{"version":3,"file":"static/js/898.03d06503.chunk.js","mappings":"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","sources":["../../../packages/mgt-chat/src/statefulClient/chatOperationScopes.ts","../../../packages/mgt-chat/src/statefulClient/GraphConfig.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/graph.groups.ts","../../../packages/mgt-chat/src/statefulClient/Caching/isConversationCacheEnabled.ts","../../../packages/mgt-chat/src/statefulClient/Caching/cacheEntryIsValid.ts","../../../packages/mgt-chat/src/statefulClient/Caching/SubscriptionCache.ts","../../../packages/mgt-chat/src/utils/Timer.ts","../../../packages/mgt-chat/src/statefulClient/GraphNotificationClient.ts","../../../packages/mgt-components/dist/es6/components/mgt-people-picker/src/components/mgt-people-picker/mgt-people-picker-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-people-picker/src/components/mgt-people-picker/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-people-picker/src/components/mgt-people-picker/mgt-people-picker.ts","../../../packages/mgt-components/dist/es6/components/mgt-tasks/src/components/mgt-tasks/mgt-tasks-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-tasks/src/components/mgt-tasks/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-tasks/src/components/mgt-tasks/mgt-tasks.graph.planner.ts","../../../packages/mgt-components/dist/es6/components/mgt-tasks/src/components/mgt-tasks/mgt-tasks.graph.todo.ts","../../../packages/mgt-components/dist/es6/components/mgt-tasks/src/components/mgt-tasks/task-sources.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-dot-options/src/components/sub-components/mgt-dot-options/strings.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-dot-options/src/components/sub-components/mgt-dot-options/mgt-dot-options-css.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-dot-options/src/components/sub-components/mgt-dot-options/mgt-dot-options.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-arrow-options/src/components/sub-components/mgt-arrow-options/mgt-arrow-options-css.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-arrow-options/src/components/sub-components/mgt-arrow-options/mgt-arrow-options.ts","../../../packages/mgt-components/dist/es6/components/mgt-tasks/src/components/mgt-tasks/mgt-tasks.ts","../../../packages/mgt-components/dist/es6/components/mgt-theme-toggle/src/components/mgt-theme-toggle/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-theme-toggle/src/components/mgt-theme-toggle/mgt-theme-toggle.ts","../../../packages/mgt-components/dist/es6/src/registerMgtComponents.ts","../../../packages/mgt-chat/src/utils/currentUser.ts","../../../packages/mgt-chat/src/utils/graph.ts","../../../packages/mgt-chat/src/statefulClient/Caching/MessageCache.ts","../../../packages/mgt-chat/src/statefulClient/ThreadEventEmitter.ts","../../../packages/mgt-chat/src/statefulClient/graph.chat.ts","../../../packages/mgt-chat/src/utils/updateMessageContentWithImage.ts","../../../packages/mgt-chat/src/utils/types.ts","../../../packages/mgt-chat/src/utils/rewriteEmojiContent.ts","../../../packages/mgt-chat/src/statefulClient/StatefulGraphChatClient.ts","../../../packages/mgt-chat/src/components/UnsupportedContent/UnsupportedContent.tsx","../../../packages/mgt-chat/src/utils/chat.tsx","../../../packages/mgt-chat/src/components/ChatMessageBar/ChatMessageBar.tsx","../../../packages/mgt-chat/src/utils/mentions.tsx","../../../packages/mgt-chat/src/components/styles/common.styles.ts","../../../packages/mgt-chat/src/components/ChatHeader/useCommonHeaderStyles.tsx","../../../packages/mgt-chat/src/components/ChatHeader/OneToOneChatHeader.tsx","../../../packages/mgt-chat/src/components/Circle/Circle.tsx","../../../packages/mgt-chat/src/components/ChatIcon/ChatIcon.tsx","../../../packages/mgt-chat/src/components/ChatHeader/GroupChatHeader.tsx","../../../packages/mgt-chat/src/components/ChatHeader/ChatTitle.tsx","../../../packages/mgt-react/src/generated/people-picker.ts","../../../packages/mgt-chat/src/components/ManageChatMembers/AddChatMembers.tsx","../../../packages/mgt-chat/src/components/ManageChatMembers/ListChatMembers.tsx","../../../packages/mgt-chat/src/components/ManageChatMembers/ManageChatMembers.tsx","../../../packages/mgt-chat/src/components/ChatHeader/EllipsisMenu.tsx","../../../packages/mgt-chat/src/components/ChatHeader/ChatHeader.tsx","../../../packages/mgt-chat/src/components/styles/registerIcons.tsx","../../../packages/mgt-chat/src/components/Chat/Chat.tsx","../../../packages/mgt-chat/src/statefulClient/useGraphChatClient.ts","../../../packages/mgt-chat/src/components/NewChat/NewChat.tsx","pages/Chats/ChatItem.tsx","pages/Chats/ChatListTemplate.tsx","pages/ChatPage.tsx"],"sourcesContent":["/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { getMgtPersonCardScopes } from '@microsoft/mgt-components/dist/es6/exports';\n\n/**\n * The lowest count of scopes required to perform all chat operations\n */\nexport const minimalChatScopesList = ['ChatMember.ReadWrite', 'Chat.ReadWrite'];\n\n/**\n * Object mapping chat operations to the scopes required to perform them\n */\nexport const chatOperationScopes: Record<string, string[]> = {\n  loadChat: ['Chat.ReadWrite'],\n  loadChatMessages: ['Chat.ReadWrite'],\n  loadChatImage: ['Chat.ReadWrite'],\n  sendChatMessage: ['Chat.ReadWrite'],\n  updateChatMessage: ['Chat.ReadWrite'],\n  deleteChatMessage: ['Chat.ReadWrite'],\n  removeChatMember: ['ChatMember.ReadWrite'],\n  addChatMember: ['ChatMember.ReadWrite'],\n  createChat: ['Chat.ReadWrite']\n};\n\n/**\n * Object mapping chat operations to the scopes required to perform them\n * This should be used when we migrate this code to use scope aware requests\n */\nexport const chatOperationScopesFullListing: Record<string, string[]> = {\n  loadChat: ['Chat.ReadBasic', 'Chat.Read', 'Chat.ReadWrite'],\n  loadChatMessages: ['Chat.Read', 'Chat.ReadWrite'],\n  loadChatImage: ['ChannelMessage.Read.All', 'Chat.Read', 'Chat.ReadWrite', 'Group.Read.All', 'Group.ReadWrite.All'],\n  sendChatMessage: ['ChatMessage.Send', 'ChatMessage.Send', 'Chat.ReadWrite', 'Group.ReadWrite.All'],\n  updateChatMessage: ['ChannelMessage.ReadWrite', 'Chat.ReadWrite', 'Group.ReadWrite.All'],\n  deleteChatMessage: ['ChannelMessage.ReadWrite', 'Chat.ReadWrite'],\n  removeChatMember: ['ChatMember.ReadWrite'],\n  addChatMember: ['ChatMember.ReadWrite', 'Chat.ReadWrite'],\n  createChat: ['Chat.Create', 'Chat.ReadWrite']\n};\n\n/**\n * The permission set required to use the people picker to search for users\n * as defined in docs: https://learn.microsoft.com/en-us/graph/toolkit/components/people-picker#microsoft-graph-permissions\n * N.B. presence permissions not currently documented\n */\nexport const peoplePickerScopes: Record<string, string[]> = {\n  loadPresence: ['Presence.Read.All'],\n  searchUsers: ['User.ReadBasic.All'],\n  searchPeople: ['People.Read']\n};\n\n/**\n * Provides an array of the distinct scopes required for all chat operations\n */\nexport const allChatScopes = Array.from(\n  [['User.Read']]\n    .concat([minimalChatScopesList])\n    .concat(Object.values(peoplePickerScopes))\n    .concat([getMgtPersonCardScopes()])\n    .reduce((acc, scopes) => {\n      scopes.forEach(s => acc.add(s));\n      return acc;\n    }, new Set<string>())\n);\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { GraphEndpoint } from '@microsoft/mgt-element';\n\nexport class GraphConfig {\n  public static ackAsString = false;\n\n  public static useCanary = false;\n\n  public static version = 'v1.0';\n\n  public static canarySubscriptionVersion = 'testprodv1.0e2ewebsockets';\n\n  public static webSocketsPrefix = 'websockets:';\n\n  public static get graphEndpoint(): GraphEndpoint {\n    return GraphConfig.useCanary ? 'https://canary.graph.microsoft.com' : 'https://graph.microsoft.com';\n  }\n\n  public static get baseCanaryUrl(): string {\n    return `${GraphConfig.graphEndpoint}/${this.canarySubscriptionVersion}`;\n  }\n\n  public static get subscriptionEndpoint(): string {\n    return GraphConfig.useCanary ? `${GraphConfig.baseCanaryUrl}/subscriptions` : '/subscriptions';\n  }\n\n  public static adjustNotificationUrl(url: string): string {\n    if (GraphConfig.useCanary && url) {\n      url = url.replace('https://graph.microsoft.com/1.0', GraphConfig.baseCanaryUrl);\n      url = url.replace('https://graph.microsoft.com/beta', GraphConfig.baseCanaryUrl);\n    }\n    return url.replace(GraphConfig.webSocketsPrefix, '');\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  IGraph,\n  prepScopes,\n  CacheItem,\n  CacheService,\n  CacheStore,\n  BatchResponse,\n  CollectionResponse\n} from '@microsoft/mgt-element';\nimport { Group } from '@microsoft/microsoft-graph-types';\nimport { schemas } from './cacheStores';\n\n/**\n * Group Type enumeration\n *\n * @export\n * @enum {number}\n */\nexport enum GroupType {\n  /**\n   * Any group Type\n   */\n  any = 0,\n\n  /**\n   * Office 365 group\n   */\n  // eslint-disable-next-line no-bitwise\n  unified = 1 << 0,\n\n  /**\n   * Security group\n   */\n  // eslint-disable-next-line no-bitwise\n  security = 1 << 1,\n\n  /**\n   * Mail Enabled Security group\n   */\n  // eslint-disable-next-line no-bitwise\n  mailenabledsecurity = 1 << 2,\n\n  /**\n   * Distribution Group\n   */\n  // eslint-disable-next-line no-bitwise\n  distribution = 1 << 3\n}\n\n/**\n * Object to be stored in cache\n */\nexport interface CacheGroup extends CacheItem {\n  /**\n   * stringified json representing a user\n   */\n  group?: string;\n}\n\n/**\n * Object to be stored in cache representing individual people\n */\ninterface CacheGroupQuery extends CacheItem {\n  /**\n   * json representing a person stored as string\n   */\n  groups?: string[];\n  /**\n   * top number of results\n   */\n  top?: number;\n}\n\n/**\n * Defines the expiration time\n */\nconst getGroupsInvalidationTime = (): number =>\n  CacheService.config.groups.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether the groups store is enabled\n */\nconst getIsGroupsCacheEnabled = (): boolean => CacheService.config.groups.isEnabled && CacheService.config.isEnabled;\n\n/**\n * Searches the Graph for Groups\n *\n * @export\n * @param {IGraph} graph\n * @param {string} query - what to search for\n * @param {number} [top=10] - number of groups to return\n * @param {GroupType} [groupTypes=GroupType.any] - the type of group to search for\n * @returns {Promise<Group[]>} An array of Groups\n */\nexport const findGroups = async (\n  graph: IGraph,\n  query: string,\n  top = 10,\n  groupTypes: GroupType = GroupType.any,\n  groupFilters = ''\n): Promise<Group[]> => {\n  const scopes = 'Group.Read.All';\n\n  let cache: CacheStore<CacheGroupQuery>;\n  const key = `${query ? query : '*'}*${groupTypes}*${groupFilters}:${top}`;\n\n  if (getIsGroupsCacheEnabled()) {\n    cache = CacheService.getCache(schemas.groups, schemas.groups.stores.groupsQuery);\n    const cacheGroupQuery = await cache.getValue(key);\n    if (cacheGroupQuery && getGroupsInvalidationTime() > Date.now() - cacheGroupQuery.timeCached) {\n      if (cacheGroupQuery.top >= top) {\n        // if request is less than the cache's requests, return a slice of the results\n        return cacheGroupQuery.groups.map(x => JSON.parse(x) as Group).slice(0, top + 1);\n      }\n      // if the new request needs more results than what's presently in the cache, graph must be called again\n    }\n  }\n\n  let filterQuery = '';\n  let responses: Map<string, BatchResponse<CollectionResponse<Group>>>;\n  const batchedResult: Group[] = [];\n\n  if (query !== '') {\n    filterQuery = `(startswith(displayName,'${query}') or startswith(mailNickname,'${query}') or startswith(mail,'${query}'))`;\n  }\n\n  if (groupFilters) {\n    filterQuery += `${query ? ' and ' : ''}${groupFilters}`;\n  }\n\n  if (groupTypes !== GroupType.any) {\n    const batch = graph.createBatch<CollectionResponse<Group>>();\n\n    const filterGroups: string[] = [];\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-enum-comparison, no-bitwise\n    if (GroupType.unified === (groupTypes & GroupType.unified)) {\n      filterGroups.push(\"groupTypes/any(c:c+eq+'Unified')\");\n    }\n\n    // eslint-disable-next-line no-bitwise, @typescript-eslint/no-unsafe-enum-comparison\n    if (GroupType.security === (groupTypes & GroupType.security)) {\n      filterGroups.push('(mailEnabled eq false and securityEnabled eq true)');\n    }\n\n    // eslint-disable-next-line no-bitwise, @typescript-eslint/no-unsafe-enum-comparison\n    if (GroupType.mailenabledsecurity === (groupTypes & GroupType.mailenabledsecurity)) {\n      filterGroups.push('(mailEnabled eq true and securityEnabled eq true)');\n    }\n\n    // eslint-disable-next-line no-bitwise, @typescript-eslint/no-unsafe-enum-comparison\n    if (GroupType.distribution === (groupTypes & GroupType.distribution)) {\n      filterGroups.push('(mailEnabled eq true and securityEnabled eq false)');\n    }\n\n    filterQuery = filterQuery ? `${filterQuery} and ` : '';\n    for (const filter of filterGroups) {\n      batch.get(filter, `/groups?$filter=${filterQuery + filter}`, ['Group.Read.All']);\n    }\n\n    try {\n      responses = await batch.executeAll();\n\n      for (const filterGroup of filterGroups) {\n        if (responses.get(filterGroup).content.value) {\n          for (const group of responses.get(filterGroup).content.value) {\n            const repeat = batchedResult.find(batchedGroup => batchedGroup.id === group.id);\n            if (!repeat) {\n              batchedResult.push(group);\n            }\n          }\n        }\n      }\n    } catch (_) {\n      try {\n        const queries: Promise<CollectionResponse<Group>>[] = [];\n        for (const filter of filterGroups) {\n          queries.push(\n            graph\n              .api('groups')\n              .filter(`${filterQuery} and ${filter}`)\n              .top(top)\n              .count(true)\n              .header('ConsistencyLevel', 'eventual')\n              .middlewareOptions(prepScopes(scopes))\n              .get() as Promise<CollectionResponse<Group>>\n          );\n        }\n        return (await Promise.all(queries)).map(x => x.value).reduce((a, b) => a.concat(b), []);\n      } catch (e) {\n        return [];\n      }\n    }\n  } else {\n    if (batchedResult.length === 0) {\n      const result = (await graph\n        .api('groups')\n        .filter(filterQuery)\n        .top(top)\n        .count(true)\n        .header('ConsistencyLevel', 'eventual')\n        .middlewareOptions(prepScopes(scopes))\n        .get()) as CollectionResponse<Group>;\n      if (getIsGroupsCacheEnabled() && result) {\n        await cache.putValue(key, { groups: result.value.map(x => JSON.stringify(x)), top });\n      }\n      return result ? result.value : null;\n    }\n  }\n\n  return batchedResult;\n};\n\n/**\n * Searches the Graph for group members\n *\n * @export\n * @param {IGraph} graph\n * @param {string} query - what to search for\n * @param {string} groupId - what to search for\n * @param {number} [top=10] - number of groups to return\n * @param {boolean} [transitive=false] - whether the return should contain a flat list of all nested members\n * @param {GroupType} [groupTypes=GroupType.any] - the type of group to search for\n * @returns {Promise<Group[]>} An array of Groups\n */\nexport const findGroupsFromGroup = async (\n  graph: IGraph,\n  query: string,\n  groupId: string,\n  top = 10,\n  transitive = false,\n  groupTypes: GroupType = GroupType.any\n): Promise<Group[]> => {\n  const scopes = 'Group.Read.All';\n\n  let cache: CacheStore<CacheGroupQuery>;\n  const key = `${groupId}:${query || '*'}:${groupTypes}:${transitive}`;\n\n  if (getIsGroupsCacheEnabled()) {\n    cache = CacheService.getCache(schemas.groups, schemas.groups.stores.groupsQuery);\n    const cacheGroupQuery = await cache.getValue(key);\n    if (cacheGroupQuery && getGroupsInvalidationTime() > Date.now() - cacheGroupQuery.timeCached) {\n      if (cacheGroupQuery.top >= top) {\n        // if request is less than the cache's requests, return a slice of the results\n        return cacheGroupQuery.groups.map(x => JSON.parse(x) as Group).slice(0, top + 1);\n      }\n      // if the new request needs more results than what's presently in the cache, graph must be called again\n    }\n  }\n\n  const apiUrl = `groups/${groupId}/${transitive ? 'transitiveMembers' : 'members'}/microsoft.graph.group`;\n  let filterQuery = '';\n  if (query !== '') {\n    filterQuery = `(startswith(displayName,'${query}') or startswith(mailNickname,'${query}') or startswith(mail,'${query}'))`;\n  }\n\n  if (groupTypes !== GroupType.any) {\n    const filterGroups = [];\n\n    // eslint-disable-next-line no-bitwise, @typescript-eslint/no-unsafe-enum-comparison\n    if (GroupType.unified === (groupTypes & GroupType.unified)) {\n      filterGroups.push(\"groupTypes/any(c:c+eq+'Unified')\");\n    }\n\n    // eslint-disable-next-line no-bitwise, @typescript-eslint/no-unsafe-enum-comparison\n    if (GroupType.security === (groupTypes & GroupType.security)) {\n      filterGroups.push('(mailEnabled eq false and securityEnabled eq true)');\n    }\n\n    // eslint-disable-next-line no-bitwise, @typescript-eslint/no-unsafe-enum-comparison\n    if (GroupType.mailenabledsecurity === (groupTypes & GroupType.mailenabledsecurity)) {\n      filterGroups.push('(mailEnabled eq true and securityEnabled eq true)');\n    }\n\n    // eslint-disable-next-line no-bitwise, @typescript-eslint/no-unsafe-enum-comparison\n    if (GroupType.distribution === (groupTypes & GroupType.distribution)) {\n      filterGroups.push('(mailEnabled eq true and securityEnabled eq false)');\n    }\n\n    filterQuery += (query !== '' ? ' and ' : '') + filterGroups.join(' or ');\n  }\n\n  const result = (await graph\n    .api(apiUrl)\n    .filter(filterQuery)\n    .count(true)\n    .top(top)\n    .header('ConsistencyLevel', 'eventual')\n    .middlewareOptions(prepScopes(scopes))\n    .get()) as CollectionResponse<Group>;\n\n  if (getIsGroupsCacheEnabled() && result) {\n    await cache.putValue(key, { groups: result.value.map(x => JSON.stringify(x)), top });\n  }\n\n  return result ? result.value : null;\n};\n\n/**\n * async promise, returns all Graph groups associated with the id provided\n *\n * @param {string} id\n * @returns {(Promise<User>)}\n * @memberof Graph\n */\nexport const getGroup = async (graph: IGraph, id: string, requestedProps?: string[]): Promise<Group> => {\n  const scopes = 'Group.Read.All';\n  let cache: CacheStore<CacheGroup>;\n\n  if (getIsGroupsCacheEnabled()) {\n    cache = CacheService.getCache(schemas.groups, schemas.groups.stores.groups);\n    // check cache\n    const group = await cache.getValue(id);\n\n    // is it stored and is timestamp good?\n    if (group && getGroupsInvalidationTime() > Date.now() - group.timeCached) {\n      const cachedData = group.group ? (JSON.parse(group.group) as Group) : null;\n      const uniqueProps =\n        requestedProps && cachedData ? requestedProps.filter(prop => !Object.keys(cachedData).includes(prop)) : null;\n\n      // return without any worries\n      if (!uniqueProps || uniqueProps.length <= 1) {\n        return cachedData;\n      }\n    }\n  }\n\n  let apiString = `/groups/${id}`;\n  if (requestedProps) {\n    apiString = apiString + '?$select=' + requestedProps.toString();\n  }\n\n  // else we must grab it\n  const response = (await graph.api(apiString).middlewareOptions(prepScopes(scopes)).get()) as Group;\n  if (getIsGroupsCacheEnabled()) {\n    await cache.putValue(id, { group: JSON.stringify(response) });\n  }\n  return response;\n};\n\n/**\n * Returns a Promise of Graph Groups array associated with the groupIds array\n *\n * @export\n * @param {IGraph} graph\n * @param {string[]} groupIds, an array of string ids\n * @returns {Promise<Group[]>}\n */\nexport const getGroupsForGroupIds = async (graph: IGraph, groupIds: string[], filters = ''): Promise<Group[]> => {\n  if (!groupIds || groupIds.length === 0) {\n    return [];\n  }\n  const batch = graph.createBatch();\n  const groupDict: Record<string, Group | Promise<Group>> = {};\n  const notInCache: string[] = [];\n  let cache: CacheStore<CacheGroup>;\n\n  if (getIsGroupsCacheEnabled()) {\n    cache = CacheService.getCache(schemas.groups, schemas.groups.stores.groups);\n  }\n\n  for (const id of groupIds) {\n    groupDict[id] = null;\n    let group: CacheGroup;\n    if (getIsGroupsCacheEnabled()) {\n      group = await cache.getValue(id);\n    }\n    if (group && getGroupsInvalidationTime() > Date.now() - group.timeCached) {\n      groupDict[id] = group.group ? (JSON.parse(group.group) as Group) : null;\n    } else if (id !== '') {\n      let apiUrl = `/groups/${id}`;\n      if (filters) {\n        apiUrl = `${apiUrl}?$filters=${filters}`;\n      }\n      batch.get(id, apiUrl, ['Group.Read.All']);\n      notInCache.push(id);\n    }\n  }\n  try {\n    const responses = await batch.executeAll();\n    // iterate over groupIds to ensure the order of ids\n    for (const id of groupIds) {\n      const response = responses.get(id);\n      if (response?.content) {\n        groupDict[id] = response.content as Group;\n        if (getIsGroupsCacheEnabled()) {\n          await cache.putValue(id, { group: JSON.stringify(response.content) });\n        }\n      }\n    }\n    return Promise.all(Object.values(groupDict));\n  } catch (_) {\n    // fallback to making the request one by one\n    try {\n      // call getGroup for all the users that weren't cached\n      groupIds\n        .filter(id => notInCache.includes(id))\n        .forEach(id => {\n          groupDict[id] = getGroup(graph, id);\n        });\n      if (getIsGroupsCacheEnabled()) {\n        // store all users that weren't retrieved from the cache, into the cache\n        await Promise.all(\n          groupIds\n            .filter(id => notInCache.includes(id))\n            .map(async id => await cache.putValue(id, { group: JSON.stringify(await groupDict[id]) }))\n        );\n      }\n      return Promise.all(Object.values(groupDict));\n    } catch (e) {\n      return [];\n    }\n  }\n};\n\n/**\n * Gets groups from the graph that are in the group ids\n *\n * @param graph\n * @param query\n * @param groupId\n * @param top\n * @param transitive\n * @param groupTypes\n * @param filters\n * @returns\n */\nexport const findGroupsFromGroupIds = async (\n  graph: IGraph,\n  query: string,\n  groupIds: string[],\n  top = 10,\n  groupTypes: GroupType = GroupType.any,\n  filters = ''\n): Promise<Group[]> => {\n  const foundGroups: Group[] = [];\n  const graphGroups = await findGroups(graph, query, top, groupTypes, filters);\n  if (graphGroups) {\n    for (const group of graphGroups) {\n      if (group.id && groupIds.includes(group.id)) {\n        foundGroups.push(group);\n      }\n    }\n  }\n  return foundGroups;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CacheService } from '@microsoft/mgt-react';\n\nexport const isConversationCacheEnabled = (): boolean => {\n  const conversation = CacheService.config.conversation;\n  return conversation.isEnabled && CacheService.config.isEnabled;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CacheItem, CacheService } from '@microsoft/mgt-react';\n\n/**\n * Defines the expiration time\n */\nconst getConversationCacheInvalidationTime = (): number => {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  const conversation = CacheService.config.conversation;\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n  return conversation.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n};\n\nexport const cacheEntryIsValid = (cacheEntry: CacheItem) =>\n  cacheEntry.timeCached && getConversationCacheInvalidationTime() > Date.now() - cacheEntry.timeCached;\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CacheItem, CacheSchema, CacheService, CacheStore, schemas } from '@microsoft/mgt-react';\nimport { Subscription } from '@microsoft/microsoft-graph-types';\nimport { isConversationCacheEnabled } from './isConversationCacheEnabled';\nimport { cacheEntryIsValid } from './cacheEntryIsValid';\n\ntype CachedSubscriptionData = CacheItem & {\n  chatId: string;\n  sessionId: string;\n  subscriptions: Subscription[];\n  lastAccessDateTime: string;\n};\n\nconst buildCacheKey = (chatId: string, sessionId: string): string => `${chatId}:${sessionId}`;\n\nexport class SubscriptionsCache {\n  private get cache(): CacheStore<CachedSubscriptionData> {\n    const conversation: CacheSchema = schemas.conversation;\n    return CacheService.getCache<CachedSubscriptionData>(conversation, conversation.stores.subscriptions);\n  }\n\n  public async loadSubscriptions(chatId: string, sessionId: string): Promise<CachedSubscriptionData | undefined> {\n    if (isConversationCacheEnabled()) {\n      const cacheKey = buildCacheKey(chatId, sessionId);\n      const data = await this.cache.getValue(cacheKey);\n      if (data && cacheEntryIsValid(data)) {\n        data.lastAccessDateTime = new Date().toISOString();\n        await this.cache.putValue(cacheKey, data);\n        return data;\n      }\n    }\n    return undefined;\n  }\n\n  public async cacheSubscription(chatId: string, sessionId: string, subscriptionRecord: Subscription): Promise<void> {\n    let cacheEntry = await this.loadSubscriptions(chatId, sessionId);\n    if (cacheEntry && cacheEntry.chatId === chatId) {\n      const subIndex = cacheEntry.subscriptions.findIndex(s => s.resource === subscriptionRecord.resource);\n      if (subIndex !== -1) {\n        cacheEntry.subscriptions[subIndex] = subscriptionRecord;\n      } else {\n        cacheEntry.subscriptions.push(subscriptionRecord);\n      }\n    } else {\n      cacheEntry = {\n        chatId,\n        sessionId,\n        subscriptions: [subscriptionRecord],\n        // we're cheating a bit here to ensure that we have a defined lastAccessDateTime\n        // but we're updating the value for all cases before storing it.\n        lastAccessDateTime: ''\n      };\n    }\n    cacheEntry.lastAccessDateTime = new Date().toISOString();\n\n    await this.cache.putValue(buildCacheKey(chatId, sessionId), cacheEntry);\n  }\n\n  public deleteCachedSubscriptions(chatId: string, sessionId: string): Promise<void> {\n    return this.cache.delete(buildCacheKey(chatId, sessionId));\n  }\n\n  public loadInactiveSubscriptions(inactivityThreshold: string): Promise<CachedSubscriptionData[]> {\n    return this.cache.queryDb('lastAccessDateTime', IDBKeyRange.upperBound(inactivityThreshold));\n  }\n}\n","import { v4 as uuid } from 'uuid';\nimport { TimerWork } from './timerWorker';\n\nexport interface Work {\n  id: string;\n  callback: () => void;\n}\n\nexport class Timer {\n  private readonly worker: SharedWorker;\n  private readonly work = new Map<string, () => void>();\n  constructor() {\n    this.worker = new SharedWorker(/* webpackChunkName: \"timer-worker\" */ new URL('./timerWorker.js', import.meta.url));\n    this.worker.port.onmessage = this.onMessage;\n  }\n\n  public setInterval(callback: () => void, delay: number): string {\n    const intervalWork: TimerWork = {\n      type: 'setInterval',\n      id: uuid(),\n      delay\n    };\n\n    this.work.set(intervalWork.id, callback);\n\n    this.worker.port.postMessage(intervalWork);\n\n    return intervalWork.id;\n  }\n\n  public clearInterval(id: string): void {\n    if (this.work.has(id)) {\n      const intervalWork: TimerWork = {\n        type: 'clearInterval',\n        id\n      };\n      this.worker.port.postMessage(intervalWork);\n      this.work.delete(id);\n    }\n  }\n\n  private readonly onMessage = (event: MessageEvent<TimerWork>): void => {\n    const intervalWork = event.data;\n    if (!intervalWork) {\n      return;\n    }\n\n    switch (intervalWork.type) {\n      case 'runCallback': {\n        if (this.work.has(intervalWork.id)) {\n          const work = this.work.get(intervalWork.id);\n          work?.();\n        }\n        break;\n      }\n    }\n  };\n\n  public close() {\n    this.worker.port.close();\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { BetaGraph, IGraph, Providers, createFromProvider, error, log } from '@microsoft/mgt-element';\nimport { HubConnection, HubConnectionBuilder, IHttpConnectionOptions, LogLevel } from '@microsoft/signalr';\nimport { ThreadEventEmitter } from './ThreadEventEmitter';\nimport type {\n  Entity,\n  Subscription,\n  ChatMessage,\n  Chat,\n  AadUserConversationMember\n} from '@microsoft/microsoft-graph-types';\nimport { GraphConfig } from './GraphConfig';\nimport { SubscriptionsCache } from './Caching/SubscriptionCache';\nimport { Timer } from '../utils/Timer';\n\nexport const appSettings = {\n  defaultSubscriptionLifetimeInMinutes: 10,\n  renewalThreshold: 75, // The number of seconds before subscription expires it will be renewed\n  renewalTimerInterval: 20, // The number of seconds between executions of the renewal timer\n  removalThreshold: 1 * 60, // number of seconds after the last update of a subscription to consider in inactive\n  removalTimerInterval: 1 * 60, // the number of seconds between executions of the timer to remove inactive subscriptions\n  useCanary: GraphConfig.useCanary\n};\n\ntype ChangeTypes = 'created' | 'updated' | 'deleted';\n\ninterface Notification<T extends Entity> {\n  subscriptionId: string;\n  changeType: ChangeTypes;\n  resource: string;\n  resourceData: T & {\n    id: string;\n    '@odata.type': string;\n    '@odata.id': string;\n  };\n  EncryptedContent: string;\n}\n\ntype ReceivedNotification = Notification<Chat> | Notification<ChatMessage> | Notification<AadUserConversationMember>;\n\nconst isMessageNotification = (o: Notification<Entity>): o is Notification<ChatMessage> =>\n  o.resource.includes('/messages(');\nconst isMembershipNotification = (o: Notification<Entity>): o is Notification<AadUserConversationMember> =>\n  o.resource.includes('/members');\n\nexport class GraphNotificationClient {\n  private connection?: HubConnection = undefined;\n  private renewalInterval?: string;\n  private cleanupInterval?: string;\n  private renewalCount = 0;\n  private chatId = '';\n  private sessionId = '';\n  private readonly subscriptionCache: SubscriptionsCache = new SubscriptionsCache();\n  private readonly timer = new Timer();\n  private get graph() {\n    return this._graph;\n  }\n  private get beta() {\n    return BetaGraph.fromGraph(this._graph);\n  }\n  private get subscriptionGraph() {\n    return GraphConfig.useCanary\n      ? createFromProvider(Providers.globalProvider, GraphConfig.canarySubscriptionVersion, 'mgt-chat')\n      : this.beta;\n  }\n\n  /**\n   *\n   */\n  constructor(\n    private readonly emitter: ThreadEventEmitter,\n    private readonly _graph: IGraph\n  ) {\n    // start the cleanup timer when we create the notification client.\n    this.startCleanupTimer();\n  }\n\n  /**\n   * Removes any active timers that may exist to prevent memory leaks and perf issues.\n   * Call this method when the component that depends an instance of this class is being removed from the DOM\n   * i.e\n   */\n  public async tearDown() {\n    log('cleaning up graph notification resources');\n    if (this.cleanupInterval) this.timer.clearInterval(this.cleanupInterval);\n    if (this.renewalInterval) this.timer.clearInterval(this.renewalInterval);\n    this.timer.close();\n    await this.unsubscribeFromChatNotifications(this.chatId, this.sessionId);\n  }\n\n  private readonly getToken = async () => {\n    const token = await Providers.globalProvider.getAccessToken();\n    if (!token) throw new Error('Could not retrieve token for user');\n    return token;\n  };\n\n  // TODO: understand if this is needed under the native model\n  private readonly onReconnect = (connectionId: string | undefined) => {\n    log(`Reconnected. ConnectionId: ${connectionId || 'undefined'}`);\n    // void this.renewChatSubscriptions();\n  };\n\n  private readonly receiveNotificationMessage = (message: string) => {\n    if (typeof message !== 'string') throw new Error('Expected string from receivenotificationmessageasync');\n\n    const notification: ReceivedNotification = JSON.parse(message) as ReceivedNotification;\n    log('received notification message', notification);\n    const emitter: ThreadEventEmitter | undefined = this.emitter;\n    if (!notification.resourceData) throw new Error('Message did not contain resourceData');\n    if (isMessageNotification(notification)) {\n      this.processMessageNotification(notification, emitter);\n    } else if (isMembershipNotification(notification)) {\n      this.processMembershipNotification(notification, emitter);\n    } else {\n      this.processChatPropertiesNotification(notification, emitter);\n    }\n    // Need to return a status code string of 200 so that graph knows the message was received and doesn't re-send the notification\n    const ackMessage: unknown = { StatusCode: '200' };\n    return GraphConfig.ackAsString ? JSON.stringify(ackMessage) : ackMessage;\n  };\n\n  private processMessageNotification(notification: Notification<ChatMessage>, emitter: ThreadEventEmitter | undefined) {\n    const message = notification.resourceData;\n\n    switch (notification.changeType) {\n      case 'created':\n        emitter?.chatMessageReceived(message);\n        return;\n      case 'updated':\n        emitter?.chatMessageEdited(message);\n        return;\n      case 'deleted':\n        emitter?.chatMessageDeleted(message);\n        return;\n      default:\n        throw new Error('Unknown change type');\n    }\n  }\n\n  private processMembershipNotification(\n    notification: Notification<AadUserConversationMember>,\n    emitter: ThreadEventEmitter | undefined\n  ) {\n    const member = notification.resourceData;\n    switch (notification.changeType) {\n      case 'created':\n        emitter?.participantAdded(member);\n        return;\n      case 'deleted':\n        emitter?.participantRemoved(member);\n        return;\n      default:\n        throw new Error('Unknown change type');\n    }\n  }\n\n  private processChatPropertiesNotification(notification: Notification<Chat>, emitter: ThreadEventEmitter | undefined) {\n    const chat = notification.resourceData;\n    switch (notification.changeType) {\n      case 'updated':\n        emitter?.chatThreadPropertiesUpdated(chat);\n        return;\n      case 'deleted':\n        emitter?.chatThreadDeleted(chat);\n        return;\n      default:\n        throw new Error('Unknown change type');\n    }\n  }\n\n  private readonly cacheSubscription = async (subscriptionRecord: Subscription): Promise<void> => {\n    log(subscriptionRecord);\n\n    await this.subscriptionCache.cacheSubscription(this.chatId, this.sessionId, subscriptionRecord);\n\n    // only start timer once. -1 for renewalInterval is semaphore it has stopped.\n    if (this.renewalInterval === undefined) this.startRenewalTimer();\n  };\n\n  private async subscribeToResource(resourcePath: string, changeTypes: ChangeTypes[]) {\n    // build subscription request\n    const expirationDateTime = new Date(\n      new Date().getTime() + appSettings.defaultSubscriptionLifetimeInMinutes * 60 * 1000\n    ).toISOString();\n    const subscriptionDefinition: Subscription = {\n      changeType: changeTypes.join(','),\n      notificationUrl: `${GraphConfig.webSocketsPrefix}?groupId=${this.chatId}&sessionId=${this.sessionId}`,\n      resource: resourcePath,\n      expirationDateTime,\n      includeResourceData: true,\n      clientState: 'wsssecret'\n    };\n\n    log('subscribing to changes for ' + resourcePath);\n    const subscriptionEndpoint = GraphConfig.subscriptionEndpoint;\n    // send subscription POST to Graph\n    const subscription: Subscription = (await this.subscriptionGraph\n      .api(subscriptionEndpoint)\n      .post(subscriptionDefinition)) as Subscription;\n    if (!subscription?.notificationUrl) throw new Error('Subscription not created');\n    log(subscription);\n\n    const awaits: Promise<void>[] = [];\n    // Cache the subscription in storage for re-hydration on page refreshes\n    awaits.push(this.cacheSubscription(subscription));\n\n    // create a connection to the web socket if one does not exist\n    if (!this.connection) awaits.push(this.createSignalRConnection(subscription.notificationUrl));\n\n    log('Invoked CreateSubscription');\n    return Promise.all(awaits);\n  }\n\n  private readonly startRenewalTimer = () => {\n    if (this.renewalInterval !== undefined) this.timer.clearInterval(this.renewalInterval);\n    this.renewalInterval = this.timer.setInterval(this.syncTimerWrapper, appSettings.renewalTimerInterval * 1000);\n    log(`Start renewal timer . Id: ${this.renewalInterval}`);\n  };\n\n  private readonly syncTimerWrapper = () => void this.renewalTimer();\n\n  private readonly renewalTimer = async () => {\n    log(`running subscription renewal timer for chatId: ${this.chatId} sessionId: ${this.sessionId}`);\n    const subscriptions =\n      (await this.subscriptionCache.loadSubscriptions(this.chatId, this.sessionId))?.subscriptions || [];\n    if (subscriptions.length === 0) {\n      log(`No subscriptions found in session state. Stop renewal timer ${this.renewalInterval}.`);\n      clearInterval(this.renewalInterval);\n      return;\n    }\n\n    for (const subscription of subscriptions) {\n      if (!subscription.expirationDateTime) continue;\n      const expirationTime = new Date(subscription.expirationDateTime);\n      const now = new Date();\n      const diff = Math.round((expirationTime.getTime() - now.getTime()) / 1000);\n\n      if (diff <= appSettings.renewalThreshold) {\n        this.renewalCount++;\n        log(`Renewing Graph subscription. RenewalCount: ${this.renewalCount}`);\n        // stop interval to prevent new invokes until refresh is ready.\n        clearInterval(this.renewalInterval);\n        this.renewalInterval = undefined;\n        void this.renewChatSubscriptions();\n        // There is one subscription that need expiration, all subscriptions will be renewed\n        break;\n      }\n    }\n  };\n\n  public renewChatSubscriptions = async () => {\n    if (this.renewalInterval) this.timer.clearInterval(this.renewalInterval);\n\n    const expirationTime = new Date(\n      new Date().getTime() + appSettings.defaultSubscriptionLifetimeInMinutes * 60 * 1000\n    );\n\n    const subscriptionCache = await this.subscriptionCache.loadSubscriptions(this.chatId, this.sessionId);\n    const awaits: Promise<unknown>[] = [];\n    for (const subscription of subscriptionCache?.subscriptions || []) {\n      if (!subscription.id) continue;\n      // the renewSubscription method caches the updated subscription to track the new expiration time\n      awaits.push(this.renewSubscription(subscription.id, expirationTime.toISOString()));\n      log(`Invoked RenewSubscription ${subscription.id}`);\n    }\n    await Promise.all(awaits);\n  };\n\n  public renewSubscription = async (subscriptionId: string, expirationDateTime: string): Promise<void> => {\n    // PATCH /subscriptions/{id}\n    const renewedSubscription = (await this.graph.api(`${GraphConfig.subscriptionEndpoint}/${subscriptionId}`).patch({\n      expirationDateTime\n    })) as Subscription;\n    return this.cacheSubscription(renewedSubscription);\n  };\n\n  public async createSignalRConnection(notificationUrl: string) {\n    const connectionOptions: IHttpConnectionOptions = {\n      accessTokenFactory: this.getToken,\n      withCredentials: false\n    };\n    const connection = new HubConnectionBuilder()\n      .withUrl(GraphConfig.adjustNotificationUrl(notificationUrl), connectionOptions)\n      .withAutomaticReconnect()\n      .configureLogging(LogLevel.Information)\n      .build();\n\n    connection.onreconnected(this.onReconnect);\n\n    connection.on('receivenotificationmessageasync', this.receiveNotificationMessage);\n\n    connection.on('EchoMessage', log);\n\n    this.connection = connection;\n    try {\n      await connection.start();\n      log(connection);\n    } catch (e) {\n      error('An error occurred connecting to the notification web socket', e);\n    }\n  }\n\n  private async deleteSubscription(id: string) {\n    try {\n      await this.graph.api(`${GraphConfig.subscriptionEndpoint}/${id}`).delete();\n    } catch (e) {\n      error(e);\n    }\n  }\n\n  private async removeSubscriptions(subscriptions: Subscription[]): Promise<unknown[]> {\n    const tasks: Promise<unknown>[] = [];\n    for (const s of subscriptions) {\n      // if there is no id or the subscription is expired, skip\n      if (!s.id || (s.expirationDateTime && new Date(s.expirationDateTime) <= new Date())) continue;\n      tasks.push(this.deleteSubscription(s.id));\n    }\n    return Promise.all(tasks);\n  }\n\n  private startCleanupTimer() {\n    this.cleanupInterval = this.timer.setInterval(this.cleanupTimerSync, appSettings.removalTimerInterval * 1000);\n  }\n\n  private readonly cleanupTimerSync = () => {\n    void this.cleanupTimer();\n  };\n\n  private readonly cleanupTimer = async () => {\n    log(`running cleanup timer`);\n    const offset = Math.min(\n      appSettings.removalThreshold * 1000,\n      appSettings.defaultSubscriptionLifetimeInMinutes * 60 * 1000\n    );\n    const threshold = new Date(new Date().getTime() - offset).toISOString();\n    const inactiveSubs = await this.subscriptionCache.loadInactiveSubscriptions(threshold);\n    let tasks: Promise<unknown>[] = [];\n    for (const inactive of inactiveSubs) {\n      tasks.push(this.removeSubscriptions(inactive.subscriptions));\n    }\n    await Promise.all(tasks);\n    tasks = [];\n    for (const inactive of inactiveSubs) {\n      tasks.push(this.subscriptionCache.deleteCachedSubscriptions(inactive.chatId, inactive.sessionId));\n    }\n  };\n\n  public async closeSignalRConnection() {\n    // stop the connection and set it to undefined so it will reconnect when next subscription is created.\n    await this.connection?.stop();\n    this.connection = undefined;\n  }\n\n  private async unsubscribeFromChatNotifications(chatId: string, sessionId: string) {\n    await this.closeSignalRConnection();\n    const cacheData = await this.subscriptionCache.loadSubscriptions(chatId, sessionId);\n    if (cacheData) {\n      await Promise.all([\n        this.removeSubscriptions(cacheData.subscriptions),\n        this.subscriptionCache.deleteCachedSubscriptions(chatId, sessionId)\n      ]);\n    }\n  }\n\n  public async subscribeToChatNotifications(chatId: string, sessionId: string) {\n    // if we have a \"previous\" chat state at present, unsubscribe\n    if (this.chatId && this.sessionId && chatId !== this.chatId && sessionId !== this.sessionId) {\n      await this.unsubscribeFromChatNotifications(this.chatId, this.sessionId);\n    }\n    this.chatId = chatId;\n    this.sessionId = sessionId;\n    // MGT uses a per-user cache, so no concerns of loading the cached data for another user.\n    const cacheData = await this.subscriptionCache.loadSubscriptions(chatId, sessionId);\n    if (cacheData) {\n      // check subscription validity & renew if all still valid otherwise recreate\n      const someExpired = cacheData.subscriptions.some(\n        s => s.expirationDateTime && new Date(s.expirationDateTime) <= new Date()\n      );\n      // for a given user + app + chatId + sessionId they only get one websocket and receive all notifications via that websocket.\n      const webSocketUrl = cacheData.subscriptions.find(s => s.notificationUrl)?.notificationUrl;\n      if (someExpired) {\n        await this.removeSubscriptions(cacheData.subscriptions);\n      } else if (webSocketUrl) {\n        await this.createSignalRConnection(webSocketUrl);\n        await this.renewChatSubscriptions();\n        return;\n      }\n      await this.subscriptionCache.deleteCachedSubscriptions(chatId, sessionId);\n    }\n    const promises: Promise<unknown>[] = [];\n    promises.push(this.subscribeToResource(`/chats/${chatId}/messages`, ['created', 'updated', 'deleted']));\n    promises.push(this.subscribeToResource(`/chats/${chatId}/members`, ['created', 'deleted']));\n    promises.push(this.subscribeToResource(`/chats/${chatId}`, ['updated', 'deleted']));\n    await Promise.all(promises);\n  }\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{--person-details-wrapper-width:0;width:auto}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){display:flex;flex-wrap:wrap;height:auto;background:padding-box linear-gradient(var(--people-picker-input-background,var(--neutral-fill-input-rest)),var(--people-picker-input-background,var(--neutral-fill-input-rest))),border-box var(--people-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--people-picker-input-hover-background,var(--neutral-fill-input-hover)),var(--people-picker-input-hover-background,var(--neutral-fill-input-hover))),border-box var(--people-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--people-picker-input-focus-background,var(--neutral-fill-input-focus)),var(--people-picker-input-focus-background,var(--neutral-fill-input-focus))),border-box var(--people-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(start){margin:unset}:host fluent-text-field::part(control){width:min-content;height:calc((var(--base-height-multiplier) + var(--density)) * var(--design-unit) * 1px);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--people-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--people-picker-input-placeholder-hover-text-color,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--people-picker-input-placeholder-focus-text-color,var(--input-placeholder-filled))}:host fluent-text-field .search-icon{display:flex;padding-top:10px;padding-inline-start:10px}:host fluent-text-field .search-icon svg path{fill:var(--people-picker-search-icon-color,currentColor)}:host .selected-list{display:flex;flex-wrap:wrap;column-gap:5px;padding:unset;margin:0 5px}:host .selected-list-item{display:flex;column-gap:5px;border-radius:100px;margin-top:3px;background-color:var(--people-picker-selected-option-background-color,var(--person-background-color,var(--neutral-layer-3)))}:host .selected-list-item.highlighted{background-color:var(--people-picker-selected-option-highlight-background-color,var(--accent-fill-rest))}:host .selected-list-item-close-icon{display:flex;justify-content:center;align-items:center;padding-inline-end:8px;cursor:pointer}:host .selected-list-item-close-icon svg path{fill:var(--people-picker-remove-selected-close-icon-color,currentColor)}:host .selected-list-item-person{width:max-content}:host fluent-card{margin-top:4px;background-color:var(--people-picker-dropdown-background-color,var(--neutral-layer-card-container))}:host .searched-people-list{list-style:none;padding:4px;margin:auto}:host .searched-people-list-result{padding:4px;border-radius:4px;background:var(--people-picker-dropdown-result-background-color,var(--person-background-color,transparent))}:host .searched-people-list-result:hover{background:var(--people-picker-dropdown-result-hover-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .searched-people-list-result:focus,:host .searched-people-list-result:focus-within{background:var(--people-picker-dropdown-result-focus-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .message-parent{display:flex;place-content:center;flex-direction:row;padding:10px 15px;column-gap:5px}:host .message-parent .loading-text,:host .message-parent .search-error-text{font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:var(--people-picker-no-results-text-color,var(--neutral-foreground-hint))}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  inputPlaceholderText: 'Search for a name',\n  maxSelectionsPlaceHolder: 'Max contacts added',\n  maxSelectionsAriaLabel: 'Maximum contact selections reached',\n  noResultsFound: \"We didn't find any matches.\",\n  loadingMessage: 'Loading...',\n  selected: 'selected',\n  removeSelectedUser: 'Remove ',\n  selectContact: 'select a contact',\n  suggestionsTitle: 'Suggested contacts'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport {\n  findGroups,\n  getGroupsForGroupIds,\n  GroupType,\n  getGroup,\n  findGroupsFromGroupIds\n} from '../../graph/graph.groups';\nimport { findPeople, getPeople, PersonType, UserType } from '../../graph/graph.people';\nimport {\n  findUsers,\n  findGroupMembers,\n  findUsersFromGroupIds,\n  getUser,\n  getUsersForUserIds,\n  getUsers\n} from '../../graph/graph.user';\nimport { IDynamicPerson, ViewType } from '../../graph/types';\nimport {\n  Providers,\n  ProviderState,\n  MgtTemplatedComponent,\n  arraysAreEqual,\n  IGraph,\n  mgtHtml\n} from '@microsoft/mgt-element';\nimport '../../styles/style-helper';\nimport '../sub-components/mgt-spinner/mgt-spinner';\nimport { debounce, isValidEmail } from '../../utils/Utils';\nimport { MgtPerson, defaultPersonProperties, registerMgtPersonComponent } from '../mgt-person/mgt-person';\nimport { PersonCardInteraction } from '../PersonCardInteraction';\nimport { MgtFlyout, registerMgtFlyoutComponent } from '../sub-components/mgt-flyout/mgt-flyout';\nimport { styles } from './mgt-people-picker-css';\nimport { SvgIcon, getSvg } from '../../utils/SvgHelper';\nimport { fluentTextField, fluentCard } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { strings } from './strings';\nimport { Person, User } from '@microsoft/microsoft-graph-types';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { registerMgtSpinnerComponent } from '../sub-components/mgt-spinner/mgt-spinner';\nimport { isGraphError } from '../../graph/isGraphError';\n\nexport { GroupType } from '../../graph/graph.groups';\nexport { PersonType, UserType } from '../../graph/graph.people';\n\nexport const registerMgtPeoplePickerComponent = () => {\n  registerFluentComponents(fluentTextField, fluentCard);\n\n  registerMgtFlyoutComponent();\n  registerMgtPersonComponent();\n  registerMgtSpinnerComponent();\n  registerComponent('people-picker', MgtPeoplePicker);\n};\n\n/**\n * Web component used to search for people from the Microsoft Graph\n *\n * @export\n * @class MgtPicker\n * @extends {MgtTemplatedComponent}\n *\n * @fires {CustomEvent<IDynamicPerson[]>} selectionChanged - Fired when set of selected people changes\n *\n * @cssprop --people-picker-selected-option-background-color - {Color} the background color of the selected person.\n * @cssprop --people-picker-selected-option-highlight-background-color - {Color} the background color of the selected person when you select it for copy/cut.\n * @cssprop --people-picker-dropdown-background-color - {Color} the background color of the dropdown card.\n * @cssprop --people-picker-dropdown-result-background-color - {Color} the background color of the dropdown result.\n * @cssprop --people-picker-dropdown-result-hover-background-color - {Color} the background color of the dropdown result on hover.\n * @cssprop --people-picker-dropdown-result-focus-background-color - {Color} the background color of the dropdown result on focus.\n * @cssprop --people-picker-no-results-text-color - {Color} the no results found text color.\n * @cssprop --people-picker-input-background - {Color} the input background color.\n * @cssprop --people-picker-input-border-color - {Color} the input border color.\n * @cssprop --people-picker-input-hover-background - {Color} the input background color when you hover.\n * @cssprop --people-picker-input-hover-border-color - {Color} the input border color when you hover\n * @cssprop --people-picker-input-focus-background - {Color} the input background color when you focus.\n * @cssprop --people-picker-input-focus-border-color - {Color} the input border color when you focus.\n * @cssprop --people-picker-input-placeholder-focus-text-color - {Color} the placeholder text color when you focus.\n * @cssprop --people-picker-input-placeholder-hover-text-color - {Color} the placeholder text color when you hover.\n * @cssprop --people-picker-input-placeholder-text-color - {Color} the placeholder text color.\n * @cssprop --people-picker-search-icon-color - {Color} the search icon color\n * @cssprop --people-picker-remove-selected-close-icon-color - {Color} the remove selected person close icon color.\n */\nexport class MgtPeoplePicker extends MgtTemplatedComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * The strings to be used for localizing the component.\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtPeoplePicker\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Gets the flyout element\n   *\n   * @protected\n   * @type {MgtFlyout}\n   * @memberof MgtLogin\n   */\n  protected get flyout(): MgtFlyout {\n    return this.renderRoot.querySelector('.flyout');\n  }\n\n  /**\n   * Gets the input element\n   *\n   * @protected\n   * @type {MgtFlyout}\n   * @memberof MgtLogin\n   */\n  protected get input(): HTMLInputElement {\n    return this.renderRoot.querySelector('fluent-text-field');\n  }\n\n  /**\n   * value determining if search is filtered to a group.\n   *\n   * @type {string}\n   */\n  @property({ attribute: 'group-id', converter: value => value.trim() })\n  public get groupId(): string {\n    return this._groupId;\n  }\n  public set groupId(value) {\n    if (this._groupId === value) {\n      return;\n    }\n\n    this._groupId = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * array of groups for search to be filtered by.\n   *\n   * @type {string[]}\n   */\n  @property({\n    attribute: 'group-ids',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    }\n  })\n  public get groupIds(): string[] {\n    return this._groupIds;\n  }\n  public set groupIds(value) {\n    if (arraysAreEqual(this._groupIds, value)) {\n      return;\n    }\n    this._groupIds = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * value determining if search is filtered to a group.\n   *\n   * @type {PersonType}\n   */\n  @property({\n    attribute: 'type',\n    converter: value => {\n      value = value.toLowerCase();\n      if (!value || value.length === 0) {\n        return PersonType.any;\n      }\n\n      if (typeof PersonType[value] === 'undefined') {\n        return PersonType.any;\n      } else {\n        return PersonType[value] as PersonType;\n      }\n    }\n  })\n  public get type(): PersonType {\n    return this._type;\n  }\n  public set type(value) {\n    if (this._type === value) {\n      return;\n    }\n\n    this._type = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * type of group to search for - requires personType to be\n   * set to \"Group\" or \"All\"\n   *\n   * @type {GroupType}\n   */\n  @property({\n    attribute: 'group-type',\n    converter: value => {\n      if (!value || value.length === 0) {\n        return GroupType.any;\n      }\n\n      const values = value.split(',');\n      const groupTypes: GroupType[] = [];\n\n      for (let v of values) {\n        v = v.trim();\n        if (typeof GroupType[v] !== 'undefined') {\n          groupTypes.push(GroupType[v] as GroupType);\n        }\n      }\n\n      if (groupTypes.length === 0) {\n        return GroupType.any;\n      }\n\n      // eslint-disable-next-line no-bitwise\n      const gt = groupTypes.reduce((a, c) => a | c);\n      return gt;\n    }\n  })\n  public get groupType(): GroupType {\n    return this._groupType;\n  }\n  public set groupType(value) {\n    if (this._groupType === value) {\n      return;\n    }\n    this._groupType = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * The type of user to search for. Default is any.\n   *\n   * @readonly\n   * @type {UserType}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'user-type',\n    converter: value => {\n      value = value.toLowerCase();\n\n      return !value || typeof UserType[value] === 'undefined' ? UserType.any : (UserType[value] as UserType);\n    }\n  })\n  public get userType(): UserType {\n    return this._userType;\n  }\n  public set userType(value) {\n    if (this._userType === value) {\n      return;\n    }\n\n    this._userType = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * whether the return should contain a flat list of all nested members\n   *\n   * @type {boolean}\n   */\n  @property({\n    attribute: 'transitive-search',\n    type: Boolean\n  })\n  public get transitiveSearch(): boolean {\n    return this._transitiveSearch;\n  }\n  public set transitiveSearch(value: boolean) {\n    if (this.transitiveSearch !== value) {\n      this._transitiveSearch = value;\n      void this.requestStateUpdate(true);\n    }\n  }\n\n  /**\n   * containing object of IDynamicPerson.\n   *\n   * @type {IDynamicPerson[]}\n   */\n  @property({\n    attribute: 'people',\n    type: Object\n  })\n  public get people(): IDynamicPerson[] {\n    return this._people;\n  }\n  public set people(value: IDynamicPerson[]) {\n    if (!arraysAreEqual(this._people, value)) {\n      this._people = value;\n      void this.requestStateUpdate(true);\n    }\n  }\n\n  /**\n   * determining how many people to show in list.\n   *\n   * @type {number}\n   */\n  @property({\n    attribute: 'show-max',\n    type: Number\n  })\n  public get showMax(): number {\n    return this._showMax;\n  }\n  public set showMax(value: number) {\n    if (value !== this._showMax) {\n      this._showMax = value;\n      void this.requestStateUpdate(true);\n    }\n  }\n\n  /**\n   * Sets whether the person image should be fetched\n   * from the Microsoft Graph\n   *\n   * @type {boolean}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'disable-images',\n    type: Boolean\n  })\n  public disableImages: boolean;\n\n  @property({\n    attribute: 'show-presence',\n    type: Boolean\n  })\n  public showPresence: boolean;\n\n  /**\n   * array of user picked people.\n   *\n   * @type {IDynamicPerson[]}\n   */\n  @property({\n    attribute: 'selected-people',\n    type: Array\n  })\n  public get selectedPeople(): IDynamicPerson[] {\n    return this._selectedPeople;\n  }\n  public set selectedPeople(value: IDynamicPerson[]) {\n    if (!value) value = [];\n    if (!arraysAreEqual(this._selectedPeople, value)) {\n      this._selectedPeople = value;\n      this.fireCustomEvent('selectionChanged', this._selectedPeople);\n      this.requestUpdate();\n    }\n  }\n\n  /**\n   * array of people to be selected upon initialization\n   *\n   * @type {string[]}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'default-selected-user-ids',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public get defaultSelectedUserIds(): string[] {\n    return this._defaultSelectedUserIds;\n  }\n  public set defaultSelectedUserIds(value) {\n    if (!arraysAreEqual(this._defaultSelectedUserIds, value)) {\n      this._defaultSelectedUserIds = value;\n      void this.requestStateUpdate(true);\n    }\n  }\n\n  /**\n   * array of groups to be selected upon initialization\n   *\n   * @type {string[]}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'default-selected-group-ids',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public get defaultSelectedGroupIds(): string[] {\n    return this._defaultSelectedGroupIds;\n  }\n  public set defaultSelectedGroupIds(value) {\n    if (!arraysAreEqual(this._defaultSelectedGroupIds, value)) {\n      this._defaultSelectedGroupIds = value;\n      void this.requestStateUpdate(true);\n    }\n  }\n\n  /**\n   * Placeholder text.\n   *\n   * @type {string}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'placeholder',\n    type: String\n  })\n  public placeholder: string;\n\n  /**\n   * Determines whether component should be disabled or not\n   *\n   * @type {boolean}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'disabled',\n    type: Boolean\n  })\n  public disabled: boolean;\n\n  /**\n   * Determines if a user can enter an email without selecting a person\n   *\n   * @type {boolean}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'allow-any-email',\n    type: Boolean\n  })\n  public allowAnyEmail: boolean;\n\n  /**\n   * Determines whether component allows multiple or single selection of people\n   *\n   * @type {string}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'selection-mode',\n    type: String\n  })\n  public selectionMode: string;\n\n  /**\n   * Array of the only users to be searched.\n   *\n   * @type {string[]}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'user-ids',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public get userIds(): string[] {\n    return this._userIds;\n  }\n  public set userIds(value: string[]) {\n    if (arraysAreEqual(this._userIds, value)) {\n      return;\n    }\n    this._userIds = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * Filters that can be set on the user properties query.\n   */\n  @property({ attribute: 'user-filters' })\n  public get userFilters(): string {\n    return this._userFilters;\n  }\n\n  public set userFilters(value: string) {\n    this._userFilters = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * Filters that can be set on the people query properties.\n   */\n  @property({ attribute: 'people-filters' })\n  public get peopleFilters(): string {\n    return this._peopleFilters;\n  }\n\n  public set peopleFilters(value: string) {\n    this._peopleFilters = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * Filters that can be set on the group query properties.\n   */\n  @property({ attribute: 'group-filters' })\n  public get groupFilters(): string {\n    return this._groupFilters;\n  }\n\n  public set groupFilters(value: string) {\n    this._groupFilters = value;\n    void this.requestStateUpdate(true);\n  }\n\n  /**\n   * Label that can be set on the people picker input to provide context to\n   * assistive technologies\n   */\n  @property({\n    attribute: 'aria-label',\n    type: String\n  })\n  public ariaLabel: string;\n\n  /**\n   * Get the scopes required for people picker\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtPeoplePicker\n   */\n  public static get requiredScopes(): string[] {\n    return [\n      ...new Set(['user.read.all', 'people.read', 'group.read.all', 'user.readbasic.all', ...MgtPerson.requiredScopes])\n    ];\n  }\n\n  /**\n   * User input in search.\n   *\n   * @protected\n   * @type {string}\n   * @memberof MgtPeoplePicker\n   */\n  protected userInput: string;\n\n  // if search is still loading don't load \"people not found\" state\n  @state() private _showLoading: boolean;\n\n  private _userIds: string[];\n  private _groupId: string;\n  private _groupIds: string[];\n  private _type: PersonType = PersonType.person;\n  private _groupType: GroupType = GroupType.any;\n  private _userType: UserType = UserType.any;\n  private _userFilters: string;\n  private _groupFilters: string;\n  private _peopleFilters: string;\n  private _defaultSelectedGroupIds: string[];\n  private _defaultSelectedUserIds: string[];\n  private _selectedPeople: IDynamicPerson[] = [];\n  private _showMax: number;\n  private _people: IDynamicPerson[];\n  private _transitiveSearch: boolean;\n\n  private defaultPeople: IDynamicPerson[];\n\n  // tracking of user arrow key input for selection\n  @state() private _arrowSelectionCount = -1;\n  // List of people requested if group property is provided\n  private _groupPeople: IDynamicPerson[];\n  private _debouncedSearch: { (): void; (): void };\n  private defaultSelectedUsers: IDynamicPerson[] = [];\n  private defaultSelectedGroups: IDynamicPerson[] = [];\n  // List of users highlighted for copy/cut-pasting\n  @state() private _highlightedUsers: Element[] = [];\n  // current user index to the left of the highlighted users\n  private _currentHighlightedUserPos = 0;\n\n  /**\n   * Checks if the input is focused.\n   */\n  @state() private _isFocused = false;\n\n  /**\n   * Switch to determine if a typed email can be set.\n   */\n  @state() private _setAnyEmail = false;\n\n  /**\n   * List of people found from the graph calls.\n   */\n  @state() private _foundPeople: IDynamicPerson[];\n\n  constructor() {\n    super();\n    this.clearState();\n    this._showLoading = true;\n    this.showMax = 6;\n    this.disableImages = false;\n\n    this.disabled = false;\n    this.allowAnyEmail = false;\n    this.addEventListener('copy', this.handleCopy);\n    this.addEventListener('cut', this.handleCut);\n    this.addEventListener('paste', this.handlePaste);\n    this.addEventListener('selectionChanged', this.handleSelectionChanged);\n  }\n\n  /**\n   * Disable the inner input of the fluent-text-field.\n   */\n  private disableTextInput() {\n    const inputControl = this.input.shadowRoot.querySelector<HTMLInputElement>('input');\n    if (inputControl) {\n      inputControl.setAttribute('disabled', 'true');\n      inputControl.value = '';\n    }\n  }\n\n  /**\n   * Enable the inner input of the fluent-text-field.\n   */\n  private enableTextInput() {\n    const inputControl = this.input.shadowRoot.querySelector<HTMLInputElement>('input');\n    if (inputControl) {\n      inputControl.removeAttribute('disabled');\n      inputControl.focus();\n    }\n  }\n\n  /**\n   * Clears the disabled property on the people picker when used in single mode.\n   */\n  private readonly handleSelectionChanged = () => {\n    if (this.selectedPeople.length === 0 && !this.disabled) {\n      this.enableTextInput();\n    }\n  };\n\n  private get hasMaxSelections(): boolean {\n    return this.selectionMode === 'single' && this.selectedPeople.length >= 1;\n  }\n\n  /**\n   * Focuses the input element when focus is called\n   *\n   * @param {FocusOptions} [options]\n   * @memberof MgtPeoplePicker\n   */\n  public focus(options?: FocusOptions) {\n    if (!this.input) {\n      return;\n    }\n    this.input.focus(options);\n    this.input.select();\n  }\n\n  /**\n   * Queries the microsoft graph for a user based on the user id and adds them to the selectedPeople array\n   *\n   * @param {readonly string []} an array of user ids to add to selectedPeople\n   * @returns {Promise<void>}\n   * @memberof MgtPeoplePicker\n   */\n  public async selectUsersById(userIds: readonly string[]): Promise<void> {\n    const provider = Providers.globalProvider;\n    const graph = Providers.globalProvider.graph;\n    if (provider && provider.state === ProviderState.SignedIn) {\n      // eslint-disable-next-line guard-for-in, @typescript-eslint/no-for-in-array\n      for (const id in userIds) {\n        const userId = userIds[id];\n        try {\n          const personDetails = await getUser(graph, userId, defaultPersonProperties);\n          this.addPerson(personDetails);\n        } catch (e: unknown) {\n          // This caters for allow-any-email property if it's enabled on the component\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-call\n          if (isGraphError(e) && e.message?.includes('does not exist') && this.allowAnyEmail) {\n            if (isValidEmail(userId)) {\n              const anyMailUser = {\n                mail: userId,\n                displayName: userId\n              };\n              this.addPerson(anyMailUser);\n            }\n          }\n        }\n      }\n    }\n  }\n  /**\n   * Queries the microsoft graph for a group of users from a group id, and adds them to the selectedPeople\n   *\n   * @param {readonly string []} an array of group ids to add to selectedPeople\n   * @returns {Promise<void>}\n   * @memberof MgtPeoplePicker\n   */\n  public async selectGroupsById(groupIds: readonly string[]): Promise<void> {\n    const provider = Providers.globalProvider;\n    const graph = Providers.globalProvider.graph;\n    if (provider && provider.state === ProviderState.SignedIn) {\n      // eslint-disable-next-line guard-for-in, @typescript-eslint/no-for-in-array\n      for (const id in groupIds) {\n        try {\n          const groupDetails = await getGroup(graph, groupIds[id]);\n          this.addPerson(groupDetails);\n        } catch (e) {\n          // no-op\n        }\n      }\n    }\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return a lit-html TemplateResult.\n   * Setting properties inside this method will not trigger the element to update.\n   *\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  public render(): TemplateResult {\n    const defaultTemplate = this.renderTemplate('default', { people: this._foundPeople });\n    if (defaultTemplate) {\n      return defaultTemplate;\n    }\n\n    const selectedPeopleTemplate = this.renderSelectedPeople(this.selectedPeople);\n    const inputTemplate = this.renderInput(selectedPeopleTemplate);\n    const flyoutTemplate = this.renderFlyout(inputTemplate);\n\n    return html`\n      <div>\n        ${flyoutTemplate}\n      </div>\n    `;\n  }\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtPeoplePicker\n   */\n  protected clearState(): void {\n    this.selectedPeople = [];\n    this.userInput = '';\n    this._highlightedUsers = [];\n    this._currentHighlightedUserPos = 0;\n  }\n\n  /**\n   * Request to reload the state.\n   * Use reload instead of load to ensure loading events are fired.\n   *\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  protected requestStateUpdate(force?: boolean) {\n    if (force) {\n      this._groupPeople = null;\n      this._foundPeople = null;\n      this.selectedPeople = [];\n      this.defaultPeople = null;\n    }\n\n    return super.requestStateUpdate(force);\n  }\n\n  /**\n   * Render the input text box.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderInput(selectedPeopleTemplate: TemplateResult): TemplateResult {\n    const placeholder = this.disabled ? '' : this.placeholder || this.strings.inputPlaceholderText;\n    const maxSelectionsAriaLabel = this.hasMaxSelections ? this.strings.maxSelectionsAriaLabel : '';\n\n    const searchIcon = html`<span class=\"search-icon\">${getSvg(SvgIcon.Search)}</span>`;\n    const startSlot = this.selectedPeople?.length > 0 ? selectedPeopleTemplate : searchIcon;\n    return html`\n      <fluent-text-field\n        autocomplete=\"off\"\n        appearance=\"outline\"\n        slot=\"anchor\"\n        id=\"people-picker-input\"\n        role=\"combobox\"\n        placeholder=${this.hasMaxSelections ? this.strings.maxSelectionsPlaceHolder : placeholder}\n        aria-label=${this.ariaLabel || maxSelectionsAriaLabel || placeholder || this.strings.selectContact}\n        aria-expanded=${this.flyout?.isOpen ?? false}\n        @click=\"${this.hasMaxSelections ? undefined : this.handleInputClick}\"\n        @focus=\"${this.hasMaxSelections ? undefined : this.gainedFocus}\"\n        @keydown=\"${this.hasMaxSelections ? undefined : this.onUserKeyDown}\"\n        @input=\"${this.hasMaxSelections ? undefined : this.onUserInput}\"\n        @blur=\"${this.lostFocus}\"\n        ?disabled=${this.disabled}\n      >\n        <span slot=\"start\">${startSlot}</span>\n      </fluent-text-field>\n    `;\n  }\n\n  /**\n   * Render the selected people tokens.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderSelectedPeople(selectedPeople?: IDynamicPerson[]): TemplateResult {\n    if (!selectedPeople?.length) {\n      return html``;\n    }\n\n    return html`\n       <ul\n        id=\"selected-list\"\n        aria-label=\"${this.strings.selected}\"\n        class=\"selected-list\">\n          ${repeat(\n            selectedPeople,\n            person => person?.id,\n            person => html`\n            <li class=\"selected-list-item\">\n              ${\n                this.renderTemplate(\n                  'selected-person',\n                  { person },\n                  `selected-${person?.id ? person.id : person.displayName}`\n                ) || this.renderSelectedPerson(person)\n              }\n\n              <div\n                role=\"button\"\n                tabindex=\"0\"\n                class=\"selected-list-item-close-icon\"\n                aria-label=\"${this.strings.removeSelectedUser}${person?.displayName ?? ''}\"\n                @click=\"${(e: UIEvent) => this.removePerson(person, e)}\"\n                @keydown=\"${(e: KeyboardEvent) => this.handleRemovePersonKeyDown(person, e)}\">\n                  ${getSvg(SvgIcon.Close)}\n              </div>\n          </li>`\n          )}\n      </ul>`;\n  }\n  /**\n   * Render the flyout chrome.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderFlyout(anchor: TemplateResult): TemplateResult {\n    return mgtHtml`\n       <mgt-flyout light-dismiss class=\"flyout\">\n         ${anchor}\n         <fluent-card\n          tabindex=\"0\"\n          slot=\"flyout\"\n          class=\"flyout-root\"\n          @wheel=${(e: WheelEvent) => this.handleSectionScroll(e)}\n          @keydown=${(e: KeyboardEvent) => this.onUserKeyDown(e)}\n          class=\"custom\">\n           ${this.renderFlyoutContent()}\n         </fluent-card>\n       </mgt-flyout>\n     `;\n  }\n\n  /**\n   * Render the appropriate state in the results flyout.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderFlyoutContent(): TemplateResult {\n    if (this.isLoadingState || this._showLoading) {\n      return this.renderLoading();\n    }\n\n    const people = this._foundPeople;\n\n    if (!people || people.length === 0 || this.showMax === 0) {\n      return this.renderNoData();\n    } else {\n      return this.renderSearchResults(people);\n    }\n  }\n\n  /**\n   * Render the loading state.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtPeoplePicker\n   */\n  protected renderLoading(): TemplateResult {\n    return (\n      this.renderTemplate('loading', null) ||\n      mgtHtml`\n         <div class=\"message-parent\">\n           <mgt-spinner></mgt-spinner>\n           <div aria-label=\"${this.strings.loadingMessage}\" class=\"loading-text\">\n             ${this.strings.loadingMessage}\n           </div>\n         </div>\n       `\n    );\n  }\n\n  /**\n   * Render the state when no results are found for the search query.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderNoData(): TemplateResult {\n    if (!this._isFocused) {\n      return;\n    }\n    return (\n      this.renderTemplate('error', null) ||\n      this.renderTemplate('no-data', null) ||\n      html`\n         <div class=\"message-parent\">\n           <div aria-label=${this.strings.noResultsFound} class=\"search-error-text\">\n             ${this.strings.noResultsFound}\n           </div>\n         </div>\n       `\n    );\n  }\n\n  /**\n   * Render the list of search results.\n   *\n   * @protected\n   * @param {IDynamicPerson[]} people\n   * @returns\n   * @memberof MgtPeoplePicker\n   */\n  protected renderSearchResults(people: IDynamicPerson[]) {\n    const filteredPeople = people.filter(person => person.id);\n    return html`\n      <ul\n        id=\"suggestions-list\"\n        class=\"searched-people-list\"\n        role=\"listbox\"\n        aria-live=\"polite\"\n        title=${this.strings.suggestionsTitle}\n      >\n         ${repeat(\n           filteredPeople,\n           person => person.id,\n           person => html`\n            <li\n              id=\"${person.id}\"\n              class=\"searched-people-list-result\"\n              role=\"option\"\n              @click=\"${() => this.handleSuggestionClick(person)}\">\n                ${this.renderPersonResult(person)}\n            </li>\n          `\n         )}\n       </ul>\n     `;\n  }\n\n  /**\n   * Render an individual person search result.\n   *\n   * @protected\n   * @param {IDynamicPerson} person\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderPersonResult(person: IDynamicPerson): TemplateResult {\n    return (\n      this.renderTemplate('person', { person }, person.id) ||\n      mgtHtml`\n         <mgt-person\n          class=\"person\"\n          ?show-presence=${this.showPresence}\n          view=\"twoLines\"\n          line2-property=\"jobTitle,mail\"\n          .personDetails=${person}\n          .fetchImage=${!this.disableImages}>\n          .personCardInteraction=${PersonCardInteraction.none}\n        </mgt-person>`\n    );\n  }\n\n  /**\n   * Render an individual selected person token.\n   *\n   * @protected\n   * @param {IDynamicPerson} person\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderSelectedPerson(person: IDynamicPerson): TemplateResult {\n    return mgtHtml`\n       <mgt-person\n         tabindex=\"-1\"\n         class=\"selected-list-item-person\"\n         .personDetails=${person}\n         .fetchImage=${!this.disableImages}\n         .view=${ViewType.oneline}\n         .personCardInteraction=${PersonCardInteraction.none}>\n        </mgt-person>\n     `;\n  }\n\n  /**\n   * Async query to Graph for members of group if determined by developer.\n   * set's `this.groupPeople` to those members.\n   */\n  protected async loadState(): Promise<void> {\n    let people = this.people;\n    const input = this.userInput.toLowerCase();\n    const provider = Providers.globalProvider;\n\n    if (people) {\n      if (input) {\n        const displayNameMatch = people.filter(person => person?.displayName.toLowerCase().includes(input));\n        people = displayNameMatch;\n      }\n      this._showLoading = false;\n    } else if (!people && provider && provider.state === ProviderState.SignedIn) {\n      const graph = provider.graph.forComponent(this);\n\n      if (!input.length) {\n        if (this.defaultPeople) {\n          people = this.defaultPeople;\n        } else {\n          if (this.groupId || this.groupIds) {\n            if (this._groupPeople === null) {\n              if (this.groupId) {\n                try {\n                  if (this.type === PersonType.group) {\n                    this._groupPeople = await findGroupMembers(\n                      graph,\n                      null,\n                      this.groupId,\n                      this.showMax,\n                      this.type,\n                      this.transitiveSearch\n                    );\n                  } else {\n                    this._groupPeople = await findGroupMembers(\n                      graph,\n                      null,\n                      this.groupId,\n                      this.showMax,\n                      this.type,\n                      this.transitiveSearch,\n                      this.userFilters,\n                      this.peopleFilters\n                    );\n                  }\n                } catch (_) {\n                  this._groupPeople = [];\n                }\n              } else if (this.groupIds) {\n                if (this.type === PersonType.group) {\n                  try {\n                    this._groupPeople = await getGroupsForGroupIds(graph, this.groupIds, this.groupFilters);\n                  } catch (_) {\n                    this._groupPeople = [];\n                  }\n                } else {\n                  try {\n                    const peopleInGroups = await findUsersFromGroupIds(\n                      graph,\n                      '',\n                      this.groupIds,\n                      this.showMax,\n                      this.type,\n                      this.transitiveSearch,\n                      this.userFilters\n                    );\n                    this._groupPeople = peopleInGroups;\n                  } catch (_) {\n                    this._groupPeople = [];\n                  }\n                }\n              }\n            }\n            people = this._groupPeople || [];\n          } else if (this.type === PersonType.person || this.type === PersonType.any) {\n            if (this.userIds) {\n              people = await getUsersForUserIds(graph, this.userIds, '', this.userFilters);\n            } else {\n              const isUserOrContactType = this.userType === UserType.user || this.userType === UserType.contact;\n              if (this._userFilters && isUserOrContactType) {\n                people = await getUsers(graph, this._userFilters, this.showMax);\n              } else {\n                people = await getPeople(graph, this.userType, this._peopleFilters, this.showMax);\n              }\n            }\n          } else if (this.type === PersonType.group) {\n            if (this.groupIds) {\n              try {\n                people = await this.getGroupsForGroupIds(graph, people);\n              } catch (_) {\n                // nop\n              }\n            } else {\n              let groups = (await findGroups(graph, '', this.showMax, this.groupType, this._groupFilters)) || [];\n              // eslint-disable-next-line @typescript-eslint/dot-notation\n              if (groups.length > 0 && groups[0]['value']) {\n                // eslint-disable-next-line @typescript-eslint/dot-notation, @typescript-eslint/no-unsafe-assignment\n                groups = groups[0]['value'];\n              }\n              people = groups;\n            }\n          }\n          this.defaultPeople = people;\n        }\n        if (this._isFocused) {\n          this._showLoading = false;\n        }\n      }\n\n      if (\n        (this.defaultSelectedUserIds?.length > 0 || this.defaultSelectedGroupIds?.length > 0) &&\n        !this.selectedPeople.length &&\n        !this.defaultSelectedUsers.length &&\n        !this.defaultSelectedGroups.length\n      ) {\n        this.defaultSelectedUsers = await getUsersForUserIds(graph, this.defaultSelectedUserIds, '', this.userFilters);\n        this.defaultSelectedGroups = await getGroupsForGroupIds(\n          graph,\n          this.defaultSelectedGroupIds,\n          this.peopleFilters\n        );\n\n        this.defaultSelectedGroups = this.defaultSelectedGroups.filter(group => {\n          return group !== null;\n        });\n\n        this.defaultSelectedUsers = this.defaultSelectedUsers.filter(user => {\n          return user !== null;\n        });\n\n        this.selectedPeople = [...this.defaultSelectedUsers, ...this.defaultSelectedGroups];\n        this.requestUpdate();\n      }\n\n      if (input) {\n        people = [];\n\n        if (this.groupId) {\n          people =\n            (await findGroupMembers(\n              graph,\n              input,\n              this.groupId,\n              this.showMax,\n              this.type,\n              this.transitiveSearch,\n              this.userFilters,\n              this.peopleFilters\n            )) || [];\n        } else {\n          if (this.type === PersonType.person || this.type === PersonType.any) {\n            try {\n              // Default UserType === any\n              if (this.userType === UserType.contact || this.userType === UserType.user) {\n                // we might have a user-filters property set, search for users with it.\n                if (this.userIds?.length) {\n                  // has the user-ids proerty set\n                  people = await getUsersForUserIds(graph, this.userIds, input, this._userFilters);\n                } else {\n                  people = await findUsers(graph, input, this.showMax, this._userFilters);\n                }\n              } else {\n                if (!this.groupIds) {\n                  if (this.userIds?.length) {\n                    // has the user-ids proerty set\n                    people = await getUsersForUserIds(graph, this.userIds, input, this._userFilters);\n                  } else {\n                    people = (await findPeople(graph, input, this.showMax, this.userType, this._peopleFilters)) || [];\n                  }\n                } else {\n                  // Does not work when the PersonType = person.\n                  try {\n                    people = await findUsersFromGroupIds(\n                      graph,\n                      input,\n                      this.groupIds,\n                      this.showMax,\n                      this.type,\n                      this.transitiveSearch,\n                      this.userFilters\n                    );\n                  } catch (_) {\n                    // nop\n                  }\n                }\n              }\n            } catch (e) {\n              // nop\n            }\n\n            // Don't follow this path if a people-filters attribute is set on the component as the\n            // default type === PersonType.person\n            if (\n              people &&\n              people.length < this.showMax &&\n              this.userType !== UserType.contact &&\n              this.type !== PersonType.person\n            ) {\n              try {\n                const users = (await findUsers(graph, input, this.showMax, this._userFilters)) || [];\n\n                // make sure only unique people\n                const peopleIds = new Set(people.map(p => p.id));\n                for (const user of users) {\n                  if (!peopleIds.has(user.id)) {\n                    people.push(user);\n                  }\n                }\n              } catch (e) {\n                // no-op\n              }\n            }\n          }\n\n          if ((this.type === PersonType.group || this.type === PersonType.any) && people.length < this.showMax) {\n            if (this.groupIds) {\n              try {\n                people = await findGroupsFromGroupIds(\n                  graph,\n                  input,\n                  this.groupIds,\n                  this.showMax,\n                  this.groupType,\n                  this.userFilters\n                );\n              } catch (_) {\n                // no-op\n              }\n            } else {\n              let groups = [];\n              try {\n                groups = (await findGroups(graph, input, this.showMax, this.groupType, this._groupFilters)) || [];\n                people = people.concat(groups);\n              } catch (e) {\n                // nop\n              }\n            }\n          }\n        }\n      }\n    }\n    // people = this.getUniquePeople(people);\n    this._foundPeople = this.filterPeople(people);\n  }\n\n  /**\n   * Gets the Groups in a list of group IDs.\n   *\n   * @param graph the graph object\n   * @param people already found groups\n   * @returns groups found\n   */\n  private async getGroupsForGroupIds(graph: IGraph, people: IDynamicPerson[]) {\n    const groups = await getGroupsForGroupIds(graph, this.groupIds, this.groupFilters);\n    for (const group of groups as IDynamicPerson[]) {\n      people = people.concat(group);\n    }\n    people = people.filter(person => person);\n    return people;\n  }\n\n  /**\n   * Hide the results flyout.\n   *\n   * @protected\n   * @memberof MgtPeoplePicker\n   */\n  protected hideFlyout(): void {\n    const flyout = this.flyout;\n    if (flyout) {\n      flyout.close();\n    }\n    if (this.input) {\n      this.input.setAttribute('aria-activedescendant', '');\n    }\n    this._arrowSelectionCount = -1;\n  }\n\n  /**\n   * Show the results flyout.\n   *\n   * @protected\n   * @memberof MgtPeoplePicker\n   */\n  protected showFlyout(): void {\n    const flyout = this.flyout;\n    if (flyout) {\n      flyout.open();\n    }\n    this._arrowSelectionCount = -1;\n  }\n\n  /**\n   * Removes person from selected people\n   *\n   * @param person - person and details pertaining to user selected\n   */\n  protected removePerson(person: IDynamicPerson, e: UIEvent): void {\n    e.stopPropagation();\n    const filteredPersonArr = this.selectedPeople.filter(p => {\n      if (!person.id && p.displayName) {\n        return p.displayName !== person.displayName;\n      }\n      return p.id !== person.id;\n    });\n    if (this.hasMaxSelections) {\n      this.enableTextInput();\n    }\n    this.selectedPeople = filteredPersonArr;\n    void this.loadState();\n  }\n\n  /**\n   * Checks if key pressed is an `Enter` key before removing person\n   *\n   * @param person\n   * @param e\n   */\n  protected handleRemovePersonKeyDown(person: IDynamicPerson, e: KeyboardEvent): void {\n    if (e.key === 'Enter') {\n      this.removePerson(person, e);\n    }\n  }\n\n  /**\n   * Tracks when user selects person from picker\n   *\n   * @param person - contains details pertaining to selected user\n   * @param event - tracks user event\n   */\n  protected addPerson(person: IDynamicPerson): void {\n    if (person) {\n      setTimeout(() => {\n        this.clearInput();\n      }, 50);\n      const duplicatePeople = this.selectedPeople.filter(p => {\n        if (!person.id && p.displayName) {\n          return p.displayName === person.displayName;\n        }\n        return p.id === person.id;\n      });\n\n      if (duplicatePeople.length === 0) {\n        this.selectedPeople = [...this.selectedPeople, person];\n        void this.loadState();\n        this._foundPeople = [];\n        this._arrowSelectionCount = -1;\n      }\n    }\n  }\n\n  private clearInput() {\n    this.clearHighlighted();\n    if (this.selectionMode !== 'single') {\n      this.input.value = '';\n    }\n    this.userInput = '';\n  }\n\n  // handle input click\n  private readonly handleInputClick = () => {\n    if (!this.flyout.isOpen) {\n      this.handleUserSearch();\n    }\n  };\n\n  // handle input focus\n  private readonly gainedFocus = () => {\n    this.clearHighlighted();\n    this._isFocused = true;\n    void this.loadState();\n    this.showFlyout();\n  };\n\n  // handle input blur\n  private readonly lostFocus = () => {\n    this._isFocused = false;\n    if (this.input) {\n      this.input.setAttribute('aria-activedescendant', '');\n    }\n\n    const peopleList = this.renderRoot.querySelector('.people-list');\n\n    if (peopleList) {\n      for (const el of peopleList.children) {\n        el.classList.remove('focused');\n        el.setAttribute('aria-selected', 'false');\n      }\n    }\n\n    this.requestUpdate();\n  };\n\n  /**\n   * Handles input from the key up events on the keyboard.\n   */\n  private readonly onUserKeyUp = (event: KeyboardEvent): void => {\n    const keyName = event.key;\n    const isCmdOrCtrlKey = event.getModifierState('Control') || event.getModifierState('Meta');\n    const isPaste = isCmdOrCtrlKey && keyName === 'v';\n    const isArrowKey = ['ArrowDown', 'ArrowRight', 'ArrowUp', 'ArrowLeft'].includes(keyName);\n\n    if ((!isPaste && isCmdOrCtrlKey) || isArrowKey) {\n      if (isCmdOrCtrlKey || ['ArrowLeft', 'ArrowRight'].includes(keyName)) {\n        // Only hide the flyout when you're doing selections with Left/Right Arrow key\n        this.hideFlyout();\n      }\n\n      if (keyName === 'ArrowDown') {\n        if (!this.flyout.isOpen && this._isFocused) {\n          this.handleUserSearch();\n        }\n      }\n      return;\n    }\n\n    if (['Tab', 'Enter', 'Shift'].includes(keyName)) return;\n\n    if (keyName === 'Escape') {\n      this.clearInput();\n      this._foundPeople = [];\n      this._arrowSelectionCount = -1;\n      return;\n    }\n\n    if (keyName === 'Backspace' && this.userInput.length === 0 && this.selectedPeople.length > 0) {\n      this.clearHighlighted();\n      // remove last person in selected list\n      this.selectedPeople = this.selectedPeople.splice(0, this.selectedPeople.length - 1);\n      void this.loadState();\n      this.hideFlyout();\n      return;\n    }\n\n    if ([';', ','].includes(keyName)) {\n      if (this.allowAnyEmail) {\n        this._setAnyEmail = true;\n        event.preventDefault();\n        event.stopPropagation();\n      }\n      return;\n    }\n  };\n\n  private readonly onUserInput = (event: InputEvent) => {\n    const input = event.target as HTMLInputElement;\n    this.userInput = input.value;\n    if (this.userInput) {\n      const validEmail = isValidEmail(this.userInput);\n      if (validEmail && this.allowAnyEmail) {\n        if (this._setAnyEmail) {\n          this.handleAnyEmail();\n        }\n      } else {\n        this.handleUserSearch();\n      }\n      this._setAnyEmail = false;\n    }\n  };\n\n  private handleAnyEmail() {\n    this._showLoading = false;\n    this._arrowSelectionCount = -1;\n    if (isValidEmail(this.userInput)) {\n      const anyMailUser = {\n        mail: this.userInput,\n        displayName: this.userInput\n      };\n      this.addPerson(anyMailUser);\n    }\n    this.hideFlyout();\n    if (this.input) {\n      this.input.focus();\n      this._isFocused = true;\n    }\n  }\n\n  // handle suggestion list item click\n  private handleSuggestionClick(person: IDynamicPerson): void {\n    this.addPerson(person);\n    if (this.hasMaxSelections) {\n      this.disableTextInput();\n      this.input.value = '';\n    }\n    this.hideFlyout();\n  }\n\n  /**\n   * Tracks event on user input in search\n   *\n   * @param input - input text\n   */\n  private handleUserSearch() {\n    if (!this._debouncedSearch) {\n      this._debouncedSearch = debounce(async () => {\n        const loadingTimeout = setTimeout(() => {\n          this._showLoading = true;\n        }, 50);\n\n        await this.loadState();\n        clearTimeout(loadingTimeout);\n        this._showLoading = false;\n        this._arrowSelectionCount = -1;\n        this.showFlyout();\n      }, 400);\n    }\n\n    this._debouncedSearch();\n  }\n\n  /**\n   * Tracks event on user search (keydown)\n   *\n   * @param event - event tracked on user input (keydown)\n   */\n  private readonly onUserKeyDown = (event: KeyboardEvent): void => {\n    const keyName = event.key;\n    const selectedList = this.renderRoot.querySelector('.selected-list');\n    const isCmdOrCtrlKey = event.getModifierState('Control') || event.getModifierState('Meta');\n    if (isCmdOrCtrlKey && selectedList) {\n      const selectedPeople = selectedList.querySelectorAll('mgt-person.selected-list-item-person');\n      this.hideFlyout();\n      if (isCmdOrCtrlKey && keyName === 'ArrowLeft') {\n        this._currentHighlightedUserPos =\n          (this._currentHighlightedUserPos - 1 + selectedPeople.length) % selectedPeople.length;\n        if (this._currentHighlightedUserPos >= 0 && !Number.isNaN(this._currentHighlightedUserPos)) {\n          this._highlightedUsers.push(selectedPeople[this._currentHighlightedUserPos]);\n        } else {\n          this._currentHighlightedUserPos = 0;\n        }\n      } else if (isCmdOrCtrlKey && keyName === 'ArrowRight') {\n        const person = this._highlightedUsers.pop();\n        if (person) {\n          const personParent = person.parentElement;\n          if (personParent) {\n            this.clearHighlighted(personParent);\n            this._currentHighlightedUserPos++;\n          }\n        }\n      } else if (isCmdOrCtrlKey && keyName === 'a') {\n        this._highlightedUsers = [];\n        selectedPeople.forEach(person => this._highlightedUsers.push(person));\n      }\n      if (this._highlightedUsers) {\n        this.highlightSelectedPeople(this._highlightedUsers);\n      }\n      return;\n    }\n\n    this.clearHighlighted();\n\n    if (!this.flyout.isOpen) {\n      return;\n    }\n\n    if (keyName === 'ArrowUp' || keyName === 'ArrowDown') {\n      this.handleArrowSelection(event);\n      event.preventDefault();\n    }\n\n    if (keyName === 'Enter') {\n      if (!event.shiftKey && this._foundPeople) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const foundPerson = this._foundPeople[this._arrowSelectionCount];\n        if (foundPerson) {\n          this.addPerson(foundPerson);\n          this.hideFlyout();\n          this.input.value = '';\n          if (this.hasMaxSelections) {\n            this.disableTextInput();\n          }\n        }\n      } else if (this.allowAnyEmail) {\n        this.handleAnyEmail();\n      } else {\n        this.showFlyout();\n      }\n    }\n\n    if (keyName === 'Escape') {\n      event.stopPropagation();\n    }\n\n    if (keyName === 'Tab') {\n      this.hideFlyout();\n    }\n\n    if ([';', ','].includes(keyName)) {\n      if (this.allowAnyEmail) {\n        event.preventDefault();\n        event.stopPropagation();\n        this.userInput = this.input.value;\n        this.handleAnyEmail();\n      }\n    }\n  };\n\n  /**\n   * Gets the text of the highlighed people and writes it to the clipboard\n   */\n  private async writeHighlightedText() {\n    const copyText = [];\n    for (const element of this._highlightedUsers) {\n      // eslint-disable-next-line @typescript-eslint/dot-notation\n      const { id, displayName, mail, userPrincipalName, scoredEmailAddresses } = element['_personDetails'] as Person &\n        User;\n      let emailAddress: string;\n      if (scoredEmailAddresses && scoredEmailAddresses.length > 0) {\n        emailAddress = scoredEmailAddresses.pop().address;\n      } else {\n        emailAddress = userPrincipalName || mail;\n      }\n\n      copyText.push({ id, displayName, email: emailAddress });\n    }\n    let copiedTextStr = '';\n    if (copyText.length > 0) {\n      copiedTextStr = JSON.stringify(copyText);\n    }\n\n    await navigator.clipboard.writeText(copiedTextStr);\n  }\n\n  /**\n   * Handles the cut event when it is fired\n   */\n  private readonly handleCut = () => {\n    this.writeHighlightedText().then(\n      () => {\n        this.removeHighlightedOnCut();\n      },\n      () => {\n        // intentionally left blank\n      }\n    );\n  };\n\n  /**\n   * Handles the copy event when it is fired\n   */\n  private readonly handleCopy = () => {\n    void this.writeHighlightedText();\n  };\n\n  /**\n   * Parses the copied people text and adds them when you paste\n   */\n  private readonly handlePaste = () => {\n    navigator.clipboard.readText().then(\n      copiedText => {\n        if (copiedText) {\n          try {\n            const people: IDynamicPerson[] = JSON.parse(copiedText) as IDynamicPerson[];\n            if (people && people.length > 0) {\n              for (const person of people) {\n                this.addPerson(person);\n              }\n            }\n          } catch (error) {\n            if (error instanceof SyntaxError) {\n              const delimiters = [',', ';'];\n              let listOfUsers: string[];\n              try {\n                for (const delimiter of delimiters) {\n                  listOfUsers = copiedText.split(delimiter);\n                  if (listOfUsers.length > 1) {\n                    this.hideFlyout();\n                    void this.selectUsersById(listOfUsers);\n                    break;\n                  }\n                }\n                // eslint-disable-next-line no-empty\n              } catch (_) {}\n            }\n          }\n        }\n      },\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      error => {\n        // 'navigator.clipboard.readText is not a function' error is thrown in Mozilla\n        // more information here https://developer.mozilla.org/en-US/docs/Web/API/Clipboard/readText#browser_compatibility\n        // Firefox only supports reading the clipboard in browser extensions,\n        // using the \"clipboardRead\" extension permission.\n      }\n    );\n  };\n\n  /**\n   * Removes only the highlighted elements from the peoplePicker during cut operations.\n   */\n  private removeHighlightedOnCut() {\n    this.selectedPeople = this.selectedPeople.splice(0, this.selectedPeople.length - this._highlightedUsers.length);\n    this._highlightedUsers = [];\n    this._currentHighlightedUserPos = 0;\n    void this.loadState();\n    this.hideFlyout();\n  }\n  /**\n   * Changes the color class to show which people are selected for copy/cut-paste\n   *\n   * @param people list of selected people classes\n   */\n  private highlightSelectedPeople(people: Element[]) {\n    for (const person of people) {\n      const parentElement = person?.parentElement;\n      parentElement.classList.add('highlighted');\n    }\n  }\n\n  /**\n   * Defaults the people class back to the normal view\n   */\n  private clearHighlighted(node?: Element) {\n    if (node) {\n      node.classList.remove('highlighted');\n    } else {\n      for (const person of this._highlightedUsers) {\n        const parentElement = person.parentElement;\n        if (parentElement) {\n          parentElement.classList.remove('highlighted');\n        }\n      }\n      this._highlightedUsers = [];\n      this._currentHighlightedUserPos = 0;\n    }\n  }\n\n  /**\n   * Tracks user key selection for arrow key selection of people\n   *\n   * @param event - tracks user key selection\n   */\n  private handleArrowSelection(event?: KeyboardEvent): void {\n    const peopleList = this.renderRoot.querySelector('.searched-people-list');\n\n    if (peopleList?.children?.length) {\n      if (event) {\n        // update arrow count\n        if (event.key === 'ArrowUp') {\n          if (this._arrowSelectionCount === -1) {\n            this._arrowSelectionCount = 0;\n          } else {\n            this._arrowSelectionCount =\n              (this._arrowSelectionCount - 1 + peopleList.children.length) % peopleList.children.length;\n          }\n        }\n        if (event.key === 'ArrowDown') {\n          if (this._arrowSelectionCount === -1) {\n            this._arrowSelectionCount = 0;\n          } else {\n            this._arrowSelectionCount =\n              (this._arrowSelectionCount + 1 + peopleList.children.length) % peopleList.children.length;\n          }\n        }\n      }\n\n      for (const person of peopleList?.children ?? []) {\n        const p = person as HTMLElement;\n        p.setAttribute('aria-selected', 'false');\n        p.blur();\n        p.removeAttribute('tabindex');\n      }\n\n      // set selected background\n      // set aria-selected to true\n      const focusedItem = peopleList.children[this._arrowSelectionCount] as HTMLElement;\n\n      if (focusedItem) {\n        focusedItem.setAttribute('tabindex', '0');\n        focusedItem.focus();\n        focusedItem.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });\n        focusedItem.setAttribute('aria-selected', 'true');\n        this.input.setAttribute('aria-activedescendant', focusedItem?.id);\n      }\n    }\n  }\n\n  /**\n   * Filters people searched from already selected people\n   *\n   * @param people - array of people returned from query to Graph\n   */\n  private filterPeople(people: IDynamicPerson[]): IDynamicPerson[] {\n    // check if people need to be updated\n    // ensuring people list is displayed\n    // find ids from selected people\n    const uniquePeople: IDynamicPerson[] = [];\n    if (people && people.length > 0) {\n      people = people.filter(person => person);\n      const idFilter = this.selectedPeople.map(el => {\n        return el.id ? el.id : el.displayName;\n      });\n\n      // filter id's\n      const filtered = people.filter((person: IDynamicPerson) => {\n        if (person?.id) {\n          return idFilter.indexOf(person.id) === -1;\n        } else {\n          return idFilter.indexOf(person?.displayName) === -1;\n        }\n      });\n\n      // remove duplicates\n      const dupsSet = new Set<string>();\n      for (const d of filtered) {\n        const person = JSON.stringify(d);\n        dupsSet.add(person);\n      }\n\n      dupsSet.forEach((person: string) => {\n        const p: IDynamicPerson = JSON.parse(person) as IDynamicPerson;\n        uniquePeople.push(p);\n      });\n    }\n    return uniquePeople;\n  }\n\n  // stop propagating wheel event to flyout so mouse scrolling works\n  private handleSectionScroll(e: WheelEvent) {\n    const target = this.renderRoot.querySelector('.flyout-root');\n    if (target) {\n      if (\n        !(e.deltaY < 0 && target.scrollTop === 0) &&\n        !(e.deltaY > 0 && target.clientHeight + target.scrollTop >= target.scrollHeight - 1)\n      ) {\n        e.stopPropagation();\n      }\n    }\n  }\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{background-color:var(--tasks-background-color,transparent);padding:var(--tasks-padding,12px);border:var(--tasks-border,0);border-radius:var(--tasks-border-radius,0);font-family:var(--default-font-family);--skeleton-fill:var(--neutral-foreground-active)}:host .header{display:flex;align-items:center;justify-content:space-between;padding:var(--tasks-header-padding,0 0 14px 0);margin:var(--tasks-header-padding,0 0 14px 0);font-size:var(--tasks-header-font-size,16px);font-weight:var(--tasks-header-font-weight,600);color:var(--tasks-header-text-color,var(--neutral-foreground-hint))}:host .header:hover{color:var(--tasks-header-text-hover-color,var(--neutral-foreground-hover))}:host .header .title{justify-content:left;display:flex;align-items:center}:host .header .title .shimmer{width:80px;height:20px}:host .header .title svg{margin-top:3px;padding:0 4px;width:16px;height:16px}:host .header .new-task-button{justify-content:right}:host .header .new-task-button .shimmer{width:40px;height:24px}:host .header .new-task-button::part(control){font-weight:var(--tasks-new-button-text-font-weight,700);color:var(--tasks-new-button-text-color,var(--foreground-on-accent-rest));width:var(--tasks-new-button-width,none);height:var(--tasks-new-button-height,none);background:var(--tasks-new-button-background,padding-box linear-gradient(var(--accent-fill-rest),var(--accent-fill-rest)),border-box var(--accent-stroke-control-rest))}:host .header .new-task-button::part(control):hover{background:var(--tasks-new-button-background-hover,var(--accent-fill-hover))}:host .header .new-task-button::part(control):active{background:var(--tasks-new-button-background-active,var(--accent-fill-active))}:host .tasks{display:flex;flex-direction:column;row-gap:var(--tasks-gap,20px)}:host .tasks .task{display:flex;column-gap:4px;align-items:flex-start;justify-content:space-between}:host .tasks .task.updating{background:var(--neutral-stroke-rest)!important;pointer-events:none;opacity:.4}:host .tasks .task.complete{border:var(--task-complete-border,2px dotted var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-complete-background-color,transparent);padding:var(--task-complete-padding,10px)}:host .tasks .task.incomplete{border:var(--task-incomplete-border,1px solid var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-incomplete-background-color,var(--neutral-layer-1));padding:var(--task-incomplete-padding,10px)}:host .tasks .task .task-details-container{display:flex;flex-direction:column;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top{display:flex;justify-content:space-between;column-gap:4px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:row}:host .tasks .task .task-details-container .top .check-and-title{display:flex;align-items:flex-start;flex-direction:column;width:100%;row-gap:12px}:host .tasks .task .task-details-container .top .check-and-title.shimmer{display:flex;flex-direction:inherit;gap:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .checkbox{height:10px;width:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .title{height:10px;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content{display:grid;grid-template-columns:repeat(auto-fit,250px);gap:12px;justify-content:start;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content .picker{max-width:250px}:host .tasks .task .task-details-container .top .check-and-title .task-content .task-due fluent-text-field.dark::part(control){color-scheme:dark}:host .tasks .task .task-details-container .top .task-options .options{height:10px;width:20px}:host .tasks .task .task-details-container .top .task-options.new-task-action-buttons{display:flex;flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:column;grid-auto-columns:1fr;grid-column-gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket,:host .tasks .task .task-details-container .bottom .task-due,:host .tasks .task .task-details-container .bottom .task-group{display:flex;align-items:center;gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon{display:flex;place-content:center;width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon .shimmer.icon{width:20px;height:20px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg{width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg path{fill:var(--task-icons-background-color,var(--neutral-foreground-hint))}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text{color:var(--task-icons-text-font-color,var(--neutral-foreground-hint));font-size:var(--task-icons-text-font-size,12px);font-weight:var(--task-icons-text-font-weight,600);white-space:normal;width:100%}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details{display:flex;flex-direction:column;row-gap:8px}:host .tasks .task .task-details-container .task-details.shimmer{flex-direction:row;place-items:center;column-gap:6px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.icon{width:24px;height:24px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details .task-title{color:var(--foreground-on-neutral-rest)}:host .tasks .task .task-details-container .task-details .task-body{display:flex}:host fluent-button.add-task::part(control){font-weight:var(--task-add-new-button-text-font-weight,initial);color:var(--task-add-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-add-new-button-width,none);height:var(--task-add-new-button-height,none);background:var(--task-add-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-add-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.add-task::part(control):hover{background:var(--task-add-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.add-task::part(control):active{background:var(--task-add-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-button.cancel-task::part(control){font-weight:var(--task-cancel-new-button-text-font-weight,initial);color:var(--task-cancel-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-cancel-new-button-width,none);height:var(--task-cancel-new-button-height,none);background:var(--task-cancel-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-cancel-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.cancel-task::part(control):hover{background:var(--task-cancel-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.cancel-task::part(control):active{background:var(--task-cancel-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-option{background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-option:hover{background:var(--task-new-dropdown-option-hover-background-color,var(--neutral-fill-stealth-hover))}:host fluent-option::part(content){color:var(--task-new-dropdown-option-text-color,var(--neutral-foreground-rest))}:host fluent-select::part(listbox){background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-select::part(control){border:var(--task-new-dropdown-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-dropdown-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-dropdown-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-select::part(control):hover{background:var(--task-new-dropdown-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-select::part(control)::placeholder{color:var(--task-new-dropdown-placeholder-color,var(--input-placeholder-rest))}:host fluent-checkbox{padding-top:1px}:host fluent-checkbox::part(control){border-radius:50%;background:var(--task-incomplete-checkbox-background-color,var(--neutral-fill-input-alt-rest))}:host fluent-checkbox::part(control):hover{background:var(--task-incomplete-checkbox-background-hover-color,var(--neutral-fill-input-alt-hover))}:host fluent-checkbox::part(label){font-size:var(--task-title-text-font-size,medium);font-weight:var(--task-title-text-font-weight,600);color:var(--task-incomplete-title-text-color,var(var(--neutral-foreground-rest)))}:host fluent-checkbox.checked::part(control){background:var(--task-complete-checkbox-background-color,var(--accent-fill-rest));color:var(--task-complete-checkbox-text-color,currentColor)}:host fluent-checkbox.checked::part(label){text-decoration:line-through;color:var(--task-complete-title-text-color,var(--neutral-foreground-hint))}:host fluent-text-field.new-task{width:100%}:host fluent-text-field.new-task::part(root){border:var(--task-new-input-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-input-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-input-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-text-field.new-task::part(root):hover{background:var(--task-new-input-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-text-field.new-task::part(root)::placeholder{color:var(--task-new-input-placeholder-color,var(--input-placeholder-rest))}:host .people [slot=no-data] fluent-button::part(control){color:var(--task-new-person-icon-text-color,var(--neutral-foreground-hint))}:host .people [slot=no-data] svg{fill:var(--task-new-person-icon-color,var(--neutral-foreground-hint))}@media only screen and (width <= 600px){:host fluent-select{width:100%}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:row;grid-auto-columns:unset;row-gap:4px}:host .tasks .task .task-details-container .bottom .ask-bucket,:host .tasks .task .task-details-container .bottom .ask-due,:host .tasks .task .task-details-container .bottom .ask-group{margin-inline-start:8px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .top.add-new-task .check-and-title .task-content{display:grid;grid-auto-flow:row;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top.add-new-task .task-options.new-task-action-buttons{flex-direction:row;column-gap:4px}}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nexport const strings = {\n  removeTaskSubtitle: 'Delete Task',\n  cancelNewTaskSubtitle: 'Cancel',\n  newTaskPlaceholder: 'Adding a task...',\n  addTaskButtonSubtitle: 'Add',\n  due: 'Due ',\n  addTaskDate: 'Add the task date',\n  assign: 'Assign'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph, prepScopes } from '@microsoft/mgt-element';\nimport { PlannerAssignments, PlannerBucket, PlannerPlan, PlannerTask } from '@microsoft/microsoft-graph-types';\nimport { CollectionResponse } from '@microsoft/mgt-element';\nimport { ITask } from './task-sources';\n\n/**\n * async promise, allows developer to create new Planner task\n *\n * @param {IGraph} graph\n * @param {(PlannerTask)} newTask\n * @returns {Promise<any>}\n * @memberof Graph\n */\nexport const addPlannerTask = async (graph: IGraph, newTask: PlannerTask): Promise<PlannerTask> => {\n  return (await graph\n    .api('/planner/tasks')\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Group.ReadWrite.All'))\n    .post(newTask)) as PlannerTask;\n};\n\n/**\n * async promise, allows developer to assign people to task\n *\n * @param {IGraph} graph\n * @param {ITask} task\n * @param {PlannerAssignments} people\n * @returns {Promise<any>}\n * @memberof Graph\n */\nexport const assignPeopleToPlannerTask = async (\n  graph: IGraph,\n  task: ITask,\n  people: PlannerAssignments\n): Promise<void> => {\n  const details: PlannerTask = { assignments: people, appliedCategories: { category4: true } };\n  await setPlannerTaskDetails(graph, task, details);\n};\n\n/**\n * async promise, allows developer to remove Planner task associated with taskId\n *\n * @param {IGraph} graph\n * @param {ITask} task the task being removed.\n * @returns {Promise<any>}\n * @memberof Graph\n */\nexport const removePlannerTask = async (graph: IGraph, task: ITask): Promise<void> => {\n  await graph\n    .api(`/planner/tasks/${task.id}`)\n    .header('Cache-Control', 'no-store')\n    .header('If-Match', task.eTag)\n    .middlewareOptions(prepScopes('Group.ReadWrite.All'))\n    .delete();\n};\n\n/**\n * async promise, allows developer to set a task to complete, associated with taskId\n *\n * @param {IGraph} graph\n * @param {ITask} task\n * @returns {Promise<any>}\n * @memberof Graph\n */\nexport const setPlannerTaskComplete = async (graph: IGraph, task: ITask): Promise<void> => {\n  await setPlannerTaskDetails(graph, task, { percentComplete: 100 });\n};\n\n/**\n * async promise, allows developer to set a task to incomplete, associated with taskId\n *\n * @param {IGraph} graph\n * @param {ITask} task\n * @returns {Promise<any>}\n * @memberof Graph\n */\nexport const setPlannerTaskIncomplete = async (graph: IGraph, task: ITask): Promise<void> => {\n  await setPlannerTaskDetails(graph, task, { percentComplete: 0 });\n};\n\n/**\n * async promise, allows developer to set details of planner task associated with a taskId\n *\n * @param {IGraph} graph\n * @param {ITask} task\n * @param {PlannerTask} details\n * @returns {Promise<any>}\n * @memberof Graph\n */\nexport const setPlannerTaskDetails = async (graph: IGraph, task: ITask, details: PlannerTask): Promise<PlannerTask> => {\n  let response: PlannerTask;\n  try {\n    response = (await graph\n      .api(`/planner/tasks/${task.id}`)\n      .header('Cache-Control', 'no-store')\n      .middlewareOptions(prepScopes('Group.ReadWrite.All'))\n      .header('Prefer', 'return=representation')\n      .header('If-Match', task.eTag)\n      .update(details)) as PlannerTask;\n  } catch (_) {\n    /* empty */\n  }\n  return response;\n};\n\n/**\n * async promise, returns all planner plans associated with the group id\n *\n * @param {IGraph} graph\n * @param {string} groupId\n * @returns {(Promise<PlannerPlan[]>)}\n * @memberof Graph\n */\nexport const getPlansForGroup = async (graph: IGraph, groupId: string): Promise<PlannerPlan[]> => {\n  const scopes = 'Group.Read.All';\n\n  const uri = `/groups/${groupId}/planner/plans`;\n  const plans = (await graph\n    .api(uri)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(scopes))\n    .get()) as CollectionResponse<PlannerPlan>;\n  return plans?.value;\n};\n\n/**\n * async promise, returns a single plan from the Graph associated with the planId\n *\n * @param {IGraph} graph\n * @param {string} planId\n * @returns {(Promise<PlannerPlan>)}\n * @memberof Graph\n */\nexport const getSinglePlannerPlan = async (graph: IGraph, planId: string): Promise<PlannerPlan> =>\n  (await graph\n    .api(`/planner/plans/${planId}`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Group.Read.All'))\n    .get()) as PlannerPlan;\n\n/**\n * async promise, returns bucket (for tasks) associated with a planId\n *\n * @param {IGraph} graph\n * @param {string} planId\n * @returns {(Promise<PlannerBucket[]>)}\n * @memberof Graph\n */\nexport const getBucketsForPlannerPlan = async (graph: IGraph, planId: string): Promise<PlannerBucket[]> => {\n  const buckets = (await graph\n    .api(`/planner/plans/${planId}/buckets`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Group.Read.All'))\n    .get()) as CollectionResponse<PlannerBucket>;\n\n  return buckets?.value;\n};\n\n/**\n * async promise, returns all planner plans associated with the user logged in\n *\n * @param {IGraph} graph\n * @returns {(Promise<PlannerPlan[]>)}\n * @memberof Graph\n */\nexport const getAllMyPlannerPlans = async (graph: IGraph): Promise<PlannerPlan[]> => {\n  const plans = (await graph\n    .api('/me/planner/plans')\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Group.Read.All'))\n    .get()) as CollectionResponse<PlannerPlan>;\n\n  return plans?.value;\n};\n\n/**\n * async promise, returns all tasks from planner associated with a bucketId\n *\n * @param {IGraph} graph\n * @param {string} bucketId\n * @returns {(Promise<PlannerTask[][]>)}\n * @memberof Graph\n */\nexport const getTasksForPlannerBucket = async (graph: IGraph, bucketId: string): Promise<PlannerTask[]> => {\n  const tasks = (await graph\n    .api(`/planner/buckets/${bucketId}/tasks`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Group.Read.All'))\n    .get()) as CollectionResponse<PlannerTask>;\n\n  return tasks?.value;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph, prepScopes } from '@microsoft/mgt-element';\nimport { OutlookTask, OutlookTaskFolder, OutlookTaskGroup } from '@microsoft/microsoft-graph-types-beta';\nimport { CollectionResponse } from '@microsoft/mgt-element';\n\n/**\n * async promise, allows developer to add new to-do task\n *\n * @param {*} newTask\n * @returns {Promise<OutlookTask>}\n * @memberof BetaGraph\n */\nexport const addTodoTask = async (graph: IGraph, newTask: OutlookTask): Promise<OutlookTask> => {\n  const { parentFolderId = null } = newTask;\n\n  if (parentFolderId) {\n    return (await graph\n      .api(`/me/outlook/taskFolders/${parentFolderId}/tasks`)\n      .header('Cache-Control', 'no-store')\n      .middlewareOptions(prepScopes('Tasks.ReadWrite'))\n      .post(newTask)) as OutlookTask;\n  } else {\n    return (await graph\n      .api('/me/outlook/tasks')\n      .header('Cache-Control', 'no-store')\n      .middlewareOptions(prepScopes('Tasks.ReadWrite'))\n      .post(newTask)) as OutlookTask;\n  }\n};\n\n/**\n * async promise, returns all Outlook taskGroups associated with the logged in user\n *\n * @returns {Promise<OutlookTaskGroup[]>}\n * @memberof BetaGraph\n */\nexport const getAllMyTodoGroups = async (graph: IGraph): Promise<OutlookTaskGroup[]> => {\n  const groups = (await graph\n    .api('/me/outlook/taskGroups')\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Tasks.Read'))\n    .get()) as CollectionResponse<OutlookTaskGroup>;\n\n  return groups?.value;\n};\n\n/**\n * async promise, returns all Outlook tasks associated with a taskFolder with folderId\n *\n * @param {string} folderId\n * @returns {Promise<OutlookTask[]>}\n * @memberof BetaGraph\n */\nexport const getAllTodoTasksForFolder = async (graph: IGraph, folderId: string): Promise<OutlookTask[]> => {\n  const tasks = (await graph\n    .api(`/me/outlook/taskFolders/${folderId}/tasks`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Tasks.Read'))\n    .get()) as CollectionResponse<OutlookTask>;\n\n  return tasks?.value;\n};\n\n/**\n * async promise, returns all Outlook taskFolders associated with groupId\n *\n * @param {string} groupId\n * @returns {Promise<OutlookTaskFolder[]>}\n * @memberof BetaGraph\n */\nexport const getFoldersForTodoGroup = async (graph: IGraph, groupId: string): Promise<OutlookTaskFolder[]> => {\n  const folders = (await graph\n    .api(`/me/outlook/taskGroups/${groupId}/taskFolders`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Tasks.Read'))\n    .get()) as CollectionResponse<OutlookTaskFolder>;\n\n  return folders?.value;\n};\n\n/**\n * async promise, returns to-do tasks from Outlook groups associated with a groupId\n *\n * @param {string} groupId\n * @returns {Promise<OutlookTaskGroup>}\n * @memberof BetaGraph\n */\nexport const getSingleTodoGroup = async (graph: IGraph, groupId: string): Promise<OutlookTaskGroup> =>\n  (await graph\n    .api(`/me/outlook/taskGroups/${groupId}`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes('Tasks.Read'))\n    .get()) as OutlookTaskGroup;\n\n/**\n * async promise, allows developer to remove task based on taskId\n *\n * @param {string} taskId\n * @param {string} eTag\n * @returns {Promise<any>}\n * @memberof BetaGraph\n */\nexport const removeTodoTask = async (graph: IGraph, taskId: string, eTag: string): Promise<void> => {\n  await graph\n    .api(`/me/outlook/tasks/${taskId}`)\n    .header('Cache-Control', 'no-store')\n    .header('If-Match', eTag)\n    .middlewareOptions(prepScopes('Tasks.ReadWrite'))\n    .delete();\n};\n\n/**\n * async promise, allows developer to set to-do task to completed state\n *\n * @param {string} taskId\n * @param {string} eTag\n * @returns {Promise<OutlookTask>}\n * @memberof BetaGraph\n */\nexport const setTodoTaskComplete = async (graph: IGraph, taskId: string, eTag: string): Promise<OutlookTask> => {\n  return await setTodoTaskDetails(\n    graph,\n    taskId,\n    {\n      isReminderOn: false,\n      status: 'completed'\n    },\n    eTag\n  );\n};\n\n/**\n * async promise, allows developer to set to-do task to incomplete state\n *\n * @param {string} taskId\n * @param {string} eTag\n * @returns {Promise<OutlookTask>}\n * @memberof BetaGraph\n */\nexport const setTodoTaskIncomplete = async (graph: IGraph, taskId: string, eTag: string): Promise<OutlookTask> => {\n  return await setTodoTaskDetails(\n    graph,\n    taskId,\n    {\n      isReminderOn: true,\n      status: 'notStarted'\n    },\n    eTag\n  );\n};\n\n/**\n * async promise, allows developer to redefine to-do Task details associated with a taskId\n *\n * @param {string} taskId\n * @param {*} task\n * @param {string} eTag\n * @returns {Promise<OutlookTask>}\n * @memberof BetaGraph\n */\nexport const setTodoTaskDetails = async (\n  graph: IGraph,\n  taskId: string,\n  task: Partial<OutlookTask>,\n  eTag: string\n): Promise<OutlookTask> =>\n  (await graph\n    .api(`/me/outlook/tasks/${taskId}`)\n    .header('Cache-Control', 'no-store')\n    .header('If-Match', eTag)\n    .middlewareOptions(prepScopes('Tasks.ReadWrite'))\n    .patch(task)) as OutlookTask;\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/* eslint-disable max-classes-per-file */\n\nimport { IGraph, BetaGraph } from '@microsoft/mgt-element';\nimport { PlannerAssignments, PlannerBucket, PlannerPlan } from '@microsoft/microsoft-graph-types';\nimport { OutlookTask, OutlookTaskFolder, OutlookTaskGroup, PlannerTask } from '@microsoft/microsoft-graph-types-beta';\nimport {\n  addPlannerTask,\n  assignPeopleToPlannerTask,\n  getAllMyPlannerPlans,\n  getBucketsForPlannerPlan,\n  getPlansForGroup,\n  getSinglePlannerPlan,\n  getTasksForPlannerBucket,\n  removePlannerTask,\n  setPlannerTaskComplete,\n  setPlannerTaskIncomplete\n} from './mgt-tasks.graph.planner';\nimport {\n  addTodoTask,\n  getAllMyTodoGroups,\n  getAllTodoTasksForFolder,\n  getFoldersForTodoGroup,\n  getSingleTodoGroup,\n  removeTodoTask,\n  setTodoTaskComplete,\n  setTodoTaskIncomplete\n} from './mgt-tasks.graph.todo';\n\n/**\n * ITask\n *\n * @export\n * @interface ITask\n */\nexport interface ITask {\n  /**\n   * id\n   *\n   * @type {string}\n   * @memberof ITask\n   */\n  id: string;\n  /**\n   * name\n   *\n   * @type {string}\n   * @memberof ITask\n   */\n  name: string;\n  /**\n   * task dueDate\n   *\n   * @type {Date}\n   * @memberof ITask\n   */\n  dueDate: Date;\n  /**\n   * is task completed\n   *\n   * @type {boolean}\n   * @memberof ITask\n   */\n  completed: boolean;\n  /**\n   * task topParentId\n   *\n   * @type {string}\n   * @memberof ITask\n   */\n  topParentId: string;\n  /**\n   * task's immediate parent task id\n   *\n   * @type {string}\n   * @memberof ITask\n   */\n  immediateParentId: string;\n  /**\n   * assignments\n   *\n   * @type {PlannerAssignments}\n   * @memberof ITask\n   */\n  assignments: PlannerAssignments;\n  /**\n   * eTag\n   *\n   * @type {string}\n   * @memberof ITask\n   */\n  eTag: string;\n  /**\n   * raw\n   *\n   * @type {PlannerTask | OutlookTask}\n   * @memberof ITask\n   */\n  _raw?: PlannerTask | OutlookTask;\n}\n/**\n * container for tasks\n *\n * @export\n * @interface ITaskFolder\n */\nexport interface ITaskFolder {\n  /**\n   * id\n   *\n   * @type {string}\n   * @memberof ITaskFolder\n   */\n  id: string;\n  /**\n   * name\n   *\n   * @type {string}\n   * @memberof ITaskFolder\n   */\n  name: string;\n  /**\n   * parentId\n   *\n   * @type {string}\n   * @memberof ITaskFolder\n   */\n  parentId: string;\n  /**\n   * raw\n   *\n   * @type {*}\n   * @memberof ITaskFolder\n   */\n  _raw?: PlannerBucket | OutlookTaskFolder;\n}\n\n/**\n * container for folders\n *\n * @export\n * @interface ITaskGroup\n */\nexport interface ITaskGroup {\n  /**\n   * string\n   *\n   * @type {string}\n   * @memberof ITaskGroup\n   */\n  id: string;\n  /**\n   * secondaryId\n   *\n   * @type {string}\n   * @memberof ITaskGroup\n   */\n  secondaryId?: string;\n  /**\n   * title\n   *\n   * @type {string}\n   * @memberof ITaskGroup\n   */\n  title: string;\n  /**\n   * raw\n   *\n   * @type {*}\n   * @memberof ITaskGroup\n   */\n  _raw?: PlannerPlan | OutlookTaskGroup;\n\n  /**\n   * Plan Container ID. Same as the group ID of the group in the plan.\n   *\n   * @type {string}\n   * @memberof ITaskGroup\n   */\n  containerId?: string;\n}\n/**\n * A common interface for both planner and todo tasks\n *\n * @export\n * @interface ITaskSource\n */\nexport interface ITaskSource {\n  /**\n   * Promise that returns task collections for the signed in user\n   *\n   * @returns {Promise<ITaskGroup[]>}\n   * @memberof ITaskSource\n   */\n  getTaskGroups(): Promise<ITaskGroup[]>;\n\n  /**\n   * Promise that returns task collections for group id\n   *\n   * @returns {Promise<ITaskGroup[]>}\n   * @memberof ITaskSource\n   */\n  getTaskGroupsForGroup(id: string): Promise<ITaskGroup[]>;\n\n  /**\n   * Promise that returns a single task collection by collection id\n   *\n   * @param {string} id\n   * @returns {Promise<ITaskGroup>}\n   * @memberof ITaskSource\n   */\n  getTaskGroup(id: string): Promise<ITaskGroup>;\n\n  /**\n   * Promise that returns all task groups in task collection\n   *\n   * @param {string} id\n   * @returns {Promise<ITaskFolder[]>}\n   * @memberof ITaskSource\n   */\n  getTaskFoldersForTaskGroup(id: string): Promise<ITaskFolder[]>;\n\n  /**\n   * Promise that returns all tasks in task group\n   *\n   * @param {string} id\n   * @param {string} parId\n   * @returns {Promise<ITask[]>}\n   * @memberof ITaskSource\n   */\n  getTasksForTaskFolder(id: string, parId: string): Promise<ITask[]>;\n\n  /**\n   * Promise that completes a single task\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof ITaskSource\n   */\n  setTaskComplete(task: ITask): Promise<void>;\n\n  /**\n   * Promise that sets a task to incomplete\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof ITaskSource\n   */\n  setTaskIncomplete(task: ITask): Promise<void>;\n\n  /**\n   * Promise to add a new task\n   *\n   * @param {ITask} newTask\n   * @returns {Promise<any>}\n   * @memberof ITaskSource\n   */\n  addTask(newTask: ITask): Promise<PlannerTask | OutlookTask>;\n\n  /**\n   * assign id's to task\n   *\n   * @param {ITask} task\n   * @param {PlannerAssignments} people\n   * @returns {Promise<any>}\n   * @memberof ITaskSource\n   */\n  assignPeopleToTask(task: ITask, people: PlannerAssignments): Promise<void>;\n\n  /**\n   * Promise to delete a task by id\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof ITaskSource\n   */\n  removeTask(task: ITask): Promise<void>;\n\n  /**\n   * assigns task to the current signed in user\n   *\n   * @param {ITask} task\n   * @param {string} myId\n   * @returns {Boolean}\n   * @memberof ITaskSource\n   */\n  isAssignedToMe(task: ITask, myId: string): boolean;\n}\n/**\n * async method to get user details\n *\n * @class TaskSourceBase\n */\nclass TaskSourceBase {\n  /**\n   * the IGraph instance to use for making Graph requests\n   *\n   * @type {IGraph}\n   * @memberof TaskSourceBase\n   */\n  public graph: IGraph;\n\n  constructor(graph: IGraph) {\n    // Use an instance of BetaGraph since we know we need to call beta apis.\n    this.graph = BetaGraph.fromGraph(graph);\n  }\n}\n\n/**\n * Create Planner\n *\n * @export\n * @class PlannerTaskSource\n * @extends {TaskSourceBase}\n * @implements {ITaskSource}\n */\nexport class PlannerTaskSource extends TaskSourceBase implements ITaskSource {\n  /**\n   * returns promise with all of users plans\n   *\n   * @returns {Promise<ITaskGroup[]>}\n   * @memberof PlannerTaskSource\n   */\n  public async getTaskGroups(): Promise<ITaskGroup[]> {\n    const plans = await getAllMyPlannerPlans(this.graph);\n    return plans.map(\n      plan => ({ id: plan.id, title: plan.title, containerId: plan?.container?.containerId }) as ITaskGroup\n    );\n  }\n\n  /**\n   * returns promise with all of plans for group id\n   *\n   * @param {string} id\n   * @returns {Promise<ITaskGroup[]>}\n   * @memberof PlannerTaskSource\n   */\n  public async getTaskGroupsForGroup(id: string): Promise<ITaskGroup[]> {\n    const plans = await getPlansForGroup(this.graph, id);\n\n    return plans.map(plan => ({ id: plan.id, title: plan.title }) as ITaskGroup);\n  }\n\n  /**\n   * returns promise single TaskGroup or plan from plan.id\n   *\n   * @param {string} id\n   * @returns {Promise<ITaskGroup>}\n   * @memberof PlannerTaskSource\n   */\n  public async getTaskGroup(id: string): Promise<ITaskGroup> {\n    const plan = await getSinglePlannerPlan(this.graph, id);\n\n    return { id: plan.id, title: plan.title, _raw: plan };\n  }\n\n  /**\n   * returns promise with Bucket for a plan from bucket.id\n   *\n   * @param {string} id\n   * @returns {Promise<ITaskFolder[]>}\n   * @memberof PlannerTaskSource\n   */\n  public async getTaskFoldersForTaskGroup(id: string): Promise<ITaskFolder[]> {\n    const buckets = await getBucketsForPlannerPlan(this.graph, id);\n\n    return buckets.map(\n      bucket =>\n        ({\n          _raw: bucket,\n          id: bucket.id,\n          name: bucket.name,\n          parentId: bucket.planId\n        }) as ITaskFolder\n    );\n  }\n\n  /**\n   * get all task from a Bucket given task id\n   *\n   * @param {string} id\n   * @returns {Promise<ITask[]>}\n   * @memberof PlannerTaskSource\n   */\n  public async getTasksForTaskFolder(id: string): Promise<ITask[]> {\n    const tasks = await getTasksForPlannerBucket(this.graph, id);\n\n    return tasks.map(\n      task =>\n        ({\n          _raw: task,\n          assignments: task.assignments,\n          completed: task.percentComplete === 100,\n          dueDate: task.dueDateTime && new Date(task.dueDateTime),\n          eTag: task['@odata.etag'] as string,\n          id: task.id,\n          immediateParentId: task.bucketId,\n          name: task.title,\n          topParentId: task.planId\n        }) as ITask\n    );\n  }\n\n  /**\n   * set task in planner to complete state by id\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof PlannerTaskSource\n   */\n  public async setTaskComplete(task: ITask): Promise<void> {\n    return await setPlannerTaskComplete(this.graph, task);\n  }\n\n  /**\n   * set task in planner to incomplete state by id\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof PlannerTaskSource\n   */\n  public async setTaskIncomplete(task: ITask): Promise<void> {\n    return setPlannerTaskIncomplete(this.graph, task);\n  }\n\n  /**\n   * add new task to bucket\n   *\n   * @param {ITask} newTask\n   * @returns {Promise<any>}\n   * @memberof PlannerTaskSource\n   */\n  public async addTask(newTask: ITask): Promise<PlannerTask> {\n    return await addPlannerTask(this.graph, {\n      assignments: newTask.assignments,\n      bucketId: newTask.immediateParentId,\n      dueDateTime: newTask.dueDate?.toISOString(),\n      planId: newTask.topParentId,\n      title: newTask.name\n    });\n  }\n\n  /**\n   * Assigns people to task\n   *\n   * @param {ITask} task\n   * @param {PlannerAssignments} people\n   * @returns {Promise<any>}\n   * @memberof PlannerTaskSource\n   */\n  public async assignPeopleToTask(task: ITask, people: PlannerAssignments): Promise<void> {\n    return assignPeopleToPlannerTask(this.graph, task, people);\n  }\n\n  /**\n   * remove task from bucket\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof PlannerTaskSource\n   */\n  public async removeTask(task: ITask): Promise<void> {\n    return await removePlannerTask(this.graph, task);\n  }\n\n  /**\n   * assigns task to the signed in user\n   *\n   * @param {ITask} task\n   * @param {string} myId\n   * @returns {boolean}\n   * @memberof PlannerTaskSource\n   */\n  public isAssignedToMe(task: ITask, myId: string): boolean {\n    const keys = Object.keys(task.assignments);\n    return keys.includes(myId);\n  }\n}\n\n/**\n * determins outlook task group for data source\n *\n * @export\n * @class TodoTaskSource\n * @extends {TaskSourceBase}\n * @implements {ITaskSource}\n */\nexport class TodoTaskSource extends TaskSourceBase implements ITaskSource {\n  /**\n   * get all Outlook task groups\n   *\n   * @returns {Promise<ITaskGroup[]>}\n   * @memberof TodoTaskSource\n   */\n  public async getTaskGroups(): Promise<ITaskGroup[]> {\n    const groups: OutlookTaskGroup[] = await getAllMyTodoGroups(this.graph);\n\n    return groups.map(\n      group =>\n        ({\n          _raw: group,\n          id: group.id,\n          secondaryId: group.groupKey,\n          title: group.name\n        }) as ITaskGroup\n    );\n  }\n  /**\n   * get a single OutlookTaskGroup from id\n   *\n   * @param {string} id\n   * @returns {Promise<ITaskGroup>}\n   * @memberof TodoTaskSource\n   */\n  public async getTaskGroup(id: string): Promise<ITaskGroup> {\n    const group: OutlookTaskGroup = await getSingleTodoGroup(this.graph, id);\n\n    return { id: group.id, secondaryId: group.groupKey, title: group.name, _raw: group };\n  }\n  /**\n   * get all OutlookTaskFolder for group by id\n   *\n   * @param {string} id\n   * @returns {Promise<ITaskFolder[]>}\n   * @memberof TodoTaskSource\n   */\n  public async getTaskFoldersForTaskGroup(id: string): Promise<ITaskFolder[]> {\n    const folders: OutlookTaskFolder[] = await getFoldersForTodoGroup(this.graph, id);\n\n    return folders.map(\n      folder =>\n        ({\n          _raw: folder,\n          id: folder.id,\n          name: folder.name,\n          parentId: id\n        }) as ITaskFolder\n    );\n  }\n  /**\n   * gets all tasks for OutLook Task Folder by id\n   *\n   * @param {string} id\n   * @param {string} parId\n   * @returns {Promise<ITask[]>}\n   * @memberof TodoTaskSource\n   */\n  public async getTasksForTaskFolder(id: string, parId: string): Promise<ITask[]> {\n    const tasks: OutlookTask[] = await getAllTodoTasksForFolder(this.graph, id);\n\n    return tasks.map(\n      task =>\n        ({\n          _raw: task,\n          assignments: {},\n          completed: !!task.completedDateTime,\n          dueDate: task.dueDateTime && new Date(task.dueDateTime.dateTime + 'Z'),\n          eTag: task['@odata.etag'] as string,\n          id: task.id,\n          immediateParentId: id,\n          name: task.subject,\n          topParentId: parId\n        }) as ITask\n    );\n  }\n\n  /**\n   * set task in todo to complete state by id\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof TodoTaskSource\n   */\n  public async setTaskComplete(task: ITask): Promise<void> {\n    await setTodoTaskComplete(this.graph, task.id, task.eTag);\n  }\n\n  /**\n   * Assigns people to task in a planner\n   *\n   * @param {ITask} task\n   * @param {PlannerAssignments} people\n   * @returns {Promise<any>}\n   * @memberof PlannerTaskSource\n   */\n  public async assignPeopleToTask(task: ITask, people: PlannerAssignments): Promise<void> {\n    return await assignPeopleToPlannerTask(this.graph, task, people);\n  }\n  /**\n   * set task in planner to incomplete state by id\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof TodoTaskSource\n   */\n  public async setTaskIncomplete(task: ITask): Promise<void> {\n    await setTodoTaskIncomplete(this.graph, task.id, task.eTag);\n  }\n  /**\n   * add new task to planner\n   *\n   * @param {ITask} newTask\n   * @returns {Promise<any>}\n   * @memberof TodoTaskSource\n   */\n  public async addTask(newTask: ITask): Promise<OutlookTask> {\n    const task = {\n      parentFolderId: newTask.immediateParentId,\n      subject: newTask.name\n    } as OutlookTask;\n    if (newTask.dueDate) {\n      task.dueDateTime = {\n        dateTime: newTask.dueDate.toISOString(),\n        timeZone: 'UTC'\n      };\n    }\n    return await addTodoTask(this.graph, task);\n  }\n  /**\n   * remove task from todo by id\n   *\n   * @param {ITask} task\n   * @returns {Promise<any>}\n   * @memberof TodoTaskSource\n   */\n  public async removeTask(task: ITask): Promise<void> {\n    return await removeTodoTask(this.graph, task.id, task.eTag);\n  }\n\n  /**\n   * if task is assigned in to user logged in\n   *\n   * @param {ITask} task\n   * @param {string} myId\n   * @returns {boolean}\n   * @memberof TodoTaskSource\n   */\n  public isAssignedToMe(task: ITask, myId: string): boolean {\n    const keys = Object.keys(task.assignments);\n    return keys.includes(myId);\n  }\n\n  /**\n   * returns promise with all of plans for group id\n   *\n   * @param {string} id\n   * @returns {Promise<ITaskGroup[]>}\n   * @memberof PlannerTaskSource\n   */\n  public async getTaskGroupsForGroup(_id: string): Promise<ITaskGroup[]> {\n    return Promise.resolve<ITaskGroup[]>(undefined);\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nexport const strings = {\n  dotOptionsTitle: 'More options'\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{display:flex;flex-direction:column;align-items:flex-end}:host .dot-icon{font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .menu{position:absolute;box-shadow:var(--neutral-fill-rest) 0 0 40px 5px;background:var(--neutral-fill-rest);z-index:1;display:none;white-space:nowrap;transform:var(--dot-options-translatey,translateY(32px))}:host .menu.open{display:block}:host fluent-button::part(control){background:inherit}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { fluentMenu, fluentMenuItem, fluentButton } from '@fluentui/web-components';\nimport { MgtBaseComponent } from '@microsoft/mgt-element';\nimport { html } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { strings } from './strings';\nimport { registerFluentComponents } from '../../../utils/FluentComponents';\nimport { styles } from './mgt-dot-options-css';\nimport { registerComponent } from '@microsoft/mgt-element';\n\n/**\n * Defines the event functions passed to the option item.\n */\ntype MenuOptionEventFunction = (e: Event) => void;\n\nexport const registerMgtDotOptionsComponent = () => {\n  registerFluentComponents(fluentMenu, fluentMenuItem, fluentButton);\n  registerComponent('dot-options', MgtDotOptions);\n};\n\n/**\n * Custom Component used to handle an arrow rendering for TaskGroups utilized in the task component.\n *\n * @export MgtDotOptions\n * @class MgtDotOptions\n * @extends {MgtBaseComponent}\n */\n\nexport class MgtDotOptions extends MgtBaseComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  public static get styles() {\n    return styles;\n  }\n\n  /**\n   * Strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtDotOptions\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Determines if header menu is rendered or hidden.\n   *\n   * @type {boolean}\n   * @memberof MgtDotOptions\n   */\n  @property({ type: Boolean }) public open: boolean;\n\n  /**\n   * Menu options to be rendered with an attached MouseEvent handler for expansion of details\n   *\n   * @memberof MgtDotOptions\n   */\n  @property({ type: Object }) public options: Record<string, (e: Event) => void>;\n\n  private readonly _clickHandler = () => (this.open = false);\n\n  public connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('click', this._clickHandler);\n  }\n\n  public disconnectedCallback() {\n    window.removeEventListener('click', this._clickHandler);\n    super.disconnectedCallback();\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  public render() {\n    const menuOptions = Object.keys(this.options);\n    return html`\n      <fluent-button\n        appearance=\"stealth\"\n        aria-label=${this.strings.dotOptionsTitle}\n        @click=${this.onDotClick}\n        @keydown=${this.onDotKeydown}\n        class=\"dot-icon\">\\uE712</fluent-button>\n      <fluent-menu class=${classMap({ menu: true, open: this.open })}>\n        ${menuOptions.map(opt => this.getMenuOption(opt, this.options[opt]))}\n      </fluent-menu>`;\n  }\n\n  private readonly handleItemClick = (e: MouseEvent, fn: MenuOptionEventFunction) => {\n    e.preventDefault();\n    e.stopPropagation();\n    fn(e);\n    this.open = false;\n  };\n\n  private readonly handleItemKeydown = (e: KeyboardEvent, fn: MenuOptionEventFunction) => {\n    this.handleKeydownMenuOption(e);\n    fn(e);\n    this.open = false;\n  };\n\n  /**\n   * Used by the render method to attach click handler to each dot item\n   *\n   * @param {string} name\n   * @param {MenuOptionEventFunction} clickFn\n   * @returns\n   * @memberof MgtDotOptions\n   */\n  public getMenuOption(name: string, clickFn: (e: Event) => void) {\n    return html`\n      <div\n        class=\"dot-item\"\n        @click=\"${(e: Event) => {\n          e.preventDefault();\n          e.stopPropagation();\n          clickFn(e);\n          this.open = false;\n        }}\"\n        @keydown=\"${(e: KeyboardEvent) => {\n          if (e.code === 'Enter' || e.code === 'Space') {\n            e.preventDefault();\n            e.stopPropagation();\n            clickFn(e);\n            this.open = false;\n          }\n        }}\"\n      >\n        <span class=\"dot-item-name\">\n          ${name}\n      </fluent-menu-item>`;\n  }\n\n  private readonly onDotClick = (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.open = !this.open;\n  };\n\n  private readonly onDotKeydown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.open = !this.open;\n    }\n  };\n\n  private handleKeydownMenuOption(e: KeyboardEvent) {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{position:relative}:host .header::part(control){font-size:var(--arrow-options-button-font-size,large);font-weight:var(--arrow-options-button-font-weight,600);color:var(--arrow-options-button-font-color,var(--accent-base-color));background:var(--arrow-options-button-background-color,transparent)}:host .header::part(control):hover{background:var(--neutral-fill-stealth-hover)}:host .header::part(control):active,:host .header::part(control):focus{background:var(--neutral-fill-stealth-active)}:host .menu{position:absolute;left:var(--arrow-options-left,0);z-index:1;display:none}:host .menu.open{display:block;width:max-content}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { MgtBaseComponent } from '@microsoft/mgt-element';\nimport { styles } from './mgt-arrow-options-css';\nimport { registerFluentComponents } from '../../../utils/FluentComponents';\nimport { fluentMenu, fluentMenuItem, fluentButton } from '@fluentui/web-components';\nimport { registerComponent } from '@microsoft/mgt-element';\n\n/*\n  Ok, the name here deserves a bit of explanation,\n  This component originally had a built-in arrow icon,\n  The problem came when you wanted to use a different symbol,\n  So the arrow was removed, but the name was already set everywhere.\n  - benotter\n */\n\nexport const registerMgtArrowOptionsComponent = () => {\n  registerFluentComponents(fluentMenu, fluentMenuItem, fluentButton);\n  registerComponent('arrow-options', MgtArrowOptions);\n};\n\n/**\n * Custom Component used to handle an arrow rendering for TaskGroups utilized in the task component.\n *\n * @cssprop --arrow-options-left {Length} The distance of the dropdown menu from the left in absolute position. Default is 0.\n * @cssprop --arrow-options-button-background-color {Color} The background color of the arrow options button.\n * @cssprop --arrow-options-button-font-size {Length} The font size of the button text. Default is large.\n * @cssprop --arrow-options-button-font-weight {Length} The font weight of the button text. Default is 600.\n * @cssprop --arrow-options-button-font-color {Color} The font color of the text in the button.\n *\n * @export MgtArrowOptions\n * @class MgtArrowOptions\n * @extends {MgtBaseComponent}\n */\nexport class MgtArrowOptions extends MgtBaseComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  public static get styles() {\n    return styles;\n  }\n\n  /**\n   * Determines if header menu is rendered or hidden.\n   *\n   * @type {boolean}\n   * @memberof MgtArrowOptions\n   */\n  @property({ type: Boolean }) public open: boolean;\n\n  /**\n   * Title of chosen TaskGroup.\n   *\n   * @type {string}\n   * @memberof MgtArrowOptions\n   */\n  @property({ type: String }) public value: string;\n\n  /**\n   * Menu options to be rendered with an attached UIEvent handler for expansion of details\n   *\n   * @type {object}\n   * @memberof MgtArrowOptions\n   */\n  @property({ type: Object }) public options: Record<string, (e: UIEvent) => void>;\n\n  private readonly _clickHandler: (e: UIEvent) => void;\n\n  constructor() {\n    super();\n    this.value = '';\n    this.options = {};\n    this._clickHandler = () => (this.open = false);\n    window.addEventListener('onblur', () => (this.open = false));\n  }\n\n  public connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('click', this._clickHandler);\n  }\n\n  public disconnectedCallback() {\n    window.removeEventListener('click', this._clickHandler);\n    super.disconnectedCallback();\n  }\n\n  /**\n   * Handles clicking for header menu, utilizing boolean switch open\n   *\n   * @param {MouseEvent} e attaches to Header to open menu\n   * @memberof MgtArrowOptions\n   */\n  public onHeaderClick = (e: MouseEvent) => {\n    const keys = Object.keys(this.options);\n    if (keys.length > 1) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.open = !this.open;\n    }\n  };\n\n  /**\n   * Handles key down presses done on the header element.\n   *\n   * @param {KeyboardEvent} e\n   */\n  private readonly onHeaderKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      e.stopPropagation();\n      this.open = !this.open;\n\n      // Manually adding the 'open' class to display the menu because\n      // by the time I set the first element's focus, the classes are not\n      // updated and that has no effect. You can't set focus on elements\n      // that have no display.\n      const fluentMenuEl: HTMLElement = this.renderRoot.querySelector('fluent-menu');\n      if (fluentMenuEl) {\n        fluentMenuEl.classList.remove('closed');\n        fluentMenuEl.classList.add('open');\n      }\n\n      const header: HTMLButtonElement = e.target as HTMLButtonElement;\n      if (header) {\n        const firstMenuItem: HTMLElement = this.renderRoot.querySelector(\"fluent-menu-item[tabindex='0']\");\n        if (firstMenuItem) {\n          header.blur();\n          firstMenuItem.focus();\n        }\n      }\n    }\n  };\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  public render() {\n    return html`\n      <fluent-button\n        class=\"header\"\n        @click=${this.onHeaderClick}\n        @keydown=${this.onHeaderKeyDown}\n        appearance=\"lightweight\">\n          ${this.value}\n      </fluent-button>\n      <fluent-menu\n        class=${classMap({ menu: true, open: this.open, closed: !this.open })}>\n          ${this.getMenuOptions()}\n      </fluent-menu>`;\n  }\n\n  private getMenuOptions() {\n    const keys = Object.keys(this.options);\n\n    return keys.map((opt: string) => {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n      const clickFn = (e: MouseEvent) => {\n        this.open = false;\n        this.options[opt](e);\n      };\n\n      const keyDownFn = (e: KeyboardEvent) => {\n        const header: HTMLButtonElement = this.renderRoot.querySelector<HTMLButtonElement>('.header');\n        if (e.key === 'Enter') {\n          this.open = false;\n          this.options[opt](e);\n          header.focus();\n        } else if (e.key === 'Tab') {\n          this.open = false;\n        } else if (e.key === 'Escape') {\n          this.open = false;\n          if (header) {\n            header.focus();\n          }\n        }\n      };\n\n      return html`\n          <fluent-menu-item\n            @click=${clickFn}\n            @keydown=${keyDownFn}>\n              ${opt}\n          </fluent-menu-item>`;\n    });\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { ComponentMediaQuery, MgtTemplatedComponent, ProviderState, Providers, mgtHtml } from '@microsoft/mgt-element';\nimport { Person, PlannerAssignments, PlannerTask, User } from '@microsoft/microsoft-graph-types';\nimport { Contact, OutlookTask, OutlookTaskFolder } from '@microsoft/microsoft-graph-types-beta';\nimport { HTMLTemplateResult, PropertyValueMap, TemplateResult, html } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { getMe } from '../../graph/graph.user';\nimport { getShortDateString } from '../../utils/Utils';\nimport { MgtPeoplePicker, registerMgtPeoplePickerComponent } from '../mgt-people-picker/mgt-people-picker';\nimport { MgtPeople, registerMgtPeopleComponent } from '../mgt-people/mgt-people';\nimport '../mgt-person/mgt-person';\nimport '../sub-components/mgt-arrow-options/mgt-arrow-options';\nimport '../sub-components/mgt-dot-options/mgt-dot-options';\nimport { MgtFlyout, registerMgtFlyoutComponent } from '../sub-components/mgt-flyout/mgt-flyout';\nimport { PersonCardInteraction } from './../PersonCardInteraction';\nimport { styles } from './mgt-tasks-css';\nimport { strings } from './strings';\nimport { ITask, ITaskFolder, ITaskGroup, ITaskSource, PlannerTaskSource, TodoTaskSource } from './task-sources';\nimport { getSvg, SvgIcon } from '../../utils/SvgHelper';\nimport { isElementDark } from '../../utils/isDark';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport {\n  fluentSelect,\n  fluentOption,\n  fluentTextField,\n  fluentButton,\n  fluentCheckbox,\n  fluentSkeleton\n} from '@fluentui/web-components';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { registerMgtDotOptionsComponent } from '../sub-components/mgt-dot-options/mgt-dot-options';\nimport { registerMgtArrowOptionsComponent } from '../sub-components/mgt-arrow-options/mgt-arrow-options';\n\n/**\n * Defines how a person card is shown when a user interacts with\n * a person component\n *\n * @export\n * @enum {number}\n */\nexport enum TasksSource {\n  /**\n   * Use Microsoft Planner\n   */\n  planner,\n\n  /**\n   * Use Microsoft To-Do\n   */\n  todo\n}\n\n/**\n * String resources for Mgt Tasks\n *\n * @export\n * @interface TasksStringResource\n */\nexport interface TasksStringResource {\n  /**\n   * Self Assigned string\n   *\n   * @type {string}\n   * @memberof TasksStringResource\n   */\n  BASE_SELF_ASSIGNED: string;\n  /**\n   * Self Assigned Buckets string\n   *\n   * @type {string}\n   * @memberof TasksStringResource\n   */\n  BUCKETS_SELF_ASSIGNED: string;\n  /**\n   * Buckets not found string\n   *\n   * @type {string}\n   * @memberof TasksStringResource\n   */\n  BUCKET_NOT_FOUND: string;\n  /**\n   * Self Assigned Plans string\n   *\n   * @type {string}\n   * @memberof TasksStringResource\n   */\n  PLANS_SELF_ASSIGNED: string;\n  /**\n   * Plan not found string\n   *\n   * @type {string}\n   * @memberof TasksStringResource\n   */\n  PLAN_NOT_FOUND: string;\n}\n\n/*\n * Filter function\n */\nexport type TaskFilter = (task: PlannerTask | OutlookTask) => boolean;\n\n// Strings and Resources for different task contexts\nconst TASK_RES = {\n  todo: {\n    BASE_SELF_ASSIGNED: 'All Tasks',\n    BUCKETS_SELF_ASSIGNED: 'All Tasks',\n    BUCKET_NOT_FOUND: 'Folder not found',\n    PLANS_SELF_ASSIGNED: 'All groups',\n    PLAN_NOT_FOUND: 'Group not found'\n  },\n  planner: {\n    BASE_SELF_ASSIGNED: 'Assigned to Me',\n    BUCKETS_SELF_ASSIGNED: 'All Tasks',\n    BUCKET_NOT_FOUND: 'Bucket not found',\n    PLANS_SELF_ASSIGNED: 'All Plans',\n    PLAN_NOT_FOUND: 'Plan not found'\n  }\n};\n\nconst plannerAssignment = {\n  '@odata.type': '#microsoft.graph.plannerAssignment',\n  orderHint: ' !'\n};\n\nexport const registerMgtTasksComponent = () => {\n  registerFluentComponents(fluentSelect, fluentOption, fluentTextField, fluentButton, fluentCheckbox, fluentSkeleton);\n\n  registerMgtArrowOptionsComponent();\n  registerMgtDotOptionsComponent();\n  registerMgtFlyoutComponent();\n  registerMgtPeopleComponent();\n  registerMgtPeoplePickerComponent();\n  registerComponent('tasks', MgtTasks);\n};\n\n/**\n * Web component enables the user to view, add, remove, complete, or edit tasks. It works with tasks in Microsoft Planner or Microsoft To-Do.\n *\n * @export\n * @class MgtTasks\n * @extends {MgtBaseComponent}\n *\n * @fires {CustomEvent<ITask>} taskAdded - Fires when a new task has been created.\n * @fires {CustomEvent<ITask>} taskChanged - Fires when task metadata has been changed, such as marking completed.\n * @fires {CustomEvent<ITask>} taskClick - Fires when the user clicks or taps on a task.\n * @fires {CustomEvent<ITask>} taskRemoved - Fires when an existing task has been deleted.\n *\n * @cssprop --tasks-header-padding - {String} Tasks header padding. Default is 0 0 14px 0.\n * @cssprop --tasks-header-margin - {String} Tasks header margin. Default is none.\n * @cssprop --tasks-header-text-font-size: {Length} the font size of the tasks header. Default is 24px.\n * @cssprop --tasks-header-text-font-weight: {Length} the font weight of the tasks header. Default is 600.\n * @cssprop --tasks-header-text-color: {Color} the font color of the tasks header.\n * @cssprop --tasks-header-text-hover-color: {Color} the font color of the tasks header when you hover on it.\n *\n * @cssprop --tasks-new-button-width - {Length} Tasks new button width. Default is none.\n * @cssprop --tasks-new-button-height - {Length} Tasks new button height. Default is none\n * @cssprop --tasks-new-button-text-color - {Color} Tasks new button text color.\n * @cssprop --tasks-new-button-text-font-weight - {Length} Tasks new button text font weight. Default is 700.\n * @cssprop --tasks-new-button-background - {Length} Tasks new button background.\n * @cssprop --tasks-new-button-border - {Length} Tasks new button border. Default is none.\n * @cssprop --tasks-new-button-background-hover - {Color} Tasks new button hover background.\n * @cssprop --tasks-new-button-background-active - {Color} Tasks new button active background.\n *\n * @cssprop --task-add-new-button-width - {Length} Add a new task button width. Default is none.\n * @cssprop --task-add-new-button-height - {Length} Add a new task button height. Default is none\n * @cssprop --task-add-new-button-text-color - {Color} Add a new task button text color.\n * @cssprop --task-add-new-button-text-font-weight - {Length} Add a new task button text font weight. Default is 700.\n * @cssprop --task-add-new-button-background - {Length} Add a new task button background.\n * @cssprop --task-add-new-button-border - {Length} Add a new task button border. Default is none.\n * @cssprop --task-add-new-button-background-hover - {Color} Add a new task button hover background.\n * @cssprop --task-add-new-button-background-active - {Color} Add a new task button active background.\n *\n * @cssprop --task-cancel-new-button-width - {Length} Cancel adding a new task button width. Default is none.\n * @cssprop --task-cancel-new-button-height - {Length} Cancel adding a new task button height. Default is none\n * @cssprop --task-cancel-new-button-text-color - {Color} Cancel adding a new task button text color.\n * @cssprop --task-cancel-new-button-text-font-weight - {Length} Cancel adding a new task button text font weight. Default is 700.\n * @cssprop --task-cancel-new-button-background - {Length} Cancel adding a new task button background.\n * @cssprop --task-cancel-new-button-border - {Length} Cancel adding a new task button border. Default is none.\n * @cssprop --task-cancel-new-button-background-hover - {Color} Cancel adding a new task button hover background.\n * @cssprop --task-cancel-new-button-background-active - {Color} Cancel adding a new task button active background.\n *\n * @cssprop --task-new-input-border - {Length} the border of the input for a new task. Default is fluent UI input border.\n * @cssprop --task-new-input-border-radius - {Length} the border radius of the input for a new task. Default is fluent UI input border.\n * @cssprop --task-new-input-background-color - {Color} the background color of the new task input.\n * @cssprop --task-new-input-hover-background-color - {Color} the background color of the new task input when you hover.\n * @cssprop --task-new-input-placeholder-color - {Color} the placeholder colder of the new task input.\n * @cssprop --task-new-dropdown-border - {Length} the border of the dropdown for a new task. Default is fluent UI dropdown border.\n * @cssprop --task-new-dropdown-border-radius - {Length} the border radius of the dropdown for a new task. Default is fluent UI dropdown border.\n * @cssprop --task-new-dropdown-background-color - {Color} the background color of the new task dropdown.\n * @cssprop --task-new-dropdown-hover-background-color - {Color} the background color of the new task dropdown when you hover.\n * @cssprop --task-new-dropdown-placeholder-color - {Color} the placeholder colder of the new task dropdown.\n * @cssprop --task-new-dropdown-list-background-color - {Color} the background color of the dropdown list options.\n * @cssprop --task-new-dropdown-option-text-color - {Color} the text color of the dropdown option text.\n * @cssprop --task-new-dropdown-option-hover-background-color - {Color} the background color of the dropdown option when you hover.\n * @cssprop --task-new-person-icon-color - {Color} color of the assign person text.\n * @cssprop --task-new-person-icon-text-color - {Color} color of the text beside the assign person icon.\n *\n * @cssprop --task-complete-checkbox-background-color - {Color} A completed task checkbox background color.\n * @cssprop --task-complete-checkbox-text-color - {Color} A completed task checkbox check color.\n * @cssprop --task-incomplete-checkbox-background-color - {Color} A incompleted task checkbox background color.\n * @cssprop --task-incomplete-checkbox-background-hover-color - {Color} A incompleted task checkbox background color.\n *\n * @cssprop --task-title-text-font-size - {Length} Task title text font size. Default is medium.\n * @cssprop --task-title-text-font-weight - {Length} Task title text font weight. Default is 600.\n * @cssprop --task-complete-title-text-color - {Length} Task title color for a complete task.\n * @cssprop --task-incomplete-title-text-color - {Length} Task title color for an incomplete task.\n *\n * @cssprop --task-icons-width - {Length} The icons in a task width size. Default is 20px;\n * @cssprop --task-icons-height - {Length} The icons in a task height size. Default is 20px;\n * @cssprop --task-icons-background-color - {Color} The icons in a task color background color.\n * @cssprop --task-icons-text-font-color - {Color} The text beside icons in a task color background color.\n * @cssprop --task-icons-text-font-size - {Length} The font size of the text beside icons in a task. Default is 12px.\n * @cssprop --task-icons-text-font-weight - {Length} The font weight of the text beside icons in a task. Default is 600.\n *\n * @cssprop --task-complete-background-color - {Color} The background color of a task that is complete.\n * @cssprop --task-incomplete-background-color - {Color} The background color of a task that is incomplete.\n * @cssprop --task-complete-border - {Length} The border of a task that is complete.  Default is 2px dotted var(--neutral-fill-strong-rest).\n * @cssprop --task-incomplete-border - {Length} The border of a task that is incomplete. Default is 1px solid var(--neutral-fill-strong-rest).\n * @cssprop --task-complete-border-radius - {Length} The border radius of a task that is incomplete. Default is 4px.\n * @cssprop --task-incomplete-border-radius - {Length} The border radius of a task that is incomplete. Default is 4px.\n * @cssprop --task-complete-padding - {Length} The padding of a task that is complete. Default is 10px.\n * @cssprop --task-incomplete-padding - {Length} The padding of a task that is incomplete. Default is 10px.\n * @cssprop --tasks-gap - {Length} The size of the gap between two tasks in a row. Default is 20px.\n *\n * @cssprop --tasks-background-color - {Color} the color of the background where the tasks are rendered.\n * @cssprop --tasks-border - {Length} the border of the area the tasks are rendered. Default is none.\n * @cssprop --tasks-border-radius - {Length} the border radius of the area where the tasks are rendered. Default is none.\n * @cssprop --tasks-padding - {Length} the padding of the are where the tasks are rendered. Default is 12px.\n */\nexport class MgtTasks extends MgtTemplatedComponent {\n  /**\n   * determines whether todo, or planner functionality for task component\n   *\n   * @readonly\n   * @type {TasksStringResource}\n   * @memberof MgtTasks\n   */\n  public get res() {\n    switch (this.dataSource) {\n      case TasksSource.todo:\n        return TASK_RES.todo;\n      case TasksSource.planner:\n      default:\n        return TASK_RES.planner;\n    }\n  }\n\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n\n  public static get styles() {\n    return styles;\n  }\n\n  /**\n   * Strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtTasks\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Get whether new task view is visible\n   *\n   * @memberof MgtTasks\n   */\n  public get isNewTaskVisible(): boolean {\n    return this._isNewTaskVisible;\n  }\n\n  /**\n   * Set whether new task is visible\n   *\n   * @memberof MgtTasks\n   */\n  public set isNewTaskVisible(value: boolean) {\n    this._isNewTaskVisible = value;\n    if (!value) {\n      this._newTaskDueDate = null;\n      this._newTaskName = '';\n      this._newTaskGroupId = '';\n      this._newTaskContainerId = '';\n    }\n  }\n\n  /**\n   * determines if tasks are un-editable\n   *\n   * @type {boolean}\n   */\n  @property({ attribute: 'read-only', type: Boolean })\n  public readOnly: boolean;\n\n  /**\n   * determines which task source is loaded, either planner or todo\n   *\n   * @type {TasksSource}\n   */\n  @property({\n    attribute: 'data-source',\n    converter: (value, _type) => {\n      value = value.toLowerCase();\n      return (TasksSource[value] as TasksSource) || TasksSource.planner;\n    }\n  })\n  public dataSource: TasksSource = TasksSource.planner;\n\n  /**\n   * if set, the component will only show tasks from either this plan or group\n   *\n   * @type {string}\n   */\n  @property({ attribute: 'target-id', type: String })\n  public targetId: string;\n\n  /**\n   * if set, the component will only show tasks from this bucket or folder\n   *\n   * @type {string}\n   */\n  @property({ attribute: 'target-bucket-id', type: String })\n  public targetBucketId: string;\n\n  /**\n   * if set, the component will first show tasks from this plan or group\n   *\n   * @type {string}\n   * @memberof MgtTasks\n   */\n  @property({ attribute: 'initial-id', type: String })\n  public initialId: string;\n\n  /**\n   * if set, the component will first show tasks from this bucket or folder\n   *\n   * @type {string}\n   * @memberof MgtTasks\n   */\n  @property({ attribute: 'initial-bucket-id', type: String })\n  public initialBucketId: string;\n\n  /**\n   * sets whether the header is rendered\n   *\n   * @type {boolean}\n   * @memberof MgtTasks\n   */\n  @property({ attribute: 'hide-header', type: Boolean })\n  public hideHeader: boolean;\n\n  /**\n   * sets whether the options are rendered\n   *\n   * @type {boolean}\n   * @memberof MgtTasks\n   */\n  @property({ attribute: 'hide-options', type: Boolean })\n  public hideOptions: boolean;\n\n  /**\n   * allows developer to define specific group id\n   *\n   * @type {string}\n   */\n  @property({ attribute: 'group-id', type: String })\n  public groupId: string;\n\n  /**\n   * Optional filter function when rendering tasks\n   *\n   * @type {TaskFilter}\n   * @memberof MgtTasks\n   */\n  public taskFilter: TaskFilter;\n\n  /**\n   * Get the scopes required for tasks\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtTasks\n   */\n  public static get requiredScopes(): string[] {\n    return [\n      ...new Set([\n        'group.read.all',\n        'group.readwrite.all',\n        'tasks.read',\n        'tasks.readwrite',\n        ...MgtPeople.requiredScopes,\n        ...MgtPeoplePicker.requiredScopes\n      ])\n    ];\n  }\n\n  @property() private _isNewTaskVisible: boolean;\n  @property() private _newTaskBeingAdded: boolean;\n  @property() private _newTaskName: string;\n  @property() private _newTaskDueDate: Date;\n  @property() private _newTaskGroupId: string;\n  @property() private _newTaskFolderId: string;\n  @property() private _newTaskContainerId: string;\n  @property() private _groups: ITaskGroup[];\n  @property() private _folders: ITaskFolder[];\n  @property() private _tasks: ITask[];\n  @property() private _hiddenTasks: string[];\n  @property() private _loadingTasks: string[];\n  @property() private _inTaskLoad: boolean;\n  @property() private _hasDoneInitialLoad: boolean;\n  @property() private _todoDefaultSet: boolean;\n\n  @property() private _currentGroup: string;\n  @property() private _currentFolder: string;\n  @state() private _isDarkMode = false;\n  @state() private _me: User = null;\n  private previousMediaQuery: ComponentMediaQuery;\n\n  constructor() {\n    super();\n    this.clearState();\n\n    this.previousMediaQuery = this.mediaQuery;\n  }\n\n  /**\n   * updates provider state\n   *\n   * @memberof MgtTasks\n   */\n  public connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('resize', this.onResize);\n    window.addEventListener('darkmodechanged', this.onThemeChanged);\n    // invoked to ensure we have the correct initial value for _isDarkMode\n    this.onThemeChanged();\n  }\n\n  /**\n   * removes updates on provider state\n   *\n   * @memberof MgtTasks\n   */\n  public disconnectedCallback() {\n    window.removeEventListener('resize', this.onResize);\n    window.removeEventListener('darkmodechanged', this.onThemeChanged);\n    super.disconnectedCallback();\n  }\n\n  /**\n   * Synchronizes property values when attributes change.\n   *\n   * @param {string} name\n   * @param {string} oldVal\n   * @param {string} newVal\n   * @memberof MgtTasks\n   */\n  public attributeChangedCallback(name: string, oldVal: string, newVal: string) {\n    super.attributeChangedCallback(name, oldVal, newVal);\n    if (name === 'data-source') {\n      if (this.dataSource === TasksSource.planner) {\n        this._currentGroup = this.initialId;\n        this._currentFolder = this.initialBucketId;\n      } else if (this.dataSource === TasksSource.todo) {\n        this._currentGroup = null;\n        this._currentFolder = this.initialId;\n      }\n\n      this.clearState();\n      void this.requestStateUpdate();\n    }\n  }\n\n  /**\n   * clears state of component\n   */\n  protected clearState(): void {\n    this._newTaskFolderId = '';\n    this._newTaskGroupId = '';\n    this._newTaskDueDate = null;\n    this._newTaskName = '';\n    this._newTaskBeingAdded = false;\n\n    this._tasks = [];\n    this._folders = [];\n    this._groups = [];\n    this._hiddenTasks = [];\n    this._loadingTasks = [];\n\n    this._hasDoneInitialLoad = false;\n    this._inTaskLoad = false;\n    this._todoDefaultSet = false;\n  }\n\n  /**\n   * Invoked when the element is first updated. Implement to perform one time\n   * work on the element after update.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   */\n  protected firstUpdated(changedProperties: PropertyValueMap<unknown>) {\n    super.firstUpdated(changedProperties);\n\n    if (this.initialId && !this._currentGroup) {\n      if (this.dataSource === TasksSource.planner) {\n        this._currentGroup = this.initialId;\n      } else if (this.dataSource === TasksSource.todo) {\n        this._currentFolder = this.initialId;\n      }\n    }\n\n    if (this.dataSource === TasksSource.planner && this.initialBucketId && !this._currentFolder) {\n      this._currentFolder = this.initialBucketId;\n    }\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected render() {\n    const loadingTask = this._inTaskLoad && !this._hasDoneInitialLoad ? this.renderLoadingTask() : null;\n\n    let header: TemplateResult;\n\n    if (!this.hideHeader) {\n      header = html`\n        <div class=\"header\">\n          ${this.renderPlanOptions()}\n        </div>\n      `;\n    }\n\n    return html`\n      ${header}\n      <div class=\"tasks\">\n        ${this._isNewTaskVisible ? this.renderNewTask() : null} ${loadingTask}\n        ${repeat(\n          this._tasks,\n          task => task.id,\n          task => this.renderTask(task)\n        )}\n      </div>\n    `;\n  }\n\n  /**\n   * loads tasks from dataSource\n   *\n   * @returns\n   * @memberof MgtTasks\n   */\n  protected async loadState() {\n    const ts = this.getTaskSource();\n    if (!ts) {\n      return;\n    }\n\n    const provider = Providers.globalProvider;\n    if (!provider || provider.state !== ProviderState.SignedIn) {\n      return;\n    }\n\n    this._inTaskLoad = true;\n    if (!this._me) {\n      const graph = provider.graph.forComponent(this);\n      this._me = await getMe(graph);\n    }\n\n    if (this.groupId && this.dataSource === TasksSource.planner) {\n      await this._loadTasksForGroup(ts);\n    } else if (this.targetId) {\n      if (this.dataSource === TasksSource.todo) {\n        await this._loadTargetTodoTasks(ts);\n      } else {\n        await this._loadTargetPlannerTasks(ts);\n      }\n    } else {\n      await this._loadAllTasks(ts);\n    }\n\n    this._tasks = this._tasks\n      .filter(task => this.isTaskInSelectedGroupFilter(task))\n      .filter(task => this.isTaskInSelectedFolderFilter(task))\n      .filter(task => !this._hiddenTasks.includes(task.id));\n\n    if (this.taskFilter) {\n      this._tasks = this._tasks.filter(task => this.taskFilter(task._raw));\n    }\n\n    this._inTaskLoad = false;\n    this._hasDoneInitialLoad = true;\n  }\n\n  private readonly onResize = () => {\n    if (this.mediaQuery !== this.previousMediaQuery) {\n      this.previousMediaQuery = this.mediaQuery;\n      this.requestUpdate();\n    }\n  };\n\n  private readonly onThemeChanged = () => {\n    this._isDarkMode = isElementDark(this);\n  };\n\n  private async _loadTargetTodoTasks(ts: ITaskSource) {\n    const groups = await ts.getTaskGroups();\n    const folders = (await Promise.all(groups.map(group => ts.getTaskFoldersForTaskGroup(group.id)))).reduce(\n      (cur, ret) => [...cur, ...ret],\n      []\n    );\n    const tasks = (\n      await Promise.all(folders.map(folder => ts.getTasksForTaskFolder(folder.id, folder.parentId)))\n    ).reduce((cur, ret) => [...cur, ...ret], []);\n\n    this._tasks = tasks;\n    this._folders = folders;\n    this._groups = groups;\n\n    this._currentGroup = null;\n  }\n\n  private async _loadTargetPlannerTasks(ts: ITaskSource) {\n    const group = await ts.getTaskGroup(this.targetId);\n    let folders = await ts.getTaskFoldersForTaskGroup(group.id);\n\n    if (this.targetBucketId) {\n      folders = folders.filter(folder => folder.id === this.targetBucketId);\n    }\n\n    const tasks = (\n      await Promise.all(folders.map(folder => ts.getTasksForTaskFolder(folder.id, folder.parentId)))\n    ).reduce((cur, ret) => [...cur, ...ret], []);\n\n    this._tasks = tasks;\n    this._folders = folders;\n    this._groups = [group];\n  }\n\n  private async _loadAllTasks(ts: ITaskSource) {\n    const groups = await ts.getTaskGroups();\n    const folders = (await Promise.all(groups.map(group => ts.getTaskFoldersForTaskGroup(group.id)))).reduce(\n      (cur, ret) => [...cur, ...ret],\n      []\n    );\n\n    if (!this.initialId && this.dataSource === TasksSource.todo && !this._todoDefaultSet) {\n      this._todoDefaultSet = true;\n      const defaultFolder = folders.find(d => (d._raw as OutlookTaskFolder).isDefaultFolder);\n      if (defaultFolder) {\n        this._currentFolder = defaultFolder.id;\n      }\n    }\n\n    const tasks = (\n      await Promise.all(folders.map(folder => ts.getTasksForTaskFolder(folder.id, folder.parentId)))\n    ).reduce((cur, ret) => [...cur, ...ret], []);\n\n    this._tasks = tasks;\n    this._folders = folders;\n    this._groups = groups;\n  }\n\n  private async _loadTasksForGroup(ts: ITaskSource) {\n    const groups = await ts.getTaskGroupsForGroup(this.groupId);\n    const folders = (await Promise.all(groups.map(group => ts.getTaskFoldersForTaskGroup(group.id)))).reduce(\n      (cur, ret) => [...cur, ...ret],\n      []\n    );\n\n    const tasks = (\n      await Promise.all(folders.map(folder => ts.getTasksForTaskFolder(folder.id, folder.parentId)))\n    ).reduce((cur, ret) => [...cur, ...ret], []);\n\n    this._tasks = tasks;\n    this._folders = folders;\n    this._groups = groups;\n  }\n\n  private async addTask(\n    name: string,\n    dueDate: Date,\n    topParentId: string,\n    immediateParentId: string,\n    assignments: PlannerAssignments = {}\n  ) {\n    const ts = this.getTaskSource();\n    if (!ts) {\n      return;\n    }\n\n    const newTask = {\n      assignments,\n      dueDate,\n      immediateParentId,\n      name,\n      topParentId\n    } as ITask;\n\n    this._newTaskBeingAdded = true;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    newTask._raw = await ts.addTask(newTask);\n    this.fireCustomEvent('taskAdded', newTask);\n\n    await this.requestStateUpdate();\n    this._newTaskBeingAdded = false;\n    this.isNewTaskVisible = false;\n  }\n\n  private async completeTask(task: ITask) {\n    const ts = this.getTaskSource();\n    if (!ts) {\n      return;\n    }\n    this._loadingTasks = [...this._loadingTasks, task.id];\n    await ts.setTaskComplete(task);\n    this.fireCustomEvent('taskChanged', task);\n\n    await this.requestStateUpdate();\n    this._loadingTasks = this._loadingTasks.filter(id => id !== task.id);\n  }\n\n  private async uncompleteTask(task: ITask) {\n    const ts = this.getTaskSource();\n    if (!ts) {\n      return;\n    }\n\n    this._loadingTasks = [...this._loadingTasks, task.id];\n    await ts.setTaskIncomplete(task);\n    this.fireCustomEvent('taskChanged', task);\n\n    await this.requestStateUpdate();\n    this._loadingTasks = this._loadingTasks.filter(id => id !== task.id);\n  }\n\n  private async removeTask(task: ITask) {\n    const ts = this.getTaskSource();\n    if (!ts) {\n      return;\n    }\n\n    this._hiddenTasks = [...this._hiddenTasks, task.id];\n    await ts.removeTask(task);\n    this.fireCustomEvent('taskRemoved', task);\n\n    await this.requestStateUpdate();\n    this._hiddenTasks = this._hiddenTasks.filter(id => id !== task.id);\n  }\n\n  private async assignPeople(task: ITask, people: (User | Person | Contact)[] = []) {\n    const ts = this.getTaskSource();\n    if (!ts) {\n      return;\n    }\n\n    // create previously selected people Object\n    let currentTaskAssigneesIds: string[] = [];\n    if (task) {\n      if (task.assignments) {\n        currentTaskAssigneesIds = Object.keys(task.assignments).sort();\n      }\n    }\n\n    const newTaskAssigneesIds: string[] = people.map(person => {\n      return person.id;\n    });\n\n    // new people from people picker\n    const isEqual =\n      newTaskAssigneesIds.length === currentTaskAssigneesIds.length &&\n      newTaskAssigneesIds.sort().every((value, index) => {\n        return value === currentTaskAssigneesIds[index];\n      });\n\n    if (isEqual) {\n      return;\n    }\n\n    const peopleObj: Record<string, PlannerAssignments> = {};\n\n    // Removes an assignee to a task by setting the value to null\n    for (const p of currentTaskAssigneesIds) {\n      if (newTaskAssigneesIds.includes(p)) {\n        peopleObj[p] = plannerAssignment;\n      } else {\n        peopleObj[p] = null;\n      }\n    }\n\n    // Adds a person to the task by assigning them a temporary planner value\n    newTaskAssigneesIds.forEach(assigneeId => {\n      if (!currentTaskAssigneesIds.includes(assigneeId)) {\n        peopleObj[assigneeId] = plannerAssignment;\n      }\n    });\n\n    if (task) {\n      await ts.assignPeopleToTask(task, peopleObj);\n      await this.requestStateUpdate();\n      this._loadingTasks = this._loadingTasks.filter(id => id !== task.id);\n    }\n  }\n\n  private readonly onAddTaskClick = () => {\n    const picker = this.getPeoplePicker(null);\n\n    const peopleObj: Record<string, unknown> = {};\n\n    if (picker) {\n      for (const person of picker?.selectedPeople ?? []) {\n        peopleObj[person.id] = plannerAssignment;\n      }\n    }\n\n    if (!this._newTaskBeingAdded && this._newTaskName && (this._currentGroup || this._newTaskGroupId)) {\n      void this.addTask(\n        this._newTaskName,\n        this._newTaskDueDate,\n        !this._currentGroup ? this._newTaskGroupId : this._currentGroup,\n        !this._currentFolder ? this._newTaskFolderId : this._currentFolder,\n        peopleObj\n      );\n    }\n  };\n\n  private readonly onAddTaskKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter' || e.key === ' ') {\n      this.onAddTaskClick();\n    }\n  };\n\n  private readonly newTaskButtonKeydown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      this.isNewTaskVisible = !this.isNewTaskVisible;\n    }\n  };\n\n  private readonly addNewTaskButtonClick = () => {\n    this.isNewTaskVisible = !this.isNewTaskVisible;\n  };\n\n  private readonly handleNewTaskDateChange = (e: Event) => {\n    const value = (e.target as HTMLInputElement).value;\n    if (value) {\n      this._newTaskDueDate = new Date(value + 'T17:00');\n    } else {\n      this._newTaskDueDate = null;\n    }\n  };\n\n  private readonly handleSelectedPlan = (e: Event) => {\n    this._newTaskGroupId = (e.target as HTMLInputElement).value;\n    if (this.dataSource === TasksSource.planner) {\n      const task = this._groups.filter(iTask => iTask.id === this._newTaskGroupId);\n      this._newTaskContainerId = task.pop()?.containerId ?? this._newTaskContainerId;\n    }\n  };\n\n  private readonly newTaskVisible = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      this.isNewTaskVisible = false;\n    }\n  };\n\n  private renderPlanOptions(): TemplateResult {\n    const p = Providers.globalProvider;\n\n    if (!p || p.state !== ProviderState.SignedIn) {\n      return null;\n    }\n\n    if (this._inTaskLoad && !this._hasDoneInitialLoad) {\n      return html`<span class=\"loading-header\"></span>`;\n    }\n\n    const addButton =\n      this.readOnly || this._isNewTaskVisible\n        ? null\n        : html`\n          <fluent-button\n            appearance=\"accent\"\n            class=\"new-task-button\"\n            @keydown=${this.newTaskButtonKeydown}\n            @click=${() => (this.isNewTaskVisible = !this.isNewTaskVisible)}>\n              <span slot=\"start\">${getSvg(SvgIcon.Add, 'currentColor')}</span>\n              ${this.strings.addTaskButtonSubtitle}\n          </fluent-button>\n        `;\n\n    if (this.dataSource === TasksSource.planner) {\n      const currentGroup = this._groups.find(d => d.id === this._currentGroup) || {\n        title: this.res.BASE_SELF_ASSIGNED\n      };\n      const groupOptions = {\n        [this.res.BASE_SELF_ASSIGNED]: () => {\n          this._currentGroup = null;\n          this._currentFolder = null;\n        }\n      };\n      for (const group of this._groups) {\n        groupOptions[group.title] = () => {\n          this._currentGroup = group.id;\n          this._currentFolder = null;\n        };\n      }\n      const groupSelect: TemplateResult = mgtHtml`\n        <mgt-arrow-options\n          class=\"arrow-options\"\n          .options=\"${groupOptions}\"\n          .value=\"${currentGroup.title}\"></mgt-arrow-options>`;\n\n      const separator = !this._currentGroup ? null : getSvg(SvgIcon.ChevronRight);\n\n      const currentFolder = this._folders.find(d => d.id === this._currentFolder) || {\n        name: this.res.BUCKETS_SELF_ASSIGNED\n      };\n      const folderOptions = {\n        [this.res.BUCKETS_SELF_ASSIGNED]: () => {\n          this._currentFolder = null;\n        }\n      };\n\n      for (const folder of this._folders.filter(d => d.parentId === this._currentGroup)) {\n        folderOptions[folder.name] = () => {\n          this._currentFolder = folder.id;\n        };\n      }\n\n      const folderSelect = this.targetBucketId\n        ? html`\n            <span class=\"plan-title\">\n              ${this._folders[0]?.name || ''}\n            </span>`\n        : mgtHtml`\n            <mgt-arrow-options class=\"arrow-options\" .options=\"${folderOptions}\" .value=\"${currentFolder.name}\"></mgt-arrow-options>\n          `;\n\n      return html`\n        <div class=\"Title\">\n          ${groupSelect} ${separator} ${!this._currentGroup ? null : folderSelect}\n        </div>\n        ${addButton}\n      `;\n    } else {\n      const folder = this._folders.find(d => d.id === this.targetId) || { name: this.res.BUCKETS_SELF_ASSIGNED };\n      const currentFolder = this._folders.find(d => d.id === this._currentFolder) || {\n        name: this.res.BUCKETS_SELF_ASSIGNED\n      };\n\n      const folderOptions = {};\n\n      for (const d of this._folders) {\n        folderOptions[d.name] = () => {\n          this._currentFolder = d.id;\n        };\n      }\n\n      folderOptions[this.res.BUCKETS_SELF_ASSIGNED] = () => {\n        this._currentFolder = null;\n      };\n\n      const folderSelect = this.targetId\n        ? html`\n            <span class=\"plan-title\">\n              ${folder.name}\n            </span>\n          `\n        : mgtHtml`\n            <mgt-arrow-options class=\"arrow-options\" .value=\"${currentFolder.name}\" .options=\"${folderOptions}\"></mgt-arrow-options>\n          `;\n\n      return html`\n        <span class=\"title\">\n          ${folderSelect}\n        </span>\n        ${addButton}\n      `;\n    }\n  }\n\n  private readonly handleDateChange = (e: UIEvent) => {\n    const value = (e.target as HTMLInputElement).value;\n    if (value) {\n      this._newTaskDueDate = new Date(value + 'T17:00');\n    } else {\n      this._newTaskDueDate = null;\n    }\n  };\n\n  private renderNewTask() {\n    const iconColor = 'var(--neutral-foreground-hint)';\n\n    const taskTitle = html`\n      <fluent-text-field\n        autocomplete=\"off\"\n        placeholder=${this.strings.newTaskPlaceholder}\n        .value=\"${this._newTaskName}\"\n        class=\"new-task\"\n        aria-label=${this.strings.newTaskPlaceholder}\n        @input=${(e: KeyboardEvent) => (this._newTaskName = (e.target as HTMLInputElement).value)}>\n      </fluent-text-field>`;\n\n    if (this._groups.length > 0 && !this._newTaskGroupId) {\n      this._newTaskGroupId = this._groups[0].id;\n    }\n\n    const groupOptions = html`\n      ${repeat(\n        this._groups,\n        grp => grp.id,\n        grp => html`<fluent-option value=\"${grp.id}\">${grp.title}</fluent-option>`\n      )}`;\n\n    const group =\n      this.dataSource === TasksSource.todo\n        ? null\n        : this._currentGroup\n        ? html`\n          <span class=\"new-task-group\">\n            ${this.renderPlannerIcon(iconColor)}\n            <span>${this.getPlanTitle(this._currentGroup)}</span>\n          </span>`\n        : html`\n            <fluent-select>\n              <span slot=\"start\">${this.renderPlannerIcon(iconColor)}</span>\n              ${this._groups.length > 0 ? groupOptions : html`<fluent-option selected>No groups found</fluent-option>`}\n            </fluent-select>`;\n\n    const folders = this._folders.filter(\n      folder =>\n        (this._currentGroup && folder.parentId === this._currentGroup) ||\n        (!this._currentGroup && folder.parentId === this._newTaskGroupId)\n    );\n    if (folders.length > 0 && !this._newTaskFolderId) {\n      this._newTaskFolderId = folders[0].id;\n    }\n\n    const folderOptions = html`\n      ${repeat(\n        folders,\n        folder => folder.id,\n        folder => html`<fluent-option value=\"${folder.id}\">${folder.name}</fluent-option>`\n      )}`;\n\n    const taskFolder = this._currentFolder\n      ? html`\n          <span class=\"new-task-bucket\">\n            ${this.renderBucketIcon(iconColor)}\n            <span>${this.getFolderName(this._currentFolder)}</span>\n          </span>\n        `\n      : html`\n         <fluent-select>\n          <span slot=\"start\">${this.renderBucketIcon(iconColor)}</span>\n          ${folders.length > 0 ? folderOptions : html`<fluent-option selected>No folders found</fluent-option>`}\n        </fluent-select>`;\n\n    const dateField = { dark: this._isDarkMode, 'new-task': true };\n\n    const taskDue = html`\n      <fluent-text-field\n        autocomplete=\"off\"\n        type=\"date\"\n        class=${classMap(dateField)}\n        aria-label=\"${this.strings.addTaskDate}\"\n        .value=\"${this.dateToInputValue(this._newTaskDueDate)}\"\n        @change=${this.handleDateChange}>\n      </fluent-text-field>`;\n\n    const taskPeople = this.dataSource === TasksSource.todo ? null : this.renderAssignedPeople(null);\n\n    const newTaskActionButtons = this._newTaskBeingAdded\n      ? html`<div class=\"task-add-button-container\"></div>`\n      : html`\n          <fluent-button\n            class=\"add-task\"\n            @click=${this.onAddTaskClick}\n            @keydown=${this.onAddTaskKeyDown}\n            appearance=\"neutral\">\n              ${this.strings.addTaskButtonSubtitle}\n          </fluent-button>\n          <fluent-button\n            class=\"cancel-task\"\n            @click=${() => (this.isNewTaskVisible = false)}\n            @keydown=${this.newTaskVisible}\n            appearance=\"neutral\">\n              ${this.strings.cancelNewTaskSubtitle}\n          </fluent-button>`;\n\n    return html`\n    <div\n      class=${classMap({\n        task: true,\n        'new-task': true\n      })}>\n      <div class=\"task-details-container\">\n        <div class=\"top add-new-task\">\n          <div class=\"check-and-title\">\n            ${taskTitle}\n            <div class=\"task-content\">\n              <div class=\"task-group\">${group}</div>\n              <div class=\"task-bucket\">${taskFolder}</div>\n              ${taskPeople}\n              <div class=\"task-due\">${taskDue}</div>\n            </div>\n          </div>\n          <div class=\"task-options new-task-action-buttons\">${newTaskActionButtons}</div>\n        </div>\n      </div>\n    </div>\n  `;\n  }\n\n  private togglePeoplePicker(task: ITask) {\n    const picker = this.getPeoplePicker(task);\n    const mgtPeople = this.getMgtPeople(task);\n    const flyout = this.getFlyout(task);\n\n    if (picker && mgtPeople && flyout) {\n      if (flyout.isOpen) {\n        flyout.close();\n      } else {\n        picker.selectedPeople = mgtPeople.people;\n        flyout.open();\n        setTimeout(() => picker.focus(), 100);\n      }\n    }\n  }\n\n  private updateAssignedPeople(task: ITask) {\n    const picker = this.getPeoplePicker(task);\n    const mgtPeople = this.getMgtPeople(task);\n\n    if (picker && picker.selectedPeople !== mgtPeople.people) {\n      mgtPeople.people = picker.selectedPeople;\n      void this.assignPeople(task, picker.selectedPeople);\n    }\n  }\n\n  private getPeoplePicker(task: ITask): MgtPeoplePicker {\n    const taskId = task ? task.id : 'new-task';\n    return this.renderRoot.querySelector<MgtPeoplePicker>(`.picker-${taskId}`);\n  }\n\n  private getMgtPeople(task: ITask): MgtPeople {\n    const taskId = task ? task.id : 'new-task';\n    return this.renderRoot.querySelector<MgtPeople>(`.people-${taskId}`);\n  }\n\n  private getFlyout(task: ITask): MgtFlyout {\n    const taskId = task ? task.id : 'new-task';\n    return this.renderRoot.querySelector(`.flyout-${taskId}`);\n  }\n\n  private renderTask(task: ITask) {\n    const { name = 'Task', completed = false, dueDate } = task;\n\n    const groupTitle = this._currentGroup ? null : this.getPlanTitle(task.topParentId);\n    const folderTitle = this._currentFolder ? null : this.getFolderName(task.immediateParentId);\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const context = { task: { ...task._raw, groupTitle, folderTitle } };\n    const taskTemplate = this.renderTemplate('task', context, task.id);\n    if (taskTemplate) {\n      return taskTemplate;\n    }\n\n    let taskDetails = this.renderTemplate('task-details', context, `task-details-${task.id}`);\n\n    if (!taskDetails) {\n      const iconColor = 'var(--neutral-foreground-hint)';\n      const group =\n        this.dataSource === TasksSource.todo || this._currentGroup\n          ? null\n          : html`\n              <div class=\"task-group\">\n                <span class=\"task-icon\">${this.renderPlannerIcon(iconColor)}</span>\n                <span class=\"task-icon-text\">${this.getPlanTitle(task.topParentId)}</span>\n              </div>\n            `;\n\n      const folder = this._currentFolder\n        ? null\n        : html`\n            <div class=\"task-bucket\">\n              <span class=\"task-icon\">${this.renderBucketIcon(iconColor)}</span>\n              <span class=\"task-icon-text\">${this.getFolderName(task.immediateParentId)}</span>\n            </div>\n          `;\n\n      const taskDue = !dueDate\n        ? null\n        : html`\n            <div class=\"task-due\">\n              <span class=\"task-icon-text\">${this.strings.due}${getShortDateString(dueDate)}</span>\n            </div>\n          `;\n\n      const taskPeople = this.dataSource === TasksSource.todo ? null : this.renderAssignedPeople(task);\n\n      taskDetails = html`${group} ${folder} ${taskPeople} ${taskDue}`;\n    }\n\n    const taskOptions =\n      this.readOnly || this.hideOptions\n        ? null\n        : mgtHtml`\n            <mgt-dot-options\n              class=\"dot-options\"\n              .options=\"${{\n                [this.strings.removeTaskSubtitle]: () => this.removeTask(task)\n              }}\"\n            ></mgt-dot-options>`;\n\n    const taskClasses = classMap({\n      task: true,\n      complete: completed,\n      incomplete: !completed,\n      'read-only': this.readOnly\n    });\n\n    return html`\n      <div\n        data-id=\"task-${task.id}\"\n        class=${taskClasses}\n        @click=${() => this.handleTaskClick(task)}>\n        <div class=\"task-details-container\">\n          <div class=\"top\">\n            <div class=\"check-and-title\">\n              <fluent-checkbox\n                @click=${(e: MouseEvent) => this.checkTask(e, task)}\n                @keydown=${(e: KeyboardEvent) => this.handleTaskCheckKeyDown(e, task)}\n                ?checked=${completed}>\n                  ${name}\n              </fluent-checkbox>\n            </div>\n            <div class=\"task-options\">${taskOptions}</div>\n          </div>\n          <div class=\"bottom\">${taskDetails}</div>\n        </div>\n      </div>\n    `;\n  }\n\n  private async handleTaskCheckKeyDown(e: KeyboardEvent, task: ITask) {\n    if (e.key === 'Enter') {\n      if (!this.readOnly) {\n        if (!task.completed) {\n          await this.completeTask(task);\n        } else {\n          await this.uncompleteTask(task);\n        }\n\n        e.stopPropagation();\n        e.preventDefault();\n      }\n    }\n  }\n\n  private async checkTask(e: MouseEvent, task: ITask) {\n    if (!this.readOnly) {\n      const target = this.shadowRoot.querySelector(`[data-id='task-${task.id}'`);\n      if (target) target.classList.add('updating');\n      if (!task.completed) {\n        await this.completeTask(task);\n      } else {\n        await this.uncompleteTask(task);\n      }\n      if (target) target.classList.remove('updating');\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  private readonly renderPlannerIcon = (iconColor: string) => {\n    return getSvg(SvgIcon.Planner, iconColor);\n  };\n  private readonly renderBucketIcon = (iconColor: string) => {\n    return getSvg(SvgIcon.Milestone, iconColor);\n  };\n\n  private readonly handlePeopleClick = (e: MouseEvent, task: ITask) => {\n    this.togglePeoplePicker(task);\n    e.stopPropagation();\n  };\n\n  private readonly handlePeopleKeydown = (e: KeyboardEvent, task: ITask) => {\n    if (e.key === 'Enter' || e.key === ' ') {\n      this.togglePeoplePicker(task);\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  };\n\n  private readonly handlePeoplePickerKeydown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.stopPropagation();\n    }\n  };\n\n  private renderAssignedPeople(task: ITask): TemplateResult {\n    let assignedGroupId: string;\n    const taskAssigneeClasses = {\n      'new-task-assignee': task === null,\n      'task-assignee': task !== null,\n      'task-detail': task !== null\n    };\n\n    const taskId = task ? task.id : 'new-task';\n    taskAssigneeClasses[`flyout-${taskId}`] = true;\n\n    const assignedPeople = task ? Object.keys(task.assignments).map(key => key) : [];\n\n    if (!this.newTaskVisible) {\n      const raw: PlannerTask = task?._raw as PlannerTask;\n      const planId = raw?.planId;\n      if (planId) {\n        const group = this._groups.filter(grp => grp.id === planId);\n        assignedGroupId = group.pop()?.containerId;\n      }\n    }\n\n    const planGroupId = this.isNewTaskVisible ? this._newTaskContainerId : assignedGroupId;\n\n    const assignedPeopleTemplate: HTMLTemplateResult = mgtHtml`\n      <mgt-people\n        class=\"people people-${taskId}\"\n        .userIds=${assignedPeople}\n        .personCardInteraction=${PersonCardInteraction.none}\n        @click=${(e: MouseEvent) => this.handlePeopleClick(e, task)}\n        @keydown=${(e: KeyboardEvent) => this.handlePeopleKeydown(e, task)}\n      >\n        <template data-type=\"no-data\">\n          <fluent-button>\n            <span style=\"display:flex;place-content:start;gap:4px;padding-inline-start:4px\">\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\" class=\"svg\" fill=\"currentColor\">\n                <path d=\"M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z\"></path>\n                <path d=\"M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z\"></path>\n                <path d=\"M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z\"></path>\n              </svg> Assign</span>\n            </fluent-button>\n        </template>\n      </mgt-people>`;\n\n    const picker = mgtHtml`\n      <mgt-people-picker\n        class=\"people-picker picker-${taskId}\"\n        .groupId=${ifDefined(planGroupId)}\n        @keydown=${this.handlePeoplePickerKeydown}>\n      ></mgt-people-picker>`;\n\n    return mgtHtml`\n      <mgt-flyout\n        light-dismiss\n        class=${classMap(taskAssigneeClasses)}\n        @closed=${() => this.updateAssignedPeople(task)}\n      >\n        <div slot=\"anchor\">${assignedPeopleTemplate}</div>\n        <div slot=\"flyout\" part=\"picker\" class=\"picker\">${picker}</div>\n      </mgt-flyout>\n    `;\n  }\n\n  private handleTaskClick(task: ITask) {\n    if (task) {\n      this.fireCustomEvent('taskClick', task);\n    }\n  }\n\n  private renderLoadingTask() {\n    return html`\n      <div class=\"header\">\n        <div class=\"title\">\n          <fluent-skeleton shimmer class=\"shimmer\" shape=\"rect\"></fluent-skeleton>\n        </div>\n        <div class=\"new-task-button\">\n          <fluent-skeleton shimmer class=\"shimmer\" shape=\"rect\"></fluent-skeleton>\n        </div>\n      </div>\n      <div class=\"tasks\">\n        <div class=\"task incomplete\">\n          <div class=\"task-details-container\">\n            <div class=\"top\">\n              <div class=\"check-and-title shimmer\">\n                <fluent-skeleton shimmer class=\"checkbox\" shape=\"circle\"></fluent-skeleton>\n                <fluent-skeleton shimmer class=\"title\" shape=\"rect\"></fluent-skeleton>\n              </div>\n              <div class=\"task-options\">\n                <fluent-skeleton shimmer class=\"options\" shape=\"rect\"></fluent-skeleton>\n              </div>\n            </div>\n            <div class=\"bottom\">\n              <div class=\"task-group\">\n                <div class=\"task-icon\">\n                  <fluent-skeleton shimmer class=\"shimmer icon\" shape=\"rect\"></fluent-skeleton>\n                </div>\n                <div class=\"task-icon-text\">\n                  <fluent-skeleton shimmer class=\"shimmer text\" shape=\"rect\"></fluent-skeleton>\n                </div>\n              </div>\n              <div class=\"task-bucket\">\n                <div class=\"task-icon\">\n                  <fluent-skeleton shimmer class=\"shimmer icon\" shape=\"rect\"></fluent-skeleton>\n                </div>\n                <div class=\"task-icon-text\">\n                  <fluent-skeleton shimmer class=\"shimmer text\" shape=\"rect\"></fluent-skeleton>\n                </div>\n              </div>\n              <div class=\"task-details shimmer\">\n                <fluent-skeleton shimmer class=\"shimmer icon\" shape=\"circle\"></fluent-skeleton>\n                <fluent-skeleton shimmer class=\"shimmer icon\" shape=\"circle\"></fluent-skeleton>\n                <fluent-skeleton shimmer class=\"shimmer icon\" shape=\"circle\"></fluent-skeleton>\n              </div>\n              <div class=\"task-due\">\n                <div class=\"task-icon-text\">\n                  <fluent-skeleton shimmer class=\"shimmer text\" shape=\"rect\"></fluent-skeleton>\n                </div>\n              </div>\n              </div>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private getTaskSource(): ITaskSource {\n    const p = Providers.globalProvider;\n    if (!p || p.state !== ProviderState.SignedIn) {\n      return null;\n    }\n\n    const graph = p.graph.forComponent(this);\n    if (this.dataSource === TasksSource.planner) {\n      return new PlannerTaskSource(graph);\n    } else if (this.dataSource === TasksSource.todo) {\n      return new TodoTaskSource(graph);\n    } else {\n      return null;\n    }\n  }\n\n  private getPlanTitle(planId: string): string {\n    if (!planId) {\n      return this.res.BASE_SELF_ASSIGNED;\n    } else if (planId === this.res.PLANS_SELF_ASSIGNED) {\n      return this.res.PLANS_SELF_ASSIGNED;\n    } else {\n      return (\n        this._groups.find(plan => plan.id === planId) || {\n          title: this.res.PLAN_NOT_FOUND\n        }\n      ).title;\n    }\n  }\n\n  private getFolderName(bucketId: string): string {\n    if (!bucketId) {\n      return this.res.BUCKETS_SELF_ASSIGNED;\n    }\n    return (\n      this._folders.find(buck => buck.id === bucketId) || {\n        name: this.res.BUCKET_NOT_FOUND\n      }\n    ).name;\n  }\n\n  private isTaskInSelectedGroupFilter(task: ITask) {\n    return (\n      !this._currentGroup ||\n      task.topParentId === this._currentGroup ||\n      (!this._currentGroup && this.getTaskSource().isAssignedToMe(task, this._me?.id))\n    );\n  }\n\n  private isTaskInSelectedFolderFilter(task: ITask) {\n    return task.immediateParentId === this._currentFolder || !this._currentFolder;\n  }\n\n  private dateToInputValue(date: Date) {\n    if (date) {\n      return new Date(date.getTime() - date.getTimezoneOffset() * 60000).toISOString().split('T')[0];\n    }\n\n    return null;\n  }\n}\n\nexport { ITask };\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  label: 'Color mode:',\n  on: 'Dark',\n  off: 'Light'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { MgtBaseComponent } from '@microsoft/mgt-element';\nimport { fluentSwitch } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { applyTheme } from '../../styles/theme-manager';\nimport { strings } from './strings';\nimport { registerComponent } from '@microsoft/mgt-element';\n\nexport const registerMgtThemeToggleComponent = () => {\n  registerFluentComponents(fluentSwitch);\n  registerComponent('theme-toggle', MgtThemeToggle);\n};\n\n/**\n * Toggle to switch between light and dark mode\n * Will detect browser preference and set accordingly or dark mode can be forced\n *\n * @fires {CustomEvent<boolean>} darkmodechanged - Fired when dark mode is toggled by a user action\n *\n * @class MgtDarkToggle\n * @extends {MgtBaseComponent}\n */\nexport class MgtThemeToggle extends MgtBaseComponent {\n  constructor() {\n    super();\n    const prefersDarkMode = window.matchMedia('(prefers-color-scheme:dark)').matches;\n    this.darkModeActive = prefersDarkMode;\n    this.applyTheme(this.darkModeActive);\n  }\n  /**\n   * Provides strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtDarkToggle\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Controls whether dark mode is active\n   *\n   * @type {boolean}\n   * @memberof MgtDarkToggle\n   */\n  @property({\n    attribute: 'mode',\n    reflect: true,\n    type: String,\n    converter: {\n      fromAttribute: (value: string) => {\n        return value === 'dark';\n      },\n      toAttribute: (value: boolean) => {\n        return value ? 'dark' : 'light';\n      }\n    }\n  })\n  public darkModeActive: boolean;\n\n  /**\n   * Fires after a component is updated.\n   * Allows a component to trigger side effects after updating.\n   *\n   * @param {Map<string, any>} changedProperties\n   * @memberof MgtDarkToggle\n   */\n  updated(changedProperties: Map<string, unknown>): void {\n    if (changedProperties.has('darkModeActive')) {\n      this.applyTheme(this.darkModeActive);\n    }\n  }\n\n  /**\n   * renders the component\n   *\n   * @return {TemplateResult}\n   * @memberof MgtDarkToggle\n   */\n  render(): TemplateResult {\n    return html`\n      <fluent-switch checked=${this.darkModeActive} @change=${this.onSwitchChanged}>\n        <span slot=\"checked-message\">${strings.on}</span>\n        <span slot=\"unchecked-message\">${strings.off}</span>\n        <label for=\"direction-switch\">${strings.label}</label>\n      </fluent-switch>\n`;\n  }\n\n  private readonly onSwitchChanged = (e: Event) => {\n    this.darkModeActive = (e.target as HTMLInputElement).checked;\n  };\n\n  private applyTheme(active: boolean) {\n    const targetTheme = active ? 'dark' : 'light';\n    applyTheme(targetTheme);\n\n    document.body.classList.remove('mgt-dark-mode', 'mgt-light-mode');\n    document.body.classList.add(`mgt-${targetTheme}-mode`);\n    this.fireCustomEvent('darkmodechanged', this.darkModeActive, true, false, true);\n  }\n}\n","import {\n  registerMgtAgendaComponent,\n  registerMgtFileComponent,\n  registerMgtFileListComponent,\n  registerMgtGetComponent,\n  registerMgtLoginComponent,\n  registerMgtPeopleComponent,\n  registerMgtPeoplePickerComponent,\n  registerMgtPersonCardComponent,\n  registerMgtPersonComponent,\n  registerMgtPickerComponent,\n  registerMgtSearchBoxComponent,\n  registerMgtSearchResultsComponent,\n  registerMgtSpinnerComponent,\n  registerMgtTasksComponent,\n  registerMgtTaxonomyPickerComponent,\n  registerMgtTeamsChannelPickerComponent,\n  registerMgtThemeToggleComponent,\n  registerMgtTodoComponent\n} from './components/components';\n\nexport const registerMgtComponents = () => {\n  // this should match the set of components listed for export in packages/mgt-react/scripts/generate.js\n  // all \"internal\" components should be registered from their parent components\n  registerMgtPersonComponent();\n  registerMgtPersonCardComponent();\n  registerMgtAgendaComponent();\n  registerMgtGetComponent();\n  registerMgtLoginComponent();\n  registerMgtPeoplePickerComponent();\n  registerMgtPeopleComponent();\n  registerMgtTasksComponent();\n  registerMgtTeamsChannelPickerComponent();\n  registerMgtTodoComponent();\n  registerMgtFileComponent();\n  registerMgtFileListComponent();\n  registerMgtPickerComponent();\n  registerMgtTaxonomyPickerComponent();\n  registerMgtThemeToggleComponent();\n  registerMgtSearchBoxComponent();\n  registerMgtSearchResultsComponent();\n  registerMgtSpinnerComponent();\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { ProviderState, Providers } from '@microsoft/mgt-element';\n\nconst getCurrentUser = () =>\n  Providers.globalProvider.state === ProviderState.SignedIn ? Providers.globalProvider.getActiveAccount?.() : undefined;\nconst currentUserId = () => getCurrentUser()?.id.split('.')[0] || '';\nconst currentUserName = () => getCurrentUser()?.name || '';\n\nexport { getCurrentUser, currentUserId, currentUserName };\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph, Providers } from '@microsoft/mgt-element';\n\nexport const graph = (component: string, version?: string): IGraph => {\n  if (!component) throw new Error('Component name is required');\n  return Providers.globalProvider.graph.forComponent(component, version);\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CacheItem, CacheSchema, CacheService, CacheStore, schemas } from '@microsoft/mgt-react';\nimport { ChatMessage } from '@microsoft/microsoft-graph-types';\nimport { GraphCollection } from '../graph.chat';\nimport { isConversationCacheEnabled } from './isConversationCacheEnabled';\nimport { cacheEntryIsValid } from './cacheEntryIsValid';\n\ninterface CachedMessageData extends CacheItem, GraphCollection<ChatMessage> {\n  chatId: string;\n  lastModifiedDateTime: string; // ISO 8601 timestamp, should be max from values in messages\n}\n\nexport class MessageCache {\n  private get cache(): CacheStore<CachedMessageData> {\n    const conversation: CacheSchema = schemas.conversation;\n    return CacheService.getCache<CachedMessageData>(conversation, conversation.stores.chats);\n  }\n\n  public async loadMessages(chatId: string): Promise<CachedMessageData | null | undefined> {\n    if (isConversationCacheEnabled()) {\n      const data = await this.cache.getValue(chatId);\n      if (data && cacheEntryIsValid(data)) return data;\n    }\n    return undefined;\n  }\n\n  public async cacheMessages(\n    chatId: string,\n    messages: ChatMessage[],\n    updateNextLink = false,\n    nextLink?: string\n  ): Promise<CachedMessageData> {\n    const cachedData = await this.cache.getValue(chatId);\n    if (!cachedData) {\n      const maxLastModifiedDateTime = messages.reduce((acc: string, curr: ChatMessage) => {\n        if (curr.lastModifiedDateTime && curr.lastModifiedDateTime > acc) acc = curr.lastModifiedDateTime;\n        return acc;\n      }, '');\n      const data = {\n        chatId,\n        value: messages,\n        lastModifiedDateTime: maxLastModifiedDateTime,\n        nextLink\n      };\n      // nothing cached, create and store.\n      await this.cache.putValue(chatId, data);\n      return data;\n    } else {\n      // need to iterate through the messages and either push or splice them into the array.\n      messages.forEach(m => this.addMessageToCacheData(m, cachedData));\n      if (updateNextLink) {\n        cachedData.nextLink = nextLink;\n      }\n      // update persisted data\n      await this.cache.putValue(chatId, cachedData);\n      return cachedData;\n    }\n  }\n\n  public async cacheMessage(chatId: string, message: ChatMessage): Promise<void> {\n    const cachedData = await this.cache.getValue(chatId);\n    if (!cachedData) {\n      // nothing cached, create and store.\n      await this.cache.putValue(chatId, {\n        chatId,\n        value: [message],\n        lastModifiedDateTime: message.lastModifiedDateTime || ''\n      });\n    } else {\n      this.addMessageToCacheData(message, cachedData);\n      // update persisted data\n      await this.cache.putValue(chatId, cachedData);\n    }\n  }\n\n  private addMessageToCacheData(message: ChatMessage, cachedData: CachedMessageData) {\n    const spliceIndex = cachedData.value.findIndex(m => m.id === message.id);\n    if (spliceIndex !== -1) {\n      cachedData.value.splice(spliceIndex, 1, message);\n    } else {\n      cachedData.value.push(message);\n    }\n    // coerce potential nullish values to an empty string to allow comparison\n    if (message.lastModifiedDateTime && message.lastModifiedDateTime > (cachedData.lastModifiedDateTime ?? ''))\n      cachedData.lastModifiedDateTime = message.lastModifiedDateTime;\n  }\n\n  public async deleteMessage(chatId: string, message: ChatMessage) {\n    const cachedData = await this.cache.getValue(chatId);\n    // for now we're ignoring the case where we didn't find anything in the cache for the given chatId as there's nothing to delete.\n    if (cachedData) {\n      const spliceIndex = cachedData.value.findIndex(m => m.id === message.id);\n      cachedData.value.splice(spliceIndex, 1);\n      await this.cache.putValue(chatId, cachedData);\n    }\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { ReadReceiptReceivedEvent, TypingIndicatorReceivedEvent } from '@azure/communication-signaling';\nimport { AadUserConversationMember, Chat, ChatMessage } from '@microsoft/microsoft-graph-types';\nimport { EventEmitter } from 'events';\n\nexport type ChatEvent =\n  | 'chatMessageReceived'\n  | 'chatMessageEdited'\n  | 'chatMessageDeleted'\n  | 'typingIndicatorReceived'\n  | 'readReceiptReceived'\n  | 'chatThreadDeleted'\n  | 'chatThreadPropertiesUpdated'\n  | 'participantAdded'\n  | 'participantRemoved'\n  | 'notificationsSubscribedForResource';\n\nexport class ThreadEventEmitter {\n  private readonly emitter: EventEmitter = new EventEmitter();\n\n  on(event: ChatEvent, listener: (...args: any[]) => void) {\n    this.emitter.on(event, listener);\n  }\n\n  off(event: ChatEvent, listener: (...args: any[]) => void) {\n    this.emitter.off(event, listener);\n  }\n\n  chatMessageReceived(e: ChatMessage) {\n    this.emitter.emit('chatMessageReceived', e);\n  }\n  chatMessageEdited(e: ChatMessage) {\n    this.emitter.emit('chatMessageEdited', e);\n  }\n  chatMessageDeleted(e: ChatMessage) {\n    this.emitter.emit('chatMessageDeleted', e);\n  }\n  typingIndicatorReceived(e: TypingIndicatorReceivedEvent) {\n    this.emitter.emit('typingIndicatorReceived', e);\n  }\n  readReceiptReceived(e: ReadReceiptReceivedEvent) {\n    this.emitter.emit('readReceiptReceived', e);\n  }\n  chatThreadDeleted(e: Chat) {\n    this.emitter.emit('chatThreadDeleted', e);\n  }\n  chatThreadPropertiesUpdated(e: Chat) {\n    this.emitter.emit('chatThreadPropertiesUpdated', e);\n  }\n  participantAdded(e: AadUserConversationMember) {\n    this.emitter.emit('participantAdded', e);\n  }\n  participantRemoved(e: AadUserConversationMember) {\n    this.emitter.emit('participantRemoved', e);\n  }\n  notificationsSubscribedForResource(resouce: string) {\n    this.emitter.emit('notificationsSubscribedForResource', resouce);\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  schemas,\n  CachePhoto,\n  getPhotoInvalidationTime,\n  storePhotoInCache,\n  blobToBase64\n} from '@microsoft/mgt-components';\nimport { CacheService, IGraph, prepScopes } from '@microsoft/mgt-element';\nimport { ResponseType } from '@microsoft/microsoft-graph-client';\nimport { AadUserConversationMember, Chat, ChatMessage } from '@microsoft/microsoft-graph-types';\nimport { chatOperationScopes } from './chatOperationScopes';\n\n/**\n * Generic collection response from graph\n */\nexport interface GraphCollection<T = any> {\n  '@odata.nextLink'?: string;\n  nextLink?: string;\n  value: T[];\n}\n\n/**\n * Object representing a collection of chat messages\n */\nexport type MessageCollection = GraphCollection<ChatMessage>;\n\n/**\n * Load the specified chat from graph with the members expanded\n *\n * @param graph authenticated graph client from mgt\n * @param chatId the id of the chat to load\n * @returns {Promise<Chat>}\n */\nexport const loadChat = async (graph: IGraph, chatId: string): Promise<Chat> =>\n  (await graph\n    .api(`/chats/${chatId}?$expand=members`)\n    .middlewareOptions(prepScopes(...chatOperationScopes.loadChat))\n    .get()) as Chat;\n\n/**\n * Load the first page of messages from the specified chat\n * Will provide a nextLink to load more messages if there are more than the specified messageCount\n *\n * @param graph authenticated graph client from mgt\n * @param chatId the id of the chat to load messages from\n * @param messageCount how many messages to load per page\n * @returns {Promise<MessageCollection>} a collection of messages and a possible nextLink to load more messages\n */\nexport const loadChatThread = async (\n  graph: IGraph,\n  chatId: string,\n  messageCount: number\n): Promise<MessageCollection> => {\n  const response = (await graph\n    .api(`/chats/${chatId}/messages`)\n    .orderby('createdDateTime DESC')\n    .top(messageCount)\n    .middlewareOptions(prepScopes(...chatOperationScopes.loadChatMessages))\n    .get()) as MessageCollection;\n  // split the nextLink on version to maintain a relative path\n  response.nextLink = response['@odata.nextLink']?.split(graph.version)[1];\n  return response;\n};\n\n/**\n * Load the first page of messages from the specified chat which were modified after the specified timestamp\n * Will provide a nextLink to load more messages if there are more than the specified messageCount\n *\n * @param graph authenticated graph client from mgt\n * @param chatId the id of the chat to load messages from\n * @param lastModified the ISO 8601 timestamp after which data should be loaded from.\n * @param messageCount how many messages to load per page\n * @returns {Promise<MessageCollection>} a collection of messages and a possible nextLink to load more messages\n */\nexport const loadChatThreadDelta = async (\n  graph: IGraph,\n  chatId: string,\n  lastModified: string,\n  messageCount: number\n): Promise<MessageCollection> => {\n  const response = (await graph\n    .api(`/chats/${chatId}/messages`)\n    .filter(`lastModifiedDateTime gt ${lastModified}`)\n    .orderby('lastModifiedDateTime DESC')\n    .top(messageCount)\n    .middlewareOptions(prepScopes(...chatOperationScopes.loadChatMessages))\n    .get()) as MessageCollection;\n  // split the nextLink on version to maintain a relative path\n  response.nextLink = response['@odata.nextLink']?.split(graph.version)[1];\n  return response;\n};\n\n/**\n * Loads another page of messages from the specified chat\n *\n * @param graph authenticated graph client from mgt\n * @param nextLink the nextLink to load more messages from\n * @returns {Promise<MessageCollection>} a collection of messages and a possible nextLink to load more messages\n */\nexport const loadMoreChatMessages = async (graph: IGraph, nextLink: string): Promise<MessageCollection> => {\n  // not defining scopes here because this uses a nextLink and the initial request ensures the required scopes are present\n  const response = (await graph.api(nextLink).get()) as MessageCollection;\n  // split the nextLink on version to maintain a relative path\n  response.nextLink = response['@odata.nextLink']?.split(graph.version)[1];\n  return response;\n};\n\n/**\n * Creates a new chat message via HTTP POST\n *\n * @param graph authenticated graph client from mgt\n * @param chatId id of the chat to send the message to\n * @param content content of the message to send\n * @returns {Promise<ChatMessage>} the newly created message\n */\nexport const sendChatMessage = async (graph: IGraph, chatId: string, content: string): Promise<ChatMessage> => {\n  // TODO: remove this code that lets me simulate a failure during debugging\n  // let fail = false;\n\n  // debugger;\n  // if (fail) throw new Error('fail');\n\n  return (await graph\n    .api(`/chats/${chatId}/messages`)\n    .middlewareOptions(prepScopes(...chatOperationScopes.sendChatMessage))\n    .post({ body: { content } })) as ChatMessage;\n};\n\n/**\n * Updates a chat message via HTTP PATCH\n *\n * @param graph authenticated graph client from mgt\n * @param chatId the id of the chat containing the message to update\n * @param messageId the id of the message to update\n * @param content the new content of the message\n * @returns {Promise<void>}\n */\nexport const updateChatMessage = async (\n  graph: IGraph,\n  chatId: string,\n  messageId: string,\n  content: string\n): Promise<void> => {\n  // TODO: remove this code that lets me simulate a failure during debugging\n  // let fail = false;\n\n  // debugger;\n  // if (fail) throw new Error('fail');\n\n  await graph\n    .api(`/chats/${chatId}/messages/${messageId}`)\n    .middlewareOptions(prepScopes(...chatOperationScopes.updateChatMessage))\n    .patch({ body: { content } });\n};\n\n/**\n * Deletes a chat message via HTTP POST to the softDelete action\n *\n * @param graph authenticated graph client from mgt\n * @param chatId the id of the chat containing the message to delete\n * @param messageId the id of the message to delete\n * @returns {Promise<void>}\n */\nexport const deleteChatMessage = async (graph: IGraph, chatId: string, messageId: string): Promise<void> => {\n  await graph\n    .api(`/me/chats/${chatId}/messages/${messageId}/softDelete`)\n    .middlewareOptions(prepScopes(...chatOperationScopes.deleteChatMessage))\n    .post({});\n};\n\nexport const removeChatMember = async (graph: IGraph, chatId: string, membershipId: string): Promise<void> => {\n  await graph\n    .api(`/chats/${chatId}/members/${membershipId}`)\n    .middlewareOptions(prepScopes(...chatOperationScopes.removeChatMember))\n    .delete();\n};\n\nexport const addChatMembers = async (\n  graph: IGraph,\n  chatId: string,\n  userIds: string[],\n  visibleHistoryStartDateTime?: Date\n): Promise<void> => {\n  const body = {\n    requests: userIds.map((userId: string, index: number) => {\n      const addRequestBody: AadUserConversationMember & { '@odata.type': string; 'user@odata.bind': string } = {\n        '@odata.type': '#microsoft.graph.aadUserConversationMember',\n        'user@odata.bind': `https://graph.microsoft.com/v1.0/users/${userId}`,\n        roles: ['owner']\n      };\n      if (visibleHistoryStartDateTime) {\n        addRequestBody.visibleHistoryStartDateTime = visibleHistoryStartDateTime.toISOString();\n      }\n      return {\n        id: index,\n        method: 'POST',\n        url: `/chats/${chatId}/members`,\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: addRequestBody\n      };\n    })\n  };\n\n  await graph\n    .api('$batch')\n    .middlewareOptions(prepScopes(...chatOperationScopes.addChatMember))\n    .post(body);\n};\n/**\n * Whether or not the cache is enabled\n */\nexport const isPhotoCacheEnabled = (): boolean => CacheService.config.photos.isEnabled && CacheService.config.isEnabled;\n\nexport const loadChatImage = async (graph: IGraph, url: string): Promise<string | null> => {\n  let cachedPhoto: CachePhoto | null;\n\n  // attempt to get user and photo from cache if enabled\n  if (isPhotoCacheEnabled()) {\n    const cache = CacheService.getCache<CachePhoto>(schemas.photos, schemas.photos.stores.teams);\n    cachedPhoto = await cache.getValue(url);\n    if (\n      cachedPhoto?.timeCached &&\n      cachedPhoto.photo &&\n      getPhotoInvalidationTime() > Date.now() - cachedPhoto.timeCached\n    ) {\n      return cachedPhoto.photo;\n    }\n  }\n  const response = (await graph\n    .api(url)\n    .responseType(ResponseType.RAW)\n    .middlewareOptions(prepScopes(...chatOperationScopes.loadChatImage))\n    .get()) as Response & { '@odata.mediaEtag'?: string };\n\n  if (response.status === 404) {\n    // 404 means the resource does not have a photo\n    // we still want to cache that state\n    // so we return an object that can be cached\n    cachedPhoto = { eTag: undefined, photo: undefined };\n  } else if (!response.ok) {\n    return null;\n  }\n\n  const eTag = response['@odata.mediaEtag'];\n  const blob = await blobToBase64(await response.blob());\n\n  cachedPhoto = { eTag, photo: blob };\n  await storePhotoInCache(url, schemas.photos.stores.teams, cachedPhoto);\n  return blob;\n};\n\n/**\n * Creates a new chat thread via HTTP POST\n *\n * @param graph authenticated graph client from mgt\n * @param memberIds array of the user ids of users to be members of the chat. Must be at least 2.\n * @param isGroupChat if true a group chat will be created, otherwise a 1:1 chat will be created. Must be true if there are more than 2 members.\n * @param chatMessage if provided a message with this content will be sent to the chat after creation\n * @param chatName if provided and there are more than 2 members the topic of the chat will be set to this value\n * @returns {Promise<Chat>} the newly created chat\n */\nexport const createChatThread = async (\n  graph: IGraph,\n  memberIds: string[],\n  isGroupChat: boolean,\n  chatMessage: string | undefined,\n  chatName: string | undefined\n): Promise<Chat> => {\n  const body: Chat = {\n    chatType: isGroupChat || memberIds.length > 2 ? 'group' : 'oneOnOne',\n    members: memberIds.map(id => {\n      return {\n        '@odata.type': '#microsoft.graph.aadUserConversationMember',\n        roles: ['owner'],\n        'user@odata.bind': `https://graph.microsoft.com/v1.0/users('${id}')`\n      };\n    })\n  };\n  if (isGroupChat && chatName) body.topic = chatName;\n\n  const chat = (await graph\n    .api('/chats')\n    .middlewareOptions(prepScopes(...chatOperationScopes.createChat))\n    .post(body)) as Chat;\n  if (!chat?.id) throw new Error('Chat id not returned from create chat thread');\n  if (chatMessage) {\n    await sendChatMessage(graph, chat.id, chatMessage);\n  }\n\n  return chat;\n};\n\n/**\n * Updates the topic of a chat via HTTP PATCH\n *\n * @param graph {IGraph} - authenticated graph client from mgt\n * @param chatId {string} - id of the chat to update\n * @param topic {string | null} - new value for the chat topic, null will remove the currently set topic\n */\nexport const updateChatTopic = async (graph: IGraph, chatId: string, topic: string | null): Promise<void> => {\n  await graph\n    .api(`/chats/${chatId}`)\n    .middlewareOptions(prepScopes(...chatOperationScopes.updateChatMessage))\n    .patch({ topic });\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const updateMessageContentWithImage = (\n  content: string,\n  index: string,\n  messageId: string,\n  image: string\n): string => {\n  const imageId = `${messageId}-${index}`;\n  const regex = new RegExp(`(<img[^>]+id=[\"']${imageId}[\"'][^>]+)src=[\"']([^\"']*)[\"']`);\n  const replacement = `$1src=\"${image}\"`;\n  const replaced = content.replace(regex, replacement);\n  return replaced;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { ChatMessage, Message } from '@azure/communication-react';\nimport { GraphChatMessage } from 'src/statefulClient/StatefulGraphChatClient';\n\n/**\n * A typeguard to get the ChatMessage type\n * @param msg of Message\n * @returns ChatMessage\n */\nexport const isChatMessage = (msg: Message): msg is ChatMessage => {\n  return 'content' in msg;\n};\n\n/**\n * A typeguard to get the GraphChatMessage type\n * @param msg of Message\n * @returns GraphChatMessage\n */\nexport const isGraphChatMessage = (msg: Message): msg is GraphChatMessage => {\n  return 'content' in msg && 'hasUnsupportedContent' in msg && 'rawChatUrl' in msg;\n};\n","/**\n * Regex to detect and extract emoji alt text\n *\n * Pattern breakdown:\n * (<emoji[^>]+): Captures the opening emoji tag, including any attributes.\n * alt=[\"'](\\w*[^\"']*)[\"']: Matches and captures the \"alt\" attribute value within single or double quotes. The value can contain word characters but not quotes.\n * (.[^>]): Captures any remaining text within the opening emoji tag, excluding the closing angle bracket.\n * ><\\/emoji>: Matches the remaining part of the tag.\n */\nconst emojiRegex = /(<emoji[^>]+)alt=[\"'](\\w*[^\"']*)[\"'](.[^>]+)><\\/emoji>/;\nconst emojiMatch = (messageContent: string): RegExpMatchArray | null => {\n  return messageContent.match(emojiRegex);\n};\n// iterative repave the emoji custom element with the content of the alt attribute\n// on the emoji element\nconst processEmojiContent = (messageContent: string): string => {\n  let result = messageContent;\n  let match = emojiMatch(result);\n  while (match) {\n    result = result.replace(emojiRegex, '$2');\n    match = emojiMatch(result);\n  }\n  return result;\n};\n\n/**\n * if the content contains an <emoji> tag with an alt attribute the content is replaced by replacing the emoji tags with the content of their alt attribute.\n * @param {string} content\n * @returns {string} the content with any emoji tags replaced by the content of their alt attribute.\n */\nexport const rewriteEmojiContent = (content: string): string =>\n  emojiMatch(content) ? processEmojiContent(content) : content;\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  ChatMessage as AcsChatMessage,\n  ContentSystemMessage,\n  ErrorBarProps,\n  Message,\n  MessageThreadProps,\n  SendBoxProps,\n  SystemMessage\n} from '@azure/communication-react';\nimport { IDynamicPerson, getUserWithPhoto } from '@microsoft/mgt-components';\nimport {\n  ActiveAccountChanged,\n  IGraph,\n  LoginChangedEvent,\n  ProviderState,\n  Providers,\n  log,\n  warn\n} from '@microsoft/mgt-element';\nimport { GraphError } from '@microsoft/microsoft-graph-client';\nimport {\n  AadUserConversationMember,\n  Chat,\n  ChatMessage,\n  ChatMessageAttachment,\n  ChatRenamedEventMessageDetail,\n  MembersAddedEventMessageDetail,\n  MembersDeletedEventMessageDetail,\n  ChatMessageMention,\n  NullableOption\n} from '@microsoft/microsoft-graph-types';\nimport { produce } from 'immer';\nimport { v4 as uuid } from 'uuid';\nimport { currentUserId, currentUserName } from '../utils/currentUser';\nimport { graph } from '../utils/graph';\nimport { MessageCache } from './Caching/MessageCache';\nimport { GraphConfig } from './GraphConfig';\nimport { GraphNotificationClient } from './GraphNotificationClient';\nimport { ThreadEventEmitter } from './ThreadEventEmitter';\nimport {\n  MessageCollection,\n  addChatMembers,\n  deleteChatMessage,\n  loadChat,\n  loadChatImage,\n  loadChatThread,\n  loadChatThreadDelta,\n  loadMoreChatMessages,\n  removeChatMember,\n  sendChatMessage,\n  updateChatMessage,\n  updateChatTopic\n} from './graph.chat';\nimport { updateMessageContentWithImage } from '../utils/updateMessageContentWithImage';\nimport { isChatMessage } from '../utils/types';\nimport { rewriteEmojiContent } from '../utils/rewriteEmojiContent';\n\n// 1x1 grey pixel\nconst placeholderImageContent =\n  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAMSURBVBhXY7h58yYABRoCjB9qX5UAAAAASUVORK5CYII=';\n\ninterface ODataType {\n  '@odata.type': MessageEventType;\n}\ntype MembersAddedEventDetail = ODataType &\n  MembersAddedEventMessageDetail & {\n    '@odata.type': '#microsoft.graph.membersAddedEventMessageDetail';\n  };\ntype MembersRemovedEventDetail = ODataType &\n  MembersDeletedEventMessageDetail & {\n    '@odata.type': '#microsoft.graph.membersDeletedEventMessageDetail';\n  };\ntype ChatRenamedEventDetail = ODataType &\n  ChatRenamedEventMessageDetail & {\n    '@odata.type': '#microsoft.graph.chatRenamedEventMessageDetail';\n  };\n\ntype ChatMessageEvents = MembersAddedEventDetail | MembersRemovedEventDetail | ChatRenamedEventDetail;\n\nconst isChatMemberChangeEvent = (\n  eventDetail: unknown\n): eventDetail is MembersDeletedEventMessageDetail | MembersAddedEventMessageDetail => {\n  return (\n    typeof (eventDetail as MembersDeletedEventMessageDetail | MembersAddedEventMessageDetail)?.members !== 'undefined'\n  );\n};\n\n// defines the type of the state object returned from the StatefulGraphChatClient\nexport type GraphChatClient = Pick<\n  MessageThreadProps,\n  | 'userId'\n  | 'messages'\n  | 'participantCount'\n  | 'disableEditing'\n  | 'onLoadPreviousChatMessages'\n  | 'numberOfChatMessagesToReload'\n  | 'onUpdateMessage'\n  | 'onDeleteMessage'\n> &\n  Pick<SendBoxProps, 'onSendMessage'> &\n  Pick<ErrorBarProps, 'activeErrorMessages'> & {\n    status:\n      | 'initial'\n      | 'creating server connections'\n      | 'subscribing to notifications'\n      | 'loading messages'\n      | 'no chat id'\n      | 'no messages'\n      | 'ready'\n      | 'error';\n    chat?: Chat;\n  } & {\n    participants: AadUserConversationMember[];\n    onAddChatMembers: (userIds: string[], history?: Date) => Promise<void>;\n    onRemoveChatMember: (membershipId: string) => Promise<void>;\n    onRenameChat: (topic: string | null) => Promise<void>;\n    mentions: NullableOption<ChatMessageMention[]>;\n  };\n\ninterface StatefulClient<T> {\n  /**\n   * Get the current state of the client\n   */\n  getState(): T;\n  /**\n   * Register a callback to receive state updates\n   *\n   * @param handler Callback to receive state updates\n   */\n  onStateChange(handler: (state: T) => void): void;\n  /**\n   * Remove a callback from receiving state updates\n   *\n   * @param handler Callback to be unregistered\n   */\n  offStateChange(handler: (state: T) => void): void;\n}\n\ninterface CreatedOn {\n  createdOn: Date;\n}\n\n/**\n * Simple object comparator function for sorting by createdOn date\n *\n * @param {CreatedOn} a\n * @param {CreatedOn} b\n */\nconst MessageCreatedComparator = (a: CreatedOn, b: CreatedOn) => a.createdOn.getTime() - b.createdOn.getTime();\n\nconst ChatMessageCreatedComparator = (a: ChatMessage, b: ChatMessage): number => {\n  if (a.createdDateTime && b.createdDateTime) {\n    if (a.createdDateTime === b.createdDateTime) return 0;\n    if (a.createdDateTime > b.createdDateTime) return 1;\n    return -1;\n  } else if (a.createdDateTime) {\n    return 1;\n  }\n  return -1;\n};\n\ntype MessageEventType =\n  | '#microsoft.graph.membersAddedEventMessageDetail'\n  | '#microsoft.graph.membersDeletedEventMessageDetail'\n  | '#microsoft.graph.chatRenamedEventMessageDetail';\n\n/**\n * Extended Message type with additional properties.\n */\nexport type GraphChatMessage = Message & {\n  hasUnsupportedContent: boolean;\n  rawChatUrl: string;\n};\n/**\n * Holder type account for async conversion of messages.\n * Some messages need to be written to the UI immediately and receive an async update.\n * Some messages do not have a current value and will be added after the future value is resolved.\n * Some messages do not have a future value and will be added immediately.\n */\ninterface MessageConversion {\n  currentValue?: GraphChatMessage;\n  futureValue?: Promise<GraphChatMessage>;\n}\n\n/**\n * Regex to detect and replace image urls using graph requests to supply the image content\n */\nconst graphImageUrlRegex = /(<img[^>]+)src=([\"']https:\\/\\/graph\\.microsoft\\.com[^\"']*[\"'])/;\n\nclass StatefulGraphChatClient implements StatefulClient<GraphChatClient> {\n  private readonly _notificationClient: GraphNotificationClient;\n  private readonly _eventEmitter: ThreadEventEmitter;\n  private readonly _cache: MessageCache;\n  private _subscribers: ((state: GraphChatClient) => void)[] = [];\n  private get _messagesPerCall() {\n    return 5;\n  }\n  private _nextLink?: string;\n  private _chat?: Chat = undefined;\n  private _userDisplayName = '';\n\n  constructor() {\n    this.updateUserInfo();\n    Providers.globalProvider.onStateChanged(this.onLoginStateChanged);\n    Providers.globalProvider.onActiveAccountChanged(this.onActiveAccountChanged);\n    this._eventEmitter = new ThreadEventEmitter();\n    this.registerEventListeners();\n    this._cache = new MessageCache();\n    this._notificationClient = new GraphNotificationClient(this._eventEmitter, graph('mgt-chat', GraphConfig.version));\n  }\n\n  /**\n   * Provides a method to clean up any resources being used internally when a consuming component is being removed from the DOM\n   */\n  public async tearDown() {\n    await this._notificationClient.tearDown();\n  }\n\n  /**\n   * Register a callback to receive state updates\n   *\n   * @param {(state: GraphChatClient) => void} handler\n   * @memberof StatefulGraphChatClient\n   */\n  public onStateChange(handler: (state: GraphChatClient) => void): void {\n    if (!this._subscribers.includes(handler)) {\n      this._subscribers.push(handler);\n    }\n  }\n\n  /**\n   * Unregister a callback from receiving state updates\n   *\n   * @param {(state: GraphChatClient) => void} handler\n   * @memberof StatefulGraphChatClient\n   */\n  public offStateChange(handler: (state: GraphChatClient) => void): void {\n    const index = this._subscribers.indexOf(handler);\n    if (index !== -1) {\n      this._subscribers = this._subscribers.splice(index, 1);\n    }\n  }\n\n  /**\n   * Calls each subscriber with the next state to be emitted\n   *\n   * @param recipe - a function which produces the next state to be emitted\n   */\n  private notifyStateChange(recipe: (draft: GraphChatClient) => void) {\n    this._state = produce(this._state, recipe);\n    this._subscribers.forEach(handler => handler(this._state));\n  }\n\n  /**\n   * Return the current state of the chat client\n   *\n   * @return {{GraphChatClient}\n   * @memberof StatefulGraphChatClient\n   */\n  public getState(): GraphChatClient {\n    return this._state;\n  }\n\n  /**\n   * Update the state of the client when the Login state changes\n   *\n   * @private\n   * @param {LoginChangedEvent} e The event that triggered the change\n   * @memberof StatefulGraphChatClient\n   */\n  private readonly onLoginStateChanged = (e: LoginChangedEvent) => {\n    switch (e.detail) {\n      case ProviderState.SignedIn:\n        // update userId and displayName\n        this.updateUserInfo();\n        // load messages?\n        // configure subscriptions\n        // emit new state;\n        if (this.chatId) {\n          void this.updateFollowedChat();\n        }\n        return;\n      case ProviderState.SignedOut:\n        // clear userId\n        // clear subscriptions\n        // clear messages\n        // emit new state\n        return;\n      case ProviderState.Loading:\n      default:\n        // do nothing for now\n        return;\n    }\n  };\n\n  private readonly onActiveAccountChanged = (e: ActiveAccountChanged) => {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (e.detail && this.userId !== e.detail?.id) {\n      void this.handleAccountChange();\n    }\n  };\n\n  private readonly handleAccountChange = async () => {\n    this.clearCurrentUserMessages();\n    // need to ensure that we close any existing connection if present\n    await this._notificationClient?.closeSignalRConnection();\n\n    this.updateUserInfo();\n    // by updating the followed chat the notification client will reconnect to SignalR\n    await this.updateFollowedChat();\n  };\n\n  private clearCurrentUserMessages() {\n    this.notifyStateChange((draft: GraphChatClient) => {\n      draft.messages = [];\n      draft.participants = [];\n      draft.chat = undefined;\n      draft.status = 'initial'; // no message?\n    });\n  }\n\n  private updateUserInfo() {\n    this.updateCurrentUserId();\n    this.updateCurrentUserName();\n  }\n\n  /**\n   * Changes the userDisplayName to the current value.\n   */\n  private updateCurrentUserName() {\n    this._userDisplayName = currentUserName();\n  }\n\n  /**\n   * Changes the current user ID value to the current value.\n   */\n  private updateCurrentUserId() {\n    this.userId = currentUserId();\n  }\n\n  /**\n   * Current User ID.\n   */\n  private _userId = '';\n\n  /**\n   * Returns the current User ID.\n   */\n  public get userId() {\n    return this._userId;\n  }\n\n  /**\n   * Sets the current User ID and updates the state value.\n   */\n  private set userId(userId: string) {\n    if (this._userId === userId) {\n      return;\n    }\n    this._userId = userId;\n    this.notifyStateChange((draft: GraphChatClient) => {\n      draft.userId = userId;\n    });\n  }\n\n  /**\n   * Current chat ID.\n   */\n  private _chatId = '';\n\n  /**\n   * Get the current chat ID.\n   */\n  public get chatId() {\n    return this._chatId;\n  }\n\n  /**\n   * Set the current chat ID and tries to get the chat data.\n   */\n  private set chatId(value: string) {\n    // take no action if the chatId is the same\n    if (value && this._chatId === value) {\n      return;\n    }\n    this._chatId = value;\n    if (this._chatId && this._sessionId) {\n      void this.updateFollowedChat();\n    }\n  }\n\n  private _sessionId: string | undefined;\n\n  public subscribeToChat(chatId: string, sessionId: string) {\n    if (chatId && sessionId) {\n      this._sessionId = sessionId;\n      this.chatId = chatId;\n    }\n  }\n\n  /**\n   * A helper to co-ordinate the loading of a chat and its messages, and the subscription to notifications for that chat\n   *\n   * @private\n   * @memberof StatefulGraphChatClient\n   */\n  private async updateFollowedChat() {\n    // avoid subscribing to a resource with an empty chatId\n    if (this.chatId && this._sessionId) {\n      // reset state to initial\n      this.notifyStateChange((draft: GraphChatClient) => {\n        draft.status = 'initial';\n        draft.messages = [];\n        draft.mentions = [];\n        draft.chat = undefined;\n        draft.participants = [];\n      });\n      // Subscribe to notifications for messages\n      this.notifyStateChange((draft: GraphChatClient) => {\n        draft.status = 'creating server connections';\n      });\n      try {\n        // Prefer sequential promise resolving to catch loading message errors\n        // TODO: in parallel promise resolving, find out how to trigger different\n        // TODO: state for failed subscriptions in GraphChatClient.onSubscribeFailed\n        const tasks: Promise<unknown>[] = [this.loadChatData()];\n        // subscribing to notifications will trigger the chatMessageNotificationsSubscribed event\n        // this client will then load the chat and messages when that event listener is called\n        tasks.push(this._notificationClient.subscribeToChatNotifications(this._chatId, this._sessionId));\n        await Promise.all(tasks);\n      } catch (e) {\n        console.error('Failed to load chat data or subscribe to notications: ', e);\n        if (e instanceof GraphError) {\n          this.notifyStateChange((draft: GraphChatClient) => {\n            draft.status = 'no messages';\n          });\n        }\n      }\n    } else {\n      this.notifyStateChange((draft: GraphChatClient) => {\n        draft.status = 'no chat id';\n      });\n    }\n  }\n\n  private async loadChatData() {\n    this.notifyStateChange((draft: GraphChatClient) => {\n      draft.status = 'loading messages';\n    });\n    try {\n      this._chat = await loadChat(this.graph, this.chatId);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n    const cachedMessages = await this._cache.loadMessages(this._chatId);\n    if (cachedMessages) {\n      // use currently cached data\n      await this.writeMessagesToState(cachedMessages);\n      // load delta messages\n      const deltaMessages = await this.loadDeltaData(this._chatId, cachedMessages.lastModifiedDateTime);\n      // add delta messages to cache\n      const updatedState = await this._cache.cacheMessages(this._chatId, deltaMessages);\n      // writeMessagesToState concats with existing state, need to be careful not to create duplicate messages\n      updatedState.value = deltaMessages;\n      // update state\n      await this.writeMessagesToState(updatedState);\n    } else {\n      const messages: MessageCollection = await loadChatThread(this.graph, this._chatId, this._messagesPerCall);\n      await this._cache.cacheMessages(this._chatId, messages.value, true, messages.nextLink);\n      await this.writeMessagesToState(messages);\n    }\n  }\n\n  private async loadDeltaData(chatId: string, lastModified: string): Promise<ChatMessage[]> {\n    const result: ChatMessage[] = [];\n    let response = await loadChatThreadDelta(this.graph, chatId, lastModified, this._messagesPerCall);\n    result.push(...response.value);\n    while (response.nextLink) {\n      response = await loadMoreChatMessages(this.graph, response.nextLink);\n      result.push(...response.value);\n    }\n    return result.sort(ChatMessageCreatedComparator);\n  }\n\n  /**\n   * Handles updating state based on the response to a graph request for a collection of messages\n   * Handles messages that can be imedately rendered and those that require async calls to fetch data\n   *\n   * @private\n   * @param {MessageCollection} messages\n   * @memberof StatefulGraphChatClient\n   */\n  private async writeMessagesToState(messages: MessageCollection) {\n    this._nextLink = messages.nextLink;\n\n    const messageConversions = messages.value\n      // trying to filter out messages on the graph request causes a 400\n      // deleted messages are returned as messages with no content, which we can't filter on the graph request\n      // so we filter them out here\n      .filter(m => m.body?.content)\n      // This gives us both current and eventual values for each message\n      .map(m => this.convertChatMessage(m));\n\n    // Collect mentions\n    const mentions: NullableOption<ChatMessageMention[]> = messages.value\n      .map(m => m.mentions)\n      .filter(m => m?.length) as NullableOption<ChatMessageMention[]>;\n\n    // update the state with the current values\n    this.notifyStateChange((draft: GraphChatClient) => {\n      draft.participants = this._chat?.members || [];\n      draft.participantCount = draft.participants.length;\n      const initialMessages: Message[] = [];\n      draft.messages = draft.messages\n        .concat(\n          messageConversions\n            .map(m => m.currentValue)\n            // need to use a reduce here to filter out undefined values in a way that TypeScript understands\n            .reduce((acc, val) => {\n              if (val) acc.push(val);\n              return acc;\n            }, initialMessages)\n        )\n        .sort(MessageCreatedComparator);\n      draft.onLoadPreviousChatMessages = this._nextLink ? this.loadMoreMessages : undefined;\n      draft.status = this._nextLink ? 'loading messages' : 'ready';\n      draft.chat = this._chat;\n      // Keep updating if there was a next link.\n      draft.mentions = draft.mentions?.concat(\n        ...Array.from(mentions as Iterable<ChatMessageMention>)\n      ) as NullableOption<ChatMessageMention[]>;\n    });\n    const futureMessages = messageConversions.filter(m => m.futureValue).map(m => m.futureValue);\n    // if there are eventual future values, wait for them to resolve and update the state\n    if (futureMessages.length > 0) {\n      (await Promise.all(futureMessages)).forEach(m => {\n        this.updateMessages(m);\n      });\n    }\n  }\n\n  /**\n   * Utility to convert a Graph Chat Message to an ACS Chat Message\n   * Some graph chat messages can synchronously be converted to ACS chat messages\n   * Others require an async call to get the ACS chat message\n   * Some messages can provide an initial state for immediate rendering while the async call is in progress\n   * This method returns an object containing the current value and a Promise of a future value\n   *\n   * @private\n   * @param {ChatMessage} message\n   * @return {*}  {MessageConversion}\n   * @memberof StatefulGraphChatClient\n   */\n  private convertChatMessage(message: ChatMessage): MessageConversion {\n    switch (message.messageType) {\n      case 'message':\n        return this.graphChatMessageToAcsChatMessage(message, this.userId);\n      case 'systemEventMessage':\n      case 'unknownFutureValue':\n        return { futureValue: this.buildSystemContentMessage(message) } as MessageConversion;\n      default:\n        throw new Error(`Unknown message type ${message.messageType?.toString() || 'undefined'}`);\n    }\n  }\n\n  /**\n   * Convert an event type to the name of an icon registered in registerIcons.tsx\n   *\n   * @param eventType\n   * @returns\n   */\n  private readonly resolveIcon = (eventType: MessageEventType): string => {\n    switch (eventType) {\n      case '#microsoft.graph.membersAddedEventMessageDetail':\n        return 'add-friend';\n      case '#microsoft.graph.membersDeletedEventMessageDetail':\n        return 'left-chat';\n      case '#microsoft.graph.chatRenamedEventMessageDetail':\n        return 'edit-svg';\n      default:\n        return 'Unknown';\n    }\n  };\n\n  private async buildSystemContentMessage(message: ChatMessage): Promise<SystemMessage> {\n    const eventDetail = message.eventDetail as ChatMessageEvents;\n    let messageContent = '';\n    const awaits: Promise<IDynamicPerson>[] = [];\n    const initiatorId = eventDetail.initiator?.user?.id;\n    // we're using getUserWithPhoto here because we want to tap into the caching that mgt-person uses to cut down on graph calls\n    if (initiatorId) {\n      awaits.push(getUserWithPhoto(this.graph, initiatorId));\n      const userIds: string[] = [];\n      if (isChatMemberChangeEvent(eventDetail)) {\n        eventDetail.members?.reduce((acc, m) => {\n          if (typeof m.id === 'string') {\n            acc.push(m.id);\n          }\n          return acc;\n        }, userIds);\n      }\n      for (const id of userIds ?? []) {\n        awaits.push(getUserWithPhoto(this.graph, id));\n      }\n      const people = await Promise.all(awaits);\n      const userNames = userIds?.map(m => this.getUserName(m, people)).join(', ');\n      switch (eventDetail['@odata.type']) {\n        case '#microsoft.graph.membersAddedEventMessageDetail':\n          messageContent = `${this.getUserName(initiatorId, people)} added ${userNames}`;\n          break;\n        case '#microsoft.graph.membersDeletedEventMessageDetail':\n          messageContent = `${this.getUserName(initiatorId, people)} removed ${userNames}`;\n          break;\n        case '#microsoft.graph.chatRenamedEventMessageDetail':\n          messageContent = eventDetail.chatDisplayName\n            ? `${this.getUserName(initiatorId, people)} renamed the chat to ${eventDetail.chatDisplayName}`\n            : `${this.getUserName(initiatorId, people)} removed the group name for this conversation`;\n          break;\n        // TODO: move this default case to a console.warn before release and emit an empty message\n        // it's here to help us catch messages we have't handled yet\n        default:\n          // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n          warn(`Unknown system message type ${eventDetail['@odata.type']}\n\ndetail: ${JSON.stringify(eventDetail)}`);\n      }\n    }\n\n    const result: ContentSystemMessage = {\n      createdOn: message.createdDateTime ? new Date(message.createdDateTime) : new Date(),\n      messageId: message.id || '',\n      systemMessageType: 'content',\n      messageType: 'system',\n      iconName: this.resolveIcon(eventDetail['@odata.type']),\n      content: messageContent\n    };\n\n    return result;\n  }\n\n  private getUserName(userId: string, people: IDynamicPerson[]) {\n    return people.find(p => p.id === userId)?.displayName || 'unknown user';\n  }\n\n  /**\n   * Async callback to load more messages\n   *\n   * @returns true if there are no more messages to load\n   */\n  private readonly loadMoreMessages = async () => {\n    if (!this._nextLink) {\n      return true;\n    }\n    const messages: MessageCollection = await loadMoreChatMessages(this.graph, this._nextLink);\n    await this._cache.cacheMessages(this._chatId, messages.value, true, messages.nextLink);\n    await this.writeMessagesToState(messages);\n    // return true when there are no more messages to load\n    return !this._nextLink;\n  };\n\n  /**\n   * Send a message to the chat thread\n   *\n   * @param {string} content - the content of the message\n   * @memberof StatefulGraphChatClient\n   */\n  public sendMessage = async (content: string) => {\n    if (!content) return;\n\n    const pendingId = uuid();\n\n    // add a pending message to the state.\n    this.notifyStateChange((draft: GraphChatClient) => {\n      const pendingMessage: Message = {\n        clientMessageId: pendingId,\n        messageId: pendingId,\n        contentType: 'text',\n        messageType: 'chat',\n        content,\n        senderDisplayName: this._userDisplayName,\n        createdOn: new Date(),\n        senderId: this.userId,\n        mine: true,\n        status: 'sending'\n      };\n      draft.messages.push(pendingMessage);\n    });\n    try {\n      // send message\n      const chat: ChatMessage = await sendChatMessage(this.graph, this.chatId, content);\n      // emit new state\n      this.notifyStateChange((draft: GraphChatClient) => {\n        const draftIndex = draft.messages.findIndex(m => m.messageId === pendingId);\n        const message = this.graphChatMessageToAcsChatMessage(chat, this.userId).currentValue;\n        // we only need use the current value of the message\n        // this message can't have a future value as it's not been sent yet\n        if (message) draft.messages.splice(draftIndex, 1, message);\n      });\n    } catch (e) {\n      this.notifyStateChange((draft: GraphChatClient) => {\n        const draftMessage = draft.messages.find(m => m.messageId === pendingId);\n        (draftMessage as AcsChatMessage).status = 'failed';\n      });\n      throw new Error('Failed to send message');\n    }\n  };\n\n  /*\n   * Helper method to set the content of a message to show deletion\n   */\n  private readonly setDeletedContent = (message: AcsChatMessage) => {\n    message.content = '<em>This message has been deleted.</em>';\n    message.contentType = 'html';\n  };\n\n  /**\n   * Handler to delete a message\n   *\n   * @param messageId id of the message to be deleted, this is the clientMessageId when triggered by the re-send action on a failed message, or the messageId when triggered by the delete action on a sent message\n   * @returns {Promise<void>}\n   */\n  public deleteMessage = async (messageId: string): Promise<void> => {\n    if (!messageId) return;\n    const message = this._state.messages.find(m => m.messageId === messageId) as AcsChatMessage;\n    // only messages not persisted to graph should have a clientMessageId\n    const uncommitted = this._state.messages.find(\n      m => (m as AcsChatMessage).clientMessageId === messageId\n    ) as AcsChatMessage;\n    if (message?.mine) {\n      try {\n        // uncommitted messages are not persisted to the graph, so don't call graph when deleting them\n        if (!uncommitted) {\n          await deleteChatMessage(this.graph, this.chatId, messageId);\n        }\n        this.notifyStateChange((draft: GraphChatClient) => {\n          const draftMessage = draft.messages.find(m => m.messageId === messageId) as AcsChatMessage;\n          if (draftMessage.clientMessageId) {\n            // just remove messages that were not saved to the graph\n            draft.messages.splice(draft.messages.indexOf(draftMessage), 1);\n          } else {\n            // show deleted messages which have been persisted to the graph as deleted in the UI\n            this.setDeletedContent(draftMessage);\n          }\n        });\n      } catch (e) {\n        // TODO: How do we handle failed deletes?\n      }\n    }\n  };\n\n  /**\n   * Update a message in the thread\n   *\n   * @param {string} messageId Id of the message to be updated\n   * @param {string} content new content of the message\n   * @memberof StatefulGraphChatClient\n   */\n  public updateMessage = async (messageId: string, content: string) => {\n    if (!messageId || !content) return;\n    const message = this._state.messages.find(m => m.messageId === messageId) as AcsChatMessage;\n    if (message?.mine && message.content) {\n      this.notifyStateChange((draft: GraphChatClient) => {\n        const updating = draft.messages.find(m => m.messageId === messageId) as AcsChatMessage;\n        if (updating) {\n          updating.content = content;\n          updating.status = 'sending';\n        }\n      });\n      try {\n        await updateChatMessage(this.graph, this.chatId, messageId, content);\n        this.notifyStateChange((draft: GraphChatClient) => {\n          const updated = draft.messages.find(m => m.messageId === messageId) as AcsChatMessage;\n          updated.status = 'delivered';\n        });\n      } catch (e) {\n        this.notifyStateChange((draft: GraphChatClient) => {\n          const updating = draft.messages.find(m => m.messageId === messageId) as AcsChatMessage;\n          updating.status = 'failed';\n        });\n        throw new Error('Failed to update message');\n      }\n    }\n  };\n\n  /*\n   * Event handler to be called when a new message is received by the notification service\n   */\n  private readonly onMessageReceived = async (message: ChatMessage) => {\n    this.updateMentions(message);\n    await this._cache.cacheMessage(this._chatId, message);\n    const messageConversion = this.convertChatMessage(message);\n    const acsMessage = messageConversion.currentValue;\n    this.updateMessages(acsMessage);\n    if (messageConversion.futureValue) {\n      // if we have a future value then we need to wait for it to resolve before we can send the read receipt\n      const futureMessageState = await messageConversion.futureValue;\n      this.updateMessages(futureMessageState);\n    }\n  };\n\n  /**\n   * When you receive a new message, check if there are any mentions and update\n   * the state. This will allow to match users to mentions them during rendering.\n   *\n   * @param newMessage from teams.\n   * @returns\n   */\n  private readonly updateMentions = (newMessage: ChatMessage) => {\n    if (!newMessage) return;\n    this.notifyStateChange((draft: GraphChatClient) => {\n      const mentions = newMessage?.mentions ?? [];\n      draft.mentions = draft.mentions?.concat(\n        ...Array.from(mentions as Iterable<ChatMessageMention>)\n      ) as NullableOption<ChatMessageMention[]>;\n    });\n  };\n\n  /*\n   * Event handler to be called when a message deletion is received by the notification service\n   */\n  private readonly onMessageDeleted = (message: ChatMessage) => {\n    void this._cache.deleteMessage(this.chatId, message);\n    this.notifyStateChange((draft: GraphChatClient) => {\n      const draftMessage = draft.messages.find(m => m.messageId === message.id) as AcsChatMessage;\n      // TODO: confirm if we should show the deleted content message in all cases or only when the message was deleted by the current user\n      if (draftMessage) this.setDeletedContent(draftMessage);\n    });\n  };\n\n  /*\n   * Event handler to be called when a message edit is received by the notification service\n   */\n  private readonly onMessageEdited = async (message: ChatMessage) => {\n    await this._cache.cacheMessage(this._chatId, message);\n    const messageConversion = this.convertChatMessage(message);\n    this.updateMessages(messageConversion.currentValue);\n    if (messageConversion.futureValue) {\n      const eventualState = await messageConversion.futureValue;\n      this.updateMessages(eventualState);\n    }\n  };\n\n  private readonly checkForMissedMessages = async () => {\n    const messages: MessageCollection = await loadChatThread(this.graph, this.chatId, this._messagesPerCall);\n    const messageConversions = messages.value\n      // trying to filter out messages on the graph request causes a 400\n      // deleted messages are returned as messages with no content, which we can't filter on the graph request\n      // so we filter them out here\n      // Violating DLP returns content as empty BUT with policyViolation set\n      .filter(m => m.body?.content || (!m.body?.content && m?.policyViolation))\n      // This gives us both current and eventual values for each message\n      .map(m => this.convertChatMessage(m));\n\n    // update the state with the current values\n    const currentValueMessages: GraphChatMessage[] = [];\n    messageConversions\n      .map(m => m.currentValue)\n      // need to use a reduce here to filter out undefined values in a way that TypeScript understands\n      .reduce((acc, val) => {\n        if (val) acc.push(val);\n        return acc;\n      }, currentValueMessages);\n    currentValueMessages.forEach(m => this.updateMessages(m));\n    const futureMessages = messageConversions.filter(m => m.futureValue).map(m => m.futureValue);\n    // if there are eventual future values, wait for them to resolve and update the state\n    if (futureMessages.length > 0) {\n      (await Promise.all(futureMessages)).forEach(m => {\n        this.updateMessages(m);\n      });\n    }\n    const hasOverlapWithExistingMessages = messages.value.some(m =>\n      this._state.messages.find(sm => sm.messageId === m.id)\n    );\n    if (!hasOverlapWithExistingMessages) {\n      // TODO handle the case where there were a lot of missed messages and we ned to get the next page of messages.\n      // This is not a common case, but we should handle it.\n    }\n    log('checked for missed messages');\n  };\n\n  private readonly onChatNotificationsSubscribed = (resource: string): void => {\n    if (resource.includes(`/${this.chatId}/`) && resource.includes('/messages')) {\n      void this.checkForMissedMessages();\n    } else {\n      // better clean this up as we don't want to be listening to events for other chats\n    }\n  };\n\n  private readonly onChatPropertiesUpdated = (chat: Chat): void => {\n    this._chat = chat;\n    this.notifyStateChange((draft: GraphChatClient) => {\n      draft.chat = chat;\n    });\n  };\n\n  private readonly onParticipantAdded = (added: AadUserConversationMember): void => {\n    this.notifyStateChange((draft: GraphChatClient) => {\n      if (!draft.participants.find(p => p.id === added.id)) {\n        draft.participants.push(added);\n      }\n    });\n  };\n\n  private readonly onParticipantRemoved = (added: AadUserConversationMember): void => {\n    if (added.id) this.removeParticipantFromState(added.id);\n  };\n\n  /**\n   * Update the state with given message either replacing an existing message matching on the id or adding to the list\n   *\n   * @private\n   * @param {(GraphChatMessage)} [message]\n   * @return {*}\n   * @memberof StatefulGraphChatClient\n   */\n  private updateMessages(message?: GraphChatMessage) {\n    if (!message) return;\n    this.notifyStateChange((draft: GraphChatClient) => {\n      const index = draft.messages.findIndex(m => m.messageId === message.messageId);\n      // this message is not already in thread so just add it\n      if (index === -1) {\n        // sort to ensure that messages are in the correct order should we get messages out of order\n        draft.messages = draft.messages.concat(message).sort(MessageCreatedComparator);\n      } else {\n        // replace the existing version of the message with the new one\n        draft.messages.splice(index, 1, message);\n      }\n    });\n  }\n\n  private removeParticipantFromState(membershipId: string): void {\n    this.notifyStateChange((draft: GraphChatClient) => {\n      const index = draft.participants.findIndex(p => p.id === membershipId);\n      if (index !== -1) {\n        draft.participants.splice(index, 1);\n      }\n    });\n  }\n\n  private readonly addChatMembers = async (userIds: string[], history?: Date): Promise<void> => {\n    await addChatMembers(this.graph, this.chatId, userIds, history);\n  };\n\n  /**\n   * Removes the given member from the chat\n   *\n   * @param membershpId {string} id of the user for the chat,\n   * this is the id of the chat member resource in the graph, i.e. member.id, and NOT the user's id\n   * @returns {Promise<void>}\n   */\n  private readonly removeChatMember = async (membershpId: string): Promise<void> => {\n    if (!membershpId) return;\n    const isPresent = this._chat?.members?.findIndex(m => m.id === membershpId) ?? -1;\n    if (isPresent === -1) return;\n    await removeChatMember(this.graph, this.chatId, membershpId);\n    this.removeParticipantFromState(membershpId);\n  };\n\n  private graphImageMatch(messageContent: string): RegExpMatchArray | null {\n    return messageContent.match(graphImageUrlRegex);\n  }\n\n  private processMessageContent(graphMessage: ChatMessage, currentUser: string): MessageConversion {\n    const conversion: MessageConversion = {};\n    // using a record here lets us track which image in the content each request is for\n    const futureImages: Record<number, Promise<string | null>> = {};\n    let messageResult = graphMessage.body?.content ?? '';\n    const messageId = graphMessage.id ?? '';\n    let index = 0;\n    let match = this.graphImageMatch(messageResult);\n    while (match) {\n      // note that the regex to replace the placeholder requires that the id be before and adjacent to the src attribute\n      messageResult = messageResult.replace(\n        graphImageUrlRegex,\n        `$1id=\"${messageId}-${index}\" src=\"${placeholderImageContent}\"`\n      );\n      const graphImageUrl = match[2].replace(/[\"']/g, '');\n      // collect promises for the image requests so that we can update the message content once they are all resolved\n      futureImages[index] = loadChatImage(this.graph, graphImageUrl);\n      index++;\n      match = this.graphImageMatch(messageResult);\n    }\n    let placeholderMessage = this.buildAcsMessage(graphMessage, currentUser, messageId, messageResult);\n    conversion.currentValue = placeholderMessage;\n    // local function to update the message with data from each of the resolved image requests\n    const updateMessage = async () => {\n      await Promise.all(Object.values(futureImages));\n      for (const [imageIndex, futureImage] of Object.entries(futureImages)) {\n        const image = await futureImage;\n        if (image && isChatMessage(placeholderMessage)) {\n          placeholderMessage = {\n            ...placeholderMessage,\n            ...{\n              content: updateMessageContentWithImage(placeholderMessage.content ?? '', imageIndex, messageId, image)\n            }\n          };\n        }\n      }\n      return placeholderMessage;\n    };\n    conversion.futureValue = updateMessage();\n    return conversion;\n  }\n\n  private graphChatMessageToAcsChatMessage(graphMessage: ChatMessage, currentUser: string): MessageConversion {\n    const messageId = graphMessage?.id ?? '';\n    if (!messageId) {\n      throw new Error('Cannot convert graph message to ACS message. No ID found on graph message');\n    }\n    let content = graphMessage.body?.content ?? 'undefined';\n    let result: MessageConversion = {};\n    // do simple emoji replacement first\n    content = rewriteEmojiContent(content);\n    // Handle any mentions in the content\n    content = this.updateMentionsContent(content);\n\n    const imageMatch = this.graphImageMatch(content ?? '');\n    if (imageMatch) {\n      // if the message contains an image, we need to fetch the image and replace the placeholder\n      result = this.processMessageContent(graphMessage, currentUser);\n    } else {\n      result.currentValue = this.buildAcsMessage(graphMessage, currentUser, messageId, content);\n    }\n    return result;\n  }\n\n  /**\n   * Teams mentions are in the pattern <at id=\"1\">User</at>. This replacement\n   * changes the mentions pattern to <msft-mention id=\"1\">User</msft-mention>\n   * which will trigger the `mentionOptions` prop to be called in MessageThread.\n   *\n   * @param content is the message with mentions.\n   * @returns string with replaced mention parts.\n   */\n  private updateMentionsContent(content: string): string {\n    const msftMention = `<msft-mention id=\"$1\">$2</msft-mention>`;\n    const atRegex = /<at\\sid=\"(\\d+)\">([a-z0-9_.-\\s]+)<\\/at>/gim;\n    content = content\n      .replace(/&nbsp;<at/gim, '<at')\n      .replace(/at>&nbsp;/gim, 'at>')\n      .replace(atRegex, msftMention);\n    return content;\n  }\n\n  private hasUnsupportedContent(content: string, attachments: ChatMessageAttachment[]): boolean {\n    const unsupportedContentTypes = [\n      'application/vnd.microsoft.card.codesnippet',\n      'application/vnd.microsoft.card.fluid',\n      'reference'\n    ];\n    const isUnsupported: boolean[] = [];\n\n    if (attachments.length) {\n      for (const attachment of attachments) {\n        const contentType = attachment?.contentType ?? '';\n        isUnsupported.push(unsupportedContentTypes.includes(contentType));\n      }\n    } else {\n      // checking content with <attachment> tags\n      const unsupportedContentRegex = /<\\/?attachment>/gim;\n      const contentUnsupported = Boolean(content) && unsupportedContentRegex.test(content);\n      isUnsupported.push(contentUnsupported);\n    }\n    return isUnsupported.every(e => e === true);\n  }\n\n  private buildAcsMessage(\n    graphMessage: ChatMessage,\n    currentUser: string,\n    messageId: string,\n    content: string\n  ): GraphChatMessage {\n    const senderId = graphMessage.from?.user?.id || undefined;\n    const chatId = graphMessage?.chatId ?? '';\n    const id = graphMessage?.id ?? '';\n    const chatUrl = `https://teams.microsoft.com/l/message/${chatId}/${id}?context={\"contextType\":\"chat\"}`;\n    const attachments = graphMessage?.attachments ?? [];\n\n    let messageData: GraphChatMessage = {\n      messageId,\n      contentType: graphMessage.body?.contentType ?? 'text',\n      messageType: 'chat',\n      content,\n      senderDisplayName: graphMessage.from?.user?.displayName ?? undefined,\n      createdOn: new Date(graphMessage.createdDateTime ?? Date.now()),\n      editedOn: graphMessage.lastEditedDateTime ? new Date(graphMessage.lastEditedDateTime) : undefined,\n      senderId,\n      mine: senderId === currentUser,\n      status: 'seen',\n      attached: 'top',\n      hasUnsupportedContent: this.hasUnsupportedContent(content, attachments),\n      rawChatUrl: chatUrl\n    };\n    if (graphMessage?.policyViolation) {\n      messageData = Object.assign(messageData, {\n        messageType: 'blocked',\n        link: 'https://go.microsoft.com/fwlink/?LinkId=2132837'\n      });\n    }\n    return messageData;\n  }\n\n  private readonly renameChat = async (topic: string | null): Promise<void> => {\n    await updateChatTopic(this.graph, this.chatId, topic);\n    this.notifyStateChange(() => void (this._chat = { ...this._chat, ...{ topic } }));\n  };\n\n  /**\n   * Register event listeners for chat events to be triggered from the notification service\n   */\n  private registerEventListeners() {\n    this._eventEmitter.on('chatMessageReceived', (message: ChatMessage) => void this.onMessageReceived(message));\n    this._eventEmitter.on('chatMessageDeleted', this.onMessageDeleted);\n    this._eventEmitter.on('chatMessageEdited', (message: ChatMessage) => void this.onMessageEdited(message));\n    this._eventEmitter.on('notificationsSubscribedForResource', this.onChatNotificationsSubscribed);\n    this._eventEmitter.on('chatThreadPropertiesUpdated', this.onChatPropertiesUpdated);\n    // TODO: add define how to handle chat deletion\n    // this._eventEmitter.on('chatThreadDeleted', this.onChatDeleted);\n    this._eventEmitter.on('participantAdded', this.onParticipantAdded);\n    this._eventEmitter.on('participantRemoved', this.onParticipantRemoved);\n  }\n\n  /**\n   * Provided the graph instance for the component with the correct SDK version decoration\n   *\n   * @readonly\n   * @private\n   * @type {IGraph}\n   * @memberof StatefulGraphChatClient\n   */\n  private get graph(): IGraph {\n    return graph('mgt-chat');\n  }\n\n  private readonly _initialState: GraphChatClient = {\n    status: 'initial',\n    userId: '',\n    messages: [],\n    mentions: [],\n    participants: [],\n    get participantCount() {\n      return this.participants?.length || 0;\n    },\n    disableEditing: false,\n    numberOfChatMessagesToReload: this._messagesPerCall,\n    onDeleteMessage: this.deleteMessage,\n    onSendMessage: this.sendMessage,\n    onUpdateMessage: this.updateMessage,\n    onAddChatMembers: this.addChatMembers,\n    onRemoveChatMember: this.removeChatMember,\n    onRenameChat: this.renameChat,\n    activeErrorMessages: [],\n    chat: this._chat\n  };\n  /**\n   * State of the chat client with initial values set\n   *\n   * @private\n   * @type {GraphChatClient}\n   * @memberof StatefulGraphChatClient\n   */\n  private _state: GraphChatClient = { ...this._initialState };\n}\n\nexport { StatefulGraphChatClient };\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport { makeStyles, shorthands } from '@fluentui/react-components';\nimport React from 'react';\nimport { ArrowSquareUpRight24Regular } from '@fluentui/react-icons';\n\nconst useStyles = makeStyles({\n  container: {\n    backgroundColor: '#ebebeb',\n    display: 'flex',\n    boxShadow: '0px 4px 8px 0px rgba(0, 0, 0, 0.14), 0px 0px 2px 0px rgba(0, 0, 0, 0.12)',\n    textDecorationLine: 'none',\n    color: '#424242',\n    ...shorthands.margin('18px', '0px', '8px', '0px'),\n    ...shorthands.borderRadius('6px'),\n    ...shorthands.padding('16px'),\n    ...shorthands.gap('6px'),\n    ':hover': {\n      backgroundColor: '#fafafa'\n    },\n    ':visited': {\n      color: '#424242'\n    }\n  },\n  cta: {\n    fontFamily: 'Segoe UI',\n    fontSize: '12px',\n    fontStyle: 'normal',\n    fontWeight: '400',\n    lineHeight: '16px',\n    textDecorationLine: 'none'\n  }\n});\n\ninterface UnsupportedContentProps {\n  targetUrl: string;\n}\n\nconst UnsupportedContent = (props: UnsupportedContentProps) => {\n  const styles = useStyles();\n  return (\n    <a className={styles.container} target=\"blank\" href={props.targetUrl}>\n      <ArrowSquareUpRight24Regular />\n      <p className={styles.cta}>View this message in Microsoft Teams.</p>\n    </a>\n  );\n};\n\nexport default UnsupportedContent;\n","import { MessageProps, MessageRenderer } from '@azure/communication-react';\nimport produce from 'immer';\nimport React from 'react';\nimport { renderToString } from 'react-dom/server';\nimport UnsupportedContent from '../components/UnsupportedContent/UnsupportedContent';\nimport { isChatMessage, isGraphChatMessage } from '../utils/types';\n\n/**\n * Renders the preferred content depending on whether it is supported.\n *\n * @param messageProps final message values from the state.\n * @param defaultOnRender default component to render content.\n * @returns\n */\nconst onRenderMessage = (messageProps: MessageProps, defaultOnRender?: MessageRenderer) => {\n  const message = messageProps?.message;\n  if (isGraphChatMessage(message) && message?.hasUnsupportedContent) {\n    const unsupportedContentComponent = <UnsupportedContent targetUrl={message.rawChatUrl} />;\n    messageProps = produce(messageProps, (draft: MessageProps) => {\n      if (isChatMessage(draft.message)) {\n        draft.message.content = renderToString(unsupportedContentComponent);\n      }\n    });\n  }\n\n  return defaultOnRender ? defaultOnRender(messageProps) : <></>;\n};\nexport { onRenderMessage };\n","import React from 'react';\n\nimport { MessageBar, MessageBarType } from '@fluentui/react';\n\ninterface ChatMessageBarProps {\n  messageBarType: MessageBarType;\n  message: string;\n}\n\nconst ChatMessageBar = ({ messageBarType, message }: ChatMessageBarProps) => {\n  return <MessageBar messageBarType={messageBarType}> {message}</MessageBar>;\n};\n\nexport default ChatMessageBar;\n","import React from 'react';\nimport { PersonCardInteraction } from '@microsoft/mgt-components';\nimport { MgtTemplateProps, Person } from '@microsoft/mgt-react';\nimport { ChatMessageMention, User } from '@microsoft/microsoft-graph-types';\nimport { GraphChatClient } from 'src/statefulClient/StatefulGraphChatClient';\nimport { Mention } from '@azure/communication-react';\n\nexport const renderMGTMention = (chatState: GraphChatClient) => {\n  return (mention: Mention, defaultRenderer: (mention: Mention) => JSX.Element): JSX.Element => {\n    let render: JSX.Element = defaultRenderer(mention);\n\n    const mentions = chatState?.mentions ?? [];\n    const flatMentions = mentions.flat();\n    const teamsMention: ChatMessageMention | undefined = flatMentions.find(\n      m => m.id?.toString() === mention?.id && m.mentionText === mention?.displayText\n    );\n\n    const user = teamsMention?.mentioned?.user as User;\n    if (user) {\n      const MGTMention = (_props: MgtTemplateProps) => {\n        return defaultRenderer(mention);\n      };\n      render = (\n        <Person userId={user?.id} personCardInteraction={PersonCardInteraction.hover}>\n          <MGTMention template=\"default\" />\n        </Person>\n      );\n    }\n    return render;\n  };\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { mergeStyleSets, mergeStyles } from '@fluentui/react/lib/Styling';\n\nconst classNames = {\n  buttonIcon: 'button-icon',\n  icon: 'icon',\n  iconFilled: 'icon-filled',\n  iconUnfilled: 'icon-unfilled'\n};\n\nconst iconOnlyButtonStyle = mergeStyles({\n  width: '18px',\n  height: '18px'\n});\n\nconst buttonIconStyle = {};\n\nconst colors = {\n  iconRest: '#616161',\n  iconHover: '#5b5fc7'\n};\n\nconst buttonIconStyles = mergeStyleSets({\n  button: [classNames.buttonIcon, buttonIconStyle],\n\n  icon: [\n    classNames.icon,\n    {\n      fill: colors.iconRest,\n      [`.${classNames.buttonIcon}:hover &`]: {\n        fill: colors.iconHover,\n        color: colors.iconHover\n      }\n    }\n  ],\n\n  iconFilled: [\n    classNames.iconFilled,\n    {\n      display: 'none',\n      [`.${classNames.buttonIcon}:hover &`]: {\n        display: 'block'\n      }\n    }\n  ],\n\n  iconUnfilled: [\n    classNames.iconUnfilled,\n    {\n      display: 'block',\n      [`.${classNames.buttonIcon}:hover &`]: {\n        display: 'none'\n      }\n    }\n  ]\n});\n\nexport { buttonIconStyles, buttonIconStyle, iconOnlyButtonStyle };\n","import { makeStyles } from '@fluentui/react-components';\n\nexport const useCommonHeaderStyles = makeStyles({\n  row: {\n    paddingInlineStart: '24px'\n  }\n});\n","import React from 'react';\nimport { AadUserConversationMember, Chat } from '@microsoft/microsoft-graph-types';\nimport { Person, PersonCardInteraction, ViewType } from '@microsoft/mgt-react';\nimport { ChatHeaderProps } from './ChatTitle';\nimport { makeStyles } from '@fluentui/react-components';\n\nconst getOtherParticipantUserId = (chat?: Chat, currentUserId = '') =>\n  (chat?.members as AadUserConversationMember[])?.find(m => m.userId !== currentUserId)?.userId;\n\nconst useStyles = makeStyles({\n  person: {\n    '--person-avatar-size': '32px',\n    '--person-alignment': 'center'\n  }\n});\nexport const OneToOneChatHeader = ({ chat, currentUserId }: ChatHeaderProps) => {\n  const styles = useStyles();\n  const id = getOtherParticipantUserId(chat, currentUserId);\n  return id ? (\n    <Person\n      className={styles.person}\n      userId={id}\n      view={ViewType.oneline}\n      avatarSize=\"small\"\n      personCardInteraction={PersonCardInteraction.hover}\n      showPresence={true}\n    />\n  ) : null;\n};\n","import React, { ReactNode } from 'react';\nimport { makeStyles, shorthands } from '@fluentui/react-components';\n\ninterface CircleProps {\n  height?: string;\n  width?: string;\n  children: ReactNode;\n}\nconst useStyles = makeStyles({\n  container: {\n    ...shorthands.border('1px solid var(--colorBrandBackground2)'),\n    ...shorthands.overflow('hidden'),\n    ...shorthands.borderRadius('50%')\n  },\n  background: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'var(--colorBrandBackground2)'\n  }\n});\nexport const Circle = ({ height, width, children }: CircleProps): JSX.Element => {\n  const styles = useStyles();\n  const style = { height: height ?? '32px', width: width ?? '32px' };\n  return (\n    <span className={styles.container} style={style}>\n      <span className={styles.background} style={style}>\n        {children}\n      </span>\n    </span>\n  );\n};\n","import React from 'react';\nimport { Chat } from '@microsoft/microsoft-graph-types';\nimport { Calendar16Regular, PeopleTeam16Regular, bundleIcon } from '@fluentui/react-icons';\nimport { error } from '@microsoft/mgt-element';\nimport { Circle } from '../Circle/Circle';\n\nconst MeetingIcon = bundleIcon(Calendar16Regular, Calendar16Regular);\nconst GroupIcon = bundleIcon(PeopleTeam16Regular, PeopleTeam16Regular);\nexport const ChatIcon = ({ chatType }: Chat): JSX.Element | null => {\n  if (!chatType) return null;\n\n  const iconColor = 'var(--colorBrandForeground2)';\n\n  switch (chatType) {\n    case 'group':\n      return (\n        <Circle>\n          <GroupIcon color={iconColor} />\n        </Circle>\n      );\n    case 'meeting':\n      return (\n        <Circle>\n          <MeetingIcon color={iconColor} />\n        </Circle>\n      );\n    default:\n      error(`Attempted to render an icon for chat of type: ${chatType}`);\n      return null;\n  }\n};\n","import React, { useCallback, useState } from 'react';\nimport { AadUserConversationMember } from '@microsoft/microsoft-graph-types';\nimport { Edit16Filled, Edit16Regular, bundleIcon } from '@fluentui/react-icons';\nimport {\n  Button,\n  Field,\n  Input,\n  InputOnChangeData,\n  OnOpenChangeData,\n  Popover,\n  PopoverSurface,\n  PopoverTrigger,\n  makeStyles,\n  tokens\n} from '@fluentui/react-components';\nimport type { PopoverProps } from '@fluentui/react-components';\nimport { ChatIcon } from '../ChatIcon/ChatIcon';\nimport { ChatHeaderProps } from './ChatTitle';\n\nconst EditIcon = bundleIcon(Edit16Filled, Edit16Regular);\nconst useStyles = makeStyles({\n  chatTitle: {\n    marginInlineStart: '10px'\n  },\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    gridRowGap: '16px',\n    minWidth: '300px',\n    backgroundColor: tokens.colorNeutralBackground1\n  },\n  formButtons: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    gridColumnGap: '8px'\n  }\n});\nconst reduceToFirstNamesList = (participants: AadUserConversationMember[] = [], userId = '') => {\n  return participants\n    .filter(p => p.userId !== userId)\n    .map(p => {\n      if (p.displayName?.includes(' ')) {\n        return p.displayName.split(' ')[0];\n      }\n      return p.displayName || p.email || p.id;\n    })\n    .join(', ');\n};\nexport const GroupChatHeader = ({ chat, currentUserId, onRenameChat }: ChatHeaderProps) => {\n  const styles = useStyles();\n  const [isPopoverOpen, setIsPopoverOpen] = useState(false);\n  const handleOpenChange = useCallback((_, data: OnOpenChangeData) => setIsPopoverOpen(data.open || false), []);\n  const onCancelClicked = useCallback(() => setIsPopoverOpen(false), []);\n  const [chatName, setChatName] = useState(chat?.topic);\n  const onChatNameChanged = useCallback(\n    (_: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, data: InputOnChangeData) => {\n      setChatName(data.value);\n    },\n    []\n  );\n  const renameChat = useCallback(() => {\n    void onRenameChat(chatName || null);\n  }, [chatName, onRenameChat]);\n  const chatTitle = chat?.topic\n    ? chat.topic\n    : reduceToFirstNamesList(chat?.members as AadUserConversationMember[], currentUserId);\n  const trapFocus = true;\n  const popoverProps: Partial<PopoverProps> = {\n    trapFocus,\n    inertTrapFocus: trapFocus,\n    inline: true,\n    positioning: 'below-start',\n    open: isPopoverOpen,\n    onOpenChange: handleOpenChange\n  };\n  return (\n    <>\n      <ChatIcon chatType={chat?.chatType} />\n      <span className={styles.chatTitle}>{chatTitle}</span>\n      <Popover {...popoverProps}>\n        <PopoverTrigger>\n          <Button appearance=\"transparent\" icon={<EditIcon />} aria-label=\"Name group chat\"></Button>\n        </PopoverTrigger>\n        <PopoverSurface>\n          <div className={styles.container}>\n            <Field label=\"Group name\">\n              <Input placeholder=\"Enter group name\" onChange={onChatNameChanged} value={chatName || ''} />\n            </Field>\n            <div className={styles.formButtons}>\n              <Button appearance=\"secondary\" onClick={onCancelClicked}>\n                Cancel\n              </Button>\n              <Button appearance=\"primary\" disabled={chatName === chat?.topic} onClick={renameChat}>\n                Send\n              </Button>\n            </div>\n          </div>\n        </PopoverSurface>\n      </Popover>\n    </>\n  );\n};\n","import React, { memo } from 'react';\nimport { Chat } from '@microsoft/microsoft-graph-types';\nimport { makeStyles, mergeClasses } from '@fluentui/react-components';\nimport { useCommonHeaderStyles } from './useCommonHeaderStyles';\nimport { OneToOneChatHeader } from './OneToOneChatHeader';\nimport { GroupChatHeader } from './GroupChatHeader';\n\nexport interface ChatHeaderProps {\n  chat?: Chat;\n  currentUserId?: string;\n  onRenameChat: (newName: string | null) => Promise<void>;\n}\n\nconst useTitleStyles = makeStyles({\n  chatHeader: {\n    display: 'flex',\n    alignItems: 'center',\n    columnGap: '0',\n    lineHeight: '32px',\n    fontSize: '18px',\n    fontWeight: 700,\n    marginBlockStart: '10px',\n    marginBlockEnd: '8px',\n    zIndex: 3\n  }\n});\n\n/**\n * Shows the \"name\" of the chat.\n * For group chats where the topic is set it will show the topic.\n * For group chats with no topic it will show the first names of other participants comma separated.\n * For 1:1 chats it will show the first name of the other participant.\n */\nconst ChatTitle = ({ chat, currentUserId, onRenameChat }: ChatHeaderProps) => {\n  const styles = useTitleStyles();\n  const commonStyles = useCommonHeaderStyles();\n  return (\n    <div className={mergeClasses(styles.chatHeader, commonStyles.row)}>\n      {chat?.chatType !== 'oneOnOne' ? (\n        <GroupChatHeader chat={chat} currentUserId={currentUserId} onRenameChat={onRenameChat} />\n      ) : (\n        <OneToOneChatHeader chat={chat} currentUserId={currentUserId} onRenameChat={onRenameChat} />\n      )}\n    </div>\n  );\n};\n\nexport default memo(ChatTitle);\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/consistent-type-definitions */\nimport { PersonType,GroupType,UserType,IDynamicPerson } from '@microsoft/mgt-components/dist/es6/exports';\nimport { registerMgtPeoplePickerComponent } from '@microsoft/mgt-components/dist/es6/components/components';\nimport { TemplateContext,ComponentMediaQuery,TemplateRenderedData } from '@microsoft/mgt-element';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraphBeta from '@microsoft/microsoft-graph-types-beta';\nimport {wrapMgt} from '../Mgt';\n\nexport type PeoplePickerProps = {\n\tgroupId?: string;\n\tgroupIds?: string[];\n\ttype?: PersonType;\n\tgroupType?: GroupType;\n\tuserType?: UserType;\n\ttransitiveSearch?: boolean;\n\tpeople?: IDynamicPerson[];\n\tshowMax?: number;\n\tdisableImages?: boolean;\n\tshowPresence?: boolean;\n\tselectedPeople?: IDynamicPerson[];\n\tdefaultSelectedUserIds?: string[];\n\tdefaultSelectedGroupIds?: string[];\n\tplaceholder?: string;\n\tdisabled?: boolean;\n\tallowAnyEmail?: boolean;\n\tselectionMode?: string;\n\tuserIds?: string[];\n\tuserFilters?: string;\n\tpeopleFilters?: string;\n\tgroupFilters?: string;\n\tariaLabel?: string;\n\ttemplateContext?: TemplateContext;\n\tmediaQuery?: ComponentMediaQuery;\n\tselectionChanged?: (e: CustomEvent<IDynamicPerson[]>) => void;\n\ttemplateRendered?: (e: CustomEvent<TemplateRenderedData>) => void;\n}\n\nexport const PeoplePicker = wrapMgt<PeoplePickerProps>('people-picker', registerMgtPeoplePickerComponent);\n\n","import React, { ChangeEvent, useCallback, useState } from 'react';\nimport { ChoiceGroup, IChoiceGroupOption } from '@fluentui/react';\nimport { shorthands, makeStyles, Button, Input, InputOnChangeData } from '@fluentui/react-components';\nimport { IDynamicPerson, PeoplePicker } from '@microsoft/mgt-react';\n\ninterface AddChatMembersProps {\n  closeDialog: () => void;\n  addChatMembers: (userIds: string[], history?: Date) => Promise<void>;\n}\n\nconst useStyles = makeStyles({\n  addMembers: {\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBlockEnd: '18px',\n    ...shorthands.paddingInline('20px')\n  },\n  buttonRow: {\n    display: 'flex',\n    columnGap: '8px',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    paddingBlockStart: '18px'\n  },\n  dialogHeading: {\n    paddingInlineStart: '4px',\n    marginBlockStart: '18px',\n    marginBlockEnd: '10px'\n  },\n  historyInput: { width: '48px' },\n  option: {\n    display: 'flex',\n    alignItems: 'center',\n    columnGap: '4px'\n  },\n  radio: {\n    marginBlockStart: '8px',\n    paddingInlineStart: '2px'\n  }\n});\n\nconst AddChatMembers = ({ addChatMembers, closeDialog }: AddChatMembersProps) => {\n  const styles = useStyles();\n  const [daysOfHistory, setDaysOfHistory] = useState<number>(1);\n  const handleHistoryChanged = useCallback(\n    (_: ChangeEvent<HTMLInputElement>, data: InputOnChangeData) => {\n      if (data.value) {\n        const newNumber = parseInt(data.value, 10);\n        setDaysOfHistory(newNumber);\n      }\n    },\n    [setDaysOfHistory]\n  );\n\n  const [historyOption, setHistoryOption] = useState<string | undefined>('none');\n  const onHistoryOptionChange = React.useCallback(\n    (_, option: IChoiceGroupOption | undefined) => {\n      if (option) setHistoryOption(option.key);\n    },\n    [setHistoryOption]\n  );\n\n  const [selectedPeople, setSelectedPeople] = useState<IDynamicPerson[]>([]);\n  const peopleSelectionChanged = useCallback(\n    (e: CustomEvent<IDynamicPerson[]>) => {\n      setSelectedPeople(e.detail);\n    },\n    [setSelectedPeople]\n  );\n\n  const addToChat = useCallback(() => {\n    let history: Date | undefined;\n    if (historyOption === 'days') {\n      history = new Date(new Date().getTime() - daysOfHistory * 24 * 60 * 60 * 1000);\n    } else if (historyOption === 'all') {\n      history = new Date('0001-01-01T00:00:00Z');\n    }\n    void addChatMembers(\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      selectedPeople.map(p => p.id!),\n      history\n    ).then(closeDialog);\n  }, [selectedPeople, historyOption, daysOfHistory, addChatMembers, closeDialog]);\n\n  const chatHistoryOptions: IChoiceGroupOption[] = [\n    {\n      key: 'none',\n      text: \"Don't include chat history\"\n    },\n    {\n      key: 'days',\n      text: 'Include history from the past number of days: ',\n\n      onRenderField: (props, render) => {\n        return render ? (\n          <div className={styles.option}>\n            {render(props)}\n            <Input\n              type=\"number\"\n              value={daysOfHistory.toString()}\n              onChange={handleHistoryChanged}\n              min={1}\n              className={styles.historyInput}\n            />\n          </div>\n        ) : null;\n      }\n    },\n    { key: 'all', text: 'Include all chat history' }\n  ];\n  return (\n    <div className={styles.addMembers}>\n      <h3 className={styles.dialogHeading}>Add</h3>\n      <PeoplePicker\n        selectedPeople={selectedPeople}\n        selectionChanged={peopleSelectionChanged}\n        disabled={selectedPeople.length >= 20}\n      />\n      <ChoiceGroup\n        className={styles.radio}\n        options={chatHistoryOptions}\n        selectedKey={historyOption}\n        onChange={onHistoryOptionChange}\n      />\n      <div className={styles.buttonRow}>\n        <Button onClick={closeDialog} appearance=\"secondary\">\n          Cancel\n        </Button>\n        <Button onClick={addToChat} appearance=\"primary\" disabled={selectedPeople.length < 1}>\n          Add\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport { AddChatMembers };\n","import React, { useCallback, useState } from 'react';\nimport {\n  makeStyles,\n  mergeClasses,\n  shorthands,\n  Button,\n  Dialog,\n  DialogActions,\n  DialogBody,\n  DialogContent,\n  DialogSurface,\n  DialogTitle\n} from '@fluentui/react-components';\nimport { List, ListItem } from '@fluentui/react-northstar';\nimport { Person, PersonViewType } from '@microsoft/mgt-react';\nimport { AadUserConversationMember } from '@microsoft/microsoft-graph-types';\nimport { Dismiss20Filled, bundleIcon, iconFilledClassName, iconRegularClassName } from '@fluentui/react-icons';\n\ninterface ListChatMembersProps {\n  currentUserId: string;\n  members: AadUserConversationMember[];\n  removeChatMember: (membershipId: string) => Promise<void>;\n  closeParentPopover: () => void;\n}\n\nconst RemovePerson = bundleIcon(Dismiss20Filled, () => <></>);\n\nconst useStyles = makeStyles({\n  iconPlaceholder: {\n    display: 'flex',\n    width: '24px'\n  },\n  listItem: {\n    listStyleType: 'none',\n    width: '100%',\n    ':focus-visible': {\n      [`& .${iconFilledClassName}`]: {\n        display: 'inline',\n        color: 'var(--colorNeutralForeground2BrandHover)'\n      },\n      [`& .${iconRegularClassName}`]: {\n        display: 'none'\n      }\n    }\n  },\n  memberList: {\n    fontWeight: 800,\n    gridGap: '8px',\n    ...shorthands.marginBlock('0'),\n    ...shorthands.padding('0')\n  },\n  personRow: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    ...shorthands.paddingBlock('5px'),\n    ...shorthands.paddingInline('16px'),\n    cursor: 'pointer',\n    ':hover': {\n      backgroundColor: 'var(--colorSubtleBackgroundHover)',\n      [`& .${iconFilledClassName}`]: {\n        display: 'inline',\n        color: 'var(--colorNeutralForeground2BrandHover)'\n      },\n      [`& .${iconRegularClassName}`]: {\n        display: 'none'\n      }\n    }\n  },\n  fullWidth: {\n    width: '100%'\n  }\n});\n\nconst ListChatMembers = ({ members, currentUserId, removeChatMember, closeParentPopover }: ListChatMembersProps) => {\n  const styles = useStyles();\n  const [removeDialogOpen, setRemoveDialogOpen] = useState(false);\n  const [removeUser, setRemoveUser] = useState<AadUserConversationMember | undefined>(undefined);\n  const openRemoveDialog = useCallback((user: AadUserConversationMember) => {\n    if (!user) return;\n    setRemoveUser(user);\n    setRemoveDialogOpen(true);\n  }, []);\n\n  const closeDialog = useCallback(() => {\n    setRemoveUser(undefined);\n    setRemoveDialogOpen(false);\n    closeParentPopover();\n  }, [closeParentPopover]);\n\n  const removeMember = useCallback(() => {\n    if (!removeUser?.id) {\n      closeDialog();\n      return;\n    }\n\n    void removeChatMember(removeUser.id).then(closeDialog);\n  }, [removeUser, removeChatMember, closeDialog]);\n\n  return (\n    <>\n      <Dialog open={removeDialogOpen} onOpenChange={(_, data) => setRemoveDialogOpen(data.open)}>\n        <DialogSurface>\n          <DialogBody>\n            <DialogTitle>Remove {removeUser?.displayName || ''} from the conversation?</DialogTitle>\n            <DialogContent>They&apos;ll still have access to the chat history.</DialogContent>\n            <DialogActions>\n              <Button appearance=\"secondary\" onClick={closeDialog}>\n                Close\n              </Button>\n              <Button appearance=\"primary\" onClick={removeMember}>\n                Remove\n              </Button>\n            </DialogActions>\n          </DialogBody>\n        </DialogSurface>\n      </Dialog>\n      <List navigable className={styles.memberList}>\n        {members.map((member, index) => {\n          const isCurrentUser = currentUserId === member.userId;\n          return member?.userId ? (\n            <ListItem\n              key={member.userId}\n              className={styles.listItem}\n              index={index}\n              content={\n                <div className={mergeClasses(styles.personRow, styles.fullWidth)}>\n                  <Person\n                    className={styles.fullWidth}\n                    tabIndex={-1}\n                    userId={member.userId}\n                    view={PersonViewType.oneline}\n                    showPresence\n                  />\n                  <span className={styles.iconPlaceholder}>{!isCurrentUser && <RemovePerson />}</span>\n                </div>\n              }\n              onClick={() => {\n                if (isCurrentUser) {\n                  closeDialog();\n                } else {\n                  openRemoveDialog(member);\n                }\n              }}\n            />\n          ) : null;\n        })}\n      </List>\n    </>\n  );\n};\n\nexport { ListChatMembers };\n","import React, { memo, useCallback, useState } from 'react';\nimport {\n  makeStyles,\n  shorthands,\n  Button,\n  Popover,\n  PopoverSurface,\n  PopoverTrigger,\n  Divider,\n  OnOpenChangeData,\n  Dialog,\n  DialogActions,\n  DialogBody,\n  DialogContent,\n  DialogSurface,\n  DialogTitle,\n  DialogTrigger,\n  PopoverProps\n} from '@fluentui/react-components';\nimport {\n  bundleIcon,\n  PeopleAdd24Regular,\n  PeopleAdd24Filled,\n  DoorArrowLeft24Filled,\n  DoorArrowLeft24Regular\n} from '@fluentui/react-icons';\nimport { AadUserConversationMember } from '@microsoft/microsoft-graph-types';\nimport { AddChatMembers } from './AddChatMembers';\nimport { ListChatMembers } from './ListChatMembers';\n\ninterface ManageChatMembersProps {\n  currentUserId: string;\n  members: AadUserConversationMember[];\n  removeChatMember: (membershipId: string) => Promise<void>;\n  addChatMembers: (userIds: string[], history?: Date) => Promise<void>;\n}\n\nconst AddPeople = bundleIcon(PeopleAdd24Filled, PeopleAdd24Regular);\nconst Leave = bundleIcon(DoorArrowLeft24Filled, DoorArrowLeft24Regular);\n\nconst useStyles = makeStyles({\n  button: {\n    justifyContent: 'flex-start',\n    ...shorthands.paddingInline('16px')\n  },\n  buttonRow: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  container: {\n    ...shorthands.paddingBlock('4px')\n  },\n  divider: {\n    ...shorthands.marginBlock('4px')\n  },\n  popover: {\n    ...shorthands.padding('0 !important')\n  },\n  triggerButton: {\n    ...shorthands.marginInline('8px'),\n    ...shorthands.paddingInline('0'),\n    '--spacingHorizontalSNudge': '2px',\n    minWidth: 'unset !important',\n    width: 'max-content'\n  }\n});\n\nconst ManageChatMembersComponent = ({\n  currentUserId,\n  members,\n  addChatMembers,\n  removeChatMember\n}: ManageChatMembersProps) => {\n  const styles = useStyles();\n  const [isPopoverOpen, setIsPopoverOpen] = useState(false);\n  const [showAddMembers, setShowAddMembers] = useState(false);\n  const openAddMembers = useCallback(() => {\n    setShowAddMembers(true);\n  }, [setShowAddMembers]);\n  const closeCallout = useCallback(() => {\n    setShowAddMembers(false);\n    setIsPopoverOpen(false);\n  }, [setShowAddMembers]);\n  const handleOpenChange = useCallback(\n    (_, data: OnOpenChangeData) => setIsPopoverOpen(data.open || false),\n    [setIsPopoverOpen]\n  );\n\n  const leaveChat = useCallback(() => {\n    const me = members.find(member => member.userId === currentUserId);\n    if (me?.id) {\n      void removeChatMember(me.id).then(closeCallout);\n      return;\n    }\n    closeCallout();\n  }, [removeChatMember, members, currentUserId, closeCallout]);\n  const trapFocus = true;\n  const popoverProps: Partial<PopoverProps> = {\n    trapFocus,\n    inertTrapFocus: trapFocus,\n    inline: true,\n    positioning: 'below-start',\n    open: isPopoverOpen,\n    onOpenChange: handleOpenChange\n  };\n  return (\n    <Popover {...popoverProps}>\n      <PopoverTrigger>\n        <Button className={styles.triggerButton} appearance=\"transparent\" icon={<AddPeople />}>\n          {members.length}\n        </Button>\n      </PopoverTrigger>\n      <PopoverSurface className={styles.popover}>\n        {showAddMembers ? (\n          <AddChatMembers closeDialog={closeCallout} addChatMembers={addChatMembers} />\n        ) : (\n          <div className={styles.container}>\n            <ListChatMembers\n              members={members}\n              removeChatMember={removeChatMember}\n              currentUserId={currentUserId}\n              closeParentPopover={closeCallout}\n            />\n            <Divider className={styles.divider} />\n            <div className={styles.buttonRow}>\n              <Button appearance=\"subtle\" icon={<AddPeople />} onClick={openAddMembers} className={styles.button}>\n                Add people\n              </Button>\n              <Dialog>\n                <DialogTrigger>\n                  <Button appearance=\"subtle\" icon={<Leave />} className={styles.button}>\n                    Leave\n                  </Button>\n                </DialogTrigger>\n                <DialogSurface>\n                  <DialogBody>\n                    <DialogTitle>Leave the conversation?</DialogTitle>\n                    <DialogContent>You&apos;ll still have access to the chat history.</DialogContent>\n                    <DialogActions>\n                      <DialogTrigger disableButtonEnhancement>\n                        <Button appearance=\"secondary\" onClick={closeCallout}>\n                          Cancel\n                        </Button>\n                      </DialogTrigger>\n                      {members.length > 2 && (\n                        <Button appearance=\"primary\" onClick={leaveChat}>\n                          Leave\n                        </Button>\n                      )}\n                    </DialogActions>\n                  </DialogBody>\n                </DialogSurface>\n              </Dialog>\n            </div>\n          </div>\n        )}\n      </PopoverSurface>\n    </Popover>\n  );\n};\n\nconst ManageChatMembers = memo(ManageChatMembersComponent);\n\nexport { ManageChatMembers };\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nimport {\n  Button,\n  Menu,\n  MenuItemLink,\n  MenuList,\n  MenuPopover,\n  MenuProps,\n  MenuTrigger,\n  makeStyles\n} from '@fluentui/react-components';\nimport { MoreHorizontal24Filled, MoreHorizontal24Regular, bundleIcon } from '@fluentui/react-icons';\nimport { createSvgIcon } from '@fluentui/react-northstar';\nimport React from 'react';\n\nconst TeamsIcon = createSvgIcon({\n  svg: () => (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n      <path\n        d=\"M17.0797 8H14.1797L12.4697 8.82V12.89C12.5119 13.5868 12.8184 14.2412 13.3267 14.7197C13.8349 15.1981 14.5067 15.4645 15.2047 15.4645C15.9028 15.4645 16.5745 15.1981 17.0828 14.7197C17.5911 14.2412 17.8976 13.5868 17.9397 12.89V8.82C17.9399 8.70887 17.9174 8.59886 17.8737 8.49668C17.83 8.39449 17.766 8.30225 17.6856 8.22556C17.6052 8.14887 17.51 8.08933 17.4058 8.05055C17.3017 8.01178 17.1907 7.99458 17.0797 8Z\"\n        fill=\"#115EA3\"\n      />\n      <path\n        d=\"M16 7C17.1046 7 18 6.10457 18 5C18 3.89543 17.1046 3 16 3C14.8954 3 14 3.89543 14 5C14 6.10457 14.8954 7 16 7Z\"\n        fill=\"#115EA3\"\n      />\n      <path\n        d=\"M6.82 8H14.18C14.3975 8 14.606 8.08639 14.7598 8.24017C14.9136 8.39395 15 8.60252 15 8.82V13.5C15 14.6935 14.5259 15.8381 13.682 16.682C12.8381 17.5259 11.6935 18 10.5 18C9.30653 18 8.16193 17.5259 7.31802 16.682C6.47411 15.8381 6 14.6935 6 13.5V8.82C6 8.60252 6.08639 8.39395 6.24017 8.24017C6.39395 8.08639 6.60252 8 6.82 8Z\"\n        fill=\"#B4D6FA\"\n      />\n      <path\n        d=\"M11 8C12.6569 8 14 6.65685 14 5C14 3.34315 12.6569 2 11 2C9.34315 2 8 3.34315 8 5C8 6.65685 9.34315 8 11 8Z\"\n        fill=\"#B4D6FA\"\n      />\n      <path\n        opacity=\"0.5\"\n        d=\"M6.00003 8.82V13.5C5.99696 14.3892 6.25799 15.2593 6.75003 16H10.97C11.5005 16 12.0092 15.7893 12.3842 15.4142C12.7593 15.0391 12.97 14.5304 12.97 14V8H6.75003C6.5449 8.01757 6.35389 8.11166 6.21494 8.26358C6.07599 8.4155 5.99928 8.61412 6.00003 8.82Z\"\n        fill=\"#242424\"\n      />\n      <path\n        opacity=\"0.5\"\n        d=\"M11.9699 6H8.16992C8.3332 6.46135 8.60686 6.87575 8.96704 7.20706C9.32722 7.53837 9.76299 7.77654 10.2363 7.9008C10.7097 8.02505 11.2062 8.03162 11.6827 7.91993C12.1592 7.80823 12.6011 7.58167 12.9699 7.26V7C12.9699 6.73478 12.8646 6.48043 12.677 6.29289C12.4895 6.10536 12.2351 6 11.9699 6Z\"\n        fill=\"#242424\"\n      />\n      <path\n        opacity=\"0.1\"\n        d=\"M6.00003 8.82V13.5C5.99696 14.3892 6.25799 15.2593 6.75003 16H10.97C11.5005 16 12.0092 15.7893 12.3842 15.4142C12.7593 15.0391 12.97 14.5304 12.97 14V8H6.75003C6.5449 8.01757 6.35389 8.11166 6.21494 8.26358C6.07599 8.4155 5.99928 8.61412 6.00003 8.82Z\"\n        fill=\"white\"\n      />\n      <path\n        opacity=\"0.1\"\n        d=\"M11.9699 6H8.16992C8.3332 6.46135 8.60686 6.87575 8.96704 7.20706C9.32722 7.53837 9.76299 7.77654 10.2363 7.9008C10.7097 8.02505 11.2062 8.03162 11.6827 7.91993C12.1592 7.80823 12.6011 7.58167 12.9699 7.26V7C12.9699 6.73478 12.8646 6.48043 12.677 6.29289C12.4895 6.10536 12.2351 6 11.9699 6Z\"\n        fill=\"white\"\n      />\n      <path\n        d=\"M11 5H3C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H11C11.5523 15 12 14.5523 12 14V6C12 5.44772 11.5523 5 11 5Z\"\n        fill=\"#115EA3\"\n      />\n      <path d=\"M10 8H8V13H7V8H5V7H10V8Z\" fill=\"white\" />\n    </svg>\n  ),\n  displayName: 'TeamsIcon'\n});\n\nconst EllipsisIcon = bundleIcon(MoreHorizontal24Filled, MoreHorizontal24Regular);\n\nconst menuProps: Partial<MenuProps> = {\n  inline: true,\n  hasIcons: true,\n  closeOnScroll: true,\n  positioning: 'below-start'\n};\n\nconst ellipsisMenuStyles = makeStyles({\n  menuPopover: {\n    zIndex: 2,\n\n    '& .fui-MenuItemLink__content': {\n      fontFamily: 'Segoe UI',\n      fontSize: '12px',\n      fontStyle: 'normal',\n      fontWeight: '600'\n    }\n  }\n});\ninterface MenuItemsProps {\n  chatWebUrl: string;\n}\n\nconst EllipsisMenu = (props: MenuItemsProps) => {\n  const styles = ellipsisMenuStyles();\n\n  return (\n    <Menu {...menuProps}>\n      <MenuTrigger disableButtonEnhancement>\n        <Button appearance=\"transparent\" icon={<EllipsisIcon />} />\n      </MenuTrigger>\n\n      <MenuPopover className={styles.menuPopover}>\n        <MenuList>\n          <MenuItemLink icon={<TeamsIcon />} target=\"_blank\" href={props.chatWebUrl}>\n            Go to Microsoft Teams\n          </MenuItemLink>\n        </MenuList>\n      </MenuPopover>\n    </Menu>\n  );\n};\n\nexport { EllipsisMenu };\n","import { Divider, makeStyles, mergeClasses } from '@fluentui/react-components';\nimport React from 'react';\nimport { GraphChatClient } from '../../statefulClient/StatefulGraphChatClient';\nimport ChatTitle from './ChatTitle';\nimport { ManageChatMembers } from '../ManageChatMembers/ManageChatMembers';\nimport { useCommonHeaderStyles } from './useCommonHeaderStyles';\nimport { EllipsisMenu } from './EllipsisMenu';\n\nconst useHeaderStyles = makeStyles({\n  chatHeader: {\n    display: 'flex',\n    flexDirection: 'column',\n    rowGap: 0,\n    zIndex: 2\n  },\n  secondRow: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    alignItems: 'center',\n    height: '30px'\n  },\n  noGrow: {\n    flexGrow: 0\n  }\n});\ninterface ChatHeaderProps {\n  chatState: GraphChatClient;\n}\nconst ChatHeader = ({ chatState }: ChatHeaderProps) => {\n  const styles = useHeaderStyles();\n  const commonStyles = useCommonHeaderStyles();\n  const chatWebUrl = chatState?.chat?.webUrl ?? 'https://teams.microsoft.com/v2';\n\n  return (\n    <div className={styles.chatHeader}>\n      <ChatTitle chat={chatState.chat} currentUserId={chatState.userId} onRenameChat={chatState.onRenameChat} />\n      <Divider appearance=\"subtle\" />\n      <div className={mergeClasses(styles.secondRow, commonStyles.row)}>\n        {chatState.participants?.length > 0 && chatState.chat?.chatType === 'group' && (\n          <>\n            <ManageChatMembers\n              members={chatState.participants}\n              removeChatMember={chatState.onRemoveChatMember}\n              currentUserId={chatState.userId}\n              addChatMembers={chatState.onAddChatMembers}\n            />\n            <Divider vertical appearance=\"subtle\" inset className={styles.noGrow} />\n          </>\n        )}\n        <EllipsisMenu chatWebUrl={chatWebUrl} />\n      </div>\n      <Divider appearance=\"subtle\" />\n    </div>\n  );\n};\n\nexport { ChatHeader };\n","import React from 'react';\nimport { DEFAULT_COMPONENT_ICONS } from '@azure/communication-react';\nimport { registerIcons } from '@fluentui/react';\nimport { buttonIconStyles } from './common.styles';\n\nconst registerAppIcons = () => {\n  const icons = Object.assign(DEFAULT_COMPONENT_ICONS, {\n    // TODO: Register the info and errorbadge icons\n    'add-friend': (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"16\"\n        height=\"16\"\n        viewBox=\"0 0 16 16\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        className={buttonIconStyles.button}\n      >\n        <path\n          className={buttonIconStyles.icon}\n          d=\"M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM10.5 15C12.9853 15 15 12.9853 15 10.5C15 8.01472 12.9853 6 10.5 6C8.01472 6 6 8.01472 6 10.5C6 12.9853 8.01472 15 10.5 15ZM10.5 8C10.7761 8 11 8.22386 11 8.5V10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H11V12.5C11 12.7761 10.7761 13 10.5 13C10.2239 13 10 12.7761 10 12.5V11H8.5C8.22386 11 8 10.7761 8 10.5C8 10.2239 8.22386 10 8.5 10H10V8.5C10 8.22386 10.2239 8 10.5 8Z\"\n        />\n      </svg>\n    ),\n    'left-chat': (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"16\"\n        height=\"16\"\n        viewBox=\"0 0 16 16\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        className={buttonIconStyles.button}\n      >\n        <path\n          className={buttonIconStyles.icon}\n          d=\"M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM15 10.5C15 12.9853 12.9853 15 10.5 15C8.01472 15 6 12.9853 6 10.5C6 8.01472 8.01472 6 10.5 6C12.9853 6 15 8.01472 15 10.5ZM8.14684 10.146L8.14433 10.1486C8.09744 10.196 8.06198 10.2505 8.03794 10.3086C8.01385 10.3667 8.0004 10.4303 8.00001 10.497L8 10.5L8.00001 10.503C8.0004 10.5697 8.01385 10.6333 8.03794 10.6914C8.06234 10.7504 8.09851 10.8056 8.14645 10.8536L10.1464 12.8536C10.3417 13.0488 10.6583 13.0488 10.8536 12.8536C11.0488 12.6583 11.0488 12.3417 10.8536 12.1464L9.70711 11H12.5C12.7761 11 13 10.7761 13 10.5C13 10.2239 12.7761 10 12.5 10H9.70711L10.8536 8.85355C11.0488 8.65829 11.0488 8.34171 10.8536 8.14645C10.6583 7.95118 10.3417 7.95118 10.1464 8.14645L8.14684 10.146Z\"\n        />\n      </svg>\n    ),\n    'edit-svg': (\n      <svg\n        viewBox=\"0 0 24 24\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"16\"\n        height=\"16\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        className={buttonIconStyles.button}\n      >\n        <g className={buttonIconStyles.icon}>\n          <path d=\"M20.9519 3.0481C19.5543 1.65058 17.2885 1.65064 15.8911 3.04825L3.94103 14.9997C3.5347 15.4061 3.2491 15.9172 3.116 16.4762L2.02041 21.0777C1.96009 21.3311 2.03552 21.5976 2.21968 21.7817C2.40385 21.9659 2.67037 22.0413 2.92373 21.981L7.52498 20.8855C8.08418 20.7523 8.59546 20.4666 9.00191 20.0601L20.952 8.10861C22.3493 6.71112 22.3493 4.4455 20.9519 3.0481ZM16.9518 4.10884C17.7634 3.29709 19.0795 3.29705 19.8912 4.10876C20.7028 4.9204 20.7029 6.23632 19.8913 7.04801L19 7.93946L16.0606 5.00012L16.9518 4.10884ZM15 6.06084L17.9394 9.00018L7.94119 18.9995C7.73104 19.2097 7.46668 19.3574 7.17755 19.4263L3.76191 20.2395L4.57521 16.8237C4.64402 16.5346 4.79168 16.2704 5.00175 16.0603L15 6.06084Z\" />\n        </g>\n      </svg>\n    ),\n    'leave-svg': (\n      <svg\n        viewBox=\"0 0 24 24\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        className={buttonIconStyles.button}\n      >\n        <g className={buttonIconStyles.icon}>\n          <path\n            className={buttonIconStyles.iconUnfilled}\n            d=\"M6.25 2C5.00736 2 4 3.00736 4 4.25V19.75C4 20.9926 5.00736 22 6.25 22H12.8096C12.3832 21.5557 12.0194 21.051 11.7322 20.5H6.25C5.83579 20.5 5.5 20.1642 5.5 19.75V4.25C5.5 3.83579 5.83579 3.5 6.25 3.5H17.75C18.1642 3.5 18.5 3.83579 18.5 4.25V11.0764C19.0232 11.1572 19.5258 11.3004 20 11.4982V4.25C20 3.00736 18.9926 2 17.75 2H6.25ZM17.5 23C20.5376 23 23 20.5376 23 17.5C23 14.4624 20.5376 12 17.5 12C14.4624 12 12 14.4624 12 17.5C12 20.5376 14.4624 23 17.5 23ZM21 17.5C21 17.7761 20.7761 18 20.5 18H15.7071L17.3536 19.6464C17.5488 19.8417 17.5488 20.1583 17.3536 20.3536C17.1583 20.5488 16.8417 20.5488 16.6464 20.3536L14.1464 17.8536C13.9512 17.6583 13.9512 17.3417 14.1464 17.1464L16.6464 14.6464C16.8417 14.4512 17.1583 14.4512 17.3536 14.6464C17.5488 14.8417 17.5488 15.1583 17.3536 15.3536L15.7071 17H20.5C20.7761 17 21 17.2239 21 17.5ZM8.5 13.25C9.32843 13.25 10 12.5784 10 11.75C10 10.9216 9.32843 10.25 8.5 10.25C7.67157 10.25 7 10.9216 7 11.75C7 12.5784 7.67157 13.25 8.5 13.25Z\"\n          />\n          <path\n            className={buttonIconStyles.iconFilled}\n            d=\"M6.25 2.75C5.42157 2.75 4.75 3.42157 4.75 4.25V19.75C4.75 20.5784 5.42157 21.25 6.25 21.25H12.1902C11.4405 20.1905 11 18.8967 11 17.5C11 13.9101 13.9101 11 17.5 11C18.1063 11 18.6932 11.083 19.25 11.2383V4.25C19.25 3.42157 18.5784 2.75 17.75 2.75H6.25ZM8.5 13.25C7.67157 13.25 7 12.5784 7 11.75C7 10.9216 7.67157 10.25 8.5 10.25C9.32843 10.25 10 10.9216 10 11.75C10 12.5784 9.32843 13.25 8.5 13.25ZM17.5 23C20.5376 23 23 20.5376 23 17.5C23 14.4624 20.5376 12 17.5 12C14.4624 12 12 14.4624 12 17.5C12 20.5376 14.4624 23 17.5 23ZM21 17.5C21 17.7761 20.7761 18 20.5 18H15.7071L17.3536 19.6464C17.5488 19.8417 17.5488 20.1583 17.3536 20.3536C17.1583 20.5488 16.8417 20.5488 16.6464 20.3536L14.1464 17.8536C13.9512 17.6583 13.9512 17.3417 14.1464 17.1464L16.6464 14.6464C16.8417 14.4512 17.1583 14.4512 17.3536 14.6464C17.5488 14.8417 17.5488 15.1583 17.3536 15.3536L15.7071 17H20.5C20.7761 17 21 17.2239 21 17.5Z\"\n          />\n        </g>\n      </svg>\n    ),\n    'people-add-svg': (\n      <svg\n        viewBox=\"0 0 24 24\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        className={buttonIconStyles.button}\n      >\n        <g className={buttonIconStyles.icon}>\n          <path\n            className={buttonIconStyles.iconUnfilled}\n            d=\"M5.5 7C5.5 5.61929 6.61929 4.5 8 4.5C9.38071 4.5 10.5 5.61929 10.5 7C10.5 8.38071 9.38071 9.5 8 9.5C6.61929 9.5 5.5 8.38071 5.5 7ZM8 3C5.79086 3 4 4.79086 4 7C4 9.20914 5.79086 11 8 11C10.2091 11 12 9.20914 12 7C12 4.79086 10.2091 3 8 3ZM15.5 8C15.5 7.17157 16.1716 6.5 17 6.5C17.8284 6.5 18.5 7.17157 18.5 8C18.5 8.82843 17.8284 9.5 17 9.5C16.1716 9.5 15.5 8.82843 15.5 8ZM17 5C15.3431 5 14 6.34315 14 8C14 9.65685 15.3431 11 17 11C18.6569 11 20 9.65685 20 8C20 6.34315 18.6569 5 17 5ZM4.25 13C3.00736 13 2 14.0074 2 15.25V15.5011L2 15.5022L2.00001 15.5048L2.00007 15.5111L2.00035 15.5277C2.00064 15.5406 2.00117 15.5571 2.0021 15.5771C2.00396 15.6169 2.00745 15.6705 2.01398 15.7358C2.02701 15.8661 2.05233 16.045 2.10165 16.2564C2.19995 16.6776 2.39654 17.2404 2.79183 17.8051C3.61066 18.9749 5.17178 20 8 20C9.36897 20 10.4411 19.7598 11.2758 19.3793C11.1268 18.8851 11.035 18.366 11.0082 17.8299C10.3633 18.2108 9.41267 18.5 8 18.5C5.57822 18.5 4.51434 17.6501 4.02067 16.9449C3.75971 16.5721 3.62818 16.1974 3.56241 15.9155C3.5297 15.7753 3.514 15.6612 3.50653 15.5865C3.50281 15.5493 3.50117 15.5222 3.50047 15.5072L3.5 15.4947V15.25C3.5 14.8358 3.83579 14.5 4.25 14.5H11.7322C11.9807 14.0233 12.2865 13.5813 12.6405 13.1831C12.3674 13.0653 12.0663 13 11.75 13H4.25ZM23 17.5C23 14.4624 20.5376 12 17.5 12C14.4624 12 12 14.4624 12 17.5C12 20.5376 14.4624 23 17.5 23C20.5376 23 23 20.5376 23 17.5ZM18.0006 18L18.0011 20.5035C18.0011 20.7797 17.7773 21.0035 17.5011 21.0035C17.225 21.0035 17.0011 20.7797 17.0011 20.5035L17.0006 18H14.4956C14.2197 18 13.9961 17.7762 13.9961 17.5C13.9961 17.2239 14.2197 17 14.4956 17H17.0005L17 14.4993C17 14.2231 17.2239 13.9993 17.5 13.9993C17.7761 13.9993 18 14.2231 18 14.4993L18.0005 17H20.4966C20.7725 17 20.9961 17.2239 20.9961 17.5C20.9961 17.7762 20.7725 18 20.4966 18H18.0006Z\"\n          />\n          <path\n            className={buttonIconStyles.iconFilled}\n            d=\"M8 11C10.2091 11 12 9.20914 12 7C12 4.79086 10.2091 3 8 3C5.79086 3 4 4.79086 4 7C4 9.20914 5.79086 11 8 11ZM17 11C18.6569 11 20 9.65685 20 8C20 6.34315 18.6569 5 17 5C15.3431 5 14 6.34315 14 8C14 9.65685 15.3431 11 17 11ZM4.25 13C3.00736 13 2 14.0074 2 15.25V15.5C2 15.5 2 20 8 20C9.38985 20 10.4578 19.7585 11.2783 19.3875C11.0973 18.7901 11 18.1564 11 17.5C11 15.8431 11.6199 14.3311 12.6405 13.1831C12.3674 13.0653 12.0663 13 11.75 13H4.25ZM23 17.5C23 14.4624 20.5376 12 17.5 12C14.4624 12 12 14.4624 12 17.5C12 20.5376 14.4624 23 17.5 23C20.5376 23 23 20.5376 23 17.5ZM18.0006 18L18.0011 20.5035C18.0011 20.7797 17.7773 21.0035 17.5011 21.0035C17.225 21.0035 17.0011 20.7797 17.0011 20.5035L17.0006 18H14.4956C14.2197 18 13.9961 17.7762 13.9961 17.5C13.9961 17.2239 14.2197 17 14.4956 17H17.0005L17 14.4993C17 14.2231 17.2239 13.9993 17.5 13.9993C17.7761 13.9993 18 14.2231 18 14.4993L18.0005 17H20.4966C20.7725 17 20.9961 17.2239 20.9961 17.5C20.9961 17.7762 20.7725 18 20.4966 18H18.0006Z\"\n          />\n        </g>\n      </svg>\n    )\n  });\n  registerIcons({ icons });\n};\n\nexport { registerAppIcons };\n","import { ErrorBar, FluentThemeProvider, MessageThread, SendBox, MessageThreadStyles } from '@azure/communication-react';\nimport { FluentTheme, MessageBarType } from '@fluentui/react';\nimport { FluentProvider, makeStyles, shorthands, webLightTheme } from '@fluentui/react-components';\nimport { Person, PersonCardInteraction, Spinner } from '@microsoft/mgt-react';\nimport React, { useEffect, useState } from 'react';\nimport { StatefulGraphChatClient } from '../../statefulClient/StatefulGraphChatClient';\nimport { useGraphChatClient } from '../../statefulClient/useGraphChatClient';\nimport { onRenderMessage } from '../../utils/chat';\nimport ChatMessageBar from '../ChatMessageBar/ChatMessageBar';\nimport { renderMGTMention } from '../../utils/mentions';\nimport { registerAppIcons } from '../styles/registerIcons';\nimport { ChatHeader } from '../ChatHeader/ChatHeader';\n\nregisterAppIcons();\n\ninterface IMgtChatProps {\n  chatId: string;\n}\n\nconst useStyles = makeStyles({\n  chat: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    ...shorthands.overflow('auto'),\n    paddingBlockEnd: '12px'\n  },\n  chatMessages: {\n    paddingInlineStart: '16px',\n    height: 'auto',\n    ...shorthands.overflow('auto'),\n    '& img': {\n      maxWidth: '100%',\n      height: 'auto'\n    }\n  },\n  chatInput: {\n    ...shorthands.paddingInline('24px'),\n    ...shorthands.overflow('unset')\n  },\n  fullHeight: {\n    height: '100%'\n  },\n  spinner: {\n    justifyContent: 'center',\n    display: 'flex',\n    alignItems: 'center',\n    height: '100%'\n  },\n  unsupportedContent: {\n    color: 'red'\n  }\n});\n\n/**\n * Styling for the MessageThread and its components.\n */\nconst messageThreadStyles: MessageThreadStyles = {\n  chatContainer: {\n    '& .ui-box': {\n      zIndex: 'unset'\n    }\n  },\n  chatMessageContainer: {\n    '& p>mgt-person,msft-mention': {\n      display: 'inline-block',\n      ...shorthands.marginInline('0px', '2px')\n    }\n  },\n  myChatMessageContainer: {\n    '& p>mgt-person,msft-mention': {\n      display: 'inline-block',\n      ...shorthands.marginInline('0px', '2px')\n    }\n  }\n};\n\nexport const Chat = ({ chatId }: IMgtChatProps) => {\n  const styles = useStyles();\n  const chatClient: StatefulGraphChatClient = useGraphChatClient(chatId);\n  const [chatState, setChatState] = useState(chatClient.getState());\n  useEffect(() => {\n    chatClient.onStateChange(setChatState);\n    return () => {\n      chatClient.offStateChange(setChatState);\n    };\n  }, [chatClient]);\n\n  const isLoading = ['creating server connections', 'subscribing to notifications', 'loading messages'].includes(\n    chatState.status\n  );\n\n  return (\n    <FluentThemeProvider fluentTheme={FluentTheme}>\n      <FluentProvider theme={webLightTheme} className={styles.fullHeight}>\n        <div className={styles.chat}>\n          {chatState.userId && chatId && chatState.messages.length > 0 ? (\n            <>\n              <ChatHeader chatState={chatState} />\n              <div className={styles.chatMessages}>\n                <MessageThread\n                  userId={chatState.userId}\n                  messages={chatState.messages}\n                  showMessageDate={true}\n                  disableEditing={chatState.disableEditing}\n                  numberOfChatMessagesToReload={chatState.numberOfChatMessagesToReload}\n                  onLoadPreviousChatMessages={chatState.onLoadPreviousChatMessages}\n                  // TODO: Messages date rendering is behind beta flag, find out how to enable it\n                  // onDisplayDateTimeString={(date: Date) => date.toISOString()}\n\n                  // current behavior for re-send is a delete call with the clientMessageId and the a new send call\n                  onDeleteMessage={chatState.onDeleteMessage}\n                  onSendMessage={chatState.onSendMessage}\n                  onUpdateMessage={chatState.onUpdateMessage}\n                  // render props\n                  onRenderAvatar={(userId?: string) => {\n                    return (\n                      <Person userId={userId} avatarSize=\"small\" personCardInteraction={PersonCardInteraction.hover} />\n                    );\n                  }}\n                  styles={messageThreadStyles}\n                  mentionOptions={{\n                    displayOptions: {\n                      onRenderMention: renderMGTMention(chatState)\n                    }\n                  }}\n                  onRenderMessage={onRenderMessage}\n                />\n              </div>\n              <div className={styles.chatInput}>\n                <SendBox onSendMessage={chatState.onSendMessage} />\n              </div>\n              <ErrorBar activeErrorMessages={chatState.activeErrorMessages} />\n            </>\n          ) : (\n            <>\n              {isLoading && (\n                <div className={styles.spinner}>\n                  <Spinner /> <br />\n                  {chatState.status}\n                </div>\n              )}\n              {chatState.status === 'no messages' && (\n                <ChatMessageBar\n                  messageBarType={MessageBarType.error}\n                  message={`No messages were found for the id ${chatId}.`}\n                />\n              )}\n              {chatState.status === 'no chat id' && (\n                <ChatMessageBar messageBarType={MessageBarType.error} message={'A valid chat id is required.'} />\n              )}\n            </>\n          )}\n        </div>\n      </FluentProvider>\n    </FluentThemeProvider>\n  );\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { useEffect, useState } from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { StatefulGraphChatClient } from './StatefulGraphChatClient';\nimport { log } from '@microsoft/mgt-element';\n\nexport const useGraphChatClient = (chatId: string): StatefulGraphChatClient => {\n  const [sessionId, setSessionId] = useState<string | undefined>();\n  const [chatClient] = useState<StatefulGraphChatClient>(() => new StatefulGraphChatClient());\n  // generate a new sessionId when the chatId changes\n  useEffect(() => {\n    setSessionId(uuid());\n  }, [chatId]);\n\n  // when chatId or sessionId changes this effect subscribes or unsubscribes\n  // the component to/from web socket based notifications for the given chatId\n  useEffect(() => {\n    // we must have both a chatId & sessionId to subscribe.\n    if (chatId && sessionId) chatClient.subscribeToChat(chatId, sessionId);\n  }, [chatId, sessionId, chatClient]);\n\n  // Returns a cleanup function to call tearDown on the chatClient\n  // This allows us to clean up when the consuming component is being unmounted from the DOM\n  useEffect(() => {\n    return () => {\n      log('invoked clean up effect');\n      void chatClient.tearDown();\n    };\n  }, [chatClient]);\n\n  return chatClient;\n};\n","import React, { FC, useCallback, useState } from 'react';\nimport { IDynamicPerson } from '@microsoft/mgt-components';\nimport { Chat } from '@microsoft/microsoft-graph-types';\nimport { IGraph, PeoplePicker, Spinner } from '@microsoft/mgt-react';\nimport {\n  Button,\n  Field,\n  FluentProvider,\n  Input,\n  InputOnChangeData,\n  Textarea,\n  TextareaOnChangeData,\n  makeStyles,\n  typographyStyles,\n  shorthands,\n  webLightTheme\n} from '@fluentui/react-components';\nimport { createChatThread } from '../../statefulClient/graph.chat';\nimport { graph } from '../../utils/graph';\nimport { currentUserId } from '../../utils/currentUser';\n\ninterface NewChatProps {\n  mode?: 'oneOnOne' | 'group' | 'auto';\n  onChatCreated: (chat: Chat) => void;\n  onCancelClicked: () => void;\n}\n\nconst useStyles = makeStyles({\n  title: {\n    ...typographyStyles.subtitle2,\n    ...shorthands.marginInline('32px')\n  },\n  form: {\n    display: 'flex',\n    flexDirection: 'column',\n    gridRowGap: '16px',\n    minWidth: '300px'\n  },\n  formButtons: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    gridColumnGap: '8px'\n  }\n});\n\nconst NewChat: FC<NewChatProps> = ({ mode = 'auto', onChatCreated, onCancelClicked }: NewChatProps) => {\n  const styles = useStyles();\n  type NewChatState = 'initial';\n\n  const [isGroup, setIsGroup] = useState<boolean>(mode === 'group');\n\n  const [state, setState] = useState<NewChatState | 'creating chat' | 'done'>('initial');\n  // chat member data control\n  const [selectedPeople, setSelectedPeople] = useState<IDynamicPerson[]>([]);\n  const onSelectedPeopleChange = useCallback(\n    (event: CustomEvent<IDynamicPerson[]>) => {\n      if (event.detail) {\n        setSelectedPeople(event.detail);\n        if (mode === 'auto') {\n          setIsGroup(event.detail.length > 1);\n        }\n      }\n    },\n    [mode]\n  );\n  // chat name data control\n  const [chatName, setChatName] = useState<string>();\n  const onChatNameChanged = useCallback(\n    (_: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, data: InputOnChangeData) => {\n      setChatName(data.value);\n    },\n    []\n  );\n  // initial message data control\n  const [initialMessage, setInitialMessage] = useState<string>();\n  const onInitialMessageChange = useCallback(\n    (event: React.FormEvent<HTMLTextAreaElement>, data: TextareaOnChangeData) => {\n      setInitialMessage(data.value);\n    },\n    []\n  );\n  const createChat = useCallback(() => {\n    const graphClient: IGraph = graph('mgt-new-chat');\n    setState('creating chat');\n    const chatMembers = [currentUserId()];\n    selectedPeople.reduce((acc, person) => {\n      if (person.id) acc.push(person.id);\n      return acc;\n    }, chatMembers);\n    void createChatThread(graphClient, chatMembers, isGroup, initialMessage, chatName).then(chat => {\n      setState('done');\n      onChatCreated(chat);\n    });\n  }, [onChatCreated, selectedPeople, initialMessage, chatName, isGroup]);\n\n  return (\n    <FluentProvider theme={webLightTheme}>\n      {state === 'initial' ? (\n        <div className={styles.form}>\n          <Field label=\"To\">\n            <PeoplePicker\n              disabled={(mode === 'oneOnOne' && selectedPeople?.length > 0) || selectedPeople?.length > 19}\n              ariaLabel=\"Select people to chat with\"\n              selectedPeople={selectedPeople}\n              selectionChanged={onSelectedPeopleChange}\n            />\n          </Field>\n\n          {isGroup && (\n            <Field label=\"Group name\">\n              <Input placeholder=\"Chat name\" onChange={onChatNameChanged} value={chatName} />\n            </Field>\n          )}\n          <Textarea\n            placeholder=\"Type your first message\"\n            size=\"large\"\n            resize=\"vertical\"\n            value={initialMessage}\n            onChange={onInitialMessageChange}\n          />\n          <div className={styles.formButtons}>\n            <Button appearance=\"secondary\" onClick={onCancelClicked}>\n              Cancel\n            </Button>\n            <Button appearance=\"primary\" onClick={createChat}>\n              Send\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <>\n          {state}\n          {state !== 'done' && <Spinner />}\n        </>\n      )}\n    </FluentProvider>\n  );\n};\n\nexport { NewChat };\n","import { Persona, makeStyles, mergeClasses, shorthands } from '@fluentui/react-components';\nimport { Providers } from '@microsoft/mgt-element';\nimport { MgtTemplateProps, Person, ViewType } from '@microsoft/mgt-react';\nimport { Chat, AadUserConversationMember } from '@microsoft/microsoft-graph-types';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { PeopleCommunityRegular, CalendarMonthRegular } from '@fluentui/react-icons';\n\nconst useStyles = makeStyles({\n  chat: {\n    paddingLeft: '5px',\n    paddingRight: '5px',\n    display: 'flex',\n    alignItems: 'center',\n    height: '50px',\n    cursor: 'pointer',\n    ':hover': {\n      backgroundColor: 'var(--colorNeutralBackground1Hover)'\n    }\n  },\n  active: {\n    backgroundColor: 'var(--colorNeutralBackground1Selected)'\n  },\n  person: {\n    '--person-avatar-size-small': '40px',\n    '& .fui-Persona__primaryText': {\n      fontSize: 'var(--fontSizeBase300);'\n    },\n    '& .fui-Persona__secondaryText': {\n      whiteSpace: 'nowrap',\n      textOverflow: 'ellipsis',\n      width: '200px',\n      display: 'inline-block',\n      ...shorthands.overflow('hidden')\n    }\n  },\n  messagePreview: {\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    width: '200px',\n    display: 'inline-block',\n    ...shorthands.overflow('hidden')\n  }\n});\n\nexport interface ChatInteractionProps {\n  onSelected: (selected: Chat) => void;\n  selectedChat?: Chat;\n}\n\ninterface ChatItemProps {\n  chat: Chat;\n  isSelected?: boolean;\n}\n\nconst getMessagePreview = (chat: Chat) => {\n  return chat?.lastMessagePreview?.body?.contentType === 'text' ? chat?.lastMessagePreview?.body?.content : '...';\n};\n\nconst ChatItem = ({ chat, isSelected, onSelected }: ChatItemProps & ChatInteractionProps) => {\n  const styles = useStyles();\n  const [myId, setMyId] = useState<string>();\n\n  useEffect(() => {\n    const getMyId = async () => {\n      const me = await Providers.me();\n      setMyId(me.id);\n    };\n    if (!myId) {\n      void getMyId();\n    }\n  }, [myId]);\n\n  const getOtherParticipantId = useCallback(\n    (chat: Chat) => {\n      const member = chat.members?.find(m => (m as AadUserConversationMember).userId !== myId);\n\n      if (member) {\n        console.log('member', member);\n        return (member as AadUserConversationMember).userId as string;\n      } else if (chat.members?.length === 1 && (chat.members[0] as AadUserConversationMember).userId === myId) {\n        return myId;\n      }\n\n      return undefined;\n    },\n    [myId]\n  );\n\n  const getGroupTitle = useCallback((chat: Chat) => {\n    let groupTitle: string | undefined = '';\n    if (chat.topic) {\n      groupTitle = chat.topic;\n    } else {\n      groupTitle = chat.members\n        ?.map(member => {\n          return member.displayName?.split(' ')[0];\n        })\n        .join(', ');\n    }\n\n    return groupTitle;\n  }, []);\n\n  return (\n    <>\n      {myId && (\n        <div className={mergeClasses(styles.chat, `${isSelected && styles.active}`)}>\n          {chat.chatType === 'oneOnOne' && (\n            <Person\n              userId={getOtherParticipantId(chat)}\n              view={ViewType.twolines}\n              avatarSize=\"auto\"\n              showPresence={true}\n              onClick={() => onSelected(chat)}\n              className={styles.person}\n            >\n              <MessagePreview template=\"line2\" chat={chat} />\n            </Person>\n          )}\n          {chat.chatType === 'group' && (\n            <div onClick={() => onSelected(chat)}>\n              <Persona\n                textAlignment=\"center\"\n                size=\"extra-large\"\n                name={getGroupTitle(chat)}\n                secondaryText={getMessagePreview(chat)}\n                avatar={{ icon: <PeopleCommunityRegular />, initials: null }}\n                className={styles.person}\n              />\n              <span></span>\n            </div>\n          )}\n          {chat.chatType === 'meeting' && (\n            <div onClick={() => onSelected(chat)}>\n              <Persona\n                textAlignment=\"center\"\n                size=\"extra-large\"\n                className={styles.person}\n                avatar={{ icon: <CalendarMonthRegular />, initials: null }}\n                name={getGroupTitle(chat)}\n                secondaryText={getMessagePreview(chat)}\n              />\n            </div>\n          )}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst MessagePreview = (props: MgtTemplateProps & ChatItemProps) => {\n  const styles = useStyles();\n\n  return (\n    <>\n      <span className={styles.messagePreview}>{getMessagePreview(props.chat)}</span>\n    </>\n  );\n};\n\nexport default ChatItem;\n","import React, { useState } from 'react';\nimport { MgtTemplateProps } from '@microsoft/mgt-react';\nimport { Chat } from '@microsoft/microsoft-graph-types';\nimport ChatItem, { ChatInteractionProps } from './ChatItem';\nimport { Chat as GraphChat } from '@microsoft/microsoft-graph-types';\n\nconst ChatListTemplate = (props: MgtTemplateProps & ChatInteractionProps) => {\n  const { value } = props.dataContext;\n  const chats: Chat[] = value;\n  const [selectedChat, setSelectedChat] = useState<GraphChat>(props.selectedChat || chats[0]);\n\n  const onChatSelected = React.useCallback(\n    (e: GraphChat) => {\n      setSelectedChat(e);\n      props.onSelected(selectedChat);\n    },\n    [setSelectedChat, selectedChat, props]\n  );\n\n  // Set the selected chat to the first chat in the list\n  // Fires only the first time the component is rendered\n  React.useEffect(() => {\n    onChatSelected(selectedChat);\n  });\n\n  const isChatActive = (chat: Chat) => {\n    if (selectedChat) {\n      return selectedChat && chat.id === selectedChat?.id;\n    }\n\n    return false;\n  };\n\n  console.log('chats', chats);\n  return (\n    <div>\n      {chats.map((c, index) => (\n        <ChatItem\n          key={c.id}\n          chat={c}\n          isSelected={(!selectedChat && index === 0) || isChatActive(c)}\n          onSelected={onChatSelected}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default ChatListTemplate;\n","import * as React from 'react';\nimport { PageHeader } from '../components/PageHeader';\nimport { Get } from '@microsoft/mgt-react';\nimport { Loading } from '../components/Loading';\nimport {\n  shorthands,\n  makeStyles,\n  mergeClasses,\n  Button,\n  Dialog,\n  DialogTrigger,\n  DialogSurface,\n  DialogBody,\n  DialogTitle\n} from '@fluentui/react-components';\nimport { Chat as GraphChat } from '@microsoft/microsoft-graph-types';\nimport { Chat, NewChat } from '@microsoft/mgt-chat';\nimport ChatListTemplate from './Chats/ChatListTemplate';\n\nconst useStyles = makeStyles({\n  container: {\n    display: 'flex',\n    flexDirection: 'row'\n  },\n  panels: {\n    ...shorthands.padding('10px')\n  },\n  main: {\n    display: 'flex',\n    flexDirection: 'column',\n    flexWrap: 'nowrap',\n    width: '300px',\n    minWidth: '300px',\n    ...shorthands.overflow('auto'),\n    maxHeight: '80vh',\n    borderRightColor: 'var(--neutral-stroke-rest)',\n    borderRightStyle: 'solid',\n    borderRightWidth: '1px'\n  },\n  side: {\n    display: 'flex',\n    flexDirection: 'column',\n    flexWrap: 'nowrap',\n    width: '80%',\n    ...shorthands.overflow('auto'),\n    maxHeight: '80vh',\n    height: '100%'\n  },\n  newChat: {\n    paddingBottom: '10px',\n    marginRight: '0px',\n    marginLeft: 'auto'\n  },\n  dialog: {\n    display: 'block'\n  },\n  dialogSurface: {\n    contain: 'unset'\n  }\n});\n\nconst ChatPage: React.FunctionComponent = () => {\n  const styles = useStyles();\n  const [selectedChat, setSelectedChat] = React.useState<GraphChat>();\n  const [isNewChatOpen, setIsNewChatOpen] = React.useState(false);\n\n  const chatSelected = (e: GraphChat) => {\n    if (e.id !== selectedChat?.id && isNewChatOpen) {\n      setIsNewChatOpen(false);\n    }\n    setSelectedChat(e);\n  };\n\n  return (\n    <>\n      <PageHeader\n        title={'Chats'}\n        description={'Stay in touch with your teammates and navigate your chats'}\n      ></PageHeader>\n\n      <div className={styles.container}>\n        <div className={mergeClasses(styles.panels, styles.main)}>\n          <div className={styles.newChat}>\n            <Dialog open={isNewChatOpen}>\n              <DialogTrigger disableButtonEnhancement>\n                <Button appearance=\"primary\" onClick={() => setIsNewChatOpen(true)}>\n                  New Chat\n                </Button>\n              </DialogTrigger>\n              <DialogSurface className={styles.dialogSurface}>\n                <DialogBody className={styles.dialog}>\n                  <DialogTitle>New Chat</DialogTitle>\n                  <NewChat\n                    onChatCreated={chatSelected}\n                    onCancelClicked={() => {\n                      setIsNewChatOpen(false);\n                    }}\n                  ></NewChat>\n                </DialogBody>\n              </DialogSurface>\n            </Dialog>\n          </div>\n          <ChatList chatSelected={selectedChat} onChatSelected={setSelectedChat}></ChatList>\n        </div>\n        <div className={styles.side}>{selectedChat && <Chat chatId={selectedChat.id!}></Chat>}</div>\n      </div>\n    </>\n  );\n};\n\ninterface ChatListProps {\n  onChatSelected: (e: GraphChat) => void;\n  chatSelected: GraphChat | undefined;\n}\n\nconst ChatList = React.memo((props: ChatListProps) => {\n  const getPreviousDate = (months: number) => {\n    const date = new Date();\n    date.setMonth(date.getMonth() - months);\n    return date.toISOString();\n  };\n\n  return (\n    <Get\n      resource={`me/chats?$expand=members,lastMessagePreview&$orderBy=lastMessagePreview/createdDateTime desc&$filter=viewpoint/lastMessageReadDateTime ge ${getPreviousDate(\n        9\n      )}`}\n      scopes={['chat.read']}\n      cacheEnabled={true}\n    >\n      <ChatListTemplate\n        template=\"default\"\n        onSelected={props.onChatSelected}\n        selectedChat={props.chatSelected}\n      ></ChatListTemplate>\n      <Loading template=\"loading\" message={'Loading your chats...'}></Loading>\n    </Get>\n  );\n});\n\nexport default ChatPage;\n"],"names":["chatOperationScopes","Array","from","concat","Object","values","loadPresence","searchUsers","searchPeople","getMgtPersonCardScopes","reduce","acc","scopes","forEach","s","add","Set","GraphConfig","_classCallCheck","_createClass","key","get","useCanary","graphEndpoint","this","canarySubscriptionVersion","baseCanaryUrl","value","url","replace","webSocketsPrefix","_defineProperty","GroupType","isConversationCacheEnabled","CacheService","config","conversation","isEnabled","cacheEntryIsValid","cacheEntry","timeCached","invalidationPeriod","defaultInvalidationPeriod","Date","now","buildCacheKey","chatId","sessionId","SubscriptionsCache","schemas","getCache","stores","subscriptions","_loadSubscriptions","_asyncToGenerator","_regeneratorRuntime","mark","_callee","cacheKey","data","wrap","_context","prev","next","cache","getValue","sent","lastAccessDateTime","toISOString","putValue","abrupt","undefined","stop","_x","_x2","apply","arguments","_cacheSubscription","_callee2","subscriptionRecord","subIndex","_context2","loadSubscriptions","findIndex","resource","push","_x3","_x4","_x5","delete","inactivityThreshold","queryDb","IDBKeyRange","upperBound","Timer","_this","Map","event","intervalWork","type","work","has","id","worker","SharedWorker","URL","port","onmessage","onMessage","callback","delay","uuid","set","postMessage","close","appSettings","GraphNotificationClient","emitter","_graph","token","Providers","globalProvider","getAccessToken","Error","connectionId","log","message","notification","JSON","parse","resourceData","includes","processMessageNotification","o","isMembershipNotification","processChatPropertiesNotification","processMembershipNotification","ackMessage","StatusCode","ackAsString","stringify","_ref2","subscriptionCache","cacheSubscription","renewalInterval","startRenewalTimer","timer","clearInterval","setInterval","syncTimerWrapper","renewalTimer","_callee3","_yield$_this$subscrip","_iterator","_step","subscription","expirationTime","_context3","t2","t1","t3","t0","length","_createForOfIteratorHelper","n","done","expirationDateTime","Math","round","getTime","renewalCount","renewChatSubscriptions","t4","e","f","finish","_callee4","awaits","_iterator2","_step2","_context4","renewSubscription","Promise","all","_ref5","_callee5","subscriptionId","renewedSubscription","_context5","graph","api","subscriptionEndpoint","patch","cleanupTimer","_callee6","offset","threshold","inactiveSubs","tasks","_iterator3","_step3","inactive","_iterator4","_step4","_inactive","_context6","min","loadInactiveSubscriptions","removeSubscriptions","err","deleteCachedSubscriptions","startCleanupTimer","BetaGraph","fromGraph","createFromProvider","beta","_tearDown","_callee7","_context7","cleanupInterval","unsubscribeFromChatNotifications","changeType","chatMessageReceived","chatMessageEdited","chatMessageDeleted","member","participantAdded","participantRemoved","chat","chatThreadPropertiesUpdated","chatThreadDeleted","_subscribeToResource","_callee8","resourcePath","changeTypes","subscriptionDefinition","_context8","join","notificationUrl","includeResourceData","clientState","subscriptionGraph","post","connection","createSignalRConnection","_createSignalRConnection","_callee9","connectionOptions","_context9","accessTokenFactory","getToken","withCredentials","HubConnectionBuilder","withUrl","adjustNotificationUrl","withAutomaticReconnect","configureLogging","LogLevel","Information","build","onreconnected","onReconnect","on","receiveNotificationMessage","start","error","_x6","_deleteSubscription","_callee10","_context10","_x7","_removeSubscriptions","_callee11","_iterator5","_step5","_context11","deleteSubscription","_x8","cleanupTimerSync","_closeSignalRConnection","_callee12","_this$connection","_context12","_unsubscribeFromChatNotifications","_callee13","cacheData","_context13","closeSignalRConnection","_x9","_x10","_subscribeToChatNotifications","_callee14","_cacheData$subscripti","someExpired","webSocketUrl","promises","_context14","some","find","subscribeToResource","_x11","_x12","getGroupsInvalidationTime","groups","getIsGroupsCacheEnabled","findGroups","query","top","groupTypes","any","groupFilters","__awaiter","cacheGroupQuery","filterQuery","responses","batchedResult","batch","filterGroups","_i","_filterGroups","filter","_i2","_filterGroups2","filterGroup","_loop","queries","_filter","result","groupsQuery","map","x","slice","createBatch","unified","security","mailenabledsecurity","distribution","executeAll","content","group","batchedGroup","delegateYield","count","header","middlewareOptions","prepScopes","a","b","getGroup","requestedProps","cachedData","uniqueProps","apiString","response","prop","keys","toString","getGroupsForGroupIds","groupIds","filters","groupDict","notInCache","_id","apiUrl","call","t5","findGroupsFromGroupIds","foundGroups","graphGroups","styles","css","_templateObject","_taggedTemplateLiteral","strings","inputPlaceholderText","maxSelectionsPlaceHolder","maxSelectionsAriaLabel","noResultsFound","loadingMessage","selected","removeSelectedUser","selectContact","suggestionsTitle","registerMgtPeoplePickerComponent","registerFluentComponents","fluentTextField","fluentCard","registerMgtFlyoutComponent","registerMgtPersonComponent","registerMgtSpinnerComponent","registerComponent","MgtPeoplePicker","_MgtTemplatedComponen","_inherits","_super","_createSuper","_type","PersonType","person","_groupType","_userType","UserType","_selectedPeople","_arrowSelectionCount","defaultSelectedUsers","defaultSelectedGroups","_highlightedUsers","_currentHighlightedUserPos","_isFocused","_setAnyEmail","handleSelectionChanged","selectedPeople","disabled","enableTextInput","handleInputClick","flyout","isOpen","handleUserSearch","gainedFocus","clearHighlighted","loadState","showFlyout","lostFocus","input","setAttribute","peopleList","renderRoot","querySelector","children","el","classList","remove","requestUpdate","onUserKeyUp","keyName","isCmdOrCtrlKey","getModifierState","isPaste","isArrowKey","hideFlyout","clearInput","_foundPeople","userInput","splice","allowAnyEmail","preventDefault","stopPropagation","onUserInput","target","isValidEmail","handleAnyEmail","onUserKeyDown","selectedList","querySelectorAll","Number","isNaN","pop","personParent","parentElement","highlightSelectedPeople","handleArrowSelection","shiftKey","foundPerson","addPerson","hasMaxSelections","disableTextInput","handleCut","writeHighlightedText","then","removeHighlightedOnCut","handleCopy","handlePaste","navigator","clipboard","readText","copiedText","people","SyntaxError","listOfUsers","_delimiters","delimiter","split","selectUsersById","_","clearState","_showLoading","showMax","disableImages","addEventListener","_groupId","requestStateUpdate","_groupIds","arraysAreEqual","_transitiveSearch","transitiveSearch","_people","_showMax","fireCustomEvent","_defaultSelectedUserIds","_defaultSelectedGroupIds","_userIds","_userFilters","_peopleFilters","_groupFilters","inputControl","shadowRoot","removeAttribute","focus","selectionMode","options","select","userIds","provider","state","ProviderState","SignedIn","userId","getUser","defaultPersonProperties","personDetails","isGraphError","_a","anyMailUser","mail","displayName","groupDetails","defaultTemplate","renderTemplate","selectedPeopleTemplate","renderSelectedPeople","inputTemplate","renderInput","flyoutTemplate","renderFlyout","html","force","_groupPeople","defaultPeople","_get","_getPrototypeOf","prototype","placeholder","searchIcon","_templateObject2","getSvg","SvgIcon","Search","startSlot","_templateObject3","ariaLabel","_c","_b","_this2","_templateObject5","repeat","_templateObject6","renderSelectedPerson","removePerson","handleRemovePersonKeyDown","Close","_templateObject4","anchor","_this3","mgtHtml","_templateObject7","handleSectionScroll","renderFlyoutContent","isLoadingState","renderLoading","renderSearchResults","renderNoData","_templateObject8","_templateObject9","_this4","filteredPeople","_templateObject10","_templateObject11","handleSuggestionClick","renderPersonResult","_templateObject12","showPresence","PersonCardInteraction","none","_templateObject13","ViewType","oneline","toLowerCase","displayNameMatch","forComponent","groupId","findGroupMembers","userFilters","peopleFilters","findUsersFromGroupIds","peopleInGroups","getUsersForUserIds","isUserOrContactType","userType","user","contact","getUsers","getPeople","groupType","defaultSelectedUserIds","defaultSelectedGroupIds","_toConsumableArray","findUsers","_d","findPeople","t6","t7","t8","t9","users","peopleIds","p","t10","t11","t12","t13","filterPeople","open","filteredPersonArr","_this5","setTimeout","_this6","_debouncedSearch","debounce","loadingTimeout","_this7","clearTimeout","copyText","element","_element$_personDetai","userPrincipalName","scoredEmailAddresses","emailAddress","address","email","copiedTextStr","writeText","_step6","_iterator6","node","_step7","_iterator7","_step8","_iterator8","blur","focusedItem","scrollIntoView","behavior","block","inline","uniquePeople","_step9","idFilter","filtered","indexOf","dupsSet","_iterator9","d","deltaY","scrollTop","clientHeight","scrollHeight","MgtPerson","requiredScopes","MgtTemplatedComponent","__decorate","property","attribute","converter","trim","v","_step10","_iterator10","c","Boolean","String","removeTaskSubtitle","cancelNewTaskSubtitle","newTaskPlaceholder","addTaskButtonSubtitle","due","addTaskDate","assign","addPlannerTask","newTask","assignPeopleToPlannerTask","task","details","assignments","appliedCategories","category4","setPlannerTaskDetails","removePlannerTask","eTag","setPlannerTaskComplete","percentComplete","setPlannerTaskIncomplete","update","getPlansForGroup","uri","plans","getSinglePlannerPlan","planId","getBucketsForPlannerPlan","buckets","getAllMyPlannerPlans","getTasksForPlannerBucket","bucketId","addTodoTask","_newTask$parentFolder","parentFolderId","getAllMyTodoGroups","getAllTodoTasksForFolder","folderId","getFoldersForTodoGroup","folders","getSingleTodoGroup","removeTodoTask","taskId","setTodoTaskComplete","setTodoTaskDetails","isReminderOn","status","setTodoTaskIncomplete","TaskSourceBase","PlannerTaskSource","_TaskSourceBase","plan","title","containerId","container","_raw","bucket","name","parentId","completed","dueDate","dueDateTime","immediateParentId","topParentId","myId","TodoTaskSource","_TaskSourceBase2","_super2","secondaryId","groupKey","folder","parId","completedDateTime","dateTime","subject","_context15","_callee15","_context16","_callee16","_context17","_callee17","timeZone","_context18","_callee18","_context19","_callee19","resolve","_context20","_callee20","dotOptionsTitle","MgtDotOptions","_MgtBaseComponent","_clickHandler","handleItemClick","fn","handleItemKeydown","handleKeydownMenuOption","onDotClick","onDotKeydown","window","removeEventListener","menuOptions","classMap","menu","opt","getMenuOption","clickFn","code","MgtBaseComponent","MgtArrowOptions","onHeaderClick","onHeaderKeyDown","fluentMenuEl","firstMenuItem","closed","getMenuOptions","TasksSource","TASK_RES","BASE_SELF_ASSIGNED","BUCKETS_SELF_ASSIGNED","BUCKET_NOT_FOUND","PLANS_SELF_ASSIGNED","PLAN_NOT_FOUND","plannerAssignment","orderHint","registerMgtTasksComponent","fluentSelect","fluentOption","fluentButton","fluentCheckbox","fluentSkeleton","fluentMenu","fluentMenuItem","registerMgtPeopleComponent","MgtTasks","dataSource","planner","_isDarkMode","_me","onResize","mediaQuery","previousMediaQuery","onThemeChanged","isElementDark","_assertThisInitialized","onAddTaskClick","picker","getPeoplePicker","peopleObj","_newTaskBeingAdded","_newTaskName","_currentGroup","_newTaskGroupId","addTask","_newTaskDueDate","_currentFolder","_newTaskFolderId","onAddTaskKeyDown","newTaskButtonKeydown","isNewTaskVisible","addNewTaskButtonClick","handleNewTaskDateChange","handleSelectedPlan","_groups","iTask","_newTaskContainerId","newTaskVisible","handleDateChange","renderPlannerIcon","iconColor","Planner","renderBucketIcon","Milestone","handlePeopleClick","togglePeoplePicker","handlePeopleKeydown","handlePeoplePickerKeydown","todo","_isNewTaskVisible","oldVal","newVal","initialId","initialBucketId","_tasks","_folders","_hiddenTasks","_loadingTasks","_hasDoneInitialLoad","_inTaskLoad","_todoDefaultSet","changedProperties","loadingTask","renderLoadingTask","hideHeader","renderPlanOptions","renderNewTask","renderTask","ts","getTaskSource","getMe","_loadTasksForGroup","targetId","_loadTargetTodoTasks","_loadTargetPlannerTasks","_loadAllTasks","isTaskInSelectedGroupFilter","isTaskInSelectedFolderFilter","taskFilter","getTaskGroups","getTaskFoldersForTaskGroup","cur","ret","getTasksForTaskFolder","getTaskGroup","targetBucketId","defaultFolder","isDefaultFolder","getTaskGroupsForGroup","setTaskComplete","setTaskIncomplete","removeTask","currentTaskAssigneesIds","sort","newTaskAssigneesIds","every","index","assigneeId","assignPeopleToTask","addButton","readOnly","Add","currentGroup","res","groupOptions","groupSelect","separator","ChevronRight","currentFolder","folderOptions","_loop2","folderSelect","_loop3","taskTitle","grp","_templateObject14","_templateObject15","getPlanTitle","_templateObject16","_templateObject17","_templateObject18","_templateObject19","taskFolder","_templateObject20","getFolderName","_templateObject21","_templateObject22","dateField","dark","taskDue","_templateObject23","dateToInputValue","taskPeople","renderAssignedPeople","newTaskActionButtons","_templateObject24","_templateObject25","_templateObject26","mgtPeople","getMgtPeople","getFlyout","assignPeople","_task$name","_task$completed","groupTitle","folderTitle","context","taskTemplate","taskDetails","_templateObject27","_templateObject28","_templateObject29","getShortDateString","_templateObject30","taskOptions","hideOptions","_templateObject31","taskClasses","complete","incomplete","_templateObject32","handleTaskClick","checkTask","handleTaskCheckKeyDown","completeTask","uncompleteTask","assignedGroupId","_this8","taskAssigneeClasses","assignedPeople","raw","planGroupId","assignedPeopleTemplate","_templateObject33","_templateObject34","ifDefined","_templateObject35","updateAssignedPeople","_templateObject36","buck","isAssignedToMe","date","getTimezoneOffset","MgtPeople","label","off","MgtThemeToggle","onSwitchChanged","darkModeActive","checked","prefersDarkMode","matchMedia","matches","applyTheme","active","targetTheme","document","body","reflect","fromAttribute","toAttribute","registerMgtPersonCardComponent","registerMgtAgendaComponent","registerMgtGetComponent","registerMgtLoginComponent","registerMgtTeamsChannelPickerComponent","registerMgtTodoComponent","registerMgtFileComponent","registerMgtFileListComponent","registerMgtPickerComponent","registerMgtTaxonomyPickerComponent","fluentSwitch","registerMgtSearchBoxComponent","registerMgtSearchResultsComponent","getCurrentUser","_Providers$globalProv","_Providers$globalProv2","getActiveAccount","currentUserId","_getCurrentUser","component","version","MessageCache","chats","_loadMessages","_cacheMessages","messages","updateNextLink","nextLink","maxLastModifiedDateTime","_args2","curr","lastModifiedDateTime","m","addMessageToCacheData","_cacheMessage","_cachedData$lastModif","spliceIndex","_deleteMessage","ThreadEventEmitter","EventEmitter","listener","emit","resouce","loadChat","_ref","loadChatThread","messageCount","_response$OdataNext","orderby","loadChatThreadDelta","_ref3","lastModified","_response$OdataNext2","loadMoreChatMessages","_ref4","_response$OdataNext3","sendChatMessage","_x13","_x14","updateChatMessage","_ref6","messageId","_x15","_x16","_x17","_x18","deleteChatMessage","_ref7","_x19","_x20","_x21","removeChatMember","_ref8","membershipId","_x22","_x23","_x24","addChatMembers","_ref9","visibleHistoryStartDateTime","requests","addRequestBody","roles","method","headers","_x25","_x26","_x27","_x28","loadChatImage","_ref10","cachedPhoto","_cachedPhoto","blob","photos","teams","photo","getPhotoInvalidationTime","responseType","ResponseType","RAW","ok","blobToBase64","storePhotoInCache","_x29","_x30","createChatThread","_ref11","memberIds","isGroupChat","chatMessage","chatName","chatType","members","topic","_x31","_x32","_x33","_x34","_x35","updateChatTopic","_ref12","_x36","_x37","_x38","updateMessageContentWithImage","image","imageId","regex","RegExp","replacement","isChatMessage","msg","emojiRegex","emojiMatch","messageContent","match","rewriteEmojiContent","processEmojiContent","isChatMemberChangeEvent","eventDetail","MessageCreatedComparator","createdOn","ChatMessageCreatedComparator","createdDateTime","graphImageUrlRegex","StatefulGraphChatClient","detail","updateUserInfo","updateFollowedChat","SignedOut","Loading","_e$detail","handleAccountChange","_this$_notificationCl","clearCurrentUserMessages","_notificationClient","eventType","_nextLink","_cache","cacheMessages","_chatId","writeMessagesToState","pendingId","notifyStateChange","draft","pendingMessage","clientMessageId","contentType","messageType","senderDisplayName","_userDisplayName","senderId","mine","draftIndex","graphChatMessageToAcsChatMessage","currentValue","uncommitted","_state","draftMessage","setDeletedContent","updating","messageConversion","acsMessage","futureMessageState","updateMentions","cacheMessage","convertChatMessage","updateMessages","futureValue","newMessage","_newMessage$mentions","_draft$mentions","mentions","deleteMessage","eventualState","messageConversions","currentValueMessages","futureMessages","_messagesPerCall","_m$body","_m$body2","policyViolation","val","sm","checkForMissedMessages","_chat","added","participants","removeParticipantFromState","history","membershpId","_this$_chat$members$f","_this$_chat","_objectSpread","participantCount","_this$participants","disableEditing","numberOfChatMessagesToReload","onDeleteMessage","onSendMessage","sendMessage","onUpdateMessage","updateMessage","onAddChatMembers","onRemoveChatMember","onRenameChat","renameChat","activeErrorMessages","_initialState","onStateChanged","onLoginStateChanged","onActiveAccountChanged","_eventEmitter","registerEventListeners","tearDown","handler","_subscribers","recipe","produce","updateCurrentUserId","updateCurrentUserName","_getCurrentUser2","currentUserName","_userId","_sessionId","_updateFollowedChat","loadChatData","subscribeToChatNotifications","console","GraphError","_loadChatData","cachedMessages","deltaMessages","updatedState","reject","loadMessages","loadDeltaData","_loadDeltaData","_writeMessagesToState","_m$body3","_this3$_chat","_draft$mentions2","onLoadPreviousChatMessages","loadMoreMessages","_message$messageType","buildSystemContentMessage","_buildSystemContentMessage","_eventDetail$initiato","initiatorId","_eventDetail$members","_arr","userNames","initiator","getUserWithPhoto","getUserName","chatDisplayName","warn","systemMessageType","iconName","resolveIcon","_people$find","graphMessage","currentUser","_graphMessage$body$co","_graphMessage$body","_graphMessage$id","conversion","futureImages","messageResult","graphImageMatch","graphImageUrl","placeholderMessage","buildAcsMessage","_Object$entries","_Object$entries$_i","imageIndex","futureImage","_placeholderMessage$c","entries","_slicedToArray","_graphMessage$id2","_graphMessage$body$co2","_graphMessage$body2","_content","updateMentionsContent","processMessageContent","attachments","unsupportedContentTypes","isUnsupported","_attachment$contentTy","attachment","contentUnsupported","test","_graphMessage$from","_graphMessage$chatId","_graphMessage$id3","_graphMessage$attachm","_graphMessage$body$co3","_graphMessage$body3","_graphMessage$from$us","_graphMessage$from2","_graphMessage$created","chatUrl","messageData","editedOn","lastEditedDateTime","attached","hasUnsupportedContent","rawChatUrl","link","onMessageReceived","onMessageDeleted","onMessageEdited","onChatNotificationsSubscribed","onChatPropertiesUpdated","onParticipantAdded","onParticipantRemoved","useStyles","makeStyles","backgroundColor","display","boxShadow","textDecorationLine","color","shorthands","margin","borderRadius","padding","gap","cta","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","props","React","className","href","targetUrl","ArrowSquareUpRight24Regular","onRenderMessage","messageProps","defaultOnRender","_messageProps","unsupportedContentComponent","UnsupportedContent","renderToString","messageBarType","MessageBar","renderMGTMention","chatState","mention","defaultRenderer","_chatState$mentions","_teamsMention$mention","render","teamsMention","flat","_m$id","mentionText","displayText","mentioned","Person","personCardInteraction","hover","_props","template","classNames","colors","mergeStyles","width","height","buttonIconStyles","mergeStyleSets","button","icon","fill","iconFilled","iconUnfilled","useCommonHeaderStyles","row","paddingInlineStart","OneToOneChatHeader","_chat$members","getOtherParticipantUserId","view","avatarSize","border","overflow","background","justifyContent","alignItems","Circle","style","MeetingIcon","bundleIcon","Calendar16Regular","GroupIcon","PeopleTeam16Regular","ChatIcon","EditIcon","Edit16Filled","Edit16Regular","chatTitle","marginInlineStart","flexDirection","gridRowGap","minWidth","tokens","colorNeutralBackground1","formButtons","gridColumnGap","GroupChatHeader","_useState","useState","_useState2","isPopoverOpen","setIsPopoverOpen","handleOpenChange","useCallback","onCancelClicked","_useState3","_useState4","setChatName","onChatNameChanged","_p$displayName","reduceToFirstNamesList","popoverProps","trapFocus","inertTrapFocus","positioning","onOpenChange","Popover","PopoverTrigger","Button","appearance","PopoverSurface","Field","Input","onChange","onClick","useTitleStyles","chatHeader","columnGap","marginBlockStart","marginBlockEnd","zIndex","memo","commonStyles","mergeClasses","PeoplePicker","wrapMgt","addMembers","paddingBlockEnd","paddingInline","buttonRow","paddingBlockStart","dialogHeading","historyInput","option","radio","AddChatMembers","closeDialog","daysOfHistory","setDaysOfHistory","handleHistoryChanged","newNumber","parseInt","historyOption","setHistoryOption","onHistoryOptionChange","_useState5","_useState6","setSelectedPeople","peopleSelectionChanged","addToChat","chatHistoryOptions","text","onRenderField","selectionChanged","ChoiceGroup","selectedKey","RemovePerson","Dismiss20Filled","iconPlaceholder","listItem","listStyleType","_focusVisible","iconFilledClassName","iconRegularClassName","memberList","gridGap","marginBlock","personRow","paddingBlock","cursor","_hover","fullWidth","ListChatMembers","closeParentPopover","removeDialogOpen","setRemoveDialogOpen","removeUser","setRemoveUser","openRemoveDialog","removeMember","Dialog","DialogSurface","DialogBody","DialogTitle","DialogContent","DialogActions","List","navigable","isCurrentUser","ListItem","tabIndex","PersonViewType","AddPeople","PeopleAdd24Filled","PeopleAdd24Regular","Leave","DoorArrowLeft24Filled","DoorArrowLeft24Regular","divider","popover","triggerButton","marginInline","ManageChatMembers","showAddMembers","setShowAddMembers","openAddMembers","closeCallout","leaveChat","me","Divider","DialogTrigger","disableButtonEnhancement","TeamsIcon","createSvgIcon","svg","xmlns","viewBox","opacity","EllipsisIcon","MoreHorizontal24Filled","MoreHorizontal24Regular","menuProps","hasIcons","closeOnScroll","ellipsisMenuStyles","menuPopover","EllipsisMenu","Menu","MenuTrigger","MenuPopover","MenuList","MenuItemLink","chatWebUrl","useHeaderStyles","rowGap","secondRow","noGrow","flexGrow","ChatHeader","_chatState$chat$webUr","_chatState$chat","_chatState$participan","_chatState$chat2","webUrl","ChatTitle","vertical","inset","icons","DEFAULT_COMPONENT_ICONS","focusable","registerIcons","registerAppIcons","chatMessages","maxWidth","chatInput","fullHeight","spinner","unsupportedContent","messageThreadStyles","chatContainer","chatMessageContainer","myChatMessageContainer","Chat","chatClient","setSessionId","useEffect","subscribeToChat","useGraphChatClient","getState","setChatState","onStateChange","offStateChange","isLoading","FluentThemeProvider","fluentTheme","FluentTheme","FluentProvider","theme","webLightTheme","MessageThread","showMessageDate","onRenderAvatar","mentionOptions","displayOptions","onRenderMention","SendBox","ErrorBar","Spinner","ChatMessageBar","MessageBarType","typographyStyles","subtitle2","form","NewChat","_ref$mode","mode","onChatCreated","isGroup","setIsGroup","setState","onSelectedPeopleChange","_useState7","_useState8","_useState9","_useState10","initialMessage","setInitialMessage","onInitialMessageChange","createChat","graphClient","chatMembers","Textarea","size","resize","paddingLeft","paddingRight","whiteSpace","textOverflow","messagePreview","getMessagePreview","_chat$lastMessagePrev","_chat$lastMessagePrev2","_chat$lastMessagePrev3","_chat$lastMessagePrev4","lastMessagePreview","MessagePreview","_jsx","_Fragment","isSelected","onSelected","setMyId","getMyId","getOtherParticipantId","_chat$members2","getGroupTitle","_chat$members3","_member$displayName","_jsxs","twolines","Persona","textAlignment","secondaryText","avatar","PeopleCommunityRegular","initials","CalendarMonthRegular","dataContext","selectedChat","setSelectedChat","onChatSelected","ChatItem","panels","main","flexWrap","maxHeight","borderRightColor","borderRightStyle","borderRightWidth","side","newChat","paddingBottom","marginRight","marginLeft","dialog","dialogSurface","contain","ChatList","Get","months","setMonth","getMonth","getPreviousDate","cacheEnabled","ChatListTemplate","chatSelected","_React$useState","_React$useState2","_React$useState3","_React$useState4","isNewChatOpen","setIsNewChatOpen","PageHeader","description"],"sourceRoot":""}