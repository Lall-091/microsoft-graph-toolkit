(self.webpackChunkroot=self.webpackChunkroot||[]).push([[179],{2647:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__(60285),__webpack_require__(41539),__webpack_require__(78783),__webpack_require__(66992),__webpack_require__(33948),__webpack_require__(79753),__webpack_require__(82526),__webpack_require__(41817),__webpack_require__(32165),__webpack_require__(47042),__webpack_require__(68309),__webpack_require__(91038);var esm=__webpack_require__(32605),types=__webpack_require__(96899);const theme=(0,__webpack_require__(65316).Ue)({base:"light",colorSecondary:"#0360B9",textColor:"#1A1A1A",textInverseColor:"rgba(255,255,255,0.9)",barTextColor:"#717171",brandTitle:"Microsoft Graph Toolkit Playground",brandUrl:"https://aka.ms/mgt"});var react=__webpack_require__(67294),api_dist_esm=__webpack_require__(86141);class EventDispatcher{constructor(){this.eventHandlers=[]}fire(event){for(const handler of this.eventHandlers)handler(event)}add(eventHandler){this.eventHandlers.push(eventHandler)}remove(eventHandler){for(let i=0;i<this.eventHandlers.length;i++)this.eventHandlers[i]===eventHandler&&(this.eventHandlers.splice(i,1),i--)}}const MICROSOFT_GRAPH_ENDPOINTS=new Set(["https://graph.microsoft.com","https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn","https://canary.graph.microsoft.com"]),validateBaseURL=url=>{try{const originAsEndpoint=new URL(url).origin;if(MICROSOFT_GRAPH_ENDPOINTS.has(originAsEndpoint))return originAsEndpoint}catch(error){return}};class IProvider{get isMultiAccountSupportedAndEnabled(){return!1}set baseURL(url){if(!validateBaseURL(url))throw new Error(`${url} is not a valid Graph URL endpoint.`);this._baseURL=url}get baseURL(){return this._baseURL}set customHosts(hosts){this._customHosts=hosts}get customHosts(){return this._customHosts}get isMultiAccountSupported(){return this.isMultipleAccountSupported}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(disabled){this._isIncrementalConsentDisabled=disabled}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new EventDispatcher,this._activeAccountChangedDispatcher=new EventDispatcher,this._baseURL="https://graph.microsoft.com",this._customHosts=void 0,this._isIncrementalConsentDisabled=!1,this.isMultipleAccountSupported=!1,this._state=ProviderState.Loading}setState(state){state!==this._state&&(this._state=state,this._loginChangedDispatcher.fire({}))}onStateChanged(eventHandler){this._loginChangedDispatcher.add(eventHandler)}removeStateChangedHandler(eventHandler){this._loginChangedDispatcher.remove(eventHandler)}setActiveAccount(user){this.fireActiveAccountChanged()}onActiveAccountChanged(eventHandler){this._activeAccountChangedDispatcher.add(eventHandler)}removeActiveAccountChangedHandler(eventHandler){this._activeAccountChangedDispatcher.remove(eventHandler)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...scopes){return this.getAccessToken({scopes})}}var LoginType,ProviderState;!function(LoginType){LoginType[LoginType.Popup=0]="Popup",LoginType[LoginType.Redirect=1]="Redirect"}(LoginType||(LoginType={})),function(ProviderState){ProviderState[ProviderState.Loading=0]="Loading",ProviderState[ProviderState.SignedOut=1]="SignedOut",ProviderState[ProviderState.SignedIn=2]="SignedIn"}(ProviderState||(ProviderState={}));var ProvidersChangedState,__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class Providers{static get globalProvider(){return this._globalProvider}static set globalProvider(provider){provider!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.isMultiAccountSupportedAndEnabled&&this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),provider&&(provider.onStateChanged(this.handleProviderStateChanged),provider.isMultiAccountSupportedAndEnabled&&provider.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=provider,this._eventDispatcher.fire(ProvidersChangedState.ProviderChanged))}static onProviderUpdated(event){this._eventDispatcher.add(event)}static removeProviderUpdatedListener(event){this._eventDispatcher.remove(event)}static onActiveAccountChanged(event){this._activeAccountChangedDispatcher.add(event)}static removeActiveAccountChangedListener(event){this._activeAccountChangedDispatcher.remove(event)}static me(){return this.client?(this._mePromise||(this._mePromise=this.getMe()),this._mePromise):(this._mePromise=null,null)}static getMe(){return __awaiter(this,void 0,void 0,(function*(){try{const response=yield this.client.api("me").get();if(null==response?void 0:response.id)return response}catch(_a){}return null}))}static getCacheId(){var _a;return __awaiter(this,void 0,void 0,(function*(){if(this._cacheId)return this._cacheId;if((null===(_a=Providers.globalProvider)||void 0===_a?void 0:_a.state)===ProviderState.SignedIn&&!this._cacheId){if(this.client)try{this._cacheId=yield this.createCacheId()}catch(_b){}}return this._cacheId}))}static unsetCacheId(){this._cacheId=null,this._mePromise=null}static createCacheId(){return __awaiter(this,void 0,void 0,(function*(){if(Providers.globalProvider.isMultiAccountSupportedAndEnabled){const cacheId=this.createCacheIdWithAccountDetails();if(cacheId)return cacheId}return yield this.createCacheIdWithUserDetails()}))}static createCacheIdWithUserDetails(){return __awaiter(this,void 0,void 0,(function*(){const response=yield this.me();return(null==response?void 0:response.id)?response.id+"-"+response.userPrincipalName:null}))}static createCacheIdWithAccountDetails(){const user=Providers.globalProvider.getActiveAccount();return user.tenantId&&user.id?user.tenantId+user.id:null}static get client(){return Providers.globalProvider&&Providers.globalProvider.state===ProviderState.SignedIn?Providers.globalProvider.graph.client:null}}Providers._eventDispatcher=new EventDispatcher,Providers._activeAccountChangedDispatcher=new EventDispatcher,Providers.handleProviderStateChanged=()=>{Providers.globalProvider&&Providers.globalProvider.state===ProviderState.SignedIn||(Providers._mePromise=null),Providers._eventDispatcher.fire(ProvidersChangedState.ProviderStateChanged)},Providers.handleActiveAccountChanged=()=>{Providers.unsetCacheId(),Providers._activeAccountChangedDispatcher.fire(null)},function(ProvidersChangedState){ProvidersChangedState[ProvidersChangedState.ProviderChanged=0]="ProviderChanged",ProvidersChangedState[ProvidersChangedState.ProviderStateChanged=1]="ProviderStateChanged"}(ProvidersChangedState||(ProvidersChangedState={}));var browser=__webpack_require__(95666);class BatchResponse{}var utils_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class BatchRequest{constructor(index,id,resource,method){"/"!==resource.charAt(0)&&(resource="/"+resource),this.resource=resource,this.method=method,this.index=index,this.id=id}}var Batch_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class Batch{static get baseUrl(){return"https://graph.microsoft.com"}constructor(graph){this.graph=graph,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(id,resource,scopes,headers){const index=this.nextIndex++,request=new BatchRequest(index,id,resource,"GET");request.headers=headers,this.allRequests.push(request),this.requestsQueue.push(index),scopes&&(this.scopes=this.scopes.concat(scopes))}executeNext(){return Batch_awaiter(this,void 0,void 0,(function*(){const responses=new Map;var ms;if(this.retryAfter&&(yield(ms=1e3*this.retryAfter,utils_awaiter(void 0,void 0,void 0,(function*(){return new Promise((resolve=>{setTimeout(resolve,ms)}))}))),this.retryAfter=0),!this.hasRequests)return responses;const nextBatch=this.requestsQueue.splice(0,20),batchRequestContent=new browser.w5;for(const request of nextBatch.map((i=>this.allRequests[i])))batchRequestContent.addRequest({id:request.index.toString(),request:new Request(Batch.baseUrl+request.resource,{method:request.method,headers:request.headers})});const middlewareOptions=this.scopes.length?((...scopes)=>{const authProviderOptions={scopes};return Providers.globalProvider.isIncrementalConsentDisabled?[]:[new browser.xn(void 0,authProviderOptions)]})(...this.scopes):[],batchRequest=this.graph.api("$batch").middlewareOptions(middlewareOptions),batchRequestBody=yield batchRequestContent.getContent(),batchResponse=yield batchRequest.post(batchRequestBody);for(const r of batchResponse.responses){const response=new BatchResponse,index=parseInt(r.id,10),request=this.allRequests[index];if(response.id=request.id,response.index=request.index,response.headers=r.headers,200===r.status)"string"==typeof r.body?r.headers["Content-Type"].includes("image/jpeg")?response.content="data:image/jpeg;base64,"+r.body:r.headers["Content-Type"].includes("image/pjpeg")?response.content="data:image/pjpeg;base64,"+r.body:r.headers["Content-Type"].includes("image/png")&&(response.content="data:image/png;base64,"+r.body):response.content=r.body,responses.set(request.id,response);else if(429===r.status){this.requestsQueue.unshift(index);const requestRetryAfter=r.headers["Retry-After"];this.retryAfter=Math.max(this.retryAfter,parseInt(requestRetryAfter,10)||1)}}return responses}))}executeAll(){return Batch_awaiter(this,void 0,void 0,(function*(){const responses=new Map;for(;this.hasRequests;){const r=yield this.executeNext();for(const[key,value]of r)responses.set(key,value)}return responses}))}}class ComponentMiddlewareOptions{constructor(component){this.componentName="string"==typeof component?component:component.tagName.toLowerCase()}}const chainMiddleware=(...middleware)=>{const rootMiddleware=middleware[0];let current=rootMiddleware;for(let i=1;i<middleware.length;++i){const next=middleware[i];current.setNext&&current.setNext(next),current=next}return rootMiddleware};var MiddlewareUtil=__webpack_require__(77206),SdkVersionMiddleware_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class SdkVersionMiddleware{constructor(packageVersion,providerName){this._packageVersion=packageVersion,this._providerName=providerName}execute(context){var _a;return SdkVersionMiddleware_awaiter(this,void 0,void 0,(function*(){try{if("string"==typeof context.request)if(validateBaseURL(context.request)){const headerParts=[],componentOptions=context.middlewareControl.getMiddlewareOptions(ComponentMiddlewareOptions);if(componentOptions){const componentVersion=`${componentOptions.componentName}/${this._packageVersion}`;headerParts.push(componentVersion)}if(this._providerName){const providerVersion=`${this._providerName}/${this._packageVersion}`;headerParts.push(providerVersion)}const packageVersion=`mgt/${this._packageVersion}`;headerParts.push(packageVersion),headerParts.push((0,MiddlewareUtil.i5)(context.request,context.options,"SdkVersion"));const sdkVersionHeaderValue=headerParts.join(", ");(0,MiddlewareUtil.rn)(context.request,context.options,"SdkVersion",sdkVersionHeaderValue)}else null===(_a=null==context?void 0:context.options)||void 0===_a||delete _a.headers.SdkVersion}catch(error){}return yield this._nextMiddleware.execute(context)}))}setNext(next){this._nextMiddleware=next}}const customElementHelper=new class CustomElementHelper{constructor(){this._disambiguation=""}get defaultPrefix(){return"mgt"}withDisambiguation(disambiguation){return disambiguation&&!this._disambiguation&&(this._disambiguation=disambiguation),this}get prefix(){return this._disambiguation?`${this.defaultPrefix}-${this._disambiguation}`:this.defaultPrefix}get disambiguation(){return this._disambiguation}get isDisambiguated(){return Boolean(this._disambiguation)}normalize(tagName){return this.isDisambiguated?tagName.toUpperCase().replace(this.prefix.toUpperCase(),this.defaultPrefix.toUpperCase()):tagName}};class Graph{get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}constructor(client,version="v1.0"){this._client=client,this._version=version}forComponent(component){const graph=new Graph(this._client,this._version);return graph.setComponent(component),graph}api(path){let request=this._client.api(path).version(this._version);return this._componentName&&(request.middlewareOptions=options=>(request._middlewareOptions=request._middlewareOptions.concat(options),request),request=request.middlewareOptions([new ComponentMiddlewareOptions(this._componentName)])),request}createBatch(){return new Batch(this)}setComponent(component){this._componentName=component instanceof Element?customElementHelper.normalize(component.tagName):component}}var PromptType,PublicClientApplication=__webpack_require__(8581),InteractionRequiredAuthError=__webpack_require__(83927),Msal2Provider_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};!function(PromptType){PromptType.SELECT_ACCOUNT="select_account",PromptType.LOGIN="login",PromptType.CONSENT="consent"}(PromptType||(PromptType={}));class SessionCache{constructor(){this.session=window.sessionStorage}setItem(key,value){this.session.setItem(key,value)}getItem(key){return this.session.getItem(key)}clear(){this.session.clear()}}var MockMiddleware_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class MockMiddleware{static get _sessionCache(){return!this._cache&&(storageType=>{let storage;try{storage="sessionStorage"===storageType?window.sessionStorage:window.localStorage;const x="__storage_test__";return storage.setItem(x,x),storage.removeItem(x),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&storage&&0!==storage.length}})("sessionStorage")&&(this._cache=new SessionCache),this._cache}execute(context){return MockMiddleware_awaiter(this,void 0,void 0,(function*(){try{const baseUrl=yield MockMiddleware.getBaseUrl();context.request=baseUrl+encodeURIComponent(context.request)}catch(error){}return yield this._nextMiddleware.execute(context)}))}setNext(next){this._nextMiddleware=next}static getBaseUrl(){var _a,_b;return MockMiddleware_awaiter(this,void 0,void 0,(function*(){if(!this._baseUrl){const sessionEndpoint=null===(_a=this._sessionCache)||void 0===_a?void 0:_a.getItem("endpointURL");if(sessionEndpoint)this._baseUrl=sessionEndpoint;else{try{const response=yield fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint"),base=yield response.json();"string"!=typeof base?MockMiddleware.setBaseFallbackUrl():this._baseUrl=base+"?url="}catch(_c){MockMiddleware.setBaseFallbackUrl()}null===(_b=this._sessionCache)||void 0===_b||_b.setItem("endpointURL",this._baseUrl)}}return this._baseUrl}))}static setBaseFallbackUrl(){this._baseUrl="https://proxy.apisandbox.msdn.microsoft.com/svc?url="}}var MockGraph_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class MockGraph extends Graph{static create(provider){return MockGraph_awaiter(this,void 0,void 0,(function*(){const middleware=[new browser.uM(provider),new browser.vU(new browser.WI),new browser.Pw,new MockMiddleware,new browser.LW];return new MockGraph(browser.KU.initWithMiddleware({middleware:chainMiddleware(...middleware),customHosts:new Set([new URL(yield MockMiddleware.getBaseUrl()).hostname])}))}))}forComponent(component){return this}}var MockProvider_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isLoginEnabled=function isLoginEnabled(){return"true"===new window.URL(window.location.href).searchParams.get("login")};document.getElementById("mgt-version").innerText="3.1.0-next.enable-tree-shaking.b2c2277";var mockProvider=new class MockProvider extends IProvider{constructor(signedIn=!1,signedInAccounts=[]){super(),this._accounts=[],this._mockGraphPromise=MockGraph.create(this);const enableMultipleLogin=Boolean(signedInAccounts.length);this.isMultipleAccountSupported=enableMultipleLogin,this.isMultipleAccountDisabled=!enableMultipleLogin,this._accounts=signedInAccounts,this.initializeMockGraph(signedIn)}get isMultiAccountSupportedAndEnabled(){return!this.isMultipleAccountDisabled&&this.isMultipleAccountSupported}getAllAccounts(){return this._accounts}getActiveAccount(){if(this._accounts.length)return this._accounts[0]}login(){return MockProvider_awaiter(this,void 0,void 0,(function*(){this.setState(ProviderState.Loading),yield this._mockGraphPromise,yield new Promise((resolve=>setTimeout(resolve,3e3))),this.setState(ProviderState.SignedIn)}))}logout(){return MockProvider_awaiter(this,void 0,void 0,(function*(){this.setState(ProviderState.Loading),yield this._mockGraphPromise,yield new Promise((resolve=>setTimeout(resolve,3e3))),this.setState(ProviderState.SignedOut)}))}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}initializeMockGraph(signedIn=!1){return MockProvider_awaiter(this,void 0,void 0,(function*(){this.graph=yield this._mockGraphPromise,signedIn?this.setState(ProviderState.SignedIn):this.setState(ProviderState.SignedOut)}))}}(!0),msal2Provider=new class Msal2Provider extends IProvider{get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}get isMultiAccountDisabled(){return!this.isMultipleAccountEnabled}set isMultiAccountDisabled(value){this.isMultipleAccountEnabled=!value}get isMultiAccountSupportedAndEnabled(){return this.isMultipleAccountEnabled}get sessionStorageRequestedScopesKey(){return"mgt-requested-scopes"}get sessionStorageDeniedScopesKey(){return"mgt-denied-scopes"}get homeAccountKey(){return"275f3731-e4a4-468a-bf9c-baca24b31e26"}constructor(config){super(),this.isMultipleAccountEnabled=!0,this.initProvider(config)}initProvider(config){return Msal2Provider_awaiter(this,void 0,void 0,(function*(){const msalConfig=config.options||{auth:{clientId:""}};if(this.ms_config=msalConfig,this.ms_config.cache=msalConfig.cache||{},this.ms_config.cache.cacheLocation=msalConfig.cache.cacheLocation||"localStorage",void 0!==this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=msalConfig.system||{},this.ms_config.system.iframeHashTimeout=msalConfig.system.iframeHashTimeout||1e4,config.authority&&(this.ms_config.auth.authority=config.authority),config.redirectUri&&(this.ms_config.auth.redirectUri=config.redirectUri),"clientId"in config){if(!config.clientId)throw new Error("clientId must be provided");this.ms_config.auth.clientId=config.clientId,this._publicClientApplication=new PublicClientApplication.L(this.ms_config)}else{if(!("publicClientApplication"in config))throw new Error("either clientId or publicClientApplication must be provided");if(!config.publicClientApplication)throw new Error("publicClientApplication must be provided");this._publicClientApplication=config.publicClientApplication}this.ms_config.system=msalConfig.system||{},this.ms_config.system.iframeHashTimeout=msalConfig.system.iframeHashTimeout||1e4,this._loginType=void 0!==config.loginType?config.loginType:LoginType.Redirect,this._loginHint=void 0!==config.loginHint?config.loginHint:null,this._sid=void 0!==config.sid?config.sid:null,this.isIncrementalConsentDisabled=void 0!==config.isIncrementalConsentDisabled&&config.isIncrementalConsentDisabled,this._domainHint=void 0!==config.domainHint?config.domainHint:null,this.scopes=void 0!==config.scopes?config.scopes:["user.read"],this._prompt=void 0!==config.prompt?config.prompt:PromptType.SELECT_ACCOUNT;const msal2config=config;this.isMultipleAccountEnabled=void 0===msal2config.isMultiAccountEnabled||msal2config.isMultiAccountEnabled,this.baseURL=void 0!==msal2config.baseURL?msal2config.baseURL:this.baseURL,this.customHosts=msal2config.customHosts,this.graph=((provider,version,component)=>{const middleware=[new browser.uM(provider),new browser.vU(new browser.WI),new browser.Pw,new SdkVersionMiddleware("3.1.0-next.enable-tree-shaking.b2c2277",provider.name),new browser.LW],baseURL=provider.baseURL?provider.baseURL:"https://graph.microsoft.com",client=browser.KU.initWithMiddleware({middleware:chainMiddleware(...middleware),customHosts:void 0===typeof provider.customHosts?null:new Set(provider.customHosts),baseUrl:baseURL}),graph=new Graph(client,version);return component?graph.forComponent(component):graph})(this);try{const tokenResponse=yield this._publicClientApplication.handleRedirectPromise();null!==tokenResponse?this.handleResponse(null==tokenResponse?void 0:tokenResponse.account):yield this.trySilentSignIn()}catch(e){throw console.error("🦒: Problem attempting to sign in",e),e}}))}trySilentSignIn(){return Msal2Provider_awaiter(this,void 0,void 0,(function*(){const silentRequest={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){silentRequest.sid=this._sid,silentRequest.loginHint=this._loginHint;try{this.setState(ProviderState.Loading);const response=yield this._publicClientApplication.ssoSilent(silentRequest);response&&this.handleResponse(null==response?void 0:response.account)}catch(e){this.setState(ProviderState.SignedOut)}}else{const account=this.getAccount();if(account&&(yield this.getAccessToken(null)))return void this.handleResponse(account);this.setState(ProviderState.SignedOut)}}))}login(){return Msal2Provider_awaiter(this,void 0,void 0,(function*(){const loginRequest={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType===LoginType.Popup){const response=yield this._publicClientApplication.loginPopup(loginRequest);this.handleResponse(null==response?void 0:response.account)}else{const loginRedirectRequest=Object.assign({},loginRequest);yield this._publicClientApplication.loginRedirect(loginRedirectRequest)}}))}getAllAccounts(){const usernames=[];return this._publicClientApplication.getAllAccounts().forEach((account=>{usernames.push({name:account.name,mail:account.username,id:account.homeAccountId})})),usernames}setActiveAccount(user){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(user.id)),this.setStoredAccount(),super.setActiveAccount(user)}getActiveAccount(){const account=this._publicClientApplication.getActiveAccount();return{name:account.name,mail:account.username,id:account.homeAccountId,tenantId:account.tenantId}}handleResponse(account){null!==account?(this.setActiveAccount({name:account.name,id:account.homeAccountId,mail:account.username}),this.setState(ProviderState.SignedIn)):this.setState(ProviderState.SignedOut),this.clearRequestedScopes()}storage(){return"localStorage"===this.ms_config.cache.cacheLocation?window.localStorage:window.sessionStorage}setStoredAccount(){this.clearStoredAccount(),this.storage().setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){const homeId=this.storage().getItem(this.homeAccountKey);return this._publicClientApplication.getAccountByHomeId(homeId)}clearStoredAccount(){this.storage().removeItem(this.homeAccountKey)}setRequestedScopes(scopes){scopes&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(scopes))}addDeniedScopes(scopes){if(scopes){let deniedScopes=this.getDeniedScopes()||[];deniedScopes=deniedScopes.concat(scopes);let index=deniedScopes.indexOf("openid");-1!==index&&deniedScopes.splice(index,1),index=deniedScopes.indexOf("profile"),-1!==index&&deniedScopes.splice(index,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(deniedScopes))}}getDeniedScopes(){const scopesStr=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return scopesStr?JSON.parse(scopesStr):null}areScopesDenied(scopes){if(scopes){const deniedScopes=this.getDeniedScopes();if(deniedScopes&&deniedScopes.filter((s=>-1!==scopes.indexOf(s))).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){const account=this.getStoredAccount();return account||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return Msal2Provider_awaiter(this,void 0,void 0,(function*(){const logOutRequest={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType===LoginType.Redirect?(this.setState(ProviderState.SignedOut),yield this._publicClientApplication.logoutRedirect(logOutRequest)):(yield this._publicClientApplication.logoutPopup(Object.assign({},logOutRequest)),1!==this._publicClientApplication.getAllAccounts.length&&this.isMultipleAccountEnabled?yield this.trySilentSignIn():this.setState(ProviderState.SignedOut))}))}getAccessToken(options){return Msal2Provider_awaiter(this,void 0,void 0,(function*(){const scopes=options&&options.scopes||this.scopes,accessTokenRequest={scopes,account:this.getAccount()};try{const silentRequest=accessTokenRequest;return(yield this._publicClientApplication.acquireTokenSilent(silentRequest)).accessToken}catch(e){if(e instanceof InteractionRequiredAuthError.Yo){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===LoginType.Redirect){if(this.areScopesDenied(scopes))throw e;this.setRequestedScopes(scopes),yield this._publicClientApplication.acquireTokenRedirect(accessTokenRequest)}else try{return(yield this._publicClientApplication.acquireTokenPopup(accessTokenRequest)).accessToken}catch(popUpErr){throw console.error("🦒: problem with pop-up sign in",popUpErr),popUpErr}}else this.setState(ProviderState.SignedOut)}throw null}))}}({clientId:function getClientId(){var customClientId=new window.URL(window.location.href).searchParams.get("clientId");return isLoginEnabled()&&customClientId?customClientId:"9aeac104-a6b6-45ca-bb7c-bf7c3083eeb2"}(),redirectUri:window.location.origin+"/blank.html",scopes:["user.read","user.read.all","mail.readBasic","people.read","people.read.all","sites.read.all","user.readbasic.all","contacts.read","presence.read","presence.read.all","tasks.readwrite","tasks.read","calendars.read","group.read.all","files.read","files.read.all","files.readwrite","files.readwrite.all"],loginType:LoginType.Popup});Providers.globalProvider=msal2Provider;var SignInPanel=function SignInPanel(){var _useState2=_slicedToArray((0,react.useState)(Providers.globalProvider.state),2),state=_useState2[0],setState=_useState2[1],loginEnabled=_slicedToArray((0,react.useState)(isLoginEnabled()),1)[0],emit=(0,api_dist_esm.EM)({STORY_RENDERED:function STORY_RENDERED(id){console.log("storyRendered",id)}}),emitProvider=function emitProvider(loginState){Providers.globalProvider.state===ProviderState.SignedOut&&Providers.globalProvider!==mockProvider?emit("mgt/setProvider",{state:loginState,provider:mockProvider,name:"MgtMockProvider"}):emit("mgt/setProvider",{state:loginState,provider:msal2Provider,name:"MgtMsal2Provider"})};Providers.onProviderUpdated((function(){setState(Providers.globalProvider.state),emitProvider(Providers.globalProvider.state)}));return emitProvider(state),react.createElement(react.Fragment,null,loginEnabled&&react.createElement(react.Fragment,null,Providers.globalProvider.state!==ProviderState.SignedIn?react.createElement("mgt-login",{"login-view":"compact",style:{marginTop:"3px"}}):react.createElement(react.Fragment,null,react.createElement("mgt-person",{"person-query":"me",style:{marginTop:"8px"}}),react.createElement("fluent-button",{appearance:"lightweight",style:{marginTop:"3px"},onClick:function onSignOut(){Providers.globalProvider.logout()}},"Sign Out"))))};esm.KP.setConfig({enableShortcuts:!1,theme}),esm.KP.register("microsoft/graph-toolkit",(function(storybookAPI){esm.KP.add("mgt/sign-in",{type:types.V.TOOLEXTRA,title:"Sign In",match:function match(_ref2){_ref2.viewMode;return!0},render:function render(_ref){_ref.active;return react.createElement(SignInPanel,null)}})}))},24654:()=>{}},__webpack_require__=>{var __webpack_exec__=moduleId=>__webpack_require__(__webpack_require__.s=moduleId);__webpack_require__.O(0,[520],(()=>(__webpack_exec__(37707),__webpack_exec__(2647),__webpack_exec__(7967),__webpack_exec__(27118),__webpack_exec__(15887))));__webpack_require__.O()}]);