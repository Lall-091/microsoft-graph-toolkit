try{
var QR=Object.defineProperty;var nm=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var y=(r,e)=>()=>(r&&(e=r(r=0)),e);var YR=(r,e)=>{for(var t in e)QR(r,t,{get:e[t],enumerable:!0})};var a=y(()=>{});var l=y(()=>{});var c=y(()=>{});var di,ac=y(()=>{a();l();c();di=class{constructor(){this.eventHandlers=[]}fire(e){for(let t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}});var lc,w1,cc=y(()=>{a();l();c();lc="https://graph.microsoft.com",w1=new Set([lc,"https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn","https://canary.graph.microsoft.com"])});var mu,gu=y(()=>{a();l();c();cc();mu=r=>{try{let t=new URL(r).origin;if(w1.has(t))return t}catch{return}}});var Hs,ln,Me,Bn=y(()=>{a();l();c();gu();cc();ac();Hs=class{get isMultiAccountSupportedAndEnabled(){return!1}set baseURL(e){if(mu(e)){this._baseURL=e;return}else throw new Error(`${e} is not a valid Graph URL endpoint.`)}get baseURL(){return this._baseURL}set customHosts(e){this._customHosts=e}get customHosts(){return this._customHosts}get isMultiAccountSupported(){return this.isMultipleAccountSupported}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(e){this._isIncrementalConsentDisabled=e}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new di,this._activeAccountChangedDispatcher=new di,this._baseURL=lc,this._customHosts=void 0,this._isIncrementalConsentDisabled=!1,this.isMultipleAccountSupported=!1,this._state=Me.Loading}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}setActiveAccount(e){this.fireActiveAccountChanged()}onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}removeActiveAccountChangedHandler(e){this._activeAccountChangedDispatcher.remove(e)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...e){return this.getAccessToken({scopes:e})}};(function(r){r[r.Popup=0]="Popup",r[r.Redirect=1]="Redirect"})(ln||(ln={}));(function(r){r[r.Loading=0]="Loading",r[r.SignedOut=1]="SignedOut",r[r.SignedIn=2]="SignedIn"})(Me||(Me={}))});var vu,he,yu,Us=y(()=>{a();l();c();ac();Bn();vu=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},he=class r{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.isMultiAccountSupportedAndEnabled&&this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.isMultiAccountSupportedAndEnabled&&e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(yu.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}static removeActiveAccountChangedListener(e){this._activeAccountChangedDispatcher.remove(e)}static me(){return this.client?(this._mePromise||(this._mePromise=this.getMe()),this._mePromise):(this._mePromise=null,null)}static getMe(){return vu(this,void 0,void 0,function*(){try{let e=yield this.client.api("me").get();if(e?.id)return e}catch{}return null})}static getCacheId(){var e;return vu(this,void 0,void 0,function*(){if(this._cacheId)return this._cacheId;if(((e=r.globalProvider)===null||e===void 0?void 0:e.state)===Me.SignedIn&&!this._cacheId&&this.client)try{this._cacheId=yield this.createCacheId()}catch{}return this._cacheId})}static unsetCacheId(){this._cacheId=null,this._mePromise=null}static createCacheId(){return vu(this,void 0,void 0,function*(){if(r.globalProvider.isMultiAccountSupportedAndEnabled){let e=this.createCacheIdWithAccountDetails();if(e)return e}return yield this.createCacheIdWithUserDetails()})}static createCacheIdWithUserDetails(){return vu(this,void 0,void 0,function*(){let e=yield this.me();return e?.id?e.id+"-"+e.userPrincipalName:null})}static createCacheIdWithAccountDetails(){let e=r.globalProvider.getActiveAccount();return e.tenantId&&e.id?e.tenantId+e.id:null}static get client(){return r.globalProvider&&r.globalProvider.state===Me.SignedIn?r.globalProvider.graph.client:null}};he._eventDispatcher=new di;he._activeAccountChangedDispatcher=new di;he.handleProviderStateChanged=()=>{(!he.globalProvider||he.globalProvider.state!==Me.SignedIn)&&(he._mePromise=null),he._eventDispatcher.fire(yu.ProviderStateChanged)};he.handleActiveAccountChanged=()=>{he.unsetCacheId(),he._activeAccountChangedDispatcher.fire(null)};(function(r){r[r.ProviderChanged=0]="ProviderChanged",r[r.ProviderStateChanged=1]="ProviderStateChanged"})(yu||(yu={}))});var bu,gm=y(()=>{a();l();c();bu=class{}});function ve(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})}var br=y(()=>{a();l();c()});var or,dc=y(()=>{a();l();c();(function(r){r.GET="GET",r.PATCH="PATCH",r.POST="POST",r.PUT="PUT",r.DELETE="DELETE"})(or||(or={}))});var Qa,x1=y(()=>{a();l();c();br();dc();Qa=class r{constructor(e){if(this.requests=new Map,typeof e<"u"){let t=r.requestLimit;if(e.length>t){let o=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw o.name="Limit Exceeded Error",o}for(let o of e)this.addRequest(o)}}static validateDependencies(e){let t=n=>{let s=n.entries(),d=s.next();for(;!d.done;){let u=d.value[1];if(u.dependsOn!==void 0&&u.dependsOn.length>0)return!1;d=s.next()}return!0},o=n=>{let s=n.entries(),d=s.next(),u=d.value[1];if(u.dependsOn!==void 0&&u.dependsOn.length>0)return!1;let h=d;for(d=s.next();!d.done;){let p=d.value[1];if(p.dependsOn===void 0||p.dependsOn.length!==1||p.dependsOn[0]!==h.value[1].id)return!1;h=d,d=s.next()}return!0},i=n=>{let s=n.entries(),d=s.next(),u=d.value[1],h;if(u.dependsOn===void 0||u.dependsOn.length===0)h=u.id;else if(u.dependsOn.length===1){let p=u.dependsOn[0];if(p!==u.id&&n.has(p))h=p;else return!1}else return!1;for(d=s.next();!d.done;){let p=d.value[1];if((p.dependsOn===void 0||p.dependsOn.length===0)&&h!==p.id||p.dependsOn!==void 0&&p.dependsOn.length!==0&&(p.dependsOn.length===1&&(p.id===h||p.dependsOn[0]!==h)||p.dependsOn.length>1))return!1;d=s.next()}return!0};if(e.size===0){let n=new Error("Empty requests map, Please provide at least one request.");throw n.name="Empty Requests Error",n}return t(e)||o(e)||i(e)}static getRequestData(e){return ve(this,void 0,void 0,function*(){let t={url:""},o=new RegExp("^https?://");t.url=o.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;let i={};return e.headers.forEach((n,s)=>{i[s]=n}),Object.keys(i).length&&(t.headers=i),(e.method===or.PATCH||e.method===or.POST||e.method===or.PUT)&&(t.body=yield r.getRequestBody(e)),t})}static getRequestBody(e){return ve(this,void 0,void 0,function*(){let t=!1,o;try{o=yield e.clone().json(),t=!0}catch{}if(!t)try{if(typeof Blob<"u"){let i=yield e.blob(),n=new FileReader;o=yield new Promise(s=>{n.addEventListener("load",()=>{let d=n.result,h=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(d);s(h[4])},!1),n.readAsDataURL(i)})}else typeof Buffer<"u"&&(o=(yield e.buffer()).toString("base64"));t=!0}catch{}return o})}addRequest(e){let t=r.requestLimit;if(e.id===""){let o=new Error("Id for a request is empty, Please provide an unique id");throw o.name="Empty Id For Request",o}if(this.requests.size===t){let o=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw o.name="Limit Exceeded Error",o}if(this.requests.has(e.id)){let o=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw o.name="Duplicate RequestId Error",o}return this.requests.set(e.id,e),e.id}removeRequest(e){let t=this.requests.delete(e),o=this.requests.entries(),i=o.next();for(;!i.done;){let n=i.value[1].dependsOn;if(typeof n<"u"){let s=n.indexOf(e);s!==-1&&n.splice(s,1),n.length===0&&delete i.value[1].dependsOn}i=o.next()}return t}getContent(){return ve(this,void 0,void 0,function*(){let e=[],t={requests:e},o=this.requests.entries(),i=o.next();if(i.done){let n=new Error("No requests added yet, Please add at least one request.");throw n.name="Empty Payload",n}if(!r.validateDependencies(this.requests)){let n=new Error(`Invalid dependency found, Dependency should be:
1. Parallel - no individual request states a dependency in the dependsOn property.
2. Serial - all individual requests depend on the previous individual request.
3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);throw n.name="Invalid Dependency",n}for(;!i.done;){let n=i.value[1],s=yield r.getRequestData(n.request);if(s.body!==void 0&&(s.headers===void 0||s.headers["content-type"]===void 0)){let d=new Error(`Content-type header is not mentioned for request #${n.id}, For request having body, Content-type header should be mentioned`);throw d.name="Invalid Content-type header",d}s.id=n.id,n.dependsOn!==void 0&&n.dependsOn.length>0&&(s.dependsOn=n.dependsOn),e.push(s),i=o.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){let o=new Error(`Dependent ${e} does not exists, Please check the id`);throw o.name="Invalid Dependent",o}if(typeof t<"u"&&!this.requests.has(t)){let o=new Error(`Dependency ${t} does not exists, Please check the id`);throw o.name="Invalid Dependency",o}if(typeof t<"u"){let o=this.requests.get(e);if(o.dependsOn===void 0&&(o.dependsOn=[]),o.dependsOn.indexOf(t)!==-1){let i=new Error(`Dependency ${t} is already added for the request ${e}`);throw i.name="Duplicate Dependency",i}o.dependsOn.push(t)}else{let o=this.requests.entries(),i,n=o.next();for(;!n.done&&n.value[1].id!==e;)i=n,n=o.next();if(typeof i<"u"){let s=i.value[0];if(n.value[1].dependsOn===void 0&&(n.value[1].dependsOn=[]),n.value[1].dependsOn.indexOf(s)!==-1){let d=new Error(`Dependency ${s} is already added for the request ${e}`);throw d.name="Duplicate Dependency",d}n.value[1].dependsOn.push(s)}else{let s=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw s.name="Invalid Dependency Addition",s}}}removeDependency(e,t){let o=this.requests.get(e);if(typeof o>"u"||o.dependsOn===void 0||o.dependsOn.length===0)return!1;if(typeof t<"u"){let i=o.dependsOn.indexOf(t);return i===-1?!1:(o.dependsOn.splice(i,1),!0)}else return delete o.dependsOn,!0}};Qa.requestLimit=20});var S1=y(()=>{a();l();c()});var _1,E1,T1,vm=y(()=>{a();l();c();_1="v1.0",E1="https://graph.microsoft.com/",T1=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"])});var ir,cn=y(()=>{a();l();c();ir=class r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,r.prototype)}static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new r,t.customError=e),t}}});var k1,I1,Cu,wu,xu,A1,N4,Su=y(()=>{a();l();c();vm();cn();k1=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],I1=r=>{let e=n=>n.replace(/\/+$/,""),t=n=>n.replace(/^\/+/,""),o=(n,s)=>[e(n),t(s)].join("/");return Array.prototype.slice.call(r).reduce(o)},Cu=r=>{let e=r&&r.constructor&&r.constructor.name;if(e==="Buffer"||e==="Blob"||e==="File"||e==="FormData"||typeof r=="string")return r;if(e==="ArrayBuffer")r=Buffer.from(r);else if(e==="Int8Array"||e==="Int16Array"||e==="Int32Array"||e==="Uint8Array"||e==="Uint16Array"||e==="Uint32Array"||e==="Uint8ClampedArray"||e==="Float32Array"||e==="Float64Array"||e==="DataView")r=Buffer.from(r.buffer);else try{r=JSON.stringify(r)}catch{throw new Error("Unable to stringify the content")}return r},wu=r=>A1(r),xu=(r,e)=>(e.forEach(t=>N4(t)),A1(r,e)),A1=(r,e=T1)=>{if(r=r.toLowerCase(),r.indexOf("https://")!==-1){r=r.replace("https://","");let t=r.indexOf(":"),o=r.indexOf("/"),i="";if(o!==-1)return t!==-1&&t<o?(i=r.substring(0,t),e.has(i)):(i=r.substring(0,o),e.has(i))}return!1},N4=r=>{if(r.indexOf("/")!==-1)throw new ir("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")}});var zr,Vn=y(()=>{a();l();c();zr=class{constructor(e=[]){this.middlewareOptions=new Map;for(let t of e){let o=t.constructor;this.middlewareOptions.set(o,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}});var ym,Ya,Za,_u,R1,Bs=y(()=>{a();l();c();br();ym=()=>{let r="";for(let e=0;e<32;e++)(e===8||e===12||e===16||e===20)&&(r+="-"),r+=Math.floor(Math.random()*16).toString(16);return r},Ya=(r,e,t)=>{let o=null;if(typeof Request<"u"&&r instanceof Request)o=r.headers.get(t);else if(typeof e<"u"&&e.headers!==void 0)if(typeof Headers<"u"&&e.headers instanceof Headers)o=e.headers.get(t);else if(e.headers instanceof Array){let i=e.headers;for(let n=0,s=i.length;n<s;n++)if(i[n][0]===t){o=i[n][1];break}}else e.headers[t]!==void 0&&(o=e.headers[t]);return o},Za=(r,e,t,o)=>{if(typeof Request<"u"&&r instanceof Request)r.headers.set(t,o);else if(typeof e<"u")if(e.headers===void 0)e.headers=new Headers({[t]:o});else if(typeof Headers<"u"&&e.headers instanceof Headers)e.headers.set(t,o);else if(e.headers instanceof Array){let i=0,n=e.headers.length;for(;i<n;i++){let s=e.headers[i];if(s[0]===t){s[1]=o;break}}i===n&&e.headers.push([t,o])}else Object.assign(e.headers,{[t]:o})},_u=(r,e,t,o)=>{typeof Request<"u"&&r instanceof Request?r.headers.append(t,o):typeof e<"u"&&(e.headers===void 0?e.headers=new Headers({[t]:o}):typeof Headers<"u"&&e.headers instanceof Headers?e.headers.append(t,o):e.headers instanceof Array?e.headers.push([t,o]):e.headers===void 0?e.headers={[t]:o}:e.headers[t]===void 0?e.headers[t]=o:e.headers[t]+=`, ${o}`)},R1=(r,e)=>ve(void 0,void 0,void 0,function*(){let t=e.headers.get("Content-Type")?yield e.blob():yield Promise.resolve(void 0),{method:o,headers:i,referrer:n,referrerPolicy:s,mode:d,credentials:u,cache:h,redirect:p,integrity:v,keepalive:C,signal:x}=e;return new Request(r,{method:o,headers:i,body:t,referrer:n,referrerPolicy:s,mode:d,credentials:u,cache:h,redirect:p,integrity:v,keepalive:C,signal:x})})});var Vs,bm=y(()=>{a();l();c();Vs=class{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}});var Ai,ui,Ja=y(()=>{a();l();c();Vn();(function(r){r[r.NONE=0]="NONE",r[r.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",r[r.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",r[r.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(Ai||(Ai={}));ui=class r{constructor(){this.featureUsage=Ai.NONE}static updateFeatureUsageFlag(e,t){let o;e.middlewareControl instanceof zr?o=e.middlewareControl.getMiddlewareOptions(r):e.middlewareControl=new zr,typeof o>"u"&&(o=new r,e.middlewareControl.setMiddlewareOptions(r,o)),o.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}});var hi,Eu=y(()=>{a();l();c();br();Su();Vn();Bs();bm();Ja();hi=class r{constructor(e){this.authenticationProvider=e}execute(e){return ve(this,void 0,void 0,function*(){let t=typeof e.request=="string"?e.request:e.request.url;if(wu(t)||e.customHosts&&xu(t,e.customHosts)){let o;e.middlewareControl instanceof zr&&(o=e.middlewareControl.getMiddlewareOptions(Vs));let i,n;o&&(i=o.authenticationProvider,n=o.authenticationProviderOptions),i||(i=this.authenticationProvider);let d=`Bearer ${yield i.getAccessToken(n)}`;_u(e.request,e.options,r.AUTHORIZATION_HEADER,d),ui.updateFeatureUsageFlag(e,Ai.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[r.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}};hi.AUTHORIZATION_HEADER="Authorization"});var Ri,Tu=y(()=>{a();l();c();br();Ri=class{execute(e){return ve(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}});var Cr,uc=y(()=>{a();l();c();Cr=class r{constructor(e=r.DEFAULT_DELAY,t=r.DEFAULT_MAX_RETRIES,o=r.defaultShouldRetry){if(e>r.MAX_DELAY&&t>r.MAX_MAX_RETRIES){let i=new Error(`Delay and MaxRetries should not be more than ${r.MAX_DELAY} and ${r.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e>r.MAX_DELAY){let i=new Error(`Delay should not be more than ${r.MAX_DELAY}`);throw i.name="MaxLimitExceeded",i}else if(t>r.MAX_MAX_RETRIES){let i=new Error(`MaxRetries should not be more than ${r.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e<0&&t<0){let i=new Error("Delay and MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}else if(e<0){let i=new Error("Delay should not be negative");throw i.name="MinExpectationNotMet",i}else if(t<0){let i=new Error("MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}this.delay=Math.min(e,r.MAX_DELAY),this.maxRetries=Math.min(t,r.MAX_MAX_RETRIES),this.shouldRetry=o}getMaxDelay(){return r.MAX_DELAY}};Cr.DEFAULT_DELAY=3;Cr.DEFAULT_MAX_RETRIES=3;Cr.MAX_DELAY=180;Cr.MAX_MAX_RETRIES=10;Cr.defaultShouldRetry=()=>!0});var ko,ku=y(()=>{a();l();c();br();dc();Vn();Bs();uc();Ja();ko=class r{constructor(e=new Cr){this.options=e}isRetry(e){return r.RETRY_STATUS_CODES.indexOf(e.status)!==-1}isBuffered(e,t){let o=typeof e=="string"?t.method:e.method;return!((o===or.PUT||o===or.PATCH||o===or.POST)&&Ya(e,t,"Content-Type")==="application/octet-stream")}getDelay(e,t,o){let i=()=>Number(Math.random().toFixed(3)),n=e.headers!==void 0?e.headers.get(r.RETRY_AFTER_HEADER):null,s;return n!==null?Number.isNaN(Number(n))?s=Math.round((new Date(n).getTime()-Date.now())/1e3):s=Number(n):s=t>=2?this.getExponentialBackOffTime(t)+o+i():o+i(),Math.min(s,this.options.getMaxDelay()+i())}getExponentialBackOffTime(e){return Math.round(1/2*(Math.pow(2,e)-1))}sleep(e){return ve(this,void 0,void 0,function*(){let t=e*1e3;return new Promise(o=>setTimeout(o,t))})}getOptions(e){let t;return e.middlewareControl instanceof zr&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),typeof t>"u"&&(t=Object.assign(new Cr,this.options)),t}executeWithRetry(e,t,o){return ve(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),t<o.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&o.shouldRetry(o.delay,t,e.request,e.options,e.response)){++t,Za(e.request,e.options,r.RETRY_ATTEMPT_HEADER,t.toString());let i=this.getDelay(e.response,t,o.delay);return yield this.sleep(i),yield this.executeWithRetry(e,t,o)}else return})}execute(e){return ve(this,void 0,void 0,function*(){let o=this.getOptions(e);return ui.updateFeatureUsageFlag(e,Ai.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,o)})}setNext(e){this.nextMiddleware=e}};ko.RETRY_STATUS_CODES=[429,503,504];ko.RETRY_ATTEMPT_HEADER="Retry-Attempt";ko.RETRY_AFTER_HEADER="Retry-After"});var Io,hc=y(()=>{a();l();c();Io=class r{constructor(e=r.DEFAULT_MAX_REDIRECTS,t=r.defaultShouldRedirect){if(e>r.MAX_MAX_REDIRECTS){let o=new Error(`MaxRedirects should not be more than ${r.MAX_MAX_REDIRECTS}`);throw o.name="MaxLimitExceeded",o}if(e<0){let o=new Error("MaxRedirects should not be negative");throw o.name="MinExpectationNotMet",o}this.maxRedirects=e,this.shouldRedirect=t}};Io.DEFAULT_MAX_REDIRECTS=5;Io.MAX_MAX_REDIRECTS=20;Io.defaultShouldRedirect=()=>!0});var pi,Iu=y(()=>{a();l();c();br();dc();Vn();Bs();hc();Ja();pi=class r{constructor(e=new Io){this.options=e}isRedirect(e){return r.REDIRECT_STATUS_CODES.indexOf(e.status)!==-1}hasLocationHeader(e){return e.headers.has(r.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(r.LOCATION_HEADER)}isRelativeURL(e){return e.indexOf("://")===-1}shouldDropAuthorizationHeader(e,t){let o=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=o.exec(e),n,s;i!==null&&(n=i[0]);let d=o.exec(t);return d!==null&&(s=d[0]),typeof n<"u"&&typeof s<"u"&&n!==s}updateRequestUrl(e,t){return ve(this,void 0,void 0,function*(){t.request=typeof t.request=="string"?e:yield R1(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof zr&&(t=e.middlewareControl.getMiddlewareOptions(Io)),typeof t>"u"&&(t=Object.assign(new Io,this.options)),t}executeWithRedirect(e,t,o){return ve(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);let i=e.response;if(t<o.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&o.shouldRedirect(i)){if(++t,i.status===r.STATUS_CODE_SEE_OTHER)e.options.method=or.GET,delete e.options.body;else{let n=this.getLocationHeader(i);!this.isRelativeURL(n)&&this.shouldDropAuthorizationHeader(i.url,n)&&delete e.options.headers[r.AUTHORIZATION_HEADER],yield this.updateRequestUrl(n,e)}yield this.executeWithRedirect(e,t,o)}else return})}execute(e){return ve(this,void 0,void 0,function*(){let o=this.getOptions(e);return e.options.redirect=r.MANUAL_REDIRECT,ui.updateFeatureUsageFlag(e,Ai.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,o)})}setNext(e){this.nextMiddleware=e}};pi.REDIRECT_STATUS_CODES=[301,302,303,307,308];pi.STATUS_CODE_SEE_OTHER=303;pi.LOCATION_HEADER="Location";pi.AUTHORIZATION_HEADER="Authorization";pi.MANUAL_REDIRECT="manual"});var P1,O1=y(()=>{a();l();c();P1="3.0.2"});var mo,Au=y(()=>{a();l();c();br();Su();O1();Vn();Bs();Ja();mo=class r{execute(e){return ve(this,void 0,void 0,function*(){let t=typeof e.request=="string"?e.request:e.request.url;if(wu(t)||e.customHosts&&xu(t,e.customHosts)){let o=Ya(e.request,e.options,r.CLIENT_REQUEST_ID_HEADER);o||(o=ym(),Za(e.request,e.options,r.CLIENT_REQUEST_ID_HEADER,o));let i=`${r.PRODUCT_NAME}/${P1}`,n;if(e.middlewareControl instanceof zr&&(n=e.middlewareControl.getMiddlewareOptions(ui)),n){let s=n.getFeatureUsage();i+=` (${r.FEATURE_USAGE_STRING}=${s})`}_u(e.request,e.options,r.SDK_VERSION_HEADER,i)}else delete e.options.headers[r.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[r.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}};mo.CLIENT_REQUEST_ID_HEADER="client-request-id";mo.SDK_VERSION_HEADER="SdkVersion";mo.PRODUCT_NAME="graph-js";mo.FEATURE_USAGE_STRING="featureUsage"});var $1=y(()=>{a();l();c();Eu();Tu();hc();uc();Iu();ku();Au()});var pc,Ru=y(()=>{a();l();c();(function(r){r[r.MANUAL=0]="MANUAL",r[r.RANDOM=1]="RANDOM"})(pc||(pc={}))});var Cm=y(()=>{a();l();c();Ru()});var M1=y(()=>{a();l();c()});var F1=y(()=>{a();l();c();br();Vn();Bs();M1();Cm();Ru()});var hr,fc=y(()=>{a();l();c();(function(r){r.ARRAYBUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.RAW="raw",r.STREAM="stream",r.TEXT="text"})(hr||(hr={}))});var wm,Pu,Ou,Xa,xm=y(()=>{a();l();c();br();fc();(function(r){r.TEXT_HTML="text/html",r.TEXT_XML="text/xml",r.APPLICATION_XML="application/xml",r.APPLICATION_XHTML="application/xhtml+xml"})(wm||(wm={}));(function(r){r.TEXT_PLAIN="text/plain",r.APPLICATION_JSON="application/json"})(Pu||(Pu={}));(function(r){r.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",r.IMAGE="^image\\/.+"})(Ou||(Ou={}));Xa=class r{static parseDocumentResponse(e,t){return typeof DOMParser<"u"?new Promise((o,i)=>{e.text().then(n=>{try{let d=new DOMParser().parseFromString(n,t);o(d)}catch(s){i(s)}})}):Promise.resolve(e.body)}static convertResponse(e,t){return ve(this,void 0,void 0,function*(){if(e.status===204)return Promise.resolve();let o,i=e.headers.get("Content-type");switch(t){case hr.ARRAYBUFFER:o=yield e.arrayBuffer();break;case hr.BLOB:o=yield e.blob();break;case hr.DOCUMENT:o=yield r.parseDocumentResponse(e,wm.TEXT_XML);break;case hr.JSON:o=yield e.json();break;case hr.STREAM:o=yield Promise.resolve(e.body);break;case hr.TEXT:o=yield e.text();break;default:if(i!==null){let n=i.split(";")[0];new RegExp(Ou.DOCUMENT).test(n)?o=yield r.parseDocumentResponse(e,n):new RegExp(Ou.IMAGE).test(n)?o=e.blob():n===Pu.TEXT_PLAIN?o=yield e.text():n===Pu.APPLICATION_JSON?o=yield e.json():o=Promise.resolve(e.body)}else o=Promise.resolve(e.body);break}return o})}static getResponse(e,t,o){return ve(this,void 0,void 0,function*(){if(t===hr.RAW)return Promise.resolve(e);{let i=yield r.convertResponse(e,t);if(e.ok)if(typeof o=="function")o(null,i);else return i;else throw i}})}}});var zn,Sm=y(()=>{a();l();c();zn=class{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}});var mc,_m=y(()=>{a();l();c();mc=class r{constructor(e,t){this._location=t,this._responseBody=e}get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}static CreateUploadResult(e,t){return new r(e,t.get("location"))}}});var gc,Em=y(()=>{a();l();c();br();cn();xm();fc();Sm();_m();gc=class{constructor(e,t,o,i={}){if(this.DEFAULT_FILE_SIZE=5*1024*1024,this.client=e,t.sliceFile)this.file=t;else throw new ir("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,i.rangeSize||(i.rangeSize=this.DEFAULT_FILE_SIZE),this.options=i,this.uploadSession=o,this.nextRange=new zn(0,this.options.rangeSize-1)}static createUploadSession(e,t,o,i={}){return ve(this,void 0,void 0,function*(){let n=yield e.api(t).headers(i).post(o);return{url:n.uploadUrl,expiry:new Date(n.expirationDateTime),isCancelled:!1}})}parseRange(e){let t=e[0];if(typeof t>"u"||t==="")return new zn;let o=t.split("-"),i=parseInt(o[0],10),n=parseInt(o[1],10);return Number.isNaN(n)&&(n=this.file.size-1),new zn(i,n)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(this.nextRange.minValue===-1)return this.nextRange;let e=this.nextRange.minValue,t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new zn(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new ir("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return ve(this,void 0,void 0,function*(){let e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){let t=this.getNextRange();if(t.maxValue===-1){let d=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw d.name="Invalid Session",d}let o=yield this.file.sliceFile(t),i=yield this.uploadSliceGetRawResponse(o,t,this.file.size);if(!i)throw new ir("Something went wrong! Large file upload slice response is null.");let n=yield Xa.getResponse(i);if(i.status===201||i.status===200&&n.id)return mc.CreateUploadResult(n,i.headers);let s={expirationDateTime:n.expirationDateTime||n.ExpirationDateTime,nextExpectedRanges:n.NextExpectedRanges||n.nextExpectedRanges};this.updateTaskStatus(s),e&&e.progress&&e.progress(t,e.extraCallbackParam)}})}uploadSlice(e,t,o){return ve(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${o}`,"Content-Type":"application/octet-stream"}).put(e)})}uploadSliceGetRawResponse(e,t,o){return ve(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${o}`,"Content-Type":"application/octet-stream"}).responseType(hr.RAW).put(e)})}cancel(){return ve(this,void 0,void 0,function*(){let e=yield this.client.api(this.uploadSession.url).responseType(hr.RAW).delete();return e.status===204&&(this.uploadSession.isCancelled=!0),e})}getStatus(){return ve(this,void 0,void 0,function*(){let e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e})}resume(){return ve(this,void 0,void 0,function*(){return yield this.getStatus(),yield this.upload()})}getUploadSession(){return this.uploadSession}}});var vc,Tm=y(()=>{a();l();c();cn();vc=class{constructor(e,t,o){if(this.content=e,this.name=t,this.size=o,!e||!t||!o)throw new ir("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}});var U4,km,Im=y(()=>{a();l();c();U4=r=>(r>327680&&(r=Math.floor(r/327680)*320*1024),r),km=(r=5242880)=>(r>62914560&&(r=62914560),U4(r))});var $u,D1=y(()=>{a();l();c();br();cn();Tm();Em();Im();$u=class r extends gc{constructor(e,t,o,i){super(e,t,o,i)}static constructCreateSessionUrl(e,t=r.DEFAULT_UPLOAD_PATH){return e=e.trim(),t=t.trim(),t===""&&(t="/"),t[0]!=="/"&&(t=`/${t}`),t[t.length-1]!=="/"&&(t=`${t}/`),`/me/drive/root:${t.split("/").map(o=>encodeURIComponent(o)).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let o,i;if(typeof Blob<"u"&&e instanceof Blob)o=new File([e],t),i=o.size;else if(typeof File<"u"&&e instanceof File)o=e,i=o.size;else if(typeof Uint8Array<"u"&&e instanceof Uint8Array){let n=e;i=n.byteLength,o=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}return{content:o,size:i}}static create(e,t,o){return ve(this,void 0,void 0,function*(){if(!e||!t||!o)throw new ir("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");let i=o.fileName,n=r.getFileInfo(t,i),s=new vc(n.content,i,n.size);return this.createTaskWithFileObject(e,s,o)})}static createTaskWithFileObject(e,t,o){return ve(this,void 0,void 0,function*(){if(!e||!t||!o)throw new ir("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");let i=r.constructCreateSessionUrl(o.fileName,o.path),n={fileName:o.fileName,fileDescription:o.fileDescription,conflictBehavior:o.conflictBehavior},s=yield r.createUploadSession(e,i,n),d=km(o.rangeSize);return new r(e,t,s,{rangeSize:d,uploadEventHandlers:o.uploadEventHandlers})})}static createUploadSession(e,t,o){let i=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return ve(this,void 0,void 0,function*(){let n={item:{"@microsoft.graph.conflictBehavior":o?.conflictBehavior||"rename",name:o?.fileName,description:o?.fileDescription}};return i.createUploadSession.call(this,e,t,n)})}commit(e,t="rename"){return ve(this,void 0,void 0,function*(){let o={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(o)})}};$u.DEFAULT_UPLOAD_PATH="/"});var L1=y(()=>{a();l();c();br();cn()});var N1=y(()=>{a();l();c();br()});var yc,Am=y(()=>{a();l();c();br();cn();yc=class{constructor(e){this.provider=e}getAccessToken(){return ve(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((o,i)=>ve(this,void 0,void 0,function*(){if(i)e(i);else{if(!o){let s="Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md";o=new ir(s)}let n=yield ir.setGraphClientError(o);t(n)}}))})})}}});var zs,Rm=y(()=>{a();l();c();zs=class r extends Error{constructor(e=-1,t,o){super(t||o&&o.message),Object.setPrototypeOf(this,r.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=o?o.stack:this.stack}}});var Mu,H1=y(()=>{a();l();c();br();Rm();Mu=class r{static constructError(e,t){let o=new zs(t,"",e);return e.name!==void 0&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o}static constructErrorFromResponse(e,t){let o=e.error,i=new zs(t,o.message);return i.code=o.code,o.innerError!==void 0&&(i.requestId=o.innerError["request-id"],i.date=new Date(o.innerError.date)),i.body=JSON.stringify(o),i}static getError(e=null,t=-1,o){return ve(this,void 0,void 0,function*(){let i;if(e&&e.error?i=r.constructErrorFromResponse(e,t):e instanceof Error?i=r.constructError(e,t):(i=new zs(t),i.body=e),typeof o=="function")o(i,null);else return i})}}});var bc,Pm=y(()=>{a();l();c();br();cn();H1();Su();xm();Vn();dc();fc();bc=class{constructor(e,t,o){this.parsePath=i=>{if(i.indexOf("https://")!==-1){i=i.replace("https://","");let s=i.indexOf("/");s!==-1&&(this.urlComponents.host="https://"+i.substring(0,s),i=i.substring(s+1,i.length));let d=i.indexOf("/");d!==-1&&(this.urlComponents.version=i.substring(0,d),i=i.substring(d+1,i.length))}i.charAt(0)==="/"&&(i=i.substr(1));let n=i.indexOf("?");if(n===-1)this.urlComponents.path=i;else{this.urlComponents.path=i.substr(0,n);let s=i.substring(n+1,i.length).split("&");for(let d of s)this.parseQueryParameter(d)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(o)}addCsvQueryParameter(e,t,o){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let i=[];o.length>1&&typeof t=="string"?i=Array.prototype.slice.call(o):typeof t=="string"?i.push(t):i=i.concat(t),this.urlComponents.oDataQueryParams[e]+=i.join(",")}buildFullUrl(){let e=I1([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){let e=this.urlComponents,t=[];if(Object.keys(e.oDataQueryParams).length!==0)for(let o in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,o)&&t.push(o+"="+e.oDataQueryParams[o]);if(Object.keys(e.otherURLQueryParams).length!==0)for(let o in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,o)&&t.push(o+"="+e.otherURLQueryParams[o]);if(e.otherURLQueryOptions.length!==0)for(let o of e.otherURLQueryOptions)t.push(o);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if(typeof e=="string")if(e.charAt(0)==="?"&&(e=e.substring(1)),e.indexOf("&")!==-1){let t=e.split("&");for(let o of t)this.parseQueryParamenterString(o)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){let t=e.indexOf("="),o=e.substring(0,t),i=e.substring(t+1);this.setURLComponentsQueryParamater(o,i)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(k1.indexOf(e)!==-1){let o=this.urlComponents.oDataQueryParams[e],i=o&&(e==="$expand"||e==="$select"||e==="$orderby");this.urlComponents.oDataQueryParams[e]=i?o+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){let t=e.indexOf("=");return!(t===-1||e.indexOf("(")!==-1&&e.indexOf("(")<t)}updateRequestOptions(e){let t=Object.assign({},e.headers);if(this.config.fetchOptions!==void 0){let o=Object.assign({},this.config.fetchOptions);Object.assign(e,o),typeof this.config.fetchOptions.headers!==void 0&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),e.headers!==void 0&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,o){var i;return ve(this,void 0,void 0,function*(){let n,s=new zr(this._middlewareOptions);this.updateRequestOptions(t);let d=(i=this.config)===null||i===void 0?void 0:i.customHosts;try{return n=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:s,customHosts:d})).response,yield Xa.getResponse(n,this._responseType,o)}catch(u){if(u instanceof ir)throw u;let h;throw n&&(h=n.status),yield Mu.getError(u,h,o)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}let e=Object.keys(this._headers);for(let t of e)if(t.toLowerCase()==="content-type")return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return ve(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:or.GET};return yield this.send(t,o,e)})}post(e,t){return ve(this,void 0,void 0,function*(){let o=this.buildFullUrl(),i={method:or.POST,body:Cu(e)};return(e&&e.constructor&&e.constructor.name)==="FormData"?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers),yield this.send(o,i,t)})}create(e,t){return ve(this,void 0,void 0,function*(){return yield this.post(e,t)})}put(e,t){return ve(this,void 0,void 0,function*(){let o=this.buildFullUrl();this.setHeaderContentType();let i={method:or.PUT,body:Cu(e)};return yield this.send(o,i,t)})}patch(e,t){return ve(this,void 0,void 0,function*(){let o=this.buildFullUrl();this.setHeaderContentType();let i={method:or.PATCH,body:Cu(e)};return yield this.send(o,i,t)})}update(e,t){return ve(this,void 0,void 0,function*(){return yield this.patch(e,t)})}delete(e){return ve(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:or.DELETE};return yield this.send(t,o,e)})}del(e){return ve(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return ve(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:or.GET};return this.responseType(hr.STREAM),yield this.send(t,o,e)})}putStream(e,t){return ve(this,void 0,void 0,function*(){let o=this.buildFullUrl(),i={method:or.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(o,i,t)})}}});var el,Om=y(()=>{a();l();c();br();el=class{constructor(...e){if(!e||!e.length){let t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,o)=>{o<e.length-1&&t.setNext(e[o+1])}),this.middleware=e[0]}sendRequest(e){return ve(this,void 0,void 0,function*(){if(typeof e.request=="string"&&e.options===void 0){let t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(e),e})}}});var B4,Fu,U1=y(()=>{a();l();c();Om();Eu();Tu();hc();uc();Iu();ku();Au();B4=()=>typeof process=="object"&&typeof nm=="function",Fu=class r{static createWithAuthenticationProvider(e){let t=new hi(e),o=new ko(new Cr),i=new mo,n=new Ri;if(t.setNext(o),B4()){let s=new pi(new Io);o.setNext(s),s.setNext(i)}else o.setNext(i);return i.setNext(n),r.createWithMiddleware(t)}static createWithMiddleware(...e){return new el(...e)}}});var B1,V1=y(()=>{a();l();c();B1=()=>{if(typeof Promise>"u"&&typeof fetch>"u"){let r=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw r.name="PolyFillNotAvailable",r}else if(typeof Promise>"u"){let r=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}else if(typeof fetch>"u"){let r=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}return!0}});var qs,z1=y(()=>{a();l();c();vm();Am();Pm();Om();U1();V1();qs=class r{constructor(e){this.config={baseUrl:E1,debugLogging:!1,defaultVersion:_1},B1();for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&(this.config[o]=e[o]);let t;if(e.authProvider!==void 0&&e.middleware!==void 0){let o=new Error;throw o.name="AmbiguityInInitialization",o.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",o}else if(e.authProvider!==void 0)t=Fu.createWithAuthenticationProvider(e.authProvider);else if(e.middleware!==void 0)t=new el(...[].concat(e.middleware));else{let o=new Error;throw o.name="InvalidMiddlewareChain",o.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",o}this.httpClient=t}static init(e){let t={};for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=o==="authProvider"?new yc(e[o]):e[o]);return r.initWithMiddleware(t)}static initWithMiddleware(e){return new r(e)}api(e){return new bc(this.httpClient,this.config,e)}}});var Gs=y(()=>{a();l();c();x1();S1();Eu();Tu();ku();Iu();Au();$1();bm();uc();hc();Ja();Cm();Ru();F1();Em();D1();Im();L1();Tm();_m();Sm();N1();z1();Am();Rm();cn();Pm();fc()});var V4,q1,G1=y(()=>{a();l();c();V4=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},q1=r=>V4(void 0,void 0,void 0,function*(){return new Promise(e=>{setTimeout(e,r)})})});var vt,$m=y(()=>{a();l();c();Gs();Us();vt=(...r)=>{let e={scopes:r};return he.globalProvider.isIncrementalConsentDisabled?[]:[new Vs(void 0,e)]}});var Du,j1=y(()=>{a();l();c();Du=class{constructor(e,t,o,i){this.resource=o.startsWith("/")?o:`/${o}`,this.method=i,this.index=e,this.id=t}}});var K1,Lu,W1=y(()=>{a();l();c();gm();Gs();G1();$m();j1();K1=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Lu=class r{static get baseUrl(){return"https://graph.microsoft.com"}constructor(e){this.graph=e,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(e,t,o,i){let n=this.nextIndex++,s=new Du(n,e,t,"GET");s.headers=i,this.allRequests.push(s),this.requestsQueue.push(n),o&&(this.scopes=this.scopes.concat(o))}executeNext(){return K1(this,void 0,void 0,function*(){let e=new Map;if(this.retryAfter&&(yield q1(this.retryAfter*1e3),this.retryAfter=0),!this.hasRequests)return e;let t=this.requestsQueue.splice(0,20),o=new Qa;for(let u of t.map(h=>this.allRequests[h]))o.addRequest({id:u.index.toString(),request:new Request(r.baseUrl+u.resource,{method:u.method,headers:u.headers})});let i=this.scopes.length?vt(...this.scopes):[],n=this.graph.api("$batch").middlewareOptions(i),s=yield o.getContent(),d=yield n.post(s);for(let u of d.responses){let h=new bu,p=parseInt(u.id,10),v=this.allRequests[p];if(h.id=v.id,h.index=v.index,h.headers=u.headers,u.status!==200){if(u.status===429){this.requestsQueue.unshift(p);let C=u.headers["Retry-After"];this.retryAfter=Math.max(this.retryAfter,parseInt(C,10)||1)}continue}else typeof u.body=="string"?u.headers["Content-Type"].includes("image/jpeg")?h.content="data:image/jpeg;base64,"+u.body:u.headers["Content-Type"].includes("image/pjpeg")?h.content="data:image/pjpeg;base64,"+u.body:u.headers["Content-Type"].includes("image/png")&&(h.content="data:image/png;base64,"+u.body):h.content=u.body;e.set(v.id,h)}return e})}executeAll(){return K1(this,void 0,void 0,function*(){let e=new Map;for(;this.hasRequests;){let t=yield this.executeNext();for(let[o,i]of t)e.set(o,i)}return e})}}});var tl,Mm=y(()=>{a();l();c();tl=class{constructor(e){typeof e=="string"?this.componentName=e:this.componentName=e.tagName.toLowerCase()}}});var Nu,Hu=y(()=>{a();l();c();Nu=(...r)=>{let e=r[0],t=e;for(let o=1;o<r.length;++o){let i=r[o];t.setNext&&t.setNext(i),t=i}return e}});var z4,Uu,Q1=y(()=>{a();l();c();Bs();Mm();gu();z4=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Uu=class{constructor(e,t){this._packageVersion=e,this._providerName=t}execute(e){var t;return z4(this,void 0,void 0,function*(){try{if(typeof e.request=="string")if(mu(e.request)){let o=[],i=e.middlewareControl.getMiddlewareOptions(tl);if(i){let d=`${i.componentName}/${this._packageVersion}`;o.push(d)}if(this._providerName){let d=`${this._providerName}/${this._packageVersion}`;o.push(d)}let n=`mgt/${this._packageVersion}`;o.push(n),o.push(Ya(e.request,e.options,"SdkVersion"));let s=o.join(", ");Za(e.request,e.options,"SdkVersion",s)}else(t=e?.options)===null||t===void 0||delete t.headers.SdkVersion}catch{}return yield this._nextMiddleware.execute(e)})}setNext(e){this._nextMiddleware=e}}});var js,Cc=y(()=>{a();l();c();js="3.1.3-pr.2861.a539190"});var Fm,oo,rl=y(()=>{a();l();c();Fm=class{constructor(){this._disambiguation=""}get defaultPrefix(){return"mgt"}withDisambiguation(e){return e&&!this._disambiguation&&(this._disambiguation=e),this}get prefix(){return this._disambiguation?`${this.defaultPrefix}-${this._disambiguation}`:this.defaultPrefix}get disambiguation(){return this._disambiguation}get isDisambiguated(){return!!this._disambiguation}normalize(e){return this.isDisambiguated?e.toUpperCase().replace(this.prefix.toUpperCase(),this.defaultPrefix.toUpperCase()):e}},oo=new Fm});var q4,ol,Dm,wc=y(()=>{a();l();c();Gs();cc();W1();Mm();Hu();Q1();Cc();rl();q4="v1.0",ol=class r{get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}constructor(e,t=q4){this._client=e,this._version=t}forComponent(e){let t=new r(this._client,this._version);return t.setComponent(e),t}api(e){let t=this._client.api(e).version(this._version);return this._componentName&&(t.middlewareOptions=o=>(t._middlewareOptions=t._middlewareOptions.concat(o),t),t=t.middlewareOptions([new tl(this._componentName)])),t}createBatch(){return new Lu(this)}setComponent(e){this._componentName=e instanceof Element?oo.normalize(e.tagName):e}},Dm=(r,e,t)=>{let o=[new hi(r),new ko(new Cr),new mo,new Uu(js,r.name),new Ri],i=r.baseURL?r.baseURL:lc,n=qs.initWithMiddleware({middleware:Nu(...o),customHosts:r.customHosts?new Set(r.customHosts):null,baseUrl:i}),s=new ol(n,e);return t?s.forComponent(t):s}});var Y1=y(()=>{a();l();c();wc()});var Bu,Vu,Lm,Z1,xc,J1,xt,Nm,zu,Hm=y(()=>{a();l();c();Bu=globalThis,Vu=Bu.ShadowRoot&&(Bu.ShadyCSS===void 0||Bu.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Lm=Symbol(),Z1=new WeakMap,xc=class{constructor(e,t,o){if(this._$cssResult$=!0,o!==Lm)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o,t=this.t;if(Vu&&e===void 0){let o=t!==void 0&&t.length===1;o&&(e=Z1.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&Z1.set(t,e))}return e}toString(){return this.cssText}},J1=r=>new xc(typeof r=="string"?r:r+"",void 0,Lm),xt=(r,...e)=>{let t=r.length===1?r[0]:e.reduce((o,i,n)=>o+(s=>{if(s._$cssResult$===!0)return s.cssText;if(typeof s=="number")return s;throw Error("Value passed to 'css' function must be a 'css' function result: "+s+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+r[n+1],r[0]);return new xc(t,r,Lm)},Nm=(r,e)=>{if(Vu)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(let t of e){let o=document.createElement("style"),i=Bu.litNonce;i!==void 0&&o.setAttribute("nonce",i),o.textContent=t.cssText,r.appendChild(o)}},zu=Vu?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(let o of e.cssRules)t+=o.cssText;return J1(t)})(r):r});var G4,j4,K4,W4,Q4,Y4,qu,X1,Z4,J4,Sc,_c,Gu,eC,dn,Ec=y(()=>{a();l();c();Hm();Hm();({is:G4,defineProperty:j4,getOwnPropertyDescriptor:K4,getOwnPropertyNames:W4,getOwnPropertySymbols:Q4,getPrototypeOf:Y4}=Object),qu=globalThis,X1=qu.trustedTypes,Z4=X1?X1.emptyScript:"",J4=qu.reactiveElementPolyfillSupport,Sc=(r,e)=>r,_c={toAttribute(r,e){switch(e){case Boolean:r=r?Z4:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},Gu=(r,e)=>!G4(r,e),eC={attribute:!0,type:String,converter:_c,reflect:!1,hasChanged:Gu};Symbol.metadata??=Symbol("metadata"),qu.litPropertyMetadata??=new WeakMap;dn=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=eC){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){let o=Symbol(),i=this.getPropertyDescriptor(e,o,t);i!==void 0&&j4(this.prototype,e,i)}}static getPropertyDescriptor(e,t,o){let{get:i,set:n}=K4(this.prototype,e)??{get(){return this[t]},set(s){this[t]=s}};return{get(){return i?.call(this)},set(s){let d=i?.call(this);n.call(this,s),this.requestUpdate(e,d,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??eC}static _$Ei(){if(this.hasOwnProperty(Sc("elementProperties")))return;let e=Y4(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Sc("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Sc("properties"))){let t=this.properties,o=[...W4(t),...Q4(t)];for(let i of o)this.createProperty(i,t[i])}let e=this[Symbol.metadata];if(e!==null){let t=litPropertyMetadata.get(e);if(t!==void 0)for(let[o,i]of t)this.elementProperties.set(o,i)}this._$Eh=new Map;for(let[t,o]of this.elementProperties){let i=this._$Eu(t,o);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e)){let o=new Set(e.flat(1/0).reverse());for(let i of o)t.unshift(zu(i))}else e!==void 0&&t.push(zu(e));return t}static _$Eu(e,t){let o=t.attribute;return o===!1?void 0:typeof o=="string"?o:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$Eg=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$ES??=[]).push(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$ES?.splice(this._$ES.indexOf(e)>>>0,1)}_$E_(){let e=new Map,t=this.constructor.elementProperties;for(let o of t.keys())this.hasOwnProperty(o)&&(e.set(o,this[o]),delete this[o]);e.size>0&&(this._$Ep=e)}createRenderRoot(){let e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Nm(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$ES?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$ES?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EO(e,t){let o=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,o);if(i!==void 0&&o.reflect===!0){let n=(o.converter?.toAttribute!==void 0?o.converter:_c).toAttribute(t,o.type);this._$Em=e,n==null?this.removeAttribute(i):this.setAttribute(i,n),this._$Em=null}}_$AK(e,t){let o=this.constructor,i=o._$Eh.get(e);if(i!==void 0&&this._$Em!==i){let n=o.getPropertyOptions(i),s=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:_c;this._$Em=i,this[i]=s.fromAttribute(t,n.type),this._$Em=null}}requestUpdate(e,t,o,i=!1,n){if(e!==void 0){if(o??=this.constructor.getPropertyOptions(e),!(o.hasChanged??Gu)(i?n:this[e],t))return;this.C(e,t,o)}this.isUpdatePending===!1&&(this._$Eg=this._$EP())}C(e,t,o){this._$AL.has(e)||this._$AL.set(e,t),o.reflect===!0&&this._$Em!==e&&(this._$Ej??=new Set).add(e)}async _$EP(){this.isUpdatePending=!0;try{await this._$Eg}catch(t){Promise.reject(t)}let e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this._$Ep){for(let[i,n]of this._$Ep)this[i]=n;this._$Ep=void 0}let o=this.constructor.elementProperties;if(o.size>0)for(let[i,n]of o)n.wrapped!==!0||this._$AL.has(i)||this[i]===void 0||this.C(i,this[i],n)}let e=!1,t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$ES?.forEach(o=>o.hostUpdate?.()),this.update(t)):this._$ET()}catch(o){throw e=!1,this._$ET(),o}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$ES?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$ET(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Eg}shouldUpdate(e){return!0}update(e){this._$Ej&&=this._$Ej.forEach(t=>this._$EO(t,this[t])),this._$ET()}updated(e){}firstUpdated(e){}};dn.elementStyles=[],dn.shadowRootOptions={mode:"open"},dn[Sc("elementProperties")]=new Map,dn[Sc("finalized")]=new Map,J4?.({ReactiveElement:dn}),(qu.reactiveElementVersions??=[]).push("2.0.0")});function uC(r,e){if(!Array.isArray(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return tC!==void 0?tC.createHTML(e):e}function Ys(r,e,t=r,o){if(e===fi)return e;let i=o!==void 0?t._$Co?.[o]:t._$Cl,n=Ic(e)?void 0:e._$litDirective$;return i?.constructor!==n&&(i?._$AO?.(!1),n===void 0?i=void 0:(i=new n(r),i._$AT(r,t,o)),o!==void 0?(t._$Co??=[])[o]=i:t._$Cl=i),i!==void 0&&(e=Ys(r,i._$AS(r,e.values),i,o)),e}var Bm,ju,tC,Vm,un,zm,X4,Qs,kc,Ic,aC,lC,Um,Tc,rC,oC,Ks,iC,nC,cC,dC,T,QH,fi,yt,sC,Ws,hC,Ac,Ku,il,Zs,Wu,Qu,Yu,Zu,pC,e3,fC,qn=y(()=>{a();l();c();Bm=globalThis,ju=Bm.trustedTypes,tC=ju?ju.createPolicy("lit-html",{createHTML:r=>r}):void 0,Vm="$lit$",un=`lit$${(Math.random()+"").slice(9)}$`,zm="?"+un,X4=`<${zm}>`,Qs=document,kc=()=>Qs.createComment(""),Ic=r=>r===null||typeof r!="object"&&typeof r!="function",aC=Array.isArray,lC=r=>aC(r)||typeof r?.[Symbol.iterator]=="function",Um=`[ 	
\f\r]`,Tc=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,rC=/-->/g,oC=/>/g,Ks=RegExp(`>|${Um}(?:([^\\s"'>=/]+)(${Um}*=${Um}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),iC=/'/g,nC=/"/g,cC=/^(?:script|style|textarea|title)$/i,dC=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),T=dC(1),QH=dC(2),fi=Symbol.for("lit-noChange"),yt=Symbol.for("lit-nothing"),sC=new WeakMap,Ws=Qs.createTreeWalker(Qs,129);hC=(r,e)=>{let t=r.length-1,o=[],i,n=e===2?"<svg>":"",s=Tc;for(let d=0;d<t;d++){let u=r[d],h,p,v=-1,C=0;for(;C<u.length&&(s.lastIndex=C,p=s.exec(u),p!==null);)C=s.lastIndex,s===Tc?p[1]==="!--"?s=rC:p[1]!==void 0?s=oC:p[2]!==void 0?(cC.test(p[2])&&(i=RegExp("</"+p[2],"g")),s=Ks):p[3]!==void 0&&(s=Ks):s===Ks?p[0]===">"?(s=i??Tc,v=-1):p[1]===void 0?v=-2:(v=s.lastIndex-p[2].length,h=p[1],s=p[3]===void 0?Ks:p[3]==='"'?nC:iC):s===nC||s===iC?s=Ks:s===rC||s===oC?s=Tc:(s=Ks,i=void 0);let x=s===Ks&&r[d+1].startsWith("/>")?" ":"";n+=s===Tc?u+X4:v>=0?(o.push(h),u.slice(0,v)+Vm+u.slice(v)+un+x):u+un+(v===-2?d:x)}return[uC(r,n+(r[t]||"<?>")+(e===2?"</svg>":"")),o]},Ac=class r{constructor({strings:e,_$litType$:t},o){let i;this.parts=[];let n=0,s=0,d=e.length-1,u=this.parts,[h,p]=hC(e,t);if(this.el=r.createElement(h,o),Ws.currentNode=this.el.content,t===2){let v=this.el.content.firstChild;v.replaceWith(...v.childNodes)}for(;(i=Ws.nextNode())!==null&&u.length<d;){if(i.nodeType===1){if(i.hasAttributes())for(let v of i.getAttributeNames())if(v.endsWith(Vm)){let C=p[s++],x=i.getAttribute(v).split(un),E=/([.?@])?(.*)/.exec(C);u.push({type:1,index:n,name:E[2],strings:x,ctor:E[1]==="."?Wu:E[1]==="?"?Qu:E[1]==="@"?Yu:Zs}),i.removeAttribute(v)}else v.startsWith(un)&&(u.push({type:6,index:n}),i.removeAttribute(v));if(cC.test(i.tagName)){let v=i.textContent.split(un),C=v.length-1;if(C>0){i.textContent=ju?ju.emptyScript:"";for(let x=0;x<C;x++)i.append(v[x],kc()),Ws.nextNode(),u.push({type:2,index:++n});i.append(v[C],kc())}}}else if(i.nodeType===8)if(i.data===zm)u.push({type:2,index:n});else{let v=-1;for(;(v=i.data.indexOf(un,v+1))!==-1;)u.push({type:7,index:n}),v+=un.length-1}n++}}static createElement(e,t){let o=Qs.createElement("template");return o.innerHTML=e,o}};Ku=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){let{el:{content:t},parts:o}=this._$AD,i=(e?.creationScope??Qs).importNode(t,!0);Ws.currentNode=i;let n=Ws.nextNode(),s=0,d=0,u=o[0];for(;u!==void 0;){if(s===u.index){let h;u.type===2?h=new il(n,n.nextSibling,this,e):u.type===1?h=new u.ctor(n,u.name,u.strings,this,e):u.type===6&&(h=new Zu(n,this,e)),this._$AV.push(h),u=o[++d]}s!==u?.index&&(n=Ws.nextNode(),s++)}return Ws.currentNode=Qs,i}p(e){let t=0;for(let o of this._$AV)o!==void 0&&(o.strings!==void 0?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}},il=class r{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,o,i){this.type=2,this._$AH=yt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode,t=this._$AM;return t!==void 0&&e?.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Ys(this,e,t),Ic(e)?e===yt||e==null||e===""?(this._$AH!==yt&&this._$AR(),this._$AH=yt):e!==this._$AH&&e!==fi&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):lC(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==yt&&Ic(this._$AH)?this._$AA.nextSibling.data=e:this.$(Qs.createTextNode(e)),this._$AH=e}g(e){let{values:t,_$litType$:o}=e,i=typeof o=="number"?this._$AC(e):(o.el===void 0&&(o.el=Ac.createElement(uC(o.h,o.h[0]),this.options)),o);if(this._$AH?._$AD===i)this._$AH.p(t);else{let n=new Ku(i,this),s=n.u(this.options);n.p(t),this.$(s),this._$AH=n}}_$AC(e){let t=sC.get(e.strings);return t===void 0&&sC.set(e.strings,t=new Ac(e)),t}T(e){aC(this._$AH)||(this._$AH=[],this._$AR());let t=this._$AH,o,i=0;for(let n of e)i===t.length?t.push(o=new r(this.k(kc()),this.k(kc()),this,this.options)):o=t[i],o._$AI(n),i++;i<t.length&&(this._$AR(o&&o._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e&&e!==this._$AB;){let o=e.nextSibling;e.remove(),e=o}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},Zs=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,o,i,n){this.type=1,this._$AH=yt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=n,o.length>2||o[0]!==""||o[1]!==""?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=yt}_$AI(e,t=this,o,i){let n=this.strings,s=!1;if(n===void 0)e=Ys(this,e,t,0),s=!Ic(e)||e!==this._$AH&&e!==fi,s&&(this._$AH=e);else{let d=e,u,h;for(e=n[0],u=0;u<n.length-1;u++)h=Ys(this,d[o+u],t,u),h===fi&&(h=this._$AH[u]),s||=!Ic(h)||h!==this._$AH[u],h===yt?e=yt:e!==yt&&(e+=(h??"")+n[u+1]),this._$AH[u]=h}s&&!i&&this.j(e)}j(e){e===yt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},Wu=class extends Zs{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===yt?void 0:e}},Qu=class extends Zs{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==yt)}},Yu=class extends Zs{constructor(e,t,o,i,n){super(e,t,o,i,n),this.type=5}_$AI(e,t=this){if((e=Ys(this,e,t,0)??yt)===fi)return;let o=this._$AH,i=e===yt&&o!==yt||e.capture!==o.capture||e.once!==o.once||e.passive!==o.passive,n=e!==yt&&(o===yt||i);i&&this.element.removeEventListener(this.name,this,o),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},Zu=class{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){Ys(this,e)}},pC={S:Vm,A:un,P:zm,C:1,M:hC,L:Ku,R:lC,V:Ys,D:il,I:Zs,H:Qu,N:Yu,U:Wu,B:Zu},e3=Bm.litHtmlPolyfillSupport;e3?.(Ac,il),(Bm.litHtmlVersions??=[]).push("3.0.0");fC=(r,e,t)=>{let o=t?.renderBefore??e,i=o._$litPart$;if(i===void 0){let n=t?.renderBefore??null;o._$litPart$=i=new il(e.insertBefore(kc(),n),n,void 0,t??{})}return i._$AI(r),i}});var Gn,t3,mC=y(()=>{a();l();c();Ec();Ec();qn();qn();Gn=class extends dn{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){let e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){let t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=fC(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return fi}};Gn._$litElement$=!0,Gn["finalized"]=!0,globalThis.litElementHydrateSupport?.({LitElement:Gn});t3=globalThis.litElementPolyfillSupport;t3?.({LitElement:Gn});(globalThis.litElementVersions??=[]).push("4.0.0")});var gC=y(()=>{a();l();c();});var ut=y(()=>{a();l();c();Ec();qn();mC();gC()});var vC=y(()=>{a();l();c();});function G(r){return(e,t)=>typeof t=="object"?o3(r,e,t):((o,i,n)=>{let s=i.hasOwnProperty(n);return i.constructor.createProperty(n,s?{...o,wrapped:!0}:o),s?Object.getOwnPropertyDescriptor(i,n):void 0})(r,e,t)}var r3,o3,qm=y(()=>{a();l();c();Ec();r3={attribute:!0,type:String,converter:_c,reflect:!1,hasChanged:Gu},o3=(r=r3,e,t)=>{let{kind:o,metadata:i}=t,n=globalThis.litPropertyMetadata.get(i);if(n===void 0&&globalThis.litPropertyMetadata.set(i,n=new Map),n.set(t.name,r),o==="accessor"){let{name:s}=t;return{set(d){let u=e.get.call(this);e.set.call(this,d),this.requestUpdate(s,u,r)},init(d){return d!==void 0&&this.C(s,void 0,r),d}}}if(o==="setter"){let{name:s}=t;return function(d){let u=this[s];e.call(this,d),this.requestUpdate(s,u,r)}}throw Error("Unsupported decorator location: "+o)}});function K(r){return G({...r,state:!0,attribute:!1})}var yC=y(()=>{a();l();c();qm();});var bC=y(()=>{a();l();c();});var nl=y(()=>{a();l();c();});var CC=y(()=>{a();l();c();nl();});var wC=y(()=>{a();l();c();nl();});var xC=y(()=>{a();l();c();nl();});var SC=y(()=>{a();l();c();nl();});var _C=y(()=>{a();l();c();nl();});var Ao=y(()=>{a();l();c();vC();qm();yC();bC();CC();wC();xC();SC();_C()});var Bo,Gm=y(()=>{a();l();c();ac();Bo=class{static get strings(){return this._strings}static set strings(e){this._strings=e,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){var e,t;switch(((e=document.body)===null||e===void 0?void 0:e.getAttribute("dir"))||((t=document.documentElement)===null||t===void 0?void 0:t.getAttribute("dir"))){case"rtl":return"rtl";case"auto":return"auto";case"ltr":default:return"ltr"}}static onStringsUpdated(e){this._stringsEventDispatcher.add(e)}static removeOnStringsUpdated(e){this._stringsEventDispatcher.remove(e)}static onDirectionUpdated(e){this._directionEventDispatcher.add(e),this.initDirection()}static removeOnDirectionUpdated(e){this._directionEventDispatcher.remove(e)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver(t=>{t.forEach(o=>{o.attributeName==="dir"&&this._directionEventDispatcher.fire(null)})});let e={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,e),this.mutationObserver.observe(document.documentElement,e)}static updateStringsForTag(e,t){var o;if(e=e.toLowerCase(),e.startsWith("mgt-")&&(e=e.substring(4)),this._strings&&t){for(let i of Object.entries(t)){let n=this._strings[i[0]];typeof n=="string"&&(t[i[0]]=n)}if(!((o=this._strings._components)===null||o===void 0)&&o[e]){let i=this._strings._components[e];for(let n of Object.keys(i))t[n]&&(t[n]=i[n])}}return t}};Bo._stringsEventDispatcher=new di;Bo._directionEventDispatcher=new di;Bo._isDirectionInit=!1});var Pc,Oc,EC,Rc,Pr,Xu=y(()=>{a();l();c();ut();Ao();Bn();Us();Gm();Cc();Pc=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Oc=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},EC=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})};(function(r){r.mobile="",r.tablet="tablet",r.desktop="desktop"})(Rc||(Rc={}));Pr=class extends Gn{static get packageVersion(){return js}get mediaQuery(){return this.offsetWidth<768?Rc.mobile:this.offsetWidth<1200?Rc.tablet:Rc.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}constructor(){super(),this.direction="ltr",this._isFirstUpdated=!1,this._isLoadingState=!1,this.setLoadingState=e=>{this._isLoadingState!==e&&(this._isLoadingState=e)},this.handleProviderUpdates=()=>{this.requestStateUpdate()},this.handleActiveAccountUpdates=()=>{this.clearState(),this.requestStateUpdate()},this.handleLocalizationChanged=()=>{Bo.updateStringsForTag(this.tagName,this.strings)},this.handleDirectionChanged=()=>{this.direction=Bo.getDocumentDirection()},this.handleDirectionChanged(),this.handleLocalizationChanged(),this._currentLoadStatePromise=null,this._loadStatePromise=null}connectedCallback(){super.connectedCallback(),Bo.onStringsUpdated(this.handleLocalizationChanged),Bo.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),Bo.removeOnStringsUpdated(this.handleLocalizationChanged),Bo.removeOnDirectionUpdated(this.handleDirectionChanged),he.removeProviderUpdatedListener(this.handleProviderUpdates),he.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(e){super.firstUpdated(e),this._isFirstUpdated=!0,he.onProviderUpdated(this.handleProviderUpdates),he.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(e,t,o=!1,i=!1,n=!1){let s=new CustomEvent(e,{bubbles:o,cancelable:i,composed:n,detail:t});return this.dispatchEvent(s)}updated(e){super.updated(e);let t=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(t)}requestStateUpdate(e=!1){return EC(this,void 0,void 0,function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!e&&(yield this._currentLoadStatePromise);let t=he.globalProvider;if(!t)return Promise.resolve();if(t.state===Me.SignedOut){this.clearState();return}else{if(t.state===Me.Loading)return Promise.resolve();this._loadStatePromise=new Promise((o,i)=>EC(this,void 0,void 0,function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),o()}catch(n){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),i(n)}return this._currentLoadStatePromise=this._isLoadingState&&this._currentLoadStatePromise&&e?this._currentLoadStatePromise.then(()=>this._loadStatePromise):this._loadStatePromise}))}})}};Pc([K(),Oc("design:type",String)],Pr.prototype,"direction",void 0);Pc([K(),Oc("design:type",Object)],Pr.prototype,"_isFirstUpdated",void 0);Pc([K(),Oc("design:type",Object)],Pr.prototype,"_isLoadingState",void 0);Pc([K(),Oc("design:type",Promise)],Pr.prototype,"_currentLoadStatePromise",void 0);Pc([K(),Oc("design:type",Promise)],Pr.prototype,"_loadStatePromise",void 0)});var jm,Km,sl,TC=y(()=>{a();l();c();Ao();Xu();jm=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Km=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},sl=class extends Pr{constructor(){super(...arguments),this.stateChangedHandler=()=>{this.fireCustomEvent("onStateChanged",this.provider.state)}}get provider(){return this._provider}set provider(e){this._provider&&this.provider.removeStateChangedHandler(()=>this.stateChangedHandler),this._provider=e,this._provider&&this.provider.onStateChanged(()=>this.stateChangedHandler)}get isAvailable(){return!0}firstUpdated(e){super.firstUpdated(e);let t=!1;if(this.dependsOn){let o=this.dependsOn;for(;o;){if(o.isAvailable){t=!0;break}o=o.dependsOn}}!t&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}};jm([G({attribute:"depends-on",converter:r=>document.querySelector(r),type:String}),Km("design:type",sl)],sl.prototype,"dependsOn",void 0);jm([G({attribute:"base-url",type:String}),Km("design:type",String)],sl.prototype,"baseUrl",void 0);jm([G({attribute:"custom-hosts",type:String,converter:r=>r.split(",").map(e=>e.trim())}),Km("design:type",Array)],sl.prototype,"customHosts",void 0)});var kC,Wm,$c,Qm=y(()=>{a();l();c();kC=(r,e)=>Wm(r,e,new Set),Wm=(r,e,t)=>{let o=Object.prototype.toString.call(r),i=Object.prototype.toString.call(e);if(typeof r=="object"&&typeof e=="object"&&o===i&&o==="[object Object]"&&!t.has(r)){t.add(r);for(let n in r)if(!Wm(r[n],e[n],t))return!1;for(let n in e)if(!Object.prototype.hasOwnProperty.call(r,n))return!1;return!0}if(Array.isArray(r)&&Array.isArray(e)&&!t.has(r)){if(t.add(r),r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!Wm(r[n],e[n],t))return!1;return!0}return r===e},$c=(r,e)=>{if(r===e)return!0;if(!r||!e||r.length!==e.length)return!1;if(r.length===0)return!0;let t=new Set(r);for(let o of e)if(!t.has(o))return!1;return!0}});var Mc,Ym=y(()=>{a();l();c();Mc=class{static renderTemplate(e,t,o){var i;t.$parentTemplateContext&&(o=Object.assign(Object.assign({},o),{$parent:t.$parentTemplateContext}));let n;if(!((i=t.content)===null||i===void 0)&&i.childNodes.length){let s=t.content.cloneNode(!0);n=this.renderNode(s,e,o)}else if(t.childNodes.length){let s=document.createElement("div");for(let d of t.childNodes)s.appendChild(this.simpleCloneNode(d));n=this.renderNode(s,e,o)}n&&e.appendChild(n)}static setBindingSyntax(e,t){this._startExpression=e,this._endExpression=t;let o=this.escapeRegex(this._startExpression),i=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${o}\\s*([$\\w\\.,'"\\s()\\[\\]]+)\\s*${i}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(e){if(!e)return null;let t=e.cloneNode(!1);for(let o of e.childNodes){let i=this.simpleCloneNode(o);i&&t.appendChild(i)}return t}static expandExpressionsAsString(e,t){return e.replace(this.expression,(o,i)=>{let n=this.evalInContext(i||this.trimExpression(o),t);return n?typeof n=="object"?JSON.stringify(n):n.toString():""})}static renderNode(e,t,o){if(e.nodeName==="#text")return e.textContent=this.expandExpressionsAsString(e.textContent,o),e;if(e.nodeName==="TEMPLATE")return e.$parentTemplateContext=o,e;let i=e;if(i.attributes)for(let u of i.attributes)if(u.name==="data-props"){let h=this.trimExpression(u.value);for(let p of h.split(",")){let v=p.trim().split(":");if(v.length===2){let C=v[0].trim(),x=this.evalInContext(v[1].trim(),o);C.startsWith("@")?typeof x=="function"&&i.addEventListener(C.substring(1),E=>x(E,o,t)):i[C]=x}}}else i.setAttribute(u.name,this.expandExpressionsAsString(u.value,o));let n=[],s=[],d=!1;for(let u of e.childNodes){let h=u,p=!1;if(h.dataset){let v=!1;if(h.dataset.if){let C=h.dataset.if;this.evalBoolInContext(this.trimExpression(C),o)?(h.removeAttribute("data-if"),d=!0,p=!0):(s.push(h),v=!0)}else typeof h.dataset.else<"u"&&(d?(s.push(h),v=!0):h.removeAttribute("data-else"));h.dataset.for&&!v?n.push(h):v||this.renderNode(u,t,o)}else this.renderNode(u,t,o);!p&&u.nodeName!=="#text"&&(d=!1)}for(let u of s)i.removeChild(u);for(let u of n){let h=u.dataset.for,p=this.trimExpression(h).split(/\s(in|of)\s/i);if(p.length===3){let v=p[0].trim(),C=p[2].trim(),x=this.evalInContext(C,o);if(Array.isArray(x)){u.removeAttribute("data-for");for(let E=0;E<x.length;E++){let O=Object.assign({$index:E},o);O[v]=x[E];let q=u.cloneNode(!0);this.renderNode(q,t,O),i.insertBefore(q,u)}}i.removeChild(u)}}return e}static evalBoolInContext(e,t){return t=Object.assign(Object.assign({},t),this.globalContext),new Function("with(this) { return !!("+e+")}").call(t)}static evalInContext(e,t){t=Object.assign(Object.assign({},t),this.globalContext);let o=new Function("with(this) { return "+e+";}"),i;try{i=o.call(t)}catch{}return i}static trimExpression(e){return e=e.trim(),e.startsWith(this._startExpression)&&e.endsWith(this._endExpression)&&(e=e.substr(this._startExpression.length,e.length-this._startExpression.length-this._endExpression.length),e=e.trim()),e}};Mc._globalContext={}});var IC,AC,qr,RC=y(()=>{a();l();c();Ao();ut();Qm();Xu();Ym();IC=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},AC=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},qr=class extends Pr{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,o){if(!this.hasTemplate(e))return null;o=o||e,this._slotNamesAddedDuringRender.push(o),this._renderedSlots=!0;let i=T`
      <slot name=${o}></slot>
    `,n=Object.assign(Object.assign({},t),this.templateContext);if(Object.prototype.hasOwnProperty.call(this._renderedTemplates,o)){let{context:u,slot:h}=this._renderedTemplates[o];if(kC(u,n))return i;this.removeChild(h)}let s=document.createElement("div");s.slot=o,s.dataset.generated="template",Mc.renderTemplate(s,this.templates[e],n),this.appendChild(s),this._renderedTemplates[o]={context:n,slot:s};let d={templateType:e,context:n,element:s};return this.fireCustomEvent("templateRendered",d),i}hasTemplate(e){var t;return!!(!((t=this.templates)===null||t===void 0)&&t[e])}getTemplates(){let e={};for(let t=0;t<this.children.length;t++){let o=this.children[t];if(o.nodeName==="TEMPLATE"){let i=o;i.dataset.type?e[i.dataset.type]=i:e.default=i,i.templateOrder=t}}return e}renderError(){return this.hasTemplate("error")?this.renderTemplate("error",this.error):T`
      <div class="error">
        ${this.error}
      </div>
    `}removeUnusedSlottedElements(){var e;if(this._renderedSlots){for(let t=0;t<this.children.length;t++){let o=this.children[t];!((e=o.dataset)===null||e===void 0)&&e.generated&&!this._slotNamesAddedDuringRender.includes(o.slot)&&(this.removeChild(o),delete this._renderedTemplates[o.slot],t--)}this._renderedSlots=!1}}};IC([G({attribute:!1}),AC("design:type",Object)],qr.prototype,"templateContext",void 0);IC([K(),AC("design:type",Object)],qr.prototype,"error",void 0)});var PC=y(()=>{a();l();c();wc();Bn()});var OC=y(()=>{a();l();c()});var $C=y(()=>{a();l();c()});function n3(){return MC||(MC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s3(){return FC||(FC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}function a3(r){let e=new Promise((t,o)=>{let i=()=>{r.removeEventListener("success",n),r.removeEventListener("error",s)},n=()=>{t(Pi(r.result)),i()},s=()=>{o(r.error),i()};r.addEventListener("success",n),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&DC.set(t,r)}).catch(()=>{}),eg.set(e,r),e}function l3(r){if(Jm.has(r))return;let e=new Promise((t,o)=>{let i=()=>{r.removeEventListener("complete",n),r.removeEventListener("error",s),r.removeEventListener("abort",s)},n=()=>{t(),i()},s=()=>{o(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",n),r.addEventListener("error",s),r.addEventListener("abort",s)});Jm.set(r,e)}function NC(r){Xm=r(Xm)}function c3(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let o=r.call(eh(this),e,...t);return LC.set(o,e.sort?e.sort():[e]),Pi(o)}:s3().includes(r)?function(...e){return r.apply(eh(this),e),Pi(DC.get(this))}:function(...e){return Pi(r.apply(eh(this),e))}}function d3(r){return typeof r=="function"?c3(r):(r instanceof IDBTransaction&&l3(r),i3(r,n3())?new Proxy(r,Xm):r)}function Pi(r){if(r instanceof IDBRequest)return a3(r);if(Zm.has(r))return Zm.get(r);let e=d3(r);return e!==r&&(Zm.set(r,e),eg.set(e,r)),e}var i3,MC,FC,DC,Jm,LC,Zm,eg,Xm,eh,tg=y(()=>{a();l();c();i3=(r,e)=>e.some(t=>r instanceof t);DC=new WeakMap,Jm=new WeakMap,LC=new WeakMap,Zm=new WeakMap,eg=new WeakMap;Xm={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Jm.get(r);if(e==="objectStoreNames")return r.objectStoreNames||LC.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Pi(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};eh=r=>eg.get(r)});function UC(r,e,{blocked:t,upgrade:o,blocking:i,terminated:n}={}){let s=indexedDB.open(r,e),d=Pi(s);return o&&s.addEventListener("upgradeneeded",u=>{o(Pi(s.result),u.oldVersion,u.newVersion,Pi(s.transaction))}),t&&s.addEventListener("blocked",()=>t()),d.then(u=>{n&&u.addEventListener("close",()=>n()),i&&u.addEventListener("versionchange",()=>i())}).catch(()=>{}),d}function HC(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(rg.get(e))return rg.get(e);let t=e.replace(/FromIndex$/,""),o=e!==t,i=h3.includes(t);if(!(t in(o?IDBIndex:IDBObjectStore).prototype)||!(i||u3.includes(t)))return;let n=async function(s,...d){let u=this.transaction(s,i?"readwrite":"readonly"),h=u.store;return o&&(h=h.index(d.shift())),(await Promise.all([h[t](...d),i&&u.done]))[0]};return rg.set(e,n),n}var u3,h3,rg,BC=y(()=>{a();l();c();tg();tg();u3=["get","getKey","getAll","getAllKeys","count"],h3=["put","add","delete","clear"],rg=new Map;NC(r=>({...r,get:(e,t,o)=>HC(e,t)||r.get(e,t,o),has:(e,t)=>!!HC(e,t)||r.has(e,t)}))});var Js,th=y(()=>{a();l();c();Js="mgt-db-list"});var Fc,rh,og=y(()=>{a();l();c();BC();Us();th();Fc=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},rh=class{constructor(e,t){if(!(t in e.stores))throw Error('"store" must be defined in the "schema"');this.schema=e,this.store=t}getValue(e){return Fc(this,void 0,void 0,function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,e)}catch{return null}})}putValue(e,t){return Fc(this,void 0,void 0,function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},t),{timeCached:Date.now()}),e)}catch{return}})}clearStore(){return Fc(this,void 0,void 0,function*(){if(window.indexedDB)try{yield(yield this.getDb()).clear(this.store)}catch{return}})}getDBName(){return Fc(this,void 0,void 0,function*(){let e=yield he.getCacheId();if(e)return`mgt-${this.schema.name}-${e}`})}getDb(){return Fc(this,void 0,void 0,function*(){let e=yield this.getDBName();if(e)return UC(e,this.schema.version,{upgrade:(t,o,i,n)=>{let s=JSON.parse(localStorage.getItem(Js))||[];s.includes(e)||s.push(e),localStorage.setItem(Js,JSON.stringify(s));for(let d in this.schema.stores)Object.prototype.hasOwnProperty.call(this.schema.stores,d)&&!t.objectStoreNames.contains(d)&&t.createObjectStore(d)}})})}}});var p3,ye,VC=y(()=>{a();l();c();Us();Bn();og();th();p3=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},ye=class{static getCache(e,t){let o=`${e.name}/${t}`;return this.isInitialized||this.init(),this.cacheStore.has(t)||this.cacheStore.set(o,new rh(e,t)),this.cacheStore.get(o)}static clearCacheById(e){let t=[],o=JSON.parse(localStorage.getItem(Js));if(o){let i=[];o.forEach(n=>{n.includes(e)?t.push(new Promise((s,d)=>{let u=indexedDB.deleteDatabase(n);u.onsuccess=()=>s(),u.onerror=()=>{console.error(`\u{1F992}: ${u.error.name} occurred deleting cache: ${n}`,u.error.message),d()}})):i.push(n)}),i.length>0?localStorage.setItem(Js,JSON.stringify(i)):localStorage.removeItem(Js)}return Promise.all(t)}static get config(){return this.cacheConfig}static init(){let e;he.globalProvider&&(e=he.globalProvider.state),he.onProviderUpdated(()=>p3(this,void 0,void 0,function*(){if(e===Me.SignedIn&&he.globalProvider.state===Me.SignedOut){let t=yield he.getCacheId();t!==null&&(yield this.clearCacheById(t))}e=he.globalProvider.state})),this.isInitialized=!0}};ye.cacheStore=new Map;ye.isInitialized=!1;ye.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}}});var Oi,zC=y(()=>{a();l();c();Oi=class{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(e){this._microsoftTeamsLib=e}static get isAvailable(){return this.microsoftTeamsLib?window.parent===window.self&&window.nativeInterface?!0:window.name==="embedded-page-container"||window.name==="extension-tab-frame":!1}static executeDeepLink(e,t){let o=this.microsoftTeamsLib;o.initialize(),o.executeDeepLink(e,t)}}});var qC=y(()=>{a();l();c()});var GC,Xs,jC=y(()=>{a();l();c();GC=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Xs=class r{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(e,t,o){return GC(this,void 0,void 0,function*(){let i=yield t.get();if(i?.value){let n=new r;return n._graph=e,n._value=i.value,n._nextLink=i["@odata.nextLink"],n._version=o||e.version,n}return null})}static createFromValue(e,t,o=null){let i=new r;return i._graph=e,i._value=t,i._nextLink=o,i._version=e.version,i}get nextLink(){return this._nextLink||""}next(){var e;return GC(this,void 0,void 0,function*(){if(this._nextLink){let t=this._nextLink.split(this._version)[1],o=yield this._graph.api(t).version(this._version).get();if(!((e=o?.value)===null||e===void 0)&&e.length)return this._value=this._value.concat(o.value),this._nextLink=o["@odata.nextLink"],o.value}return null})}}});var KC,WC,f3,Ot,QC=y(()=>{a();l();c();ut();rl();KC=new WeakMap,WC=(r,e,t)=>{let o=[];for(let i of r)o.push(i.replace(e,t));return o},f3=(r,...e)=>{if(oo.isDisambiguated){let t=KC.get(r);if(!t){let o=new RegExp("(</?)mgt-(?!"+oo.disambiguation+"-)"),i=`$1${oo.prefix}-`;t=Object.assign(WC(r,o,i),{raw:WC(r.raw,o,i)}),KC.set(r,t)}r=t}return T(r,...e)},Ot=f3});var YC=y(()=>{a();l();c();Ao();rl()});var Dc,Nt,ZC=y(()=>{a();l();c();rl();Dc=r=>`${oo.prefix}-${r}`,Nt=(r,e,t)=>{let o=Dc(r);customElements.get(o)||customElements.define(o,e,t)}});var JC=y(()=>{a();l();c()});var oh,XC,ew=y(()=>{a();l();c();oh=class{constructor(){this.session=window.sessionStorage}setItem(e,t){this.session.setItem(e,t)}getItem(e){return this.session.getItem(e)}clear(){this.session.clear()}},XC=r=>{let e;try{r==="sessionStorage"?e=window.sessionStorage:e=window.localStorage;let t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0}}});var tw,Lc,rw=y(()=>{a();l();c();ew();tw=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Lc=class r{static get _sessionCache(){return!this._cache&&XC("sessionStorage")&&(this._cache=new oh),this._cache}execute(e){return tw(this,void 0,void 0,function*(){try{let t=yield r.getBaseUrl();e.request=t+encodeURIComponent(e.request)}catch{}return yield this._nextMiddleware.execute(e)})}setNext(e){this._nextMiddleware=e}static getBaseUrl(){var e,t;return tw(this,void 0,void 0,function*(){if(!this._baseUrl){let o=(e=this._sessionCache)===null||e===void 0?void 0:e.getItem("endpointURL");if(o)this._baseUrl=o;else{try{let n=yield(yield fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint")).json();typeof n!="string"?r.setBaseFallbackUrl():this._baseUrl=n+"?url="}catch{r.setBaseFallbackUrl()}(t=this._sessionCache)===null||t===void 0||t.setItem("endpointURL",this._baseUrl)}}return this._baseUrl})}static setBaseFallbackUrl(){this._baseUrl="https://proxy.apisandbox.msdn.microsoft.com/svc?url="}}});var m3,ih,ow=y(()=>{a();l();c();Gs();wc();Hu();rw();m3=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},ih=class r extends ol{static create(e){return m3(this,void 0,void 0,function*(){let t=[new hi(e),new ko(new Cr),new mo,new Lc,new Ri];return new r(qs.initWithMiddleware({middleware:Nu(...t),customHosts:new Set([new URL(yield Lc.getBaseUrl()).hostname])}))})}forComponent(e){return this}}});var ig,nh,iw=y(()=>{a();l();c();Bn();ow();ig=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},nh=class extends Hs{constructor(e=!1,t=[]){super(),this._accounts=[],this._mockGraphPromise=ih.create(this);let o=!!t.length;this.isMultipleAccountSupported=o,this.isMultipleAccountDisabled=!o,this._accounts=t,this.initializeMockGraph(e)}get isMultiAccountSupportedAndEnabled(){return!this.isMultipleAccountDisabled&&this.isMultipleAccountSupported}getAllAccounts(){return this._accounts}getActiveAccount(){if(this._accounts.length)return this._accounts[0]}login(){return ig(this,void 0,void 0,function*(){this.setState(Me.Loading),yield this._mockGraphPromise,yield new Promise(e=>setTimeout(e,3e3)),this.setState(Me.SignedIn)})}logout(){return ig(this,void 0,void 0,function*(){this.setState(Me.Loading),yield this._mockGraphPromise,yield new Promise(e=>setTimeout(e,3e3)),this.setState(Me.SignedOut)})}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}initializeMockGraph(e=!1){return ig(this,void 0,void 0,function*(){this.graph=yield this._mockGraphPromise,e?this.setState(Me.SignedIn):this.setState(Me.SignedOut)})}}});var lt=y(()=>{a();l();c();gm();cc();wc();Y1();Xu();TC();RC();rl();Bn();Us();PC();OC();$C();VC();og();th();ac();Qm();Hu();$m();gu();zC();qC();Ym();jC();Gm();QC();YC();ZC();Cc();JC();iw()});var _h,Eh,gl,Dg=y(()=>{a();l();c();_h={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Eh=r=>(...e)=>({_$litDirective$:r,values:e}),gl=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,o){this._$Ct=e,this._$AM=t,this._$Ci=o}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}});var Qt,Fw=y(()=>{a();l();c();qn();Dg();Qt=Eh(class extends gl{constructor(r){if(super(r),r.type!==_h.ATTRIBUTE||r.name!=="class"||r.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(r){return" "+Object.keys(r).filter(e=>r[e]).join(" ")+" "}update(r,[e]){if(this.it===void 0){this.it=new Set,r.strings!==void 0&&(this.st=new Set(r.strings.join(" ").split(/\s/).filter(o=>o!=="")));for(let o in e)e[o]&&!this.st?.has(o)&&this.it.add(o);return this.render(e)}let t=r.element.classList;for(let o of this.it)o in e||(t.remove(o),this.it.delete(o));for(let o in e){let i=!!e[o];i===this.it.has(o)||this.st?.has(o)||(i?(t.add(o),this.it.add(o)):(t.remove(o),this.it.delete(o)))}return fi}})});var ca=y(()=>{a();l();c();Fw()});var Th,Lg,kh,Qc,da=y(()=>{a();l();c();lt();Th=r=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate());if(r>=t)return r.toLocaleString("default",{hour:"numeric",minute:"numeric"});let o=new Date(t);if(o.setDate(e.getDate()-e.getDay()),r>=o)return r.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});let i=new Date(o);return i.setDate(o.getDate()-7),r>=i?r.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):r.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},Lg=r=>new Promise((e,t)=>{let o=new FileReader;o.onerror=t,o.onload=()=>{e(o.result)},o.readAsDataURL(r)}),kh=r=>r.startsWith("[")?r.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():r,Qc=(r,e=2)=>{if(r===0)return"0 Bytes";let t=1024,o=e<0?0:e,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(r)/Math.log(t));return`${parseFloat((r/Math.pow(t,n)).toFixed(o))} ${i[n]}`}});var re,ua=y(()=>{a();l();c();re={presence:{name:"presence",stores:{presence:"presence"},version:2},users:{name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters"},version:3},photos:{name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups",teams:"teams"},version:2},people:{name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:3},groups:{name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:5},get:{name:"responses",stores:{responses:"responses"},version:2},search:{name:"search",stores:{responses:"responses"},version:2},files:{name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:2},fileLists:{name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:2}}});var Dw,Ng,vl,Lw,Yc,Zc,jr,Hg,ha=y(()=>{a();l();c();lt();da();ua();Dw=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})};(function(r){r[r.any=0]="any",r.person="person",r.group="group"})(Ng||(Ng={}));(function(r){r.any="any",r.user="user",r.contact="contact"})(vl||(vl={}));Lw=()=>ye.config.people.invalidationPeriod||ye.config.defaultInvalidationPeriod,Yc=()=>ye.config.people.isEnabled&&ye.config.isEnabled,Zc=(r,e,t=10,o=vl.any,i="")=>Dw(void 0,void 0,void 0,function*(){let n="people.read",s=`${e}:${t}:${o}`,d;if(Yc()){let p=re.people,v=re.people.stores.peopleQuery;d=ye.getCache(p,v);let C=Yc()?yield d.getValue(s):null;if(C&&Lw()>Date.now()-C.timeCached)return C.results.map(x=>JSON.parse(x))}let u="personType/class eq 'Person'";o!==vl.any&&(o===vl.user?u+="and personType/subclass eq 'OrganizationUser'":u+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),i!==""&&(u+=` and  ${i}`);let h;try{let p=r.api("/me/people").search('"'+e+'"').top(t).filter(u).middlewareOptions(vt(n));if(o!==vl.contact&&(p=p.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),h=yield p.get(),Yc()&&h){let v={maxResults:t,results:null};v.results=h.value.map(C=>JSON.stringify(C)),yield d.putValue(s,v)}}catch{}return h?.value}),jr=r=>{var e,t;let o=r,i=r,n=r;return i.mail?kh(i.mail):!((e=o.scoredEmailAddresses)===null||e===void 0)&&e.length?kh(o.scoredEmailAddresses[0].address):!((t=n.emailAddresses)===null||t===void 0)&&t.length?kh(n.emailAddresses[0].address):null},Hg=(r,e)=>Dw(void 0,void 0,void 0,function*(){let t="contacts.read",o;if(Yc()){o=ye.getCache(re.people,re.people.stores.contacts);let s=yield o.getValue(e);if(s&&Lw()>Date.now()-s.timeCached)return JSON.parse(s.person)}let i=`${e.replace(/#/g,"%2523")}`,n=yield r.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${i}')`).middlewareOptions(vt(t)).get();return Yc()&&n&&(yield o.putValue(e,{person:JSON.stringify(n.value)})),n?n.value:null})});var Ug,Jc,Ni,Nw,Hw,Ih,Ah=y(()=>{a();l();c();lt();ua();ha();Ug=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Jc=()=>ye.config.users.invalidationPeriod||ye.config.defaultInvalidationPeriod,Ni=()=>ye.config.users.isEnabled&&ye.config.isEnabled,Nw=(r,e)=>Ug(void 0,void 0,void 0,function*(){let t;if(Ni()){t=ye.getCache(re.users,re.users.stores.users);let n=yield t.getValue("me");if(n&&Jc()>Date.now()-n.timeCached){let s=JSON.parse(n.user),d=e?e.filter(u=>!Object.keys(s).includes(u)):null;if(!d||d.length<=1)return s}}let o="me";e&&(o=o+"?$select="+e.toString());let i=yield r.api(o).middlewareOptions(vt("user.read")).get();return Ni()&&(yield t.putValue("me",{user:JSON.stringify(i)})),i}),Hw=(r,e,t)=>Ug(void 0,void 0,void 0,function*(){let o="user.readbasic.all",i;if(Ni()){i=ye.getCache(re.users,re.users.stores.users);let d=yield i.getValue(e);if(d&&Jc()>Date.now()-d.timeCached){let u=d.user?JSON.parse(d.user):null,h=t&&u?t.filter(p=>!Object.keys(u).includes(p)):null;if(!h||h.length<=1)return u}}let n=`/users/${e}`;t&&(n=n+"?$select="+t.toString());let s;try{s=yield r.api(n).middlewareOptions(vt(o)).get()}catch{}return Ni()&&(yield i.putValue(e,{user:JSON.stringify(s)})),s}),Ih=(r,e,t=10,o="")=>Ug(void 0,void 0,void 0,function*(){let i="User.ReadBasic.All",n={maxResults:t,results:null},s=`${e}:${t}:${o}`,d;if(Ni()){d=ye.getCache(re.users,re.users.stores.usersQuery);let v=yield d.getValue(s);if(v&&Jc()>Date.now()-v.timeCached)return v.results.map(C=>JSON.parse(C))}let u=`${e.replace(/#/g,"%2523")}`,h=r.api("users").header("ConsistencyLevel","eventual").count(!0).search(`"displayName:${u}" OR "mail:${u}"`),p;o!==""&&h.filter(o);try{p=yield h.top(t).middlewareOptions(vt(i)).get()}catch{}return Ni()&&p&&(n.results=p.value.map(v=>JSON.stringify(v)),yield d.putValue(e,n)),p?p.value:null})});var pa,Xc,Hi,ed,Uw,Bg,td,Bw,Vw,rd,Rh=y(()=>{a();l();c();lt();Gs();da();ua();ha();Ah();pa=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Xc=()=>ye.config.photos.invalidationPeriod||ye.config.defaultInvalidationPeriod,Hi=()=>ye.config.photos.isEnabled&&ye.config.isEnabled,ed=(r,e,t)=>pa(void 0,void 0,void 0,function*(){try{let o=yield r.api(`${e}/photo/$value`).responseType(hr.RAW).middlewareOptions(vt(...t)).get();if(o.status===404)return{eTag:null,photo:null};if(!o.ok)return null;let i=o["@odata.mediaEtag"],n=yield Lg(yield o.blob());return{eTag:i,photo:n}}catch{return null}}),Uw=(r,e)=>pa(void 0,void 0,void 0,function*(){let t,o;return Hi()&&(t=ye.getCache(re.photos,re.photos.stores.contacts),o=yield t.getValue(e),o&&Xc()>Date.now()-o.timeCached)?o.photo:(o=yield ed(r,`me/contacts/${e}`,["contacts.read"]),Hi()&&o&&(yield t.putValue(e,o)),o?o.photo:null)}),Bg=(r,e)=>pa(void 0,void 0,void 0,function*(){let t,o;if(Hi()){if(t=ye.getCache(re.photos,re.photos.stores.users),o=yield t.getValue(e),o&&Xc()>Date.now()-o.timeCached)return o.photo;if(o)try{let i=yield r.api(`users/${e}/photo`).get();i&&(i["@odata.mediaEtag"]!==o.eTag||i["@odata.mediaEtag"]===null&&o.eTag===null)&&(o=null)}catch{return null}}return o=o||(yield ed(r,`users/${e}`,["user.readbasic.all"])),Hi()&&o&&(yield t.putValue(e,o)),o?o.photo:null}),td=(r,e,t=!0)=>pa(void 0,void 0,void 0,function*(){if("personType"in e&&e.personType.subclass!=="OrganizationUser"){if(e.personType.subclass==="PersonalContact"&&t){let i=jr(e),n=yield Hg(r,i);if(n?.length&&n[0].id)return yield Uw(r,n[0].id)}return null}if(e.userPrincipalName||e.id){let i=e.userPrincipalName||e.id;return yield Bg(r,i)}if(e.id){let i=yield Bg(r,e.id);if(i)return i}let o=jr(e);if(o){let i=yield Ih(r,o,1);if(i?.length)return yield Bg(r,i[0].id);if(t){let n=yield Hg(r,o);if(n?.length)return yield Uw(r,n[0].id)}}return null}),Bw=(r,e)=>pa(void 0,void 0,void 0,function*(){let t,o,i=e.id;if(Hi()){if(o=ye.getCache(re.photos,re.photos.stores.groups),t=yield o.getValue(i),t&&Xc()>Date.now()-t.timeCached)return t.photo;if(t)try{let n=yield r.api(`groups/${i}/photo`).get();n&&(n["@odata.mediaEtag"]!==t.eTag||n["@odata.mediaEtag"]===null&&t.eTag===null)&&(t=null)}catch{return null}}return t=t||(yield ed(r,`groups/${i}`,["user.readbasic.all"])),Hi()&&t&&(yield o.putValue(i,t)),t?t.photo:null}),Vw=(r,e)=>pa(void 0,void 0,void 0,function*(){return yield ye.getCache(re.photos,e).getValue(r)}),rd=(r,e,t)=>pa(void 0,void 0,void 0,function*(){yield ye.getCache(re.photos,e).putValue(r,t)})});var B3,V3,zw,Ph,Vg=y(()=>{a();l();c();lt();ua();B3=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},V3=()=>ye.config.presence.invalidationPeriod||ye.config.defaultInvalidationPeriod,zw=()=>ye.config.presence.isEnabled&&ye.config.isEnabled,Ph=(r,e)=>B3(void 0,void 0,void 0,function*(){let t;if(zw()){t=ye.getCache(re.presence,re.presence.stores.presence);let s=yield t.getValue(e||"me");if(s&&V3()>Date.now()-s.timeCached)return JSON.parse(s.presence)}let o=e?["presence.read.all"]:["presence.read"],i=e?`/users/${e}/presence`:"/me/presence",n=yield r.api(i).middlewareOptions(vt(...o)).get();return zw()&&(yield t.putValue(e||"me",{presence:JSON.stringify(n)})),n})});var qw,Gw=y(()=>{a();l();c();qw=r=>{let e=r;return e.statusCode&&"code"in e&&"body"in e&&e.date&&"message"in e&&"name"in e&&"requestId"in e}});var z3,fa,Oh=y(()=>{a();l();c();lt();Rh();Ah();ua();Gw();z3=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},fa=(r,e,t)=>z3(void 0,void 0,void 0,function*(){let o,i=null,n,s,d=e?`users/${e}`:"me",u=d+(t?`?$select=${t.toString()}`:""),h=e?["user.readbasic.all"]:["user.read"];if(Ni()&&(s=yield ye.getCache(re.users,re.users.stores.users).getValue(e||"me"),s&&Jc()>Date.now()-s.timeCached?(i=s.user?JSON.parse(s.user):null,i!==null&&t&&t.filter(C=>!Object.keys(i).includes(C)).length>=1&&(i=null,s=null)):s=null),Hi()){if(n=yield Vw(e||"me",re.photos.stores.users),n&&Xc()>Date.now()-n.timeCached)o=n.photo;else if(n)try{let p=yield r.api(`${d}/photo`).get();p?.["@odata.mediaEtag"]&&p["@odata.mediaEtag"]===n.eTag?(yield rd(e||"me",re.photos.stores.users,n),o=n.photo):n=null}catch(p){qw(p)&&(p.code==="ErrorItemNotFound"||p.code==="ImageNotFound")&&(yield rd(e||"me",re.photos.stores.users,{eTag:null,photo:null}))}}if(!n&&!s){let p,v=r.createBatch();e?(v.get("user",`/users/${e}${t?"?$select="+t.toString():""}`,["user.readbasic.all"]),v.get("photo",`users/${e}/photo/$value`,["user.readbasic.all"])):(v.get("user","me",["user.read"]),v.get("photo","me/photo/$value",["user.read"]));let C=yield v.executeAll(),x=C.get("photo");x&&(p=x.headers.ETag,o=x.content);let E=C.get("user");E&&(i=E.content),Ni()&&(yield ye.getCache(re.users,re.users.stores.users).putValue(e||"me",{user:JSON.stringify(i)})),Hi()&&(yield rd(e||"me",re.photos.stores.users,{eTag:p,photo:o}))}else if(n){if(!s)try{let p=yield r.api(u).middlewareOptions(vt(...h)).get();p&&(Ni()&&(yield ye.getCache(re.users,re.users.stores.users).putValue(e||"me",{user:JSON.stringify(p)})),i=p)}catch{}}else try{let p=yield ed(r,d,h);p&&(Hi()&&(yield rd(e||"me",re.photos.stores.users,{eTag:p.eTag,photo:p.photo})),o=p.photo)}catch{}return i&&(i.personImage=o),i})});var be,es=y(()=>{a();l();c();(function(r){r[r.image=2]="image",r[r.oneline=3]="oneline",r[r.twolines=4]="twolines",r[r.threelines=5]="threelines",r[r.fourlines=6]="fourlines"})(be||(be={}))});var jw,Kw=y(()=>{a();l();c();ut();jw=[xt`

`]});var Ww,Qw,zg=y(()=>{a();l();c();Kw();Ww=document.createElement("style");Ww.appendChild(document.createTextNode(`
@font-face {
    font-family: 'FabricMDL2Icons';
    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),
    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format("woff"),
    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format("truetype");
}
`));document.head.appendChild(Ww);Qw=document.createElement("style");Qw.innerHTML=jw.toString();document.head.appendChild(Qw)});var D,Ce,wi=y(()=>{a();l();c();ut();(function(r){r[r.ArrowDown=0]="ArrowDown",r[r.TeamSeparator=1]="TeamSeparator",r[r.Search=2]="Search",r[r.SkypeArrow=3]="SkypeArrow",r[r.SmallEmail=4]="SmallEmail",r[r.SmallEmailHovered=5]="SmallEmailHovered",r[r.SmallChat=6]="SmallChat",r[r.SmallChatHovered=7]="SmallChatHovered",r[r.Video=8]="Video",r[r.VideoHovered=9]="VideoHovered",r[r.ExpandDown=10]="ExpandDown",r[r.Overview=11]="Overview",r[r.Send=12]="Send",r[r.Contact=13]="Contact",r[r.Copy=14]="Copy",r[r.Phone=15]="Phone",r[r.CellPhone=16]="CellPhone",r[r.Chat=17]="Chat",r[r.Call=18]="Call",r[r.CallHovered=19]="CallHovered",r[r.Confirmation=20]="Confirmation",r[r.Department=21]="Department",r[r.Email=22]="Email",r[r.OfficeLocation=23]="OfficeLocation",r[r.Person=24]="Person",r[r.Messages=25]="Messages",r[r.Organization=26]="Organization",r[r.ExpandRight=27]="ExpandRight",r[r.Profile=28]="Profile",r[r.Birthday=29]="Birthday",r[r.File=30]="File",r[r.Files=31]="Files",r[r.Back=32]="Back",r[r.Close=33]="Close",r[r.Upload=34]="Upload",r[r.FileCloud=35]="FileCloud",r[r.DragFile=36]="DragFile",r[r.Cancel=37]="Cancel",r[r.CheckMark=38]="CheckMark",r[r.Success=39]="Success",r[r.Fail=40]="Fail",r[r.SelectAccount=41]="SelectAccount",r[r.News=42]="News",r[r.DoubleBookmark=43]="DoubleBookmark",r[r.ChevronLeft=44]="ChevronLeft",r[r.ChevronRight=45]="ChevronRight",r[r.Event=46]="Event",r[r.BookOpen=47]="BookOpen",r[r.FileOuter=48]="FileOuter",r[r.BookQuestion=49]="BookQuestion",r[r.Globe=50]="Globe",r[r.Delete=51]="Delete",r[r.Add=52]="Add",r[r.Calendar=53]="Calendar",r[r.Planner=54]="Planner",r[r.Milestone=55]="Milestone",r[r.PersonAdd=56]="PersonAdd",r[r.PresenceAvailable=57]="PresenceAvailable",r[r.PresenceOofAvailable=58]="PresenceOofAvailable",r[r.PresenceBusy=59]="PresenceBusy",r[r.PresenceOofBusy=60]="PresenceOofBusy",r[r.PresenceDnd=61]="PresenceDnd",r[r.PresenceOofDnd=62]="PresenceOofDnd",r[r.PresenceAway=63]="PresenceAway",r[r.PresenceOofAway=64]="PresenceOofAway",r[r.PresenceOffline=65]="PresenceOffline",r[r.PresenceStatusUnknown=66]="PresenceStatusUnknown"})(D||(D={}));Ce=(r,e)=>{switch(r){case D.ArrowDown:return T`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case D.TeamSeparator:return T`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${e}
          />
        </svg>
      `;case D.Search:return T`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.30887 8.01596C6.53903 8.63179 5.56252 9.00004 4.5 9.00004C2.01472 9.00004 0 6.98531 0 4.50002C0 2.01473 2.01472 0 4.5 0C6.98528 0 9 2.01473 9 4.50002C9 5.56252 8.63177 6.53901 8.01597 7.30885L11.8536 11.1464C12.0488 11.3417 12.0488 11.6583 11.8536 11.8536C11.6583 12.0488 11.3417 12.0488 11.1464 11.8536L7.30887 8.01596ZM8 4.50002C8 2.56701 6.433 1 4.5 1C2.567 1 1 2.56701 1 4.50002C1 6.43302 2.567 8.00003 4.5 8.00003C6.433 8.00003 8 6.43302 8 4.50002Z" fill="currentColor"/>
        </svg>`;case D.SkypeArrow:return T`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case D.SmallEmail:return T`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M16 3.373V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 -7.62939e-05 11.8807 -7.62939e-05 10.5V3.373L7.74649 7.93097C7.90297 8.02301 8.09704 8.02301 8.25351 7.93097L16 3.373ZM13.5 0C14.7871 0 15.847 0.972604 15.9848 2.22293L8 6.91991L0.0151832 2.22293C0.15304 0.972604 1.21294 0 2.5 0H13.5Z" fill="currentColor"/>
          <path class="regular" d="M13.608 0.833496C14.9887 0.833496 16.108 1.95278 16.108 3.3335V11.3335C16.108 12.7142 14.9887 13.8335 13.608 13.8335H2.60803C1.22732 13.8335 0.108032 12.7142 0.108032 11.3335V3.3335C0.108032 1.95278 1.22732 0.833496 2.60803 0.833496H13.608ZM15.108 4.7945L8.36154 8.76446C8.23115 8.84117 8.07464 8.85395 7.93554 8.80281L7.85452 8.76446L1.10803 4.7965V11.3335C1.10803 12.1619 1.77961 12.8335 2.60803 12.8335H13.608C14.4365 12.8335 15.108 12.1619 15.108 11.3335V4.7945ZM13.608 1.8335H2.60803C1.77961 1.8335 1.10803 2.50507 1.10803 3.3335V3.6355L8.10803 7.75341L15.108 3.6345V3.3335C15.108 2.50507 14.4365 1.8335 13.608 1.8335Z" fill="currentColor"/>
        </svg>
      `;case D.SmallChat:return T`
        <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8.5 9H5.5L5.41012 9.00806C5.17688 9.05039 5 9.25454 5 9.5C5 9.74546 5.17688 9.94961 5.41012 9.99194L5.5 10H8.5L8.58988 9.99194C8.82312 9.94961 9 9.74546 9 9.5C9 9.25454 8.82312 9.05039 8.58988 9.00806L8.5 9ZM10.5 6H5.5L5.41012 6.00806C5.17688 6.05039 5 6.25454 5 6.5C5 6.74546 5.17688 6.94961 5.41012 6.99194L5.5 7H10.5L10.5899 6.99194C10.8231 6.94961 11 6.74546 11 6.5C11 6.25454 10.8231 6.05039 10.5899 6.00806L10.5 6Z" fill="currentColor"/>
          <path class="regular" d="M8.38599 0.833496C12.8043 0.833496 16.386 4.41522 16.386 8.8335C16.386 13.2518 12.8043 16.8335 8.38599 16.8335C7.11277 16.8335 5.8819 16.5353 4.77267 15.9728L4.65199 15.9085L1.00708 16.8186C0.697255 16.8959 0.41221 16.6704 0.387296 16.3773L0.387128 16.2959L0.400919 16.2122L1.31099 12.5685L1.24768 12.4488C0.792589 11.5521 0.510317 10.5757 0.418733 9.56176L0.393362 9.17984L0.385986 8.8335C0.385986 4.41522 3.96771 0.833496 8.38599 0.833496ZM8.38599 1.8335C4.51999 1.8335 1.38599 4.9675 1.38599 8.8335C1.38599 10.0505 1.69653 11.2213 2.27951 12.2584C2.32645 12.3419 2.34809 12.4365 2.34291 12.5308L2.32873 12.6247L1.57299 15.6455L4.59703 14.8918C4.65892 14.8764 4.72261 14.8731 4.78472 14.8814L4.87629 14.9026L4.963 14.941C5.9996 15.5233 7.16969 15.8335 8.38599 15.8335C12.252 15.8335 15.386 12.6995 15.386 8.8335C15.386 4.9675 12.252 1.8335 8.38599 1.8335ZM8.88599 9.8335C9.16213 9.8335 9.38599 10.0574 9.38599 10.3335C9.38599 10.579 9.20911 10.7831 8.97586 10.8254L8.88599 10.8335H5.88599C5.60984 10.8335 5.38599 10.6096 5.38599 10.3335C5.38599 10.088 5.56286 9.88389 5.79611 9.84155L5.88599 9.8335H8.88599ZM10.886 6.8335C11.1621 6.8335 11.386 7.05735 11.386 7.3335C11.386 7.57896 11.2091 7.7831 10.9759 7.82544L10.886 7.8335L5.88599 7.8335C5.60984 7.8335 5.38599 7.60964 5.38599 7.3335C5.38599 7.08804 5.56286 6.88389 5.79611 6.84155L5.88599 6.8335L10.886 6.8335Z" fill="currentColor"/>
        </svg>
      `;case D.Video:return T`
        <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="filled" d="M11 2.5C11 1.11929 9.88071 0 8.5 0H2.5C1.11929 0 0 1.11929 0 2.5V9.5C0 10.8807 1.11929 12 2.5 12H8.5C9.88071 12 11 10.8807 11 9.5V2.5ZM12 3.93082V8.08149L14.7642 10.4319C15.2512 10.8461 16 10.4999 16 9.86055V2.19315C16 1.55685 15.2575 1.20962 14.7692 1.61756L12 3.93082Z" fill="currentColor"/>
          <path class="regular" d="M2.72095 0.833496C1.34024 0.833496 0.220947 1.95278 0.220947 3.3335V10.3335C0.220947 11.7142 1.34024 12.8335 2.72095 12.8335H9.72095C11.1017 12.8335 12.2209 11.7142 12.2209 10.3335V9.33348L14.6209 11.1335C15.2802 11.6279 16.2209 11.1575 16.2209 10.3335V3.33348C16.2209 2.50944 15.2802 2.03905 14.6209 2.53348L12.2209 4.33348V3.3335C12.2209 1.95278 11.1017 0.833496 9.72095 0.833496H2.72095ZM12.2209 5.58348L15.2209 3.33348V10.3335L12.2209 8.08348V5.58348ZM11.2209 3.3335V10.3335C11.2209 11.1619 10.5494 11.8335 9.72095 11.8335H2.72095C1.89252 11.8335 1.22095 11.1619 1.22095 10.3335V3.3335C1.22095 2.50507 1.89252 1.8335 2.72095 1.8335H9.72095C10.5494 1.8335 11.2209 2.50507 11.2209 3.3335Z" fill="currentColor"/>
        </svg>
      `;case D.ExpandDown:return T`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="currentColor" />
        </svg>
      `;case D.Overview:return T`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.5 10.5C2.67157 10.5 2 9.82843 2 9V4C2 3.17157 2.67157 2.5 3.5 2.5H12.5C13.3284 2.5 14 3.17157 14 4V9C14 9.82843 13.3284 10.5 12.5 10.5H3.5ZM3.5 3.5C3.22386 3.5 3 3.72386 3 4V5.5H13V4C13 3.72386 12.7761 3.5 12.5 3.5H3.5ZM5 6.5H3V9C3 9.27614 3.22386 9.5 3.5 9.5H5V6.5ZM6 9.5H12.5C12.7761 9.5 13 9.27614 13 9V6.5H6V9.5ZM0 3C0 1.61929 1.11929 0.5 2.5 0.5H13.5C14.8807 0.5 16 1.61929 16 3V10C16 11.3807 14.8807 12.5 13.5 12.5H2.5C1.11929 12.5 0 11.3807 0 10V3ZM2.5 1.5C1.67157 1.5 1 2.17157 1 3V10C1 10.8284 1.67157 11.5 2.5 11.5H13.5C14.3284 11.5 15 10.8284 15 10V3C15 2.17157 14.3284 1.5 13.5 1.5H2.5Z" fill="#717171"/>
        </svg>
      `;case D.Send:return T`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case D.Contact:return T`
        <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5ZM2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879ZM9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5ZM0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z" fill="#717171"/>
        </svg>
      `;case D.Call:return T`
        <svg width="13" height="17" viewBox="0 0 13 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M3.98706 1.06589C4.89545 0.792081 5.86254 1.19479 6.31418 2.01224L6.38841 2.16075L7.04987 3.63213C7.46246 4.54992 7.28209 5.61908 6.60754 6.3496L6.47529 6.48248L5.43194 7.45541C5.24417 7.63298 5.38512 8.32181 6.06527 9.49986C6.67716 10.5597 7.17487 11.0552 7.41986 11.0823L7.4628 11.082L7.5158 11.0716L9.56651 10.4446C10.1332 10.2713 10.7438 10.4487 11.1298 10.8865L11.2215 11.0014L12.5781 12.8815C13.1299 13.6462 13.0689 14.6842 12.4533 15.378L12.3314 15.5039L11.7886 16.018C10.7948 16.9592 9.34348 17.2346 8.07389 16.7231C6.13867 15.9433 4.38077 14.1607 2.78368 11.3945C1.18323 8.62242 0.519004 6.20438 0.815977 4.13565C0.99977 2.85539 1.87301 1.78674 3.07748 1.3462L3.27036 1.28192L3.98706 1.06589Z" fill="currentColor"/>
          <path class="regular" d="M3.9292 0.399388L3.2125 0.615419C1.90898 1.00834 0.951582 2.1215 0.758116 3.46915C0.461142 5.53787 1.12537 7.95591 2.72582 10.728C4.32291 13.4942 6.0808 15.2768 8.01603 16.0565C9.28562 16.5681 10.7369 16.2927 11.7308 15.3515L12.2736 14.8374C13.0011 14.1485 13.1065 13.0275 12.5202 12.215L11.1636 10.3349C10.788 9.81423 10.1226 9.59039 9.50865 9.7781L7.45794 10.4051L7.40494 10.4154C7.17877 10.4485 6.65754 9.95942 6.00741 8.83335C5.32726 7.65531 5.1863 6.96648 5.37408 6.7889L6.41743 5.81598C7.19937 5.08681 7.43039 3.94078 6.99201 2.96562L6.33055 1.49424C5.91866 0.578005 4.89102 0.109471 3.9292 0.399388ZM5.41847 1.90427L6.07993 3.37564C6.34277 3.96031 6.20426 4.64744 5.73543 5.08463L4.68953 6.05994C4.02044 6.69268 4.24206 7.77567 5.14138 9.33335C5.98759 10.799 6.75958 11.5233 7.58908 11.3977L7.71341 11.3711L9.80102 10.7344C10.0057 10.6718 10.2275 10.7464 10.3527 10.92L11.7093 12.8001C12.0024 13.2064 11.9497 13.7669 11.586 14.1113L11.0432 14.6254C10.3333 15.2977 9.29663 15.4944 8.38977 15.129C6.6917 14.4448 5.08689 12.8175 3.59185 10.228C2.09375 7.63319 1.48745 5.42604 1.74797 3.61125C1.88616 2.64864 2.57001 1.85352 3.5011 1.57287L4.2178 1.35684C4.69871 1.21188 5.21253 1.44615 5.41847 1.90427Z" fill="currentColor"/>
        </svg>
      `;case D.Confirmation:return T`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.03212 13.9072L3.56056 10.0017C3.28538 9.69214 2.81132 9.66425 2.50174 9.93944C2.19215 10.2146 2.16426 10.6887 2.43945 10.9983L6.43945 15.4983C6.72614 15.8208 7.2252 15.8355 7.53034 15.5303L18.0303 5.03033C18.3232 4.73744 18.3232 4.26256 18.0303 3.96967C17.7374 3.67678 17.2626 3.67678 16.9697 3.96967L7.03212 13.9072Z" fill="#009E00"/>
      </svg>
      `;case D.Copy:return T`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case D.Phone:return T`
        <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" fill="none">
            <path d="M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z" fill="${e}"></path>
        </svg>
      `;case D.CellPhone:return T`
        <svg width="10" height="16" viewBox="0 0 10 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 12C3.72386 12 3.5 12.2239 3.5 12.5C3.5 12.7761 3.72386 13 4 13H6C6.27614 13 6.5 12.7761 6.5 12.5C6.5 12.2239 6.27614 12 6 12H4ZM2 0C0.89543 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H8C9.10457 16 10 15.1046 10 14V2C10 0.89543 9.10457 0 8 0H2ZM1 2C1 1.44772 1.44772 1 2 1H8C8.55228 1 9 1.44772 9 2V14C9 14.5523 8.55228 15 8 15H2C1.44772 15 1 14.5523 1 14V2Z" fill="#717171"/>
        </svg>
      `;case D.Chat:return T`
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7L5.5 7C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6L10.5 6Z" fill="#717171"/>
        </svg>
      `;case D.Department:return T`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 1.5V3H2C0.895431 3 0 3.89543 0 5V12C0 13.1046 0.895432 14 2 14H14.0026C15.1071 14 16.0026 13.1046 16.0026 12V5C16.0026 3.89543 15.1071 3 14.0026 3H12V1.5C12 0.671573 11.3284 0 10.5 0H5.5C4.67157 0 4 0.671573 4 1.5ZM5.5 1H10.5C10.7761 1 11 1.22386 11 1.5V3H5V1.5C5 1.22386 5.22386 1 5.5 1ZM2 4H14.0026C14.5549 4 15.0026 4.44772 15.0026 5V7H12L12 6.50073C12 6.22459 11.7761 6.00073 11.5 6.00073C11.2239 6.00073 11 6.22459 11 6.50074L11 7H5V6.50073C5 6.22459 4.77614 6.00073 4.5 6.00073C4.22386 6.00073 4 6.22459 4 6.50073V7H1V5C1 4.44772 1.44772 4 2 4ZM11 8L11 8.5C11 8.77615 11.2239 9 11.5 9C11.7762 9 12 8.77614 12 8.5L12 8H15.0026V12C15.0026 12.5523 14.5549 13 14.0026 13H2C1.44772 13 1 12.5523 1 12V8H4V8.5C4 8.77614 4.22386 9 4.5 9C4.77614 9 5 8.77614 5 8.5V8H11Z" fill="#717171"/>
        </svg>
      `;case D.Email:return T`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case D.OfficeLocation:return T`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <title>Location icon</title>
          <path d="M10 7C10 8.65685 8.65685 10 7 10C5.34315 10 4 8.65685 4 7C4 5.34315 5.34315 4 7 4C8.65685 4 10 5.34315 10 7ZM9 7C9 5.89543 8.10457 5 7 5C5.89543 5 5 5.89543 5 7C5 8.10457 5.89543 9 7 9C8.10457 9 9 8.10457 9 7ZM11.9497 11.955C14.6834 9.2201 14.6834 4.78601 11.9497 2.05115C9.21608 -0.683716 4.78392 -0.683716 2.05025 2.05115C-0.683418 4.78601 -0.683418 9.2201 2.05025 11.955L3.57128 13.4538L5.61408 15.4389L5.74691 15.5567C6.52168 16.1847 7.65623 16.1455 8.38611 15.4391L10.8223 13.0691L11.9497 11.955ZM2.75499 2.75619C5.09944 0.410715 8.90055 0.410715 11.245 2.75619C13.5294 5.04153 13.5879 8.71039 11.4207 11.0667L11.245 11.2499L9.92371 12.5539L7.69315 14.7225L7.60016 14.8021C7.24594 15.0699 6.7543 15.0698 6.40012 14.802L6.30713 14.7224L3.3263 11.817L2.75499 11.2499L2.57927 11.0667C0.412077 8.71039 0.47065 5.04153 2.75499 2.75619Z" fill="#717171"/>
        </svg>
      `;case D.Birthday:return T`
        <svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.81357 0.667333C6.07581 0.320242 6.48151 0 7 0C7.51849 0 7.92419 0.320242 8.18643 0.667333C8.45471 1.0224 8.63508 1.47991 8.69561 1.93392C8.75552 2.3832 8.70532 2.89341 8.42852 3.3086C8.134 3.75039 7.63965 4 7 4C6.36035 4 5.866 3.75039 5.57148 3.3086C5.29468 2.89341 5.24448 2.3832 5.30439 1.93392C5.36492 1.47991 5.54529 1.0224 5.81357 0.667333ZM6.40353 2.7539C6.484 2.87461 6.63965 3 7 3C7.36035 3 7.516 2.87461 7.59647 2.7539C7.69468 2.60659 7.74448 2.3668 7.70439 2.06608C7.66492 1.77009 7.54529 1.4776 7.38857 1.27017C7.22581 1.05476 7.08151 1 7 1C6.91849 1 6.77419 1.05476 6.61143 1.27017C6.45471 1.4776 6.33508 1.77009 6.29561 2.06608C6.25552 2.3668 6.30532 2.60659 6.40353 2.7539ZM1 7C1 5.89543 1.89543 5 3 5H11C12.1046 5 13 5.89543 13 7V12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H0.5C0.223858 13 0 12.7761 0 12.5C0 12.2239 0.223858 12 0.5 12H1V7ZM2 12H12V9.01931C11.9109 9.10285 11.8174 9.18842 11.7208 9.27412C11.4006 9.55804 11.0346 9.85319 10.6715 10.0802C10.3274 10.2953 9.90815 10.5 9.5 10.5C8.77182 10.5 8.30806 9.98986 8.00471 9.65617C7.9834 9.63273 7.96289 9.61016 7.94312 9.58869C7.5876 9.20261 7.35769 9 7 9C6.64231 9 6.4124 9.20261 6.05688 9.58869C6.03711 9.61016 6.0166 9.63273 5.99529 9.65617C5.69194 9.98986 5.22818 10.5 4.5 10.5C4.10587 10.5 3.69263 10.2897 3.35907 10.0789C3.00198 9.85313 2.63516 9.55951 2.31117 9.27666C2.20329 9.18247 2.09896 9.08844 2 8.9971V12ZM2 7.59993C2.05039 7.65198 2.11363 7.71652 2.1873 7.7902C2.38843 7.99132 2.6649 8.25801 2.96883 8.52334C3.27484 8.79049 3.59802 9.04687 3.89343 9.23362C4.21237 9.43525 4.41413 9.5 4.5 9.5C4.75817 9.5 4.93171 9.33433 5.32125 8.91131L5.32447 8.90781C5.65956 8.5439 6.16039 8 7 8C7.83961 8 8.34044 8.5439 8.67553 8.90781L8.67875 8.91131C9.06828 9.33433 9.24183 9.5 9.5 9.5C9.6106 9.5 9.82569 9.42967 10.1414 9.23229C10.4381 9.04681 10.7573 8.79196 11.0573 8.52588C11.3554 8.26163 11.6238 7.99594 11.8184 7.7955C11.89 7.72165 11.9513 7.65703 12 7.60506V7C12 6.44772 11.5523 6 11 6H3C2.44772 6 2 6.44772 2 7V7.59993Z" fill="#717171"/>
        </svg>
      `;case D.Person:return T`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case D.Messages:return T`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case D.Organization:return T`
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.99992 0C6.34271 0 4.99927 1.34344 4.99927 3.00066C4.99927 4.48754 6.08073 5.72183 7.49999 5.95985V7.5H4.5C3.67157 7.5 3 8.17157 3 9V10.0416C1.5811 10.2799 0.5 11.514 0.5 13.0007C0.5 14.6579 1.84344 16.0013 3.50066 16.0013C5.15787 16.0013 6.50131 14.6579 6.50131 13.0007C6.50131 11.5136 5.41954 10.2791 4 10.0414V9C4 8.72386 4.22386 8.5 4.5 8.5H11.5C11.7761 8.5 12 8.72386 12 9V10.0416C10.5811 10.2799 9.5 11.514 9.5 13.0007C9.5 14.6579 10.8434 16.0013 12.5007 16.0013C14.1579 16.0013 15.5013 14.6579 15.5013 13.0007C15.5013 11.5136 14.4195 10.2791 13 10.0414V9C13 8.17157 12.3284 7.5 11.5 7.5H8.49999V5.95983C9.91918 5.72176 11.0006 4.48749 11.0006 3.00066C11.0006 1.34344 9.65714 0 7.99992 0ZM5.99927 3.00066C5.99927 1.89572 6.89499 1 7.99992 1C9.10485 1 10.0006 1.89572 10.0006 3.00066C10.0006 4.10559 9.10485 5.00131 7.99992 5.00131C6.89499 5.00131 5.99927 4.10559 5.99927 3.00066ZM1.5 13.0007C1.5 11.8957 2.39572 11 3.50066 11C4.60559 11 5.50131 11.8957 5.50131 13.0007C5.50131 14.1056 4.60559 15.0013 3.50066 15.0013C2.39572 15.0013 1.5 14.1056 1.5 13.0007ZM12.5007 11C13.6056 11 14.5013 11.8957 14.5013 13.0007C14.5013 14.1056 13.6056 15.0013 12.5007 15.0013C11.3957 15.0013 10.5 14.1056 10.5 13.0007C10.5 11.8957 11.3957 11 12.5007 11Z" fill="#717171"/>
        </svg>
      `;case D.ExpandRight:return T`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case D.Profile:return T`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case D.File:return T`
        <svg width="28" height="28" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case D.Files:return T`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.9956 4.07309V4C14.9956 2.61929 13.8763 1.5 12.4956 1.5H7.66418L6.06391 0.299946C5.80428 0.105247 5.48851 0 5.16399 0H2.5C1.11916 0 -0.000181445 1.11949 2.20615e-08 2.50033L0.0011832 11.4978C0.00135142 12.7772 0.962583 13.8321 2.2023 13.9798C2.2867 13.9945 2.37375 14.0021 2.46289 14.0021H13.1798C13.8981 14.0021 14.5156 13.4929 14.6524 12.7877L16.0097 5.78769C16.1587 5.01967 15.696 4.29703 14.9956 4.07309ZM2.5 1H5.16399C5.27216 1 5.37742 1.03508 5.46396 1.09998L7.19756 2.40002C7.2841 2.46492 7.38936 2.5 7.49753 2.5H12.4956C13.324 2.5 13.9956 3.17157 13.9956 4V4.00214H3.824C3.10596 4.00214 2.48863 4.511 2.35158 5.21583L1.05351 11.8916C1.01941 11.7661 1.0012 11.634 1.00118 11.4976L1 2.5002C0.999891 1.67169 1.6715 1 2.5 1ZM3.33319 5.4067C3.37888 5.17176 3.58465 5.00214 3.824 5.00214H14.5372C14.8515 5.00214 15.0879 5.28874 15.028 5.59732L13.6706 12.5973C13.6251 12.8324 13.4192 13.0021 13.1798 13.0021H2.46289C2.14845 13.0021 1.91206 12.7154 1.97208 12.4067L3.33319 5.4067Z" fill="#717171"/>
        </svg>
      `;case D.Back:return T`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `;case D.Close:return T`
        <svg width="10" height="10" viewBox="0 0 10 10" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.73838 5.032L9.70337 1.067L8.99638 0.360001L5.03137 4.325L1.06637 0.360001L0.359375 1.067L4.32438 5.032L0.359375 8.997L1.06637 9.704L5.03137 5.739L8.99638 9.704L9.70337 8.997L5.73838 5.032Z" fill="currentColor"/>
        </svg>
     `;case D.Upload:return T`
        <svg class="upload-icon" width="21" height="12" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4.5 2C4.08579 2 3.75 2.33579 3.75 2.75C3.75 3.16421 4.08579 3.5 4.5 3.5H15C15.4142 3.5 15.75 3.16421 15.75 2.75C15.75 2.33579 15.4142 2 15 2H4.5ZM10.4963 17.3493C10.4466 17.7154 10.1328 17.9976 9.75311 17.9976C9.3389 17.9976 9.00311 17.6618 9.00311 17.2476L9.00249 7.05856L6.02995 10.026L5.94578 10.0986C5.65202 10.3162 5.23537 10.2917 4.96929 10.0253C4.67661 9.73215 4.67695 9.25728 4.97005 8.96459L9.25962 4.67989C9.33377 4.61512 9.42089 4.56485 9.5169 4.53385L9.59777 4.51072C9.64749 4.50019 9.69837 4.4947 9.74849 4.4947L9.80855 4.49661L9.87781 4.50451L9.99828 4.53462L10.0895 4.57254L10.1259 4.59371L10.2169 4.6523L10.2875 4.71481L14.5303 8.96546L14.6029 9.04964C14.8205 9.34345 14.7959 9.7601 14.5294 10.0261L14.4452 10.0987C14.1514 10.3162 13.7347 10.2917 13.4687 10.0251L10.5025 7.05456L10.5031 17.2476L10.4963 17.3493Z" fill="#ffffff"/>
        </svg>
      `;case D.FileCloud:return T`
        <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">
          <path
            d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"
          />
        </svg>
      `;case D.DragFile:return T`
        <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z"
          />
        </svg>
      `;case D.Cancel:return T`
        <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.588591 0.715694L0.646447 0.646447C0.820013 0.47288 1.08944 0.453595 1.28431 0.588591L1.35355 0.646447L6 5.293L10.6464 0.646447C10.8417 0.451185 11.1583 0.451185 11.3536 0.646447C11.5488 0.841709 11.5488 1.15829 11.3536 1.35355L6.707 6L11.3536 10.6464C11.5271 10.82 11.5464 11.0894 11.4114 11.2843L11.3536 11.3536C11.18 11.5271 10.9106 11.5464 10.7157 11.4114L10.6464 11.3536L6 6.707L1.35355 11.3536C1.15829 11.5488 0.841709 11.5488 0.646447 11.3536C0.451185 11.1583 0.451185 10.8417 0.646447 10.6464L5.293 6L0.646447 1.35355C0.47288 1.17999 0.453595 0.910563 0.588591 0.715694L0.646447 0.646447L0.588591 0.715694Z" fill="currentColor"/>
        </svg>
     `;case D.Success:return T`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>
          <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>
        </svg>
      `;case D.CheckMark:return T`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="filled" d="M10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0ZM13.2197 6.96967L8.75 11.4393L6.78033 9.46967C6.48744 9.17678 6.01256 9.17678 5.71967 9.46967C5.42678 9.76256 5.42678 10.2374 5.71967 10.5303L8.21967 13.0303C8.51256 13.3232 8.98744 13.3232 9.28033 13.0303L14.2803 8.03033C14.5732 7.73744 14.5732 7.26256 14.2803 6.96967C13.9874 6.67678 13.5126 6.67678 13.2197 6.96967Z" fill="currentColor"/>
        <path class="regular" d="M10 1.5C5.30558 1.5 1.5 5.30558 1.5 10C1.5 14.6944 5.30558 18.5 10 18.5C14.6944 18.5 18.5 14.6944 18.5 10C18.5 5.30558 14.6944 1.5 10 1.5ZM0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10Z" fill="currentColor"/>
      </svg>
      `;case D.Fail:return T`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>
          <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />
        </svg>
      `;case D.SelectAccount:return T`
    <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
      <path fill=${e} d="M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM10.5 15C12.9853 15 15 12.9853 15 10.5C15 8.01472 12.9853 6 10.5 6C8.01472 6 6 8.01472 6 10.5C6 12.9853 8.01472 15 10.5 15ZM10.5 8C10.7761 8 11 8.22386 11 8.5V10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H11V12.5C11 12.7761 10.7761 13 10.5 13C10.2239 13 10 12.7761 10 12.5V11H8.5C8.22386 11 8 10.7761 8 10.5C8 10.2239 8.22386 10 8.5 10H10V8.5C10 8.22386 10.2239 8 10.5 8Z"/>
    </svg>
  `;case D.News:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.75 20H5.25C3.51697 20 2.10075 18.6435 2.00514 16.9344L2 16.75V6.25C2 5.05914 2.92516 4.08436 4.09595 4.00519L4.25 4H16.75C17.9409 4 18.9156 4.92516 18.9948 6.09595L19 6.25V7H19.75C20.9409 7 21.9156 7.92516 21.9948 9.09595L22 9.25V16.75C22 18.483 20.6435 19.8992 18.9344 19.9949L18.75 20H5.25H18.75ZM5.25 18.5H18.75C19.6682 18.5 20.4212 17.7929 20.4942 16.8935L20.5 16.75V9.25C20.5 8.8703 20.2178 8.55651 19.8518 8.50685L19.75 8.5H19V16.25C19 16.6297 18.7178 16.9435 18.3518 16.9932L18.25 17C17.8703 17 17.5565 16.7178 17.5068 16.3518L17.5 16.25V6.25C17.5 5.8703 17.2178 5.55651 16.8518 5.50685L16.75 5.5H4.25C3.8703 5.5 3.55651 5.78215 3.50685 6.14823L3.5 6.25V16.75C3.5 17.6682 4.20711 18.4212 5.10647 18.4942L5.25 18.5H18.75H5.25ZM12.246 14.5H15.2522C15.6665 14.5 16.0022 14.8358 16.0022 15.25C16.0022 15.6297 15.7201 15.9435 15.354 15.9932L15.2522 16H12.246C11.8318 16 11.496 15.6642 11.496 15.25C11.496 14.8703 11.7782 14.5565 12.1442 14.5068L12.246 14.5H15.2522H12.246ZM9.24328 11.0045C9.6575 11.0045 9.99328 11.3403 9.99328 11.7545V15.25C9.99328 15.6642 9.6575 16 9.24328 16H5.74776C5.33355 16 4.99776 15.6642 4.99776 15.25V11.7545C4.99776 11.3403 5.33355 11.0045 5.74776 11.0045H9.24328ZM8.49328 12.5045H6.49776V14.5H8.49328V12.5045ZM12.246 11.0045H15.2522C15.6665 11.0045 16.0022 11.3403 16.0022 11.7545C16.0022 12.1342 15.7201 12.448 15.354 12.4976L15.2522 12.5045H12.246C11.8318 12.5045 11.496 12.1687 11.496 11.7545C11.496 11.3748 11.7782 11.061 12.1442 11.0113L12.246 11.0045H15.2522H12.246ZM5.74776 7.50247H15.2522C15.6665 7.50247 16.0022 7.83826 16.0022 8.25247C16.0022 8.63217 15.7201 8.94596 15.354 8.99563L15.2522 9.00247H5.74776C5.33355 9.00247 4.99776 8.66669 4.99776 8.25247C4.99776 7.87278 5.27991 7.55898 5.64599 7.50932L5.74776 7.50247H15.2522H5.74776Z" fill="none" />
      </svg>
      `;case D.DoubleBookmark:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 6.74814C4 5.50535 5.00742 4.49786 6.25013 4.49786H15.2506C16.4933 4.49786 17.5008 5.50535 17.5008 6.74814V21.2499C17.5008 21.5185 17.3572 21.7666 17.1243 21.9003C16.8914 22.0341 16.6048 22.0332 16.3728 21.8978L10.7504 18.6179L5.12797 21.8978C4.89599 22.0332 4.60936 22.0341 4.37648 21.9003C4.14359 21.7666 4 21.5185 4 21.2499V6.74814ZM6.25013 5.99805C5.83589 5.99805 5.50008 6.33387 5.50008 6.74814V19.944L10.3725 17.1016C10.606 16.9653 10.8948 16.9653 11.1283 17.1016L16.0007 19.944V6.74814C16.0007 6.33387 15.6649 5.99805 15.2506 5.99805H6.25013ZM15.2497 2C17.8732 2 20 4.12691 20 6.75058V18.6232C20 19.0374 19.6642 19.3733 19.25 19.3733C18.8357 19.3733 18.4999 19.0374 18.4999 18.6232V6.75058C18.4999 4.95543 17.0448 3.50018 15.2497 3.50018H6.63687C6.63687 3.50018 6.75016 2.94339 7.43379 2.41948C8.00023 2 8.60182 2 8.60182 2H15.2497Z" fill="none" />
        </svg>
      `;case D.ChevronLeft:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.5303 4.21967C15.8232 4.51256 15.8232 4.98744 15.5303 5.28033L8.81066 12L15.5303 18.7197C15.8232 19.0126 15.8232 19.4874 15.5303 19.7803C15.2374 20.0732 14.7626 20.0732 14.4697 19.7803L7.21967 12.5303C6.92678 12.2374 6.92678 11.7626 7.21967 11.4697L14.4697 4.21967C14.7626 3.92678 15.2374 3.92678 15.5303 4.21967Z" fill="none" />
        </svg>`;case D.ChevronRight:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z" fill="currentColor" />
        </svg>`;case D.Delete:return T`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.5 4H11.5C11.5 3.17157 10.8284 2.5 10 2.5C9.17157 2.5 8.5 3.17157 8.5 4ZM7.5 4C7.5 2.61929 8.61929 1.5 10 1.5C11.3807 1.5 12.5 2.61929 12.5 4H17.5C17.7761 4 18 4.22386 18 4.5C18 4.77614 17.7761 5 17.5 5H16.4456L15.2521 15.3439C15.0774 16.8576 13.7957 18 12.2719 18H7.72813C6.20431 18 4.92256 16.8576 4.7479 15.3439L3.55437 5H2.5C2.22386 5 2 4.77614 2 4.5C2 4.22386 2.22386 4 2.5 4H7.5ZM5.74131 15.2292C5.85775 16.2384 6.71225 17 7.72813 17H12.2719C13.2878 17 14.1422 16.2384 14.2587 15.2292L15.439 5H4.56101L5.74131 15.2292ZM8.5 7.5C8.77614 7.5 9 7.72386 9 8V14C9 14.2761 8.77614 14.5 8.5 14.5C8.22386 14.5 8 14.2761 8 14V8C8 7.72386 8.22386 7.5 8.5 7.5ZM12 8C12 7.72386 11.7761 7.5 11.5 7.5C11.2239 7.5 11 7.72386 11 8V14C11 14.2761 11.2239 14.5 11.5 14.5C11.7761 14.5 12 14.2761 12 14V8Z" fill="currentColor"/>
        </svg>
    `;case D.Add:return T`
        <svg width="16" height="15" viewBox="0 0 16 15" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.39563 0.5C8.39563 0.223858 8.17177 0 7.89563 0C7.61949 0 7.39563 0.223858 7.39563 0.5V7H0.89563C0.619487 7 0.39563 7.22386 0.39563 7.5C0.39563 7.77614 0.619487 8 0.89563 8H7.39563V14.5C7.39563 14.7761 7.61949 15 7.89563 15C8.17177 15 8.39563 14.7761 8.39563 14.5V8H14.8956C15.1718 8 15.3956 7.77614 15.3956 7.5C15.3956 7.22386 15.1718 7 14.8956 7H8.39563V0.5Z" fill="${e}"/>
        </svg>`;case D.Calendar:return T`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 11C7.55228 11 8 10.5523 8 10C8 9.44771 7.55228 9 7 9C6.44772 9 6 9.44771 6 10C6 10.5523 6.44772 11 7 11ZM8 13C8 13.5523 7.55228 14 7 14C6.44772 14 6 13.5523 6 13C6 12.4477 6.44772 12 7 12C7.55228 12 8 12.4477 8 13ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44771 10.5523 9 10 9C9.44771 9 9 9.44771 9 10C9 10.5523 9.44771 11 10 11ZM11 13C11 13.5523 10.5523 14 10 14C9.44771 14 9 13.5523 9 13C9 12.4477 9.44771 12 10 12C10.5523 12 11 12.4477 11 13ZM13 11C13.5523 11 14 10.5523 14 10C14 9.44771 13.5523 9 13 9C12.4477 9 12 9.44771 12 10C12 10.5523 12.4477 11 13 11ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM4 7H16V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V7ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V6H4V5.5C4 4.67157 4.67157 4 5.5 4Z" fill=${e}/>
        </svg>
    `;case D.Planner:return T`
        <svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm1.75 5.5h-15v9.25c0 .966.784 1.75 1.75 1.75h11.5a1.75 1.75 0 0 0 1.75-1.75V8.5Zm-11.75 6a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm-4.25-4a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm1.5-6H6.25A1.75 1.75 0 0 0 4.5 6.25V7h15v-.75a1.75 1.75 0 0 0-1.75-1.75Z" fill="${e}"/>
        </svg>`;case D.Milestone:return T`
        <svg width="24" height="24" fill="${e}" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.25 13c.966 0 1.75.784 1.75 1.75v4.5A1.75 1.75 0 0 1 15.25 21H3.75A1.75 1.75 0 0 1 2 19.25v-4.5c0-.966.783-1.75 1.75-1.75h11.5ZM21 14.899v5.351a.75.75 0 0 1-1.494.102l-.006-.102v-5.338a3.006 3.006 0 0 0 1.5-.013Zm-5.75-.399H3.75a.25.25 0 0 0-.25.25v4.5c0 .138.111.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25Zm5-4.408a1.908 1.908 0 1 1 0 3.816 1.908 1.908 0 0 1 0-3.816ZM15.244 3c.967 0 1.75.784 1.75 1.75v4.5a1.75 1.75 0 0 1-1.75 1.75h-11.5a1.75 1.75 0 0 1-1.75-1.75v-4.5a1.75 1.75 0 0 1 1.607-1.744L3.745 3h11.5Zm0 1.5h-11.5l-.057.007a.25.25 0 0 0-.193.243v4.5c0 .138.112.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25ZM20.25 3a.75.75 0 0 1 .743.648L21 3.75v5.351a3.004 3.004 0 0 0-1.5-.013V3.75a.75.75 0 0 1 .75-.75Z" fill="${e}"/>
        </svg>`;case D.PersonAdd:return T`
        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">
          <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>
          <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>
          <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>
        </svg>`;case D.Event:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.75 3C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25C3 4.45507 4.45507 3 6.25 3H17.75ZM19.5 8.5H4.5V17.75C4.5 18.7165 5.2835 19.5 6.25 19.5H17.75C18.7165 19.5 19.5 18.7165 19.5 17.75V8.5ZM7.75 14.5C8.44036 14.5 9 15.0596 9 15.75C9 16.4404 8.44036 17 7.75 17C7.05964 17 6.5 16.4404 6.5 15.75C6.5 15.0596 7.05964 14.5 7.75 14.5ZM12 14.5C12.6904 14.5 13.25 15.0596 13.25 15.75C13.25 16.4404 12.6904 17 12 17C11.3096 17 10.75 16.4404 10.75 15.75C10.75 15.0596 11.3096 14.5 12 14.5ZM7.75 10.5C8.44036 10.5 9 11.0596 9 11.75C9 12.4404 8.44036 13 7.75 13C7.05964 13 6.5 12.4404 6.5 11.75C6.5 11.0596 7.05964 10.5 7.75 10.5ZM12 10.5C12.6904 10.5 13.25 11.0596 13.25 11.75C13.25 12.4404 12.6904 13 12 13C11.3096 13 10.75 12.4404 10.75 11.75C10.75 11.0596 11.3096 10.5 12 10.5ZM16.25 10.5C16.9404 10.5 17.5 11.0596 17.5 11.75C17.5 12.4404 16.9404 13 16.25 13C15.5596 13 15 12.4404 15 11.75C15 11.0596 15.5596 10.5 16.25 10.5ZM17.75 4.5H6.25C5.2835 4.5 4.5 5.2835 4.5 6.25V7H19.5V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5Z" fill="none" />
        </svg>
      `;case D.BookOpen:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 19.1375C11.4986 19.6686 10.788 20 10 20H3.75C2.7835 20 2 19.2165 2 18.25V5.75C2 4.7835 2.7835 4 3.75 4H10C10.788 4 11.4986 4.33145 12 4.86253C12.5014 4.33145 13.212 4 14 4H20.25C21.2165 4 22 4.7835 22 5.75V18.25C22 19.2165 21.2165 20 20.25 20H14C13.212 20 12.5014 19.6686 12 19.1375ZM3.5 5.75V18.25C3.5 18.3881 3.61193 18.5 3.75 18.5H10C10.6904 18.5 11.25 17.9404 11.25 17.25V6.75C11.25 6.05964 10.6904 5.5 10 5.5H3.75C3.61193 5.5 3.5 5.61193 3.5 5.75ZM12.75 17.25C12.75 17.9404 13.3096 18.5 14 18.5H20.25C20.3881 18.5 20.5 18.3881 20.5 18.25V5.75C20.5 5.61193 20.3881 5.5 20.25 5.5H14C13.3096 5.5 12.75 6.05964 12.75 6.75V17.25Z" fill="none" />
        </svg>
      `;case D.FileOuter:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 2C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V9.82777C20 9.29733 19.7893 8.78863 19.4142 8.41355L13.5864 2.58579C13.2114 2.21071 12.7027 2 12.1722 2H6ZM5.5 4C5.5 3.72386 5.72386 3.5 6 3.5H12V8C12 9.10457 12.8954 10 14 10H18.5V20C18.5 20.2761 18.2761 20.5 18 20.5H6C5.72386 20.5 5.5 20.2761 5.5 20V4ZM17.3793 8.5H14C13.7239 8.5 13.5 8.27614 13.5 8V4.62066L17.3793 8.5Z" fill="none" />
        </svg>
      `;case D.BookQuestion:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.9998 8.01752C10.9905 8.42363 10.6584 8.74999 10.25 8.74999C9.5 8.74999 9.5 7.9989 9.5 7.9989L9.5 7.99777L9.50001 7.99539L9.50006 7.99017C9.50032 7.9755 9.50072 7.96084 9.50144 7.94618C9.50262 7.92198 9.50473 7.89159 9.50846 7.8559C9.51591 7.78477 9.52996 7.69092 9.55665 7.58186C9.60973 7.36492 9.71565 7.07652 9.92848 6.78906C10.3825 6.17582 11.1982 5.72727 12.513 5.7501C13.4627 5.76659 14.3059 6.16497 14.834 6.82047C15.371 7.48704 15.5517 8.3902 15.1964 9.27853C14.8342 10.1839 14.0149 10.5437 13.5442 10.7503L13.4932 10.7728C13.2147 10.8957 13.0813 10.9599 13.0013 11.024L13 11.0251L13 11.7492C13.0001 12.1634 12.6643 12.4999 12.2501 12.5C11.8359 12.5 11.5001 12.1643 11.5 11.7501L11.5 11C11.5 10.4769 11.752 10.1029 12.0633 9.85345C12.3134 9.65303 12.6276 9.51483 12.8491 9.4174L12.8875 9.40049C13.4292 9.16137 13.6868 9.01346 13.8036 8.72145C13.9483 8.35977 13.8789 8.02596 13.6659 7.76153C13.4439 7.48604 13.0371 7.25943 12.487 7.24988C11.5518 7.23364 11.2425 7.53509 11.134 7.68162C11.0656 7.77404 11.0309 7.86797 11.0137 7.93838C11.0052 7.973 11.0017 7.99908 11.0003 8.01197L10.9998 8.01752ZM12.25 15.5C12.8023 15.5 13.25 15.0523 13.25 14.5C13.25 13.9477 12.8023 13.5 12.25 13.5C11.6977 13.5 11.25 13.9477 11.25 14.5C11.25 15.0523 11.6977 15.5 12.25 15.5ZM4 4.5C4 3.11929 5.11929 2 6.5 2H18C19.3807 2 20.5 3.11929 20.5 4.5V18.75C20.5 19.1642 20.1642 19.5 19.75 19.5H5.5C5.5 20.0523 5.94772 20.5 6.5 20.5H19.75C20.1642 20.5 20.5 20.8358 20.5 21.25C20.5 21.6642 20.1642 22 19.75 22H6.5C5.11929 22 4 20.8807 4 19.5V4.5ZM5.5 4.5V18H19V4.5C19 3.94772 18.5523 3.5 18 3.5H6.5C5.94772 3.5 5.5 3.94772 5.5 4.5Z" fill="none" />
        </svg>
      `;case D.Globe:return T`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M12.0001 1.99805C17.5238 1.99805 22.0016 6.47589 22.0016 11.9996C22.0016 17.5233 17.5238 22.0011 12.0001 22.0011C6.47638 22.0011 1.99854 17.5233 1.99854 11.9996C1.99854 6.47589 6.47638 1.99805 12.0001 1.99805ZM14.939 16.4993H9.06118C9.71322 18.9135 10.8466 20.5011 12.0001 20.5011C13.1536 20.5011 14.2869 18.9135 14.939 16.4993ZM7.5084 16.4999L4.78591 16.4998C5.74425 18.0328 7.1777 19.2384 8.88008 19.9104C8.3578 19.0906 7.92681 18.0643 7.60981 16.8949L7.5084 16.4999ZM19.2143 16.4998L16.4918 16.4999C16.168 17.8337 15.7004 18.9995 15.119 19.9104C16.716 19.2804 18.0757 18.1814 19.0291 16.7833L19.2143 16.4998ZM7.09351 9.99895H3.7359L3.73115 10.0162C3.57906 10.6525 3.49854 11.3166 3.49854 11.9996C3.49854 13.0558 3.69112 14.0669 4.0431 14.9999L7.21626 14.9995C7.07396 14.0504 6.99854 13.0422 6.99854 11.9996C6.99854 11.3156 7.031 10.6464 7.09351 9.99895ZM15.397 9.99901H8.60316C8.53514 10.6393 8.49853 11.309 8.49853 11.9996C8.49853 13.0591 8.58468 14.0694 8.73827 14.9997H15.2619C15.4155 14.0694 15.5016 13.0591 15.5016 11.9996C15.5016 11.309 15.465 10.6393 15.397 9.99901ZM20.2647 9.99811L16.9067 9.99897C16.9692 10.6464 17.0016 11.3156 17.0016 11.9996C17.0016 13.0422 16.9262 14.0504 16.7839 14.9995L19.9571 14.9999C20.309 14.0669 20.5016 13.0558 20.5016 11.9996C20.5016 11.3102 20.4196 10.64 20.2647 9.99811ZM8.88114 4.08875L8.85823 4.09747C6.81092 4.91218 5.1549 6.49949 4.25023 8.49935L7.29835 8.49972C7.61171 6.74693 8.15855 5.221 8.88114 4.08875ZM12.0001 3.49805L11.8844 3.50335C10.619 3.6191 9.39651 5.62107 8.8288 8.4993H15.1714C14.6052 5.62914 13.388 3.63033 12.1264 3.50436L12.0001 3.49805ZM15.1201 4.08881L15.2269 4.2629C15.8961 5.37537 16.4043 6.83525 16.7018 8.49972L19.7499 8.49935C18.8853 6.58795 17.3343 5.05341 15.4113 4.21008L15.1201 4.08881Z" />
        </svg>
      `;case D.PresenceAvailable:return T`
        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm2.1-5.9L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 0 1 .7-.7l.65.64 1.9-1.9a.5.5 0 0 1 .7.71Z" fill="#13a10e"></path>
        </svg>`;case D.PresenceOofAvailable:return T`
        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm6.1-1.6c.2.2.2.5 0 .7L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 1 1 .7-.7l.65.64 1.9-1.9c.2-.19.5-.19.7 0Z" fill="#13a10e"></path>
        </svg>`;case D.PresenceBusy:return T`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M10 5A5 5 0 1 1 0 5a5 5 0 0 1 10 0Z" fill="#d13438"></path>
        </svg>`;case D.PresenceOofBusy:return T`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>
        </svg>
      `;case D.PresenceDnd:return T`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10ZM3.5 4.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z" fill="#d13438"></path>
        </svg>`;case D.PresenceOofDnd:return T`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm2 0c0-.28.22-.5.5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 3 5Z" fill="#d13438"></path>
        </svg>`;case D.PresenceAway:return T`
        <svg fill="#eaa300" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm0-7v1.8l1.35 1.35a.5.5 0 1 1-.7.7l-1.5-1.5A.5.5 0 0 1 4 5V3a.5.5 0 0 1 1 0Z" fill="#eaa300"></path>
        </svg>`;case D.PresenceOofAway:return T`
        <svg fill="#c239b3" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.35 3.85a.5.5 0 1 0-.7-.7l-1.5 1.5a.5.5 0 0 0 0 .7l1.5 1.5a.5.5 0 1 0 .7-.7L4.7 5.5h1.8a.5.5 0 1 0 0-1H4.7l.65-.65ZM5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Z" fill="#c239b3"></path>
        </svg>`;case D.PresenceOffline:return T`
        <svg fill="#929292" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.85 3.15c.2.2.2.5 0 .7L5.71 5l1.14 1.15a.5.5 0 1 1-.7.7L5 5.71 3.85 6.85a.5.5 0 1 1-.7-.7L4.29 5 3.15 3.85a.5.5 0 1 1 .7-.7L5 4.29l1.15-1.14c.2-.2.5-.2.7 0ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Zm5-4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z" fill="#929292"></path>
        </svg>`;case D.PresenceStatusUnknown:return T`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>
        </svg>`}}});var qg,Yw,Zw=y(()=>{a();l();c();qg=()=>window.getWindowSegments!==void 0,Yw=()=>qg()?window:null});var Jw,Xw=y(()=>{a();l();c();ut();Jw=[xt`
.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--mgt-flyout-box-shadow,var(--elevation-shadow-card-rest));border-radius:8px}.root .flyout.small{overflow:hidden auto}.root.visible .flyout{display:inline-block;animation-name:fade-in;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}.root.visible .flyout.small{overflow:hidden auto}@keyframes fade-in{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`]});var yl,ma,$h,wn,Mh=y(()=>{a();l();c();ut();Ao();ca();Zw();Xw();lt();lt();yl=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},ma=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},$h=()=>Nt("flyout",wn),wn=class extends Pr{static get styles(){return Jw}get isOpen(){return this._isOpen}set isOpen(e){this._isOpen!==e&&(this._isOpen=e,window.requestAnimationFrame(()=>{this.setupWindowEvents(this.isOpen);let o=this._flyout;!this.isOpen&&o&&(o.style.width=null,o.style.setProperty("--mgt-flyout-set-width",null),o.style.setProperty("--mgt-flyout-set-height",null),o.style.maxHeight=null,o.style.top=null,o.style.left=null,o.style.bottom=null)}),this.dispatchEvent(new Event(e?"opened":"closed")))}get _edgePadding(){return 24}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}constructor(){super(),this._renderedOnce=!1,this._isOpen=!1,this._smallView=!1,this.handleWindowEvent=e=>{let t=this._flyout;if(t)if(e.composedPath){let o=e.composedPath();if(o.includes(t)||e.type==="pointerdown"&&o.includes(this))return}else{let o=e.target;for(;o;)if(o=o.parentElement,o===t||e.type==="pointerdown"&&o===this)return}this.close()},this.handleResize=()=>{this.close()},this.handleKeyUp=e=>{e.key==="Escape"&&this.close()},this.handleFlyoutWheel=e=>{e.preventDefault()},this.avoidHidingAnchor=!0,this.addEventListener("expanded",()=>{window.requestAnimationFrame(()=>{this.updateFlyout()})})}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(e){super.updated(e),window.requestAnimationFrame(()=>{this.updateFlyout()})}render(){let e={root:!0,visible:this.isOpen},t=this.renderAnchor(),o=null;if(this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0),this.isOpen||this._renderedOnce){this._renderedOnce=!0;let i=Qt({flyout:!0,small:this._smallView});o=T`
        <div class=${i} @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `}return T`
      <div class=${Qt(e)}>
        <div class="anchor">
          ${t}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${o}
      </div>
    `}renderAnchor(){return T`
      <slot name="anchor"></slot>
    `}renderFlyout(){return T`
      <slot name="flyout"></slot>
    `}updateFlyout(e=!0){if(!this.isOpen)return;let t=this._anchor,o=this._flyout;if(o&&t){let i=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth;this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let n=0,s,d=0,u,h,p=o.getBoundingClientRect(),v=t.getBoundingClientRect(),C=this._topScout.getBoundingClientRect(),x=this._bottomScout.getBoundingClientRect(),E={height:this._windowHeight,left:0,top:0,width:i};if(qg()){let se=Yw().getWindowSegments(),ke,Tt=v.left+v.width/2,Gt=v.top+v.height/2;for(let Lt of se)if(Tt>=Lt.left&&Gt>=Lt.top){ke=Lt;break}ke&&(E.left=ke.left,E.top=ke.top,E.width=ke.width,E.height=ke.height)}p.width+2*this._edgePadding>E.width?p.width>E.width?(h=E.width,n=0):n=(E.width-p.width)/2:v.left+p.width+this._edgePadding>E.width?n=v.left-(v.left+p.width+this._edgePadding-E.width):v.left<this._edgePadding?n=this._edgePadding:n=v.left;let O=E.height-(v.top+v.height),q=v.top;this.avoidHidingAnchor?O<=p.height?q<p.height?q>O?(s=E.height-v.top,u=q):(d=v.bottom,u=O):(s=E.height-v.top,u=q):(d=v.bottom,u=O):p.height+2*this._edgePadding>E.height?p.height>=E.height?(u=E.height,d=0):d=(E.height-p.height)/2:v.top+v.height+p.height+this._edgePadding>E.height?d=E.height-p.height-this._edgePadding:d=Math.max(v.top+v.height,this._edgePadding),(C.top!==0||C.left!==0)&&(n-=C.left,typeof s<"u"?s+=x.top-this._windowHeight:d-=C.top),this.direction==="rtl"?n>100&&this.offsetLeft>100&&(o.style.left=`${E.width-n+p.left-p.width-30}px`):o.style.left=`${n+E.left}px`,typeof s<"u"?(o.style.top="unset",o.style.bottom=`${s}px`):(o.style.bottom="unset",o.style.top=`${d+E.top}px`),h&&(o.style.width=`${h}px`,o.style.setProperty("--mgt-flyout-set-width",`${h}px`),window.requestAnimationFrame(()=>this.updateFlyout())),u&&!e?(o.style.maxHeight=`${u}px`,o.style.setProperty("--mgt-flyout-set-height",`${u}px`)):(o.style.maxHeight=null,o.style.setProperty("--mgt-flyout-set-height","unset")),e&&window.requestAnimationFrame(()=>this.updateFlyout(!1))}}setupWindowEvents(e){e&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}};yl([G({attribute:"light-dismiss",type:Boolean}),ma("design:type",Boolean)],wn.prototype,"isLightDismiss",void 0);yl([G({attribute:null,type:Boolean}),ma("design:type",Boolean)],wn.prototype,"avoidHidingAnchor",void 0);yl([G({attribute:"isOpen",type:Boolean}),ma("design:type",Boolean),ma("design:paramtypes",[Boolean])],wn.prototype,"isOpen",null);yl([K(),ma("design:type",Object)],wn.prototype,"_isOpen",void 0);yl([K(),ma("design:type",Object)],wn.prototype,"_smallView",void 0);yl([K(),ma("design:type",Number)],wn.prototype,"_windowHeight",void 0)});var Mo,Gg=y(()=>{a();l();c();(function(r){r[r.none=0]="none",r[r.hover=1]="hover",r[r.click=2]="click"})(Mo||(Mo={}))});var ex,tx=y(()=>{a();l();c();ut();ex=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size)}:host .flyout [slot=anchor]{display:flex;cursor:pointer}:host .flyout [slot=anchor].vertical{flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0;--person-avatar-size:72px}:host .person-root{display:flex;flex-direction:row;align-items:center;background-color:var(--person-background-color,transparent);border-radius:var(--person-border-radius,4px)}:host .person-root.small .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.noline .presence-basic,:host .person-root.oneline .presence-basic{border-width:1px;position:relative;bottom:calc(var(--person-avatar-size,24px) * .12 - 4px)}:host .person-root.twolines .avatar-wrapper{min-width:var(--person-avatar-size,40px);width:var(--person-avatar-size,40px);height:var(--person-avatar-size,40px)}:host .person-root.twolines .avatar-wrapper .contact-icon,:host .person-root.twolines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,40px) * .4)}:host .person-root.twolines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,40px) * .28);height:calc(var(--person-avatar-size,40px) * .28)}:host .person-root.large .avatar-wrapper,:host .person-root.threelines .avatar-wrapper{min-width:var(--person-avatar-size,56px);width:var(--person-avatar-size,56px);height:var(--person-avatar-size,56px)}:host .person-root.large .avatar-wrapper .contact-icon,:host .person-root.large .avatar-wrapper .initials,:host .person-root.threelines .avatar-wrapper .contact-icon,:host .person-root.threelines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,56px) * .4)}:host .person-root.large .avatar-wrapper .presence-wrapper svg,:host .person-root.threelines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,56px) * .28);height:calc(var(--person-avatar-size,56px) * .28)}:host .person-root.fourlines .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.fourlines .avatar-wrapper .contact-icon,:host .person-root.fourlines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.fourlines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root.vertical{flex-direction:column;justify-content:center;align-items:center}:host .person-root.vertical .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.vertical .avatar-wrapper .contact-icon,:host .person-root.vertical .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.vertical .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px);position:relative;box-sizing:border-box}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials,:host .person-root .avatar-wrapper img{height:100%;width:100%;border:var(--person-avatar-border,none);border-radius:var(--person-avatar-border-radius,50%);margin-block-start:var(--person-avatar-top-spacing,0)}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials{display:flex;justify-content:center;align-items:center;font-size:calc(var(--person-avatar-size,24px) * .4);font-weight:400;background:var(--person-initials-background-color,var(--neutral-fill-secondary-rest));color:var(--person-initials-text-color,var(--neutral-fill-strong-hover))}:host .person-root .avatar-wrapper .presence-wrapper{bottom:var(--person-presence-wrapper-bottom,0);right:0;position:absolute;border-radius:50%;background-color:var(--neutral-layer-1);border:1px solid var(--neutral-layer-1)}:host .person-root .avatar-wrapper .presence-wrapper svg{display:flex;width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root .details-wrapper{display:flex;flex-direction:column;align-items:flex-start;min-width:var(--person-details-wrapper-width,168px);margin-inline-start:var(--person-details-left-spacing,12px);margin-block-end:var(--person-details-bottom-spacing,0)}:host .person-root .details-wrapper.vertical{display:inline-flex;flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root .details-wrapper .line1{font-size:var(--person-line1-font-size,ms-font-size-14);font-weight:var(--person-line1-font-weight,600);color:var(--person-line1-text-color,var(--neutral-foreground-rest));text-transform:var(--person-line1-text-transform,inherit);line-height:var(--person-line1-text-line-height,20px)}:host .person-root .details-wrapper .line2{font-size:var(--person-line2-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line2-font-weight,400);color:var(--person-line2-text-color,var(--secondary-text-color));text-transform:var(--person-line2-text-transform,inherit);line-height:var(--person-line2-text-line-height,16px)}:host .person-root .details-wrapper .line3{font-size:var(--person-line3-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line3-font-weight,400);color:var(--person-line3-text-color,var(--secondary-text-color));text-transform:var(--person-line3-text-transform,inherit);line-height:var(--person-line3-text-line-height,16px)}:host .person-root .details-wrapper .line4{font-size:var(--person-line4-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line4-font-weight,400);color:var(--person-line4-text-color,var(--secondary-text-color));text-transform:var(--person-line4-text-transform,inherit);line-height:var(--person-line4-text-line-height,16px)}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff;fill-rule:nonzero;clip-rule:nonzero}}[dir=rtl] .presence-wrapper{right:unset!important;left:0}
`]});var bl,jo,jg=y(()=>{a();l();c();(function(r){r[r.avatar=2]="avatar",r[r.oneline=3]="oneline",r[r.twolines=4]="twolines",r[r.threelines=5]="threelines",r[r.fourlines=6]="fourlines"})(bl||(bl={}));(function(r){r.photo="photo",r.initials="initials"})(jo||(jo={}))});var q3,rx,ox=y(()=>{a();l();c();q3={Available:"Available",Away:"Away",BeRightBack:"Be right back",Busy:"Busy",DoNotDisturb:"Do not disturb",InACall:"In a call",InAConferenceCall:"In a conference call",Inactive:"Inactive",InAMeeting:"In a meeting",Offline:"Offline",OffWork:"Off work",OutOfOffice:"Out of office",PresenceUnknown:"Presence unknown",Presenting:"Presenting",UrgentInterruptionsOnly:"Urgent interruptions only"},rx=Object.assign(Object.assign({},q3),{photoFor:"Photo for",emailAddress:"Email address",initials:"Initials"})});var od,ix,Kg=y(()=>{a();l();c();od=r=>"personType"in r||"userType"in r,ix=r=>"initials"in r});var ts,nx=y(()=>{a();l();c();qn();ts=r=>r??yt});var Wg=y(()=>{a();l();c();nx()});var Rt,Fh=y(()=>{a();l();c();Rt=class{};Rt.sections={files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0};Rt.useContactApis=!0;Rt.isSendMessageVisible=!0});var Dh,Qg,id,sx,G3,j3,K3,W3,Q3,ax,lx,cx=y(()=>{a();l();c();lt();ha();Fh();Dh=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Qg="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id,accountEnabled",id={directReports:"directReports",files:"files",messages:"messages",people:"people",person:"person"},sx=(r,e,t)=>Dh(void 0,void 0,void 0,function*(){var o;let i=e.id,n=jr(e),s="classification"in e||"personType"in e&&(e.personType.subclass==="PersonalContact"||e.personType.class==="Group"),d=r.createBatch();s||Rt.sections.organization&&(G3(d,i),Rt.sections.organization.showWorksWith&&j3(d,i)),Rt.sections.mailMessages&&n&&K3(d,n),Rt.sections.files&&W3(d,t?null:n);let u,h={};try{u=yield d.executeAll()}catch{}if(u)for(let[p,v]of u)h[p]=((o=v.content)===null||o===void 0?void 0:o.value)||v.content;if(!s&&Rt.sections.profile)try{let p=yield Q3(r,i);p&&(h.profile=p)}catch{}return h.directReports&&h.directReports.length>0&&(h.directReports=h.directReports.filter(p=>p.accountEnabled)),h}),G3=(r,e)=>{let t=`manager($levels=max;$select=${Qg})`;r.get(id.person,`users/${e}?$expand=${t}&$select=${Qg}&$count=true`,["user.read.all"],{ConsistencyLevel:"eventual"}),r.get(id.directReports,`users/${e}/directReports?$select=${Qg}`)},j3=(r,e)=>{r.get(id.people,`users/${e}/people?$filter=personType/class eq 'Person'`,["People.Read.All"])},K3=(r,e)=>{r.get(id.messages,`me/messages?$search="from:${e}"`,["Mail.ReadBasic"])},W3=(r,e)=>{let t;e?t=`me/insights/shared?$filter=lastshared/sharedby/address eq '${e}'`:t="me/insights/used",r.get(id.files,t,["Sites.Read.All"])},Q3=(r,e)=>Dh(void 0,void 0,void 0,function*(){return yield r.api(`/users/${e}/profile`).version("beta").get()}),ax=(r,e,t)=>Dh(void 0,void 0,void 0,function*(){let o={chatType:"oneonOne",members:[{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${t}')`},{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${e}')`}]};return yield r.api("/chats").header("Cache-Control","no-store").middlewareOptions(vt("Chat.Create","Chat.ReadWrite")).post(o)}),lx=(r,e,t)=>Dh(void 0,void 0,void 0,function*(){return yield r.api(`/chats/${e}/messages`).header("Cache-Control","no-store").middlewareOptions(vt("Chat.ReadWrite","ChatMessage.Send")).post(t)})});var dx,ux=y(()=>{a();l();c();ut();dx=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{box-shadow:var(--person-card-box-shadow,var(--elevation-shadow-card-rest));width:var(--mgt-flyout-set-width,375px);overflow:hidden;user-select:none;border-radius:8px;background-color:var(--person-card-background-color,var(--neutral-layer-floating));--file-list-background-color:transparent;--file-list-box-shadow:none;--file-item-background-color:transparent}:host .small{max-height:100vh;overflow:hidden auto}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding-top:18px;padding-inline-start:12px;height:32px;width:32px}:host .nav__back svg{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,var(--neutral-foreground-rest))}:host .close-card-container{position:relative;z-index:100}:host .close-card-container .close-button{position:absolute;right:10px;margin-top:9px;z-index:1;border:1px solid transparent}:host .close-card-container .close-button svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .close-card-container .close-button:hover svg path{fill:var(--person-card-close-button-hover-color,var(--neutral-foreground-rest))}:host .person-details-container{display:flex;flex-direction:column;padding-inline-start:22px;padding-block:36px;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .person-details-container .person-image{--person-avatar-top-spacing:var(--person-card-avatar-top-spacing, 15px);--person-details-left-spacing:var(--person-card-details-left-spacing, 15px);--person-details-bottom-spacing:var(--person-card-details-bottom-spacing, 0);--person-background-color:var(--person-card-background-color, var(--neutral-layer-floating));--person-line1-font-size:var(--person-card-line1-font-size, 20px);--person-line1-font-weight:var(--person-card-line1-font-weight, 600);--person-line1-text-line-height:var(--person-card-line1-line-height, 28px);--person-line1-text-color:var(--person-card-line1-text-color, var(--neutral-foreground-rest));--person-line2-font-size:var(--person-card-line2-font-size, 14px);--person-line2-font-weight:var(--person-card-line2-font-weight, 400);--person-line2-text-line-height:var(--person-card-line2-line-height, 20px);--person-line2-text-color:var(--person-card-line2-text-color, var(--neutral-foreground-hint));--person-line3-font-size:var(--person-card-line3-font-size, 14px);--person-line3-font-weight:var(--person-card-line3-font-weight, 400);--person-line3-text-line-height:var(--person-card-line3-line-height, 19px);--person-line3-text-color:var(--person-card-line3-text-color, var(--neutral-foreground-hint));--person-avatar-size:var(--person-card-avatar-size, 75px);--person-presence-wrapper-bottom:-15px}:host .person-details-container .base-icons{display:flex;align-items:center;margin-inline-start:var(--person-card-base-icons-left-spacing,calc(var(--person-card-avatar-size,75px) + var(--person-card-details-left-spacing,15px) - 8px));z-index:1}:host .person-details-container .base-icons .icon{display:flex;align-items:center;font-size:13px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-inline-end:28px}:host .person-details-container .base-icons .icon svg .filled{display:none}:host .person-details-container .base-icons .icon svg .regular{display:block}:host .person-details-container .base-icons .icon svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .person-details-container .base-icons .icon:active svg .filled,:host .person-details-container .base-icons .icon:hover svg .filled{display:block}:host .person-details-container .base-icons .icon:active svg .regular,:host .person-details-container .base-icons .icon:hover svg .regular{display:none}:host .person-details-container .base-icons .icon:active svg path,:host .person-details-container .base-icons .icon:hover svg path{fill:var(--person-card-icon-hover-color,var(--accent-foreground-hover))}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;height:32px}:host .expanded-details-container .expanded-details-button svg path{stroke:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .expanded-details-container .expanded-details-button:hover{cursor:pointer;background-color:var(--person-card-expanded-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section{padding:20px 0;display:flex;flex-direction:column;position:relative}:host .expanded-details-container .sections .section:not(:last-child)::after{position:absolute;content:"";width:90%;transform:translateX(-50%);border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest));left:50%;bottom:0}:host .expanded-details-container .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .expanded-details-container .sections .section__title{flex-grow:1;color:var(--person-card-line1-text-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;line-height:19px}:host .expanded-details-container .sections .section__show-more{font-size:12px;font-weight:600;align-self:center;vertical-align:top;--base-height-multiplier:6}:host .expanded-details-container .sections .section__show-more:hover{background-color:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section__content{margin-top:14px}:host .expanded-details-container .sections .section .additional-details{padding:0 20px}:host .expanded-details-container .divider{z-index:100;position:relative;width:375px;margin:0;border-style:none;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .expanded-details-container .section-nav{height:35px}:host .expanded-details-container .section-nav fluent-tabs{grid-template-columns:minmax(1px,.1fr)}:host .expanded-details-container .section-nav fluent-tabs.horizontal::part(activeIndicator){width:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel{max-height:360px;min-height:360px;overflow:hidden auto;padding:0;scrollbar-width:thin}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted{padding:20px 0;max-width:var(--mgt-flyout-set-width,375px);min-width:var(--mgt-flyout-set-width,360px);--file-list-box-shadow:none;--file-list-padding:0}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 20px;line-height:19px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .overview-panel{max-width:var(--mgt-flyout-set-width,375px)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-button{height:1px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track{border-radius:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab{padding-bottom:1px!important;border:1px solid transparent!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab:focus-visible{border:1px solid #2b2b2b!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon{cursor:pointer;box-sizing:border-box;width:53px;height:36px;display:flex;align-items:center;justify-content:center}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon svg{fill:var(--person-card-fluent-background-color,transparent)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon:hover{background:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover));border-radius:4px;z-index:0;position:relative}:host .expanded-details-container .section-host{min-height:360px;overflow:hidden auto}:host .expanded-details-container .section-host::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-host::-webkit-scrollbar-button{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .expanded-details-container .section-host::-webkit-scrollbar-track-piece{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-host.small{overflow-y:hidden}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .message-section{border-bottom:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint));display:flex}:host .message-section fluent-text-field{margin:10px 10px 10px 16px;--neutral-fill-input-rest:$person-card-background-color;--neutral-fill-input-hover:$person-card-chat-input-hover-color;--neutral-fill-input-focus:$person-card-chat-input-focus-color;width:300px;margin-inline-start:16px;border-radius:4px;border:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section .send-message-icon{max-width:15px;margin-top:10px}:host .message-section svg{height:17px;width:16px;fill:var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section svg:hover{filter:brightness(.5)}:host .message-section svg:disabled{filter:none}:host .person-root.large,:host .person-root.threelines{--person-avatar-size-3-lines:75px}:host fluent-button.close-button.lightweight::part(control),:host fluent-button.expanded-details-button::part(control),:host fluent-button.section__show-more.lightweight::part(control){background:var(--person-card-fluent-background-color,transparent)}:host fluent-button.icon::part(control),:host fluent-button.nav__back::part(control){border:none;padding:0;background:0 0}:host fluent-button.icon::part(control) :hover,:host fluent-button.nav__back::part(control) :hover{background:0 0}[dir=rtl] .base-icons{right:91px}[dir=rtl] .nav__back{width:20px!important;transform:scaleX(-1);filter:fliph;filter:FlipH}[dir=rtl] .close-card-container .close-button{right:auto;left:10px}[dir=rtl] .message-section svg{transform:scale(-1,1)}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var hx,px=y(()=>{a();l();c();ut();hx=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}
`]});var fx,Yg,Lh=y(()=>{a();l();c();ut();lt();px();lt();fx=()=>Nt("spinner",Yg),Yg=class extends Pr{static get styles(){return hx}render(){return T`<fluent-progress-ring title="spinner"></fluent-progress-ring>`}}});var Zg,Nh,Fo,nd=y(()=>{a();l();c();lt();ut();Ao();Lh();Zg=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Nh=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Fo=class extends qr{get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.requestStateUpdate())}get isCompact(){return this._isCompact}constructor(){super(),this._isCompact=!1,this._personDetails=null}asCompactView(){return this._isCompact=!0,this}asFullView(){return this._isCompact=!1,this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return Ot`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `}renderNoData(){return T`
      <div class="no-data">No data</div>
    `}navigateCard(e){var t;let o=this.parentNode;for(;o;){o=o.parentNode;let n=o;if(((t=n?.host)===null||t===void 0?void 0:t.tagName)===`${oo.prefix}-PERSON-CARD`.toUpperCase()){o=n.host;break}}o.navigate(e)}};Zg([G({attribute:"person-details",type:Object}),Nh("design:type",Object),Nh("design:paramtypes",[Object])],Fo.prototype,"personDetails",null);Zg([K(),Nh("design:type",Boolean)],Fo.prototype,"_isCompact",void 0);Zg([K(),Nh("design:type",Object)],Fo.prototype,"_personDetails",void 0)});var mx,gx=y(()=>{a();l();c();ut();mx=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__icon svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint))}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--contact-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .part .part__details .part__value{grid-column:2;color:var(--contact-value-color,var(--neutral-foreground-rest));font-size:14px;font-weight:400;line-height:19px}:host .root .part .part__details .part__value .part__link{color:var(--contact-link-color,var(--accent-foreground-rest));font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--contact-link-hover-color,var(--accent-foreground-hover))}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--contact-background-color,transparent);visibility:hidden;display:flex;align-items:center;justify-content:flex-start}:host .root .part .part__copy svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint));cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px;margin-bottom:2px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var vx,yx=y(()=>{a();l();c();vx={contactSectionTitle:"Contact",emailTitle:"Email",chatTitle:"Teams",businessPhoneTitle:"Business Phone",cellPhoneTitle:"Mobile Phone",departmentTitle:"Department",titleTitle:"Title",officeLocationTitle:"Office Location",copyToClipboardButton:"Copy to clipboard"}});var bx,sd,Cx=y(()=>{a();l();c();ut();lt();ca();ha();nd();gx();wi();yx();lt();bx=()=>{Nt("contact",sd)},sd=class extends Fo{static get styles(){return mx}get strings(){return vx}get hasData(){return this._contactParts?!!Object.values(this._contactParts).filter(t=>!!t.value).length:!1}constructor(e){var t;super(),this._contactParts={email:{icon:Ce(D.Email),onClick:()=>this.sendEmail(jr(this._person)),showCompact:!0,title:this.strings.emailTitle},chat:{icon:Ce(D.Chat),onClick:()=>{var o;return this.sendChat((o=this._person)===null||o===void 0?void 0:o.userPrincipalName)},showCompact:!1,title:this.strings.chatTitle},businessPhone:{icon:Ce(D.Phone),onClick:()=>{var o,i;return this.sendCall(((i=(o=this._person)===null||o===void 0?void 0:o.businessPhones)===null||i===void 0?void 0:i.length)>0?this._person.businessPhones[0]:null)},showCompact:!0,title:this.strings.businessPhoneTitle},cellPhone:{icon:Ce(D.CellPhone),onClick:()=>{var o;return this.sendCall((o=this._person)===null||o===void 0?void 0:o.mobilePhone)},showCompact:!0,title:this.strings.cellPhoneTitle},department:{icon:Ce(D.Department),showCompact:!1,title:this.strings.departmentTitle},title:{icon:Ce(D.Person),showCompact:!1,title:this.strings.titleTitle},officeLocation:{icon:Ce(D.OfficeLocation),showCompact:!0,title:this.strings.officeLocationTitle}},this.sendCall=o=>{this.sendLink("tel:",o)},this._person=e,this._contactParts.email.value=jr(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,!((t=this._person.businessPhones)===null||t===void 0)&&t.length&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}get displayName(){return this.strings.contactSectionTitle}get cardTitle(){return this.strings.contactSectionTitle}renderIcon(){return Ce(D.Contact)}clearState(){super.clearState();for(let e of Object.keys(this._contactParts))this._contactParts[e].value=null}renderCompactView(){if(!this.hasData)return null;let e=Object.values(this._contactParts).filter(i=>!!i.value),t=Object.values(e).filter(i=>!!i.value&&i.showCompact);t?.length||(t=Object.values(e).slice(0,2));let o=T`
      ${t.map(i=>this.renderContactPart(i))}
    `;return T`
      <div class="root compact" dir=${this.direction}>
        ${o}
      </div>
    `}renderFullView(){let e;if(this.hasData){let t=Object.values(this._contactParts).filter(o=>!!o.value);e=T`
        ${t.map(o=>this.renderContactPart(o))}
      `}return T`
      <div class="root" dir=${this.direction}>
        ${e}
      </div>
    `}renderContactPart(e){let t=!1;(e.title==="Mobile Phone"||e.title==="Business Phone")&&(t=!0);let o={part__link:!0,phone:t},i=e.onClick?T`
          <span class=${Qt(o)} @click=${n=>e.onClick(n)}>${e.value}</span>
        `:T`
          ${e.value}
        `;return T`
      <div class="part" role="button" @click=${n=>this.handlePartClick(n,e.value)} tabindex="0">
        <div class="part__icon" aria-label=${e.title} title=${e.title}>${e.icon}</div>
        <div class="part__details">
          <div class="part__title">${e.title}</div>
          <div class="part__value" title=${e.title}>${i}</div>
        </div>
        <div
          class="part__copy"
          aria-label=${this.strings.copyToClipboardButton}
          title=${this.strings.copyToClipboardButton}
        >
          ${Ce(D.Copy)}
        </div>
      </div>
    `}handlePartClick(e,t){t&&navigator.clipboard.writeText(t)}sendLink(e,t){t?window.open(`${e}${t}`,"_blank","noreferrer"):console.error(`\u{1F992}: Target resource for ${e} link was not provided: resource: ${t}`)}sendChat(e){if(!e){console.error("\u{1F992}: Can't send chat when upn is not provided");return}let t=`https://teams.microsoft.com/l/chat/0/0?users=${e}`,o=()=>window.open(t,"_blank","noreferrer");Oi.isAvailable?Oi.executeDeepLink(t,i=>{i||o()}):o()}sendEmail(e){this.sendLink("mailto:",e)}}});var Y3,wx,Cl,rs,Z3,xx,Sx,Hh,_x=y(()=>{a();l();c();qn();({D:Y3}=pC),wx=()=>document.createComment(""),Cl=(r,e,t)=>{let o=r._$AA.parentNode,i=e===void 0?r._$AB:e._$AA;if(t===void 0){let n=o.insertBefore(wx(),i),s=o.insertBefore(wx(),i);t=new Y3(n,s,r,r.options)}else{let n=t._$AB.nextSibling,s=t._$AM,d=s!==r;if(d){let u;t._$AQ?.(r),t._$AM=r,t._$AP!==void 0&&(u=r._$AU)!==s._$AU&&t._$AP(u)}if(n!==i||d){let u=t._$AA;for(;u!==n;){let h=u.nextSibling;o.insertBefore(u,i),u=h}}}return t},rs=(r,e,t=r)=>(r._$AI(e,t),r),Z3={},xx=(r,e=Z3)=>r._$AH=e,Sx=r=>r._$AH,Hh=r=>{r._$AP?.(!1,!0);let e=r._$AA,t=r._$AB.nextSibling;for(;e!==t;){let o=e.nextSibling;e.remove(),e=o}}});var Ex,Tx,kx=y(()=>{a();l();c();qn();Dg();_x();Ex=(r,e,t)=>{let o=new Map;for(let i=e;i<=t;i++)o.set(r[i],i);return o},Tx=Eh(class extends gl{constructor(r){if(super(r),r.type!==_h.CHILD)throw Error("repeat() can only be used in text expressions")}ht(r,e,t){let o;t===void 0?t=e:e!==void 0&&(o=e);let i=[],n=[],s=0;for(let d of r)i[s]=o?o(d,s):s,n[s]=t(d,s),s++;return{values:n,keys:i}}render(r,e,t){return this.ht(r,e,t).values}update(r,[e,t,o]){let i=Sx(r),{values:n,keys:s}=this.ht(e,t,o);if(!Array.isArray(i))return this.dt=s,n;let d=this.dt??=[],u=[],h,p,v=0,C=i.length-1,x=0,E=n.length-1;for(;v<=C&&x<=E;)if(i[v]===null)v++;else if(i[C]===null)C--;else if(d[v]===s[x])u[x]=rs(i[v],n[x]),v++,x++;else if(d[C]===s[E])u[E]=rs(i[C],n[E]),C--,E--;else if(d[v]===s[E])u[E]=rs(i[v],n[E]),Cl(r,u[E+1],i[v]),v++,E--;else if(d[C]===s[x])u[x]=rs(i[C],n[x]),Cl(r,i[v],i[C]),C--,x++;else if(h===void 0&&(h=Ex(s,x,E),p=Ex(d,v,C)),h.has(d[v]))if(h.has(d[C])){let O=p.get(s[x]),q=O!==void 0?i[O]:null;if(q===null){let _e=Cl(r,i[v]);rs(_e,n[x]),u[x]=_e}else u[x]=rs(q,n[x]),Cl(r,i[v],q),i[O]=null;x++}else Hh(i[C]),C--;else Hh(i[v]),v++;for(;x<=E;){let O=Cl(r,u[E+1]);rs(O,n[x]),u[x++]=O}for(;v<=C;){let O=i[v++];O!==null&&Hh(O)}return this.dt=s,xx(r,u),fi}})});var Ix=y(()=>{a();l();c();kx()});var Ve,Ax,Uh,Rx,ga,J3,ad,Kr,Px,Ox,$x,Mx,Fx,Dx,Lx,Nx,Hx,Ux,Bx,Vx,zx,Ko,qx,Gx,jx,Kx,Wx,Qx,Yx,Zx,Jx,Xx,eS,tS,rS,oS,iS,nS,X3,eP,tP,Jg,Xg,sS,aS,lS,cS,dS,Bh=y(()=>{a();l();c();lt();ua();Gs();da();Ve=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Ax=r=>Array.isArray(r.nextExpectedRanges),Uh=()=>Ve(void 0,void 0,void 0,function*(){yield ye.getCache(re.fileLists,re.fileLists.stores.fileLists).clearStore()}),Rx=()=>ye.config.files.invalidationPeriod||ye.config.defaultInvalidationPeriod,ga=()=>ye.config.files.isEnabled&&ye.config.isEnabled,J3=()=>ye.config.fileLists.invalidationPeriod||ye.config.defaultInvalidationPeriod,ad=()=>ye.config.fileLists.isEnabled&&ye.config.isEnabled,Kr=(r,e,t=re.files.stores.fileQueries,o="files.read")=>Ve(void 0,void 0,void 0,function*(){let i=ye.getCache(re.files,t),n=yield tP(i,e);if(n)return n;let s;try{s=yield r.api(e).middlewareOptions(vt(o)).get(),ga()&&(yield i.putValue(e,{file:JSON.stringify(s)}))}catch{}return s||null}),Px=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/drives/${e}/items/${t}`;return Kr(r,o,re.files.stores.driveFiles)}),Ox=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/drives/${e}/root:/${t}`;return Kr(r,o,re.files.stores.driveFiles)}),$x=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/groups/${e}/drive/items/${t}`;return Kr(r,o,re.files.stores.groupFiles)}),Mx=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/groups/${e}/drive/root:/${t}`;return Kr(r,o,re.files.stores.groupFiles)}),Fx=(r,e)=>Ve(void 0,void 0,void 0,function*(){let t=`/me/drive/items/${e}`;return Kr(r,t,re.files.stores.userFiles)}),Dx=(r,e)=>Ve(void 0,void 0,void 0,function*(){let t=`/me/drive/root:/${e}`;return Kr(r,t,re.files.stores.userFiles)}),Lx=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/sites/${e}/drive/items/${t}`;return Kr(r,o,re.files.stores.siteFiles)}),Nx=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/sites/${e}/drive/root:/${t}`;return Kr(r,o,re.files.stores.siteFiles)}),Hx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/sites/${e}/lists/${t}/items/${o}/driveItem`;return Kr(r,i,re.files.stores.siteFiles)}),Ux=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/users/${e}/drive/items/${t}`;return Kr(r,o,re.files.stores.userFiles)}),Bx=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/users/${e}/drive/root:/${t}`;return Kr(r,o,re.files.stores.userFiles)}),Vx=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/me/insights/${e}/${t}/resource`;return Kr(r,o,re.files.stores.insightFiles,"sites.read.all")}),zx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/users/${e}/insights/${t}/${o}/resource`;return Kr(r,i,re.files.stores.insightFiles,"sites.read.all")}),Ko=(r,e,t,o,i)=>Ve(void 0,void 0,void 0,function*(){let n,s=ye.getCache(re.fileLists,t),d=yield Jg(s,t,`${e}:${i}`);if(d)return n=eP(r,d.files,d.nextLink),n;let u;try{if(u=r.api(e).middlewareOptions(vt(...o)),i&&u.top(i),n=yield X3(r,u),ad()){let h=n.nextLink;yield s.putValue(e,{files:n.value.map(p=>JSON.stringify(p)),nextLink:h})}}catch{}return n||null}),qx=(r,e)=>Ve(void 0,void 0,void 0,function*(){let t="/me/drive/root/children",o=re.fileLists.stores.fileLists;return Ko(r,t,o,["files.read"],e)}),Gx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/drives/${e}/items/${t}/children`,n=re.fileLists.stores.fileLists;return Ko(r,i,n,["files.read"],o)}),jx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/drives/${e}/root:/${t}:/children`,n=re.fileLists.stores.fileLists;return Ko(r,i,n,["files.read"],o)}),Kx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/groups/${e}/drive/items/${t}/children`,n=re.fileLists.stores.fileLists;return Ko(r,i,n,["files.read"],o)}),Wx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/groups/${e}/drive/root:/${t}:/children`,n=re.fileLists.stores.fileLists;return Ko(r,i,n,["files.read"],o)}),Qx=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/me/drive/items/${e}/children`,i=re.fileLists.stores.fileLists;return Ko(r,o,i,["files.read"],t)}),Yx=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=`/me/drive/root:/${e}:/children`,i=re.fileLists.stores.fileLists;return Ko(r,o,i,["files.read"],t)}),Zx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/sites/${e}/drive/items/${t}/children`,n=re.fileLists.stores.fileLists;return Ko(r,i,n,["files.read"],o)}),Jx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/sites/${e}/drive/root:/${t}:/children`,n=re.fileLists.stores.fileLists;return Ko(r,i,n,["files.read"],o)}),Xx=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/users/${e}/drive/items/${t}/children`,n=re.fileLists.stores.fileLists;return Ko(r,i,n,["files.read"],o)}),eS=(r,e,t,o)=>Ve(void 0,void 0,void 0,function*(){let i=`/users/${e}/drive/root:/${t}:/children`,n=re.fileLists.stores.fileLists;return Ko(r,i,n,["files.read"],o)}),tS=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o=re.fileLists.stores.fileLists;return Ko(r,e,o,["files.read","sites.read.all"],t)}),rS=(r,e)=>Ve(void 0,void 0,void 0,function*(){let t=`/me/insights/${e}`,o=re.fileLists.stores.insightfileLists,i=ye.getCache(re.fileLists,o),n=yield Jg(i,o,t);if(n)return n.files.map(h=>JSON.parse(h));let s=["sites.read.all"],d;try{d=yield r.api(t).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(vt(...s)).get()}catch{}let u=yield nS(r,d,s);return ad()&&(yield i.putValue(t,{files:u.map(h=>JSON.stringify(h))})),u||null}),oS=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){let o,i;t==="shared"?(o="/me/insights/shared",i=`((lastshared/sharedby/id eq '${e}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(o=`/users/${e}/insights/${t}`,i="resourceReference/type eq 'microsoft.graph.driveItem'");let n=`${o}?$filter=${i}`,s=re.fileLists.stores.insightfileLists,d=ye.getCache(re.fileLists,s),u=yield Jg(d,s,n);if(u)return u.files.map(C=>JSON.parse(C));let h=["sites.read.all"],p;try{p=yield r.api(o).filter(i).middlewareOptions(vt(...h)).get()}catch{}let v=yield nS(r,p,h);return ad()&&(yield d.putValue(o,{files:v.map(C=>JSON.stringify(C))})),v||null}),iS=(r,e)=>Ve(void 0,void 0,void 0,function*(){if(!e||e.length===0)return[];let t=r.createBatch(),o=[],i=["files.read"],n,s;ga()&&(n=ye.getCache(re.files,re.files.stores.fileQueries));for(let d of e)ga()&&(s=yield n.getValue(d)),ga()&&s&&Rx()>Date.now()-s.timeCached?o.push(JSON.parse(s.file)):d!==""&&t.get(d,d,i);try{let d=yield t.executeAll();for(let u of e){let h=d.get(u);h?.content&&(o.push(h.content),ga()&&(yield n.putValue(u,{file:JSON.stringify(h.content)})))}return o}catch{try{return Promise.all(e.filter(u=>u&&u!=="").map(u=>Ve(void 0,void 0,void 0,function*(){let h=yield Kr(r,u);if(h)return ga()&&(yield n.putValue(u,{file:JSON.stringify(h)})),h})))}catch{return[]}}}),nS=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){if(!e)return[];let o=e.value,i=r.createBatch(),n=[];for(let s of o){let d=s.resourceReference.id;d!==""&&i.get(d,d,t)}try{let s=yield i.executeAll();for(let d of o){let u=s.get(d.resourceReference.id);u?.content&&n.push(u.content)}return n}catch{try{return Promise.all(o.filter(d=>!!d.resourceReference.id).map(d=>Ve(void 0,void 0,void 0,function*(){return yield r.api(d.resourceReference.id).middlewareOptions(vt(...t)).get()})))}catch{return[]}}}),X3=(r,e)=>Ve(void 0,void 0,void 0,function*(){return Xs.create(r,e)}),eP=(r,e,t)=>Xs.createFromValue(r,e.map(o=>JSON.parse(o)),t),tP=(r,e)=>Ve(void 0,void 0,void 0,function*(){if(ga()){let t=yield r.getValue(e);if(t&&Rx()>Date.now()-t.timeCached)return JSON.parse(t.file)}return null}),Jg=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){if(r||(r=ye.getCache(re.fileLists,e)),ad()){let o=yield r.getValue(t);if(o&&J3()>Date.now()-o.timeCached)return o}return null}),Xg=r=>Ve(void 0,void 0,void 0,function*(){let e=r.nextLink;if(r.hasNext&&(yield r.next()),ad()){let t=ye.getCache(re.fileLists,re.fileLists.stores.fileLists),n=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(e)[3];yield t.putValue(n,{files:r.value.map(s=>JSON.stringify(s)),nextLink:e})}}),sS=(r,e)=>Ve(void 0,void 0,void 0,function*(){let t="files.read";try{return(yield r.api(e).middlewareOptions(vt(t)).get())||null}catch{}return null}),aS=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){try{let o="files.readwrite",i={item:{"@microsoft.graph.conflictBehavior":t===0||t===null?"rename":"replace"}},n;try{n=yield r.api(e).middlewareOptions(vt(o)).post(JSON.stringify(i))}catch{}return n||null}catch{return null}}),lS=(r,e,t,o,i)=>Ve(void 0,void 0,void 0,function*(){try{let n="files.readwrite",s={"Content-Length":t,"Content-Range":o},d;try{d=yield r.client.api(e).middlewareOptions(vt(n)).headers(s).put(i)}catch{}return d||null}catch{return null}}),cS=(r,e,t)=>Ve(void 0,void 0,void 0,function*(){try{let o="files.readwrite",i;try{i=yield r.client.api(e).middlewareOptions(vt(o)).put(t)}catch{}return i||null}catch{return null}}),dS=(r,e)=>Ve(void 0,void 0,void 0,function*(){let t="files.readwrite";try{yield r.client.api(e).middlewareOptions(vt(t)).delete()}catch{return null}})});function Vh(){let r=new WeakMap;return function(e){let t=r.get(e);if(t===void 0){let o=Reflect.getPrototypeOf(e);for(;t===void 0&&o!==null;)t=r.get(o),o=Reflect.getPrototypeOf(o);t=t===void 0?[]:t.slice(0),r.set(e,t)}return t}}var xi,uS,va,Wo,xn=y(()=>{a();l();c();xi=function(){if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof window<"u")return window;try{return new Function("return this")()}catch{return{}}}();xi.trustedTypes===void 0&&(xi.trustedTypes={createPolicy:(r,e)=>e});uS={configurable:!1,enumerable:!1,writable:!1};xi.FAST===void 0&&Reflect.defineProperty(xi,"FAST",Object.assign({value:Object.create(null)},uS));va=xi.FAST;if(va.getById===void 0){let r=Object.create(null);Reflect.defineProperty(va,"getById",Object.assign({value(e,t){let o=r[e];return o===void 0&&(o=t?r[e]=t():null),o}},uS))}Wo=Object.freeze([])});var ev,hS,tv,ld,rv,zh,W,Qo=y(()=>{a();l();c();xn();ev=xi.FAST.getById(1,()=>{let r=[],e=[];function t(){if(e.length)throw e.shift()}function o(s){try{s.call()}catch(d){e.push(d),setTimeout(t,0)}}function i(){let d=0;for(;d<r.length;)if(o(r[d]),d++,d>1024){for(let u=0,h=r.length-d;u<h;u++)r[u]=r[u+d];r.length-=d,d=0}r.length=0}function n(s){r.length<1&&xi.requestAnimationFrame(i),r.push(s)}return Object.freeze({enqueue:n,process:i})}),hS=xi.trustedTypes.createPolicy("fast-html",{createHTML:r=>r}),tv=hS,ld=`fast-${Math.random().toString(36).substring(2,8)}`,rv=`${ld}{`,zh=`}${ld}`,W=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(r){if(tv!==hS)throw new Error("The HTML policy can only be set once.");tv=r},createHTML(r){return tv.createHTML(r)},isMarker(r){return r&&r.nodeType===8&&r.data.startsWith(ld)},extractDirectiveIndexFromMarker(r){return parseInt(r.data.replace(`${ld}:`,""))},createInterpolationPlaceholder(r){return`${rv}${r}${zh}`},createCustomAttributePlaceholder(r,e){return`${r}="${this.createInterpolationPlaceholder(e)}"`},createBlockPlaceholder(r){return`<!--${ld}:${r}-->`},queueUpdate:ev.enqueue,processUpdates:ev.process,nextUpdate(){return new Promise(ev.enqueue)},setAttribute(r,e,t){t==null?r.removeAttribute(e):r.setAttribute(e,t)},setBooleanAttribute(r,e,t){t?r.setAttribute(e,""):r.removeAttribute(e)},removeChildNodes(r){for(let e=r.firstChild;e!==null;e=r.firstChild)r.removeChild(e)},createTemplateWalker(r){return document.createTreeWalker(r,133,null,!1)}})});var Ui,wl,cd=y(()=>{a();l();c();Ui=class{constructor(e,t){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=e,this.sub1=t}has(e){return this.spillover===void 0?this.sub1===e||this.sub2===e:this.spillover.indexOf(e)!==-1}subscribe(e){let t=this.spillover;if(t===void 0){if(this.has(e))return;if(this.sub1===void 0){this.sub1=e;return}if(this.sub2===void 0){this.sub2=e;return}this.spillover=[this.sub1,this.sub2,e],this.sub1=void 0,this.sub2=void 0}else t.indexOf(e)===-1&&t.push(e)}unsubscribe(e){let t=this.spillover;if(t===void 0)this.sub1===e?this.sub1=void 0:this.sub2===e&&(this.sub2=void 0);else{let o=t.indexOf(e);o!==-1&&t.splice(o,1)}}notify(e){let t=this.spillover,o=this.source;if(t===void 0){let i=this.sub1,n=this.sub2;i!==void 0&&i.handleChange(o,e),n!==void 0&&n.handleChange(o,e)}else for(let i=0,n=t.length;i<n;++i)t[i].handleChange(o,e)}},wl=class{constructor(e){this.subscribers={},this.sourceSubscribers=null,this.source=e}notify(e){var t;let o=this.subscribers[e];o!==void 0&&o.notify(e),(t=this.sourceSubscribers)===null||t===void 0||t.notify(e)}subscribe(e,t){var o;if(t){let i=this.subscribers[t];i===void 0&&(this.subscribers[t]=i=new Ui(this.source)),i.subscribe(e)}else this.sourceSubscribers=(o=this.sourceSubscribers)!==null&&o!==void 0?o:new Ui(this.source),this.sourceSubscribers.subscribe(e)}unsubscribe(e,t){var o;if(t){let i=this.subscribers[t];i!==void 0&&i.unsubscribe(e)}else(o=this.sourceSubscribers)===null||o===void 0||o.unsubscribe(e)}}});function k(r,e){ce.defineProperty(r,e)}function fS(r,e,t){return Object.assign({},t,{get:function(){return ce.trackVolatile(),t.get.apply(this)}})}var ce,pS,os,is,Bi=y(()=>{a();l();c();Qo();xn();cd();ce=va.getById(2,()=>{let r=/(:|&&|\|\||if)/,e=new WeakMap,t=W.queueUpdate,o,i=h=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function n(h){let p=h.$fastController||e.get(h);return p===void 0&&(Array.isArray(h)?p=i(h):e.set(h,p=new wl(h))),p}let s=Vh();class d{constructor(p){this.name=p,this.field=`_${p}`,this.callback=`${p}Changed`}getValue(p){return o!==void 0&&o.watch(p,this.name),p[this.field]}setValue(p,v){let C=this.field,x=p[C];if(x!==v){p[C]=v;let E=p[this.callback];typeof E=="function"&&E.call(p,x,v),n(p).notify(this.name)}}}class u extends Ui{constructor(p,v,C=!1){super(p,v),this.binding=p,this.isVolatileBinding=C,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(p,v){this.needsRefresh&&this.last!==null&&this.disconnect();let C=o;o=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;let x=this.binding(p,v);return o=C,x}disconnect(){if(this.last!==null){let p=this.first;for(;p!==void 0;)p.notifier.unsubscribe(this,p.propertyName),p=p.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(p,v){let C=this.last,x=n(p),E=C===null?this.first:{};if(E.propertySource=p,E.propertyName=v,E.notifier=x,x.subscribe(this,v),C!==null){if(!this.needsRefresh){let O;o=void 0,O=C.propertySource[C.propertyName],o=this,p===O&&(this.needsRefresh=!0)}C.next=E}this.last=E}handleChange(){this.needsQueue&&(this.needsQueue=!1,t(this))}call(){this.last!==null&&(this.needsQueue=!0,this.notify(this))}records(){let p=this.first;return{next:()=>{let v=p;return v===void 0?{value:void 0,done:!0}:(p=p.next,{value:v,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(h){i=h},getNotifier:n,track(h,p){o!==void 0&&o.watch(h,p)},trackVolatile(){o!==void 0&&(o.needsRefresh=!0)},notify(h,p){n(h).notify(p)},defineProperty(h,p){typeof p=="string"&&(p=new d(p)),s(h).push(p),Reflect.defineProperty(h,p.name,{enumerable:!0,get:function(){return p.getValue(this)},set:function(v){p.setValue(this,v)}})},getAccessors:s,binding(h,p,v=this.isVolatileBinding(h)){return new u(h,p,v)},isVolatileBinding(h){return r.test(h.toString())}})});pS=va.getById(3,()=>{let r=null;return{get(){return r},set(e){r=e}}}),os=class{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return pS.get()}get isEven(){return this.index%2===0}get isOdd(){return this.index%2!==0}get isFirst(){return this.index===0}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(e){pS.set(e)}};ce.defineProperty(os.prototype,"index");ce.defineProperty(os.prototype,"length");is=Object.seal(new os)});var ns,xl,Sn,ss=y(()=>{a();l();c();Qo();ns=class{constructor(){this.targetIndex=0}},xl=class extends ns{constructor(){super(...arguments),this.createPlaceholder=W.createInterpolationPlaceholder}},Sn=class extends ns{constructor(e,t,o){super(),this.name=e,this.behavior=t,this.options=o}createPlaceholder(e){return W.createCustomAttributePlaceholder(this.name,e)}createBehavior(e){return new this.behavior(e,this.options)}}});function rP(r,e){this.source=r,this.context=e,this.bindingObserver===null&&(this.bindingObserver=ce.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(r,e))}function oP(r,e){this.source=r,this.context=e,this.target.addEventListener(this.targetName,this)}function iP(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function nP(){this.bindingObserver.disconnect(),this.source=null,this.context=null;let r=this.target.$fastView;r!==void 0&&r.isComposed&&(r.unbind(),r.needsBindOnly=!0)}function sP(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function aP(r){W.setAttribute(this.target,this.targetName,r)}function lP(r){W.setBooleanAttribute(this.target,this.targetName,r)}function cP(r){if(r==null&&(r=""),r.create){this.target.textContent="";let e=this.target.$fastView;e===void 0?e=r.create():this.target.$fastTemplate!==r&&(e.isComposed&&(e.remove(),e.unbind()),e=r.create()),e.isComposed?e.needsBindOnly&&(e.needsBindOnly=!1,e.bind(this.source,this.context)):(e.isComposed=!0,e.bind(this.source,this.context),e.insertBefore(this.target),this.target.$fastView=e,this.target.$fastTemplate=r)}else{let e=this.target.$fastView;e!==void 0&&e.isComposed&&(e.isComposed=!1,e.remove(),e.needsBindOnly?e.needsBindOnly=!1:e.unbind()),this.target.textContent=r}}function dP(r){this.target[this.targetName]=r}function uP(r){let e=this.classVersions||Object.create(null),t=this.target,o=this.version||0;if(r!=null&&r.length){let i=r.split(/\s+/);for(let n=0,s=i.length;n<s;++n){let d=i[n];d!==""&&(e[d]=o,t.classList.add(d))}}if(this.classVersions=e,this.version=o+1,o!==0){o-=1;for(let i in e)e[i]===o&&t.classList.remove(i)}}var ya,ov,qh=y(()=>{a();l();c();Qo();Bi();ss();ya=class extends xl{constructor(e){super(),this.binding=e,this.bind=rP,this.unbind=iP,this.updateTarget=aP,this.isBindingVolatile=ce.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(e){if(this.originalTargetName=e,e!==void 0)switch(e[0]){case":":if(this.cleanedTargetName=e.substr(1),this.updateTarget=dP,this.cleanedTargetName==="innerHTML"){let t=this.binding;this.binding=(o,i)=>W.createHTML(t(o,i))}break;case"?":this.cleanedTargetName=e.substr(1),this.updateTarget=lP;break;case"@":this.cleanedTargetName=e.substr(1),this.bind=oP,this.unbind=sP;break;default:this.cleanedTargetName=e,e==="class"&&(this.updateTarget=uP);break}}targetAtContent(){this.updateTarget=cP,this.unbind=nP}createBehavior(e){return new ov(e,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}},ov=class{constructor(e,t,o,i,n,s,d){this.source=null,this.context=null,this.bindingObserver=null,this.target=e,this.binding=t,this.isBindingVolatile=o,this.bind=i,this.unbind=n,this.updateTarget=s,this.targetName=d}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(e){os.setEvent(e);let t=this.binding(this.source,this.context);os.setEvent(null),t!==!0&&e.preventDefault()}}});function hP(r){if(r.length===1)return r[0];let e,t=r.length,o=r.map(s=>typeof s=="string"?()=>s:(e=s.targetName||e,s.binding)),i=(s,d)=>{let u="";for(let h=0;h<t;++h)u+=o[h](s,d);return u},n=new ya(i);return n.targetName=e,n}function gS(r,e){let t=e.split(rv);if(t.length===1)return null;let o=[];for(let i=0,n=t.length;i<n;++i){let s=t[i],d=s.indexOf(zh),u;if(d===-1)u=s;else{let h=parseInt(s.substring(0,d));o.push(r.directives[h]),u=s.substring(d+pP)}u!==""&&o.push(u)}return o}function mS(r,e,t=!1){let o=e.attributes;for(let i=0,n=o.length;i<n;++i){let s=o[i],d=s.value,u=gS(r,d),h=null;u===null?t&&(h=new ya(()=>d),h.targetName=s.name):h=hP(u),h!==null&&(e.removeAttributeNode(s),i--,n--,r.addFactory(h))}}function fP(r,e,t){let o=gS(r,e.textContent);if(o!==null){let i=e;for(let n=0,s=o.length;n<s;++n){let d=o[n],u=n===0?e:i.parentNode.insertBefore(document.createTextNode(""),i.nextSibling);typeof d=="string"?u.textContent=d:(u.textContent=" ",r.captureContentBinding(d)),i=u,r.targetIndex++,u!==e&&t.nextNode()}r.targetIndex--}}function vS(r,e){let t=r.content;document.adoptNode(t);let o=nv.borrow(e);mS(o,r,!0);let i=o.behaviorFactories;o.reset();let n=W.createTemplateWalker(t),s;for(;s=n.nextNode();)switch(o.targetIndex++,s.nodeType){case 1:mS(o,s);break;case 3:fP(o,s,n);break;case 8:W.isMarker(s)&&o.addFactory(e[W.extractDirectiveIndexFromMarker(s)])}let d=0;(W.isMarker(t.firstChild)||t.childNodes.length===1&&e.length)&&(t.insertBefore(document.createComment(""),t.firstChild),d=-1);let u=o.behaviorFactories;return o.release(),{fragment:t,viewBehaviorFactories:u,hostBehaviorFactories:i,targetOffset:d}}var iv,nv,pP,sv=y(()=>{a();l();c();Qo();qh();iv=null,nv=class r{addFactory(e){e.targetIndex=this.targetIndex,this.behaviorFactories.push(e)}captureContentBinding(e){e.targetAtContent(),this.addFactory(e)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){iv=this}static borrow(e){let t=iv||new r;return t.directives=e,t.reset(),iv=null,t}};pP=zh.length});var av,Sl,Gh=y(()=>{a();l();c();av=document.createRange(),Sl=class{constructor(e,t){this.fragment=e,this.behaviors=t,this.source=null,this.context=null,this.firstChild=e.firstChild,this.lastChild=e.lastChild}appendTo(e){e.appendChild(this.fragment)}insertBefore(e){if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{let t=this.lastChild;if(e.previousSibling===t)return;let o=e.parentNode,i=this.firstChild,n;for(;i!==t;)n=i.nextSibling,o.insertBefore(i,e),i=n;o.insertBefore(t,e)}}remove(){let e=this.fragment,t=this.lastChild,o=this.firstChild,i;for(;o!==t;)i=o.nextSibling,e.appendChild(o),o=i;e.appendChild(t)}dispose(){let e=this.firstChild.parentNode,t=this.lastChild,o=this.firstChild,i;for(;o!==t;)i=o.nextSibling,e.removeChild(o),o=i;e.removeChild(t);let n=this.behaviors,s=this.source;for(let d=0,u=n.length;d<u;++d)n[d].unbind(s)}bind(e,t){let o=this.behaviors;if(this.source!==e)if(this.source!==null){let i=this.source;this.source=e,this.context=t;for(let n=0,s=o.length;n<s;++n){let d=o[n];d.unbind(i),d.bind(e,t)}}else{this.source=e,this.context=t;for(let i=0,n=o.length;i<n;++i)o[i].bind(e,t)}}unbind(){if(this.source===null)return;let e=this.behaviors,t=this.source;for(let o=0,i=e.length;o<i;++o)e[o].unbind(t);this.source=null}static disposeContiguousBatch(e){if(e.length!==0){av.setStartBefore(e[0].firstChild),av.setEndAfter(e[e.length-1].lastChild),av.deleteContents();for(let t=0,o=e.length;t<o;++t){let i=e[t],n=i.behaviors,s=i.source;for(let d=0,u=n.length;d<u;++d)n[d].unbind(s)}}}}});function R(r,...e){let t=[],o="";for(let i=0,n=r.length-1;i<n;++i){let s=r[i],d=e[i];if(o+=s,d instanceof jh){let u=d;d=()=>u}if(typeof d=="function"&&(d=new ya(d)),d instanceof xl){let u=mP.exec(s);u!==null&&(d.targetName=u[2])}d instanceof ns?(o+=d.createPlaceholder(t.length),t.push(d)):o+=d}return o+=r[r.length-1],new jh(o,t)}var jh,mP,yS=y(()=>{a();l();c();Qo();Bi();sv();Gh();ss();qh();jh=class{constructor(e,t){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=e,this.directives=t}create(e){if(this.fragment===null){let h,p=this.html;if(typeof p=="string"){h=document.createElement("template"),h.innerHTML=W.createHTML(p);let C=h.content.firstElementChild;C!==null&&C.tagName==="TEMPLATE"&&(h=C)}else h=p;let v=vS(h,this.directives);this.fragment=v.fragment,this.viewBehaviorFactories=v.viewBehaviorFactories,this.hostBehaviorFactories=v.hostBehaviorFactories,this.targetOffset=v.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}let t=this.fragment.cloneNode(!0),o=this.viewBehaviorFactories,i=new Array(this.behaviorCount),n=W.createTemplateWalker(t),s=0,d=this.targetOffset,u=n.nextNode();for(let h=o.length;s<h;++s){let p=o[s],v=p.targetIndex;for(;u!==null;)if(d===v){i[s]=p.createBehavior(u);break}else u=n.nextNode(),d++}if(this.hasHostBehaviors){let h=this.hostBehaviorFactories;for(let p=0,v=h.length;p<v;++p,++s)i[s]=h[p].createBehavior(e)}return new Sl(t,i)}render(e,t,o){typeof t=="string"&&(t=document.getElementById(t)),o===void 0&&(o=t);let i=this.create(o);return i.bind(e,is),i.appendTo(t),i}},mP=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/});function dv(r){return r.map(e=>e instanceof Yt?dv(e.styles):[e]).reduce((e,t)=>e.concat(t),[])}function bS(r){return r.map(e=>e instanceof Yt?e.behaviors:null).reduce((e,t)=>t===null?e:(e===null&&(e=[]),e.concat(t)),null)}function vP(){return`fast-style-class-${++gP}`}var Yt,CS,wS,lv,gP,cv,Kh=y(()=>{a();l();c();Qo();Yt=class{constructor(){this.targets=new WeakSet}addStylesTo(e){this.targets.add(e)}removeStylesFrom(e){this.targets.delete(e)}isAttachedTo(e){return this.targets.has(e)}withBehaviors(...e){return this.behaviors=this.behaviors===null?e:this.behaviors.concat(e),this}};Yt.create=(()=>{if(W.supportsAdoptedStyleSheets){let r=new Map;return e=>new lv(e,r)}return r=>new cv(r)})();CS=(r,e)=>{r.adoptedStyleSheets=[...r.adoptedStyleSheets,...e]},wS=(r,e)=>{r.adoptedStyleSheets=r.adoptedStyleSheets.filter(t=>e.indexOf(t)===-1)};if(W.supportsAdoptedStyleSheets)try{document.adoptedStyleSheets.push(),document.adoptedStyleSheets.splice(),CS=(r,e)=>{r.adoptedStyleSheets.push(...e)},wS=(r,e)=>{for(let t of e){let o=r.adoptedStyleSheets.indexOf(t);o!==-1&&r.adoptedStyleSheets.splice(o,1)}}}catch{}lv=class extends Yt{constructor(e,t){super(),this.styles=e,this.styleSheetCache=t,this._styleSheets=void 0,this.behaviors=bS(e)}get styleSheets(){if(this._styleSheets===void 0){let e=this.styles,t=this.styleSheetCache;this._styleSheets=dv(e).map(o=>{if(o instanceof CSSStyleSheet)return o;let i=t.get(o);return i===void 0&&(i=new CSSStyleSheet,i.replaceSync(o),t.set(o,i)),i})}return this._styleSheets}addStylesTo(e){CS(e,this.styleSheets),super.addStylesTo(e)}removeStylesFrom(e){wS(e,this.styleSheets),super.removeStylesFrom(e)}},gP=0;cv=class extends Yt{constructor(e){super(),this.styles=e,this.behaviors=null,this.behaviors=bS(e),this.styleSheets=dv(e),this.styleClass=vP()}addStylesTo(e){let t=this.styleSheets,o=this.styleClass;e=this.normalizeTarget(e);for(let i=0;i<t.length;i++){let n=document.createElement("style");n.innerHTML=t[i],n.className=o,e.append(n)}super.addStylesTo(e)}removeStylesFrom(e){e=this.normalizeTarget(e);let t=e.querySelectorAll(`.${this.styleClass}`);for(let o=0,i=t.length;o<i;++o)e.removeChild(t[o]);super.removeStylesFrom(e)}isAttachedTo(e){return super.isAttachedTo(this.normalizeTarget(e))}normalizeTarget(e){return e===document?document.body:e}}});function w(r,e){let t;function o(i,n){arguments.length>1&&(t.property=n),dd.locate(i.constructor).push(t)}if(arguments.length>1){t={},o(r,e);return}return t=r===void 0?{}:r,o}var dd,_n,ee,Wh,uv=y(()=>{a();l();c();Bi();Qo();xn();dd=Object.freeze({locate:Vh()}),_n={toView(r){return r?"true":"false"},fromView(r){return!(r==null||r==="false"||r===!1||r===0)}},ee={toView(r){if(r==null)return null;let e=r*1;return isNaN(e)?null:e.toString()},fromView(r){if(r==null)return null;let e=r*1;return isNaN(e)?null:e}},Wh=class r{constructor(e,t,o=t.toLowerCase(),i="reflect",n){this.guards=new Set,this.Owner=e,this.name=t,this.attribute=o,this.mode=i,this.converter=n,this.fieldName=`_${t}`,this.callbackName=`${t}Changed`,this.hasCallback=this.callbackName in e.prototype,i==="boolean"&&n===void 0&&(this.converter=_n)}setValue(e,t){let o=e[this.fieldName],i=this.converter;i!==void 0&&(t=i.fromView(t)),o!==t&&(e[this.fieldName]=t,this.tryReflectToAttribute(e),this.hasCallback&&e[this.callbackName](o,t),e.$fastController.notify(this.name))}getValue(e){return ce.track(e,this.name),e[this.fieldName]}onAttributeChangedCallback(e,t){this.guards.has(e)||(this.guards.add(e),this.setValue(e,t),this.guards.delete(e))}tryReflectToAttribute(e){let t=this.mode,o=this.guards;o.has(e)||t==="fromView"||W.queueUpdate(()=>{o.add(e);let i=e[this.fieldName];switch(t){case"reflect":let n=this.converter;W.setAttribute(e,this.attribute,n!==void 0?n.toView(i):i);break;case"boolean":W.setBooleanAttribute(e,this.attribute,i);break}o.delete(e)})}static collect(e,...t){let o=[];t.push(dd.locate(e));for(let i=0,n=t.length;i<n;++i){let s=t[i];if(s!==void 0)for(let d=0,u=s.length;d<u;++d){let h=s[d];typeof h=="string"?o.push(new r(e,h)):o.push(new r(e,h.property,h.attribute,h.mode,h.converter))}}return o}}});var xS,SS,hv,Vi,Qh=y(()=>{a();l();c();xn();Bi();Kh();uv();xS={mode:"open"},SS={},hv=va.getById(4,()=>{let r=new Map;return Object.freeze({register(e){return r.has(e.type)?!1:(r.set(e.type,e),!0)},getByType(e){return r.get(e)}})}),Vi=class{constructor(e,t=e.definition){typeof t=="string"&&(t={name:t}),this.type=e,this.name=t.name,this.template=t.template;let o=Wh.collect(e,t.attributes),i=new Array(o.length),n={},s={};for(let d=0,u=o.length;d<u;++d){let h=o[d];i[d]=h.attribute,n[h.name]=h,s[h.attribute]=h}this.attributes=o,this.observedAttributes=i,this.propertyLookup=n,this.attributeLookup=s,this.shadowOptions=t.shadowOptions===void 0?xS:t.shadowOptions===null?void 0:Object.assign(Object.assign({},xS),t.shadowOptions),this.elementOptions=t.elementOptions===void 0?SS:Object.assign(Object.assign({},SS),t.elementOptions),this.styles=t.styles===void 0?void 0:Array.isArray(t.styles)?Yt.create(t.styles):t.styles instanceof Yt?t.styles:Yt.create([t.styles])}get isDefined(){return!!hv.getByType(this.type)}define(e=customElements){let t=this.type;if(hv.register(this)){let o=this.attributes,i=t.prototype;for(let n=0,s=o.length;n<s;++n)ce.defineProperty(i,o[n]);Reflect.defineProperty(t,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return e.get(this.name)||e.define(this.name,t,this.elementOptions),this}};Vi.forType=hv.getByType});function pv(r){return r.shadowRoot||_S.get(r)||null}var _S,yP,Yh,fv=y(()=>{a();l();c();Qo();cd();Bi();Qh();_S=new WeakMap,yP={bubbles:!0,composed:!0,cancelable:!0};Yh=class r extends wl{constructor(e,t){super(e),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=e,this.definition=t;let o=t.shadowOptions;if(o!==void 0){let n=e.attachShadow(o);o.mode==="closed"&&_S.set(e,n)}let i=ce.getAccessors(e);if(i.length>0){let n=this.boundObservables=Object.create(null);for(let s=0,d=i.length;s<d;++s){let u=i[s].name,h=e[u];h!==void 0&&(delete e[u],n[u]=h)}}}get isConnected(){return ce.track(this,"isConnected"),this._isConnected}setIsConnected(e){this._isConnected=e,ce.notify(this,"isConnected")}get template(){return this._template}set template(e){this._template!==e&&(this._template=e,this.needsInitialization||this.renderTemplate(e))}get styles(){return this._styles}set styles(e){this._styles!==e&&(this._styles!==null&&this.removeStyles(this._styles),this._styles=e,!this.needsInitialization&&e!==null&&this.addStyles(e))}addStyles(e){let t=pv(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.append(e);else if(!e.isAttachedTo(t)){let o=e.behaviors;e.addStylesTo(t),o!==null&&this.addBehaviors(o)}}removeStyles(e){let t=pv(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.removeChild(e);else if(e.isAttachedTo(t)){let o=e.behaviors;e.removeStylesFrom(t),o!==null&&this.removeBehaviors(o)}}addBehaviors(e){let t=this.behaviors||(this.behaviors=new Map),o=e.length,i=[];for(let n=0;n<o;++n){let s=e[n];t.has(s)?t.set(s,t.get(s)+1):(t.set(s,1),i.push(s))}if(this._isConnected){let n=this.element;for(let s=0;s<i.length;++s)i[s].bind(n,is)}}removeBehaviors(e,t=!1){let o=this.behaviors;if(o===null)return;let i=e.length,n=[];for(let s=0;s<i;++s){let d=e[s];if(o.has(d)){let u=o.get(d)-1;u===0||t?o.delete(d)&&n.push(d):o.set(d,u)}}if(this._isConnected){let s=this.element;for(let d=0;d<n.length;++d)n[d].unbind(s)}}onConnectedCallback(){if(this._isConnected)return;let e=this.element;this.needsInitialization?this.finishInitialization():this.view!==null&&this.view.bind(e,is);let t=this.behaviors;if(t!==null)for(let[o]of t)o.bind(e,is);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);let e=this.view;e!==null&&e.unbind();let t=this.behaviors;if(t!==null){let o=this.element;for(let[i]of t)i.unbind(o)}}onAttributeChangedCallback(e,t,o){let i=this.definition.attributeLookup[e];i!==void 0&&i.onAttributeChangedCallback(this.element,o)}emit(e,t,o){return this._isConnected?this.element.dispatchEvent(new CustomEvent(e,Object.assign(Object.assign({detail:t},yP),o))):!1}finishInitialization(){let e=this.element,t=this.boundObservables;if(t!==null){let i=Object.keys(t);for(let n=0,s=i.length;n<s;++n){let d=i[n];e[d]=t[d]}this.boundObservables=null}let o=this.definition;this._template===null&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():o.template&&(this._template=o.template||null)),this._template!==null&&this.renderTemplate(this._template),this._styles===null&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():o.styles&&(this._styles=o.styles||null)),this._styles!==null&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(e){let t=this.element,o=pv(t)||t;this.view!==null?(this.view.dispose(),this.view=null):this.needsInitialization||W.removeChildNodes(o),e&&(this.view=e.render(t,o,t))}static forCustomElement(e){let t=e.$fastController;if(t!==void 0)return t;let o=Vi.forType(e.constructor);if(o===void 0)throw new Error("Missing FASTElement definition.");return e.$fastController=new r(e,o)}}});function ES(r){return class extends r{constructor(){super(),Yh.forCustomElement(this)}$emit(e,t,o){return this.$fastController.emit(e,t,o)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(e,t,o){this.$fastController.onAttributeChangedCallback(e,t,o)}}}var as,TS=y(()=>{a();l();c();fv();Qh();as=Object.assign(ES(HTMLElement),{from(r){return ES(r)},define(r,e){return new Vi(r,e).define().type}})});var ls,mv=y(()=>{a();l();c();ls=class{createCSS(){return""}createBehavior(){}}});function kS(r,e){let t=[],o="",i=[];for(let n=0,s=r.length-1;n<s;++n){o+=r[n];let d=e[n];if(d instanceof ls){let u=d.createBehavior();d=d.createCSS(),u&&i.push(u)}d instanceof Yt||d instanceof CSSStyleSheet?(o.trim()!==""&&(t.push(o),o=""),t.push(d)):o+=d}return o+=r[r.length-1],o.trim()!==""&&t.push(o),{styles:t,behaviors:i}}function P(r,...e){let{styles:t,behaviors:o}=kS(r,e),i=Yt.create(t);return o.length&&i.withBehaviors(...o),i}function _r(r,...e){let{styles:t,behaviors:o}=kS(r,e);return new gv(t,o)}var gv,IS=y(()=>{a();l();c();mv();Kh();gv=class extends ls{constructor(e,t){super(),this.behaviors=t,this.css="";let o=e.reduce((i,n)=>(typeof n=="string"?this.css+=n:i.push(n),i),[]);o.length&&(this.styles=Yt.create(o))}createBehavior(){return this}createCSS(){return this.css}bind(e){this.styles&&e.$fastController.addStyles(this.styles),this.behaviors.length&&e.$fastController.addBehaviors(this.behaviors)}unbind(e){this.styles&&e.$fastController.removeStyles(this.styles),this.behaviors.length&&e.$fastController.removeBehaviors(this.behaviors)}}});function Yo(r,e,t){return{index:r,removed:e,addedCount:t}}function bP(r,e,t,o,i,n){let s=n-i+1,d=t-e+1,u=new Array(s),h,p;for(let v=0;v<s;++v)u[v]=new Array(d),u[v][0]=v;for(let v=0;v<d;++v)u[0][v]=v;for(let v=1;v<s;++v)for(let C=1;C<d;++C)r[e+C-1]===o[i+v-1]?u[v][C]=u[v-1][C-1]:(h=u[v-1][C]+1,p=u[v][C-1]+1,u[v][C]=h<p?h:p);return u}function CP(r){let e=r.length-1,t=r[0].length-1,o=r[e][t],i=[];for(;e>0||t>0;){if(e===0){i.push(vv),t--;continue}if(t===0){i.push(yv),e--;continue}let n=r[e-1][t-1],s=r[e-1][t],d=r[e][t-1],u;s<d?u=s<n?s:n:u=d<n?d:n,u===n?(n===o?i.push(RS):(i.push(PS),o=n),e--,t--):u===s?(i.push(yv),e--,o=s):(i.push(vv),t--,o=d)}return i.reverse(),i}function wP(r,e,t){for(let o=0;o<t;++o)if(r[o]!==e[o])return o;return t}function xP(r,e,t){let o=r.length,i=e.length,n=0;for(;n<t&&r[--o]===e[--i];)n++;return n}function SP(r,e,t,o){return e<t||o<r?-1:e===t||o===r?0:r<t?e<o?e-t:o-t:o<e?o-r:e-r}function bv(r,e,t,o,i,n){let s=0,d=0,u=Math.min(t-e,n-i);if(e===0&&i===0&&(s=wP(r,o,u)),t===r.length&&n===o.length&&(d=xP(r,o,u-s)),e+=s,i+=s,t-=d,n-=d,t-e===0&&n-i===0)return Wo;if(e===t){let E=Yo(e,[],0);for(;i<n;)E.removed.push(o[i++]);return[E]}else if(i===n)return[Yo(e,[],t-e)];let h=CP(bP(r,e,t,o,i,n)),p=[],v,C=e,x=i;for(let E=0;E<h.length;++E)switch(h[E]){case RS:v!==void 0&&(p.push(v),v=void 0),C++,x++;break;case PS:v===void 0&&(v=Yo(C,[],0)),v.addedCount++,C++,v.removed.push(o[x]),x++;break;case vv:v===void 0&&(v=Yo(C,[],0)),v.addedCount++,C++;break;case yv:v===void 0&&(v=Yo(C,[],0)),v.removed.push(o[x]),x++;break}return v!==void 0&&p.push(v),p}function _P(r,e,t,o){let i=Yo(e,t,o),n=!1,s=0;for(let d=0;d<r.length;d++){let u=r[d];if(u.index+=s,n)continue;let h=SP(i.index,i.index+i.removed.length,u.index,u.index+u.addedCount);if(h>=0){r.splice(d,1),d--,s-=u.addedCount-u.removed.length,i.addedCount+=u.addedCount-h;let p=i.removed.length+u.removed.length-h;if(!i.addedCount&&!p)n=!0;else{let v=u.removed;if(i.index<u.index){let C=i.removed.slice(0,u.index-i.index);AS.apply(C,v),v=C}if(i.index+i.removed.length>u.index+u.addedCount){let C=i.removed.slice(u.index+u.addedCount-i.index);AS.apply(v,C)}i.removed=v,u.index<i.index&&(i.index=u.index)}}else if(i.index<u.index){n=!0,r.splice(d,0,i),d++;let p=i.addedCount-i.removed.length;u.index+=p,s+=p}}n||r.push(i)}function EP(r){let e=[];for(let t=0,o=r.length;t<o;t++){let i=r[t];_P(e,i.index,i.removed,i.addedCount)}return e}function OS(r,e){let t=[],o=EP(e);for(let i=0,n=o.length;i<n;++i){let s=o[i];if(s.addedCount===1&&s.removed.length===1){s.removed[0]!==r[s.index]&&t.push(s);continue}t=t.concat(bv(r,s.index,s.index+s.addedCount,s.removed,0,s.removed.length))}return t}var RS,PS,vv,yv,AS,Cv=y(()=>{a();l();c();xn();RS=0,PS=1,vv=2,yv=3;AS=Array.prototype.push});function wv(r,e){let t=r.index,o=e.length;return t>o?t=o-r.addedCount:t<0&&(t=o+r.removed.length+t-r.addedCount),t<0&&(t=0),r.index=t,r}function Sv(){if($S)return;$S=!0,ce.setArrayObserverFactory(u=>new xv(u));let r=Array.prototype;if(r.$fastPatch)return;Reflect.defineProperty(r,"$fastPatch",{value:1,enumerable:!1});let e=r.pop,t=r.push,o=r.reverse,i=r.shift,n=r.sort,s=r.splice,d=r.unshift;r.pop=function(){let u=this.length>0,h=e.apply(this,arguments),p=this.$fastController;return p!==void 0&&u&&p.addSplice(Yo(this.length,[h],0)),h},r.push=function(){let u=t.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(wv(Yo(this.length-arguments.length,[],arguments.length),this)),u},r.reverse=function(){let u,h=this.$fastController;h!==void 0&&(h.flush(),u=this.slice());let p=o.apply(this,arguments);return h!==void 0&&h.reset(u),p},r.shift=function(){let u=this.length>0,h=i.apply(this,arguments),p=this.$fastController;return p!==void 0&&u&&p.addSplice(Yo(0,[h],0)),h},r.sort=function(){let u,h=this.$fastController;h!==void 0&&(h.flush(),u=this.slice());let p=n.apply(this,arguments);return h!==void 0&&h.reset(u),p},r.splice=function(){let u=s.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(wv(Yo(+arguments[0],u,arguments.length>2?arguments.length-2:0),this)),u},r.unshift=function(){let u=d.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(wv(Yo(0,[],arguments.length),this)),u}}var $S,xv,_v=y(()=>{a();l();c();Qo();Cv();cd();Bi();$S=!1;xv=class extends Ui{constructor(e){super(e),this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this.call=this.flush,Reflect.defineProperty(e,"$fastController",{value:this,enumerable:!1})}subscribe(e){this.flush(),super.subscribe(e)}addSplice(e){this.splices===void 0?this.splices=[e]:this.splices.push(e),this.needsQueue&&(this.needsQueue=!1,W.queueUpdate(this))}reset(e){this.oldCollection=e,this.needsQueue&&(this.needsQueue=!1,W.queueUpdate(this))}flush(){let e=this.splices,t=this.oldCollection;if(e===void 0&&t===void 0)return;this.needsQueue=!0,this.splices=void 0,this.oldCollection=void 0;let o=t===void 0?OS(this.source,e):bv(this.source,0,this.source.length,t,0,t.length);this.notify(o)}}});function we(r){return new Sn("fast-ref",Ev,r)}var Ev,MS=y(()=>{a();l();c();ss();Ev=class{constructor(e,t){this.target=e,this.propertyName=t}bind(e){e[this.propertyName]=this.target}unbind(){}}});var Tv,FS=y(()=>{a();l();c();Tv=r=>typeof r=="function"});function DS(r){return r===void 0?TP:Tv(r)?r:()=>r}function Qe(r,e,t){let o=Tv(r)?r:()=>r,i=DS(e),n=DS(t);return(s,d)=>o(s,d)?i(s,d):n(s,d)}var TP,LS=y(()=>{a();l();c();FS();TP=()=>null});function kP(r,e,t,o){r.bind(e[t],o)}function IP(r,e,t,o){let i=Object.create(o);i.index=t,i.length=e.length,r.bind(e[t],i)}function ba(r,e,t=NS){let o=typeof e=="function"?e:()=>e;return new zi(r,o,Object.assign(Object.assign({},NS),t))}var NS,kv,zi,HS=y(()=>{a();l();c();Qo();Bi();_v();xn();ss();Gh();NS=Object.freeze({positioning:!1,recycle:!0});kv=class{constructor(e,t,o,i,n,s){this.location=e,this.itemsBinding=t,this.templateBinding=i,this.options=s,this.source=null,this.views=[],this.items=null,this.itemsObserver=null,this.originalContext=void 0,this.childContext=void 0,this.bindView=kP,this.itemsBindingObserver=ce.binding(t,this,o),this.templateBindingObserver=ce.binding(i,this,n),s.positioning&&(this.bindView=IP)}bind(e,t){this.source=e,this.originalContext=t,this.childContext=Object.create(t),this.childContext.parent=e,this.childContext.parentContext=this.originalContext,this.items=this.itemsBindingObserver.observe(e,this.originalContext),this.template=this.templateBindingObserver.observe(e,this.originalContext),this.observeItems(!0),this.refreshAllViews()}unbind(){this.source=null,this.items=null,this.itemsObserver!==null&&this.itemsObserver.unsubscribe(this),this.unbindAllViews(),this.itemsBindingObserver.disconnect(),this.templateBindingObserver.disconnect()}handleChange(e,t){e===this.itemsBinding?(this.items=this.itemsBindingObserver.observe(this.source,this.originalContext),this.observeItems(),this.refreshAllViews()):e===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.originalContext),this.refreshAllViews(!0)):this.updateViews(t)}observeItems(e=!1){if(!this.items){this.items=Wo;return}let t=this.itemsObserver,o=this.itemsObserver=ce.getNotifier(this.items),i=t!==o;i&&t!==null&&t.unsubscribe(this),(i||e)&&o.subscribe(this)}updateViews(e){let t=this.childContext,o=this.views,i=this.bindView,n=this.items,s=this.template,d=this.options.recycle,u=[],h=0,p=0;for(let v=0,C=e.length;v<C;++v){let x=e[v],E=x.removed,O=0,q=x.index,_e=q+x.addedCount,se=o.splice(x.index,E.length),ke=p=u.length+se.length;for(;q<_e;++q){let Tt=o[q],Gt=Tt?Tt.firstChild:this.location,Lt;d&&p>0?(O<=ke&&se.length>0?(Lt=se[O],O++):(Lt=u[h],h++),p--):Lt=s.create(),o.splice(q,0,Lt),i(Lt,n,q,t),Lt.insertBefore(Gt)}se[O]&&u.push(...se.slice(O))}for(let v=h,C=u.length;v<C;++v)u[v].dispose();if(this.options.positioning)for(let v=0,C=o.length;v<C;++v){let x=o[v].context;x.length=C,x.index=v}}refreshAllViews(e=!1){let t=this.items,o=this.childContext,i=this.template,n=this.location,s=this.bindView,d=t.length,u=this.views,h=u.length;if((d===0||e||!this.options.recycle)&&(Sl.disposeContiguousBatch(u),h=0),h===0){this.views=u=new Array(d);for(let p=0;p<d;++p){let v=i.create();s(v,t,p,o),u[p]=v,v.insertBefore(n)}}else{let p=0;for(;p<d;++p)if(p<h){let C=u[p];s(C,t,p,o)}else{let C=i.create();s(C,t,p,o),u.push(C),C.insertBefore(n)}let v=u.splice(p,h-p);for(p=0,d=v.length;p<d;++p)v[p].dispose()}}unbindAllViews(){let e=this.views;for(let t=0,o=e.length;t<o;++t)e[t].unbind()}},zi=class extends ns{constructor(e,t,o){super(),this.itemsBinding=e,this.templateBinding=t,this.options=o,this.createPlaceholder=W.createBlockPlaceholder,Sv(),this.isItemsBindingVolatile=ce.isVolatileBinding(e),this.isTemplateBindingVolatile=ce.isVolatileBinding(t)}createBehavior(e){return new kv(e,this.itemsBinding,this.isItemsBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile,this.options)}}});function Er(r){return r?function(e,t,o){return e.nodeType===1&&e.matches(r)}:function(e,t,o){return e.nodeType===1}}var _l,Zh=y(()=>{a();l();c();Bi();xn();_l=class{constructor(e,t){this.target=e,this.options=t,this.source=null}bind(e){let t=this.options.property;this.shouldUpdate=ce.getAccessors(e).some(o=>o.name===t),this.source=e,this.updateTarget(this.computeNodes()),this.shouldUpdate&&this.observe()}unbind(){this.updateTarget(Wo),this.source=null,this.shouldUpdate&&this.disconnect()}handleEvent(){this.updateTarget(this.computeNodes())}computeNodes(){let e=this.getNodes();return this.options.filter!==void 0&&(e=e.filter(this.options.filter)),e}updateTarget(e){this.source[this.options.property]=e}}});function Oe(r){return typeof r=="string"&&(r={property:r}),new Sn("fast-slotted",Iv,r)}var Iv,US=y(()=>{a();l();c();ss();Zh();Iv=class extends _l{constructor(e,t){super(e,t)}observe(){this.target.addEventListener("slotchange",this)}disconnect(){this.target.removeEventListener("slotchange",this)}getNodes(){return this.target.assignedNodes(this.options)}}});function cs(r){return typeof r=="string"&&(r={property:r}),new Sn("fast-children",Av,r)}var Av,BS=y(()=>{a();l();c();ss();Zh();Av=class extends _l{constructor(e,t){super(e,t),this.observer=null,t.childList=!0}observe(){this.observer===null&&(this.observer=new MutationObserver(this.handleEvent.bind(this))),this.observer.observe(this.target,this.options)}disconnect(){this.observer.disconnect()}getNodes(){return"subtree"in this.options?Array.from(this.target.querySelectorAll(this.options.selector)):Array.from(this.target.childNodes)}}});var I=y(()=>{a();l();c();xn();yS();TS();Qh();uv();fv();sv();Kh();IS();mv();Gh();Bi();cd();Cv();_v();Qo();qh();ss();MS();LS();HS();US();BS();Zh()});var mt,ht,pt,VS,zS,St=y(()=>{a();l();c();I();mt=class{handleStartContentChange(){this.startContainer.classList.toggle("start",this.start.assignedNodes().length>0)}handleEndContentChange(){this.endContainer.classList.toggle("end",this.end.assignedNodes().length>0)}},ht=(r,e)=>R`
    <span
        part="end"
        ${we("endContainer")}
        class=${t=>e.end?"end":void 0}
    >
        <slot name="end" ${we("end")} @slotchange="${t=>t.handleEndContentChange()}">
            ${e.end||""}
        </slot>
    </span>
`,pt=(r,e)=>R`
    <span
        part="start"
        ${we("startContainer")}
        class="${t=>e.start?"start":void 0}"
    >
        <slot
            name="start"
            ${we("start")}
            @slotchange="${t=>t.handleStartContentChange()}"
        >
            ${e.start||""}
        </slot>
    </span>
`,VS=R`
    <span part="end" ${we("endContainer")}>
        <slot
            name="end"
            ${we("end")}
            @slotchange="${r=>r.handleEndContentChange()}"
        ></slot>
    </span>
`,zS=R`
    <span part="start" ${we("startContainer")}>
        <slot
            name="start"
            ${we("start")}
            @slotchange="${r=>r.handleStartContentChange()}"
        ></slot>
    </span>
`});var qS,GS=y(()=>{a();l();c();I();St();qS=(r,e)=>R`
    <template class="${t=>t.expanded?"expanded":""}">
        <div
            class="heading"
            part="heading"
            role="heading"
            aria-level="${t=>t.headinglevel}"
        >
            <button
                class="button"
                part="button"
                ${we("expandbutton")}
                aria-expanded="${t=>t.expanded}"
                aria-controls="${t=>t.id}-panel"
                id="${t=>t.id}"
                @click="${(t,o)=>t.clickHandler(o.event)}"
            >
                <span class="heading-content" part="heading-content">
                    <slot name="heading"></slot>
                </span>
            </button>
            ${pt(r,e)}
            ${ht(r,e)}
            <span class="icon" part="icon" aria-hidden="true">
                <slot name="expanded-icon" part="expanded-icon">
                    ${e.expandedIcon||""}
                </slot>
                <slot name="collapsed-icon" part="collapsed-icon">
                    ${e.collapsedIcon||""}
                </slot>
            <span>
        </div>
        <div
            class="region"
            part="region"
            id="${t=>t.id}-panel"
            role="region"
            aria-labelledby="${t=>t.id}"
        >
            <slot></slot>
        </div>
    </template>
`});function b(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n}var Ie=y(()=>{a();l();c();});function ud(r){let e=r.slice(),t=Object.keys(r),o=t.length,i;for(let n=0;n<o;++n)i=t[n],o_(i)||(e[i]=r[i]);return e}function KS(r){return e=>Reflect.getOwnMetadata(r,e)}function tp(r){return function(e){let t=function(o,i,n){Ct.inject(t)(o,i,n)};return t.$isResolver=!0,t.resolve=function(o,i){return r(e,o,i)},t}}function OP(r){return function(e,t){t=!!t;let o=function(i,n,s){Ct.inject(o)(i,n,s)};return o.$isResolver=!0,o.resolve=function(i,n){return r(e,i,n,t)},o}}function Dv(r,e,t){Ct.inject(Dv)(r,e,t)}function e_(r,e){return e.getFactory(r).construct(e)}function QS(r){return this.get(r)}function $P(r,e){return e(r)}function ep(r){return typeof r.register=="function"}function FP(r){return ep(r)&&typeof r.registerInRequestor=="boolean"}function YS(r){return FP(r)&&r.registerInRequestor}function DP(r){return r.prototype!==void 0}function r_(r){return function(e,t,o){if($v.has(o))return $v.get(o);let i=r(e,t,o);return $v.set(o,i),i}}function Jh(r){if(r==null)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}function ZS(r,e,t){if(r instanceof so&&r.strategy===4){let o=r.state,i=o.length,n=new Array(i);for(;i--;)n[i]=o[i].resolve(e,t);return n}return[r.resolve(e,t)]}function XS(r){return typeof r=="object"&&r!==null||typeof r=="function"}function o_(r){switch(typeof r){case"number":return r>=0&&(r|0)===r;case"string":{let e=Xh[r];if(e!==void 0)return e;let t=r.length;if(t===0)return Xh[r]=!1;let o=0;for(let i=0;i<t;++i)if(o=r.charCodeAt(i),i===0&&o===48&&t>1||o<48||o>57)return Xh[r]=!1;return Xh[r]=!0}default:return!1}}var Rv,Mv,AP,Pv,jS,WS,Ct,RP,yve,PP,bve,Cve,wve,xve,Sve,so,Fv,MP,LP,t_,Ov,hd,$v,Ca,JS,NP,Xh,rp=y(()=>{a();l();c();I();Rv=new Map;"metadata"in Reflect||(Reflect.metadata=function(r,e){return function(t){Reflect.defineMetadata(r,e,t)}},Reflect.defineMetadata=function(r,e,t){let o=Rv.get(t);o===void 0&&Rv.set(t,o=new Map),o.set(r,e)},Reflect.getOwnMetadata=function(r,e){let t=Rv.get(e);if(t!==void 0)return t.get(r)});Mv=class{constructor(e,t){this.container=e,this.key=t}instance(e){return this.registerResolver(0,e)}singleton(e){return this.registerResolver(1,e)}transient(e){return this.registerResolver(2,e)}callback(e){return this.registerResolver(3,e)}cachedCallback(e){return this.registerResolver(3,r_(e))}aliasTo(e){return this.registerResolver(5,e)}registerResolver(e,t){let{container:o,key:i}=this;return this.container=this.key=void 0,o.registerResolver(i,new so(i,e,t))}};AP=Object.freeze({none(r){throw Error(`${r.toString()} not registered, did you forget to add @singleton()?`)},singleton(r){return new so(r,1,r)},transient(r){return new so(r,2,r)}}),Pv=Object.freeze({default:Object.freeze({parentLocator:()=>null,responsibleForOwnerRequests:!1,defaultResolver:AP.singleton})}),jS=new Map;WS=null,Ct=Object.freeze({createContainer(r){return new hd(null,Object.assign({},Pv.default,r))},findResponsibleContainer(r){let e=r.$$container$$;return e&&e.responsibleForOwnerRequests?e:Ct.findParentContainer(r)},findParentContainer(r){let e=new CustomEvent(t_,{bubbles:!0,composed:!0,cancelable:!0,detail:{container:void 0}});return r.dispatchEvent(e),e.detail.container||Ct.getOrCreateDOMContainer()},getOrCreateDOMContainer(r,e){return r?r.$$container$$||new hd(r,Object.assign({},Pv.default,e,{parentLocator:Ct.findParentContainer})):WS||(WS=new hd(null,Object.assign({},Pv.default,e,{parentLocator:()=>null})))},getDesignParamtypes:KS("design:paramtypes"),getAnnotationParamtypes:KS("di:paramtypes"),getOrCreateAnnotationParamTypes(r){let e=this.getAnnotationParamtypes(r);return e===void 0&&Reflect.defineMetadata("di:paramtypes",e=[],r),e},getDependencies(r){let e=jS.get(r);if(e===void 0){let t=r.inject;if(t===void 0){let o=Ct.getDesignParamtypes(r),i=Ct.getAnnotationParamtypes(r);if(o===void 0)if(i===void 0){let n=Object.getPrototypeOf(r);typeof n=="function"&&n!==Function.prototype?e=ud(Ct.getDependencies(n)):e=[]}else e=ud(i);else if(i===void 0)e=ud(o);else{e=ud(o);let n=i.length,s;for(let h=0;h<n;++h)s=i[h],s!==void 0&&(e[h]=s);let d=Object.keys(i);n=d.length;let u;for(let h=0;h<n;++h)u=d[h],o_(u)||(e[u]=i[u])}}else e=ud(t);jS.set(r,e)}return e},defineProperty(r,e,t,o=!1){let i=`$di_${e}`;Reflect.defineProperty(r,e,{get:function(){let n=this[i];if(n===void 0&&(n=(this instanceof HTMLElement?Ct.findResponsibleContainer(this):Ct.getOrCreateDOMContainer()).get(t),this[i]=n,o&&this instanceof as)){let d=this.$fastController,u=()=>{let p=Ct.findResponsibleContainer(this).get(t),v=this[i];p!==v&&(this[i]=n,d.notify(e))};d.subscribe({handleChange:u},"isConnected")}return n}})},createInterface(r,e){let t=typeof r=="function"?r:e,o=typeof r=="string"?r:r&&"friendlyName"in r&&r.friendlyName||JS,i=typeof r=="string"?!1:r&&"respectConnection"in r&&r.respectConnection||!1,n=function(s,d,u){if(s==null||new.target!==void 0)throw new Error(`No registration for interface: '${n.friendlyName}'`);if(d)Ct.defineProperty(s,d,n,i);else{let h=Ct.getOrCreateAnnotationParamTypes(s);h[u]=n}};return n.$isInterface=!0,n.friendlyName=o??"(anonymous)",t!=null&&(n.register=function(s,d){return t(new Mv(s,d??n))}),n.toString=function(){return`InterfaceSymbol<${n.friendlyName}>`},n},inject(...r){return function(e,t,o){if(typeof o=="number"){let i=Ct.getOrCreateAnnotationParamTypes(e),n=r[0];n!==void 0&&(i[o]=n)}else if(t)Ct.defineProperty(e,t,r[0]);else{let i=o?Ct.getOrCreateAnnotationParamTypes(o.value):Ct.getOrCreateAnnotationParamTypes(e),n;for(let s=0;s<r.length;++s)n=r[s],n!==void 0&&(i[s]=n)}}},transient(r){return r.register=function(t){return Ca.transient(r,r).register(t)},r.registerInRequestor=!1,r},singleton(r,e=PP){return r.register=function(o){return Ca.singleton(r,r).register(o)},r.registerInRequestor=e.scoped,r}}),RP=Ct.createInterface("Container");yve=Ct.inject,PP={scoped:!1};bve=OP((r,e,t,o)=>t.getAll(r,o)),Cve=tp((r,e,t)=>()=>t.get(r)),wve=tp((r,e,t)=>{if(t.has(r,!0))return t.get(r)});Dv.$isResolver=!0;Dv.resolve=()=>{};xve=tp((r,e,t)=>{let o=e_(r,e),i=new so(r,0,o);return t.registerResolver(r,i),o}),Sve=tp((r,e,t)=>e_(r,e));so=class{constructor(e,t,o){this.key=e,this.strategy=t,this.state=o,this.resolving=!1}get $isResolver(){return!0}register(e){return e.registerResolver(this.key,this)}resolve(e,t){switch(this.strategy){case 0:return this.state;case 1:{if(this.resolving)throw new Error(`Cyclic dependency found: ${this.state.name}`);return this.resolving=!0,this.state=e.getFactory(this.state).construct(t),this.strategy=0,this.resolving=!1,this.state}case 2:{let o=e.getFactory(this.state);if(o===null)throw new Error(`Resolver for ${String(this.key)} returned a null factory`);return o.construct(t)}case 3:return this.state(e,t,this);case 4:return this.state[0].resolve(e,t);case 5:return t.get(this.state);default:throw new Error(`Invalid resolver strategy specified: ${this.strategy}.`)}}getFactory(e){var t,o,i;switch(this.strategy){case 1:case 2:return e.getFactory(this.state);case 5:return(i=(o=(t=e.getResolver(this.state))===null||t===void 0?void 0:t.getFactory)===null||o===void 0?void 0:o.call(t,e))!==null&&i!==void 0?i:null;default:return null}}};Fv=class{constructor(e,t){this.Type=e,this.dependencies=t,this.transformers=null}construct(e,t){let o;return t===void 0?o=new this.Type(...this.dependencies.map(QS,e)):o=new this.Type(...this.dependencies.map(QS,e),...t),this.transformers==null?o:this.transformers.reduce($P,o)}registerTransformer(e){(this.transformers||(this.transformers=[])).push(e)}},MP={$isResolver:!0,resolve(r,e){return e}};LP=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]),t_="__DI_LOCATE_PARENT__",Ov=new Map,hd=class r{constructor(e,t){this.owner=e,this.config=t,this._parent=void 0,this.registerDepth=0,this.context=null,e!==null&&(e.$$container$$=this),this.resolvers=new Map,this.resolvers.set(RP,MP),e instanceof Node&&e.addEventListener(t_,o=>{o.composedPath()[0]!==this.owner&&(o.detail.container=this,o.stopImmediatePropagation())})}get parent(){return this._parent===void 0&&(this._parent=this.config.parentLocator(this.owner)),this._parent}get depth(){return this.parent===null?0:this.parent.depth+1}get responsibleForOwnerRequests(){return this.config.responsibleForOwnerRequests}registerWithContext(e,...t){return this.context=e,this.register(...t),this.context=null,this}register(...e){if(++this.registerDepth===100)throw new Error("Unable to autoregister dependency");let t,o,i,n,s,d=this.context;for(let u=0,h=e.length;u<h;++u)if(t=e[u],!!XS(t))if(ep(t))t.register(this,d);else if(DP(t))Ca.singleton(t,t).register(this);else for(o=Object.keys(t),n=0,s=o.length;n<s;++n)i=t[o[n]],XS(i)&&(ep(i)?i.register(this,d):this.register(i));return--this.registerDepth,this}registerResolver(e,t){Jh(e);let o=this.resolvers,i=o.get(e);return i==null?o.set(e,t):i instanceof so&&i.strategy===4?i.state.push(t):o.set(e,new so(e,4,[i,t])),t}registerTransformer(e,t){let o=this.getResolver(e);if(o==null)return!1;if(o.getFactory){let i=o.getFactory(this);return i==null?!1:(i.registerTransformer(t),!0)}return!1}getResolver(e,t=!0){if(Jh(e),e.resolve!==void 0)return e;let o=this,i;for(;o!=null;)if(i=o.resolvers.get(e),i==null){if(o.parent==null){let n=YS(e)?this:o;return t?this.jitRegister(e,n):null}o=o.parent}else return i;return null}has(e,t=!1){return this.resolvers.has(e)?!0:t&&this.parent!=null?this.parent.has(e,!0):!1}get(e){if(Jh(e),e.$isResolver)return e.resolve(this,this);let t=this,o;for(;t!=null;)if(o=t.resolvers.get(e),o==null){if(t.parent==null){let i=YS(e)?this:t;return o=this.jitRegister(e,i),o.resolve(t,this)}t=t.parent}else return o.resolve(t,this);throw new Error(`Unable to resolve key: ${String(e)}`)}getAll(e,t=!1){Jh(e);let o=this,i=o,n;if(t){let s=Wo;for(;i!=null;)n=i.resolvers.get(e),n!=null&&(s=s.concat(ZS(n,i,o))),i=i.parent;return s}else for(;i!=null;)if(n=i.resolvers.get(e),n==null){if(i=i.parent,i==null)return Wo}else return ZS(n,i,o);return Wo}getFactory(e){let t=Ov.get(e);if(t===void 0){if(NP(e))throw new Error(`${e.name} is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.`);Ov.set(e,t=new Fv(e,Ct.getDependencies(e)))}return t}registerFactory(e,t){Ov.set(e,t)}createChild(e){return new r(null,Object.assign({},this.config,e,{parentLocator:()=>this}))}jitRegister(e,t){if(typeof e!="function")throw new Error(`Attempted to jitRegister something that is not a constructor: '${e}'. Did you forget to register this dependency?`);if(LP.has(e.name))throw new Error(`Attempted to jitRegister an intrinsic type: ${e.name}. Did you forget to add @inject(Key)`);if(ep(e)){let o=e.register(t);if(!(o instanceof Object)||o.resolve==null){let i=t.resolvers.get(e);if(i!=null)return i;throw new Error("A valid resolver was not returned from the static register method")}return o}else{if(e.$isInterface)throw new Error(`Attempted to jitRegister an interface: ${e.friendlyName}`);{let o=this.config.defaultResolver(e,t);return t.resolvers.set(e,o),o}}}},$v=new WeakMap;Ca=Object.freeze({instance(r,e){return new so(r,0,e)},singleton(r,e){return new so(r,1,e)},transient(r,e){return new so(r,2,e)},callback(r,e){return new so(r,3,e)},cachedCallback(r,e){return new so(r,3,r_(e))},aliasTo(r,e){return new so(e,5,r)}});JS="(anonymous)";NP=function(){let r=new WeakMap,e=!1,t="",o=0;return function(i){return e=r.get(i),e===void 0&&(t=i.toString(),o=t.length,e=o>=29&&o<=100&&t.charCodeAt(o-1)===125&&t.charCodeAt(o-2)<=32&&t.charCodeAt(o-3)===93&&t.charCodeAt(o-4)===101&&t.charCodeAt(o-5)===100&&t.charCodeAt(o-6)===111&&t.charCodeAt(o-7)===99&&t.charCodeAt(o-8)===32&&t.charCodeAt(o-9)===101&&t.charCodeAt(o-10)===118&&t.charCodeAt(o-11)===105&&t.charCodeAt(o-12)===116&&t.charCodeAt(o-13)===97&&t.charCodeAt(o-14)===110&&t.charCodeAt(o-15)===88,r.set(i,e)),e}}(),Xh={}});function i_(r){return`${r.toLowerCase()}:presentation`}var op,np,ip,sp=y(()=>{a();l();c();I();rp();op=new Map,np=Object.freeze({define(r,e,t){let o=i_(r);op.get(o)===void 0?op.set(o,e):op.set(o,!1),t.register(Ca.instance(o,e))},forTag(r,e){let t=i_(r),o=op.get(t);return o===!1?Ct.findResponsibleContainer(e).get(t):o||null}}),ip=class{constructor(e,t){this.template=e||null,this.styles=t===void 0?null:Array.isArray(t)?Yt.create(t):t instanceof Yt?t:Yt.create([t])}applyTo(e){let t=e.$fastController;t.template===null&&(t.template=this.template),t.styles===null&&(t.styles=this.styles)}}});function pd(r,e,t){return typeof r=="function"?r(e,t):r}var B,Lv,De=y(()=>{a();l();c();Ie();I();sp();B=class r extends as{constructor(){super(...arguments),this._presentation=void 0}get $presentation(){return this._presentation===void 0&&(this._presentation=np.forTag(this.tagName,this)),this._presentation}templateChanged(){this.template!==void 0&&(this.$fastController.template=this.template)}stylesChanged(){this.styles!==void 0&&(this.$fastController.styles=this.styles)}connectedCallback(){this.$presentation!==null&&this.$presentation.applyTo(this),super.connectedCallback()}static compose(e){return(t={})=>new Lv(this===r?class extends r{}:this,e,t)}};b([k],B.prototype,"template",void 0);b([k],B.prototype,"styles",void 0);Lv=class{constructor(e,t,o){this.type=e,this.elementDefinition=t,this.overrideDefinition=o,this.definition=Object.assign(Object.assign({},this.elementDefinition),this.overrideDefinition)}register(e,t){let o=this.definition,i=this.overrideDefinition,s=`${o.prefix||t.elementPrefix}-${o.baseName}`;t.tryDefineElement({name:s,type:this.type,baseClass:this.elementDefinition.baseClass,callback:d=>{let u=new ip(pd(o.template,d,o),pd(o.styles,d,o));d.definePresentation(u);let h=pd(o.shadowOptions,d,o);d.shadowRootMode&&(h?i.shadowOptions||(h.mode=d.shadowRootMode):h!==null&&(h={mode:d.shadowRootMode})),d.defineElement({elementOptions:pd(o.elementOptions,d,o),shadowOptions:h,attributes:pd(o.attributes,d,o)})}})}}});function je(r,...e){let t=dd.locate(r);e.forEach(o=>{Object.getOwnPropertyNames(o.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(o.prototype,n))}),dd.locate(o).forEach(n=>t.push(n))})}var Tr=y(()=>{a();l();c();I()});var Si,Nv=y(()=>{a();l();c();Ie();I();De();St();Tr();Si=class extends B{constructor(){super(...arguments),this.headinglevel=2,this.expanded=!1,this.clickHandler=e=>{this.expanded=!this.expanded,this.change()},this.change=()=>{this.$emit("change")}}};b([w({attribute:"heading-level",mode:"fromView",converter:ee})],Si.prototype,"headinglevel",void 0);b([w({mode:"boolean"})],Si.prototype,"expanded",void 0);b([w],Si.prototype,"id",void 0);je(Si,mt)});var n_=y(()=>{a();l();c();GS();Nv()});var s_,a_=y(()=>{a();l();c();I();s_=(r,e)=>R`
    <template>
        <slot ${Oe({property:"accordionItems",filter:Er()})}></slot>
        <slot name="item" part="item" ${Oe("accordionItems")}></slot>
    </template>
`});var gt,l_=y(()=>{a();l();c();gt={horizontal:"horizontal",vertical:"vertical"}});function c_(r,e){let t=r.length;for(;t--;)if(e(r[t],t,r))return t;return-1}var d_=y(()=>{a();l();c()});var u_=y(()=>{a();l();c()});function El(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var ap=y(()=>{a();l();c()});var h_=y(()=>{a();l();c();ap()});var p_=y(()=>{a();l();c();ap()});var f_=y(()=>{a();l();c()});var Hv=y(()=>{a();l();c();ap();h_();p_();f_()});function qi(...r){return r.every(e=>e instanceof HTMLElement)}function m_(r,e){return!r||!e||!qi(r)?void 0:Array.from(r.querySelectorAll(e)).filter(o=>o.offsetParent!==null)}function HP(){let r=document.querySelector('meta[property="csp-nonce"]');return r?r.getAttribute("content"):null}function g_(){if(typeof wa=="boolean")return wa;if(!El())return wa=!1,wa;let r=document.createElement("style"),e=HP();e!==null&&r.setAttribute("nonce",e),document.head.appendChild(r);try{r.sheet.insertRule("foo:focus-visible {color:inherit}",0),wa=!0}catch{wa=!1}finally{document.head.removeChild(r)}return wa}var wa,v_=y(()=>{a();l();c();Hv()});var Uv,Bv,En,Tn,Vv,zv,y_=y(()=>{a();l();c();Uv="focus",Bv="focusin",En="focusout",Tn="keydown",Vv="resize",zv="scroll"});var b_=y(()=>{a();l();c()});var C_,Mt,Wr,Qr,Ft,Zt,bo,lr,cr,w_,x_,S_,Co,ds,__,E_,us,T_=y(()=>{a();l();c();(function(r){r[r.alt=18]="alt",r[r.arrowDown=40]="arrowDown",r[r.arrowLeft=37]="arrowLeft",r[r.arrowRight=39]="arrowRight",r[r.arrowUp=38]="arrowUp",r[r.back=8]="back",r[r.backSlash=220]="backSlash",r[r.break=19]="break",r[r.capsLock=20]="capsLock",r[r.closeBracket=221]="closeBracket",r[r.colon=186]="colon",r[r.colon2=59]="colon2",r[r.comma=188]="comma",r[r.ctrl=17]="ctrl",r[r.delete=46]="delete",r[r.end=35]="end",r[r.enter=13]="enter",r[r.equals=187]="equals",r[r.equals2=61]="equals2",r[r.equals3=107]="equals3",r[r.escape=27]="escape",r[r.forwardSlash=191]="forwardSlash",r[r.function1=112]="function1",r[r.function10=121]="function10",r[r.function11=122]="function11",r[r.function12=123]="function12",r[r.function2=113]="function2",r[r.function3=114]="function3",r[r.function4=115]="function4",r[r.function5=116]="function5",r[r.function6=117]="function6",r[r.function7=118]="function7",r[r.function8=119]="function8",r[r.function9=120]="function9",r[r.home=36]="home",r[r.insert=45]="insert",r[r.menu=93]="menu",r[r.minus=189]="minus",r[r.minus2=109]="minus2",r[r.numLock=144]="numLock",r[r.numPad0=96]="numPad0",r[r.numPad1=97]="numPad1",r[r.numPad2=98]="numPad2",r[r.numPad3=99]="numPad3",r[r.numPad4=100]="numPad4",r[r.numPad5=101]="numPad5",r[r.numPad6=102]="numPad6",r[r.numPad7=103]="numPad7",r[r.numPad8=104]="numPad8",r[r.numPad9=105]="numPad9",r[r.numPadDivide=111]="numPadDivide",r[r.numPadDot=110]="numPadDot",r[r.numPadMinus=109]="numPadMinus",r[r.numPadMultiply=106]="numPadMultiply",r[r.numPadPlus=107]="numPadPlus",r[r.openBracket=219]="openBracket",r[r.pageDown=34]="pageDown",r[r.pageUp=33]="pageUp",r[r.period=190]="period",r[r.print=44]="print",r[r.quote=222]="quote",r[r.scrollLock=145]="scrollLock",r[r.shift=16]="shift",r[r.space=32]="space",r[r.tab=9]="tab",r[r.tilde=192]="tilde",r[r.windowsLeft=91]="windowsLeft",r[r.windowsOpera=219]="windowsOpera",r[r.windowsRight=92]="windowsRight"})(C_||(C_={}));Mt="ArrowDown",Wr="ArrowLeft",Qr="ArrowRight",Ft="ArrowUp",Zt="Enter",bo="Escape",lr="Home",cr="End",w_="F2",x_="PageDown",S_="PageUp",Co=" ",ds="Tab",__="Backspace",E_="Delete",us={ArrowDown:Mt,ArrowLeft:Wr,ArrowRight:Qr,ArrowUp:Ft}});var Ze,qv=y(()=>{a();l();c();(function(r){r.ltr="ltr",r.rtl="rtl"})(Ze||(Ze={}))});function k_(r,e,t){return t<r?e:t>e?r:t}function hs(r,e,t){return Math.min(Math.max(t,r),e)}function fd(r,e,t=0){return[e,t]=[e,t].sort((o,i)=>o-i),e<=r&&r<t}var I_=y(()=>{a();l();c()});function Do(r=""){return`${r}${UP++}`}var UP,A_=y(()=>{a();l();c();UP=0});var R_=y(()=>{a();l();c()});var Tl,P_=y(()=>{a();l();c();Hv();qv();Tl=class r{static getScrollLeft(e,t){return t===Ze.rtl?r.getRtlScrollLeftConverter(e):e.scrollLeft}static setScrollLeft(e,t,o){if(o===Ze.rtl){r.setRtlScrollLeftConverter(e,t);return}e.scrollLeft=t}static initialGetRtlScrollConverter(e){return r.initializeRtlScrollConverters(),r.getRtlScrollLeftConverter(e)}static directGetRtlScrollConverter(e){return e.scrollLeft}static invertedGetRtlScrollConverter(e){return-Math.abs(e.scrollLeft)}static reverseGetRtlScrollConverter(e){return e.scrollLeft-(e.scrollWidth-e.clientWidth)}static initialSetRtlScrollConverter(e,t){r.initializeRtlScrollConverters(),r.setRtlScrollLeftConverter(e,t)}static directSetRtlScrollConverter(e,t){e.scrollLeft=t}static invertedSetRtlScrollConverter(e,t){e.scrollLeft=Math.abs(t)}static reverseSetRtlScrollConverter(e,t){let o=e.scrollWidth-e.clientWidth;e.scrollLeft=o+t}static initializeRtlScrollConverters(){if(!El()){r.applyDirectScrollConverters();return}let e=r.getTestElement();document.body.appendChild(e),r.checkForScrollType(e),document.body.removeChild(e)}static checkForScrollType(e){r.isReverse(e)?r.applyReverseScrollConverters():r.isDirect(e)?r.applyDirectScrollConverters():r.applyInvertedScrollConverters()}static isReverse(e){return e.scrollLeft>0}static isDirect(e){return e.scrollLeft=-1,e.scrollLeft<0}static applyDirectScrollConverters(){r.setRtlScrollLeftConverter=r.directSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.directGetRtlScrollConverter}static applyInvertedScrollConverters(){r.setRtlScrollLeftConverter=r.invertedSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.invertedGetRtlScrollConverter}static applyReverseScrollConverters(){r.setRtlScrollLeftConverter=r.reverseSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.reverseGetRtlScrollConverter}static getTestElement(){let e=document.createElement("div");return e.appendChild(document.createTextNode("ABCD")),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",e}};Tl.getRtlScrollLeftConverter=Tl.initialGetRtlScrollConverter;Tl.setRtlScrollLeftConverter=Tl.initialSetRtlScrollConverter});var _,O_=y(()=>{a();l();c();(function(r){r.Canvas="Canvas",r.CanvasText="CanvasText",r.LinkText="LinkText",r.VisitedText="VisitedText",r.ActiveText="ActiveText",r.ButtonFace="ButtonFace",r.ButtonText="ButtonText",r.Field="Field",r.FieldText="FieldText",r.Highlight="Highlight",r.HighlightText="HighlightText",r.GrayText="GrayText"})(_||(_={}))});var pe=y(()=>{a();l();c();l_();d_();u_();v_();y_();b_();T_();qv();I_();A_();R_();P_();O_()});var $_,kl,M_=y(()=>{a();l();c();Ie();I();pe();De();Nv();$_={single:"single",multi:"multi"},kl=class extends B{constructor(){super(...arguments),this.expandmode=$_.multi,this.activeItemIndex=0,this.change=()=>{this.$emit("change",this.activeid)},this.setItems=()=>{var e;this.accordionItems.length!==0&&(this.accordionIds=this.getItemIds(),this.accordionItems.forEach((t,o)=>{t instanceof Si&&(t.addEventListener("change",this.activeItemChange),this.isSingleExpandMode()&&(this.activeItemIndex!==o?t.expanded=!1:t.expanded=!0));let i=this.accordionIds[o];t.setAttribute("id",typeof i!="string"?`accordion-${o+1}`:i),this.activeid=this.accordionIds[this.activeItemIndex],t.addEventListener("keydown",this.handleItemKeyDown),t.addEventListener("focus",this.handleItemFocus)}),this.isSingleExpandMode()&&((e=this.findExpandedItem())!==null&&e!==void 0?e:this.accordionItems[0]).setAttribute("aria-disabled","true"))},this.removeItemListeners=e=>{e.forEach((t,o)=>{t.removeEventListener("change",this.activeItemChange),t.removeEventListener("keydown",this.handleItemKeyDown),t.removeEventListener("focus",this.handleItemFocus)})},this.activeItemChange=e=>{if(e.defaultPrevented||e.target!==e.currentTarget)return;e.preventDefault();let t=e.target;this.activeid=t.getAttribute("id"),this.isSingleExpandMode()&&(this.resetItems(),t.expanded=!0,t.setAttribute("aria-disabled","true"),this.accordionItems.forEach(o=>{!o.hasAttribute("disabled")&&o.id!==this.activeid&&o.removeAttribute("aria-disabled")})),this.activeItemIndex=Array.from(this.accordionItems).indexOf(t),this.change()},this.handleItemKeyDown=e=>{if(e.target===e.currentTarget)switch(this.accordionIds=this.getItemIds(),e.key){case Ft:e.preventDefault(),this.adjust(-1);break;case Mt:e.preventDefault(),this.adjust(1);break;case lr:this.activeItemIndex=0,this.focusItem();break;case cr:this.activeItemIndex=this.accordionItems.length-1,this.focusItem();break}},this.handleItemFocus=e=>{if(e.target===e.currentTarget){let t=e.target,o=this.activeItemIndex=Array.from(this.accordionItems).indexOf(t);this.activeItemIndex!==o&&o!==-1&&(this.activeItemIndex=o,this.activeid=this.accordionIds[this.activeItemIndex])}}}accordionItemsChanged(e,t){this.$fastController.isConnected&&(this.removeItemListeners(e),this.setItems())}findExpandedItem(){for(let e=0;e<this.accordionItems.length;e++)if(this.accordionItems[e].getAttribute("expanded")==="true")return this.accordionItems[e];return null}resetItems(){this.accordionItems.forEach((e,t)=>{e.expanded=!1})}getItemIds(){return this.accordionItems.map(e=>e.getAttribute("id"))}isSingleExpandMode(){return this.expandmode===$_.single}adjust(e){this.activeItemIndex=k_(0,this.accordionItems.length-1,this.activeItemIndex+e),this.focusItem()}focusItem(){let e=this.accordionItems[this.activeItemIndex];e instanceof Si&&e.expandbutton.focus()}};b([w({attribute:"expand-mode"})],kl.prototype,"expandmode",void 0);b([k],kl.prototype,"accordionItems",void 0)});var F_=y(()=>{a();l();c();a_();M_()});var lp,Gv=y(()=>{a();l();c();I();St();lp=(r,e)=>R`
    <a
        class="control"
        part="control"
        download="${t=>t.download}"
        href="${t=>t.href}"
        hreflang="${t=>t.hreflang}"
        ping="${t=>t.ping}"
        referrerpolicy="${t=>t.referrerpolicy}"
        rel="${t=>t.rel}"
        target="${t=>t.target}"
        type="${t=>t.type}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${we("control")}
    >
        ${pt(r,e)}
        <span class="content" part="content">
            <slot ${Oe("defaultSlottedContent")}></slot>
        </span>
        ${ht(r,e)}
    </a>
`});var st,md=y(()=>{a();l();c();Ie();I();st=class{};b([w({attribute:"aria-atomic"})],st.prototype,"ariaAtomic",void 0);b([w({attribute:"aria-busy"})],st.prototype,"ariaBusy",void 0);b([w({attribute:"aria-controls"})],st.prototype,"ariaControls",void 0);b([w({attribute:"aria-current"})],st.prototype,"ariaCurrent",void 0);b([w({attribute:"aria-describedby"})],st.prototype,"ariaDescribedby",void 0);b([w({attribute:"aria-details"})],st.prototype,"ariaDetails",void 0);b([w({attribute:"aria-disabled"})],st.prototype,"ariaDisabled",void 0);b([w({attribute:"aria-errormessage"})],st.prototype,"ariaErrormessage",void 0);b([w({attribute:"aria-flowto"})],st.prototype,"ariaFlowto",void 0);b([w({attribute:"aria-haspopup"})],st.prototype,"ariaHaspopup",void 0);b([w({attribute:"aria-hidden"})],st.prototype,"ariaHidden",void 0);b([w({attribute:"aria-invalid"})],st.prototype,"ariaInvalid",void 0);b([w({attribute:"aria-keyshortcuts"})],st.prototype,"ariaKeyshortcuts",void 0);b([w({attribute:"aria-label"})],st.prototype,"ariaLabel",void 0);b([w({attribute:"aria-labelledby"})],st.prototype,"ariaLabelledby",void 0);b([w({attribute:"aria-live"})],st.prototype,"ariaLive",void 0);b([w({attribute:"aria-owns"})],st.prototype,"ariaOwns",void 0);b([w({attribute:"aria-relevant"})],st.prototype,"ariaRelevant",void 0);b([w({attribute:"aria-roledescription"})],st.prototype,"ariaRoledescription",void 0)});var xa=y(()=>{a();l();c();md();St()});var Nr,Sa,jv=y(()=>{a();l();c();Ie();I();De();xa();Tr();Nr=class extends B{constructor(){super(...arguments),this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(!((e=this.$fastController.definition.shadowOptions)===null||e===void 0)&&e.delegatesFocus)&&(this.focus=()=>{var t;(t=this.control)===null||t===void 0||t.focus()})}}connectedCallback(){super.connectedCallback(),this.handleUnsupportedDelegatesFocus()}};b([w],Nr.prototype,"download",void 0);b([w],Nr.prototype,"href",void 0);b([w],Nr.prototype,"hreflang",void 0);b([w],Nr.prototype,"ping",void 0);b([w],Nr.prototype,"referrerpolicy",void 0);b([w],Nr.prototype,"rel",void 0);b([w],Nr.prototype,"target",void 0);b([w],Nr.prototype,"type",void 0);b([k],Nr.prototype,"defaultSlottedContent",void 0);Sa=class{};b([w({attribute:"aria-expanded"})],Sa.prototype,"ariaExpanded",void 0);je(Sa,st);je(Nr,mt,Sa)});var D_=y(()=>{a();l();c();Gv();jv()});var L_,N_=y(()=>{a();l();c();I();L_=(r,e)=>R`
    <template class="${t=>t.initialLayoutComplete?"loaded":""}">
        ${Qe(t=>t.initialLayoutComplete,R`
                <slot></slot>
            `)}
    </template>
`});var Lo,ps=y(()=>{a();l();c();pe();Lo=r=>{let e=r.closest("[dir]");return e!==null&&e.dir==="rtl"?Ze.rtl:Ze.ltr}});var cp,H_=y(()=>{a();l();c();I();cp=class{constructor(){this.intersectionDetector=null,this.observedElements=new Map,this.requestPosition=(e,t)=>{var o;if(this.intersectionDetector!==null){if(this.observedElements.has(e)){(o=this.observedElements.get(e))===null||o===void 0||o.push(t);return}this.observedElements.set(e,[t]),this.intersectionDetector.observe(e)}},this.cancelRequestPosition=(e,t)=>{let o=this.observedElements.get(e);if(o!==void 0){let i=o.indexOf(t);i!==-1&&o.splice(i,1)}},this.initializeIntersectionDetector=()=>{xi.IntersectionObserver&&(this.intersectionDetector=new IntersectionObserver(this.handleIntersection,{root:null,rootMargin:"0px",threshold:[0,1]}))},this.handleIntersection=e=>{if(this.intersectionDetector===null)return;let t=[],o=[];e.forEach(i=>{var n;(n=this.intersectionDetector)===null||n===void 0||n.unobserve(i.target);let s=this.observedElements.get(i.target);s!==void 0&&(s.forEach(d=>{let u=t.indexOf(d);u===-1&&(u=t.length,t.push(d),o.push([])),o[u].push(i)}),this.observedElements.delete(i.target))}),t.forEach((i,n)=>{i(o[n])})},this.initializeIntersectionDetector()}}});var Re,gd=y(()=>{a();l();c();Ie();I();pe();De();ps();H_();Re=class r extends B{constructor(){super(...arguments),this.anchor="",this.viewport="",this.horizontalPositioningMode="uncontrolled",this.horizontalDefaultPosition="unset",this.horizontalViewportLock=!1,this.horizontalInset=!1,this.horizontalScaling="content",this.verticalPositioningMode="uncontrolled",this.verticalDefaultPosition="unset",this.verticalViewportLock=!1,this.verticalInset=!1,this.verticalScaling="content",this.fixedPlacement=!1,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.initialLayoutComplete=!1,this.resizeDetector=null,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.pendingPositioningUpdate=!1,this.pendingReset=!1,this.currentDirection=Ze.ltr,this.regionVisible=!1,this.forceUpdate=!1,this.updateThreshold=.5,this.update=()=>{this.pendingPositioningUpdate||this.requestPositionUpdates()},this.startObservers=()=>{this.stopObservers(),this.anchorElement!==null&&(this.requestPositionUpdates(),this.resizeDetector!==null&&(this.resizeDetector.observe(this.anchorElement),this.resizeDetector.observe(this)))},this.requestPositionUpdates=()=>{this.anchorElement===null||this.pendingPositioningUpdate||(r.intersectionService.requestPosition(this,this.handleIntersection),r.intersectionService.requestPosition(this.anchorElement,this.handleIntersection),this.viewportElement!==null&&r.intersectionService.requestPosition(this.viewportElement,this.handleIntersection),this.pendingPositioningUpdate=!0)},this.stopObservers=()=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,r.intersectionService.cancelRequestPosition(this,this.handleIntersection),this.anchorElement!==null&&r.intersectionService.cancelRequestPosition(this.anchorElement,this.handleIntersection),this.viewportElement!==null&&r.intersectionService.cancelRequestPosition(this.viewportElement,this.handleIntersection)),this.resizeDetector!==null&&this.resizeDetector.disconnect()},this.getViewport=()=>typeof this.viewport!="string"||this.viewport===""?document.documentElement:document.getElementById(this.viewport),this.getAnchor=()=>document.getElementById(this.anchor),this.handleIntersection=e=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,this.applyIntersectionEntries(e)&&this.updateLayout())},this.applyIntersectionEntries=e=>{let t=e.find(n=>n.target===this),o=e.find(n=>n.target===this.anchorElement),i=e.find(n=>n.target===this.viewportElement);return t===void 0||i===void 0||o===void 0?!1:!this.regionVisible||this.forceUpdate||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0||this.isRectDifferent(this.anchorRect,o.boundingClientRect)||this.isRectDifferent(this.viewportRect,i.boundingClientRect)||this.isRectDifferent(this.regionRect,t.boundingClientRect)?(this.regionRect=t.boundingClientRect,this.anchorRect=o.boundingClientRect,this.viewportElement===document.documentElement?this.viewportRect=new DOMRectReadOnly(i.boundingClientRect.x+document.documentElement.scrollLeft,i.boundingClientRect.y+document.documentElement.scrollTop,i.boundingClientRect.width,i.boundingClientRect.height):this.viewportRect=i.boundingClientRect,this.updateRegionOffset(),this.forceUpdate=!1,!0):!1},this.updateRegionOffset=()=>{this.anchorRect&&this.regionRect&&(this.baseHorizontalOffset=this.baseHorizontalOffset+(this.anchorRect.left-this.regionRect.left)+(this.translateX-this.baseHorizontalOffset),this.baseVerticalOffset=this.baseVerticalOffset+(this.anchorRect.top-this.regionRect.top)+(this.translateY-this.baseVerticalOffset))},this.isRectDifferent=(e,t)=>Math.abs(e.top-t.top)>this.updateThreshold||Math.abs(e.right-t.right)>this.updateThreshold||Math.abs(e.bottom-t.bottom)>this.updateThreshold||Math.abs(e.left-t.left)>this.updateThreshold,this.handleResize=e=>{this.update()},this.reset=()=>{this.pendingReset&&(this.pendingReset=!1,this.anchorElement===null&&(this.anchorElement=this.getAnchor()),this.viewportElement===null&&(this.viewportElement=this.getViewport()),this.currentDirection=Lo(this),this.startObservers())},this.updateLayout=()=>{let e,t;if(this.horizontalPositioningMode!=="uncontrolled"){let n=this.getPositioningOptions(this.horizontalInset);if(this.horizontalDefaultPosition==="center")t="center";else if(this.horizontalDefaultPosition!=="unset"){let C=this.horizontalDefaultPosition;if(C==="start"||C==="end"){let x=Lo(this);if(x!==this.currentDirection){this.currentDirection=x,this.initialize();return}this.currentDirection===Ze.ltr?C=C==="start"?"left":"right":C=C==="start"?"right":"left"}switch(C){case"left":t=this.horizontalInset?"insetStart":"start";break;case"right":t=this.horizontalInset?"insetEnd":"end";break}}let s=this.horizontalThreshold!==void 0?this.horizontalThreshold:this.regionRect!==void 0?this.regionRect.width:0,d=this.anchorRect!==void 0?this.anchorRect.left:0,u=this.anchorRect!==void 0?this.anchorRect.right:0,h=this.anchorRect!==void 0?this.anchorRect.width:0,p=this.viewportRect!==void 0?this.viewportRect.left:0,v=this.viewportRect!==void 0?this.viewportRect.right:0;(t===void 0||this.horizontalPositioningMode!=="locktodefault"&&this.getAvailableSpace(t,d,u,h,p,v)<s)&&(t=this.getAvailableSpace(n[0],d,u,h,p,v)>this.getAvailableSpace(n[1],d,u,h,p,v)?n[0]:n[1])}if(this.verticalPositioningMode!=="uncontrolled"){let n=this.getPositioningOptions(this.verticalInset);if(this.verticalDefaultPosition==="center")e="center";else if(this.verticalDefaultPosition!=="unset")switch(this.verticalDefaultPosition){case"top":e=this.verticalInset?"insetStart":"start";break;case"bottom":e=this.verticalInset?"insetEnd":"end";break}let s=this.verticalThreshold!==void 0?this.verticalThreshold:this.regionRect!==void 0?this.regionRect.height:0,d=this.anchorRect!==void 0?this.anchorRect.top:0,u=this.anchorRect!==void 0?this.anchorRect.bottom:0,h=this.anchorRect!==void 0?this.anchorRect.height:0,p=this.viewportRect!==void 0?this.viewportRect.top:0,v=this.viewportRect!==void 0?this.viewportRect.bottom:0;(e===void 0||this.verticalPositioningMode!=="locktodefault"&&this.getAvailableSpace(e,d,u,h,p,v)<s)&&(e=this.getAvailableSpace(n[0],d,u,h,p,v)>this.getAvailableSpace(n[1],d,u,h,p,v)?n[0]:n[1])}let o=this.getNextRegionDimension(t,e),i=this.horizontalPosition!==t||this.verticalPosition!==e;if(this.setHorizontalPosition(t,o),this.setVerticalPosition(e,o),this.updateRegionStyle(),!this.initialLayoutComplete){this.initialLayoutComplete=!0,this.requestPositionUpdates();return}this.regionVisible||(this.regionVisible=!0,this.style.removeProperty("pointer-events"),this.style.removeProperty("opacity"),this.classList.toggle("loaded",!0),this.$emit("loaded",this,{bubbles:!1})),this.updatePositionClasses(),i&&this.$emit("positionchange",this,{bubbles:!1})},this.updateRegionStyle=()=>{this.style.width=this.regionWidth,this.style.height=this.regionHeight,this.style.transform=`translate(${this.translateX}px, ${this.translateY}px)`},this.updatePositionClasses=()=>{this.classList.toggle("top",this.verticalPosition==="start"),this.classList.toggle("bottom",this.verticalPosition==="end"),this.classList.toggle("inset-top",this.verticalPosition==="insetStart"),this.classList.toggle("inset-bottom",this.verticalPosition==="insetEnd"),this.classList.toggle("vertical-center",this.verticalPosition==="center"),this.classList.toggle("left",this.horizontalPosition==="start"),this.classList.toggle("right",this.horizontalPosition==="end"),this.classList.toggle("inset-left",this.horizontalPosition==="insetStart"),this.classList.toggle("inset-right",this.horizontalPosition==="insetEnd"),this.classList.toggle("horizontal-center",this.horizontalPosition==="center")},this.setHorizontalPosition=(e,t)=>{if(e===void 0||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0)return;let o=0;switch(this.horizontalScaling){case"anchor":case"fill":o=this.horizontalViewportLock?this.viewportRect.width:t.width,this.regionWidth=`${o}px`;break;case"content":o=this.regionRect.width,this.regionWidth="unset";break}let i=0;switch(e){case"start":this.translateX=this.baseHorizontalOffset-o,this.horizontalViewportLock&&this.anchorRect.left>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.right));break;case"insetStart":this.translateX=this.baseHorizontalOffset-o+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.right));break;case"insetEnd":this.translateX=this.baseHorizontalOffset,this.horizontalViewportLock&&this.anchorRect.left<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.left));break;case"end":this.translateX=this.baseHorizontalOffset+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.left));break;case"center":if(i=(this.anchorRect.width-o)/2,this.translateX=this.baseHorizontalOffset+i,this.horizontalViewportLock){let n=this.anchorRect.left+i,s=this.anchorRect.right-i;n<this.viewportRect.left&&!(s>this.viewportRect.right)?this.translateX=this.translateX-(n-this.viewportRect.left):s>this.viewportRect.right&&!(n<this.viewportRect.left)&&(this.translateX=this.translateX-(s-this.viewportRect.right))}break}this.horizontalPosition=e},this.setVerticalPosition=(e,t)=>{if(e===void 0||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0)return;let o=0;switch(this.verticalScaling){case"anchor":case"fill":o=this.verticalViewportLock?this.viewportRect.height:t.height,this.regionHeight=`${o}px`;break;case"content":o=this.regionRect.height,this.regionHeight="unset";break}let i=0;switch(e){case"start":this.translateY=this.baseVerticalOffset-o,this.verticalViewportLock&&this.anchorRect.top>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.bottom));break;case"insetStart":this.translateY=this.baseVerticalOffset-o+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.bottom));break;case"insetEnd":this.translateY=this.baseVerticalOffset,this.verticalViewportLock&&this.anchorRect.top<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.top));break;case"end":this.translateY=this.baseVerticalOffset+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.top));break;case"center":if(i=(this.anchorRect.height-o)/2,this.translateY=this.baseVerticalOffset+i,this.verticalViewportLock){let n=this.anchorRect.top+i,s=this.anchorRect.bottom-i;n<this.viewportRect.top&&!(s>this.viewportRect.bottom)?this.translateY=this.translateY-(n-this.viewportRect.top):s>this.viewportRect.bottom&&!(n<this.viewportRect.top)&&(this.translateY=this.translateY-(s-this.viewportRect.bottom))}}this.verticalPosition=e},this.getPositioningOptions=e=>e?["insetStart","insetEnd"]:["start","end"],this.getAvailableSpace=(e,t,o,i,n,s)=>{let d=t-n,u=s-(t+i);switch(e){case"start":return d;case"insetStart":return d+i;case"insetEnd":return u+i;case"end":return u;case"center":return Math.min(d,u)*2+i}},this.getNextRegionDimension=(e,t)=>{let o={height:this.regionRect!==void 0?this.regionRect.height:0,width:this.regionRect!==void 0?this.regionRect.width:0};return e!==void 0&&this.horizontalScaling==="fill"?o.width=this.getAvailableSpace(e,this.anchorRect!==void 0?this.anchorRect.left:0,this.anchorRect!==void 0?this.anchorRect.right:0,this.anchorRect!==void 0?this.anchorRect.width:0,this.viewportRect!==void 0?this.viewportRect.left:0,this.viewportRect!==void 0?this.viewportRect.right:0):this.horizontalScaling==="anchor"&&(o.width=this.anchorRect!==void 0?this.anchorRect.width:0),t!==void 0&&this.verticalScaling==="fill"?o.height=this.getAvailableSpace(t,this.anchorRect!==void 0?this.anchorRect.top:0,this.anchorRect!==void 0?this.anchorRect.bottom:0,this.anchorRect!==void 0?this.anchorRect.height:0,this.viewportRect!==void 0?this.viewportRect.top:0,this.viewportRect!==void 0?this.viewportRect.bottom:0):this.verticalScaling==="anchor"&&(o.height=this.anchorRect!==void 0?this.anchorRect.height:0),o},this.startAutoUpdateEventListeners=()=>{window.addEventListener(Vv,this.update,{passive:!0}),window.addEventListener(zv,this.update,{passive:!0,capture:!0}),this.resizeDetector!==null&&this.viewportElement!==null&&this.resizeDetector.observe(this.viewportElement)},this.stopAutoUpdateEventListeners=()=>{window.removeEventListener(Vv,this.update),window.removeEventListener(zv,this.update),this.resizeDetector!==null&&this.viewportElement!==null&&this.resizeDetector.unobserve(this.viewportElement)}}anchorChanged(){this.initialLayoutComplete&&(this.anchorElement=this.getAnchor())}viewportChanged(){this.initialLayoutComplete&&(this.viewportElement=this.getViewport())}horizontalPositioningModeChanged(){this.requestReset()}horizontalDefaultPositionChanged(){this.updateForAttributeChange()}horizontalViewportLockChanged(){this.updateForAttributeChange()}horizontalInsetChanged(){this.updateForAttributeChange()}horizontalThresholdChanged(){this.updateForAttributeChange()}horizontalScalingChanged(){this.updateForAttributeChange()}verticalPositioningModeChanged(){this.requestReset()}verticalDefaultPositionChanged(){this.updateForAttributeChange()}verticalViewportLockChanged(){this.updateForAttributeChange()}verticalInsetChanged(){this.updateForAttributeChange()}verticalThresholdChanged(){this.updateForAttributeChange()}verticalScalingChanged(){this.updateForAttributeChange()}fixedPlacementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}autoUpdateModeChanged(e,t){this.$fastController.isConnected&&this.initialLayoutComplete&&(e==="auto"&&this.stopAutoUpdateEventListeners(),t==="auto"&&this.startAutoUpdateEventListeners())}anchorElementChanged(){this.requestReset()}viewportElementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}connectedCallback(){super.connectedCallback(),this.autoUpdateMode==="auto"&&this.startAutoUpdateEventListeners(),this.initialize()}disconnectedCallback(){super.disconnectedCallback(),this.autoUpdateMode==="auto"&&this.stopAutoUpdateEventListeners(),this.stopObservers(),this.disconnectResizeDetector()}adoptedCallback(){this.initialize()}disconnectResizeDetector(){this.resizeDetector!==null&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.handleResize)}updateForAttributeChange(){this.$fastController.isConnected&&this.initialLayoutComplete&&(this.forceUpdate=!0,this.update())}initialize(){this.initializeResizeDetector(),this.anchorElement===null&&(this.anchorElement=this.getAnchor()),this.requestReset()}requestReset(){this.$fastController.isConnected&&this.pendingReset===!1&&(this.setInitialState(),W.queueUpdate(()=>this.reset()),this.pendingReset=!0)}setInitialState(){this.initialLayoutComplete=!1,this.regionVisible=!1,this.translateX=0,this.translateY=0,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.viewportRect=void 0,this.regionRect=void 0,this.anchorRect=void 0,this.verticalPosition=void 0,this.horizontalPosition=void 0,this.style.opacity="0",this.style.pointerEvents="none",this.forceUpdate=!1,this.style.position=this.fixedPlacement?"fixed":"absolute",this.updatePositionClasses(),this.updateRegionStyle()}};Re.intersectionService=new cp;b([w],Re.prototype,"anchor",void 0);b([w],Re.prototype,"viewport",void 0);b([w({attribute:"horizontal-positioning-mode"})],Re.prototype,"horizontalPositioningMode",void 0);b([w({attribute:"horizontal-default-position"})],Re.prototype,"horizontalDefaultPosition",void 0);b([w({attribute:"horizontal-viewport-lock",mode:"boolean"})],Re.prototype,"horizontalViewportLock",void 0);b([w({attribute:"horizontal-inset",mode:"boolean"})],Re.prototype,"horizontalInset",void 0);b([w({attribute:"horizontal-threshold"})],Re.prototype,"horizontalThreshold",void 0);b([w({attribute:"horizontal-scaling"})],Re.prototype,"horizontalScaling",void 0);b([w({attribute:"vertical-positioning-mode"})],Re.prototype,"verticalPositioningMode",void 0);b([w({attribute:"vertical-default-position"})],Re.prototype,"verticalDefaultPosition",void 0);b([w({attribute:"vertical-viewport-lock",mode:"boolean"})],Re.prototype,"verticalViewportLock",void 0);b([w({attribute:"vertical-inset",mode:"boolean"})],Re.prototype,"verticalInset",void 0);b([w({attribute:"vertical-threshold"})],Re.prototype,"verticalThreshold",void 0);b([w({attribute:"vertical-scaling"})],Re.prototype,"verticalScaling",void 0);b([w({attribute:"fixed-placement",mode:"boolean"})],Re.prototype,"fixedPlacement",void 0);b([w({attribute:"auto-update-mode"})],Re.prototype,"autoUpdateMode",void 0);b([k],Re.prototype,"anchorElement",void 0);b([k],Re.prototype,"viewportElement",void 0);b([k],Re.prototype,"initialLayoutComplete",void 0)});var Kv,Wv,Qv,Yv,U_,Zv,B_,V_=y(()=>{a();l();c();Kv={horizontalDefaultPosition:"center",horizontalPositioningMode:"locktodefault",horizontalInset:!1,horizontalScaling:"anchor"},Wv=Object.assign(Object.assign({},Kv),{verticalDefaultPosition:"top",verticalPositioningMode:"locktodefault",verticalInset:!1,verticalScaling:"content"}),Qv=Object.assign(Object.assign({},Kv),{verticalDefaultPosition:"bottom",verticalPositioningMode:"locktodefault",verticalInset:!1,verticalScaling:"content"}),Yv=Object.assign(Object.assign({},Kv),{verticalPositioningMode:"dynamic",verticalInset:!1,verticalScaling:"content"}),U_=Object.assign(Object.assign({},Wv),{verticalScaling:"fill"}),Zv=Object.assign(Object.assign({},Qv),{verticalScaling:"fill"}),B_=Object.assign(Object.assign({},Yv),{verticalScaling:"fill"})});var Jv=y(()=>{a();l();c();N_();gd();V_()});var z_=y(()=>{a();l();c();I()});var Il,q_=y(()=>{a();l();c();Ie();I();De();Il=class extends B{connectedCallback(){super.connectedCallback(),this.shape||(this.shape="circle")}};b([w],Il.prototype,"fill",void 0);b([w],Il.prototype,"color",void 0);b([w],Il.prototype,"link",void 0);b([w],Il.prototype,"shape",void 0)});var G_=y(()=>{a();l();c();z_();q_()});var j_,K_=y(()=>{a();l();c();I();j_=(r,e)=>R`
    <template class="${t=>t.circular?"circular":""}">
        <div class="control" part="control" style="${t=>t.generateBadgeStyle()}">
            <slot></slot>
        </div>
    </template>
`});var fs,W_=y(()=>{a();l();c();Ie();I();De();fs=class extends B{constructor(){super(...arguments),this.generateBadgeStyle=()=>{if(!this.fill&&!this.color)return;let e=`background-color: var(--badge-fill-${this.fill});`,t=`color: var(--badge-color-${this.color});`;return this.fill&&!this.color?e:this.color&&!this.fill?t:`${t} ${e}`}}};b([w({attribute:"fill"})],fs.prototype,"fill",void 0);b([w({attribute:"color"})],fs.prototype,"color",void 0);b([w({mode:"boolean"})],fs.prototype,"circular",void 0)});var Q_=y(()=>{a();l();c();K_();W_()});var Y_,Z_=y(()=>{a();l();c();I();Gv();St();Y_=(r,e)=>R`
    <div role="listitem" class="listitem" part="listitem">
        ${Qe(t=>t.href&&t.href.length>0,R`
                ${lp(r,e)}
            `)}
        ${Qe(t=>!t.href,R`
                ${pt(r,e)}
                <slot></slot>
                ${ht(r,e)}
            `)}
        ${Qe(t=>t.separator,R`
                <span class="separator" part="separator" aria-hidden="true">
                    <slot name="separator">${e.separator||""}</slot>
                </span>
            `)}
    </div>
`});var kn,Xv=y(()=>{a();l();c();Ie();I();jv();xa();Tr();kn=class extends Nr{constructor(){super(...arguments),this.separator=!0}};b([k],kn.prototype,"separator",void 0);je(kn,mt,Sa)});var J_=y(()=>{a();l();c();Z_();Xv()});var X_,eE=y(()=>{a();l();c();I();X_=(r,e)=>R`
    <template role="navigation">
        <div role="list" class="list" part="list">
            <slot
                ${Oe({property:"slottedBreadcrumbItems",filter:Er()})}
            ></slot>
        </div>
    </template>
`});var vd,tE=y(()=>{a();l();c();Ie();I();Xv();De();vd=class extends B{slottedBreadcrumbItemsChanged(){if(this.$fastController.isConnected){if(this.slottedBreadcrumbItems===void 0||this.slottedBreadcrumbItems.length===0)return;let e=this.slottedBreadcrumbItems[this.slottedBreadcrumbItems.length-1];this.slottedBreadcrumbItems.forEach(t=>{let o=t===e;this.setItemSeparator(t,o),this.setAriaCurrent(t,o)})}}setItemSeparator(e,t){e instanceof kn&&(e.separator=!t)}findChildWithHref(e){var t,o;return e.childElementCount>0?e.querySelector("a[href]"):!((t=e.shadowRoot)===null||t===void 0)&&t.childElementCount?(o=e.shadowRoot)===null||o===void 0?void 0:o.querySelector("a[href]"):null}setAriaCurrent(e,t){let o=this.findChildWithHref(e);o===null&&e.hasAttribute("href")&&e instanceof kn?t?e.setAttribute("aria-current","page"):e.removeAttribute("aria-current"):o!==null&&(t?o.setAttribute("aria-current","page"):o.removeAttribute("aria-current"))}};b([k],vd.prototype,"slottedBreadcrumbItems",void 0)});var rE=y(()=>{a();l();c();eE();tE()});var oE,iE=y(()=>{a();l();c();I();St();oE=(r,e)=>R`
    <button
        class="control"
        part="control"
        ?autofocus="${t=>t.autofocus}"
        ?disabled="${t=>t.disabled}"
        form="${t=>t.formId}"
        formaction="${t=>t.formaction}"
        formenctype="${t=>t.formenctype}"
        formmethod="${t=>t.formmethod}"
        formnovalidate="${t=>t.formnovalidate}"
        formtarget="${t=>t.formtarget}"
        name="${t=>t.name}"
        type="${t=>t.type}"
        value="${t=>t.value}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-pressed="${t=>t.ariaPressed}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${we("control")}
    >
        ${pt(r,e)}
        <span class="content" part="content">
            <slot ${Oe("defaultSlottedContent")}></slot>
        </span>
        ${ht(r,e)}
    </button>
`});function fr(r){let e=class extends r{constructor(...t){super(...t),this.dirtyValue=!1,this.disabled=!1,this.proxyEventsToBlock=["change","click"],this.proxyInitialized=!1,this.required=!1,this.initialValue=this.initialValue||"",this.elementInternals||(this.formResetCallback=this.formResetCallback.bind(this))}static get formAssociated(){return aE}get validity(){return this.elementInternals?this.elementInternals.validity:this.proxy.validity}get form(){return this.elementInternals?this.elementInternals.form:this.proxy.form}get validationMessage(){return this.elementInternals?this.elementInternals.validationMessage:this.proxy.validationMessage}get willValidate(){return this.elementInternals?this.elementInternals.willValidate:this.proxy.willValidate}get labels(){if(this.elementInternals)return Object.freeze(Array.from(this.elementInternals.labels));if(this.proxy instanceof HTMLElement&&this.proxy.ownerDocument&&this.id){let t=this.proxy.labels,o=Array.from(this.proxy.getRootNode().querySelectorAll(`[for='${this.id}']`)),i=t?o.concat(Array.from(t)):o;return Object.freeze(i)}else return Wo}valueChanged(t,o){this.dirtyValue=!0,this.proxy instanceof HTMLElement&&(this.proxy.value=this.value),this.currentValue=this.value,this.setFormValue(this.value),this.validate()}currentValueChanged(){this.value=this.currentValue}initialValueChanged(t,o){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}disabledChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.disabled=this.disabled),W.queueUpdate(()=>this.classList.toggle("disabled",this.disabled))}nameChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.name=this.name)}requiredChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.required=this.required),W.queueUpdate(()=>this.classList.toggle("required",this.required)),this.validate()}get elementInternals(){if(!aE)return null;let t=lE.get(this);return t||(t=this.attachInternals(),lE.set(this,t)),t}connectedCallback(){super.connectedCallback(),this.addEventListener("keypress",this._keypressHandler),this.value||(this.value=this.initialValue,this.dirtyValue=!1),this.elementInternals||(this.attachProxy(),this.form&&this.form.addEventListener("reset",this.formResetCallback))}disconnectedCallback(){this.proxyEventsToBlock.forEach(t=>this.proxy.removeEventListener(t,this.stopPropagation)),!this.elementInternals&&this.form&&this.form.removeEventListener("reset",this.formResetCallback)}checkValidity(){return this.elementInternals?this.elementInternals.checkValidity():this.proxy.checkValidity()}reportValidity(){return this.elementInternals?this.elementInternals.reportValidity():this.proxy.reportValidity()}setValidity(t,o,i){this.elementInternals?this.elementInternals.setValidity(t,o,i):typeof o=="string"&&this.proxy.setCustomValidity(o)}formDisabledCallback(t){this.disabled=t}formResetCallback(){this.value=this.initialValue,this.dirtyValue=!1}attachProxy(){var t;this.proxyInitialized||(this.proxyInitialized=!0,this.proxy.style.display="none",this.proxyEventsToBlock.forEach(o=>this.proxy.addEventListener(o,this.stopPropagation)),this.proxy.disabled=this.disabled,this.proxy.required=this.required,typeof this.name=="string"&&(this.proxy.name=this.name),typeof this.value=="string"&&(this.proxy.value=this.value),this.proxy.setAttribute("slot",nE),this.proxySlot=document.createElement("slot"),this.proxySlot.setAttribute("name",nE)),(t=this.shadowRoot)===null||t===void 0||t.appendChild(this.proxySlot),this.appendChild(this.proxy)}detachProxy(){var t;this.removeChild(this.proxy),(t=this.shadowRoot)===null||t===void 0||t.removeChild(this.proxySlot)}validate(t){this.proxy instanceof HTMLElement&&this.setValidity(this.proxy.validity,this.proxy.validationMessage,t)}setFormValue(t,o){this.elementInternals&&this.elementInternals.setFormValue(t,o||t)}_keypressHandler(t){switch(t.key){case Zt:if(this.form instanceof HTMLFormElement){let o=this.form.querySelector("[type=submit]");o?.click()}break}}stopPropagation(t){t.stopPropagation()}};return w({mode:"boolean"})(e.prototype,"disabled"),w({mode:"fromView",attribute:"value"})(e.prototype,"initialValue"),w({attribute:"current-value"})(e.prototype,"currentValue"),w(e.prototype,"name"),w({mode:"boolean"})(e.prototype,"required"),k(e.prototype,"value"),e}function Al(r){class e extends fr(r){}class t extends e{constructor(...i){super(i),this.dirtyChecked=!1,this.checkedAttribute=!1,this.checked=!1,this.dirtyChecked=!1}checkedAttributeChanged(){this.defaultChecked=this.checkedAttribute}defaultCheckedChanged(){this.dirtyChecked||(this.checked=this.defaultChecked,this.dirtyChecked=!1)}checkedChanged(i,n){this.dirtyChecked||(this.dirtyChecked=!0),this.currentChecked=this.checked,this.updateForm(),this.proxy instanceof HTMLInputElement&&(this.proxy.checked=this.checked),i!==void 0&&this.$emit("change"),this.validate()}currentCheckedChanged(i,n){this.checked=this.currentChecked}updateForm(){let i=this.checked?this.value:null;this.setFormValue(i,i)}connectedCallback(){super.connectedCallback(),this.updateForm()}formResetCallback(){super.formResetCallback(),this.checked=!!this.checkedAttribute,this.dirtyChecked=!1}}return w({attribute:"checked",mode:"boolean"})(t.prototype,"checkedAttribute"),w({attribute:"current-checked",converter:_n})(t.prototype,"currentChecked"),k(t.prototype,"defaultChecked"),k(t.prototype,"checked"),t}var nE,sE,aE,lE,wo=y(()=>{a();l();c();I();pe();nE="form-associated-proxy",sE="ElementInternals",aE=sE in window&&"setFormValue"in window[sE].prototype,lE=new WeakMap});var e0,dp,cE=y(()=>{a();l();c();wo();De();e0=class extends B{},dp=class extends fr(e0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Hr,Rl,dE=y(()=>{a();l();c();Ie();I();xa();Tr();cE();Hr=class extends dp{constructor(){super(...arguments),this.handleClick=e=>{var t;this.disabled&&((t=this.defaultSlottedContent)===null||t===void 0?void 0:t.length)<=1&&e.stopPropagation()},this.handleSubmission=()=>{if(!this.form)return;let e=this.proxy.isConnected;e||this.attachProxy(),typeof this.form.requestSubmit=="function"?this.form.requestSubmit(this.proxy):this.proxy.click(),e||this.detachProxy()},this.handleFormReset=()=>{var e;(e=this.form)===null||e===void 0||e.reset()},this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(!((e=this.$fastController.definition.shadowOptions)===null||e===void 0)&&e.delegatesFocus)&&(this.focus=()=>{this.control.focus()})}}formactionChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formAction=this.formaction)}formenctypeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formEnctype=this.formenctype)}formmethodChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formMethod=this.formmethod)}formnovalidateChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formNoValidate=this.formnovalidate)}formtargetChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formTarget=this.formtarget)}typeChanged(e,t){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type),t==="submit"&&this.addEventListener("click",this.handleSubmission),e==="submit"&&this.removeEventListener("click",this.handleSubmission),t==="reset"&&this.addEventListener("click",this.handleFormReset),e==="reset"&&this.removeEventListener("click",this.handleFormReset)}validate(){super.validate(this.control)}connectedCallback(){var e;super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.handleUnsupportedDelegatesFocus();let t=Array.from((e=this.control)===null||e===void 0?void 0:e.children);t&&t.forEach(o=>{o.addEventListener("click",this.handleClick)})}disconnectedCallback(){var e;super.disconnectedCallback();let t=Array.from((e=this.control)===null||e===void 0?void 0:e.children);t&&t.forEach(o=>{o.removeEventListener("click",this.handleClick)})}};b([w({mode:"boolean"})],Hr.prototype,"autofocus",void 0);b([w({attribute:"form"})],Hr.prototype,"formId",void 0);b([w],Hr.prototype,"formaction",void 0);b([w],Hr.prototype,"formenctype",void 0);b([w],Hr.prototype,"formmethod",void 0);b([w({mode:"boolean"})],Hr.prototype,"formnovalidate",void 0);b([w],Hr.prototype,"formtarget",void 0);b([w],Hr.prototype,"type",void 0);b([k],Hr.prototype,"defaultSlottedContent",void 0);Rl=class{};b([w({attribute:"aria-expanded"})],Rl.prototype,"ariaExpanded",void 0);b([w({attribute:"aria-pressed"})],Rl.prototype,"ariaPressed",void 0);je(Rl,st);je(Hr,mt,Rl)});var uE=y(()=>{a();l();c();iE();dE()});var up,t0=y(()=>{a();l();c();up=class{constructor(e){if(this.dayFormat="numeric",this.weekdayFormat="long",this.monthFormat="long",this.yearFormat="numeric",this.date=new Date,e)for(let t in e){let o=e[t];t==="date"?this.date=this.getDateObject(o):this[t]=o}}getDateObject(e){if(typeof e=="string"){let t=e.split(/[/-]/);return t.length<3?new Date:new Date(parseInt(t[2],10),parseInt(t[0],10)-1,parseInt(t[1],10))}else if("day"in e&&"month"in e&&"year"in e){let{day:t,month:o,year:i}=e;return new Date(i,o-1,t)}return e}getDate(e=this.date,t={weekday:this.weekdayFormat,month:this.monthFormat,day:this.dayFormat,year:this.yearFormat},o=this.locale){let i=this.getDateObject(e);if(!i.getTime())return"";let n=Object.assign({timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},t);return new Intl.DateTimeFormat(o,n).format(i)}getDay(e=this.date.getDate(),t=this.dayFormat,o=this.locale){return this.getDate({month:1,day:e,year:2020},{day:t},o)}getMonth(e=this.date.getMonth()+1,t=this.monthFormat,o=this.locale){return this.getDate({month:e,day:2,year:2020},{month:t},o)}getYear(e=this.date.getFullYear(),t=this.yearFormat,o=this.locale){return this.getDate({month:2,day:2,year:e},{year:t},o)}getWeekday(e=0,t=this.weekdayFormat,o=this.locale){let i=`1-${e+1}-2017`;return this.getDate(i,{weekday:t},o)}getWeekdays(e=this.weekdayFormat,t=this.locale){return Array(7).fill(null).map((o,i)=>this.getWeekday(i,e,t))}}});var ao,hE=y(()=>{a();l();c();Ie();I();pe();De();t0();ao=class extends B{constructor(){super(...arguments),this.dateFormatter=new up,this.readonly=!1,this.locale="en-US",this.month=new Date().getMonth()+1,this.year=new Date().getFullYear(),this.dayFormat="numeric",this.weekdayFormat="short",this.monthFormat="long",this.yearFormat="numeric",this.minWeeks=0,this.disabledDates="",this.selectedDates="",this.oneDayInMs=864e5}localeChanged(){this.dateFormatter.locale=this.locale}dayFormatChanged(){this.dateFormatter.dayFormat=this.dayFormat}weekdayFormatChanged(){this.dateFormatter.weekdayFormat=this.weekdayFormat}monthFormatChanged(){this.dateFormatter.monthFormat=this.monthFormat}yearFormatChanged(){this.dateFormatter.yearFormat=this.yearFormat}getMonthInfo(e=this.month,t=this.year){let o=u=>new Date(u.getFullYear(),u.getMonth(),1).getDay(),i=u=>{let h=new Date(u.getFullYear(),u.getMonth()+1,1);return new Date(h.getTime()-this.oneDayInMs).getDate()},n=new Date(t,e-1),s=new Date(t,e),d=new Date(t,e-2);return{length:i(n),month:e,start:o(n),year:t,previous:{length:i(d),month:d.getMonth()+1,start:o(d),year:d.getFullYear()},next:{length:i(s),month:s.getMonth()+1,start:o(s),year:s.getFullYear()}}}getDays(e=this.getMonthInfo(),t=this.minWeeks){t=t>10?10:t;let{start:o,length:i,previous:n,next:s}=e,d=[],u=1-o;for(;u<i+1||d.length<t||d[d.length-1].length%7!==0;){let{month:h,year:p}=u<1?n:u>i?s:e,v=u<1?n.length+u:u>i?u-i:u,C=`${h}-${v}-${p}`,x=this.dateInString(C,this.disabledDates),E=this.dateInString(C,this.selectedDates),O={day:v,month:h,year:p,disabled:x,selected:E},q=d[d.length-1];d.length===0||q.length%7===0?d.push([O]):q.push(O),u++}return d}dateInString(e,t){let o=t.split(",").map(i=>i.trim());return e=typeof e=="string"?e:`${e.getMonth()+1}-${e.getDate()}-${e.getFullYear()}`,o.some(i=>i===e)}getDayClassNames(e,t){let{day:o,month:i,year:n,disabled:s,selected:d}=e,u=t===`${i}-${o}-${n}`,h=this.month!==i;return["day",u&&"today",h&&"inactive",s&&"disabled",d&&"selected"].filter(Boolean).join(" ")}getWeekdayText(){let e=this.dateFormatter.getWeekdays().map(t=>({text:t}));if(this.weekdayFormat!=="long"){let t=this.dateFormatter.getWeekdays("long");e.forEach((o,i)=>{o.abbr=t[i]})}return e}handleDateSelect(e,t){e.preventDefault,this.$emit("dateselected",t)}handleKeydown(e,t){return e.key===Zt&&this.handleDateSelect(e,t),!0}};b([w({mode:"boolean"})],ao.prototype,"readonly",void 0);b([w],ao.prototype,"locale",void 0);b([w({converter:ee})],ao.prototype,"month",void 0);b([w({converter:ee})],ao.prototype,"year",void 0);b([w({attribute:"day-format",mode:"fromView"})],ao.prototype,"dayFormat",void 0);b([w({attribute:"weekday-format",mode:"fromView"})],ao.prototype,"weekdayFormat",void 0);b([w({attribute:"month-format",mode:"fromView"})],ao.prototype,"monthFormat",void 0);b([w({attribute:"year-format",mode:"fromView"})],ao.prototype,"yearFormat",void 0);b([w({attribute:"min-weeks",converter:ee})],ao.prototype,"minWeeks",void 0);b([w({attribute:"disabled-dates"})],ao.prototype,"disabledDates",void 0);b([w({attribute:"selected-dates"})],ao.prototype,"selectedDates",void 0)});var yd,In,_a,hp=y(()=>{a();l();c();yd={none:"none",default:"default",sticky:"sticky"},In={default:"default",columnHeader:"columnheader",rowHeader:"rowheader"},_a={default:"default",header:"header",stickyHeader:"sticky-header"}});var Jt,r0=y(()=>{a();l();c();Ie();I();pe();De();hp();Jt=class extends B{constructor(){super(...arguments),this.rowType=_a.default,this.rowData=null,this.columnDefinitions=null,this.isActiveRow=!1,this.cellsRepeatBehavior=null,this.cellsPlaceholder=null,this.focusColumnIndex=0,this.refocusOnLoad=!1,this.updateRowStyle=()=>{this.style.gridTemplateColumns=this.gridTemplateColumns}}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowStyle()}rowTypeChanged(){this.$fastController.isConnected&&this.updateItemTemplate()}rowDataChanged(){if(this.rowData!==null&&this.isActiveRow){this.refocusOnLoad=!0;return}}cellItemTemplateChanged(){this.updateItemTemplate()}headerCellItemTemplateChanged(){this.updateItemTemplate()}connectedCallback(){super.connectedCallback(),this.cellsRepeatBehavior===null&&(this.cellsPlaceholder=document.createComment(""),this.appendChild(this.cellsPlaceholder),this.updateItemTemplate(),this.cellsRepeatBehavior=new zi(e=>e.columnDefinitions,e=>e.activeCellItemTemplate,{positioning:!0}).createBehavior(this.cellsPlaceholder),this.$fastController.addBehaviors([this.cellsRepeatBehavior])),this.addEventListener("cell-focused",this.handleCellFocus),this.addEventListener(En,this.handleFocusout),this.addEventListener(Tn,this.handleKeydown),this.updateRowStyle(),this.refocusOnLoad&&(this.refocusOnLoad=!1,this.cellElements.length>this.focusColumnIndex&&this.cellElements[this.focusColumnIndex].focus())}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("cell-focused",this.handleCellFocus),this.removeEventListener(En,this.handleFocusout),this.removeEventListener(Tn,this.handleKeydown)}handleFocusout(e){this.contains(e.target)||(this.isActiveRow=!1,this.focusColumnIndex=0)}handleCellFocus(e){this.isActiveRow=!0,this.focusColumnIndex=this.cellElements.indexOf(e.target),this.$emit("row-focused",this)}handleKeydown(e){if(e.defaultPrevented)return;let t=0;switch(e.key){case Wr:t=Math.max(0,this.focusColumnIndex-1),this.cellElements[t].focus(),e.preventDefault();break;case Qr:t=Math.min(this.cellElements.length-1,this.focusColumnIndex+1),this.cellElements[t].focus(),e.preventDefault();break;case lr:e.ctrlKey||(this.cellElements[0].focus(),e.preventDefault());break;case cr:e.ctrlKey||(this.cellElements[this.cellElements.length-1].focus(),e.preventDefault());break}}updateItemTemplate(){this.activeCellItemTemplate=this.rowType===_a.default&&this.cellItemTemplate!==void 0?this.cellItemTemplate:this.rowType===_a.default&&this.cellItemTemplate===void 0?this.defaultCellItemTemplate:this.headerCellItemTemplate!==void 0?this.headerCellItemTemplate:this.defaultHeaderCellItemTemplate}};b([w({attribute:"grid-template-columns"})],Jt.prototype,"gridTemplateColumns",void 0);b([w({attribute:"row-type"})],Jt.prototype,"rowType",void 0);b([k],Jt.prototype,"rowData",void 0);b([k],Jt.prototype,"columnDefinitions",void 0);b([k],Jt.prototype,"cellItemTemplate",void 0);b([k],Jt.prototype,"headerCellItemTemplate",void 0);b([k],Jt.prototype,"rowIndex",void 0);b([k],Jt.prototype,"isActiveRow",void 0);b([k],Jt.prototype,"activeCellItemTemplate",void 0);b([k],Jt.prototype,"defaultCellItemTemplate",void 0);b([k],Jt.prototype,"defaultHeaderCellItemTemplate",void 0);b([k],Jt.prototype,"cellElements",void 0)});function BP(r){let e=r.tagFor(Jt);return R`
    <${e}
        :rowData="${t=>t}"
        :cellItemTemplate="${(t,o)=>o.parent.cellItemTemplate}"
        :headerCellItemTemplate="${(t,o)=>o.parent.headerCellItemTemplate}"
    ></${e}>
`}var pE,fE=y(()=>{a();l();c();I();r0();pE=(r,e)=>{let t=BP(r),o=r.tagFor(Jt);return R`
        <template
            role="grid"
            tabindex="0"
            :rowElementTag="${()=>o}"
            :defaultRowItemTemplate="${t}"
            ${cs({property:"rowElements",filter:Er("[role=row]")})}
        >
            <slot></slot>
        </template>
    `}});var dr,mE=y(()=>{a();l();c();Ie();I();pe();De();hp();dr=class r extends B{constructor(){super(),this.noTabbing=!1,this.generateHeader=yd.default,this.rowsData=[],this.columnDefinitions=null,this.focusRowIndex=0,this.focusColumnIndex=0,this.rowsPlaceholder=null,this.generatedHeader=null,this.isUpdatingFocus=!1,this.pendingFocusUpdate=!1,this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!0,this.generatedGridTemplateColumns="",this.focusOnCell=(e,t,o)=>{if(this.rowElements.length===0){this.focusRowIndex=0,this.focusColumnIndex=0;return}let i=Math.max(0,Math.min(this.rowElements.length-1,e)),s=this.rowElements[i].querySelectorAll('[role="cell"], [role="gridcell"], [role="columnheader"], [role="rowheader"]'),d=Math.max(0,Math.min(s.length-1,t)),u=s[d];o&&this.scrollHeight!==this.clientHeight&&(i<this.focusRowIndex&&this.scrollTop>0||i>this.focusRowIndex&&this.scrollTop<this.scrollHeight-this.clientHeight)&&u.scrollIntoView({block:"center",inline:"center"}),u.focus()},this.onChildListChange=(e,t)=>{e&&e.length&&(e.forEach(o=>{o.addedNodes.forEach(i=>{i.nodeType===1&&i.getAttribute("role")==="row"&&(i.columnDefinitions=this.columnDefinitions)})}),this.queueRowIndexUpdate())},this.queueRowIndexUpdate=()=>{this.rowindexUpdateQueued||(this.rowindexUpdateQueued=!0,W.queueUpdate(this.updateRowIndexes))},this.updateRowIndexes=()=>{let e=this.gridTemplateColumns;if(e===void 0){if(this.generatedGridTemplateColumns===""&&this.rowElements.length>0){let t=this.rowElements[0];this.generatedGridTemplateColumns=new Array(t.cellElements.length).fill("1fr").join(" ")}e=this.generatedGridTemplateColumns}this.rowElements.forEach((t,o)=>{let i=t;i.rowIndex=o,i.gridTemplateColumns=e,this.columnDefinitionsStale&&(i.columnDefinitions=this.columnDefinitions)}),this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!1}}static generateTemplateColumns(e){let t="";return e.forEach(o=>{t=`${t}${t===""?"":" "}1fr`}),t}noTabbingChanged(){this.$fastController.isConnected&&(this.noTabbing?this.setAttribute("tabIndex","-1"):this.setAttribute("tabIndex",this.contains(document.activeElement)||this===document.activeElement?"-1":"0"))}generateHeaderChanged(){this.$fastController.isConnected&&this.toggleGeneratedHeader()}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowIndexes()}rowsDataChanged(){this.columnDefinitions===null&&this.rowsData.length>0&&(this.columnDefinitions=r.generateColumns(this.rowsData[0])),this.$fastController.isConnected&&this.toggleGeneratedHeader()}columnDefinitionsChanged(){if(this.columnDefinitions===null){this.generatedGridTemplateColumns="";return}this.generatedGridTemplateColumns=r.generateTemplateColumns(this.columnDefinitions),this.$fastController.isConnected&&(this.columnDefinitionsStale=!0,this.queueRowIndexUpdate())}headerCellItemTemplateChanged(){this.$fastController.isConnected&&this.generatedHeader!==null&&(this.generatedHeader.headerCellItemTemplate=this.headerCellItemTemplate)}focusRowIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}focusColumnIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}connectedCallback(){super.connectedCallback(),this.rowItemTemplate===void 0&&(this.rowItemTemplate=this.defaultRowItemTemplate),this.rowsPlaceholder=document.createComment(""),this.appendChild(this.rowsPlaceholder),this.toggleGeneratedHeader(),this.rowsRepeatBehavior=new zi(e=>e.rowsData,e=>e.rowItemTemplate,{positioning:!0}).createBehavior(this.rowsPlaceholder),this.$fastController.addBehaviors([this.rowsRepeatBehavior]),this.addEventListener("row-focused",this.handleRowFocus),this.addEventListener(Uv,this.handleFocus),this.addEventListener(Tn,this.handleKeydown),this.addEventListener(En,this.handleFocusOut),this.observer=new MutationObserver(this.onChildListChange),this.observer.observe(this,{childList:!0}),this.noTabbing&&this.setAttribute("tabindex","-1"),W.queueUpdate(this.queueRowIndexUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("row-focused",this.handleRowFocus),this.removeEventListener(Uv,this.handleFocus),this.removeEventListener(Tn,this.handleKeydown),this.removeEventListener(En,this.handleFocusOut),this.observer.disconnect(),this.rowsPlaceholder=null,this.generatedHeader=null}handleRowFocus(e){this.isUpdatingFocus=!0;let t=e.target;this.focusRowIndex=this.rowElements.indexOf(t),this.focusColumnIndex=t.focusColumnIndex,this.setAttribute("tabIndex","-1"),this.isUpdatingFocus=!1}handleFocus(e){this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}handleFocusOut(e){(e.relatedTarget===null||!this.contains(e.relatedTarget))&&this.setAttribute("tabIndex",this.noTabbing?"-1":"0")}handleKeydown(e){if(e.defaultPrevented)return;let t,o=this.rowElements.length-1,i=this.offsetHeight+this.scrollTop,n=this.rowElements[o];switch(e.key){case Ft:e.preventDefault(),this.focusOnCell(this.focusRowIndex-1,this.focusColumnIndex,!0);break;case Mt:e.preventDefault(),this.focusOnCell(this.focusRowIndex+1,this.focusColumnIndex,!0);break;case S_:if(e.preventDefault(),this.rowElements.length===0){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex===0){this.focusOnCell(0,this.focusColumnIndex,!1);return}for(t=this.focusRowIndex-1,t;t>=0;t--){let s=this.rowElements[t];if(s.offsetTop<this.scrollTop){this.scrollTop=s.offsetTop+s.clientHeight-this.clientHeight;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case x_:if(e.preventDefault(),this.rowElements.length===0){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex>=o||n.offsetTop+n.offsetHeight<=i){this.focusOnCell(o,this.focusColumnIndex,!1);return}for(t=this.focusRowIndex+1,t;t<=o;t++){let s=this.rowElements[t];if(s.offsetTop+s.offsetHeight>i){let d=0;this.generateHeader===yd.sticky&&this.generatedHeader!==null&&(d=this.generatedHeader.clientHeight),this.scrollTop=s.offsetTop-d;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case lr:e.ctrlKey&&(e.preventDefault(),this.focusOnCell(0,0,!0));break;case cr:e.ctrlKey&&this.columnDefinitions!==null&&(e.preventDefault(),this.focusOnCell(this.rowElements.length-1,this.columnDefinitions.length-1,!0));break}}queueFocusUpdate(){this.isUpdatingFocus&&(this.contains(document.activeElement)||this===document.activeElement)||this.pendingFocusUpdate===!1&&(this.pendingFocusUpdate=!0,W.queueUpdate(()=>this.updateFocus()))}updateFocus(){this.pendingFocusUpdate=!1,this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}toggleGeneratedHeader(){if(this.generatedHeader!==null&&(this.removeChild(this.generatedHeader),this.generatedHeader=null),this.generateHeader!==yd.none&&this.rowsData.length>0){let e=document.createElement(this.rowElementTag);this.generatedHeader=e,this.generatedHeader.columnDefinitions=this.columnDefinitions,this.generatedHeader.gridTemplateColumns=this.gridTemplateColumns,this.generatedHeader.rowType=this.generateHeader===yd.sticky?_a.stickyHeader:_a.header,(this.firstChild!==null||this.rowsPlaceholder!==null)&&this.insertBefore(e,this.firstChild!==null?this.firstChild:this.rowsPlaceholder);return}}};dr.generateColumns=r=>Object.getOwnPropertyNames(r).map((e,t)=>({columnDataKey:e,gridColumn:`${t}`}));b([w({attribute:"no-tabbing",mode:"boolean"})],dr.prototype,"noTabbing",void 0);b([w({attribute:"generate-header"})],dr.prototype,"generateHeader",void 0);b([w({attribute:"grid-template-columns"})],dr.prototype,"gridTemplateColumns",void 0);b([k],dr.prototype,"rowsData",void 0);b([k],dr.prototype,"columnDefinitions",void 0);b([k],dr.prototype,"rowItemTemplate",void 0);b([k],dr.prototype,"cellItemTemplate",void 0);b([k],dr.prototype,"headerCellItemTemplate",void 0);b([k],dr.prototype,"focusRowIndex",void 0);b([k],dr.prototype,"focusColumnIndex",void 0);b([k],dr.prototype,"defaultRowItemTemplate",void 0);b([k],dr.prototype,"rowElementTag",void 0);b([k],dr.prototype,"rowElements",void 0)});var VP,zP,xo,o0=y(()=>{a();l();c();Ie();I();pe();De();hp();VP=R`
    <template>
        ${r=>r.rowData===null||r.columnDefinition===null||r.columnDefinition.columnDataKey===null?null:r.rowData[r.columnDefinition.columnDataKey]}
    </template>
`,zP=R`
    <template>
        ${r=>r.columnDefinition===null?null:r.columnDefinition.title===void 0?r.columnDefinition.columnDataKey:r.columnDefinition.title}
    </template>
`,xo=class extends B{constructor(){super(...arguments),this.cellType=In.default,this.rowData=null,this.columnDefinition=null,this.isActiveCell=!1,this.customCellView=null,this.updateCellStyle=()=>{this.style.gridColumn=this.gridColumn}}cellTypeChanged(){this.$fastController.isConnected&&this.updateCellView()}gridColumnChanged(){this.$fastController.isConnected&&this.updateCellStyle()}columnDefinitionChanged(e,t){this.$fastController.isConnected&&this.updateCellView()}connectedCallback(){var e;super.connectedCallback(),this.addEventListener(Bv,this.handleFocusin),this.addEventListener(En,this.handleFocusout),this.addEventListener(Tn,this.handleKeydown),this.style.gridColumn=`${((e=this.columnDefinition)===null||e===void 0?void 0:e.gridColumn)===void 0?0:this.columnDefinition.gridColumn}`,this.updateCellView(),this.updateCellStyle()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(Bv,this.handleFocusin),this.removeEventListener(En,this.handleFocusout),this.removeEventListener(Tn,this.handleKeydown),this.disconnectCellView()}handleFocusin(e){if(!this.isActiveCell){switch(this.isActiveCell=!0,this.cellType){case In.columnHeader:if(this.columnDefinition!==null&&this.columnDefinition.headerCellInternalFocusQueue!==!0&&typeof this.columnDefinition.headerCellFocusTargetCallback=="function"){let t=this.columnDefinition.headerCellFocusTargetCallback(this);t!==null&&t.focus()}break;default:if(this.columnDefinition!==null&&this.columnDefinition.cellInternalFocusQueue!==!0&&typeof this.columnDefinition.cellFocusTargetCallback=="function"){let t=this.columnDefinition.cellFocusTargetCallback(this);t!==null&&t.focus()}break}this.$emit("cell-focused",this)}}handleFocusout(e){this!==document.activeElement&&!this.contains(document.activeElement)&&(this.isActiveCell=!1)}handleKeydown(e){if(!(e.defaultPrevented||this.columnDefinition===null||this.cellType===In.default&&this.columnDefinition.cellInternalFocusQueue!==!0||this.cellType===In.columnHeader&&this.columnDefinition.headerCellInternalFocusQueue!==!0))switch(e.key){case Zt:case w_:if(this.contains(document.activeElement)&&document.activeElement!==this)return;switch(this.cellType){case In.columnHeader:if(this.columnDefinition.headerCellFocusTargetCallback!==void 0){let t=this.columnDefinition.headerCellFocusTargetCallback(this);t!==null&&t.focus(),e.preventDefault()}break;default:if(this.columnDefinition.cellFocusTargetCallback!==void 0){let t=this.columnDefinition.cellFocusTargetCallback(this);t!==null&&t.focus(),e.preventDefault()}break}break;case bo:this.contains(document.activeElement)&&document.activeElement!==this&&(this.focus(),e.preventDefault());break}}updateCellView(){if(this.disconnectCellView(),this.columnDefinition!==null)switch(this.cellType){case In.columnHeader:this.columnDefinition.headerCellTemplate!==void 0?this.customCellView=this.columnDefinition.headerCellTemplate.render(this,this):this.customCellView=zP.render(this,this);break;case void 0:case In.rowHeader:case In.default:this.columnDefinition.cellTemplate!==void 0?this.customCellView=this.columnDefinition.cellTemplate.render(this,this):this.customCellView=VP.render(this,this);break}}disconnectCellView(){this.customCellView!==null&&(this.customCellView.dispose(),this.customCellView=null)}};b([w({attribute:"cell-type"})],xo.prototype,"cellType",void 0);b([w({attribute:"grid-column"})],xo.prototype,"gridColumn",void 0);b([k],xo.prototype,"rowData",void 0);b([k],xo.prototype,"columnDefinition",void 0)});function qP(r){let e=r.tagFor(xo);return R`
    <${e}
        cell-type="${t=>t.isRowHeader?"rowheader":void 0}"
        grid-column="${(t,o)=>o.index+1}"
        :rowData="${(t,o)=>o.parent.rowData}"
        :columnDefinition="${t=>t}"
    ></${e}>
`}function GP(r){let e=r.tagFor(xo);return R`
    <${e}
        cell-type="columnheader"
        grid-column="${(t,o)=>o.index+1}"
        :columnDefinition="${t=>t}"
    ></${e}>
`}var gE,vE=y(()=>{a();l();c();I();o0();gE=(r,e)=>{let t=qP(r),o=GP(r);return R`
        <template
            role="row"
            class="${i=>i.rowType!=="default"?i.rowType:""}"
            :defaultCellItemTemplate="${t}"
            :defaultHeaderCellItemTemplate="${o}"
            ${cs({property:"cellElements",filter:Er('[role="cell"],[role="gridcell"],[role="columnheader"],[role="rowheader"]')})}
        >
            <slot ${Oe("slottedCellElements")}></slot>
        </template>
    `}});var yE,bE=y(()=>{a();l();c();I();yE=(r,e)=>R`
        <template
            tabindex="-1"
            role="${t=>!t.cellType||t.cellType==="default"?"gridcell":t.cellType}"
            class="
            ${t=>t.cellType==="columnheader"?"column-header":t.cellType==="rowheader"?"row-header":""}
            "
        >
            <slot></slot>
        </template>
    `});var i0=y(()=>{a();l();c();fE();mE();vE();r0();bE();o0()});var CE,jP,KP,WP,QP,YP,wE,xE=y(()=>{a();l();c();I();St();i0();CE=R`
    <div
        class="title"
        part="title"
        aria-label="${r=>r.dateFormatter.getDate(`${r.month}-2-${r.year}`,{month:"long",year:"numeric"})}"
    >
        <span part="month">
            ${r=>r.dateFormatter.getMonth(r.month)}
        </span>
        <span part="year">${r=>r.dateFormatter.getYear(r.year)}</span>
    </div>
`,jP=r=>{let e=r.tagFor(xo);return R`
        <${e}
            class="week-day"
            part="week-day"
            tabindex="-1"
            grid-column="${(t,o)=>o.index+1}"
            abbr="${t=>t.abbr}"
        >
            ${t=>t.text}
        </${e}>
    `},KP=(r,e)=>{let t=r.tagFor(xo);return R`
        <${t}
            class="${(o,i)=>i.parentContext.parent.getDayClassNames(o,e)}"
            part="day"
            tabindex="-1"
            role="gridcell"
            grid-column="${(o,i)=>i.index+1}"
            @click="${(o,i)=>i.parentContext.parent.handleDateSelect(i.event,o)}"
            @keydown="${(o,i)=>i.parentContext.parent.handleKeydown(i.event,o)}"
            aria-label="${(o,i)=>i.parentContext.parent.dateFormatter.getDate(`${o.month}-${o.day}-${o.year}`,{month:"long",day:"numeric"})}"
        >
            <div
                class="date"
                part="${o=>e===`${o.month}-${o.day}-${o.year}`?"today":"date"}"
            >
                ${(o,i)=>i.parentContext.parent.dateFormatter.getDay(o.day)}
            </div>
            <slot name="${o=>o.month}-${o=>o.day}-${o=>o.year}"></slot>
        </${t}>
    `},WP=(r,e)=>{let t=r.tagFor(Jt);return R`
        <${t}
            class="week"
            part="week"
            role="row"
            role-type="default"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
        ${ba(o=>o,KP(r,e),{positioning:!0})}
        </${t}>
    `},QP=(r,e)=>{let t=r.tagFor(dr),o=r.tagFor(Jt);return R`
    <${t} class="days interact" part="days" generate-header="none">
        <${o}
            class="week-days"
            part="week-days"
            role="row"
            row-type="header"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
            ${ba(i=>i.getWeekdayText(),jP(r),{positioning:!0})}
        </${o}>
        ${ba(i=>i.getDays(),WP(r,e))}
    </${t}>
`},YP=r=>R`
        <div class="days" part="days">
            <div class="week-days" part="week-days">
                ${ba(e=>e.getWeekdayText(),R`
                        <div class="week-day" part="week-day" abbr="${e=>e.abbr}">
                            ${e=>e.text}
                        </div>
                    `)}
            </div>
            ${ba(e=>e.getDays(),R`
                    <div class="week">
                        ${ba(e=>e,R`
                                <div
                                    class="${(e,t)=>t.parentContext.parent.getDayClassNames(e,r)}"
                                    part="day"
                                    aria-label="${(e,t)=>t.parentContext.parent.dateFormatter.getDate(`${e.month}-${e.day}-${e.year}`,{month:"long",day:"numeric"})}"
                                >
                                    <div
                                        class="date"
                                        part="${e=>r===`${e.month}-${e.day}-${e.year}`?"today":"date"}"
                                    >
                                        ${(e,t)=>t.parentContext.parent.dateFormatter.getDay(e.day)}
                                    </div>
                                    <slot
                                        name="${e=>e.month}-${e=>e.day}-${e=>e.year}"
                                    ></slot>
                                </div>
                            `)}
                    </div>
                `)}
        </div>
    `,wE=(r,e)=>{var t;let o=new Date,i=`${o.getMonth()+1}-${o.getDate()}-${o.getFullYear()}`;return R`
        <template>
            ${zS}
            ${e.title instanceof Function?e.title(r,e):(t=e.title)!==null&&t!==void 0?t:""}
            <slot></slot>
            ${Qe(n=>n.readonly,YP(i),QP(r,i))}
            ${VS}
        </template>
    `}});var SE=y(()=>{a();l();c();hE();xE();t0()});var _E,EE=y(()=>{a();l();c();I();_E=(r,e)=>R`
    <slot></slot>
`});var bd,TE=y(()=>{a();l();c();De();bd=class extends B{}});var kE=y(()=>{a();l();c();EE();TE()});var IE,AE=y(()=>{a();l();c();I();IE=(r,e)=>R`
    <template
        role="checkbox"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.readOnly?"readonly":""} ${t=>t.checked?"checked":""} ${t=>t.indeterminate?"indeterminate":""}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${e.checkedIndicator||""}
            </slot>
            <slot name="indeterminate-indicator">
                ${e.indeterminateIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Oe("defaultSlottedNodes")}></slot>
        </label>
    </template>
`});var n0,pp,RE=y(()=>{a();l();c();wo();De();n0=class extends B{},pp=class extends Al(n0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Ea,PE=y(()=>{a();l();c();Ie();I();pe();RE();Ea=class extends pp{constructor(){super(),this.initialValue="on",this.indeterminate=!1,this.keypressHandler=e=>{if(!this.readOnly)switch(e.key){case Co:this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked;break}},this.clickHandler=e=>{!this.disabled&&!this.readOnly&&(this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}};b([w({attribute:"readonly",mode:"boolean"})],Ea.prototype,"readOnly",void 0);b([k],Ea.prototype,"defaultSlottedNodes",void 0);b([k],Ea.prototype,"indeterminate",void 0)});var OE=y(()=>{a();l();c();AE();PE()});function s0(r){return qi(r)&&(r.getAttribute("role")==="option"||r instanceof HTMLOptionElement)}var So,ms,a0=y(()=>{a();l();c();Ie();I();pe();De();md();St();Tr();So=class extends B{constructor(e,t,o,i){super(),this.defaultSelected=!1,this.dirtySelected=!1,this.selected=this.defaultSelected,this.dirtyValue=!1,e&&(this.textContent=e),t&&(this.initialValue=t),o&&(this.defaultSelected=o),i&&(this.selected=i),this.proxy=new Option(`${this.textContent}`,this.initialValue,this.defaultSelected,this.selected),this.proxy.disabled=this.disabled}checkedChanged(e,t){if(typeof t=="boolean"){this.ariaChecked=t?"true":"false";return}this.ariaChecked=null}contentChanged(e,t){this.proxy instanceof HTMLOptionElement&&(this.proxy.textContent=this.textContent),this.$emit("contentchange",null,{bubbles:!0})}defaultSelectedChanged(){this.dirtySelected||(this.selected=this.defaultSelected,this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.defaultSelected))}disabledChanged(e,t){this.ariaDisabled=this.disabled?"true":"false",this.proxy instanceof HTMLOptionElement&&(this.proxy.disabled=this.disabled)}selectedAttributeChanged(){this.defaultSelected=this.selectedAttribute,this.proxy instanceof HTMLOptionElement&&(this.proxy.defaultSelected=this.defaultSelected)}selectedChanged(){this.ariaSelected=this.selected?"true":"false",this.dirtySelected||(this.dirtySelected=!0),this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.selected)}initialValueChanged(e,t){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}get label(){var e;return(e=this.value)!==null&&e!==void 0?e:this.text}get text(){var e,t;return(t=(e=this.textContent)===null||e===void 0?void 0:e.replace(/\s+/g," ").trim())!==null&&t!==void 0?t:""}set value(e){let t=`${e??""}`;this._value=t,this.dirtyValue=!0,this.proxy instanceof HTMLOptionElement&&(this.proxy.value=t),ce.notify(this,"value")}get value(){var e;return ce.track(this,"value"),(e=this._value)!==null&&e!==void 0?e:this.text}get form(){return this.proxy?this.proxy.form:null}};b([k],So.prototype,"checked",void 0);b([k],So.prototype,"content",void 0);b([k],So.prototype,"defaultSelected",void 0);b([w({mode:"boolean"})],So.prototype,"disabled",void 0);b([w({attribute:"selected",mode:"boolean"})],So.prototype,"selectedAttribute",void 0);b([k],So.prototype,"selected",void 0);b([w({attribute:"value",mode:"fromView"})],So.prototype,"initialValue",void 0);ms=class{};b([k],ms.prototype,"ariaChecked",void 0);b([k],ms.prototype,"ariaPosInSet",void 0);b([k],ms.prototype,"ariaSelected",void 0);b([k],ms.prototype,"ariaSetSize",void 0);je(ms,st);je(So,mt,ms)});var Xt,Zo,gs=y(()=>{a();l();c();Ie();I();pe();De();a0();md();Tr();Xt=class r extends B{constructor(){super(...arguments),this._options=[],this.selectedIndex=-1,this.selectedOptions=[],this.shouldSkipFocus=!1,this.typeaheadBuffer="",this.typeaheadExpired=!0,this.typeaheadTimeout=-1}get firstSelectedOption(){var e;return(e=this.selectedOptions[0])!==null&&e!==void 0?e:null}get hasSelectableOptions(){return this.options.length>0&&!this.options.every(e=>e.disabled)}get length(){var e,t;return(t=(e=this.options)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0}get options(){return ce.track(this,"options"),this._options}set options(e){this._options=e,ce.notify(this,"options")}get typeAheadExpired(){return this.typeaheadExpired}set typeAheadExpired(e){this.typeaheadExpired=e}clickHandler(e){let t=e.target.closest("option,[role=option]");if(t&&!t.disabled)return this.selectedIndex=this.options.indexOf(t),!0}focusAndScrollOptionIntoView(e=this.firstSelectedOption){this.contains(document.activeElement)&&e!==null&&(e.focus(),requestAnimationFrame(()=>{e.scrollIntoView({block:"nearest"})}))}focusinHandler(e){!this.shouldSkipFocus&&e.target===e.currentTarget&&(this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}getTypeaheadMatches(){let e=this.typeaheadBuffer.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),t=new RegExp(`^${e}`,"gi");return this.options.filter(o=>o.text.trim().match(t))}getSelectableIndex(e=this.selectedIndex,t){let o=e>t?-1:e<t?1:0,i=e+o,n=null;switch(o){case-1:{n=this.options.reduceRight((s,d,u)=>!s&&!d.disabled&&u<i?d:s,n);break}case 1:{n=this.options.reduce((s,d,u)=>!s&&!d.disabled&&u>i?d:s,n);break}}return this.options.indexOf(n)}handleChange(e,t){switch(t){case"selected":{r.slottedOptionFilter(e)&&(this.selectedIndex=this.options.indexOf(e)),this.setSelectedOptions();break}}}handleTypeAhead(e){this.typeaheadTimeout&&window.clearTimeout(this.typeaheadTimeout),this.typeaheadTimeout=window.setTimeout(()=>this.typeaheadExpired=!0,r.TYPE_AHEAD_TIMEOUT_MS),!(e.length>1)&&(this.typeaheadBuffer=`${this.typeaheadExpired?"":this.typeaheadBuffer}${e}`)}keydownHandler(e){if(this.disabled)return!0;this.shouldSkipFocus=!1;let t=e.key;switch(t){case lr:{e.shiftKey||(e.preventDefault(),this.selectFirstOption());break}case Mt:{e.shiftKey||(e.preventDefault(),this.selectNextOption());break}case Ft:{e.shiftKey||(e.preventDefault(),this.selectPreviousOption());break}case cr:{e.preventDefault(),this.selectLastOption();break}case ds:return this.focusAndScrollOptionIntoView(),!0;case Zt:case bo:return!0;case Co:if(this.typeaheadExpired)return!0;default:return t.length===1&&this.handleTypeAhead(`${t}`),!0}}mousedownHandler(e){return this.shouldSkipFocus=!this.contains(document.activeElement),!0}multipleChanged(e,t){this.ariaMultiSelectable=t?"true":null}selectedIndexChanged(e,t){var o;if(!this.hasSelectableOptions){this.selectedIndex=-1;return}if(!((o=this.options[this.selectedIndex])===null||o===void 0)&&o.disabled&&typeof e=="number"){let i=this.getSelectableIndex(e,t),n=i>-1?i:e;this.selectedIndex=n,t===n&&this.selectedIndexChanged(t,n);return}this.setSelectedOptions()}selectedOptionsChanged(e,t){var o;let i=t.filter(r.slottedOptionFilter);(o=this.options)===null||o===void 0||o.forEach(n=>{let s=ce.getNotifier(n);s.unsubscribe(this,"selected"),n.selected=i.includes(n),s.subscribe(this,"selected")})}selectFirstOption(){var e,t;this.disabled||(this.selectedIndex=(t=(e=this.options)===null||e===void 0?void 0:e.findIndex(o=>!o.disabled))!==null&&t!==void 0?t:-1)}selectLastOption(){this.disabled||(this.selectedIndex=c_(this.options,e=>!e.disabled))}selectNextOption(){!this.disabled&&this.selectedIndex<this.options.length-1&&(this.selectedIndex+=1)}selectPreviousOption(){!this.disabled&&this.selectedIndex>0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){var e,t;this.selectedIndex=(t=(e=this.options)===null||e===void 0?void 0:e.findIndex(o=>o.defaultSelected))!==null&&t!==void 0?t:-1}setSelectedOptions(){var e,t,o;!((e=this.options)===null||e===void 0)&&e.length&&(this.selectedOptions=[this.options[this.selectedIndex]],this.ariaActiveDescendant=(o=(t=this.firstSelectedOption)===null||t===void 0?void 0:t.id)!==null&&o!==void 0?o:"",this.focusAndScrollOptionIntoView())}slottedOptionsChanged(e,t){this.options=t.reduce((i,n)=>(s0(n)&&i.push(n),i),[]);let o=`${this.options.length}`;this.options.forEach((i,n)=>{i.id||(i.id=Do("option-")),i.ariaPosInSet=`${n+1}`,i.ariaSetSize=o}),this.$fastController.isConnected&&(this.setSelectedOptions(),this.setDefaultSelectedOption())}typeaheadBufferChanged(e,t){if(this.$fastController.isConnected){let o=this.getTypeaheadMatches();if(o.length){let i=this.options.indexOf(o[0]);i>-1&&(this.selectedIndex=i)}this.typeaheadExpired=!1}}};Xt.slottedOptionFilter=r=>s0(r)&&!r.hidden;Xt.TYPE_AHEAD_TIMEOUT_MS=1e3;b([w({mode:"boolean"})],Xt.prototype,"disabled",void 0);b([k],Xt.prototype,"selectedIndex",void 0);b([k],Xt.prototype,"selectedOptions",void 0);b([k],Xt.prototype,"slottedOptions",void 0);b([k],Xt.prototype,"typeaheadBuffer",void 0);Zo=class{};b([k],Zo.prototype,"ariaActiveDescendant",void 0);b([k],Zo.prototype,"ariaDisabled",void 0);b([k],Zo.prototype,"ariaExpanded",void 0);b([k],Zo.prototype,"ariaMultiSelectable",void 0);je(Zo,st);je(Xt,Zo)});var vs,fp=y(()=>{a();l();c();vs={above:"above",below:"below"}});var l0,mp,$E=y(()=>{a();l();c();wo();gs();l0=class extends Xt{},mp=class extends fr(l0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Cd,c0=y(()=>{a();l();c();Cd={inline:"inline",list:"list",both:"both",none:"none"}});var Jo,Pl,ME=y(()=>{a();l();c();Ie();I();pe();gs();St();fp();Tr();$E();c0();Jo=class extends mp{constructor(){super(...arguments),this._value="",this.filteredOptions=[],this.filter="",this.forcedPosition=!1,this.listboxId=Do("listbox-"),this.maxHeight=0,this.open=!1}formResetCallback(){super.formResetCallback(),this.setDefaultSelectedOption(),this.updateValue()}validate(){super.validate(this.control)}get isAutocompleteInline(){return this.autocomplete===Cd.inline||this.isAutocompleteBoth}get isAutocompleteList(){return this.autocomplete===Cd.list||this.isAutocompleteBoth}get isAutocompleteBoth(){return this.autocomplete===Cd.both}openChanged(){if(this.open){this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),W.queueUpdate(()=>this.focus());return}this.ariaControls="",this.ariaExpanded="false"}get options(){return ce.track(this,"options"),this.filteredOptions.length?this.filteredOptions:this._options}set options(e){this._options=e,ce.notify(this,"options")}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}positionChanged(e,t){this.positionAttribute=t,this.setPositioning()}get value(){return ce.track(this,"value"),this._value}set value(e){var t,o,i;let n=`${this._value}`;if(this.$fastController.isConnected&&this.options){let s=this.options.findIndex(h=>h.text.toLowerCase()===e.toLowerCase()),d=(t=this.options[this.selectedIndex])===null||t===void 0?void 0:t.text,u=(o=this.options[s])===null||o===void 0?void 0:o.text;this.selectedIndex=d!==u?s:this.selectedIndex,e=((i=this.firstSelectedOption)===null||i===void 0?void 0:i.text)||e}n!==e&&(this._value=e,super.valueChanged(n,e),ce.notify(this,"value"))}clickHandler(e){if(!this.disabled){if(this.open){let t=e.target.closest("option,[role=option]");if(!t||t.disabled)return;this.selectedOptions=[t],this.control.value=t.text,this.clearSelectionRange(),this.updateValue(!0)}return this.open=!this.open,this.open&&this.control.focus(),!0}}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.value&&(this.initialValue=this.value)}disabledChanged(e,t){super.disabledChanged&&super.disabledChanged(e,t),this.ariaDisabled=this.disabled?"true":"false"}filterOptions(){(!this.autocomplete||this.autocomplete===Cd.none)&&(this.filter="");let e=this.filter.toLowerCase();this.filteredOptions=this._options.filter(t=>t.text.toLowerCase().startsWith(this.filter.toLowerCase())),this.isAutocompleteList&&(!this.filteredOptions.length&&!e&&(this.filteredOptions=this._options),this._options.forEach(t=>{t.hidden=!this.filteredOptions.includes(t)}))}focusAndScrollOptionIntoView(){this.contains(document.activeElement)&&(this.control.focus(),this.firstSelectedOption&&requestAnimationFrame(()=>{var e;(e=this.firstSelectedOption)===null||e===void 0||e.scrollIntoView({block:"nearest"})}))}focusoutHandler(e){if(this.syncValue(),!this.open)return!0;let t=e.relatedTarget;if(this.isSameNode(t)){this.focus();return}(!this.options||!this.options.includes(t))&&(this.open=!1)}inputHandler(e){if(this.filter=this.control.value,this.filterOptions(),this.isAutocompleteInline||(this.selectedIndex=this.options.map(t=>t.text).indexOf(this.control.value)),e.inputType.includes("deleteContent")||!this.filter.length)return!0;this.isAutocompleteList&&!this.open&&(this.open=!0),this.isAutocompleteInline&&(this.filteredOptions.length?(this.selectedOptions=[this.filteredOptions[0]],this.selectedIndex=this.options.indexOf(this.firstSelectedOption),this.setInlineSelection()):this.selectedIndex=-1)}keydownHandler(e){let t=e.key;if(e.ctrlKey||e.shiftKey)return!0;switch(t){case"Enter":{this.syncValue(),this.isAutocompleteInline&&(this.filter=this.value),this.open=!1,this.clearSelectionRange();break}case"Escape":{if(this.isAutocompleteInline||(this.selectedIndex=-1),this.open){this.open=!1;break}this.value="",this.control.value="",this.filter="",this.filterOptions();break}case"Tab":{if(this.setInputToSelection(),!this.open)return!0;e.preventDefault(),this.open=!1;break}case"ArrowUp":case"ArrowDown":{if(this.filterOptions(),!this.open){this.open=!0;break}this.filteredOptions.length>0&&super.keydownHandler(e),this.isAutocompleteInline&&this.setInlineSelection();break}default:return!0}}keyupHandler(e){switch(e.key){case"ArrowLeft":case"ArrowRight":case"Backspace":case"Delete":case"Home":case"End":{this.filter=this.control.value,this.selectedIndex=-1,this.filterOptions();break}}}selectedIndexChanged(e,t){if(this.$fastController.isConnected){if(t=hs(-1,this.options.length-1,t),t!==this.selectedIndex){this.selectedIndex=t;return}super.selectedIndexChanged(e,t)}}selectPreviousOption(){!this.disabled&&this.selectedIndex>=0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){if(this.$fastController.isConnected&&this.options){let e=this.options.findIndex(t=>t.getAttribute("selected")!==null||t.selected);this.selectedIndex=e,!this.dirtyValue&&this.firstSelectedOption&&(this.value=this.firstSelectedOption.text),this.setSelectedOptions()}}setInputToSelection(){this.firstSelectedOption&&(this.control.value=this.firstSelectedOption.text,this.control.focus())}setInlineSelection(){this.firstSelectedOption&&(this.setInputToSelection(),this.control.setSelectionRange(this.filter.length,this.control.value.length,"backward"))}syncValue(){var e;let t=this.selectedIndex>-1?(e=this.firstSelectedOption)===null||e===void 0?void 0:e.text:this.control.value;this.updateValue(this.value!==t)}setPositioning(){let e=this.getBoundingClientRect(),o=window.innerHeight-e.bottom;this.position=this.forcedPosition?this.positionAttribute:e.top>o?vs.above:vs.below,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===vs.above?~~e.top:~~o}selectedOptionsChanged(e,t){this.$fastController.isConnected&&this._options.forEach(o=>{o.selected=t.includes(o)})}slottedOptionsChanged(e,t){super.slottedOptionsChanged(e,t),this.updateValue()}updateValue(e){var t;this.$fastController.isConnected&&(this.value=((t=this.firstSelectedOption)===null||t===void 0?void 0:t.text)||this.control.value,this.control.value=this.value),e&&this.$emit("change")}clearSelectionRange(){let e=this.control.value.length;this.control.setSelectionRange(e,e)}};b([w({attribute:"autocomplete",mode:"fromView"})],Jo.prototype,"autocomplete",void 0);b([k],Jo.prototype,"maxHeight",void 0);b([w({attribute:"open",mode:"boolean"})],Jo.prototype,"open",void 0);b([w],Jo.prototype,"placeholder",void 0);b([w({attribute:"position"})],Jo.prototype,"positionAttribute",void 0);b([k],Jo.prototype,"position",void 0);Pl=class{};b([k],Pl.prototype,"ariaAutoComplete",void 0);b([k],Pl.prototype,"ariaControls",void 0);je(Pl,Zo);je(Jo,mt,Pl)});var FE,DE=y(()=>{a();l();c();I();gs();St();FE=(r,e)=>R`
    <template
        aria-disabled="${t=>t.ariaDisabled}"
        autocomplete="${t=>t.autocomplete}"
        class="${t=>t.open?"open":""} ${t=>t.disabled?"disabled":""} ${t=>t.position}"
        ?open="${t=>t.open}"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
    >
        <div class="control" part="control">
            ${pt(r,e)}
            <slot name="control">
                <input
                    aria-activedescendant="${t=>t.open?t.ariaActiveDescendant:null}"
                    aria-autocomplete="${t=>t.ariaAutoComplete}"
                    aria-controls="${t=>t.ariaControls}"
                    aria-disabled="${t=>t.ariaDisabled}"
                    aria-expanded="${t=>t.ariaExpanded}"
                    aria-haspopup="listbox"
                    class="selected-value"
                    part="selected-value"
                    placeholder="${t=>t.placeholder}"
                    role="combobox"
                    type="text"
                    ?disabled="${t=>t.disabled}"
                    :value="${t=>t.value}"
                    @input="${(t,o)=>t.inputHandler(o.event)}"
                    @keyup="${(t,o)=>t.keyupHandler(o.event)}"
                    ${we("control")}
                />
                <div class="indicator" part="indicator" aria-hidden="true">
                    <slot name="indicator">
                        ${e.indicator||""}
                    </slot>
                </div>
            </slot>
            ${ht(r,e)}
        </div>
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>!t.open}"
            ${we("listbox")}
        >
            <slot
                ${Oe({filter:Xt.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`});var LE=y(()=>{a();l();c();ME();c0();DE()});function Ta(r){let e=r.parentElement;if(e)return e;{let t=r.getRootNode();if(t.host instanceof HTMLElement)return t.host}return null}var gp=y(()=>{a();l();c()});function d0(r,e){let t=e;for(;t!==null;){if(t===r)return!0;t=Ta(t)}return!1}var u0=y(()=>{a();l();c();gp()});function ZP(r){return r instanceof as}var Gi,wd,p0,f0,m0,vp,g0,ys,h0,JP,ka,v0=y(()=>{a();l();c();Ie();I();Gi=document.createElement("div");wd=class{setProperty(e,t){W.queueUpdate(()=>this.target.setProperty(e,t))}removeProperty(e){W.queueUpdate(()=>this.target.removeProperty(e))}},p0=class extends wd{constructor(e){super();let t=new CSSStyleSheet;this.target=t.cssRules[t.insertRule(":host{}")].style,e.$fastController.addStyles(Yt.create([t]))}},f0=class extends wd{constructor(){super();let e=new CSSStyleSheet;this.target=e.cssRules[e.insertRule(":root{}")].style,document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}},m0=class extends wd{constructor(){super(),this.style=document.createElement("style"),document.head.appendChild(this.style);let{sheet:e}=this.style;if(e){let t=e.insertRule(":root{}",e.cssRules.length);this.target=e.cssRules[t].style}}},vp=class{constructor(e){this.store=new Map,this.target=null;let t=e.$fastController;this.style=document.createElement("style"),t.addStyles(this.style),ce.getNotifier(t).subscribe(this,"isConnected"),this.handleChange(t,"isConnected")}targetChanged(){if(this.target!==null)for(let[e,t]of this.store.entries())this.target.setProperty(e,t)}setProperty(e,t){this.store.set(e,t),W.queueUpdate(()=>{this.target!==null&&this.target.setProperty(e,t)})}removeProperty(e){this.store.delete(e),W.queueUpdate(()=>{this.target!==null&&this.target.removeProperty(e)})}handleChange(e,t){let{sheet:o}=this.style;if(o){let i=o.insertRule(":host{}",o.cssRules.length);this.target=o.cssRules[i].style}else this.target=null}};b([k],vp.prototype,"target",void 0);g0=class{constructor(e){this.target=e.style}setProperty(e,t){W.queueUpdate(()=>this.target.setProperty(e,t))}removeProperty(e){W.queueUpdate(()=>this.target.removeProperty(e))}},ys=class r{setProperty(e,t){r.properties[e]=t;for(let o of r.roots.values())ka.getOrCreate(r.normalizeRoot(o)).setProperty(e,t)}removeProperty(e){delete r.properties[e];for(let t of r.roots.values())ka.getOrCreate(r.normalizeRoot(t)).removeProperty(e)}static registerRoot(e){let{roots:t}=r;if(!t.has(e)){t.add(e);let o=ka.getOrCreate(this.normalizeRoot(e));for(let i in r.properties)o.setProperty(i,r.properties[i])}}static unregisterRoot(e){let{roots:t}=r;if(t.has(e)){t.delete(e);let o=ka.getOrCreate(r.normalizeRoot(e));for(let i in r.properties)o.removeProperty(i)}}static normalizeRoot(e){return e===Gi?document:e}};ys.roots=new Set;ys.properties={};h0=new WeakMap,JP=W.supportsAdoptedStyleSheets?p0:vp,ka=Object.freeze({getOrCreate(r){if(h0.has(r))return h0.get(r);let e;return r===Gi?e=new ys:r instanceof Document?e=W.supportsAdoptedStyleSheets?new f0:new m0:ZP(r)?e=new JP(r):e=new g0(r),h0.set(r,e),e}})});function XP(r){return _i.from(r)}var _i,y0,b0,C0,xd,Sd,lo,tt,w0=y(()=>{a();l();c();Ie();I();gp();u0();v0();v0();_i=class r extends ls{constructor(e){super(),this.subscribers=new WeakMap,this._appliedTo=new Set,this.name=e.name,e.cssCustomPropertyName!==null&&(this.cssCustomProperty=`--${e.cssCustomPropertyName}`,this.cssVar=`var(${this.cssCustomProperty})`),this.id=r.uniqueId(),r.tokensById.set(this.id,this)}get appliedTo(){return[...this._appliedTo]}static from(e){return new r({name:typeof e=="string"?e:e.name,cssCustomPropertyName:typeof e=="string"?e:e.cssCustomPropertyName===void 0?e.name:e.cssCustomPropertyName})}static isCSSDesignToken(e){return typeof e.cssCustomProperty=="string"}static isDerivedDesignTokenValue(e){return typeof e=="function"}static getTokenById(e){return r.tokensById.get(e)}getOrCreateSubscriberSet(e=this){return this.subscribers.get(e)||this.subscribers.set(e,new Set)&&this.subscribers.get(e)}createCSS(){return this.cssVar||""}getValueFor(e){let t=lo.getOrCreate(e).get(this);if(t!==void 0)return t;throw new Error(`Value could not be retrieved for token named "${this.name}". Ensure the value is set for ${e} or an ancestor of ${e}.`)}setValueFor(e,t){return this._appliedTo.add(e),t instanceof r&&(t=this.alias(t)),lo.getOrCreate(e).set(this,t),this}deleteValueFor(e){return this._appliedTo.delete(e),lo.existsFor(e)&&lo.getOrCreate(e).delete(this),this}withDefault(e){return this.setValueFor(Gi,e),this}subscribe(e,t){let o=this.getOrCreateSubscriberSet(t);t&&!lo.existsFor(t)&&lo.getOrCreate(t),o.has(e)||o.add(e)}unsubscribe(e,t){let o=this.subscribers.get(t||this);o&&o.has(e)&&o.delete(e)}notify(e){let t=Object.freeze({token:this,target:e});this.subscribers.has(this)&&this.subscribers.get(this).forEach(o=>o.handleChange(t)),this.subscribers.has(e)&&this.subscribers.get(e).forEach(o=>o.handleChange(t))}alias(e){return t=>e.getValueFor(t)}};_i.uniqueId=(()=>{let r=0;return()=>(r++,r.toString(16))})();_i.tokensById=new Map;y0=class{startReflection(e,t){e.subscribe(this,t),this.handleChange({token:e,target:t})}stopReflection(e,t){e.unsubscribe(this,t),this.remove(e,t)}handleChange(e){let{token:t,target:o}=e;this.add(t,o)}add(e,t){ka.getOrCreate(t).setProperty(e.cssCustomProperty,this.resolveCSSValue(lo.getOrCreate(t).get(e)))}remove(e,t){ka.getOrCreate(t).removeProperty(e.cssCustomProperty)}resolveCSSValue(e){return e&&typeof e.createCSS=="function"?e.createCSS():e}},b0=class{constructor(e,t,o){this.source=e,this.token=t,this.node=o,this.dependencies=new Set,this.observer=ce.binding(e,this,!1),this.observer.handleChange=this.observer.call,this.handleChange()}disconnect(){this.observer.disconnect()}handleChange(){this.node.store.set(this.token,this.observer.observe(this.node.target,is))}},C0=class{constructor(){this.values=new Map}set(e,t){this.values.get(e)!==t&&(this.values.set(e,t),ce.getNotifier(this).notify(e.id))}get(e){return ce.track(this,e.id),this.values.get(e)}delete(e){this.values.delete(e)}all(){return this.values.entries()}},xd=new WeakMap,Sd=new WeakMap,lo=class r{constructor(e){this.target=e,this.store=new C0,this.children=[],this.assignedValues=new Map,this.reflecting=new Set,this.bindingObservers=new Map,this.tokenValueChangeHandler={handleChange:(t,o)=>{let i=_i.getTokenById(o);if(i&&(i.notify(this.target),_i.isCSSDesignToken(i))){let n=this.parent,s=this.isReflecting(i);if(n){let d=n.get(i),u=t.get(i);d!==u&&!s?this.reflectToCSS(i):d===u&&s&&this.stopReflectToCSS(i)}else s||this.reflectToCSS(i)}}},xd.set(e,this),ce.getNotifier(this.store).subscribe(this.tokenValueChangeHandler),e instanceof as?e.$fastController.addBehaviors([this]):e.isConnected&&this.bind()}static getOrCreate(e){return xd.get(e)||new r(e)}static existsFor(e){return xd.has(e)}static findParent(e){if(Gi!==e.target){let t=Ta(e.target);for(;t!==null;){if(xd.has(t))return xd.get(t);t=Ta(t)}return r.getOrCreate(Gi)}return null}static findClosestAssignedNode(e,t){let o=t;do{if(o.has(e))return o;o=o.parent?o.parent:o.target!==Gi?r.getOrCreate(Gi):null}while(o!==null);return null}get parent(){return Sd.get(this)||null}has(e){return this.assignedValues.has(e)}get(e){let t=this.store.get(e);if(t!==void 0)return t;let o=this.getRaw(e);if(o!==void 0)return this.hydrate(e,o),this.get(e)}getRaw(e){var t;return this.assignedValues.has(e)?this.assignedValues.get(e):(t=r.findClosestAssignedNode(e,this))===null||t===void 0?void 0:t.getRaw(e)}set(e,t){_i.isDerivedDesignTokenValue(this.assignedValues.get(e))&&this.tearDownBindingObserver(e),this.assignedValues.set(e,t),_i.isDerivedDesignTokenValue(t)?this.setupBindingObserver(e,t):this.store.set(e,t)}delete(e){this.assignedValues.delete(e),this.tearDownBindingObserver(e);let t=this.getRaw(e);t?this.hydrate(e,t):this.store.delete(e)}bind(){let e=r.findParent(this);e&&e.appendChild(this);for(let t of this.assignedValues.keys())t.notify(this.target)}unbind(){this.parent&&Sd.get(this).removeChild(this)}appendChild(e){e.parent&&Sd.get(e).removeChild(e);let t=this.children.filter(o=>e.contains(o));Sd.set(e,this),this.children.push(e),t.forEach(o=>e.appendChild(o)),ce.getNotifier(this.store).subscribe(e);for(let[o,i]of this.store.all())e.hydrate(o,this.bindingObservers.has(o)?this.getRaw(o):i)}removeChild(e){let t=this.children.indexOf(e);return t!==-1&&this.children.splice(t,1),ce.getNotifier(this.store).unsubscribe(e),e.parent===this?Sd.delete(e):!1}contains(e){return d0(this.target,e.target)}reflectToCSS(e){this.isReflecting(e)||(this.reflecting.add(e),r.cssCustomPropertyReflector.startReflection(e,this.target))}stopReflectToCSS(e){this.isReflecting(e)&&(this.reflecting.delete(e),r.cssCustomPropertyReflector.stopReflection(e,this.target))}isReflecting(e){return this.reflecting.has(e)}handleChange(e,t){let o=_i.getTokenById(t);o&&this.hydrate(o,this.getRaw(o))}hydrate(e,t){if(!this.has(e)){let o=this.bindingObservers.get(e);_i.isDerivedDesignTokenValue(t)?o?o.source!==t&&(this.tearDownBindingObserver(e),this.setupBindingObserver(e,t)):this.setupBindingObserver(e,t):(o&&this.tearDownBindingObserver(e),this.store.set(e,t))}}setupBindingObserver(e,t){let o=new b0(t,e,this);return this.bindingObservers.set(e,o),o}tearDownBindingObserver(e){return this.bindingObservers.has(e)?(this.bindingObservers.get(e).disconnect(),this.bindingObservers.delete(e),!0):!1}};lo.cssCustomPropertyReflector=new y0;b([k],lo.prototype,"children",void 0);tt=Object.freeze({create:XP,notifyConnection(r){return!r.isConnected||!lo.existsFor(r)?!1:(lo.getOrCreate(r).bind(),!0)},notifyDisconnection(r){return r.isConnected||!lo.existsFor(r)?!1:(lo.getOrCreate(r).unbind(),!0)},registerRoot(r=Gi){ys.registerRoot(r)},unregisterRoot(r=Gi){ys.unregisterRoot(r)}})});function e6(r,e,t){return typeof r=="string"?{name:r,type:e,callback:t}:r}var x0,S0,yp,Ol,_d,E0,bp,_0,NE=y(()=>{a();l();c();I();De();rp();w0();sp();x0=Object.freeze({definitionCallbackOnly:null,ignoreDuplicate:Symbol()}),S0=new Map,yp=new Map,Ol=null,_d=Ct.createInterface(r=>r.cachedCallback(e=>(Ol===null&&(Ol=new bp(null,e)),Ol))),E0=Object.freeze({tagFor(r){return yp.get(r)},responsibleFor(r){let e=r.$$designSystem$$;return e||Ct.findResponsibleContainer(r).get(_d)},getOrCreate(r){if(!r)return Ol===null&&(Ol=Ct.getOrCreateDOMContainer().get(_d)),Ol;let e=r.$$designSystem$$;if(e)return e;let t=Ct.getOrCreateDOMContainer(r);if(t.has(_d,!1))return t.get(_d);{let o=new bp(r,t);return t.register(Ca.instance(_d,o)),o}}});bp=class{constructor(e,t){this.owner=e,this.container=t,this.designTokensInitialized=!1,this.prefix="fast",this.shadowRootMode=void 0,this.disambiguate=()=>x0.definitionCallbackOnly,e!==null&&(e.$$designSystem$$=this)}withPrefix(e){return this.prefix=e,this}withShadowRootMode(e){return this.shadowRootMode=e,this}withElementDisambiguation(e){return this.disambiguate=e,this}withDesignTokenRoot(e){return this.designTokenRoot=e,this}register(...e){let t=this.container,o=[],i=this.disambiguate,n=this.shadowRootMode,s={elementPrefix:this.prefix,tryDefineElement(d,u,h){let p=e6(d,u,h),{name:v,callback:C,baseClass:x}=p,{type:E}=p,O=v,q=S0.get(O),_e=!0;for(;q;){let se=i(O,E,q);switch(se){case x0.ignoreDuplicate:return;case x0.definitionCallbackOnly:_e=!1,q=void 0;break;default:O=se,q=S0.get(O);break}}_e&&((yp.has(E)||E===B)&&(E=class extends E{}),S0.set(O,E),yp.set(E,O),x&&yp.set(x,O)),o.push(new _0(t,O,E,n,C,_e))}};this.designTokensInitialized||(this.designTokensInitialized=!0,this.designTokenRoot!==null&&tt.registerRoot(this.designTokenRoot)),t.registerWithContext(s,...e);for(let d of o)d.callback(d),d.willDefine&&d.definition!==null&&d.definition.define();return this}},_0=class{constructor(e,t,o,i,n,s){this.container=e,this.name=t,this.type=o,this.shadowRootMode=i,this.callback=n,this.willDefine=s,this.definition=null}definePresentation(e){np.define(this.name,e,this.container)}defineElement(e){this.definition=new Vi(this.type,Object.assign(Object.assign({},e),{name:this.name}))}tagFor(e){return E0.tagFor(e)}}});var HE=y(()=>{a();l();c()});var UE=y(()=>{a();l();c();NE();sp();HE()});var BE=y(()=>{a();l();c()});var VE=y(()=>{a();l();c();rp()});var zE,qE=y(()=>{a();l();c();I();zE=(r,e)=>R`
    <div class="positioning-region" part="positioning-region">
        ${Qe(t=>t.modal,R`
                <div
                    class="overlay"
                    part="overlay"
                    role="presentation"
                    @click="${t=>t.dismiss()}"
                ></div>
            `)}
        <div
            role="dialog"
            tabindex="-1"
            class="control"
            part="control"
            aria-modal="${t=>t.modal}"
            aria-describedby="${t=>t.ariaDescribedby}"
            aria-labelledby="${t=>t.ariaLabelledby}"
            aria-label="${t=>t.ariaLabel}"
            ${we("dialog")}
        >
            <slot></slot>
        </div>
    </div>
`});var jE,t6,KE,Ed,T0,r6,WE,o6,i6,n6,s6,a6,l6,GE,c6,d6,QE,u6,k0,h6,I0,A0=y(()=>{a();l();c();jE=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],t6=jE.join(","),KE=typeof Element>"u",Ed=KE?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,T0=!KE&&Element.prototype.getRootNode?function(r){return r.getRootNode()}:function(r){return r.ownerDocument},r6=function(e,t){return e.tabIndex<0&&(t||/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||e.isContentEditable)&&isNaN(parseInt(e.getAttribute("tabindex"),10))?0:e.tabIndex},WE=function(e){return e.tagName==="INPUT"},o6=function(e){return WE(e)&&e.type==="hidden"},i6=function(e){var t=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(o){return o.tagName==="SUMMARY"});return t},n6=function(e,t){for(var o=0;o<e.length;o++)if(e[o].checked&&e[o].form===t)return e[o]},s6=function(e){if(!e.name)return!0;var t=e.form||T0(e),o=function(d){return t.querySelectorAll('input[type="radio"][name="'+d+'"]')},i;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")i=o(window.CSS.escape(e.name));else try{i=o(e.name)}catch(s){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",s.message),!1}var n=n6(i,e.form);return!n||n===e},a6=function(e){return WE(e)&&e.type==="radio"},l6=function(e){return a6(e)&&!s6(e)},GE=function(e){var t=e.getBoundingClientRect(),o=t.width,i=t.height;return o===0&&i===0},c6=function(e,t){var o=t.displayCheck,i=t.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var n=Ed.call(e,"details>summary:first-of-type"),s=n?e.parentElement:e;if(Ed.call(s,"details:not([open]) *"))return!0;var d=T0(e).host,u=d?.ownerDocument.contains(d)||e.ownerDocument.contains(e);if(!o||o==="full"){if(typeof i=="function"){for(var h=e;e;){var p=e.parentElement,v=T0(e);if(p&&!p.shadowRoot&&i(p)===!0)return GE(e);e.assignedSlot?e=e.assignedSlot:!p&&v!==e.ownerDocument?e=v.host:e=p}e=h}if(u)return!e.getClientRects().length}else if(o==="non-zero-area")return GE(e);return!1},d6=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if(t.tagName==="FIELDSET"&&t.disabled){for(var o=0;o<t.children.length;o++){var i=t.children.item(o);if(i.tagName==="LEGEND")return Ed.call(t,"fieldset[disabled] *")?!0:!i.contains(e)}return!0}t=t.parentElement}return!1},QE=function(e,t){return!(t.disabled||o6(t)||c6(t,e)||i6(t)||d6(t))},u6=function(e,t){return!(l6(t)||r6(t)<0||!QE(e,t))},k0=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Ed.call(e,t6)===!1?!1:u6(t,e)},h6=jE.concat("iframe").join(","),I0=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Ed.call(e,h6)===!1?!1:QE(t,e)}});var ji,YE=y(()=>{a();l();c();Ie();I();pe();A0();De();ji=class r extends B{constructor(){super(...arguments),this.modal=!0,this.hidden=!1,this.trapFocus=!0,this.trapFocusChanged=()=>{this.$fastController.isConnected&&this.updateTrapFocus()},this.isTrappingFocus=!1,this.handleDocumentKeydown=e=>{if(!e.defaultPrevented&&!this.hidden)switch(e.key){case bo:this.dismiss(),e.preventDefault();break;case ds:this.handleTabKeyDown(e);break}},this.handleDocumentFocus=e=>{!e.defaultPrevented&&this.shouldForceFocus(e.target)&&(this.focusFirstElement(),e.preventDefault())},this.handleTabKeyDown=e=>{if(!this.trapFocus||this.hidden)return;let t=this.getTabQueueBounds();if(t.length!==0){if(t.length===1){t[0].focus(),e.preventDefault();return}e.shiftKey&&e.target===t[0]?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&e.target===t[t.length-1]&&(t[0].focus(),e.preventDefault())}},this.getTabQueueBounds=()=>{let e=[];return r.reduceTabbableItems(e,this)},this.focusFirstElement=()=>{let e=this.getTabQueueBounds();e.length>0?e[0].focus():this.dialog instanceof HTMLElement&&this.dialog.focus()},this.shouldForceFocus=e=>this.isTrappingFocus&&!this.contains(e),this.shouldTrapFocus=()=>this.trapFocus&&!this.hidden,this.updateTrapFocus=e=>{let t=e===void 0?this.shouldTrapFocus():e;t&&!this.isTrappingFocus?(this.isTrappingFocus=!0,document.addEventListener("focusin",this.handleDocumentFocus),W.queueUpdate(()=>{this.shouldForceFocus(document.activeElement)&&this.focusFirstElement()})):!t&&this.isTrappingFocus&&(this.isTrappingFocus=!1,document.removeEventListener("focusin",this.handleDocumentFocus))}}dismiss(){this.$emit("dismiss"),this.$emit("cancel")}show(){this.hidden=!1}hide(){this.hidden=!0,this.$emit("close")}connectedCallback(){super.connectedCallback(),document.addEventListener("keydown",this.handleDocumentKeydown),this.notifier=ce.getNotifier(this),this.notifier.subscribe(this,"hidden"),this.updateTrapFocus()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleDocumentKeydown),this.updateTrapFocus(!1),this.notifier.unsubscribe(this,"hidden")}handleChange(e,t){switch(t){case"hidden":this.updateTrapFocus();break;default:break}}static reduceTabbableItems(e,t){return t.getAttribute("tabindex")==="-1"?e:k0(t)||r.isFocusableFastElement(t)&&r.hasTabbableShadow(t)?(e.push(t),e):t.childElementCount?e.concat(Array.from(t.children).reduce(r.reduceTabbableItems,[])):e}static isFocusableFastElement(e){var t,o;return!!(!((o=(t=e.$fastController)===null||t===void 0?void 0:t.definition.shadowOptions)===null||o===void 0)&&o.delegatesFocus)}static hasTabbableShadow(e){var t,o;return Array.from((o=(t=e.shadowRoot)===null||t===void 0?void 0:t.querySelectorAll("*"))!==null&&o!==void 0?o:[]).some(i=>k0(i))}};b([w({mode:"boolean"})],ji.prototype,"modal",void 0);b([w({mode:"boolean"})],ji.prototype,"hidden",void 0);b([w({attribute:"trap-focus",mode:"boolean"})],ji.prototype,"trapFocus",void 0);b([w({attribute:"aria-describedby"})],ji.prototype,"ariaDescribedby",void 0);b([w({attribute:"aria-labelledby"})],ji.prototype,"ariaLabelledby",void 0);b([w({attribute:"aria-label"})],ji.prototype,"ariaLabel",void 0)});var ZE=y(()=>{a();l();c();qE();YE()});var p6,Cp,JE=y(()=>{a();l();c();I();p6=new MutationObserver(r=>{for(let e of r)Cp.getOrCreateFor(e.target).notify(e.attributeName)}),Cp=class r extends Ui{constructor(e){super(e),this.watchedAttributes=new Set,r.subscriberCache.set(e,this)}subscribe(e){super.subscribe(e),this.watchedAttributes.has(e.attributes)||(this.watchedAttributes.add(e.attributes),this.observe())}unsubscribe(e){super.unsubscribe(e),this.watchedAttributes.has(e.attributes)&&(this.watchedAttributes.delete(e.attributes),this.observe())}static getOrCreateFor(e){return this.subscriberCache.get(e)||new r(e)}observe(){let e=[];for(let t of this.watchedAttributes.values())for(let o=0;o<t.length;o++)e.push(t[o]);p6.observe(this.source,{attributeFilter:e})}};Cp.subscriberCache=new WeakMap});var XE=y(()=>{a();l();c();I()});var wp,eT=y(()=>{a();l();c();Ie();I();De();wp=class extends B{connectedCallback(){super.connectedCallback(),this.setup()}disconnectedCallback(){super.disconnectedCallback(),this.details.removeEventListener("toggle",this.onToggle)}show(){this.details.open=!0}hide(){this.details.open=!1}toggle(){this.details.open=!this.details.open}setup(){this.onToggle=this.onToggle.bind(this),this.details.addEventListener("toggle",this.onToggle),this.expanded&&this.show()}onToggle(){this.expanded=this.details.open,this.$emit("toggle")}};b([w({mode:"boolean"})],wp.prototype,"expanded",void 0);b([w],wp.prototype,"title",void 0)});var tT=y(()=>{a();l();c();XE();eT()});var rT,oT=y(()=>{a();l();c();I();rT=(r,e)=>R`
    <template role="${t=>t.role}" aria-orientation="${t=>t.orientation}"></template>
`});var iT,nT=y(()=>{a();l();c();iT={separator:"separator",presentation:"presentation"}});var bs,sT=y(()=>{a();l();c();Ie();I();pe();De();nT();bs=class extends B{constructor(){super(...arguments),this.role=iT.separator,this.orientation=gt.horizontal}};b([w],bs.prototype,"role",void 0);b([w],bs.prototype,"orientation",void 0)});var aT=y(()=>{a();l();c();oT();sT()});var Td,R0=y(()=>{a();l();c();Td={next:"next",previous:"previous"}});var lT,cT=y(()=>{a();l();c();I();R0();lT=(r,e)=>R`
    <template
        role="button"
        aria-disabled="${t=>t.disabled?!0:void 0}"
        tabindex="${t=>t.hiddenFromAT?-1:0}"
        class="${t=>t.direction} ${t=>t.disabled?"disabled":""}"
        @keyup="${(t,o)=>t.keyupHandler(o.event)}"
    >
        ${Qe(t=>t.direction===Td.next,R`
                <span part="next" class="next">
                    <slot name="next">
                        ${e.next||""}
                    </slot>
                </span>
            `)}
        ${Qe(t=>t.direction===Td.previous,R`
                <span part="previous" class="previous">
                    <slot name="previous">
                        ${e.previous||""}
                    </slot>
                </span>
            `)}
    </template>
`});var Ia,dT=y(()=>{a();l();c();Ie();I();De();R0();Ia=class extends B{constructor(){super(...arguments),this.hiddenFromAT=!0,this.direction=Td.next}keyupHandler(e){if(!this.hiddenFromAT){let t=e.key;(t==="Enter"||t==="Space")&&this.$emit("click",e),t==="Escape"&&this.blur()}}};b([w({mode:"boolean"})],Ia.prototype,"disabled",void 0);b([w({attribute:"aria-hidden",converter:_n})],Ia.prototype,"hiddenFromAT",void 0);b([w],Ia.prototype,"direction",void 0)});var uT=y(()=>{a();l();c();cT();dT()});var hT=y(()=>{a();l();c();wo()});var pT=y(()=>{a();l();c();De()});var fT,mT=y(()=>{a();l();c();I();St();fT=(r,e)=>R`
    <template
        aria-checked="${t=>t.ariaChecked}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-posinset="${t=>t.ariaPosInSet}"
        aria-selected="${t=>t.ariaSelected}"
        aria-setsize="${t=>t.ariaSetSize}"
        class="${t=>[t.checked&&"checked",t.selected&&"selected",t.disabled&&"disabled"].filter(Boolean).join(" ")}"
        role="option"
    >
        ${pt(r,e)}
        <span class="content" part="content">
            <slot ${Oe("content")}></slot>
        </span>
        ${ht(r,e)}
    </template>
`});var gT=y(()=>{a();l();c();a0();mT()});var An,xp=y(()=>{a();l();c();Ie();I();pe();gs();An=class extends Xt{constructor(){super(...arguments),this.activeIndex=-1,this.rangeStartIndex=-1}get activeOption(){return this.options[this.activeIndex]}get checkedOptions(){var e;return(e=this.options)===null||e===void 0?void 0:e.filter(t=>t.checked)}get firstSelectedOptionIndex(){return this.options.indexOf(this.firstSelectedOption)}activeIndexChanged(e,t){var o,i;this.ariaActiveDescendant=(i=(o=this.options[t])===null||o===void 0?void 0:o.id)!==null&&i!==void 0?i:"",this.focusAndScrollOptionIntoView()}checkActiveIndex(){if(!this.multiple)return;let e=this.activeOption;e&&(e.checked=!0)}checkFirstOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex+1),this.options.forEach((t,o)=>{t.checked=fd(o,this.rangeStartIndex)})):this.uncheckAllOptions(),this.activeIndex=0,this.checkActiveIndex()}checkLastOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.options.forEach((t,o)=>{t.checked=fd(o,this.rangeStartIndex,this.options.length)})):this.uncheckAllOptions(),this.activeIndex=this.options.length-1,this.checkActiveIndex()}connectedCallback(){super.connectedCallback(),this.addEventListener("focusout",this.focusoutHandler)}disconnectedCallback(){this.removeEventListener("focusout",this.focusoutHandler),super.disconnectedCallback()}checkNextOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.options.forEach((t,o)=>{t.checked=fd(o,this.rangeStartIndex,this.activeIndex+1)})):this.uncheckAllOptions(),this.activeIndex+=this.activeIndex<this.options.length-1?1:0,this.checkActiveIndex()}checkPreviousOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.checkedOptions.length===1&&(this.rangeStartIndex+=1),this.options.forEach((t,o)=>{t.checked=fd(o,this.activeIndex,this.rangeStartIndex)})):this.uncheckAllOptions(),this.activeIndex-=this.activeIndex>0?1:0,this.checkActiveIndex()}clickHandler(e){var t;if(!this.multiple)return super.clickHandler(e);let o=(t=e.target)===null||t===void 0?void 0:t.closest("[role=option]");if(!(!o||o.disabled))return this.uncheckAllOptions(),this.activeIndex=this.options.indexOf(o),this.checkActiveIndex(),this.toggleSelectedForAllCheckedOptions(),!0}focusAndScrollOptionIntoView(){super.focusAndScrollOptionIntoView(this.activeOption)}focusinHandler(e){if(!this.multiple)return super.focusinHandler(e);!this.shouldSkipFocus&&e.target===e.currentTarget&&(this.uncheckAllOptions(),this.activeIndex===-1&&(this.activeIndex=this.firstSelectedOptionIndex!==-1?this.firstSelectedOptionIndex:0),this.checkActiveIndex(),this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}focusoutHandler(e){this.multiple&&this.uncheckAllOptions()}keydownHandler(e){if(!this.multiple)return super.keydownHandler(e);if(this.disabled)return!0;let{key:t,shiftKey:o}=e;switch(this.shouldSkipFocus=!1,t){case lr:{this.checkFirstOption(o);return}case Mt:{this.checkNextOption(o);return}case Ft:{this.checkPreviousOption(o);return}case cr:{this.checkLastOption(o);return}case ds:return this.focusAndScrollOptionIntoView(),!0;case bo:return this.uncheckAllOptions(),this.checkActiveIndex(),!0;case Co:if(e.preventDefault(),this.typeAheadExpired){this.toggleSelectedForAllCheckedOptions();return}default:return t.length===1&&this.handleTypeAhead(`${t}`),!0}}mousedownHandler(e){if(e.offsetX>=0&&e.offsetX<=this.scrollWidth)return super.mousedownHandler(e)}multipleChanged(e,t){var o;this.ariaMultiSelectable=t?"true":null,(o=this.options)===null||o===void 0||o.forEach(i=>{i.checked=t?!1:void 0}),this.setSelectedOptions()}setSelectedOptions(){if(!this.multiple){super.setSelectedOptions();return}this.$fastController.isConnected&&this.options&&(this.selectedOptions=this.options.filter(e=>e.selected),this.focusAndScrollOptionIntoView())}sizeChanged(e,t){var o;let i=Math.max(0,parseInt((o=t?.toFixed())!==null&&o!==void 0?o:"",10));i!==t&&W.queueUpdate(()=>{this.size=i})}toggleSelectedForAllCheckedOptions(){let e=this.checkedOptions.filter(o=>!o.disabled),t=!e.every(o=>o.selected);e.forEach(o=>o.selected=t),this.selectedIndex=this.options.indexOf(e[e.length-1]),this.setSelectedOptions()}typeaheadBufferChanged(e,t){if(!this.multiple){super.typeaheadBufferChanged(e,t);return}if(this.$fastController.isConnected){let o=this.getTypeaheadMatches(),i=this.options.indexOf(o[0]);i>-1&&(this.activeIndex=i,this.uncheckAllOptions(),this.checkActiveIndex()),this.typeAheadExpired=!1}}uncheckAllOptions(e=!1){this.options.forEach(t=>t.checked=this.multiple?!1:void 0),e||(this.rangeStartIndex=-1)}};b([k],An.prototype,"activeIndex",void 0);b([w({mode:"boolean"})],An.prototype,"multiple",void 0);b([w({converter:ee})],An.prototype,"size",void 0)});var vT,yT=y(()=>{a();l();c();I();xp();vT=(r,e)=>R`
    <template
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        class="listbox"
        role="listbox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        <slot
            ${Oe({filter:An.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
        ></slot>
    </template>
`});var bT=y(()=>{a();l();c();gs();xp();yT()});var Aa,P0=y(()=>{a();l();c();Ie();pe();I();De();Aa=class extends B{constructor(){super(...arguments),this.optionElements=[]}menuElementsChanged(){this.updateOptions()}headerElementsChanged(){this.updateOptions()}footerElementsChanged(){this.updateOptions()}updateOptions(){this.optionElements.splice(0,this.optionElements.length),this.addSlottedListItems(this.headerElements),this.addSlottedListItems(this.menuElements),this.addSlottedListItems(this.footerElements),this.$emit("optionsupdated",{bubbles:!1})}addSlottedListItems(e){e!==void 0&&e.forEach(t=>{t.nodeType===1&&t.getAttribute("role")==="listitem"&&(t.id=t.id||Do("option-"),this.optionElements.push(t))})}};b([k],Aa.prototype,"menuElements",void 0);b([k],Aa.prototype,"headerElements",void 0);b([k],Aa.prototype,"footerElements",void 0);b([k],Aa.prototype,"suggestionsAvailableText",void 0)});var f6,Ra,Sp=y(()=>{a();l();c();Ie();I();De();f6=R`
    <template>
        ${r=>r.value}
    </template>
`,Ra=class extends B{contentsTemplateChanged(){this.$fastController.isConnected&&this.updateView()}connectedCallback(){super.connectedCallback(),this.updateView()}disconnectedCallback(){super.disconnectedCallback(),this.disconnectView()}handleClick(e){return e.defaultPrevented||this.handleInvoked(),!1}handleInvoked(){this.$emit("pickeroptioninvoked")}updateView(){var e,t;this.disconnectView(),this.customView=(t=(e=this.contentsTemplate)===null||e===void 0?void 0:e.render(this,this))!==null&&t!==void 0?t:f6.render(this,this)}disconnectView(){var e;(e=this.customView)===null||e===void 0||e.dispose(),this.customView=void 0}};b([w({attribute:"value"})],Ra.prototype,"value",void 0);b([k],Ra.prototype,"contentsTemplate",void 0)});var O0=y(()=>{a();l();c();De()});var m6,Pa,_p=y(()=>{a();l();c();Ie();I();pe();De();m6=R`
    <template>
        ${r=>r.value}
    </template>
`,Pa=class extends B{contentsTemplateChanged(){this.$fastController.isConnected&&this.updateView()}connectedCallback(){super.connectedCallback(),this.updateView()}disconnectedCallback(){this.disconnectView(),super.disconnectedCallback()}handleKeyDown(e){return e.defaultPrevented?!1:e.key===Zt?(this.handleInvoke(),!1):!0}handleClick(e){return e.defaultPrevented||this.handleInvoke(),!1}handleInvoke(){this.$emit("pickeriteminvoked")}updateView(){var e,t;this.disconnectView(),this.customView=(t=(e=this.contentsTemplate)===null||e===void 0?void 0:e.render(this,this))!==null&&t!==void 0?t:m6.render(this,this)}disconnectView(){var e;(e=this.customView)===null||e===void 0||e.dispose(),this.customView=void 0}};b([w({attribute:"value"})],Pa.prototype,"value",void 0);b([k],Pa.prototype,"contentsTemplate",void 0)});var CT=y(()=>{a();l();c();I();gd();P0();Sp();O0();_p()});var $0,Ep,wT=y(()=>{a();l();c();wo();De();$0=class extends B{},Ep=class extends fr($0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var g6,at,xT=y(()=>{a();l();c();Ie();I();pe();Jv();Sp();_p();wT();g6=R`
    <input
        slot="input-region"
        role="combobox"
        type="text"
        autocapitalize="off"
        autocomplete="off"
        haspopup="list"
        aria-label="${r=>r.label}"
        aria-labelledby="${r=>r.labelledBy}"
        placeholder="${r=>r.placeholder}"
        ${we("inputElement")}
    ></input>
`,at=class extends Ep{constructor(){super(...arguments),this.selection="",this.filterSelected=!0,this.filterQuery=!0,this.noSuggestionsText="No suggestions available",this.suggestionsAvailableText="Suggestions available",this.loadingText="Loading suggestions",this.menuPlacement="bottom-fill",this.showLoading=!1,this.optionsList=[],this.filteredOptionsList=[],this.flyoutOpen=!1,this.menuFocusIndex=-1,this.showNoOptions=!1,this.selectedItems=[],this.inputElementView=null,this.handleTextInput=e=>{this.query=this.inputElement.value},this.handleInputClick=e=>{e.preventDefault(),this.toggleFlyout(!0)},this.setRegionProps=()=>{if(this.flyoutOpen){if(this.region===null||this.region===void 0){W.queueUpdate(this.setRegionProps);return}this.region.anchorElement=this.inputElement}},this.configLookup={top:Wv,bottom:Qv,tallest:Yv,"top-fill":U_,"bottom-fill":Zv,"tallest-fill":B_}}selectionChanged(){this.$fastController.isConnected&&(this.handleSelectionChange(),this.proxy instanceof HTMLInputElement&&(this.proxy.value=this.selection,this.validate()))}optionsChanged(){this.optionsList=this.options.split(",").map(e=>e.trim()).filter(e=>e!=="")}menuPlacementChanged(){this.$fastController.isConnected&&this.updateMenuConfig()}showLoadingChanged(){this.$fastController.isConnected&&W.queueUpdate(()=>{this.setFocusedOption(0)})}listItemTemplateChanged(){this.updateListItemTemplate()}defaultListItemTemplateChanged(){this.updateListItemTemplate()}menuOptionTemplateChanged(){this.updateOptionTemplate()}defaultMenuOptionTemplateChanged(){this.updateOptionTemplate()}optionsListChanged(){this.updateFilteredOptions()}queryChanged(){this.$fastController.isConnected&&(this.inputElement.value!==this.query&&(this.inputElement.value=this.query),this.updateFilteredOptions(),this.$emit("querychange",{bubbles:!1}))}filteredOptionsListChanged(){this.$fastController.isConnected&&(this.showNoOptions=this.filteredOptionsList.length===0&&this.menuElement.querySelectorAll('[role="listitem"]').length===0,this.setFocusedOption(this.showNoOptions?-1:0))}flyoutOpenChanged(){this.flyoutOpen?(W.queueUpdate(this.setRegionProps),this.$emit("menuopening",{bubbles:!1})):this.$emit("menuclosing",{bubbles:!1})}showNoOptionsChanged(){this.$fastController.isConnected&&W.queueUpdate(()=>{this.setFocusedOption(0)})}connectedCallback(){super.connectedCallback(),this.listElement=document.createElement(this.selectedListTag),this.appendChild(this.listElement),this.itemsPlaceholderElement=document.createComment(""),this.listElement.append(this.itemsPlaceholderElement),this.inputElementView=g6.render(this,this.listElement);let e=this.menuTag.toUpperCase();this.menuElement=Array.from(this.children).find(t=>t.tagName===e),this.menuElement===void 0&&(this.menuElement=document.createElement(this.menuTag),this.appendChild(this.menuElement)),this.menuElement.id===""&&(this.menuElement.id=Do("listbox-")),this.menuId=this.menuElement.id,this.optionsPlaceholder=document.createComment(""),this.menuElement.append(this.optionsPlaceholder),this.updateMenuConfig(),W.queueUpdate(()=>this.initialize())}disconnectedCallback(){super.disconnectedCallback(),this.toggleFlyout(!1),this.inputElement.removeEventListener("input",this.handleTextInput),this.inputElement.removeEventListener("click",this.handleInputClick),this.inputElementView!==null&&(this.inputElementView.dispose(),this.inputElementView=null)}focus(){this.inputElement.focus()}initialize(){this.updateListItemTemplate(),this.updateOptionTemplate(),this.itemsRepeatBehavior=new zi(e=>e.selectedItems,e=>e.activeListItemTemplate,{positioning:!0}).createBehavior(this.itemsPlaceholderElement),this.inputElement.addEventListener("input",this.handleTextInput),this.inputElement.addEventListener("click",this.handleInputClick),this.$fastController.addBehaviors([this.itemsRepeatBehavior]),this.menuElement.suggestionsAvailableText=this.suggestionsAvailableText,this.menuElement.addEventListener("optionsupdated",this.handleMenuOptionsUpdated),this.optionsRepeatBehavior=new zi(e=>e.filteredOptionsList,e=>e.activeMenuOptionTemplate,{positioning:!0}).createBehavior(this.optionsPlaceholder),this.$fastController.addBehaviors([this.optionsRepeatBehavior]),this.handleSelectionChange()}toggleFlyout(e){if(this.flyoutOpen!==e){if(e&&document.activeElement===this.inputElement){this.flyoutOpen=e,W.queueUpdate(()=>{this.menuElement!==void 0?this.setFocusedOption(0):this.disableMenu()});return}this.flyoutOpen=!1,this.disableMenu()}}handleMenuOptionsUpdated(e){e.preventDefault(),this.flyoutOpen&&this.setFocusedOption(0)}handleKeyDown(e){if(e.defaultPrevented)return!1;switch(e.key){case Mt:{if(!this.flyoutOpen)this.toggleFlyout(!0);else{let t=this.flyoutOpen?Math.min(this.menuFocusIndex+1,this.menuElement.optionElements.length-1):0;this.setFocusedOption(t)}return!1}case Ft:{if(!this.flyoutOpen)this.toggleFlyout(!0);else{let t=this.flyoutOpen?Math.max(this.menuFocusIndex-1,0):0;this.setFocusedOption(t)}return!1}case bo:return this.toggleFlyout(!1),!1;case Zt:return this.menuFocusIndex!==-1&&this.menuElement.optionElements.length>this.menuFocusIndex&&this.menuElement.optionElements[this.menuFocusIndex].click(),!1;case Qr:return document.activeElement!==this.inputElement?(this.incrementFocusedItem(1),!1):!0;case Wr:return this.inputElement.selectionStart===0?(this.incrementFocusedItem(-1),!1):!0;case E_:case __:{if(document.activeElement===null)return!0;if(document.activeElement===this.inputElement)return this.inputElement.selectionStart===0?(this.selection=this.selectedItems.slice(0,this.selectedItems.length-1).toString(),this.toggleFlyout(!1),!1):!0;let t=Array.from(this.listElement.children),o=t.indexOf(document.activeElement);return o>-1?(this.selection=this.selectedItems.splice(o,1).toString(),W.queueUpdate(()=>{t[Math.min(t.length,o)].focus()}),!1):!0}}return this.toggleFlyout(!0),!0}handleFocusIn(e){return!1}handleFocusOut(e){return(this.menuElement===void 0||!this.menuElement.contains(e.relatedTarget))&&this.toggleFlyout(!1),!1}handleSelectionChange(){this.selectedItems.toString()!==this.selection&&(this.selectedItems=this.selection===""?[]:this.selection.split(","),this.updateFilteredOptions(),W.queueUpdate(()=>{this.checkMaxItems()}),this.$emit("selectionchange",{bubbles:!1}))}handleRegionLoaded(e){W.queueUpdate(()=>{this.setFocusedOption(0),this.$emit("menuloaded",{bubbles:!1})})}checkMaxItems(){if(this.inputElement!==void 0)if(this.maxSelected!==void 0&&this.selectedItems.length>=this.maxSelected){if(document.activeElement===this.inputElement){let e=Array.from(this.listElement.querySelectorAll("[role='listitem']"));e[e.length-1].focus()}this.inputElement.hidden=!0}else this.inputElement.hidden=!1}handleItemInvoke(e){if(e.defaultPrevented)return!1;if(e.target instanceof Pa){let o=Array.from(this.listElement.querySelectorAll("[role='listitem']")).indexOf(e.target);if(o!==-1){let i=this.selectedItems.slice();i.splice(o,1),this.selection=i.toString(),W.queueUpdate(()=>this.incrementFocusedItem(0))}return!1}return!0}handleOptionInvoke(e){return e.defaultPrevented?!1:e.target instanceof Ra?(e.target.value!==void 0&&(this.selection=`${this.selection}${this.selection===""?"":","}${e.target.value}`),this.inputElement.value="",this.query="",this.inputElement.focus(),this.toggleFlyout(!1),!1):!0}incrementFocusedItem(e){if(this.selectedItems.length===0){this.inputElement.focus();return}let t=Array.from(this.listElement.querySelectorAll("[role='listitem']"));if(document.activeElement!==null){let o=t.indexOf(document.activeElement);o===-1&&(o=t.length);let i=Math.min(t.length,Math.max(0,o+e));i===t.length?this.maxSelected!==void 0&&this.selectedItems.length>=this.maxSelected?t[i-1].focus():this.inputElement.focus():t[i].focus()}}disableMenu(){var e,t,o;this.menuFocusIndex=-1,this.menuFocusOptionId=void 0,(e=this.inputElement)===null||e===void 0||e.removeAttribute("aria-activedescendant"),(t=this.inputElement)===null||t===void 0||t.removeAttribute("aria-owns"),(o=this.inputElement)===null||o===void 0||o.removeAttribute("aria-expanded")}setFocusedOption(e){if(!this.flyoutOpen||e===-1||this.showNoOptions||this.showLoading){this.disableMenu();return}if(this.menuElement.optionElements.length===0)return;this.menuElement.optionElements.forEach(o=>{o.setAttribute("aria-selected","false")}),this.menuFocusIndex=e,this.menuFocusIndex>this.menuElement.optionElements.length-1&&(this.menuFocusIndex=this.menuElement.optionElements.length-1),this.menuFocusOptionId=this.menuElement.optionElements[this.menuFocusIndex].id,this.inputElement.setAttribute("aria-owns",this.menuId),this.inputElement.setAttribute("aria-expanded","true"),this.inputElement.setAttribute("aria-activedescendant",this.menuFocusOptionId);let t=this.menuElement.optionElements[this.menuFocusIndex];t.setAttribute("aria-selected","true"),this.menuElement.scrollTo(0,t.offsetTop)}updateListItemTemplate(){var e;this.activeListItemTemplate=(e=this.listItemTemplate)!==null&&e!==void 0?e:this.defaultListItemTemplate}updateOptionTemplate(){var e;this.activeMenuOptionTemplate=(e=this.menuOptionTemplate)!==null&&e!==void 0?e:this.defaultMenuOptionTemplate}updateFilteredOptions(){this.filteredOptionsList=this.optionsList.slice(0),this.filterSelected&&(this.filteredOptionsList=this.filteredOptionsList.filter(e=>this.selectedItems.indexOf(e)===-1)),this.filterQuery&&this.query!==""&&this.query!==void 0&&(this.filteredOptionsList=this.filteredOptionsList.filter(e=>e.indexOf(this.query)!==-1))}updateMenuConfig(){let e=this.configLookup[this.menuPlacement];e===null&&(e=Zv),this.menuConfig=Object.assign(Object.assign({},e),{autoUpdateMode:"auto",fixedPlacement:!0,horizontalViewportLock:!1,verticalViewportLock:!1})}};b([w({attribute:"selection"})],at.prototype,"selection",void 0);b([w({attribute:"options"})],at.prototype,"options",void 0);b([w({attribute:"filter-selected",mode:"boolean"})],at.prototype,"filterSelected",void 0);b([w({attribute:"filter-query",mode:"boolean"})],at.prototype,"filterQuery",void 0);b([w({attribute:"max-selected"})],at.prototype,"maxSelected",void 0);b([w({attribute:"no-suggestions-text"})],at.prototype,"noSuggestionsText",void 0);b([w({attribute:"suggestions-available-text"})],at.prototype,"suggestionsAvailableText",void 0);b([w({attribute:"loading-text"})],at.prototype,"loadingText",void 0);b([w({attribute:"label"})],at.prototype,"label",void 0);b([w({attribute:"labelledby"})],at.prototype,"labelledBy",void 0);b([w({attribute:"placeholder"})],at.prototype,"placeholder",void 0);b([w({attribute:"menu-placement"})],at.prototype,"menuPlacement",void 0);b([k],at.prototype,"showLoading",void 0);b([k],at.prototype,"listItemTemplate",void 0);b([k],at.prototype,"defaultListItemTemplate",void 0);b([k],at.prototype,"activeListItemTemplate",void 0);b([k],at.prototype,"menuOptionTemplate",void 0);b([k],at.prototype,"defaultMenuOptionTemplate",void 0);b([k],at.prototype,"activeMenuOptionTemplate",void 0);b([k],at.prototype,"listItemContentsTemplate",void 0);b([k],at.prototype,"menuOptionContentsTemplate",void 0);b([k],at.prototype,"optionsList",void 0);b([k],at.prototype,"query",void 0);b([k],at.prototype,"filteredOptionsList",void 0);b([k],at.prototype,"flyoutOpen",void 0);b([k],at.prototype,"menuId",void 0);b([k],at.prototype,"selectedListTag",void 0);b([k],at.prototype,"menuTag",void 0);b([k],at.prototype,"menuFocusIndex",void 0);b([k],at.prototype,"menuFocusOptionId",void 0);b([k],at.prototype,"showNoOptions",void 0);b([k],at.prototype,"menuConfig",void 0);b([k],at.prototype,"selectedItems",void 0)});var ST=y(()=>{a();l();c();I()});var _T=y(()=>{a();l();c();I()});var ET=y(()=>{a();l();c();I()});var TT=y(()=>{a();l();c();I()});var kT=y(()=>{a();l();c();CT();xT();ST();P0();_T();Sp();ET();O0();TT();_p()});var kr,M0,IT=y(()=>{a();l();c();kr={menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio"},M0={[kr.menuitem]:"menuitem",[kr.menuitemcheckbox]:"menuitemcheckbox",[kr.menuitemradio]:"menuitemradio"}});var Ir,F0=y(()=>{a();l();c();Ie();I();pe();De();St();ps();Tr();IT();Ir=class extends B{constructor(){super(...arguments),this.role=kr.menuitem,this.hasSubmenu=!1,this.currentDirection=Ze.ltr,this.focusSubmenuOnLoad=!1,this.handleMenuItemKeyDown=e=>{if(e.defaultPrevented)return!1;switch(e.key){case Zt:case Co:return this.invoke(),!1;case Qr:return this.expandAndFocus(),!1;case Wr:if(this.expanded)return this.expanded=!1,this.focus(),!1}return!0},this.handleMenuItemClick=e=>(e.defaultPrevented||this.disabled||this.invoke(),!1),this.submenuLoaded=()=>{this.focusSubmenuOnLoad&&(this.focusSubmenuOnLoad=!1,this.hasSubmenu&&(this.submenu.focus(),this.setAttribute("tabindex","-1")))},this.handleMouseOver=e=>(this.disabled||!this.hasSubmenu||this.expanded||(this.expanded=!0),!1),this.handleMouseOut=e=>(!this.expanded||this.contains(document.activeElement)||(this.expanded=!1),!1),this.expandAndFocus=()=>{this.hasSubmenu&&(this.focusSubmenuOnLoad=!0,this.expanded=!0)},this.invoke=()=>{if(!this.disabled)switch(this.role){case kr.menuitemcheckbox:this.checked=!this.checked;break;case kr.menuitem:this.updateSubmenu(),this.hasSubmenu?this.expandAndFocus():this.$emit("change");break;case kr.menuitemradio:this.checked||(this.checked=!0);break}},this.updateSubmenu=()=>{this.submenu=this.domChildren().find(e=>e.getAttribute("role")==="menu"),this.hasSubmenu=this.submenu!==void 0}}expandedChanged(e){if(this.$fastController.isConnected){if(this.submenu===void 0)return;this.expanded===!1?this.submenu.collapseExpandedItem():this.currentDirection=Lo(this),this.$emit("expanded-change",this,{bubbles:!1})}}checkedChanged(e,t){this.$fastController.isConnected&&this.$emit("change")}connectedCallback(){super.connectedCallback(),W.queueUpdate(()=>{this.updateSubmenu()}),this.startColumnCount||(this.startColumnCount=1),this.observer=new MutationObserver(this.updateSubmenu)}disconnectedCallback(){super.disconnectedCallback(),this.submenu=void 0,this.observer!==void 0&&(this.observer.disconnect(),this.observer=void 0)}domChildren(){return Array.from(this.children).filter(e=>!e.hasAttribute("hidden"))}};b([w({mode:"boolean"})],Ir.prototype,"disabled",void 0);b([w({mode:"boolean"})],Ir.prototype,"expanded",void 0);b([k],Ir.prototype,"startColumnCount",void 0);b([w],Ir.prototype,"role",void 0);b([w({mode:"boolean"})],Ir.prototype,"checked",void 0);b([k],Ir.prototype,"submenuRegion",void 0);b([k],Ir.prototype,"hasSubmenu",void 0);b([k],Ir.prototype,"currentDirection",void 0);b([k],Ir.prototype,"submenu",void 0);je(Ir,mt)});var AT,RT=y(()=>{a();l();c();I();gd();St();F0();AT=(r,e)=>R`
    <template
        role="${t=>t.role}"
        aria-haspopup="${t=>t.hasSubmenu?"menu":void 0}"
        aria-checked="${t=>t.role!==kr.menuitem?t.checked:void 0}"
        aria-disabled="${t=>t.disabled}"
        aria-expanded="${t=>t.expanded}"
        @keydown="${(t,o)=>t.handleMenuItemKeyDown(o.event)}"
        @click="${(t,o)=>t.handleMenuItemClick(o.event)}"
        @mouseover="${(t,o)=>t.handleMouseOver(o.event)}"
        @mouseout="${(t,o)=>t.handleMouseOut(o.event)}"
        class="${t=>t.disabled?"disabled":""} ${t=>t.expanded?"expanded":""} ${t=>`indent-${t.startColumnCount}`}"
    >
            ${Qe(t=>t.role===kr.menuitemcheckbox,R`
                    <div part="input-container" class="input-container">
                        <span part="checkbox" class="checkbox">
                            <slot name="checkbox-indicator">
                                ${e.checkboxIndicator||""}
                            </slot>
                        </span>
                    </div>
                `)}
            ${Qe(t=>t.role===kr.menuitemradio,R`
                    <div part="input-container" class="input-container">
                        <span part="radio" class="radio">
                            <slot name="radio-indicator">
                                ${e.radioIndicator||""}
                            </slot>
                        </span>
                    </div>
                `)}
        </div>
        ${pt(r,e)}
        <span class="content" part="content">
            <slot></slot>
        </span>
        ${ht(r,e)}
        ${Qe(t=>t.hasSubmenu,R`
                <div
                    part="expand-collapse-glyph-container"
                    class="expand-collapse-glyph-container"
                >
                    <span part="expand-collapse" class="expand-collapse">
                        <slot name="expand-collapse-indicator">
                            ${e.expandCollapseGlyph||""}
                        </slot>
                    </span>
                </div>
            `)}
        ${Qe(t=>t.expanded,R`
                <${r.tagFor(Re)}
                    :anchorElement="${t=>t}"
                    vertical-positioning-mode="dynamic"
                    vertical-default-position="bottom"
                    vertical-inset="true"
                    horizontal-positioning-mode="dynamic"
                    horizontal-default-position="end"
                    class="submenu-region"
                    dir="${t=>t.currentDirection}"
                    @loaded="${t=>t.submenuLoaded()}"
                    ${we("submenuRegion")}
                    part="submenu-region"
                >
                    <slot name="submenu"></slot>
                </${r.tagFor(Re)}>
            `)}
    </template>
`});var D0=y(()=>{a();l();c();RT();F0()});var PT,OT=y(()=>{a();l();c();I();PT=(r,e)=>R`
    <template
        slot="${t=>t.slot?t.slot:t.isNestedMenu()?"submenu":void 0}"
        role="menu"
        @keydown="${(t,o)=>t.handleMenuKeyDown(o.event)}"
        @focusout="${(t,o)=>t.handleFocusOut(o.event)}"
    >
        <slot ${Oe("items")}></slot>
    </template>
`});var Oa,$T=y(()=>{a();l();c();Ie();I();pe();D0();De();Oa=class r extends B{constructor(){super(...arguments),this.expandedItem=null,this.focusIndex=-1,this.isNestedMenu=()=>this.parentElement!==null&&qi(this.parentElement)&&this.parentElement.getAttribute("role")==="menuitem",this.handleFocusOut=e=>{if(!this.contains(e.relatedTarget)&&this.menuItems!==void 0){this.collapseExpandedItem();let t=this.menuItems.findIndex(this.isFocusableElement);this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.menuItems[t].setAttribute("tabindex","0"),this.focusIndex=t}},this.handleItemFocus=e=>{let t=e.target;this.menuItems!==void 0&&t!==this.menuItems[this.focusIndex]&&(this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=this.menuItems.indexOf(t),t.setAttribute("tabindex","0"))},this.handleExpandedChanged=e=>{if(e.defaultPrevented||e.target===null||this.menuItems===void 0||this.menuItems.indexOf(e.target)<0)return;e.preventDefault();let t=e.target;if(this.expandedItem!==null&&t===this.expandedItem&&t.expanded===!1){this.expandedItem=null;return}t.expanded&&(this.expandedItem!==null&&this.expandedItem!==t&&(this.expandedItem.expanded=!1),this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.expandedItem=t,this.focusIndex=this.menuItems.indexOf(t),t.setAttribute("tabindex","0"))},this.removeItemListeners=()=>{this.menuItems!==void 0&&this.menuItems.forEach(e=>{e.removeEventListener("expanded-change",this.handleExpandedChanged),e.removeEventListener("focus",this.handleItemFocus)})},this.setItems=()=>{let e=this.domChildren();this.removeItemListeners(),this.menuItems=e;let t=this.menuItems.filter(this.isMenuItemElement);t.length&&(this.focusIndex=0);function o(n){let s=n.getAttribute("role"),d=n.querySelector("[slot=start]");return s!==kr.menuitem&&d===null||s===kr.menuitem&&d!==null?1:s!==kr.menuitem&&d!==null?2:0}let i=t.reduce((n,s)=>{let d=o(s);return n>d?n:d},0);t.forEach((n,s)=>{n.setAttribute("tabindex",s===0?"0":"-1"),n.addEventListener("expanded-change",this.handleExpandedChanged),n.addEventListener("focus",this.handleItemFocus),n instanceof Ir&&(n.startColumnCount=i)})},this.changeHandler=e=>{if(this.menuItems===void 0)return;let t=e.target,o=this.menuItems.indexOf(t);if(o!==-1&&t.role==="menuitemradio"&&t.checked===!0){for(let n=o-1;n>=0;--n){let s=this.menuItems[n],d=s.getAttribute("role");if(d===kr.menuitemradio&&(s.checked=!1),d==="separator")break}let i=this.menuItems.length-1;for(let n=o+1;n<=i;++n){let s=this.menuItems[n],d=s.getAttribute("role");if(d===kr.menuitemradio&&(s.checked=!1),d==="separator")break}}},this.isMenuItemElement=e=>qi(e)&&r.focusableElementRoles.hasOwnProperty(e.getAttribute("role")),this.isFocusableElement=e=>this.isMenuItemElement(e)}itemsChanged(e,t){this.$fastController.isConnected&&this.menuItems!==void 0&&this.setItems()}connectedCallback(){super.connectedCallback(),W.queueUpdate(()=>{this.setItems()}),this.addEventListener("change",this.changeHandler)}disconnectedCallback(){super.disconnectedCallback(),this.removeItemListeners(),this.menuItems=void 0,this.removeEventListener("change",this.changeHandler)}focus(){this.setFocus(0,1)}collapseExpandedItem(){this.expandedItem!==null&&(this.expandedItem.expanded=!1,this.expandedItem=null)}handleMenuKeyDown(e){if(!(e.defaultPrevented||this.menuItems===void 0))switch(e.key){case Mt:this.setFocus(this.focusIndex+1,1);return;case Ft:this.setFocus(this.focusIndex-1,-1);return;case cr:this.setFocus(this.menuItems.length-1,-1);return;case lr:this.setFocus(0,1);return;default:return!0}}domChildren(){return Array.from(this.children).filter(e=>!e.hasAttribute("hidden"))}setFocus(e,t){if(this.menuItems!==void 0)for(;e>=0&&e<this.menuItems.length;){let o=this.menuItems[e];if(this.isFocusableElement(o)){this.focusIndex>-1&&this.menuItems.length>=this.focusIndex-1&&this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=e,o.setAttribute("tabindex","0"),o.focus();break}e+=t}}};Oa.focusableElementRoles=M0;b([k],Oa.prototype,"items",void 0)});var MT=y(()=>{a();l();c();OT();$T()});var FT,DT=y(()=>{a();l();c();I();St();FT=(r,e)=>R`
    <template class="${t=>t.readOnly?"readonly":""}">
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Oe("defaultSlottedNodes")}></slot>
        </label>
        <div class="root" part="root">
            ${pt(r,e)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${t=>t.handleTextInput()}"
                @change="${t=>t.handleChange()}"
                @keydown="${(t,o)=>t.handleKeyDown(o.event)}"
                @blur="${(t,o)=>t.handleBlur()}"
                ?autofocus="${t=>t.autofocus}"
                ?disabled="${t=>t.disabled}"
                list="${t=>t.list}"
                maxlength="${t=>t.maxlength}"
                minlength="${t=>t.minlength}"
                placeholder="${t=>t.placeholder}"
                ?readonly="${t=>t.readOnly}"
                ?required="${t=>t.required}"
                size="${t=>t.size}"
                type="text"
                inputmode="numeric"
                min="${t=>t.min}"
                max="${t=>t.max}"
                step="${t=>t.step}"
                aria-atomic="${t=>t.ariaAtomic}"
                aria-busy="${t=>t.ariaBusy}"
                aria-controls="${t=>t.ariaControls}"
                aria-current="${t=>t.ariaCurrent}"
                aria-describedby="${t=>t.ariaDescribedby}"
                aria-details="${t=>t.ariaDetails}"
                aria-disabled="${t=>t.ariaDisabled}"
                aria-errormessage="${t=>t.ariaErrormessage}"
                aria-flowto="${t=>t.ariaFlowto}"
                aria-haspopup="${t=>t.ariaHaspopup}"
                aria-hidden="${t=>t.ariaHidden}"
                aria-invalid="${t=>t.ariaInvalid}"
                aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
                aria-label="${t=>t.ariaLabel}"
                aria-labelledby="${t=>t.ariaLabelledby}"
                aria-live="${t=>t.ariaLive}"
                aria-owns="${t=>t.ariaOwns}"
                aria-relevant="${t=>t.ariaRelevant}"
                aria-roledescription="${t=>t.ariaRoledescription}"
                ${we("control")}
            />
            ${Qe(t=>!t.hideStep&&!t.readOnly&&!t.disabled,R`
                    <div class="controls" part="controls">
                        <div class="step-up" part="step-up" @click="${t=>t.stepUp()}">
                            <slot name="step-up-glyph">
                                ${e.stepUpGlyph||""}
                            </slot>
                        </div>
                        <div
                            class="step-down"
                            part="step-down"
                            @click="${t=>t.stepDown()}"
                        >
                            <slot name="step-down-glyph">
                                ${e.stepDownGlyph||""}
                            </slot>
                        </div>
                    </div>
                `)}
            ${ht(r,e)}
        </div>
    </template>
`});var L0,Tp,LT=y(()=>{a();l();c();wo();De();L0=class extends B{},Tp=class extends fr(L0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var NT,HT=y(()=>{a();l();c();NT={email:"email",password:"password",tel:"tel",text:"text",url:"url"}});var Ur,Cs,kp=y(()=>{a();l();c();Ie();I();xa();Tr();LT();HT();Ur=class extends Tp{constructor(){super(...arguments),this.type=NT.text}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}typeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type,this.validate())}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.validate(),this.autofocus&&W.queueUpdate(()=>{this.focus()})}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.value=this.control.value}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}};b([w({attribute:"readonly",mode:"boolean"})],Ur.prototype,"readOnly",void 0);b([w({mode:"boolean"})],Ur.prototype,"autofocus",void 0);b([w],Ur.prototype,"placeholder",void 0);b([w],Ur.prototype,"type",void 0);b([w],Ur.prototype,"list",void 0);b([w({converter:ee})],Ur.prototype,"maxlength",void 0);b([w({converter:ee})],Ur.prototype,"minlength",void 0);b([w],Ur.prototype,"pattern",void 0);b([w({converter:ee})],Ur.prototype,"size",void 0);b([w({mode:"boolean"})],Ur.prototype,"spellcheck",void 0);b([k],Ur.prototype,"defaultSlottedNodes",void 0);Cs=class{};je(Cs,st);je(Ur,mt,Cs)});var N0,Ip,UT=y(()=>{a();l();c();wo();De();N0=class extends B{},Ip=class extends fr(N0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Ar,BT=y(()=>{a();l();c();Ie();I();pe();St();Tr();kp();UT();Ar=class extends Ip{constructor(){super(...arguments),this.hideStep=!1,this.step=1,this.isUserInput=!1}maxChanged(e,t){var o;this.max=Math.max(t,(o=this.min)!==null&&o!==void 0?o:t);let i=Math.min(this.min,this.max);this.min!==void 0&&this.min!==i&&(this.min=i),this.value=this.getValidValue(this.value)}minChanged(e,t){var o;this.min=Math.min(t,(o=this.max)!==null&&o!==void 0?o:t);let i=Math.max(this.min,this.max);this.max!==void 0&&this.max!==i&&(this.max=i),this.value=this.getValidValue(this.value)}get valueAsNumber(){return parseFloat(super.value)}set valueAsNumber(e){this.value=e.toString()}valueChanged(e,t){this.value=this.getValidValue(t),t===this.value&&(this.control&&!this.isUserInput&&(this.control.value=this.value),super.valueChanged(e,this.value),e!==void 0&&!this.isUserInput&&(this.$emit("input"),this.$emit("change")),this.isUserInput=!1)}validate(){super.validate(this.control)}getValidValue(e){var t,o;let i=parseFloat(parseFloat(e).toPrecision(12));return isNaN(i)?i="":(i=Math.min(i,(t=this.max)!==null&&t!==void 0?t:i),i=Math.max(i,(o=this.min)!==null&&o!==void 0?o:i).toString()),i}stepUp(){let e=parseFloat(this.value),t=isNaN(e)?this.min>0?this.min:this.max<0?this.max:this.min?0:this.step:e+this.step;this.value=t.toString()}stepDown(){let e=parseFloat(this.value),t=isNaN(e)?this.min>0?this.min:this.max<0?this.max:this.min?0:0-this.step:e-this.step;this.value=t.toString()}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type","number"),this.validate(),this.control.value=this.value,this.autofocus&&W.queueUpdate(()=>{this.focus()})}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.control.value=this.control.value.replace(/[^0-9\-+e.]/g,""),this.isUserInput=!0,this.value=this.control.value}handleChange(){this.$emit("change")}handleKeyDown(e){switch(e.key){case Ft:return this.stepUp(),!1;case Mt:return this.stepDown(),!1}return!0}handleBlur(){this.control.value=this.value}};b([w({attribute:"readonly",mode:"boolean"})],Ar.prototype,"readOnly",void 0);b([w({mode:"boolean"})],Ar.prototype,"autofocus",void 0);b([w({attribute:"hide-step",mode:"boolean"})],Ar.prototype,"hideStep",void 0);b([w],Ar.prototype,"placeholder",void 0);b([w],Ar.prototype,"list",void 0);b([w({converter:ee})],Ar.prototype,"maxlength",void 0);b([w({converter:ee})],Ar.prototype,"minlength",void 0);b([w({converter:ee})],Ar.prototype,"size",void 0);b([w({converter:ee})],Ar.prototype,"step",void 0);b([w({converter:ee})],Ar.prototype,"max",void 0);b([w({converter:ee})],Ar.prototype,"min",void 0);b([k],Ar.prototype,"defaultSlottedNodes",void 0);je(Ar,mt,Cs)});var VT=y(()=>{a();l();c();DT();BT()});var zT,qT,GT=y(()=>{a();l();c();I();zT=44,qT=(r,e)=>R`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${Qe(t=>typeof t.value=="number",R`
                <svg
                    class="progress"
                    part="progress"
                    viewBox="0 0 16 16"
                    slot="determinate"
                >
                    <circle
                        class="background"
                        part="background"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                    <circle
                        class="determinate"
                        part="determinate"
                        style="stroke-dasharray: ${t=>zT*t.percentComplete/100}px ${zT}px"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                </svg>
            `,R`
                <slot name="indeterminate" slot="indeterminate">
                    ${e.indeterminateIndicator||""}
                </slot>
            `)}
    </template>
`});var jT=y(()=>{a();l();c();GT()});var Ei,KT=y(()=>{a();l();c();Ie();I();De();Ei=class extends B{constructor(){super(...arguments),this.percentComplete=0}valueChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}minChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}maxChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}connectedCallback(){super.connectedCallback(),this.updatePercentComplete()}updatePercentComplete(){let e=typeof this.min=="number"?this.min:0,t=typeof this.max=="number"?this.max:100,o=typeof this.value=="number"?this.value:0,i=t-e;this.percentComplete=i===0?0:Math.fround((o-e)/i*100)}};b([w({converter:ee})],Ei.prototype,"value",void 0);b([w({converter:ee})],Ei.prototype,"min",void 0);b([w({converter:ee})],Ei.prototype,"max",void 0);b([w({mode:"boolean"})],Ei.prototype,"paused",void 0);b([k],Ei.prototype,"percentComplete",void 0)});var WT,QT=y(()=>{a();l();c();I();WT=(r,e)=>R`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${Qe(t=>typeof t.value=="number",R`
                <div class="progress" part="progress" slot="determinate">
                    <div
                        class="determinate"
                        part="determinate"
                        style="width: ${t=>t.percentComplete}%"
                    ></div>
                </div>
            `,R`
                <div class="progress" part="progress" slot="indeterminate">
                    <slot class="indeterminate" name="indeterminate">
                        ${e.indeterminateIndicator1||""}
                        ${e.indeterminateIndicator2||""}
                    </slot>
                </div>
            `)}
    </template>
`});var YT=y(()=>{a();l();c();KT();QT()});var ZT,JT=y(()=>{a();l();c();I();pe();ZT=(r,e)=>R`
    <template
        role="radiogroup"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @focusout="${(t,o)=>t.focusOutHandler(o.event)}"
    >
        <slot name="label"></slot>
        <div
            class="positioning-region ${t=>t.orientation===gt.horizontal?"horizontal":"vertical"}"
            part="positioning-region"
        >
            <slot
                ${Oe({property:"slottedRadioButtons",filter:Er("[role=radio]")})}
            ></slot>
        </div>
    </template>
`});var Ti,XT=y(()=>{a();l();c();Ie();I();pe();ps();De();Ti=class extends B{constructor(){super(...arguments),this.orientation=gt.horizontal,this.radioChangeHandler=e=>{let t=e.target;t.checked&&(this.slottedRadioButtons.forEach(o=>{o!==t&&(o.checked=!1,this.isInsideFoundationToolbar||o.setAttribute("tabindex","-1"))}),this.selectedRadio=t,this.value=t.value,t.setAttribute("tabindex","0"),this.focusedRadio=t),e.stopPropagation()},this.moveToRadioByIndex=(e,t)=>{let o=e[t];this.isInsideToolbar||(o.setAttribute("tabindex","0"),o.readOnly?this.slottedRadioButtons.forEach(i=>{i!==o&&i.setAttribute("tabindex","-1")}):(o.checked=!0,this.selectedRadio=o)),this.focusedRadio=o,o.focus()},this.moveRightOffGroup=()=>{var e;(e=this.nextElementSibling)===null||e===void 0||e.focus()},this.moveLeftOffGroup=()=>{var e;(e=this.previousElementSibling)===null||e===void 0||e.focus()},this.focusOutHandler=e=>{let t=this.slottedRadioButtons,o=e.target,i=o!==null?t.indexOf(o):0,n=this.focusedRadio?t.indexOf(this.focusedRadio):-1;return(n===0&&i===n||n===t.length-1&&n===i)&&(this.selectedRadio?(this.focusedRadio=this.selectedRadio,this.isInsideFoundationToolbar||(this.selectedRadio.setAttribute("tabindex","0"),t.forEach(s=>{s!==this.selectedRadio&&s.setAttribute("tabindex","-1")}))):(this.focusedRadio=t[0],this.focusedRadio.setAttribute("tabindex","0"),t.forEach(s=>{s!==this.focusedRadio&&s.setAttribute("tabindex","-1")}))),!0},this.clickHandler=e=>{let t=e.target;if(t){let o=this.slottedRadioButtons;t.checked||o.indexOf(t)===0?(t.setAttribute("tabindex","0"),this.selectedRadio=t):(t.setAttribute("tabindex","-1"),this.selectedRadio=null),this.focusedRadio=t}e.preventDefault()},this.shouldMoveOffGroupToTheRight=(e,t,o)=>e===t.length&&this.isInsideToolbar&&o===Qr,this.shouldMoveOffGroupToTheLeft=(e,t)=>(this.focusedRadio?e.indexOf(this.focusedRadio)-1:0)<0&&this.isInsideToolbar&&t===Wr,this.checkFocusedRadio=()=>{this.focusedRadio!==null&&!this.focusedRadio.readOnly&&!this.focusedRadio.checked&&(this.focusedRadio.checked=!0,this.focusedRadio.setAttribute("tabindex","0"),this.focusedRadio.focus(),this.selectedRadio=this.focusedRadio)},this.moveRight=e=>{let t=this.slottedRadioButtons,o=0;if(o=this.focusedRadio?t.indexOf(this.focusedRadio)+1:1,this.shouldMoveOffGroupToTheRight(o,t,e.key)){this.moveRightOffGroup();return}else o===t.length&&(o=0);for(;o<t.length&&t.length>1;)if(t[o].disabled){if(this.focusedRadio&&o===t.indexOf(this.focusedRadio))break;if(o+1>=t.length){if(this.isInsideToolbar)break;o=0}else o+=1}else{this.moveToRadioByIndex(t,o);break}},this.moveLeft=e=>{let t=this.slottedRadioButtons,o=0;if(o=this.focusedRadio?t.indexOf(this.focusedRadio)-1:0,o=o<0?t.length-1:o,this.shouldMoveOffGroupToTheLeft(t,e.key)){this.moveLeftOffGroup();return}for(;o>=0&&t.length>1;)if(t[o].disabled){if(this.focusedRadio&&o===t.indexOf(this.focusedRadio))break;o-1<0?o=t.length-1:o-=1}else{this.moveToRadioByIndex(t,o);break}},this.keydownHandler=e=>{let t=e.key;if(t in us&&this.isInsideFoundationToolbar)return!0;switch(t){case Zt:{this.checkFocusedRadio();break}case Qr:case Mt:{this.direction===Ze.ltr?this.moveRight(e):this.moveLeft(e);break}case Wr:case Ft:{this.direction===Ze.ltr?this.moveLeft(e):this.moveRight(e);break}default:return!0}}}readOnlyChanged(){this.slottedRadioButtons!==void 0&&this.slottedRadioButtons.forEach(e=>{this.readOnly?e.readOnly=!0:e.readOnly=!1})}disabledChanged(){this.slottedRadioButtons!==void 0&&this.slottedRadioButtons.forEach(e=>{this.disabled?e.disabled=!0:e.disabled=!1})}nameChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach(e=>{e.setAttribute("name",this.name)})}valueChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach(e=>{e.value===this.value&&(e.checked=!0,this.selectedRadio=e)}),this.$emit("change")}slottedRadioButtonsChanged(e,t){this.slottedRadioButtons&&this.slottedRadioButtons.length>0&&this.setupRadioButtons()}get parentToolbar(){return this.closest('[role="toolbar"]')}get isInsideToolbar(){var e;return(e=this.parentToolbar)!==null&&e!==void 0?e:!1}get isInsideFoundationToolbar(){var e;return!!(!((e=this.parentToolbar)===null||e===void 0)&&e.$fastController)}connectedCallback(){super.connectedCallback(),this.direction=Lo(this),this.setupRadioButtons()}disconnectedCallback(){this.slottedRadioButtons.forEach(e=>{e.removeEventListener("change",this.radioChangeHandler)})}setupRadioButtons(){let e=this.slottedRadioButtons.filter(i=>i.hasAttribute("checked")),t=e?e.length:0;if(t>1){let i=e[t-1];i.checked=!0}let o=!1;if(this.slottedRadioButtons.forEach(i=>{this.name!==void 0&&i.setAttribute("name",this.name),this.disabled&&(i.disabled=!0),this.readOnly&&(i.readOnly=!0),this.value&&this.value===i.value?(this.selectedRadio=i,this.focusedRadio=i,i.checked=!0,i.setAttribute("tabindex","0"),o=!0):(this.isInsideFoundationToolbar||i.setAttribute("tabindex","-1"),i.checked=!1),i.addEventListener("change",this.radioChangeHandler)}),this.value===void 0&&this.slottedRadioButtons.length>0){let i=this.slottedRadioButtons.filter(s=>s.hasAttribute("checked")),n=i!==null?i.length:0;if(n>0&&!o){let s=i[n-1];s.checked=!0,this.focusedRadio=s,s.setAttribute("tabindex","0")}else this.slottedRadioButtons[0].setAttribute("tabindex","0"),this.focusedRadio=this.slottedRadioButtons[0]}}};b([w({attribute:"readonly",mode:"boolean"})],Ti.prototype,"readOnly",void 0);b([w({attribute:"disabled",mode:"boolean"})],Ti.prototype,"disabled",void 0);b([w],Ti.prototype,"name",void 0);b([w],Ti.prototype,"value",void 0);b([w],Ti.prototype,"orientation",void 0);b([k],Ti.prototype,"childItems",void 0);b([k],Ti.prototype,"slottedRadioButtons",void 0)});var ek=y(()=>{a();l();c();JT();XT()});var tk,rk=y(()=>{a();l();c();I();tk=(r,e)=>R`
    <template
        role="radio"
        class="${t=>t.checked?"checked":""} ${t=>t.readOnly?"readonly":""}"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${e.checkedIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Oe("defaultSlottedNodes")}></slot>
        </label>
    </template>
`});var H0,Ap,ok=y(()=>{a();l();c();wo();De();H0=class extends B{},Ap=class extends Al(H0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var $a,ik=y(()=>{a();l();c();Ie();I();pe();ok();$a=class extends Ap{constructor(){super(),this.initialValue="on",this.keypressHandler=e=>{switch(e.key){case Co:!this.checked&&!this.readOnly&&(this.checked=!0);return}return!0},this.proxy.setAttribute("type","radio")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}defaultCheckedChanged(){var e;this.$fastController.isConnected&&!this.dirtyChecked&&(this.isInsideRadioGroup()||(this.checked=(e=this.defaultChecked)!==null&&e!==void 0?e:!1,this.dirtyChecked=!1))}connectedCallback(){var e,t;super.connectedCallback(),this.validate(),((e=this.parentElement)===null||e===void 0?void 0:e.getAttribute("role"))!=="radiogroup"&&this.getAttribute("tabindex")===null&&(this.disabled||this.setAttribute("tabindex","0")),this.checkedAttribute&&(this.dirtyChecked||this.isInsideRadioGroup()||(this.checked=(t=this.defaultChecked)!==null&&t!==void 0?t:!1,this.dirtyChecked=!1))}isInsideRadioGroup(){return this.closest("[role=radiogroup]")!==null}clickHandler(e){!this.disabled&&!this.readOnly&&!this.checked&&(this.checked=!0)}};b([w({attribute:"readonly",mode:"boolean"})],$a.prototype,"readOnly",void 0);b([k],$a.prototype,"name",void 0);b([k],$a.prototype,"defaultSlottedNodes",void 0)});var nk=y(()=>{a();l();c();rk();ik()});var Xo,sk=y(()=>{a();l();c();Ie();I();De();Xo=class extends B{constructor(){super(...arguments),this.framesPerSecond=60,this.updatingItems=!1,this.speed=600,this.easing="ease-in-out",this.flippersHiddenFromAT=!1,this.scrolling=!1,this.resizeDetector=null}get frameTime(){return 1e3/this.framesPerSecond}scrollingChanged(e,t){if(this.scrollContainer){let o=this.scrolling==!0?"scrollstart":"scrollend";this.$emit(o,this.scrollContainer.scrollLeft)}}get isRtl(){return this.scrollItems.length>1&&this.scrollItems[0].offsetLeft>this.scrollItems[1].offsetLeft}connectedCallback(){super.connectedCallback(),this.initializeResizeDetector()}disconnectedCallback(){this.disconnectResizeDetector(),super.disconnectedCallback()}scrollItemsChanged(e,t){t&&!this.updatingItems&&W.queueUpdate(()=>this.setStops())}disconnectResizeDetector(){this.resizeDetector&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.resized.bind(this)),this.resizeDetector.observe(this)}updateScrollStops(){this.updatingItems=!0;let e=this.scrollItems.reduce((t,o)=>o instanceof HTMLSlotElement?t.concat(o.assignedElements()):(t.push(o),t),[]);this.scrollItems=e,this.updatingItems=!1}setStops(){this.updateScrollStops();let{scrollContainer:e}=this,{scrollLeft:t}=e,{width:o,left:i}=e.getBoundingClientRect();this.width=o;let n=0,s=this.scrollItems.map((d,u)=>{let{left:h,width:p}=d.getBoundingClientRect(),v=Math.round(h+t-i),C=Math.round(v+p);return this.isRtl?-C:(n=C,u===0?0:v)}).concat(n);s=this.fixScrollMisalign(s),s.sort((d,u)=>Math.abs(d)-Math.abs(u)),this.scrollStops=s,this.setFlippers()}validateStops(e=!0){let t=()=>!!this.scrollStops.find(o=>o>0);return!t()&&e&&this.setStops(),t()}fixScrollMisalign(e){if(this.isRtl&&e.some(t=>t>0)){e.sort((o,i)=>i-o);let t=e[0];e=e.map(o=>o-t)}return e}setFlippers(){var e,t;let o=this.scrollContainer.scrollLeft;if((e=this.previousFlipperContainer)===null||e===void 0||e.classList.toggle("disabled",o===0),this.scrollStops){let i=Math.abs(this.scrollStops[this.scrollStops.length-1]);(t=this.nextFlipperContainer)===null||t===void 0||t.classList.toggle("disabled",this.validateStops(!1)&&Math.abs(o)+this.width>=i)}}scrollInView(e,t=0,o){var i;if(typeof e!="number"&&e&&(e=this.scrollItems.findIndex(n=>n===e||n.contains(e))),e!==void 0){o=o??t;let{scrollContainer:n,scrollStops:s,scrollItems:d}=this,{scrollLeft:u}=this.scrollContainer,{width:h}=n.getBoundingClientRect(),p=s[e],{width:v}=d[e].getBoundingClientRect(),C=p+v,x=u+t>p;if(x||u+h-o<C){let O=(i=[...s].sort((q,_e)=>x?_e-q:q-_e).find(q=>x?q+t<p:q+h-(o??0)>C))!==null&&i!==void 0?i:0;this.scrollToPosition(O)}}}keyupHandler(e){switch(e.key){case"ArrowLeft":this.scrollToPrevious();break;case"ArrowRight":this.scrollToNext();break}}scrollToPrevious(){this.validateStops();let e=this.scrollContainer.scrollLeft,t=this.scrollStops.findIndex((n,s)=>n>=e&&(this.isRtl||s===this.scrollStops.length-1||this.scrollStops[s+1]>e)),o=Math.abs(this.scrollStops[t+1]),i=this.scrollStops.findIndex(n=>Math.abs(n)+this.width>o);(i>=t||i===-1)&&(i=t>0?t-1:0),this.scrollToPosition(this.scrollStops[i],e)}scrollToNext(){this.validateStops();let e=this.scrollContainer.scrollLeft,t=this.scrollStops.findIndex(n=>Math.abs(n)>=Math.abs(e)),o=this.scrollStops.findIndex(n=>Math.abs(e)+this.width<=Math.abs(n)),i=t;o>t+2?i=o-2:t<this.scrollStops.length-2&&(i=t+1),this.scrollToPosition(this.scrollStops[i],e)}scrollToPosition(e,t=this.scrollContainer.scrollLeft){var o;if(this.scrolling)return;this.scrolling=!0;let i=(o=this.duration)!==null&&o!==void 0?o:`${Math.abs(e-t)/this.speed}s`;this.content.style.setProperty("transition-duration",i);let n=parseFloat(getComputedStyle(this.content).getPropertyValue("transition-duration")),s=h=>{h&&h.target!==h.currentTarget||(this.content.style.setProperty("transition-duration","0s"),this.content.style.removeProperty("transform"),this.scrollContainer.style.setProperty("scroll-behavior","auto"),this.scrollContainer.scrollLeft=e,this.setFlippers(),this.content.removeEventListener("transitionend",s),this.scrolling=!1)};if(n===0){s();return}this.content.addEventListener("transitionend",s);let d=this.scrollContainer.scrollWidth-this.scrollContainer.clientWidth,u=this.scrollContainer.scrollLeft-Math.min(e,d);this.isRtl&&(u=this.scrollContainer.scrollLeft+Math.min(Math.abs(e),d)),this.content.style.setProperty("transition-property","transform"),this.content.style.setProperty("transition-timing-function",this.easing),this.content.style.setProperty("transform",`translateX(${u}px)`)}resized(){this.resizeTimeout&&(this.resizeTimeout=clearTimeout(this.resizeTimeout)),this.resizeTimeout=setTimeout(()=>{this.width=this.scrollContainer.offsetWidth,this.setFlippers()},this.frameTime)}scrolled(){this.scrollTimeout&&(this.scrollTimeout=clearTimeout(this.scrollTimeout)),this.scrollTimeout=setTimeout(()=>{this.setFlippers()},this.frameTime)}};b([w({converter:ee})],Xo.prototype,"speed",void 0);b([w],Xo.prototype,"duration",void 0);b([w],Xo.prototype,"easing",void 0);b([w({attribute:"flippers-hidden-from-at",converter:_n})],Xo.prototype,"flippersHiddenFromAT",void 0);b([k],Xo.prototype,"scrolling",void 0);b([k],Xo.prototype,"scrollItems",void 0);b([w({attribute:"view"})],Xo.prototype,"view",void 0)});var ak,lk=y(()=>{a();l();c();I();St();ak=(r,e)=>{var t,o;return R`
    <template
        class="horizontal-scroll"
        @keyup="${(i,n)=>i.keyupHandler(n.event)}"
    >
        ${pt(r,e)}
        <div class="scroll-area" part="scroll-area">
            <div
                class="scroll-view"
                part="scroll-view"
                @scroll="${i=>i.scrolled()}"
                ${we("scrollContainer")}
            >
                <div class="content-container" part="content-container" ${we("content")}>
                    <slot
                        ${Oe({property:"scrollItems",filter:Er()})}
                    ></slot>
                </div>
            </div>
            ${Qe(i=>i.view!=="mobile",R`
                    <div
                        class="scroll scroll-prev"
                        part="scroll-prev"
                        ${we("previousFlipperContainer")}
                    >
                        <div class="scroll-action" part="scroll-action-previous">
                            <slot name="previous-flipper">
                                ${e.previousFlipper instanceof Function?e.previousFlipper(r,e):(t=e.previousFlipper)!==null&&t!==void 0?t:""}
                            </slot>
                        </div>
                    </div>
                    <div
                        class="scroll scroll-next"
                        part="scroll-next"
                        ${we("nextFlipperContainer")}
                    >
                        <div class="scroll-action" part="scroll-action-next">
                            <slot name="next-flipper">
                                ${e.nextFlipper instanceof Function?e.nextFlipper(r,e):(o=e.nextFlipper)!==null&&o!==void 0?o:""}
                            </slot>
                        </div>
                    </div>
                `)}
        </div>
        ${ht(r,e)}
    </template>
`}});var ck=y(()=>{a();l();c();sk();lk()});function kd(r,e,t){return r.nodeType!==Node.TEXT_NODE?!0:typeof r.nodeValue=="string"&&!!r.nodeValue.trim().length}var Rp=y(()=>{a();l();c()});var dk=y(()=>{a();l();c();I();St();Rp()});var U0,Pp,uk=y(()=>{a();l();c();wo();De();U0=class extends B{},Pp=class extends fr(U0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Yr,Op,hk=y(()=>{a();l();c();Ie();I();xa();Tr();uk();Yr=class extends Pp{readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.validate(),this.autofocus&&W.queueUpdate(()=>{this.focus()})}validate(){super.validate(this.control)}handleTextInput(){this.value=this.control.value}handleClearInput(){this.value="",this.control.focus(),this.handleChange()}handleChange(){this.$emit("change")}};b([w({attribute:"readonly",mode:"boolean"})],Yr.prototype,"readOnly",void 0);b([w({mode:"boolean"})],Yr.prototype,"autofocus",void 0);b([w],Yr.prototype,"placeholder",void 0);b([w],Yr.prototype,"list",void 0);b([w({converter:ee})],Yr.prototype,"maxlength",void 0);b([w({converter:ee})],Yr.prototype,"minlength",void 0);b([w],Yr.prototype,"pattern",void 0);b([w({converter:ee})],Yr.prototype,"size",void 0);b([w({mode:"boolean"})],Yr.prototype,"spellcheck",void 0);b([k],Yr.prototype,"defaultSlottedNodes",void 0);Op=class{};je(Op,st);je(Yr,mt,Op)});var pk=y(()=>{a();l();c();dk();hk()});var B0,$p,fk=y(()=>{a();l();c();xp();wo();B0=class extends An{},$p=class extends fr(B0){constructor(){super(...arguments),this.proxy=document.createElement("select")}}});var ei,Id,mk=y(()=>{a();l();c();Ie();I();pe();gs();St();Tr();fk();fp();ei=class extends $p{constructor(){super(...arguments),this.open=!1,this.forcedPosition=!1,this.listboxId=Do("listbox-"),this.maxHeight=0}openChanged(e,t){if(this.collapsible){if(this.open){this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),this.indexWhenOpened=this.selectedIndex,W.queueUpdate(()=>this.focus());return}this.ariaControls="",this.ariaExpanded="false"}}get collapsible(){return!(this.multiple||typeof this.size=="number")}get value(){return ce.track(this,"value"),this._value}set value(e){var t,o,i,n,s,d,u;let h=`${this._value}`;if(!((t=this._options)===null||t===void 0)&&t.length){let p=this._options.findIndex(x=>x.value===e),v=(i=(o=this._options[this.selectedIndex])===null||o===void 0?void 0:o.value)!==null&&i!==void 0?i:null,C=(s=(n=this._options[p])===null||n===void 0?void 0:n.value)!==null&&s!==void 0?s:null;(p===-1||v!==C)&&(e="",this.selectedIndex=p),e=(u=(d=this.firstSelectedOption)===null||d===void 0?void 0:d.value)!==null&&u!==void 0?u:e}h!==e&&(this._value=e,super.valueChanged(h,e),ce.notify(this,"value"),this.updateDisplayValue())}updateValue(e){var t,o;this.$fastController.isConnected&&(this.value=(o=(t=this.firstSelectedOption)===null||t===void 0?void 0:t.value)!==null&&o!==void 0?o:""),e&&(this.$emit("input"),this.$emit("change",this,{bubbles:!0,composed:void 0}))}selectedIndexChanged(e,t){super.selectedIndexChanged(e,t),this.updateValue()}positionChanged(e,t){this.positionAttribute=t,this.setPositioning()}setPositioning(){let e=this.getBoundingClientRect(),o=window.innerHeight-e.bottom;this.position=this.forcedPosition?this.positionAttribute:e.top>o?vs.above:vs.below,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===vs.above?~~e.top:~~o}get displayValue(){var e,t;return ce.track(this,"displayValue"),(t=(e=this.firstSelectedOption)===null||e===void 0?void 0:e.text)!==null&&t!==void 0?t:""}disabledChanged(e,t){super.disabledChanged&&super.disabledChanged(e,t),this.ariaDisabled=this.disabled?"true":"false"}formResetCallback(){this.setProxyOptions(),super.setDefaultSelectedOption(),this.selectedIndex===-1&&(this.selectedIndex=0)}clickHandler(e){if(!this.disabled){if(this.open){let t=e.target.closest("option,[role=option]");if(t&&t.disabled)return}return super.clickHandler(e),this.open=this.collapsible&&!this.open,!this.open&&this.indexWhenOpened!==this.selectedIndex&&this.updateValue(!0),!0}}focusoutHandler(e){var t;if(super.focusoutHandler(e),!this.open)return!0;let o=e.relatedTarget;if(this.isSameNode(o)){this.focus();return}!((t=this.options)===null||t===void 0)&&t.includes(o)||(this.open=!1,this.indexWhenOpened!==this.selectedIndex&&this.updateValue(!0))}handleChange(e,t){super.handleChange(e,t),t==="value"&&this.updateValue()}slottedOptionsChanged(e,t){this.options.forEach(o=>{ce.getNotifier(o).unsubscribe(this,"value")}),super.slottedOptionsChanged(e,t),this.options.forEach(o=>{ce.getNotifier(o).subscribe(this,"value")}),this.setProxyOptions(),this.updateValue()}mousedownHandler(e){var t;return e.offsetX>=0&&e.offsetX<=((t=this.listbox)===null||t===void 0?void 0:t.scrollWidth)?super.mousedownHandler(e):this.collapsible}multipleChanged(e,t){super.multipleChanged(e,t),this.proxy&&(this.proxy.multiple=t)}selectedOptionsChanged(e,t){var o;super.selectedOptionsChanged(e,t),(o=this.options)===null||o===void 0||o.forEach((i,n)=>{var s;let d=(s=this.proxy)===null||s===void 0?void 0:s.options.item(n);d&&(d.selected=i.selected)})}setDefaultSelectedOption(){var e;let t=(e=this.options)!==null&&e!==void 0?e:Array.from(this.children).filter(Xt.slottedOptionFilter),o=t?.findIndex(i=>i.hasAttribute("selected")||i.selected||i.value===this.value);if(o!==-1){this.selectedIndex=o;return}this.selectedIndex=0}setProxyOptions(){this.proxy instanceof HTMLSelectElement&&this.options&&(this.proxy.options.length=0,this.options.forEach(e=>{let t=e.proxy||(e instanceof HTMLOptionElement?e.cloneNode():null);t&&this.proxy.options.add(t)}))}keydownHandler(e){super.keydownHandler(e);let t=e.key||e.key.charCodeAt(0);switch(t){case Co:{e.preventDefault(),this.collapsible&&this.typeAheadExpired&&(this.open=!this.open);break}case lr:case cr:{e.preventDefault();break}case Zt:{e.preventDefault(),this.open=!this.open;break}case bo:{this.collapsible&&this.open&&(e.preventDefault(),this.open=!1);break}case ds:return this.collapsible&&this.open&&(e.preventDefault(),this.open=!1),!0}return!this.open&&this.indexWhenOpened!==this.selectedIndex&&(this.updateValue(!0),this.indexWhenOpened=this.selectedIndex),!(t===Mt||t===Ft)}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.addEventListener("contentchange",this.updateDisplayValue)}disconnectedCallback(){this.removeEventListener("contentchange",this.updateDisplayValue),super.disconnectedCallback()}sizeChanged(e,t){super.sizeChanged(e,t),this.proxy&&(this.proxy.size=t)}updateDisplayValue(){this.collapsible&&ce.notify(this,"displayValue")}};b([w({attribute:"open",mode:"boolean"})],ei.prototype,"open",void 0);b([fS],ei.prototype,"collapsible",null);b([k],ei.prototype,"control",void 0);b([w({attribute:"position"})],ei.prototype,"positionAttribute",void 0);b([k],ei.prototype,"position",void 0);b([k],ei.prototype,"maxHeight",void 0);Id=class{};b([k],Id.prototype,"ariaControls",void 0);je(Id,Zo);je(ei,mt,Id)});var gk,vk=y(()=>{a();l();c();I();gs();St();gk=(r,e)=>R`
    <template
        class="${t=>[t.collapsible&&"collapsible",t.collapsible&&t.open&&"open",t.disabled&&"disabled",t.collapsible&&t.position].filter(Boolean).join(" ")}"
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-controls="${t=>t.ariaControls}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-haspopup="${t=>t.collapsible?"listbox":null}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        ?open="${t=>t.open}"
        role="combobox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        ${Qe(t=>t.collapsible,R`
                <div
                    class="control"
                    part="control"
                    ?disabled="${t=>t.disabled}"
                    ${we("control")}
                >
                    ${pt(r,e)}
                    <slot name="button-container">
                        <div class="selected-value" part="selected-value">
                            <slot name="selected-value">${t=>t.displayValue}</slot>
                        </div>
                        <div aria-hidden="true" class="indicator" part="indicator">
                            <slot name="indicator">
                                ${e.indicator||""}
                            </slot>
                        </div>
                    </slot>
                    ${ht(r,e)}
                </div>
            `)}
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>t.collapsible?!t.open:!1}"
            ${we("listbox")}
        >
            <slot
                ${Oe({filter:Xt.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`});var yk=y(()=>{a();l();c();mk();fp();vk()});var bk,Ck=y(()=>{a();l();c();I();bk=(r,e)=>R`
    <template
        class="${t=>t.shape==="circle"?"circle":"rect"}"
        pattern="${t=>t.pattern}"
        ?shimmer="${t=>t.shimmer}"
    >
        ${Qe(t=>t.shimmer===!0,R`
                <span class="shimmer"></span>
            `)}
        <object type="image/svg+xml" data="${t=>t.pattern}" role="presentation">
            <img class="pattern" src="${t=>t.pattern}" />
        </object>
        <slot></slot>
    </template>
`});var ws,wk=y(()=>{a();l();c();Ie();I();De();ws=class extends B{constructor(){super(...arguments),this.shape="rect"}};b([w],ws.prototype,"fill",void 0);b([w],ws.prototype,"shape",void 0);b([w],ws.prototype,"pattern",void 0);b([w({mode:"boolean"})],ws.prototype,"shimmer",void 0)});var xk=y(()=>{a();l();c();Ck();wk()});var Sk,_k=y(()=>{a();l();c();I();pe();Sk=(r,e)=>R`
    <template
        aria-disabled="${t=>t.disabled}"
        class="${t=>t.sliderOrientation||gt.horizontal}
            ${t=>t.disabled?"disabled":""}"
    >
        <div ${we("root")} part="root" class="root" style="${t=>t.positionStyle}">
            <div class="container">
                ${Qe(t=>!t.hideMark,R`
                        <div class="mark"></div>
                    `)}
                <div class="label">
                    <slot></slot>
                </div>
            </div>
        </div>
    </template>
`});function Ad(r,e,t,o){let i=hs(0,1,(r-e)/(t-e));return o===Ze.rtl&&(i=1-i),i}var V0=y(()=>{a();l();c();pe()});var Mp,ti,Ek=y(()=>{a();l();c();Ie();I();pe();V0();De();Mp={min:0,max:0,direction:Ze.ltr,orientation:gt.horizontal,disabled:!1},ti=class extends B{constructor(){super(...arguments),this.hideMark=!1,this.sliderDirection=Ze.ltr,this.getSliderConfiguration=()=>{if(!this.isSliderConfig(this.parentNode))this.sliderDirection=Mp.direction||Ze.ltr,this.sliderOrientation=Mp.orientation||gt.horizontal,this.sliderMaxPosition=Mp.max,this.sliderMinPosition=Mp.min;else{let e=this.parentNode,{min:t,max:o,direction:i,orientation:n,disabled:s}=e;s!==void 0&&(this.disabled=s),this.sliderDirection=i||Ze.ltr,this.sliderOrientation=n||gt.horizontal,this.sliderMaxPosition=o,this.sliderMinPosition=t}},this.positionAsStyle=()=>{let e=this.sliderDirection?this.sliderDirection:Ze.ltr,t=Ad(Number(this.position),Number(this.sliderMinPosition),Number(this.sliderMaxPosition)),o=Math.round((1-t)*100),i=Math.round(t*100);return Number.isNaN(i)&&Number.isNaN(o)&&(o=50,i=50),this.sliderOrientation===gt.horizontal?e===Ze.rtl?`right: ${i}%; left: ${o}%;`:`left: ${i}%; right: ${o}%;`:`top: ${i}%; bottom: ${o}%;`}}positionChanged(){this.positionStyle=this.positionAsStyle()}sliderOrientationChanged(){}connectedCallback(){super.connectedCallback(),this.getSliderConfiguration(),this.positionStyle=this.positionAsStyle(),this.notifier=ce.getNotifier(this.parentNode),this.notifier.subscribe(this,"orientation"),this.notifier.subscribe(this,"direction"),this.notifier.subscribe(this,"max"),this.notifier.subscribe(this,"min")}disconnectedCallback(){super.disconnectedCallback(),this.notifier.unsubscribe(this,"orientation"),this.notifier.unsubscribe(this,"direction"),this.notifier.unsubscribe(this,"max"),this.notifier.unsubscribe(this,"min")}handleChange(e,t){switch(t){case"direction":this.sliderDirection=e.direction;break;case"orientation":this.sliderOrientation=e.orientation;break;case"max":this.sliderMaxPosition=e.max;break;case"min":this.sliderMinPosition=e.min;break;default:break}this.positionStyle=this.positionAsStyle()}isSliderConfig(e){return e.max!==void 0&&e.min!==void 0}};b([k],ti.prototype,"positionStyle",void 0);b([w],ti.prototype,"position",void 0);b([w({attribute:"hide-mark",mode:"boolean"})],ti.prototype,"hideMark",void 0);b([w({attribute:"disabled",mode:"boolean"})],ti.prototype,"disabled",void 0);b([k],ti.prototype,"sliderOrientation",void 0);b([k],ti.prototype,"sliderMinPosition",void 0);b([k],ti.prototype,"sliderMaxPosition",void 0);b([k],ti.prototype,"sliderDirection",void 0)});var Tk=y(()=>{a();l();c();_k();Ek()});var kk,Ik=y(()=>{a();l();c();I();pe();kk=(r,e)=>R`
    <template
        role="slider"
        class="${t=>t.readOnly?"readonly":""}
        ${t=>t.orientation||gt.horizontal}"
        tabindex="${t=>t.disabled?null:0}"
        aria-valuetext="${t=>t.valueTextFormatter(t.value)}"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        aria-disabled="${t=>t.disabled?!0:void 0}"
        aria-readonly="${t=>t.readOnly?!0:void 0}"
        aria-orientation="${t=>t.orientation}"
        class="${t=>t.orientation}"
    >
        <div part="positioning-region" class="positioning-region">
            <div ${we("track")} part="track-container" class="track">
                <slot name="track"></slot>
                <div part="track-start" class="track-start" style="${t=>t.position}">
                    <slot name="track-start"></slot>
                </div>
            </div>
            <slot></slot>
            <div
                ${we("thumb")}
                part="thumb-container"
                class="thumb-container"
                style="${t=>t.position}"
            >
                <slot name="thumb">${e.thumb||""}</slot>
            </div>
        </div>
    </template>
`});var z0,Fp,Ak=y(()=>{a();l();c();wo();De();z0=class extends B{},Fp=class extends fr(z0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var v6,mr,Rk=y(()=>{a();l();c();Ie();I();pe();ps();V0();Ak();v6={singleValue:"single-value"},mr=class extends Fp{constructor(){super(...arguments),this.direction=Ze.ltr,this.isDragging=!1,this.trackWidth=0,this.trackMinWidth=0,this.trackHeight=0,this.trackLeft=0,this.trackMinHeight=0,this.valueTextFormatter=()=>null,this.min=0,this.max=10,this.step=1,this.orientation=gt.horizontal,this.mode=v6.singleValue,this.keypressHandler=e=>{if(!this.readOnly){if(e.key===lr)e.preventDefault(),this.value=`${this.min}`;else if(e.key===cr)e.preventDefault(),this.value=`${this.max}`;else if(!e.shiftKey)switch(e.key){case Qr:case Ft:e.preventDefault(),this.increment();break;case Wr:case Mt:e.preventDefault(),this.decrement();break}}},this.setupTrackConstraints=()=>{let e=this.track.getBoundingClientRect();this.trackWidth=this.track.clientWidth,this.trackMinWidth=this.track.clientLeft,this.trackHeight=e.bottom,this.trackMinHeight=e.top,this.trackLeft=this.getBoundingClientRect().left,this.trackWidth===0&&(this.trackWidth=1)},this.setupListeners=(e=!1)=>{let t=`${e?"remove":"add"}EventListener`;this[t]("keydown",this.keypressHandler),this[t]("mousedown",this.handleMouseDown),this.thumb[t]("mousedown",this.handleThumbMouseDown,{passive:!0}),this.thumb[t]("touchstart",this.handleThumbMouseDown,{passive:!0}),e&&(this.handleMouseDown(null),this.handleThumbMouseDown(null))},this.initialValue="",this.handleThumbMouseDown=e=>{if(e){if(this.readOnly||this.disabled||e.defaultPrevented)return;e.target.focus()}let t=`${e!==null?"add":"remove"}EventListener`;window[t]("mouseup",this.handleWindowMouseUp),window[t]("mousemove",this.handleMouseMove,{passive:!0}),window[t]("touchmove",this.handleMouseMove,{passive:!0}),window[t]("touchend",this.handleWindowMouseUp),this.isDragging=e!==null},this.handleMouseMove=e=>{if(this.readOnly||this.disabled||e.defaultPrevented)return;let t=window.TouchEvent&&e instanceof TouchEvent?e.touches[0]:e,o=this.orientation===gt.horizontal?t.pageX-document.documentElement.scrollLeft-this.trackLeft:t.pageY-document.documentElement.scrollTop;this.value=`${this.calculateNewValue(o)}`},this.calculateNewValue=e=>{let t=Ad(e,this.orientation===gt.horizontal?this.trackMinWidth:this.trackMinHeight,this.orientation===gt.horizontal?this.trackWidth:this.trackHeight,this.direction),o=(this.max-this.min)*t+this.min;return this.convertToConstrainedValue(o)},this.handleWindowMouseUp=e=>{this.stopDragging()},this.stopDragging=()=>{this.isDragging=!1,this.handleMouseDown(null),this.handleThumbMouseDown(null)},this.handleMouseDown=e=>{let t=`${e!==null?"add":"remove"}EventListener`;if((e===null||!this.disabled&&!this.readOnly)&&(window[t]("mouseup",this.handleWindowMouseUp),window.document[t]("mouseleave",this.handleWindowMouseUp),window[t]("mousemove",this.handleMouseMove),e)){e.preventDefault(),this.setupTrackConstraints(),e.target.focus();let o=this.orientation===gt.horizontal?e.pageX-document.documentElement.scrollLeft-this.trackLeft:e.pageY-document.documentElement.scrollTop;this.value=`${this.calculateNewValue(o)}`}},this.convertToConstrainedValue=e=>{isNaN(e)&&(e=this.min);let t=e-this.min,o=Math.round(t/this.step),i=t-o*(this.stepMultiplier*this.step)/this.stepMultiplier;return t=i>=Number(this.step)/2?t-i+Number(this.step):t-i,t+this.min}}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}get valueAsNumber(){return parseFloat(super.value)}set valueAsNumber(e){this.value=e.toString()}valueChanged(e,t){super.valueChanged(e,t),this.$fastController.isConnected&&this.setThumbPositionForOrientation(this.direction),this.$emit("change")}minChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.min=`${this.min}`),this.validate()}maxChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.max=`${this.max}`),this.validate()}stepChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.step=`${this.step}`),this.updateStepMultiplier(),this.validate()}orientationChanged(){this.$fastController.isConnected&&this.setThumbPositionForOrientation(this.direction)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type","range"),this.direction=Lo(this),this.updateStepMultiplier(),this.setupTrackConstraints(),this.setupListeners(),this.setupDefaultValue(),this.setThumbPositionForOrientation(this.direction)}disconnectedCallback(){this.setupListeners(!0)}increment(){let e=this.direction!==Ze.rtl&&this.orientation!==gt.vertical?Number(this.value)+Number(this.step):Number(this.value)-Number(this.step),t=this.convertToConstrainedValue(e),o=t<Number(this.max)?`${t}`:`${this.max}`;this.value=o}decrement(){let e=this.direction!==Ze.rtl&&this.orientation!==gt.vertical?Number(this.value)-Number(this.step):Number(this.value)+Number(this.step),t=this.convertToConstrainedValue(e),o=t>Number(this.min)?`${t}`:`${this.min}`;this.value=o}setThumbPositionForOrientation(e){let o=(1-Ad(Number(this.value),Number(this.min),Number(this.max),e))*100;this.orientation===gt.horizontal?this.position=this.isDragging?`right: ${o}%; transition: none;`:`right: ${o}%; transition: all 0.2s ease;`:this.position=this.isDragging?`bottom: ${o}%; transition: none;`:`bottom: ${o}%; transition: all 0.2s ease;`}updateStepMultiplier(){let e=this.step+"",t=this.step%1?e.length-e.indexOf(".")-1:0;this.stepMultiplier=Math.pow(10,t)}get midpoint(){return`${this.convertToConstrainedValue((this.max+this.min)/2)}`}setupDefaultValue(){if(typeof this.value=="string")if(this.value.length===0)this.initialValue=this.midpoint;else{let e=parseFloat(this.value);!Number.isNaN(e)&&(e<this.min||e>this.max)&&(this.value=this.midpoint)}}};b([w({attribute:"readonly",mode:"boolean"})],mr.prototype,"readOnly",void 0);b([k],mr.prototype,"direction",void 0);b([k],mr.prototype,"isDragging",void 0);b([k],mr.prototype,"position",void 0);b([k],mr.prototype,"trackWidth",void 0);b([k],mr.prototype,"trackMinWidth",void 0);b([k],mr.prototype,"trackHeight",void 0);b([k],mr.prototype,"trackLeft",void 0);b([k],mr.prototype,"trackMinHeight",void 0);b([k],mr.prototype,"valueTextFormatter",void 0);b([w({converter:ee})],mr.prototype,"min",void 0);b([w({converter:ee})],mr.prototype,"max",void 0);b([w({converter:ee})],mr.prototype,"step",void 0);b([w],mr.prototype,"orientation",void 0);b([w],mr.prototype,"mode",void 0)});var Pk=y(()=>{a();l();c();Ik();Rk()});var Ok,$k=y(()=>{a();l();c();I();Ok=(r,e)=>R`
    <template
        role="switch"
        aria-checked="${t=>t.checked}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.checked?"checked":""}"
    >
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Oe("defaultSlottedNodes")}></slot>
        </label>
        <div part="switch" class="switch">
            <slot name="switch">${e.switch||""}</slot>
        </div>
        <span class="status-message" part="status-message">
            <span class="checked-message" part="checked-message">
                <slot name="checked-message"></slot>
            </span>
            <span class="unchecked-message" part="unchecked-message">
                <slot name="unchecked-message"></slot>
            </span>
        </span>
    </template>
`});var q0,Dp,Mk=y(()=>{a();l();c();wo();De();q0=class extends B{},Dp=class extends Al(q0){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var $l,Fk=y(()=>{a();l();c();Ie();I();pe();Mk();$l=class extends Dp{constructor(){super(),this.initialValue="on",this.keypressHandler=e=>{if(!this.readOnly)switch(e.key){case Zt:case Co:this.checked=!this.checked;break}},this.clickHandler=e=>{!this.disabled&&!this.readOnly&&(this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly),this.readOnly?this.classList.add("readonly"):this.classList.remove("readonly")}checkedChanged(e,t){super.checkedChanged(e,t),this.checked?this.classList.add("checked"):this.classList.remove("checked")}};b([w({attribute:"readonly",mode:"boolean"})],$l.prototype,"readOnly",void 0);b([k],$l.prototype,"defaultSlottedNodes",void 0)});var Dk=y(()=>{a();l();c();$k();Fk()});var Lk,Nk=y(()=>{a();l();c();I();Lk=(r,e)=>R`
    <template slot="tabpanel" role="tabpanel">
        <slot></slot>
    </template>
`});var Lp,Hk=y(()=>{a();l();c();De();Lp=class extends B{}});var Uk=y(()=>{a();l();c();Nk();Hk()});var Bk,Vk=y(()=>{a();l();c();I();Bk=(r,e)=>R`
    <template slot="tab" role="tab" aria-disabled="${t=>t.disabled}">
        <slot></slot>
    </template>
`});var Rd,zk=y(()=>{a();l();c();Ie();I();De();Rd=class extends B{};b([w({mode:"boolean"})],Rd.prototype,"disabled",void 0)});var qk=y(()=>{a();l();c();Vk();zk()});var Gk,jk=y(()=>{a();l();c();I();St();Gk=(r,e)=>R`
    <template class="${t=>t.orientation}">
        ${pt(r,e)}
        <div class="tablist" part="tablist" role="tablist">
            <slot class="tab" name="tab" part="tab" ${Oe("tabs")}></slot>

            ${Qe(t=>t.showActiveIndicator,R`
                    <div
                        ${we("activeIndicatorRef")}
                        class="activeIndicator"
                        part="activeIndicator"
                    ></div>
                `)}
        </div>
        ${ht(r,e)}
        <div class="tabpanel" part="tabpanel">
            <slot name="tabpanel" ${Oe("tabpanels")}></slot>
        </div>
    </template>
`});var Kk,ri,Wk=y(()=>{a();l();c();Ie();I();pe();St();Tr();De();Kk={vertical:"vertical",horizontal:"horizontal"},ri=class extends B{constructor(){super(...arguments),this.orientation=Kk.horizontal,this.activeindicator=!0,this.showActiveIndicator=!0,this.prevActiveTabIndex=0,this.activeTabIndex=0,this.ticking=!1,this.change=()=>{this.$emit("change",this.activetab)},this.isDisabledElement=e=>e.getAttribute("aria-disabled")==="true",this.isHiddenElement=e=>e.hasAttribute("hidden"),this.isFocusableElement=e=>!this.isDisabledElement(e)&&!this.isHiddenElement(e),this.setTabs=()=>{let e="gridColumn",t="gridRow",o=this.isHorizontal()?e:t;this.activeTabIndex=this.getActiveIndex(),this.showActiveIndicator=!1,this.tabs.forEach((i,n)=>{if(i.slot==="tab"){let s=this.activeTabIndex===n&&this.isFocusableElement(i);this.activeindicator&&this.isFocusableElement(i)&&(this.showActiveIndicator=!0);let d=this.tabIds[n],u=this.tabpanelIds[n];i.setAttribute("id",d),i.setAttribute("aria-selected",s?"true":"false"),i.setAttribute("aria-controls",u),i.addEventListener("click",this.handleTabClick),i.addEventListener("keydown",this.handleTabKeyDown),i.setAttribute("tabindex",s?"0":"-1"),s&&(this.activetab=i,this.activeid=d)}i.style[e]="",i.style[t]="",i.style[o]=`${n+1}`,this.isHorizontal()?i.classList.remove("vertical"):i.classList.add("vertical")})},this.setTabPanels=()=>{this.tabpanels.forEach((e,t)=>{let o=this.tabIds[t],i=this.tabpanelIds[t];e.setAttribute("id",i),e.setAttribute("aria-labelledby",o),this.activeTabIndex!==t?e.setAttribute("hidden",""):e.removeAttribute("hidden")})},this.handleTabClick=e=>{let t=e.currentTarget;t.nodeType===1&&this.isFocusableElement(t)&&(this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=this.tabs.indexOf(t),this.setComponent())},this.handleTabKeyDown=e=>{if(this.isHorizontal())switch(e.key){case Wr:e.preventDefault(),this.adjustBackward(e);break;case Qr:e.preventDefault(),this.adjustForward(e);break}else switch(e.key){case Ft:e.preventDefault(),this.adjustBackward(e);break;case Mt:e.preventDefault(),this.adjustForward(e);break}switch(e.key){case lr:e.preventDefault(),this.adjust(-this.activeTabIndex);break;case cr:e.preventDefault(),this.adjust(this.tabs.length-this.activeTabIndex-1);break}},this.adjustForward=e=>{let t=this.tabs,o=0;for(o=this.activetab?t.indexOf(this.activetab)+1:1,o===t.length&&(o=0);o<t.length&&t.length>1;)if(this.isFocusableElement(t[o])){this.moveToTabByIndex(t,o);break}else{if(this.activetab&&o===t.indexOf(this.activetab))break;o+1>=t.length?o=0:o+=1}},this.adjustBackward=e=>{let t=this.tabs,o=0;for(o=this.activetab?t.indexOf(this.activetab)-1:0,o=o<0?t.length-1:o;o>=0&&t.length>1;)if(this.isFocusableElement(t[o])){this.moveToTabByIndex(t,o);break}else o-1<0?o=t.length-1:o-=1},this.moveToTabByIndex=(e,t)=>{let o=e[t];this.activetab=o,this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=t,o.focus(),this.setComponent()}}orientationChanged(){this.$fastController.isConnected&&(this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}activeidChanged(e,t){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.prevActiveTabIndex=this.tabs.findIndex(o=>o.id===e),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabsChanged(){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabpanelsChanged(){this.$fastController.isConnected&&this.tabpanels.length<=this.tabs.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}getActiveIndex(){return this.activeid!==void 0?this.tabIds.indexOf(this.activeid)===-1?0:this.tabIds.indexOf(this.activeid):0}getTabIds(){return this.tabs.map(e=>{var t;return(t=e.getAttribute("id"))!==null&&t!==void 0?t:`tab-${Do()}`})}getTabPanelIds(){return this.tabpanels.map(e=>{var t;return(t=e.getAttribute("id"))!==null&&t!==void 0?t:`panel-${Do()}`})}setComponent(){this.activeTabIndex!==this.prevActiveTabIndex&&(this.activeid=this.tabIds[this.activeTabIndex],this.focusTab(),this.change())}isHorizontal(){return this.orientation===Kk.horizontal}handleActiveIndicatorPosition(){this.showActiveIndicator&&this.activeindicator&&this.activeTabIndex!==this.prevActiveTabIndex&&(this.ticking?this.ticking=!1:(this.ticking=!0,this.animateActiveIndicator()))}animateActiveIndicator(){this.ticking=!0;let e=this.isHorizontal()?"gridColumn":"gridRow",t=this.isHorizontal()?"translateX":"translateY",o=this.isHorizontal()?"offsetLeft":"offsetTop",i=this.activeIndicatorRef[o];this.activeIndicatorRef.style[e]=`${this.activeTabIndex+1}`;let n=this.activeIndicatorRef[o];this.activeIndicatorRef.style[e]=`${this.prevActiveTabIndex+1}`;let s=n-i;this.activeIndicatorRef.style.transform=`${t}(${s}px)`,this.activeIndicatorRef.classList.add("activeIndicatorTransition"),this.activeIndicatorRef.addEventListener("transitionend",()=>{this.ticking=!1,this.activeIndicatorRef.style[e]=`${this.activeTabIndex+1}`,this.activeIndicatorRef.style.transform=`${t}(0px)`,this.activeIndicatorRef.classList.remove("activeIndicatorTransition")})}adjust(e){let t=this.tabs.filter(s=>this.isFocusableElement(s)),o=t.indexOf(this.activetab),i=hs(0,t.length-1,o+e),n=this.tabs.indexOf(t[i]);n>-1&&this.moveToTabByIndex(this.tabs,n)}focusTab(){this.tabs[this.activeTabIndex].focus()}connectedCallback(){super.connectedCallback(),this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.activeTabIndex=this.getActiveIndex()}};b([w],ri.prototype,"orientation",void 0);b([w],ri.prototype,"activeid",void 0);b([k],ri.prototype,"tabs",void 0);b([k],ri.prototype,"tabpanels",void 0);b([w({mode:"boolean"})],ri.prototype,"activeindicator",void 0);b([k],ri.prototype,"activeIndicatorRef",void 0);b([k],ri.prototype,"showActiveIndicator",void 0);je(ri,mt)});var Qk=y(()=>{a();l();c();jk();Wk()});var G0,Np,Yk=y(()=>{a();l();c();wo();De();G0=class extends B{},Np=class extends fr(G0){constructor(){super(...arguments),this.proxy=document.createElement("textarea")}}});var Hp,Zk=y(()=>{a();l();c();Hp={none:"none",both:"both",horizontal:"horizontal",vertical:"vertical"}});var gr,j0=y(()=>{a();l();c();Ie();I();kp();Tr();Yk();Zk();gr=class extends Np{constructor(){super(...arguments),this.resize=Hp.none,this.cols=20,this.handleTextInput=()=>{this.value=this.control.value}}readOnlyChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.readOnly=this.readOnly)}autofocusChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.autofocus=this.autofocus)}listChanged(){this.proxy instanceof HTMLTextAreaElement&&this.proxy.setAttribute("list",this.list)}maxlengthChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.maxLength=this.maxlength)}minlengthChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.minLength=this.minlength)}spellcheckChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.spellcheck=this.spellcheck)}select(){this.control.select(),this.$emit("select")}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}};b([w({mode:"boolean"})],gr.prototype,"readOnly",void 0);b([w],gr.prototype,"resize",void 0);b([w({mode:"boolean"})],gr.prototype,"autofocus",void 0);b([w({attribute:"form"})],gr.prototype,"formId",void 0);b([w],gr.prototype,"list",void 0);b([w({converter:ee})],gr.prototype,"maxlength",void 0);b([w({converter:ee})],gr.prototype,"minlength",void 0);b([w],gr.prototype,"name",void 0);b([w],gr.prototype,"placeholder",void 0);b([w({converter:ee,mode:"fromView"})],gr.prototype,"cols",void 0);b([w({converter:ee,mode:"fromView"})],gr.prototype,"rows",void 0);b([w({mode:"boolean"})],gr.prototype,"spellcheck",void 0);b([k],gr.prototype,"defaultSlottedNodes",void 0);je(gr,Cs)});var Jk,Xk=y(()=>{a();l();c();I();j0();Jk=(r,e)=>R`
    <template
        class="
            ${t=>t.readOnly?"readonly":""}
            ${t=>t.resize!==Hp.none?`resize-${t.resize}`:""}"
    >
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Oe("defaultSlottedNodes")}></slot>
        </label>
        <textarea
            part="control"
            class="control"
            id="control"
            ?autofocus="${t=>t.autofocus}"
            cols="${t=>t.cols}"
            ?disabled="${t=>t.disabled}"
            form="${t=>t.form}"
            list="${t=>t.list}"
            maxlength="${t=>t.maxlength}"
            minlength="${t=>t.minlength}"
            name="${t=>t.name}"
            placeholder="${t=>t.placeholder}"
            ?readonly="${t=>t.readOnly}"
            ?required="${t=>t.required}"
            rows="${t=>t.rows}"
            ?spellcheck="${t=>t.spellcheck}"
            :value="${t=>t.value}"
            aria-atomic="${t=>t.ariaAtomic}"
            aria-busy="${t=>t.ariaBusy}"
            aria-controls="${t=>t.ariaControls}"
            aria-current="${t=>t.ariaCurrent}"
            aria-describedby="${t=>t.ariaDescribedby}"
            aria-details="${t=>t.ariaDetails}"
            aria-disabled="${t=>t.ariaDisabled}"
            aria-errormessage="${t=>t.ariaErrormessage}"
            aria-flowto="${t=>t.ariaFlowto}"
            aria-haspopup="${t=>t.ariaHaspopup}"
            aria-hidden="${t=>t.ariaHidden}"
            aria-invalid="${t=>t.ariaInvalid}"
            aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
            aria-label="${t=>t.ariaLabel}"
            aria-labelledby="${t=>t.ariaLabelledby}"
            aria-live="${t=>t.ariaLive}"
            aria-owns="${t=>t.ariaOwns}"
            aria-relevant="${t=>t.ariaRelevant}"
            aria-roledescription="${t=>t.ariaRoledescription}"
            @input="${(t,o)=>t.handleTextInput()}"
            @change="${t=>t.handleChange()}"
            ${we("control")}
        ></textarea>
    </template>
`});var e2=y(()=>{a();l();c();Xk();j0()});var t2,r2=y(()=>{a();l();c();I();St();Rp();t2=(r,e)=>R`
    <template
        class="
            ${t=>t.readOnly?"readonly":""}
        "
    >
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot
                ${Oe({property:"defaultSlottedNodes",filter:kd})}
            ></slot>
        </label>
        <div class="root" part="root">
            ${pt(r,e)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${t=>t.handleTextInput()}"
                @change="${t=>t.handleChange()}"
                ?autofocus="${t=>t.autofocus}"
                ?disabled="${t=>t.disabled}"
                list="${t=>t.list}"
                maxlength="${t=>t.maxlength}"
                minlength="${t=>t.minlength}"
                pattern="${t=>t.pattern}"
                placeholder="${t=>t.placeholder}"
                ?readonly="${t=>t.readOnly}"
                ?required="${t=>t.required}"
                size="${t=>t.size}"
                ?spellcheck="${t=>t.spellcheck}"
                :value="${t=>t.value}"
                type="${t=>t.type}"
                aria-atomic="${t=>t.ariaAtomic}"
                aria-busy="${t=>t.ariaBusy}"
                aria-controls="${t=>t.ariaControls}"
                aria-current="${t=>t.ariaCurrent}"
                aria-describedby="${t=>t.ariaDescribedby}"
                aria-details="${t=>t.ariaDetails}"
                aria-disabled="${t=>t.ariaDisabled}"
                aria-errormessage="${t=>t.ariaErrormessage}"
                aria-flowto="${t=>t.ariaFlowto}"
                aria-haspopup="${t=>t.ariaHaspopup}"
                aria-hidden="${t=>t.ariaHidden}"
                aria-invalid="${t=>t.ariaInvalid}"
                aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
                aria-label="${t=>t.ariaLabel}"
                aria-labelledby="${t=>t.ariaLabelledby}"
                aria-live="${t=>t.ariaLive}"
                aria-owns="${t=>t.ariaOwns}"
                aria-relevant="${t=>t.ariaRelevant}"
                aria-roledescription="${t=>t.ariaRoledescription}"
                ${we("control")}
            />
            ${ht(r,e)}
        </div>
    </template>
`});var o2=y(()=>{a();l();c();r2();kp()});var i2,n2=y(()=>{a();l();c();I();St();i2=(r,e)=>R`
    <template
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-orientation="${t=>t.orientation}"
        orientation="${t=>t.orientation}"
        role="toolbar"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        ${cs({property:"childItems",attributeFilter:["disabled","hidden"],filter:Er(),subtree:!0})}
    >
        <slot name="label"></slot>
        <div class="positioning-region" part="positioning-region">
            ${pt(r,e)}
            <slot
                ${Oe({filter:Er(),property:"slottedItems"})}
            ></slot>
            ${ht(r,e)}
        </div>
    </template>
`});var s2,ki,Ml,a2=y(()=>{a();l();c();Ie();I();pe();A0();De();md();St();Tr();ps();s2=Object.freeze({[us.ArrowUp]:{[gt.vertical]:-1},[us.ArrowDown]:{[gt.vertical]:1},[us.ArrowLeft]:{[gt.horizontal]:{[Ze.ltr]:-1,[Ze.rtl]:1}},[us.ArrowRight]:{[gt.horizontal]:{[Ze.ltr]:1,[Ze.rtl]:-1}}}),ki=class r extends B{constructor(){super(...arguments),this._activeIndex=0,this.direction=Ze.ltr,this.orientation=gt.horizontal}get activeIndex(){return ce.track(this,"activeIndex"),this._activeIndex}set activeIndex(e){this.$fastController.isConnected&&(this._activeIndex=hs(0,this.focusableElements.length-1,e),ce.notify(this,"activeIndex"))}slottedItemsChanged(){this.$fastController.isConnected&&this.reduceFocusableElements()}clickHandler(e){var t;let o=(t=this.focusableElements)===null||t===void 0?void 0:t.indexOf(e.target);return o>-1&&this.activeIndex!==o&&this.setFocusedElement(o),!0}childItemsChanged(e,t){this.$fastController.isConnected&&this.reduceFocusableElements()}connectedCallback(){super.connectedCallback(),this.direction=Lo(this)}focusinHandler(e){let t=e.relatedTarget;!t||this.contains(t)||this.setFocusedElement()}getDirectionalIncrementer(e){var t,o,i,n,s;return(s=(i=(o=(t=s2[e])===null||t===void 0?void 0:t[this.orientation])===null||o===void 0?void 0:o[this.direction])!==null&&i!==void 0?i:(n=s2[e])===null||n===void 0?void 0:n[this.orientation])!==null&&s!==void 0?s:0}keydownHandler(e){let t=e.key;if(!(t in us)||e.defaultPrevented||e.shiftKey)return!0;let o=this.getDirectionalIncrementer(t);if(!o)return!e.target.closest("[role=radiogroup]");let i=this.activeIndex+o;return this.focusableElements[i]&&e.preventDefault(),this.setFocusedElement(i),!0}get allSlottedItems(){return[...this.start.assignedElements(),...this.slottedItems,...this.end.assignedElements()]}reduceFocusableElements(){var e;let t=(e=this.focusableElements)===null||e===void 0?void 0:e[this.activeIndex];this.focusableElements=this.allSlottedItems.reduce(r.reduceFocusableItems,[]);let o=this.focusableElements.indexOf(t);this.activeIndex=Math.max(0,o),this.setFocusableElements()}setFocusedElement(e=this.activeIndex){var t;this.activeIndex=e,this.setFocusableElements(),(t=this.focusableElements[this.activeIndex])===null||t===void 0||t.focus()}static reduceFocusableItems(e,t){var o,i,n,s;let d=t.getAttribute("role")==="radio",u=(i=(o=t.$fastController)===null||o===void 0?void 0:o.definition.shadowOptions)===null||i===void 0?void 0:i.delegatesFocus,h=Array.from((s=(n=t.shadowRoot)===null||n===void 0?void 0:n.querySelectorAll("*"))!==null&&s!==void 0?s:[]).some(p=>I0(p));return!t.hasAttribute("disabled")&&!t.hasAttribute("hidden")&&(I0(t)||d||u||h)?(e.push(t),e):t.childElementCount?e.concat(Array.from(t.children).reduce(r.reduceFocusableItems,[])):e}setFocusableElements(){this.$fastController.isConnected&&this.focusableElements.length>0&&this.focusableElements.forEach((e,t)=>{e.tabIndex=this.activeIndex===t?0:-1})}};b([k],ki.prototype,"direction",void 0);b([w],ki.prototype,"orientation",void 0);b([k],ki.prototype,"slottedItems",void 0);b([k],ki.prototype,"slottedLabel",void 0);b([k],ki.prototype,"childItems",void 0);Ml=class{};b([w({attribute:"aria-labelledby"})],Ml.prototype,"ariaLabelledby",void 0);b([w({attribute:"aria-label"})],Ml.prototype,"ariaLabel",void 0);je(Ml,st);je(ki,mt,Ml)});var l2=y(()=>{a();l();c();n2();a2()});var c2,d2=y(()=>{a();l();c();I();gd();c2=(r,e)=>R`
        ${Qe(t=>t.tooltipVisible,R`
            <${r.tagFor(Re)}
                fixed-placement="true"
                auto-update-mode="${t=>t.autoUpdateMode}"
                vertical-positioning-mode="${t=>t.verticalPositioningMode}"
                vertical-default-position="${t=>t.verticalDefaultPosition}"
                vertical-inset="${t=>t.verticalInset}"
                vertical-scaling="${t=>t.verticalScaling}"
                horizontal-positioning-mode="${t=>t.horizontalPositioningMode}"
                horizontal-default-position="${t=>t.horizontalDefaultPosition}"
                horizontal-scaling="${t=>t.horizontalScaling}"
                horizontal-inset="${t=>t.horizontalInset}"
                vertical-viewport-lock="${t=>t.horizontalViewportLock}"
                horizontal-viewport-lock="${t=>t.verticalViewportLock}"
                dir="${t=>t.currentDirection}"
                ${we("region")}
            >
                <div class="tooltip" part="tooltip" role="tooltip">
                    <slot></slot>
                </div>
            </${r.tagFor(Re)}>
        `)}
    `});var co,u2=y(()=>{a();l();c();co={top:"top",right:"right",bottom:"bottom",left:"left",start:"start",end:"end",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",topStart:"top-start",topEnd:"top-end",bottomStart:"bottom-start",bottomEnd:"bottom-end"}});var Ht,h2=y(()=>{a();l();c();Ie();I();pe();ps();De();u2();Ht=class extends B{constructor(){super(...arguments),this.anchor="",this.delay=300,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.horizontalInset="false",this.verticalInset="false",this.horizontalScaling="content",this.verticalScaling="content",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition=void 0,this.tooltipVisible=!1,this.currentDirection=Ze.ltr,this.showDelayTimer=null,this.hideDelayTimer=null,this.isAnchorHoveredFocused=!1,this.isRegionHovered=!1,this.handlePositionChange=e=>{this.classList.toggle("top",this.region.verticalPosition==="start"),this.classList.toggle("bottom",this.region.verticalPosition==="end"),this.classList.toggle("inset-top",this.region.verticalPosition==="insetStart"),this.classList.toggle("inset-bottom",this.region.verticalPosition==="insetEnd"),this.classList.toggle("center-vertical",this.region.verticalPosition==="center"),this.classList.toggle("left",this.region.horizontalPosition==="start"),this.classList.toggle("right",this.region.horizontalPosition==="end"),this.classList.toggle("inset-left",this.region.horizontalPosition==="insetStart"),this.classList.toggle("inset-right",this.region.horizontalPosition==="insetEnd"),this.classList.toggle("center-horizontal",this.region.horizontalPosition==="center")},this.handleRegionMouseOver=e=>{this.isRegionHovered=!0},this.handleRegionMouseOut=e=>{this.isRegionHovered=!1,this.startHideDelayTimer()},this.handleAnchorMouseOver=e=>{if(this.tooltipVisible){this.isAnchorHoveredFocused=!0;return}this.startShowDelayTimer()},this.handleAnchorMouseOut=e=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.handleAnchorFocusIn=e=>{this.startShowDelayTimer()},this.handleAnchorFocusOut=e=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.startHideDelayTimer=()=>{this.clearHideDelayTimer(),this.tooltipVisible&&(this.hideDelayTimer=window.setTimeout(()=>{this.updateTooltipVisibility()},60))},this.clearHideDelayTimer=()=>{this.hideDelayTimer!==null&&(clearTimeout(this.hideDelayTimer),this.hideDelayTimer=null)},this.startShowDelayTimer=()=>{if(!this.isAnchorHoveredFocused){if(this.delay>1){this.showDelayTimer===null&&(this.showDelayTimer=window.setTimeout(()=>{this.startHover()},this.delay));return}this.startHover()}},this.startHover=()=>{this.isAnchorHoveredFocused=!0,this.updateTooltipVisibility()},this.clearShowDelayTimer=()=>{this.showDelayTimer!==null&&(clearTimeout(this.showDelayTimer),this.showDelayTimer=null)},this.getAnchor=()=>{let e=this.getRootNode();return e instanceof ShadowRoot?e.getElementById(this.anchor):document.getElementById(this.anchor)},this.handleDocumentKeydown=e=>{if(!e.defaultPrevented&&this.tooltipVisible)switch(e.key){case bo:this.isAnchorHoveredFocused=!1,this.updateTooltipVisibility(),this.$emit("dismiss");break}},this.updateTooltipVisibility=()=>{if(this.visible===!1)this.hideTooltip();else if(this.visible===!0){this.showTooltip();return}else{if(this.isAnchorHoveredFocused||this.isRegionHovered){this.showTooltip();return}this.hideTooltip()}},this.showTooltip=()=>{this.tooltipVisible||(this.currentDirection=Lo(this),this.tooltipVisible=!0,document.addEventListener("keydown",this.handleDocumentKeydown),W.queueUpdate(this.setRegionProps))},this.hideTooltip=()=>{this.tooltipVisible&&(this.clearHideDelayTimer(),this.region!==null&&this.region!==void 0&&(this.region.removeEventListener("positionchange",this.handlePositionChange),this.region.viewportElement=null,this.region.anchorElement=null,this.region.removeEventListener("mouseover",this.handleRegionMouseOver),this.region.removeEventListener("mouseout",this.handleRegionMouseOut)),document.removeEventListener("keydown",this.handleDocumentKeydown),this.tooltipVisible=!1)},this.setRegionProps=()=>{this.tooltipVisible&&(this.region.viewportElement=this.viewportElement,this.region.anchorElement=this.anchorElement,this.region.addEventListener("positionchange",this.handlePositionChange),this.region.addEventListener("mouseover",this.handleRegionMouseOver,{passive:!0}),this.region.addEventListener("mouseout",this.handleRegionMouseOut,{passive:!0}))}}visibleChanged(){this.$fastController.isConnected&&(this.updateTooltipVisibility(),this.updateLayout())}anchorChanged(){this.$fastController.isConnected&&(this.anchorElement=this.getAnchor())}positionChanged(){this.$fastController.isConnected&&this.updateLayout()}anchorElementChanged(e){if(this.$fastController.isConnected){if(e!=null&&(e.removeEventListener("mouseover",this.handleAnchorMouseOver),e.removeEventListener("mouseout",this.handleAnchorMouseOut),e.removeEventListener("focusin",this.handleAnchorFocusIn),e.removeEventListener("focusout",this.handleAnchorFocusOut)),this.anchorElement!==null&&this.anchorElement!==void 0){this.anchorElement.addEventListener("mouseover",this.handleAnchorMouseOver,{passive:!0}),this.anchorElement.addEventListener("mouseout",this.handleAnchorMouseOut,{passive:!0}),this.anchorElement.addEventListener("focusin",this.handleAnchorFocusIn,{passive:!0}),this.anchorElement.addEventListener("focusout",this.handleAnchorFocusOut,{passive:!0});let t=this.anchorElement.id;this.anchorElement.parentElement!==null&&this.anchorElement.parentElement.querySelectorAll(":hover").forEach(o=>{o.id===t&&this.startShowDelayTimer()})}this.region!==null&&this.region!==void 0&&this.tooltipVisible&&(this.region.anchorElement=this.anchorElement),this.updateLayout()}}viewportElementChanged(){this.region!==null&&this.region!==void 0&&(this.region.viewportElement=this.viewportElement),this.updateLayout()}connectedCallback(){super.connectedCallback(),this.anchorElement=this.getAnchor(),this.updateTooltipVisibility()}disconnectedCallback(){this.hideTooltip(),this.clearShowDelayTimer(),this.clearHideDelayTimer(),super.disconnectedCallback()}updateLayout(){switch(this.verticalPositioningMode="locktodefault",this.horizontalPositioningMode="locktodefault",this.position){case co.top:case co.bottom:this.verticalDefaultPosition=this.position,this.horizontalDefaultPosition="center";break;case co.right:case co.left:case co.start:case co.end:this.verticalDefaultPosition="center",this.horizontalDefaultPosition=this.position;break;case co.topLeft:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="left";break;case co.topRight:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="right";break;case co.bottomLeft:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="left";break;case co.bottomRight:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="right";break;case co.topStart:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="start";break;case co.topEnd:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="end";break;case co.bottomStart:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="start";break;case co.bottomEnd:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="end";break;default:this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition="center";break}}};b([w({mode:"boolean"})],Ht.prototype,"visible",void 0);b([w],Ht.prototype,"anchor",void 0);b([w],Ht.prototype,"delay",void 0);b([w],Ht.prototype,"position",void 0);b([w({attribute:"auto-update-mode"})],Ht.prototype,"autoUpdateMode",void 0);b([w({attribute:"horizontal-viewport-lock"})],Ht.prototype,"horizontalViewportLock",void 0);b([w({attribute:"vertical-viewport-lock"})],Ht.prototype,"verticalViewportLock",void 0);b([k],Ht.prototype,"anchorElement",void 0);b([k],Ht.prototype,"viewportElement",void 0);b([k],Ht.prototype,"verticalPositioningMode",void 0);b([k],Ht.prototype,"horizontalPositioningMode",void 0);b([k],Ht.prototype,"horizontalInset",void 0);b([k],Ht.prototype,"verticalInset",void 0);b([k],Ht.prototype,"horizontalScaling",void 0);b([k],Ht.prototype,"verticalScaling",void 0);b([k],Ht.prototype,"verticalDefaultPosition",void 0);b([k],Ht.prototype,"horizontalDefaultPosition",void 0);b([k],Ht.prototype,"tooltipVisible",void 0);b([k],Ht.prototype,"currentDirection",void 0)});var p2=y(()=>{a();l();c();d2();h2()});var f2,m2=y(()=>{a();l();c();I();St();f2=(r,e)=>R`
    <template
        role="treeitem"
        slot="${t=>t.isNestedItem()?"item":void 0}"
        tabindex="-1"
        class="${t=>t.expanded?"expanded":""} ${t=>t.selected?"selected":""} ${t=>t.nested?"nested":""}
            ${t=>t.disabled?"disabled":""}"
        aria-expanded="${t=>t.childItems&&t.childItemLength()>0?t.expanded:void 0}"
        aria-selected="${t=>t.selected}"
        aria-disabled="${t=>t.disabled}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        ${cs({property:"childItems",filter:Er()})}
    >
        <div class="positioning-region" part="positioning-region">
            <div class="content-region" part="content-region">
                ${Qe(t=>t.childItems&&t.childItemLength()>0,R`
                        <div
                            aria-hidden="true"
                            class="expand-collapse-button"
                            part="expand-collapse-button"
                            @click="${(t,o)=>t.handleExpandCollapseButtonClick(o.event)}"
                            ${we("expandCollapseButton")}
                        >
                            <slot name="expand-collapse-glyph">
                                ${e.expandCollapseGlyph||""}
                            </slot>
                        </div>
                    `)}
                ${pt(r,e)}
                <slot></slot>
                ${ht(r,e)}
            </div>
        </div>
        ${Qe(t=>t.childItems&&t.childItemLength()>0&&(t.expanded||t.renderCollapsedChildren),R`
                <div role="group" class="items" part="items">
                    <slot name="item" ${Oe("items")}></slot>
                </div>
            `)}
    </template>
`});function Rn(r){return qi(r)&&r.getAttribute("role")==="treeitem"}var Ut,K0=y(()=>{a();l();c();Ie();I();pe();St();Tr();De();Ut=class extends B{constructor(){super(...arguments),this.expanded=!1,this.focusable=!1,this.isNestedItem=()=>Rn(this.parentElement),this.handleExpandCollapseButtonClick=e=>{!this.disabled&&!e.defaultPrevented&&(this.expanded=!this.expanded)},this.handleFocus=e=>{this.setAttribute("tabindex","0")},this.handleBlur=e=>{this.setAttribute("tabindex","-1")}}expandedChanged(){this.$fastController.isConnected&&this.$emit("expanded-change",this)}selectedChanged(){this.$fastController.isConnected&&this.$emit("selected-change",this)}itemsChanged(e,t){this.$fastController.isConnected&&this.items.forEach(o=>{Rn(o)&&(o.nested=!0)})}static focusItem(e){e.focusable=!0,e.focus()}childItemLength(){let e=this.childItems.filter(t=>Rn(t));return e?e.length:0}};b([w({mode:"boolean"})],Ut.prototype,"expanded",void 0);b([w({mode:"boolean"})],Ut.prototype,"selected",void 0);b([w({mode:"boolean"})],Ut.prototype,"disabled",void 0);b([k],Ut.prototype,"focusable",void 0);b([k],Ut.prototype,"childItems",void 0);b([k],Ut.prototype,"items",void 0);b([k],Ut.prototype,"nested",void 0);b([k],Ut.prototype,"renderCollapsedChildren",void 0);je(Ut,mt)});var g2=y(()=>{a();l();c();m2();K0()});var v2,y2=y(()=>{a();l();c();I();v2=(r,e)=>R`
    <template
        role="tree"
        ${we("treeView")}
        @keydown="${(t,o)=>t.handleKeyDown(o.event)}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        @click="${(t,o)=>t.handleClick(o.event)}"
        @selected-change="${(t,o)=>t.handleSelectedChange(o.event)}"
    >
        <slot ${Oe("slottedTreeItems")}></slot>
    </template>
`});var Ma,b2=y(()=>{a();l();c();Ie();I();pe();K0();De();Ma=class extends B{constructor(){super(...arguments),this.currentFocused=null,this.handleFocus=e=>{if(!(this.slottedTreeItems.length<1)){if(e.target===this){this.currentFocused===null&&(this.currentFocused=this.getValidFocusableItem()),this.currentFocused!==null&&Ut.focusItem(this.currentFocused);return}this.contains(e.target)&&(this.setAttribute("tabindex","-1"),this.currentFocused=e.target)}},this.handleBlur=e=>{e.target instanceof HTMLElement&&(e.relatedTarget===null||!this.contains(e.relatedTarget))&&this.setAttribute("tabindex","0")},this.handleKeyDown=e=>{if(e.defaultPrevented)return;if(this.slottedTreeItems.length<1)return!0;let t=this.getVisibleNodes();switch(e.key){case lr:t.length&&Ut.focusItem(t[0]);return;case cr:t.length&&Ut.focusItem(t[t.length-1]);return;case Wr:if(e.target&&this.isFocusableElement(e.target)){let o=e.target;o instanceof Ut&&o.childItemLength()>0&&o.expanded?o.expanded=!1:o instanceof Ut&&o.parentElement instanceof Ut&&Ut.focusItem(o.parentElement)}return!1;case Qr:if(e.target&&this.isFocusableElement(e.target)){let o=e.target;o instanceof Ut&&o.childItemLength()>0&&!o.expanded?o.expanded=!0:o instanceof Ut&&o.childItemLength()>0&&this.focusNextNode(1,e.target)}return;case Mt:e.target&&this.isFocusableElement(e.target)&&this.focusNextNode(1,e.target);return;case Ft:e.target&&this.isFocusableElement(e.target)&&this.focusNextNode(-1,e.target);return;case Zt:this.handleClick(e);return}return!0},this.handleSelectedChange=e=>{if(e.defaultPrevented)return;if(!(e.target instanceof Element)||!Rn(e.target))return!0;let t=e.target;t.selected?(this.currentSelected&&this.currentSelected!==t&&(this.currentSelected.selected=!1),this.currentSelected=t):!t.selected&&this.currentSelected===t&&(this.currentSelected=null)},this.setItems=()=>{let e=this.treeView.querySelector("[aria-selected='true']");this.currentSelected=e,(this.currentFocused===null||!this.contains(this.currentFocused))&&(this.currentFocused=this.getValidFocusableItem()),this.nested=this.checkForNestedItems(),this.getVisibleNodes().forEach(o=>{Rn(o)&&(o.nested=this.nested)})},this.isFocusableElement=e=>Rn(e),this.isSelectedElement=e=>e.selected}slottedTreeItemsChanged(){this.$fastController.isConnected&&this.setItems()}connectedCallback(){super.connectedCallback(),this.setAttribute("tabindex","0"),W.queueUpdate(()=>{this.setItems()})}handleClick(e){if(e.defaultPrevented)return;if(!(e.target instanceof Element)||!Rn(e.target))return!0;let t=e.target;t.disabled||(t.selected=!t.selected)}focusNextNode(e,t){let o=this.getVisibleNodes();if(!o)return;let i=o[o.indexOf(t)+e];qi(i)&&Ut.focusItem(i)}getValidFocusableItem(){let e=this.getVisibleNodes(),t=e.findIndex(this.isSelectedElement);return t===-1&&(t=e.findIndex(this.isFocusableElement)),t!==-1?e[t]:null}checkForNestedItems(){return this.slottedTreeItems.some(e=>Rn(e)&&e.querySelector("[role='treeitem']"))}getVisibleNodes(){return m_(this,"[role='treeitem']")||[]}};b([w({attribute:"render-collapsed-nodes"})],Ma.prototype,"renderCollapsedNodes",void 0);b([k],Ma.prototype,"currentSelected",void 0);b([k],Ma.prototype,"slottedTreeItems",void 0)});var C2=y(()=>{a();l();c();y2();b2()});var W0,Pd,de,k9e,I9e,w2=y(()=>{a();l();c();W0=class{constructor(e){this.listenerCache=new WeakMap,this.query=e}bind(e){let{query:t}=this,o=this.constructListener(e);o.bind(t)(),t.addListener(o),this.listenerCache.set(e,o)}unbind(e){let t=this.listenerCache.get(e);t&&(this.query.removeListener(t),this.listenerCache.delete(e))}},Pd=class r extends W0{constructor(e,t){super(e),this.styles=t}static with(e){return t=>new r(e,t)}constructListener(e){let t=!1,o=this.styles;return function(){let{matches:n}=this;n&&!t?(e.$fastController.addStyles(o),t=n):!n&&t&&(e.$fastController.removeStyles(o),t=n)}}unbind(e){super.unbind(e),e.$fastController.removeStyles(this.styles)}},de=Pd.with(window.matchMedia("(forced-colors)")),k9e=Pd.with(window.matchMedia("(prefers-color-scheme: dark)")),I9e=Pd.with(window.matchMedia("(prefers-color-scheme: light)"))});var Up,x2=y(()=>{a();l();c();I();Up=class{constructor(e,t,o){this.propertyName=e,this.value=t,this.styles=o}bind(e){ce.getNotifier(e).subscribe(this,this.propertyName),this.handleChange(e,this.propertyName)}unbind(e){ce.getNotifier(e).unsubscribe(this,this.propertyName),e.$fastController.removeStyles(this.styles)}handleChange(e,t){e[t]===this.value?e.$fastController.addStyles(this.styles):e.$fastController.removeStyles(this.styles)}}});var Bt,S2=y(()=>{a();l();c();Bt="not-allowed"});function ne(r){return`${y6}:host{display:${r}}`}var y6,_2=y(()=>{a();l();c();y6=":host([hidden]){display:none}"});var me,E2=y(()=>{a();l();c();pe();me=g_()?"focus-visible":"focus"});var T2=y(()=>{a();l();c();S2();_2();E2()});var k2=y(()=>{a();l();c();Tr();gp();u0();w2();x2();T2();ps();Rp()});var j=y(()=>{a();l();c();n_();F_();D_();Jv();G_();Q_();J_();rE();uE();SE();kE();OE();LE();i0();UE();w0();BE();VE();ZE();JE();tT();aT();uT();hT();pT();gT();bT();kT();D0();MT();VT();xa();jT();YT();ek();nk();ck();pk();yk();xk();Tk();Pk();Dk();Uk();qk();Qk();e2();o2();l2();p2();g2();C2();k2()});function oi(r,e,t){return isNaN(r)||r<=e?e:r>=t?t:r}function Bp(r,e,t){return isNaN(r)||r<=e?0:r>=t?1:r/(t-e)}function xs(r,e,t){return isNaN(r)?e:e+r*(t-e)}function Q0(r){return r*(Math.PI/180)}function I2(r){return r*(180/Math.PI)}function A2(r){let e=Math.round(oi(r,0,255)).toString(16);return e.length===1?"0"+e:e}function Br(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:e+r*(t-e)}function Vp(r,e,t){if(r<=0)return e%360;if(r>=1)return t%360;let o=(e-t+360)%360,i=(t-e+360)%360;return o<=i?(e-o*r+360)%360:(e+o*r+360)%360}function wt(r,e){let t=Math.pow(10,e);return Math.round(r*t)/t}var CFe,ii=y(()=>{a();l();c();CFe=Math.PI*2});var ni,Fl=y(()=>{a();l();c();ii();ni=class r{constructor(e,t,o){this.h=e,this.s=t,this.l=o}static fromObject(e){return e&&!isNaN(e.h)&&!isNaN(e.s)&&!isNaN(e.l)?new r(e.h,e.s,e.l):null}equalValue(e){return this.h===e.h&&this.s===e.s&&this.l===e.l}roundToPrecision(e){return new r(wt(this.h,e),wt(this.s,e),wt(this.l,e))}toObject(){return{h:this.h,s:this.s,l:this.l}}}});var Dl,zp=y(()=>{a();l();c();ii();Dl=class r{constructor(e,t,o){this.h=e,this.s=t,this.v=o}static fromObject(e){return e&&!isNaN(e.h)&&!isNaN(e.s)&&!isNaN(e.v)?new r(e.h,e.s,e.v):null}equalValue(e){return this.h===e.h&&this.s===e.s&&this.v===e.v}roundToPrecision(e){return new r(wt(this.h,e),wt(this.s,e),wt(this.v,e))}toObject(){return{h:this.h,s:this.s,v:this.v}}}});var jt,Od=y(()=>{a();l();c();ii();jt=class r{constructor(e,t,o){this.l=e,this.a=t,this.b=o}static fromObject(e){return e&&!isNaN(e.l)&&!isNaN(e.a)&&!isNaN(e.b)?new r(e.l,e.a,e.b):null}equalValue(e){return this.l===e.l&&this.a===e.a&&this.b===e.b}roundToPrecision(e){return new r(wt(this.l,e),wt(this.a,e),wt(this.b,e))}toObject(){return{l:this.l,a:this.a,b:this.b}}};jt.epsilon=216/24389;jt.kappa=24389/27});var Ss,$d=y(()=>{a();l();c();ii();Ss=class r{constructor(e,t,o){this.l=e,this.c=t,this.h=o}static fromObject(e){return e&&!isNaN(e.l)&&!isNaN(e.c)&&!isNaN(e.h)?new r(e.l,e.c,e.h):null}equalValue(e){return this.l===e.l&&this.c===e.c&&this.h===e.h}roundToPrecision(e){return new r(wt(this.l,e),wt(this.c,e),wt(this.h,e))}toObject(){return{l:this.l,c:this.c,h:this.h}}}});var Ke,Ki=y(()=>{a();l();c();ii();Ke=class r{constructor(e,t,o,i){this.r=e,this.g=t,this.b=o,this.a=typeof i=="number"&&!isNaN(i)?i:1}static fromObject(e){return e&&!isNaN(e.r)&&!isNaN(e.g)&&!isNaN(e.b)?new r(e.r,e.g,e.b,e.a):null}equalValue(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}toStringHexRGB(){return"#"+[this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringHexRGBA(){return this.toStringHexRGB()+this.formatHexValue(this.a)}toStringHexARGB(){return"#"+[this.a,this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringWebRGB(){return`rgb(${Math.round(xs(this.r,0,255))},${Math.round(xs(this.g,0,255))},${Math.round(xs(this.b,0,255))})`}toStringWebRGBA(){return`rgba(${Math.round(xs(this.r,0,255))},${Math.round(xs(this.g,0,255))},${Math.round(xs(this.b,0,255))},${oi(this.a,0,1)})`}roundToPrecision(e){return new r(wt(this.r,e),wt(this.g,e),wt(this.b,e),wt(this.a,e))}clamp(){return new r(oi(this.r,0,1),oi(this.g,0,1),oi(this.b,0,1),oi(this.a,0,1))}toObject(){return{r:this.r,g:this.g,b:this.b,a:this.a}}formatHexValue(e){return A2(xs(e,0,255))}}});var uo,qp=y(()=>{a();l();c();ii();uo=class r{constructor(e,t,o){this.x=e,this.y=t,this.z=o}static fromObject(e){return e&&!isNaN(e.x)&&!isNaN(e.y)&&!isNaN(e.z)?new r(e.x,e.y,e.z):null}equalValue(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}roundToPrecision(e){return new r(wt(this.x,e),wt(this.y,e),wt(this.z,e))}toObject(){return{x:this.x,y:this.y,z:this.z}}};uo.whitePoint=new uo(.95047,1,1.08883)});function Gp(r){return r.r*.2126+r.g*.7152+r.b*.0722}function Ll(r){function e(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}return Gp(new Ke(e(r.r),e(r.g),e(r.b),1))}function J0(r,e){let t=Ll(r),o=Ll(e);return t>o?R2(t,o):R2(o,t)}function Y0(r,e,t){return t-e===0?0:(r-e)/(t-e)}function Z0(r,e,t){let o=Y0(r.r,e.r,t.r),i=Y0(r.g,e.g,t.g),n=Y0(r.b,e.b,t.b);return(o+i+n)/3}function P2(r,e,t=null){let o=0,i=t;return i!==null?o=Z0(r,e,i):(i=new Ke(0,0,0,1),o=Z0(r,e,i),o<=0&&(i=new Ke(1,1,1,1),o=Z0(r,e,i))),o=Math.round(o*1e3)/1e3,new Ke(i.r,i.g,i.b,o)}function No(r){let e=Math.max(r.r,r.g,r.b),t=Math.min(r.r,r.g,r.b),o=e-t,i=0;o!==0&&(e===r.r?i=60*((r.g-r.b)/o%6):e===r.g?i=60*((r.b-r.r)/o+2):i=60*((r.r-r.g)/o+4)),i<0&&(i+=360);let n=(e+t)/2,s=0;return o!==0&&(s=o/(1-Math.abs(2*n-1))),new ni(i,s,n)}function _s(r,e=1){let t=(1-Math.abs(2*r.l-1))*r.s,o=t*(1-Math.abs(r.h/60%2-1)),i=r.l-t/2,n=0,s=0,d=0;return r.h<60?(n=t,s=o,d=0):r.h<120?(n=o,s=t,d=0):r.h<180?(n=0,s=t,d=o):r.h<240?(n=0,s=o,d=t):r.h<300?(n=o,s=0,d=t):r.h<360&&(n=t,s=0,d=o),new Ke(n+i,s+i,d+i,e)}function X0(r){let e=Math.max(r.r,r.g,r.b),t=Math.min(r.r,r.g,r.b),o=e-t,i=0;o!==0&&(e===r.r?i=60*((r.g-r.b)/o%6):e===r.g?i=60*((r.b-r.r)/o+2):i=60*((r.r-r.g)/o+4)),i<0&&(i+=360);let n=0;return e!==0&&(n=o/e),new Dl(i,n,e)}function O2(r,e=1){let t=r.s*r.v,o=t*(1-Math.abs(r.h/60%2-1)),i=r.v-t,n=0,s=0,d=0;return r.h<60?(n=t,s=o,d=0):r.h<120?(n=o,s=t,d=0):r.h<180?(n=0,s=t,d=o):r.h<240?(n=0,s=o,d=t):r.h<300?(n=o,s=0,d=t):r.h<360&&(n=t,s=0,d=o),new Ke(n+i,s+i,d+i,e)}function b6(r){let e=0,t=0;return r.h!==0&&(e=Math.cos(Q0(r.h))*r.c,t=Math.sin(Q0(r.h))*r.c),new jt(r.l,e,t)}function C6(r){let e=0;(Math.abs(r.b)>.001||Math.abs(r.a)>.001)&&(e=I2(Math.atan2(r.b,r.a))),e<0&&(e+=360);let t=Math.sqrt(r.a*r.a+r.b*r.b);return new Ss(r.l,t,e)}function w6(r){let e=(r.l+16)/116,t=e+r.a/500,o=e-r.b/200,i=Math.pow(t,3),n=Math.pow(e,3),s=Math.pow(o,3),d=0;i>jt.epsilon?d=i:d=(116*t-16)/jt.kappa;let u=0;r.l>jt.epsilon*jt.kappa?u=n:u=r.l/jt.kappa;let h=0;return s>jt.epsilon?h=s:h=(116*o-16)/jt.kappa,d=uo.whitePoint.x*d,u=uo.whitePoint.y*u,h=uo.whitePoint.z*h,new uo(d,u,h)}function x6(r){function e(u){return u>jt.epsilon?Math.pow(u,1/3):(jt.kappa*u+16)/116}let t=e(r.x/uo.whitePoint.x),o=e(r.y/uo.whitePoint.y),i=e(r.z/uo.whitePoint.z),n=116*o-16,s=500*(t-o),d=200*(o-i);return new jt(n,s,d)}function jp(r){function e(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}let t=e(r.r),o=e(r.g),i=e(r.b),n=t*.4124564+o*.3575761+i*.1804375,s=t*.2126729+o*.7151522+i*.072175,d=t*.0193339+o*.119192+i*.9503041;return new uo(n,s,d)}function ey(r,e=1){function t(s){return s<=.0031308?s*12.92:1.055*Math.pow(s,1/2.4)-.055}let o=t(r.x*3.2404542-r.y*1.5371385-r.z*.4985314),i=t(r.x*-.969266+r.y*1.8760108+r.z*.041556),n=t(r.x*.0556434-r.y*.2040259+r.z*1.0572252);return new Ke(o,i,n,e)}function Fa(r){return x6(jp(r))}function Es(r,e=1){return ey(w6(r),e)}function Md(r){return C6(Fa(r))}function Kp(r,e=1){return Es(b6(r),e)}var R2,Ts=y(()=>{a();l();c();Fl();zp();Od();$d();Ki();qp();ii();R2=(r,e)=>(r+.05)/(e+.05)});function oy(r,e,t=18){let o=Md(r),i=o.c+e*t;return i<0&&(i=0),Kp(new Ss(o.l,i,o.h))}function ty(r,e){return r*e}function iy(r,e){return new Ke(ty(r.r,e.r),ty(r.g,e.g),ty(r.b,e.b),1)}function ry(r,e){return r<.5?oi(2*e*r,0,1):oi(1-2*(1-e)*(1-r),0,1)}function ny(r,e){return new Ke(ry(r.r,e.r),ry(r.g,e.g),ry(r.b,e.b),1)}function M2(r,e){if(e.a>=1)return e;if(e.a<=0)return new Ke(r.r,r.g,r.b,1);let t=e.a*e.r+(1-e.a)*r.r,o=e.a*e.g+(1-e.a)*r.g,i=e.a*e.b+(1-e.a)*r.b;return new Ke(t,o,i,1)}var $2,sy=y(()=>{a();l();c();Ts();Fl();Od();$d();Ki();ii();(function(r){r[r.Burn=0]="Burn",r[r.Color=1]="Color",r[r.Darken=2]="Darken",r[r.Dodge=3]="Dodge",r[r.Lighten=4]="Lighten",r[r.Multiply=5]="Multiply",r[r.Overlay=6]="Overlay",r[r.Screen=7]="Screen"})($2||($2={}))});function Nl(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Ke(Br(r,e.r,t.r),Br(r,e.g,t.g),Br(r,e.b,t.b),Br(r,e.a,t.a))}function S6(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new ni(Vp(r,e.h,t.h),Br(r,e.s,t.s),Br(r,e.l,t.l))}function _6(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Dl(Vp(r,e.h,t.h),Br(r,e.s,t.s),Br(r,e.v,t.v))}function E6(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new uo(Br(r,e.x,t.x),Br(r,e.y,t.y),Br(r,e.z,t.z))}function T6(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new jt(Br(r,e.l,t.l),Br(r,e.a,t.a),Br(r,e.b,t.b))}function k6(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Ss(Br(r,e.l,t.l),Br(r,e.c,t.c),Vp(r,e.h,t.h))}function Da(r,e,t,o){if(isNaN(r)||r<=0)return t;if(r>=1)return o;switch(e){case Zr.HSL:return _s(S6(r,No(t),No(o)));case Zr.HSV:return O2(_6(r,X0(t),X0(o)));case Zr.XYZ:return ey(E6(r,jp(t),jp(o)));case Zr.LAB:return Es(T6(r,Fa(t),Fa(o)));case Zr.LCH:return Kp(k6(r,Md(t),Md(o)));default:return Nl(r,t,o)}}var Zr,Fd=y(()=>{a();l();c();Ts();Fl();zp();Od();$d();Ki();qp();ii();(function(r){r[r.RGB=0]="RGB",r[r.HSL=1]="HSL",r[r.HSV=2]="HSV",r[r.XYZ=3]="XYZ",r[r.LAB=4]="LAB",r[r.LCH=5]="LCH"})(Zr||(Zr={}))});var Wi,Wp=y(()=>{a();l();c();Ts();Fd();Wi=class r{constructor(e){if(e==null||e.length===0)throw new Error("The stops argument must be non-empty");this.stops=this.sortColorScaleStops(e)}static createBalancedColorScale(e){if(e==null||e.length===0)throw new Error("The colors argument must be non-empty");let t=new Array(e.length);for(let o=0;o<e.length;o++)o===0?t[o]={color:e[o],position:0}:o===e.length-1?t[o]={color:e[o],position:1}:t[o]={color:e[o],position:o*(1/(e.length-1))};return new r(t)}getColor(e,t=Zr.RGB){if(this.stops.length===1)return this.stops[0].color;if(e<=0)return this.stops[0].color;if(e>=1)return this.stops[this.stops.length-1].color;let o=0;for(let s=0;s<this.stops.length;s++)this.stops[s].position<=e&&(o=s);let i=o+1;i>=this.stops.length&&(i=this.stops.length-1);let n=(e-this.stops[o].position)*(1/(this.stops[i].position-this.stops[o].position));return Da(n,t,this.stops[o].color,this.stops[i].color)}trim(e,t,o=Zr.RGB){if(e<0||t>1||t<e)throw new Error("Invalid bounds");if(e===t)return new r([{color:this.getColor(e,o),position:0}]);let i=[];for(let d=0;d<this.stops.length;d++)this.stops[d].position>=e&&this.stops[d].position<=t&&i.push(this.stops[d]);if(i.length===0)return new r([{color:this.getColor(e),position:e},{color:this.getColor(t),position:t}]);i[0].position!==e&&i.unshift({color:this.getColor(e),position:e}),i[i.length-1].position!==t&&i.push({color:this.getColor(t),position:t});let n=t-e,s=new Array(i.length);for(let d=0;d<i.length;d++)s[d]={color:i[d].color,position:(i[d].position-e)/n};return new r(s)}findNextColor(e,t,o=!1,i=Zr.RGB,n=.005,s=32){isNaN(e)||e<=0?e=0:e>=1&&(e=1);let d=this.getColor(e,i),u=o?0:1,h=this.getColor(u,i);if(J0(d,h)<=t)return u;let v=o?0:e,C=o?e:0,x=u,E=0;for(;E<=s;){x=Math.abs(C-v)/2+v;let O=this.getColor(x,i),q=J0(d,O);if(Math.abs(q-t)<=n)return x;q>t?o?v=x:C=x:o?C=x:v=x,E++}return x}clone(){let e=new Array(this.stops.length);for(let t=0;t<e.length;t++)e[t]={color:this.stops[t].color,position:this.stops[t].position};return new r(e)}sortColorScaleStops(e){return e.sort((t,o)=>{let i=t.position,n=o.position;return i<n?-1:i>n?1:0})}}});var F2=y(()=>{a();l();c()});function Jr(r){let e=I6.exec(r);if(e===null)return null;let t=e[1];if(t.length===3){let i=t.charAt(0),n=t.charAt(1),s=t.charAt(2);t=i.concat(i,n,n,s,s)}let o=parseInt(t,16);return isNaN(o)?null:new Ke(Bp((o&16711680)>>>16,0,255),Bp((o&65280)>>>8,0,255),Bp(o&255,0,255),1)}var I6,Qp=y(()=>{a();l();c();Ki();ii();F2();I6=/^#((?:[0-9a-f]{6}|[0-9a-f]{3}))$/i});var Pn,iDe,ay=y(()=>{a();l();c();sy();Ts();Fd();Ki();Wp();Qp();Pn=class r{constructor(e){this.config=Object.assign({},r.defaultPaletteConfig,e),this.palette=[],this.updatePaletteColors()}updatePaletteGenerationValues(e){let t=!1;for(let o in e)this.config[o]&&(this.config[o].equalValue?this.config[o].equalValue(e[o])||(this.config[o]=e[o],t=!0):e[o]!==this.config[o]&&(this.config[o]=e[o],t=!0));return t&&this.updatePaletteColors(),t}updatePaletteColors(){let e=this.generatePaletteColorScale();for(let t=0;t<this.config.steps;t++)this.palette[t]=e.getColor(t/(this.config.steps-1),this.config.interpolationMode)}generatePaletteColorScale(){let e=No(this.config.baseColor),o=new Wi([{position:0,color:this.config.scaleColorLight},{position:.5,color:this.config.baseColor},{position:1,color:this.config.scaleColorDark}]).trim(this.config.clipLight,1-this.config.clipDark),i=o.getColor(0),n=o.getColor(1),s=i,d=n;if(e.s>=this.config.saturationAdjustmentCutoff&&(s=oy(s,this.config.saturationLight),d=oy(d,this.config.saturationDark)),this.config.multiplyLight!==0){let u=iy(this.config.baseColor,s);s=Da(this.config.multiplyLight,this.config.interpolationMode,s,u)}if(this.config.multiplyDark!==0){let u=iy(this.config.baseColor,d);d=Da(this.config.multiplyDark,this.config.interpolationMode,d,u)}if(this.config.overlayLight!==0){let u=ny(this.config.baseColor,s);s=Da(this.config.overlayLight,this.config.interpolationMode,s,u)}if(this.config.overlayDark!==0){let u=ny(this.config.baseColor,d);d=Da(this.config.overlayDark,this.config.interpolationMode,d,u)}return this.config.baseScalePosition?this.config.baseScalePosition<=0?new Wi([{position:0,color:this.config.baseColor},{position:1,color:d.clamp()}]):this.config.baseScalePosition>=1?new Wi([{position:0,color:s.clamp()},{position:1,color:this.config.baseColor}]):new Wi([{position:0,color:s.clamp()},{position:this.config.baseScalePosition,color:this.config.baseColor},{position:1,color:d.clamp()}]):new Wi([{position:0,color:s.clamp()},{position:.5,color:this.config.baseColor},{position:1,color:d.clamp()}])}};Pn.defaultPaletteConfig={baseColor:Jr("#808080"),steps:11,interpolationMode:Zr.RGB,scaleColorLight:new Ke(1,1,1,1),scaleColorDark:new Ke(0,0,0,1),clipLight:.185,clipDark:.16,saturationAdjustmentCutoff:.05,saturationLight:.35,saturationDark:1.25,overlayLight:0,overlayDark:.25,multiplyLight:0,multiplyDark:0,baseScalePosition:.5};Pn.greyscalePaletteConfig={baseColor:Jr("#808080"),steps:11,interpolationMode:Zr.RGB,scaleColorLight:new Ke(1,1,1,1),scaleColorDark:new Ke(0,0,0,1),clipLight:0,clipDark:0,saturationAdjustmentCutoff:0,saturationLight:0,saturationDark:0,overlayLight:0,overlayDark:0,multiplyLight:0,multiplyDark:0,baseScalePosition:.5};iDe={targetSize:63,spacing:4,scaleColorLight:Pn.defaultPaletteConfig.scaleColorLight,scaleColorDark:Pn.defaultPaletteConfig.scaleColorDark}});var ly=y(()=>{a();l();c()});var cy=y(()=>{a();l();c();Ki()});var D2=y(()=>{a();l();c();ly();cy()});var dy,L2=y(()=>{a();l();c();Ki();ay();Ts();Wp();Fl();Fd();Qp();dy=class r{constructor(e){this.palette=[],this.config=Object.assign({},r.defaultPaletteConfig,e),this.regenPalettes()}regenPalettes(){let e=this.config.steps;(isNaN(e)||e<3)&&(e=3);let t=.14,o=.06,i=new Ke(t,t,t,1),n=94,d=new Pn(Object.assign(Object.assign({},Pn.greyscalePaletteConfig),{baseColor:i,baseScalePosition:(1-t)*100/n,steps:e})).palette,u=Gp(this.config.baseColor),h=No(this.config.baseColor).l,p=(u+h)/2,C=this.matchRelativeLuminanceIndex(p,d)/(e-1),E=this.matchRelativeLuminanceIndex(t,d)/(e-1),O=No(this.config.baseColor),q=_s(ni.fromObject({h:O.h,s:O.s,l:t})),_e=_s(ni.fromObject({h:O.h,s:O.s,l:o})),se=new Array(5);se[0]={position:0,color:new Ke(1,1,1,1)},se[1]={position:C,color:this.config.baseColor},se[2]={position:E,color:q},se[3]={position:.99,color:_e},se[4]={position:1,color:new Ke(0,0,0,1)};let ke=new Wi(se);this.palette=new Array(e);for(let Tt=0;Tt<e;Tt++){let Gt=ke.getColor(Tt/(e-1),Zr.RGB);this.palette[Tt]=Gt}}matchRelativeLuminanceIndex(e,t){let o=Number.MAX_VALUE,i=0,n=0,s=t.length;for(;n<s;n++){let d=Math.abs(Gp(t[n])-e);d<o&&(o=d,i=n)}return i}};dy.defaultPaletteConfig={baseColor:Jr("#808080"),steps:94}});var N2=y(()=>{a();l();c();Ts()});var H2=y(()=>{a();l();c();Ki()});var ks=y(()=>{a();l();c();sy();Ts();Fl();zp();Fd();Od();$d();ay();D2();Ki();Wp();qp();L2();ly();ii();N2();Qp();H2();cy()});function La(r,e){let t=r.relativeLuminance>e.relativeLuminance?r:e,o=r.relativeLuminance>e.relativeLuminance?e:r;return(t.relativeLuminance+.05)/(o.relativeLuminance+.05)}var Yp=y(()=>{a();l();c()});function U2(r){let e={r:0,g:0,b:0,toColorString:()=>"",contrast:()=>0,relativeLuminance:0};for(let t in e)if(typeof e[t]!=typeof r[t])return!1;return!0}var vr,Zp,Is=y(()=>{a();l();c();ks();Yp();vr=Object.freeze({create(r,e,t){return new Zp(r,e,t)},from(r){return new Zp(r.r,r.g,r.b)}});Zp=class r extends Ke{constructor(e,t,o){super(e,t,o,1),this.toColorString=this.toStringHexRGB,this.contrast=La.bind(null,this),this.createCSS=this.toColorString,this.relativeLuminance=Ll(this)}static fromObject(e){return new r(e.r,e.g,e.b)}}});function Jp(r,e,t=0,o=r.length-1){if(o===t)return r[t];let i=Math.floor((o-t)/2)+t;return e(r[i])?Jp(r,e,t,i):Jp(r,e,i+1,o)}var B2=y(()=>{a();l();c()});function Qi(r){return r.relativeLuminance<=A6}var A6,Hl=y(()=>{a();l();c();A6=(-.1+Math.sqrt(.21))/2});function _o(r){return Qi(r)?-1:1}var As=y(()=>{a();l();c();Hl()});function R6(r,e,t){return typeof r=="number"?Rs.from(vr.create(r,e,t)):Rs.from(r)}function P6(r,e){return U2(r)?Xp.from(r,e):Xp.from(vr.create(r.r,r.g,r.b),e)}var V2,Rs,Xp,ef=y(()=>{a();l();c();ks();Is();B2();As();Yp();V2={stepContrast:1.03,stepContrastRamp:.03,preserveSource:!1};Rs=Object.freeze({create:R6,from:P6}),Xp=class r{constructor(e,t){this.closestIndexCache=new Map,this.source=e,this.swatches=t,this.reversedSwatches=Object.freeze([...this.swatches].reverse()),this.lastIndex=this.swatches.length-1}colorContrast(e,t,o,i){o===void 0&&(o=this.closestIndexOf(e));let n=this.swatches,s=this.lastIndex,d=o;i===void 0&&(i=_o(e));let u=h=>La(e,h)>=t;return i===-1&&(n=this.reversedSwatches,d=s-d),Jp(n,u,d,s)}get(e){return this.swatches[e]||this.swatches[oi(e,0,this.lastIndex)]}closestIndexOf(e){if(this.closestIndexCache.has(e.relativeLuminance))return this.closestIndexCache.get(e.relativeLuminance);let t=this.swatches.indexOf(e);if(t!==-1)return this.closestIndexCache.set(e.relativeLuminance,t),t;let o=this.swatches.reduce((i,n)=>Math.abs(n.relativeLuminance-e.relativeLuminance)<Math.abs(i.relativeLuminance-e.relativeLuminance)?n:i);return t=this.swatches.indexOf(o),this.closestIndexCache.set(e.relativeLuminance,t),t}static saturationBump(e,t){let i=No(e).s,n=No(t);if(n.s<i){let s=new ni(n.h,i,n.l);return _s(s)}return t}static ramp(e){let t=e/100;return t>.5?(t-.5)/.5:2*t}static createHighResolutionPalette(e){let t=[],o=Fa(Ke.fromObject(e).roundToPrecision(4)),i=Es(new jt(0,o.a,o.b)).clamp().roundToPrecision(4),n=Es(new jt(50,o.a,o.b)).clamp().roundToPrecision(4),s=Es(new jt(100,o.a,o.b)).clamp().roundToPrecision(4),d=new Ke(0,0,0),u=new Ke(1,1,1),h=s.equalValue(u)?0:14,p=i.equalValue(d)?0:14;for(let v=100+h;v>=0-p;v-=.5){let C;if(v<0){let x=v/p+1;C=Nl(x,d,i)}else if(v<=50)C=Nl(r.ramp(v),i,n);else if(v<=100)C=Nl(r.ramp(v),n,s);else{let x=(v-100)/h;C=Nl(x,s,u)}C=r.saturationBump(n,C).roundToPrecision(4),t.push(vr.from(C))}return new r(e,t)}static adjustEnd(e,t,o,i){let n=i===-1?t.swatches:t.reversedSwatches,s=h=>{let p=t.closestIndexOf(h);return i===1?t.lastIndex-p:p};i===1&&o.reverse();let d=e(o[o.length-2]);if(wt(La(o[o.length-1],o[o.length-2]),2)<d){o.pop();let h=t.colorContrast(n[t.lastIndex],d,void 0,i),p=s(h),v=s(o[o.length-2]),C=p-v,x=1;for(let E=o.length-C-1;E<o.length;E++){let O=s(o[E]),q=E===o.length-1?t.lastIndex:O+x;o[E]=n[q],x++}}i===1&&o.reverse()}static createColorPaletteByContrast(e,t){let o=r.createHighResolutionPalette(e),i=d=>{let u=t.stepContrast+t.stepContrast*(1-d.relativeLuminance)*t.stepContrastRamp;return wt(u,2)},n=[],s=t.preserveSource?e:o.swatches[0];n.push(s);do{let d=i(s);s=o.colorContrast(s,d,void 0,1),n.push(s)}while(s.relativeLuminance>0);if(t.preserveSource){s=e;do{let d=i(s);s=o.colorContrast(s,d,void 0,-1),n.unshift(s)}while(s.relativeLuminance<1)}return this.adjustEnd(i,o,n,-1),t.preserveSource&&this.adjustEnd(i,o,n,1),n}static from(e,t){let o=t===void 0?V2:Object.assign(Object.assign({},V2),t);return new r(e,Object.freeze(r.createColorPaletteByContrast(e,o)))}}});var Ul,Dd,z2,uy,q2,tf=y(()=>{a();l();c();ks();Is();Ul=vr.create(1,1,1),Dd=vr.create(0,0,0),z2=vr.create(.5,.5,.5),uy=Jr("#0078D4"),q2=vr.create(uy.r,uy.g,uy.b)});function hy(r,e,t,o,i){let n=p=>p.contrast(Ul)>=i?Ul:Dd,s=n(r),d=n(e),u=s.relativeLuminance===d.relativeLuminance?s:n(t),h=n(o);return{rest:s,hover:d,active:u,focus:h}}var G2=y(()=>{a();l();c();tf()});var Bl,py=y(()=>{a();l();c();ks();Yp();Bl=class r{constructor(e,t,o,i){this.toColorString=()=>this.cssGradient,this.contrast=La.bind(null,this),this.createCSS=this.toColorString,this.color=new Ke(e,t,o),this.cssGradient=i,this.relativeLuminance=Ll(this.color),this.r=e,this.g=t,this.b=o}static fromObject(e,t){return new r(e.r,e.g,e.b,t)}}});function fy(r,e,t,o,i,n,s,d,u=10,h=!1){let p=r.closestIndexOf(e);d===void 0&&(d=_o(e));function v(ke){if(h){let Tt=r.closestIndexOf(e),Gt=r.get(Tt),Lt=ke.relativeLuminance<e.relativeLuminance?O6:$6,sn=P2(Jr(ke.toColorString()),Jr(Gt.toColorString()),Lt).roundToPrecision(2),ur=M2(Jr(e.toColorString()),sn);return vr.from(ur)}else return ke}let C=p+d*t,x=C+d*(o-t),E=C+d*(i-t),O=C+d*(n-t),q=d===-1?0:100-u,_e=d===-1?u:100;function se(ke,Tt){let Gt=r.get(ke);if(Tt){let Lt=r.get(ke+d*s),sn=d===-1?Lt:Gt,ur=d===-1?Gt:Lt,WR=`linear-gradient(${v(sn).toColorString()} ${q}%, ${v(ur).toColorString()} ${_e}%)`;return Bl.fromObject(sn,WR)}else return v(Gt)}return{rest:se(C,!0),hover:se(x,!0),active:se(E,!1),focus:se(O,!0)}}var O6,$6,j2=y(()=>{a();l();c();ks();Is();As();py();O6=new Ke(0,0,0),$6=new Ke(1,1,1)});function K2(r,e,t,o,i,n,s,d){let u=r.closestIndexOf(e),h=_o(e),p=u+h*t,v=p+h*(o-t),C=p+h*(i-t),x=p+h*(n-t),E=`calc(100% - ${d})`;function O(q,_e){let se=r.get(q);if(_e){let ke=r.get(q+h*s),Tt=`linear-gradient(${se.toColorString()} ${E}, ${ke.toColorString()} ${E}, ${ke.toColorString()})`;return Bl.fromObject(se,Tt)}else return se}return{rest:O(p,!0),hover:O(v,!0),active:O(C,!1),focus:O(x,!0)}}var W2=y(()=>{a();l();c();As();py()});function Q2(r,e,t){return r.colorContrast(e,t)}var Y2=y(()=>{a();l();c()});function Na(r,e,t,o,i,n,s,d){d==null&&(d=_o(e));let u=r.closestIndexOf(r.colorContrast(e,t));return{rest:r.get(u+d*o),hover:r.get(u+d*i),active:r.get(u+d*n),focus:r.get(u+d*s)}}function Z2(r,e,t,o,i,n,s,d=void 0,u,h,p,v,C,x=void 0){return Qi(e)?Na(r,e,u,h,p,v,C,x):Na(r,e,t,o,i,n,s,d)}var J2=y(()=>{a();l();c();As();Hl()});function X2(r,e,t){return r.get(r.closestIndexOf(e)+_o(e)*t)}var eI=y(()=>{a();l();c();As()});function On(r,e,t,o,i,n,s){let d=r.closestIndexOf(e);return s==null&&(s=_o(e)),{rest:r.get(d+s*t),hover:r.get(d+s*o),active:r.get(d+s*i),focus:r.get(d+s*n)}}function rf(r,e,t,o,i,n,s=void 0,d,u,h,p,v=void 0){return Qi(e)?On(r,e,d,u,h,p,v):On(r,e,t,o,i,n,s)}var tI=y(()=>{a();l();c();As();Hl()});function rI(r,e){return Qi(e)?Ul:Dd}function oI(r,e,t){return Qi(e)?Dd:Ul}var iI=y(()=>{a();l();c();tf();Hl()});function nI(r){return vr.create(r,r,r)}var Ld,of=y(()=>{a();l();c();Is();(function(r){r[r.LightMode=.98]="LightMode",r[r.DarkMode=.15]="DarkMode"})(Ld||(Ld={}))});function $n(r,e){return r.closestIndexOf(nI(e))}function sI(r,e){return r.get($n(r,e))}var Vl=y(()=>{a();l();c();of()});function aI(r,e,t){return r.get($n(r,e)+t)}var lI=y(()=>{a();l();c();Vl()});function my(r,e,t){return r.get($n(r,e)+t*-1)}var cI=y(()=>{a();l();c();Vl()});function dI(r,e,t){return r.get($n(r,e)+t*-1*2)}var uI=y(()=>{a();l();c();Vl()});function hI(r,e,t){return r.get($n(r,e)+t*-1*3)}var pI=y(()=>{a();l();c();Vl()});var fI,mI=y(()=>{a();l();c();fI={Thin:100,ExtraLight:200,Light:300,Normal:400,Medium:500,SemiBold:600,Bold:700,ExtraBold:800,Black:900}});function J(r){return tt.create({name:r,cssCustomPropertyName:null})}function Fn(r){return e=>{let t=r.getValueFor(e),o=M6.getValueFor(e);if(t.endsWith("px")){let i=Number.parseFloat(t.replace("px",""));if(i<=12)return`"wght" ${o}, "opsz" 8`;if(i>24)return`"wght" ${o}, "opsz" 36`}return`"wght" ${o}, "opsz" 10.5`}}function lO(r,e,t,o,i,n){let s=_o(e),d=r.closestIndexOf(r.colorContrast(e,14)),u=d+s*Math.abs(t-o),h=s===1?t<o:s*t>s*o,p,v;return h?(p=d,v=u):(p=u,v=d),{rest:r.get(p),hover:r.get(v),active:r.get(p+s*i),focus:r.get(p+s*n)}}var F,zl,Pt,Ps,CI,Xr,V,Ae,ho,Z,Vt,eo,M6,Nd,hf,wI,Hd,ql,xI,Ud,pf,SI,Bd,ff,_I,Vd,mf,EI,zd,gf,TI,qd,vf,kI,Gd,yf,II,jd,bf,AI,Os,af,lf,cf,df,gy,vy,yy,by,Cy,wy,xy,Sy,_y,Ey,Ty,ky,nf,gI,vI,yI,Mn,F6,D6,sf,L6,N6,H6,U6,Iy,Ay,Ry,Py,B6,Oy,$y,My,Fy,Dy,Ly,Ny,RI,PI,OI,$I,Hy,bI,V6,z6,q6,G6,j6,Uy,_t,By,Vy,K6,XHe,W6,Yi,Q6,Y6,Z6,eUe,J6,tUe,X6,rUe,Ee,uf,Cf,Ye,to,ro,wf,xf,Ho,Sf,_f,oUe,Ef,zy,qy,Gy,iUe,Tf,MI,FI,DI,nUe,kf,po,jy,Ky,sUe,Zi,Kd,Wy,aUe,Qy,If,Gl,jl,Kl,Wl,Dn,LI,lUe,cUe,eO,NI,Ln,si,Ql,HI,UI,Eo,Nn,Ji,Xi,BI,Af,Rf,VI,zI,dUe,Pf,Pe,qI,GI,uUe,Yl,en,Of,$s,jI,KI,hUe,$f,Zl,Mf,Ff,pUe,tO,Ha,Df,Yy,WI,fUe,mUe,Zy,Hn,gUe,vUe,Lf,ai,Jl,Xl,yUe,rO,ec,oO,QI,Nf,bUe,CUe,wUe,xUe,iO,nO,sO,aO,Hf,SUe,_Ue,EUe,TUe,$e=y(()=>{a();l();c();j();pe();ef();G2();j2();W2();Y2();J2();eI();tI();iI();lI();Vl();cI();uI();pI();tf();of();As();mI();({create:F}=tt);zl=F("direction").withDefault(Ze.ltr),Pt=F("disabled-opacity").withDefault(.3),Ps=F("base-height-multiplier").withDefault(8),CI=F("base-horizontal-spacing-multiplier").withDefault(3),Xr=F("density").withDefault(0),V=F("design-unit").withDefault(4),Ae=F("control-corner-radius").withDefault(4),ho=F("layer-corner-radius").withDefault(8),Z=F("stroke-width").withDefault(1),Vt=F("focus-stroke-width").withDefault(2),eo=F("body-font").withDefault('"Segoe UI Variable", "Segoe UI", sans-serif'),M6=F("font-weight").withDefault(fI.Normal);Nd=F("type-ramp-base-font-size").withDefault("14px"),hf=F("type-ramp-base-line-height").withDefault("20px"),wI=F("type-ramp-base-font-variations").withDefault(Fn(Nd)),Hd=F("type-ramp-minus-1-font-size").withDefault("12px"),ql=F("type-ramp-minus-1-line-height").withDefault("16px"),xI=F("type-ramp-minus-1-font-variations").withDefault(Fn(Hd)),Ud=F("type-ramp-minus-2-font-size").withDefault("10px"),pf=F("type-ramp-minus-2-line-height").withDefault("14px"),SI=F("type-ramp-minus-2-font-variations").withDefault(Fn(Ud)),Bd=F("type-ramp-plus-1-font-size").withDefault("16px"),ff=F("type-ramp-plus-1-line-height").withDefault("22px"),_I=F("type-ramp-plus-1-font-variations").withDefault(Fn(Bd)),Vd=F("type-ramp-plus-2-font-size").withDefault("20px"),mf=F("type-ramp-plus-2-line-height").withDefault("26px"),EI=F("type-ramp-plus-2-font-variations").withDefault(Fn(Vd)),zd=F("type-ramp-plus-3-font-size").withDefault("24px"),gf=F("type-ramp-plus-3-line-height").withDefault("32px"),TI=F("type-ramp-plus-3-font-variations").withDefault(Fn(zd)),qd=F("type-ramp-plus-4-font-size").withDefault("28px"),vf=F("type-ramp-plus-4-line-height").withDefault("36px"),kI=F("type-ramp-plus-4-font-variations").withDefault(Fn(qd)),Gd=F("type-ramp-plus-5-font-size").withDefault("32px"),yf=F("type-ramp-plus-5-line-height").withDefault("40px"),II=F("type-ramp-plus-5-font-variations").withDefault(Fn(Gd)),jd=F("type-ramp-plus-6-font-size").withDefault("40px"),bf=F("type-ramp-plus-6-line-height").withDefault("52px"),AI=F("type-ramp-plus-6-font-variations").withDefault(Fn(jd)),Os=F("base-layer-luminance").withDefault(Ld.LightMode),af=J("accent-fill-rest-delta").withDefault(0),lf=J("accent-fill-hover-delta").withDefault(-2),cf=J("accent-fill-active-delta").withDefault(-5),df=J("accent-fill-focus-delta").withDefault(0),gy=J("accent-foreground-rest-delta").withDefault(0),vy=J("accent-foreground-hover-delta").withDefault(3),yy=J("accent-foreground-active-delta").withDefault(-8),by=J("accent-foreground-focus-delta").withDefault(0),Cy=J("neutral-fill-rest-delta").withDefault(-1),wy=J("neutral-fill-hover-delta").withDefault(1),xy=J("neutral-fill-active-delta").withDefault(0),Sy=J("neutral-fill-focus-delta").withDefault(0),_y=J("neutral-fill-input-rest-delta").withDefault(-1),Ey=J("neutral-fill-input-hover-delta").withDefault(1),Ty=J("neutral-fill-input-active-delta").withDefault(0),ky=J("neutral-fill-input-focus-delta").withDefault(-2),nf=J("neutral-fill-input-alt-rest-delta").withDefault(2),gI=J("neutral-fill-input-alt-hover-delta").withDefault(4),vI=J("neutral-fill-input-alt-active-delta").withDefault(6),yI=J("neutral-fill-input-alt-focus-delta").withDefault(2),Mn=J("neutral-fill-layer-rest-delta").withDefault(-2),F6=J("neutral-fill-layer-hover-delta").withDefault(-3),D6=J("neutral-fill-layer-active-delta").withDefault(-3),sf=J("neutral-fill-layer-alt-rest-delta").withDefault(-1),L6=J("neutral-fill-secondary-rest-delta").withDefault(3),N6=J("neutral-fill-secondary-hover-delta").withDefault(2),H6=J("neutral-fill-secondary-active-delta").withDefault(1),U6=J("neutral-fill-secondary-focus-delta").withDefault(3),Iy=J("neutral-fill-stealth-rest-delta").withDefault(0),Ay=J("neutral-fill-stealth-hover-delta").withDefault(3),Ry=J("neutral-fill-stealth-active-delta").withDefault(2),Py=J("neutral-fill-stealth-focus-delta").withDefault(0),B6=J("neutral-fill-strong-rest-delta").withDefault(0),Oy=J("neutral-fill-strong-hover-delta").withDefault(8),$y=J("neutral-fill-strong-active-delta").withDefault(-5),My=J("neutral-fill-strong-focus-delta").withDefault(0),Fy=J("neutral-stroke-rest-delta").withDefault(8),Dy=J("neutral-stroke-hover-delta").withDefault(12),Ly=J("neutral-stroke-active-delta").withDefault(6),Ny=J("neutral-stroke-focus-delta").withDefault(8),RI=J("neutral-stroke-control-rest-delta").withDefault(3),PI=J("neutral-stroke-control-hover-delta").withDefault(5),OI=J("neutral-stroke-control-active-delta").withDefault(5),$I=J("neutral-stroke-control-focus-delta").withDefault(5),Hy=J("neutral-stroke-divider-rest-delta").withDefault(4),bI=J("neutral-stroke-layer-rest-delta").withDefault(3),V6=J("neutral-stroke-layer-hover-delta").withDefault(3),z6=J("neutral-stroke-layer-active-delta").withDefault(3),q6=J("neutral-stroke-strong-hover-delta").withDefault(0),G6=J("neutral-stroke-strong-active-delta").withDefault(0),j6=J("neutral-stroke-strong-focus-delta").withDefault(0),Uy=F("neutral-base-color").withDefault(z2),_t=J("neutral-palette").withDefault(r=>Rs.from(Uy.getValueFor(r))),By=F("accent-base-color").withDefault(q2),Vy=J("accent-palette").withDefault(r=>Rs.from(By.getValueFor(r))),K6=J("neutral-layer-card-container-recipe").withDefault({evaluate:r=>my(_t.getValueFor(r),Os.getValueFor(r),Mn.getValueFor(r))}),XHe=F("neutral-layer-card-container").withDefault(r=>K6.getValueFor(r).evaluate(r)),W6=J("neutral-layer-floating-recipe").withDefault({evaluate:r=>aI(_t.getValueFor(r),Os.getValueFor(r),Mn.getValueFor(r))}),Yi=F("neutral-layer-floating").withDefault(r=>W6.getValueFor(r).evaluate(r)),Q6=J("neutral-layer-1-recipe").withDefault({evaluate:r=>sI(_t.getValueFor(r),Os.getValueFor(r))}),Y6=F("neutral-layer-1").withDefault(r=>Q6.getValueFor(r).evaluate(r)),Z6=J("neutral-layer-2-recipe").withDefault({evaluate:r=>my(_t.getValueFor(r),Os.getValueFor(r),Mn.getValueFor(r))}),eUe=F("neutral-layer-2").withDefault(r=>Z6.getValueFor(r).evaluate(r)),J6=J("neutral-layer-3-recipe").withDefault({evaluate:r=>dI(_t.getValueFor(r),Os.getValueFor(r),Mn.getValueFor(r))}),tUe=F("neutral-layer-3").withDefault(r=>J6.getValueFor(r).evaluate(r)),X6=J("neutral-layer-4-recipe").withDefault({evaluate:r=>hI(_t.getValueFor(r),Os.getValueFor(r),Mn.getValueFor(r))}),rUe=F("neutral-layer-4").withDefault(r=>X6.getValueFor(r).evaluate(r)),Ee=F("fill-color").withDefault(r=>Y6.getValueFor(r));(function(r){r[r.normal=4.5]="normal",r[r.large=3]="large"})(uf||(uf={}));Cf=J("accent-fill-recipe").withDefault({evaluate:(r,e)=>Z2(Vy.getValueFor(r),e||Ee.getValueFor(r),5,af.getValueFor(r),lf.getValueFor(r),cf.getValueFor(r),df.getValueFor(r),void 0,8,af.getValueFor(r),lf.getValueFor(r),cf.getValueFor(r),df.getValueFor(r),void 0)}),Ye=F("accent-fill-rest").withDefault(r=>Cf.getValueFor(r).evaluate(r).rest),to=F("accent-fill-hover").withDefault(r=>Cf.getValueFor(r).evaluate(r).hover),ro=F("accent-fill-active").withDefault(r=>Cf.getValueFor(r).evaluate(r).active),wf=F("accent-fill-focus").withDefault(r=>Cf.getValueFor(r).evaluate(r).focus),xf=J("foreground-on-accent-recipe").withDefault({evaluate:r=>hy(Ye.getValueFor(r),to.getValueFor(r),ro.getValueFor(r),wf.getValueFor(r),uf.normal)}),Ho=F("foreground-on-accent-rest").withDefault(r=>xf.getValueFor(r).evaluate(r).rest),Sf=F("foreground-on-accent-hover").withDefault(r=>xf.getValueFor(r).evaluate(r).hover),_f=F("foreground-on-accent-active").withDefault(r=>xf.getValueFor(r).evaluate(r).active),oUe=F("foreground-on-accent-focus").withDefault(r=>xf.getValueFor(r).evaluate(r).focus),Ef=J("accent-foreground-recipe").withDefault({evaluate:(r,e)=>Na(Vy.getValueFor(r),e||Ee.getValueFor(r),9.5,gy.getValueFor(r),vy.getValueFor(r),yy.getValueFor(r),by.getValueFor(r))}),zy=F("accent-foreground-rest").withDefault(r=>Ef.getValueFor(r).evaluate(r).rest),qy=F("accent-foreground-hover").withDefault(r=>Ef.getValueFor(r).evaluate(r).hover),Gy=F("accent-foreground-active").withDefault(r=>Ef.getValueFor(r).evaluate(r).active),iUe=F("accent-foreground-focus").withDefault(r=>Ef.getValueFor(r).evaluate(r).focus),Tf=J("accent-stroke-control-recipe").withDefault({evaluate:(r,e)=>fy(_t.getValueFor(r),e||Ee.getValueFor(r),-3,-3,-3,-3,10,1,void 0,!0)}),MI=F("accent-stroke-control-rest").withDefault(r=>Tf.getValueFor(r).evaluate(r,Ye.getValueFor(r)).rest),FI=F("accent-stroke-control-hover").withDefault(r=>Tf.getValueFor(r).evaluate(r,to.getValueFor(r)).hover),DI=F("accent-stroke-control-active").withDefault(r=>Tf.getValueFor(r).evaluate(r,ro.getValueFor(r)).active),nUe=F("accent-stroke-control-focus").withDefault(r=>Tf.getValueFor(r).evaluate(r,wf.getValueFor(r)).focus),kf=J("neutral-fill-recipe").withDefault({evaluate:(r,e)=>rf(_t.getValueFor(r),e||Ee.getValueFor(r),Cy.getValueFor(r),wy.getValueFor(r),xy.getValueFor(r),Sy.getValueFor(r),void 0,2,3,1,2,void 0)}),po=F("neutral-fill-rest").withDefault(r=>kf.getValueFor(r).evaluate(r).rest),jy=F("neutral-fill-hover").withDefault(r=>kf.getValueFor(r).evaluate(r).hover),Ky=F("neutral-fill-active").withDefault(r=>kf.getValueFor(r).evaluate(r).active),sUe=F("neutral-fill-focus").withDefault(r=>kf.getValueFor(r).evaluate(r).focus),Zi=J("neutral-fill-input-recipe").withDefault({evaluate:(r,e)=>rf(_t.getValueFor(r),e||Ee.getValueFor(r),_y.getValueFor(r),Ey.getValueFor(r),Ty.getValueFor(r),ky.getValueFor(r),void 0,2,3,1,0,void 0)}),Kd=F("neutral-fill-input-rest").withDefault(r=>Zi.getValueFor(r).evaluate(r).rest),Wy=F("neutral-fill-input-hover").withDefault(r=>Zi.getValueFor(r).evaluate(r).hover),aUe=F("neutral-fill-input-active").withDefault(r=>Zi.getValueFor(r).evaluate(r).active),Qy=F("neutral-fill-input-focus").withDefault(r=>Zi.getValueFor(r).evaluate(r).focus),If=J("neutral-fill-input-alt-recipe").withDefault({evaluate:(r,e)=>rf(_t.getValueFor(r),e||Ee.getValueFor(r),nf.getValueFor(r),gI.getValueFor(r),vI.getValueFor(r),yI.getValueFor(r),1,nf.getValueFor(r),nf.getValueFor(r)-gI.getValueFor(r),nf.getValueFor(r)-vI.getValueFor(r),yI.getValueFor(r),1)}),Gl=F("neutral-fill-input-alt-rest").withDefault(r=>If.getValueFor(r).evaluate(r).rest),jl=F("neutral-fill-input-alt-hover").withDefault(r=>If.getValueFor(r).evaluate(r).hover),Kl=F("neutral-fill-input-alt-active").withDefault(r=>If.getValueFor(r).evaluate(r).active),Wl=F("neutral-fill-input-alt-focus").withDefault(r=>If.getValueFor(r).evaluate(r).focus),Dn=J("neutral-fill-layer-recipe").withDefault({evaluate:(r,e)=>On(_t.getValueFor(r),e||Ee.getValueFor(r),Mn.getValueFor(r),F6.getValueFor(r),D6.getValueFor(r),Mn.getValueFor(r),1)}),LI=F("neutral-fill-layer-rest").withDefault(r=>Dn.getValueFor(r).evaluate(r).rest),lUe=F("neutral-fill-layer-hover").withDefault(r=>Dn.getValueFor(r).evaluate(r).hover),cUe=F("neutral-fill-layer-active").withDefault(r=>Dn.getValueFor(r).evaluate(r).active),eO=J("neutral-fill-layer-alt-recipe").withDefault({evaluate:(r,e)=>On(_t.getValueFor(r),e||Ee.getValueFor(r),sf.getValueFor(r),sf.getValueFor(r),sf.getValueFor(r),sf.getValueFor(r))}),NI=F("neutral-fill-layer-alt-rest").withDefault(r=>eO.getValueFor(r).evaluate(r).rest),Ln=J("neutral-fill-secondary-recipe").withDefault({evaluate:(r,e)=>On(_t.getValueFor(r),e||Ee.getValueFor(r),L6.getValueFor(r),N6.getValueFor(r),H6.getValueFor(r),U6.getValueFor(r))}),si=F("neutral-fill-secondary-rest").withDefault(r=>Ln.getValueFor(r).evaluate(r).rest),Ql=F("neutral-fill-secondary-hover").withDefault(r=>Ln.getValueFor(r).evaluate(r).hover),HI=F("neutral-fill-secondary-active").withDefault(r=>Ln.getValueFor(r).evaluate(r).active),UI=F("neutral-fill-secondary-focus").withDefault(r=>Ln.getValueFor(r).evaluate(r).focus),Eo=J("neutral-fill-stealth-recipe").withDefault({evaluate:(r,e)=>On(_t.getValueFor(r),e||Ee.getValueFor(r),Iy.getValueFor(r),Ay.getValueFor(r),Ry.getValueFor(r),Py.getValueFor(r))}),Nn=F("neutral-fill-stealth-rest").withDefault(r=>Eo.getValueFor(r).evaluate(r).rest),Ji=F("neutral-fill-stealth-hover").withDefault(r=>Eo.getValueFor(r).evaluate(r).hover),Xi=F("neutral-fill-stealth-active").withDefault(r=>Eo.getValueFor(r).evaluate(r).active),BI=F("neutral-fill-stealth-focus").withDefault(r=>Eo.getValueFor(r).evaluate(r).focus),Af=J("neutral-fill-strong-recipe").withDefault({evaluate:(r,e)=>Na(_t.getValueFor(r),e||Ee.getValueFor(r),4.5,B6.getValueFor(r),Oy.getValueFor(r),$y.getValueFor(r),My.getValueFor(r))}),Rf=F("neutral-fill-strong-rest").withDefault(r=>Af.getValueFor(r).evaluate(r).rest),VI=F("neutral-fill-strong-hover").withDefault(r=>Af.getValueFor(r).evaluate(r).hover),zI=F("neutral-fill-strong-active").withDefault(r=>Af.getValueFor(r).evaluate(r).active),dUe=F("neutral-fill-strong-focus").withDefault(r=>Af.getValueFor(r).evaluate(r).focus),Pf=J("neutral-foreground-recipe").withDefault({evaluate:(r,e)=>Na(_t.getValueFor(r),e||Ee.getValueFor(r),16,0,-19,-30,0)}),Pe=F("neutral-foreground-rest").withDefault(r=>Pf.getValueFor(r).evaluate(r).rest),qI=F("neutral-foreground-hover").withDefault(r=>Pf.getValueFor(r).evaluate(r).hover),GI=F("neutral-foreground-active").withDefault(r=>Pf.getValueFor(r).evaluate(r).active),uUe=F("neutral-foreground-focus").withDefault(r=>Pf.getValueFor(r).evaluate(r).focus),Yl=J("neutral-foreground-hint-recipe").withDefault({evaluate:(r,e)=>Q2(_t.getValueFor(r),e||Ee.getValueFor(r),4.5)}),en=F("neutral-foreground-hint").withDefault(r=>Yl.getValueFor(r).evaluate(r)),Of=J("neutral-stroke-recipe").withDefault({evaluate:(r,e)=>On(_t.getValueFor(r),e||Ee.getValueFor(r),Fy.getValueFor(r),Dy.getValueFor(r),Ly.getValueFor(r),Ny.getValueFor(r))}),$s=F("neutral-stroke-rest").withDefault(r=>Of.getValueFor(r).evaluate(r).rest),jI=F("neutral-stroke-hover").withDefault(r=>Of.getValueFor(r).evaluate(r).hover),KI=F("neutral-stroke-active").withDefault(r=>Of.getValueFor(r).evaluate(r).active),hUe=F("neutral-stroke-focus").withDefault(r=>Of.getValueFor(r).evaluate(r).focus),$f=J("neutral-stroke-control-recipe").withDefault({evaluate:(r,e)=>fy(_t.getValueFor(r),e||Ee.getValueFor(r),RI.getValueFor(r),PI.getValueFor(r),OI.getValueFor(r),$I.getValueFor(r),5)}),Zl=F("neutral-stroke-control-rest").withDefault(r=>$f.getValueFor(r).evaluate(r).rest),Mf=F("neutral-stroke-control-hover").withDefault(r=>$f.getValueFor(r).evaluate(r).hover),Ff=F("neutral-stroke-control-active").withDefault(r=>$f.getValueFor(r).evaluate(r).active),pUe=F("neutral-stroke-control-focus").withDefault(r=>$f.getValueFor(r).evaluate(r).focus),tO=J("neutral-stroke-divider-recipe").withDefault({evaluate:(r,e)=>X2(_t.getValueFor(r),e||Ee.getValueFor(r),Hy.getValueFor(r))}),Ha=F("neutral-stroke-divider-rest").withDefault(r=>tO.getValueFor(r).evaluate(r)),Df=J("neutral-stroke-input-recipe").withDefault({evaluate:(r,e)=>K2(_t.getValueFor(r),e||Ee.getValueFor(r),RI.getValueFor(r),PI.getValueFor(r),OI.getValueFor(r),$I.getValueFor(r),20,Z.getValueFor(r)+"px")}),Yy=F("neutral-stroke-input-rest").withDefault(r=>Df.getValueFor(r).evaluate(r).rest),WI=F("neutral-stroke-input-hover").withDefault(r=>Df.getValueFor(r).evaluate(r).hover),fUe=F("neutral-stroke-input-active").withDefault(r=>Df.getValueFor(r).evaluate(r).active),mUe=F("neutral-stroke-input-focus").withDefault(r=>Df.getValueFor(r).evaluate(r).focus),Zy=J("neutral-stroke-layer-recipe").withDefault({evaluate:(r,e)=>On(_t.getValueFor(r),e||Ee.getValueFor(r),bI.getValueFor(r),V6.getValueFor(r),z6.getValueFor(r),bI.getValueFor(r))}),Hn=F("neutral-stroke-layer-rest").withDefault(r=>Zy.getValueFor(r).evaluate(r).rest),gUe=F("neutral-stroke-layer-hover").withDefault(r=>Zy.getValueFor(r).evaluate(r).hover),vUe=F("neutral-stroke-layer-active").withDefault(r=>Zy.getValueFor(r).evaluate(r).active),Lf=J("neutral-stroke-strong-recipe").withDefault({evaluate:(r,e)=>Na(_t.getValueFor(r),e||Ee.getValueFor(r),5.5,0,q6.getValueFor(r),G6.getValueFor(r),j6.getValueFor(r))}),ai=F("neutral-stroke-strong-rest").withDefault(r=>Lf.getValueFor(r).evaluate(r).rest),Jl=F("neutral-stroke-strong-hover").withDefault(r=>Lf.getValueFor(r).evaluate(r).hover),Xl=F("neutral-stroke-strong-active").withDefault(r=>Lf.getValueFor(r).evaluate(r).active),yUe=F("neutral-stroke-strong-focus").withDefault(r=>Lf.getValueFor(r).evaluate(r).focus),rO=J("focus-stroke-outer-recipe").withDefault({evaluate:r=>rI(_t.getValueFor(r),Ee.getValueFor(r))}),ec=F("focus-stroke-outer").withDefault(r=>rO.getValueFor(r).evaluate(r)),oO=J("focus-stroke-inner-recipe").withDefault({evaluate:r=>oI(Vy.getValueFor(r),Ee.getValueFor(r),ec.getValueFor(r))}),QI=F("focus-stroke-inner").withDefault(r=>oO.getValueFor(r).evaluate(r)),Nf=J("foreground-on-accent-large-recipe").withDefault({evaluate:r=>hy(Ye.getValueFor(r),to.getValueFor(r),ro.getValueFor(r),wf.getValueFor(r),uf.large)}),bUe=F("foreground-on-accent-rest-large").withDefault(r=>Nf.getValueFor(r).evaluate(r).rest),CUe=F("foreground-on-accent-hover-large").withDefault(r=>Nf.getValueFor(r).evaluate(r,to.getValueFor(r)).hover),wUe=F("foreground-on-accent-active-large").withDefault(r=>Nf.getValueFor(r).evaluate(r,ro.getValueFor(r)).active),xUe=F("foreground-on-accent-focus-large").withDefault(r=>Nf.getValueFor(r).evaluate(r,wf.getValueFor(r)).focus),iO=F("neutral-fill-inverse-rest-delta").withDefault(0),nO=F("neutral-fill-inverse-hover-delta").withDefault(-3),sO=F("neutral-fill-inverse-active-delta").withDefault(7),aO=F("neutral-fill-inverse-focus-delta").withDefault(0);Hf=J("neutral-fill-inverse-recipe").withDefault({evaluate:(r,e)=>lO(_t.getValueFor(r),e||Ee.getValueFor(r),iO.getValueFor(r),nO.getValueFor(r),sO.getValueFor(r),aO.getValueFor(r))}),SUe=F("neutral-fill-inverse-rest").withDefault(r=>Hf.getValueFor(r).evaluate(r).rest),_Ue=F("neutral-fill-inverse-hover").withDefault(r=>Hf.getValueFor(r).evaluate(r).hover),EUe=F("neutral-fill-inverse-active").withDefault(r=>Hf.getValueFor(r).evaluate(r).active),TUe=F("neutral-fill-inverse-focus").withDefault(r=>Hf.getValueFor(r).evaluate(r).focus)});var Ue,Uf,$Ue,MUe,FUe,DUe,LUe,NUe,HUe,Dt=y(()=>{a();l();c();I();$e();Ue=_r`
  font-family: ${eo};
  font-size: ${Nd};
  line-height: ${hf};
  font-weight: initial;
  font-variation-settings: ${wI};
`,Uf=_r`
  font-family: ${eo};
  font-size: ${Hd};
  line-height: ${ql};
  font-weight: initial;
  font-variation-settings: ${xI};
`,$Ue=_r`
  font-family: ${eo};
  font-size: ${Ud};
  line-height: ${pf};
  font-weight: initial;
  font-variation-settings: ${SI};
`,MUe=_r`
  font-family: ${eo};
  font-size: ${Bd};
  line-height: ${ff};
  font-weight: initial;
  font-variation-settings: ${_I};
`,FUe=_r`
  font-family: ${eo};
  font-size: ${Vd};
  line-height: ${mf};
  font-weight: initial;
  font-variation-settings: ${EI};
`,DUe=_r`
  font-family: ${eo};
  font-size: ${zd};
  line-height: ${gf};
  font-weight: initial;
  font-variation-settings: ${TI};
`,LUe=_r`
  font-family: ${eo};
  font-size: ${qd};
  line-height: ${vf};
  font-weight: initial;
  font-variation-settings: ${kI};
`,NUe=_r`
  font-family: ${eo};
  font-size: ${Gd};
  line-height: ${yf};
  font-weight: initial;
  font-variation-settings: ${II};
`,HUe=_r`
  font-family: ${eo};
  font-size: ${jd};
  line-height: ${bf};
  font-weight: initial;
  font-variation-settings: ${AI};
`});var YI,ZI=y(()=>{a();l();c();I();j();$e();Dt();YI=(r,e)=>P`
    ${ne("flex")} :host {
      box-sizing: border-box;
      flex-direction: column;
      ${Ue}
      color: ${Pe};
      gap: calc(${V} * 1px);
    }
  `});var zt,tn,Rr=y(()=>{a();l();c();I();$e();zt=_r`
  outline: calc(${Vt} * 1px) solid ${ec};
  outline-offset: calc(${Vt} * -1px);
`,tn=_r`
  outline: calc(${Vt} * 1px) solid ${ec};
  outline-offset: calc(${Z} * 1px);
`});var xe,Ua=y(()=>{a();l();c();I();$e();xe=_r`(${Ps} + ${Xr}) * ${V}`});var cO,dO,uO,JI,XI=y(()=>{a();l();c();I();j();pe();$e();Rr();Dt();Ua();cO=tt.create("neutral-fill-stealth-rest-on-neutral-fill-layer-rest").withDefault(r=>{let e=Dn.getValueFor(r);return Eo.getValueFor(r).evaluate(r,e.evaluate(r).rest).rest}),dO=tt.create("neutral-fill-stealth-hover-on-neutral-fill-layer-rest").withDefault(r=>{let e=Dn.getValueFor(r);return Eo.getValueFor(r).evaluate(r,e.evaluate(r).rest).hover}),uO=tt.create("neutral-fill-stealth-active-on-neutral-fill-layer-rest").withDefault(r=>{let e=Dn.getValueFor(r);return Eo.getValueFor(r).evaluate(r,e.evaluate(r).rest).active}),JI=(r,e)=>P`
    ${ne("flex")} :host {
      box-sizing: border-box;
      ${Ue};
      flex-direction: column;
      background: ${LI};
      color: ${Pe};
      border: calc(${Z} * 1px) solid ${Hn};
      border-radius: calc(${ho} * 1px);
    }

    .region {
      display: none;
      padding: calc(${V} * 2 * 1px);
      background: ${NI};
    }

    .heading {
      display: grid;
      position: relative;
      grid-template-columns: auto 1fr auto auto;
      align-items: center;
    }

    .button {
      appearance: none;
      border: none;
      background: none;
      grid-column: 2;
      grid-row: 1;
      outline: none;
      margin: calc(${V} * 3 * 1px) 0;
      padding: 0 calc(${V} * 2 * 1px);
      text-align: left;
      color: inherit;
      cursor: pointer;
      font: inherit;
    }

    .button::before {
      content: '';
      position: absolute;
      top: calc(${Z} * -1px);
      left: calc(${Z} * -1px);
      right: calc(${Z} * -1px);
      bottom: calc(${Z} * -1px);
      cursor: pointer;
    }

    .button:${me}::before {
      ${zt}
      border-radius: calc(${ho} * 1px);
    }

    :host(.expanded) .button:${me}::before {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    :host(.expanded) .region {
      display: block;
      border-top: calc(${Z} * 1px) solid ${Hn};
      border-bottom-left-radius: calc((${ho} - ${Z}) * 1px);
      border-bottom-right-radius: calc((${ho} - ${Z}) * 1px);
    }

    .icon {
      display: flex;
      align-items: center;
      justify-content: center;
      grid-column: 4;
      pointer-events: none;
      background: ${cO};
      border-radius: calc(${Ae} * 1px);
      fill: currentcolor;
      width: calc(${xe} * 1px);
      height: calc(${xe} * 1px);
      margin: calc(${V} * 2 * 1px);
    }

    .heading:hover .icon {
      background: ${dO};
    }

    .heading:active .icon {
      background: ${uO};
    }

    slot[name='collapsed-icon'] {
      display: flex;
    }

    :host(.expanded) slot[name='collapsed-icon'] {
      display: none;
    }

    slot[name='expanded-icon'] {
      display: none;
    }

    :host(.expanded) slot[name='expanded-icon'] {
      display: flex;
    }

    .start {
      display: flex;
      align-items: center;
      padding-inline-start: calc(${V} * 2 * 1px);
      justify-content: center;
      grid-column: 1;
    }

    .end {
      display: flex;
      align-items: center;
      justify-content: center;
      grid-column: 3;
    }

    .icon,
    .start,
    .end {
      position: relative;
    }
  `.withBehaviors(de(P`
        .button:${me}::before {
          outline-color: ${_.Highlight};
        }
        .icon {
          fill: ${_.ButtonText};
        }
      `))});var hO,e5=y(()=>{a();l();c();j();XI();hO=Si.compose({baseName:"accordion-item",template:qS,styles:JI,collapsedIcon:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `,expandedIcon:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 7.35c.2.2.5.2.7 0L6 4.21l3.15 3.14a.5.5 0 10.7-.7l-3.5-3.5a.5.5 0 00-.7 0l-3.5 3.5a.5.5 0 000 .7z"/>
    </svg>
  `})});var pO,Jy=y(()=>{a();l();c();j();ZI();e5();pO=kl.compose({baseName:"accordion",template:s_,styles:YI})});function Q(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n}var Uo=y(()=>{a();l();c()});var To,Xy,eb=y(()=>{a();l();c();$e();To=class{constructor(e,t){this.cache=new WeakMap,this.ltr=e,this.rtl=t}bind(e){this.attach(e)}unbind(e){let t=this.cache.get(e);t&&zl.unsubscribe(t)}attach(e){let t=this.cache.get(e)||new Xy(this.ltr,this.rtl,e),o=zl.getValueFor(e);zl.subscribe(t),t.attach(o),this.cache.set(e,t)}},Xy=class{constructor(e,t,o){this.ltr=e,this.rtl=t,this.source=o,this.attached=null}handleChange({target:e,token:t}){this.attach(t.getValueFor(this.source))}attach(e){this.attached!==this[e]&&(this.attached!==null&&this.source.$fastController.removeStyles(this.attached),this.attached=this[e],this.attached!==null&&this.source.$fastController.addStyles(this.attached))}}});var fO,mO,qBe,Ba,gO,vO,yO,bO,t5,GBe,jBe,KBe,CO,r5,wO,Bf,xO,o5,tb=y(()=>{a();l();c();j();fO="0 0 2px rgba(0, 0, 0, 0.14)",mO="0 calc(var(--elevation) * 0.5px) calc((var(--elevation) * 1px)) rgba(0, 0, 0, 0.2)",qBe=`box-shadow: ${fO}, ${mO};`,Ba=tt.create({name:"elevation-shadow",cssCustomPropertyName:null}).withDefault({evaluate:(r,e,t)=>{let o=.12,i=.14;e>16&&(o=.2,i=.24);let n=`0 0 2px rgba(0, 0, 0, ${o})`,s=`0 calc(${e} * 0.5px) calc((${e} * 1px)) rgba(0, 0, 0, ${i})`;return`${n}, ${s}`}}),gO=tt.create("elevation-shadow-card-rest-size").withDefault(4),vO=tt.create("elevation-shadow-card-hover-size").withDefault(8),yO=tt.create("elevation-shadow-card-active-size").withDefault(0),bO=tt.create("elevation-shadow-card-focus-size").withDefault(8),t5=tt.create("elevation-shadow-card-rest").withDefault(r=>Ba.getValueFor(r).evaluate(r,gO.getValueFor(r))),GBe=tt.create("elevation-shadow-card-hover").withDefault(r=>Ba.getValueFor(r).evaluate(r,vO.getValueFor(r))),jBe=tt.create("elevation-shadow-card-active").withDefault(r=>Ba.getValueFor(r).evaluate(r,yO.getValueFor(r))),KBe=tt.create("elevation-shadow-card-focus").withDefault(r=>Ba.getValueFor(r).evaluate(r,bO.getValueFor(r))),CO=tt.create("elevation-shadow-tooltip-size").withDefault(16),r5=tt.create("elevation-shadow-tooltip").withDefault(r=>Ba.getValueFor(r).evaluate(r,CO.getValueFor(r))),wO=tt.create("elevation-shadow-flyout-size").withDefault(32),Bf=tt.create("elevation-shadow-flyout").withDefault(r=>Ba.getValueFor(r).evaluate(r,wO.getValueFor(r))),xO=tt.create("elevation-shadow-dialog-size").withDefault(128),o5=tt.create("elevation-shadow-dialog").withDefault(r=>Ba.getValueFor(r).evaluate(r,xO.getValueFor(r)))});var Vf,tc,zf,i5,qf,Gf,rc,n5=y(()=>{a();l();c();I();pe();j();Ua();$e();Dt();Rr();Vf=(r,e,t,o="[disabled]")=>P`
    ${ne("inline-flex")}
    
    :host {
      position: relative;
      box-sizing: border-box;
      ${Ue}
      height: calc(${xe} * 1px);
      min-width: calc(${xe} * 1px);
      color: ${Pe};
      border-radius: calc(${Ae} * 1px);
      fill: currentcolor;
    }

    .control {
      border: calc(${Z} * 1px) solid transparent;
      flex-grow: 1;
      box-sizing: border-box;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 0 calc((10 + (${V} * 2 * ${Xr})) * 1px);
      white-space: nowrap;
      outline: none;
      text-decoration: none;
      color: inherit;
      border-radius: inherit;
      fill: inherit;
      font-family: inherit;
    }

    .control,
    .end,
    .start {
      font: inherit;
    }

    .control.icon-only {
      padding: 0;
      line-height: 0;
    }

    .control:${me} {
      ${zt}
    }

    .control::-moz-focus-inner {
      border: 0;
    }

    .content {
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
      pointer-events: none;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }
  `,tc=(r,e,t,o="[disabled]")=>P`
    .control {
      background: padding-box linear-gradient(${po}, ${po}),
        border-box ${Zl};
    }

    :host(${t}:hover) .control {
      background: padding-box linear-gradient(${jy}, ${jy}),
        border-box ${Mf};
    }

    :host(${t}:active) .control {
      background: padding-box linear-gradient(${Ky}, ${Ky}),
        border-box ${Ff};
    }

    :host(${o}) .control {
      background: padding-box linear-gradient(${po}, ${po}),
        border-box ${$s};
    }
  `.withBehaviors(de(P`
        .control {
          background: ${_.ButtonFace};
          border-color: ${_.ButtonText};
          color: ${_.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          forced-color-adjust: none;
          background: ${_.HighlightText};
          border-color: ${_.Highlight};
          color: ${_.Highlight};
        }

        :host(${o}) .control {
          background: transparent;
          border-color: ${_.GrayText};
          color: ${_.GrayText};
        }

        .control:${me} {
          outline-color: ${_.CanvasText};
        }

        :host([href]) .control {
          background: transparent;
          border-color: ${_.LinkText};
          color: ${_.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${_.CanvasText};
          color: ${_.CanvasText};
        }
    `)),zf=(r,e,t,o="[disabled]")=>P`
    .control {
      background: padding-box linear-gradient(${Ye}, ${Ye}),
        border-box ${MI};
      color: ${Ho};
    }

    :host(${t}:hover) .control {
      background: padding-box linear-gradient(${to}, ${to}),
        border-box ${FI};
      color: ${Sf};
    }

    :host(${t}:active) .control {
      background: padding-box linear-gradient(${ro}, ${ro}),
        border-box ${DI};
      color: ${_f};
    }

    :host(${o}) .control {
      background: ${Ye};
    }

    .control:${me} {
      box-shadow: 0 0 0 calc(${Vt} * 1px) ${QI} inset !important;
    }
  `.withBehaviors(de(P`
        .control {
          forced-color-adjust: none;
          background: ${_.Highlight};
          color: ${_.HighlightText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: ${_.HighlightText};
          border-color: ${_.Highlight};
          color: ${_.Highlight};
        }

        :host(${o}) .control {
          background: transparent;
          border-color: ${_.GrayText};
          color: ${_.GrayText};
        }

        .control:${me} {
          outline-color: ${_.CanvasText};
          box-shadow: 0 0 0 calc(${Vt} * 1px) ${_.HighlightText} inset !important;
        }

        :host([href]) .control {
          background: ${_.LinkText};
          color: ${_.HighlightText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: ${_.ButtonFace};
          border-color: ${_.LinkText};
          color: ${_.LinkText};
        }
      `)),i5=(r,e,t,o="[disabled]")=>P`
    :host {
      height: auto;
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      min-width: 0;
    }

    .control {
      display: inline;
      padding: 0;
      border: none;
      box-shadow: none;
      line-height: 1;
    }

    :host(${t}) .control {
      color: ${zy};
      text-decoration: underline 1px;
    }

    :host(${t}:hover) .control {
      color: ${qy};
      text-decoration: none;
    }

    :host(${t}:active) .control {
      color: ${Gy};
      text-decoration: none;
    }

    .control:${me} {
      ${tn}
    }
  `.withBehaviors(de(P`
        :host(${t}) .control {
          color: ${_.LinkText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          color: ${_.CanvasText};
        }

        .control:${me} {
          outline-color: ${_.CanvasText};
        }
      `)),qf=(r,e,t,o="[disabled]")=>P`
    :host {
      color: ${zy};
    }

    .control {
      background: ${Nn};
    }

    :host(${t}:hover) .control {
      background: ${Ji};
      color: ${qy};
    }

    :host(${t}:active) .control {
      background: ${Xi};
      color: ${Gy};
    }

    :host(${o}) .control {
      background: ${Nn};
    }
  `.withBehaviors(de(P`
        :host {
          color: ${_.ButtonText};
        }

        .control {
          forced-color-adjust: none;
          background: transparent;
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: transparent;
          border-color: ${_.ButtonText};
          color: ${_.ButtonText};
        }

        :host(${o}) .control {
          background: transparent;
          color: ${_.GrayText};
        }

        .control:${me} {
          outline-color: ${_.CanvasText};
        }

        :host([href]) .control {
          color: ${_.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${_.LinkText};
          color: ${_.LinkText};
        }
      `)),Gf=(r,e,t,o="[disabled]")=>P`
    .control {
      background: transparent !important;
      border-color: ${$s};
    }

    :host(${t}:hover) .control {
      border-color: ${jI};
    }

    :host(${t}:active) .control {
      border-color: ${KI};
    }

    :host(${o}) .control {
      background: transparent !important;
      border-color: ${$s};
    }
  `.withBehaviors(de(P`
        .control {
          border-color: ${_.ButtonText};
          color: ${_.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: ${_.HighlightText};
          border-color: ${_.Highlight};
          color: ${_.Highlight};
        }

        :host(${o}) .control {
          border-color: ${_.GrayText};
          color: ${_.GrayText};
        }

        .control:${me} {
          outline-color: ${_.CanvasText};
        }

        :host([href]) .control {
          border-color: ${_.LinkText};
          color: ${_.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${_.CanvasText};
          color: ${_.CanvasText};
        }
      `)),rc=(r,e,t,o="[disabled]")=>P`
    .control {
      background: ${Nn};
    }

    :host(${t}:hover) .control {
      background: ${Ji};
    }

    :host(${t}:active) .control {
      background: ${Xi};
    }

    :host(${o}) .control {
      background: ${Nn};
    }
  `.withBehaviors(de(P`
        .control {
          forced-color-adjust: none;
          background: transparent;
          color: ${_.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: transparent;
          border-color: ${_.ButtonText};
          color: ${_.ButtonText};
        }

        :host(${o}) .control {
          background: transparent;
          color: ${_.GrayText};
        }
        
        .control:${me} {
          outline-color: ${_.CanvasText};
        }

        :host([href]) .control {
          color: ${_.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${_.LinkText};
          color: ${_.LinkText};
        }
      `))});var SO,_O,EO,TO,Ms,rn,on,li,ci,s5=y(()=>{a();l();c();I();j();pe();$e();Dt();Ua();Rr();SO=tt.create("input-placeholder-rest").withDefault(r=>{let e=Zi.getValueFor(r);return Yl.getValueFor(r).evaluate(r,e.evaluate(r).rest)}),_O=tt.create("input-placeholder-hover").withDefault(r=>{let e=Zi.getValueFor(r);return Yl.getValueFor(r).evaluate(r,e.evaluate(r).hover)}),EO=tt.create("input-filled-placeholder-rest").withDefault(r=>{let e=Ln.getValueFor(r);return Yl.getValueFor(r).evaluate(r,e.evaluate(r).rest)}),TO=tt.create("input-filled-placeholder-hover").withDefault(r=>{let e=Ln.getValueFor(r);return Yl.getValueFor(r).evaluate(r,e.evaluate(r).hover)}),Ms=(r,e,t)=>P`
  :host {
    ${Ue}
    color: ${Pe};
    fill: currentcolor;
    user-select: none;
    position: relative;
  }

  ${t} {
    box-sizing: border-box;
    position: relative;
    color: inherit;
    border: calc(${Z} * 1px) solid transparent;
    border-radius: calc(${Ae} * 1px);
    height: calc(${xe} * 1px);
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
  }

  .control {
    width: 100%;
    outline: none;
  }

  .label {
    display: block;
    color: ${Pe};
    cursor: pointer;
    ${Ue}
    margin-bottom: 4px;
  }

  .label__hidden {
    display: none;
    visibility: hidden;
  }

  :host([disabled]) ${t},
  :host([readonly]) ${t},
  :host([disabled]) .label,
  :host([readonly]) .label,
  :host([disabled]) .control,
  :host([readonly]) .control {
    cursor: ${Bt};
  }

  :host([disabled]) {
    opacity: ${Pt};
  }
`,rn=(r,e,t)=>P`
  @media (forced-colors: none) {
    :host(:not([disabled]):active)::after {
      left: 50%;
      width: 40%;
      transform: translateX(-50%);
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    :host(:not([disabled]):focus-within)::after {
      left: 0;
      width: 100%;
      transform: none;
    }

    :host(:not([disabled]):active)::after,
    :host(:not([disabled]):focus-within:not(:active))::after {
      content: '';
      position: absolute;
      height: calc(${Vt} * 1px);
      bottom: 0;
      border-bottom: calc(${Vt} * 1px) solid ${Ye};
      border-bottom-left-radius: calc(${Ae} * 1px);
      border-bottom-right-radius: calc(${Ae} * 1px);
      z-index: 2;
      transition: all 300ms cubic-bezier(0.1, 0.9, 0.2, 1);
    }
  }
`,on=(r,e,t,o=":not([disabled]):not(:focus-within)")=>P`
  ${t} {
    background: padding-box linear-gradient(${Kd}, ${Kd}),
      border-box ${Yy};
  }

  :host(${o}:hover) ${t} {
    background: padding-box linear-gradient(${Wy}, ${Wy}),
      border-box ${WI};
  }

  :host(:not([disabled]):focus-within) ${t} {
    background: padding-box linear-gradient(${Qy}, ${Qy}),
      border-box ${Yy};
  }
  
  :host([disabled]) ${t} {
    background: padding-box linear-gradient(${Kd}, ${Kd}),
      border-box ${$s};
  }

  .control::placeholder {
    color: ${SO};
  }

  :host(${o}:hover) .control::placeholder {
    color: ${_O};
  }
`,li=(r,e,t,o=":not([disabled]):not(:focus-within)")=>P`
  ${t} {
    background: ${si};
  }

  :host(${o}:hover) ${t} {
    background: ${Ql};
  }

  :host(:not([disabled]):focus-within) ${t} {
    background: ${UI};
  }

  :host([disabled]) ${t} {
    background: ${si};
  }

  .control::placeholder {
    color: ${EO};
  }

  :host(${o}:hover) .control::placeholder {
    color: ${TO};
  }
`,ci=(r,e,t,o=":not([disabled]):not(:focus-within)")=>P`
  :host {
    color: ${_.ButtonText};
  }

  ${t} {
    background: ${_.ButtonFace};
    border-color: ${_.ButtonText};
  }

  :host(${o}:hover) ${t},
  :host(:not([disabled]):focus-within) ${t} {
    border-color: ${_.Highlight};
  }

  :host([disabled]) ${t} {
    opacity: 1;
    background: ${_.ButtonFace};
    border-color: ${_.GrayText};
  }

  .control::placeholder,
  :host(${o}:hover) .control::placeholder {
    color: ${_.CanvasText};
  }

  :host(:not([disabled]):focus) ${t} {
    ${zt}
    outline-color: ${_.Highlight};
  }

  :host([disabled]) {
    opacity: 1;
    color: ${_.GrayText};
  }

  :host([disabled]) ::placeholder,
  :host([disabled]) ::-webkit-input-placeholder {
    color: ${_.GrayText};
  }
`});var a5=y(()=>{a();l();c();n5();s5();Dt()});var Et=y(()=>{a();l();c();eb();tb();Rr();a5();Ua()});function dt(r,e){return new Up("appearance",r,e)}var Un=y(()=>{a();l();c();j()});var Va,l5,c5=y(()=>{a();l();c();Et();Un();Va="[href]",l5=(r,e)=>Vf(r,e,Va).withBehaviors(dt("neutral",tc(r,e,Va)),dt("accent",zf(r,e,Va)),dt("hypertext",i5(r,e,Va)),dt("lightweight",qf(r,e,Va)),dt("outline",Gf(r,e,Va)),dt("stealth",rc(r,e,Va)))});var jf,kO,rb=y(()=>{a();l();c();Uo();I();j();c5();jf=class extends Nr{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){var e,t;let o=this.defaultSlottedContent.filter(i=>i.nodeType===Node.ELEMENT_NODE);o.length===1&&o[0]instanceof SVGElement?(e=this.control)===null||e===void 0||e.classList.add("icon-only"):(t=this.control)===null||t===void 0||t.classList.remove("icon-only")}};Q([w],jf.prototype,"appearance",void 0);kO=jf.compose({baseName:"anchor",baseClass:Nr,template:lp,styles:l5,shadowOptions:{delegatesFocus:!0}})});var d5,u5=y(()=>{a();l();c();I();d5=(r,e)=>P`
  :host {
    contain: layout;
    display: block;
  }
`});var IO,ob=y(()=>{a();l();c();j();u5();IO=Re.compose({baseName:"anchored-region",template:L_,styles:d5})});var h5,p5=y(()=>{a();l();c();I();j();$e();Dt();h5=(r,e)=>P`
    ${ne("inline-block")} :host {
      box-sizing: border-box;
      ${Uf};
    }

    .control {
      border-radius: calc(${Ae} * 1px);
      padding: calc(((${V} * 0.5) - ${Z}) * 1px) calc((${V} - ${Z}) * 1px);
      border: calc(${Z} * 1px) solid transparent;
    }

    :host(.lightweight) .control {
      background: transparent;
      color: ${Pe};
      font-weight: 600;
    }

    :host(.accent) .control {
      background: ${Ye};
      color: ${Ho};
    }

    :host(.neutral) .control {
      background: ${si};
      color: ${Pe};
    }

    :host([circular]) .control {
      border-radius: 100px;
      min-width: calc(${ql} - calc(${V} * 1px));
      display: flex;
      align-items: center;
      justify-content: center;
    }
  `});var Kf,AO,ib=y(()=>{a();l();c();Uo();I();j();p5();Kf=class extends fs{constructor(){super(...arguments),this.appearance="lightweight"}appearanceChanged(e,t){e!==t&&W.queueUpdate(()=>{this.classList.add(t),this.classList.remove(e)})}};Q([w({mode:"fromView"})],Kf.prototype,"appearance",void 0);AO=Kf.compose({baseName:"badge",baseClass:fs,template:j_,styles:h5})});var f5,m5=y(()=>{a();l();c();I();j();Dt();f5=(r,e)=>P`
  ${ne("inline-block")} :host {
    box-sizing: border-box;
    ${Ue};
  }

  .list {
    display: flex;
  }
`});var RO,nb=y(()=>{a();l();c();j();m5();RO=vd.compose({baseName:"breadcrumb",template:X_,styles:f5})});var g5,v5=y(()=>{a();l();c();I();j();pe();$e();Dt();Et();Rr();g5=(r,e)=>P`
    ${ne("inline-flex")} :host {
      background: transparent;
      color: ${Pe};
      fill: currentcolor;
      box-sizing: border-box;
      ${Ue};
      min-width: calc(${xe} * 1px);
      border-radius: calc(${Ae} * 1px);
    }

    .listitem {
      display: flex;
      align-items: center;
      border-radius: inherit;
    }

    .control {
      position: relative;
      align-items: center;
      box-sizing: border-box;
      color: inherit;
      fill: inherit;
      cursor: pointer;
      display: flex;
      outline: none;
      text-decoration: none;
      white-space: nowrap;
      border-radius: inherit;
    }

    .control:hover {
      color: ${qI};
    }

    .control:active {
      color: ${GI};
    }

    .control:${me} {
      ${tn}
    }

    :host(:not([href])),
    :host([aria-current]) .control {
      color: ${Pe};
      fill: currentcolor;
      cursor: default;
    }

    .start {
      display: flex;
      margin-inline-end: 6px;
    }

    .end {
      display: flex;
      margin-inline-start: 6px;
    }

    .separator {
      display: flex;
    }
  `.withBehaviors(de(P`
        :host(:not([href])),
        .start,
        .end,
        .separator {
          background: ${_.ButtonFace};
          color: ${_.ButtonText};
          fill: currentcolor;
        }
        .separator {
          fill: ${_.ButtonText};
        }
        :host([href]) {
          forced-color-adjust: none;
          background: ${_.ButtonFace};
          color: ${_.LinkText};
        }
        :host([href]) .control:hover {
          background: ${_.LinkText};
          color: ${_.HighlightText};
          fill: currentcolor;
        }
        .control:${me} {
          outline-color: ${_.LinkText};
        }
      `))});var PO,sb=y(()=>{a();l();c();j();v5();PO=kn.compose({baseName:"breadcrumb-item",template:Y_,styles:g5,shadowOptions:{delegatesFocus:!0},separator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>
    </svg>
  `})});var za,Fs,y5,b5=y(()=>{a();l();c();I();j();Et();Un();$e();za=":not([disabled])",Fs="[disabled]",y5=(r,e)=>P`
    :host(${za}) .control {
      cursor: pointer;
    }

    :host(${Fs}) .control {
      cursor: ${Bt};
    }

    @media (forced-colors: none) {
      :host(${Fs}) .control {
        opacity: ${Pt};
      }
    }

    ${Vf(r,e,za,Fs)}
  `.withBehaviors(dt("neutral",tc(r,e,za,Fs)),dt("accent",zf(r,e,za,Fs)),dt("lightweight",qf(r,e,za,Fs)),dt("outline",Gf(r,e,za,Fs)),dt("stealth",rc(r,e,za,Fs)))});var Wf,qa,ab=y(()=>{a();l();c();Uo();I();j();b5();Wf=class extends Hr{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){let e=this.defaultSlottedContent.filter(t=>t.nodeType===Node.ELEMENT_NODE);e.length===1&&e[0]instanceof SVGElement?this.control.classList.add("icon-only"):this.control.classList.remove("icon-only")}};Q([w],Wf.prototype,"appearance",void 0);qa=Wf.compose({baseName:"button",baseClass:Hr,template:oE,styles:y5,shadowOptions:{delegatesFocus:!0}})});var OO,$O,C5,w5=y(()=>{a();l();c();I();j();pe();$e();Et();Dt();OO=P`
.day.disabled::before {
  transform: translate(-50%, 0) rotate(45deg);
}
`,$O=P`
.day.disabled::before {
  transform: translate(50%, 0) rotate(-45deg);
}
`,C5=(r,e)=>P`
${ne("inline-block")} :host {
  --calendar-cell-size: calc((${Ps} + 2 + ${Xr}) * ${V} * 1px);
  --calendar-gap: 2px;
  ${Ue}
  color: ${Pe};
}

.title {
  padding: calc(${V} * 2px);
  font-weight: 600;
}

.days {
  text-align: center;
}

.week-days,
.week {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  grid-gap: var(--calendar-gap);
  border: 0;
  padding: 0;
}

.day,
.week-day {
  border: 0;
  width: var(--calendar-cell-size);
  height: var(--calendar-cell-size);
  line-height: var(--calendar-cell-size);
  padding: 0;
  box-sizing: initial;
}

.week-day {
  font-weight: 600;
}

.day {
  border: calc(${Z} * 1px) solid transparent;
  border-radius: calc(${Ae} * 1px);
}

.interact .day {
  cursor: pointer;
}

.date {
  height: 100%;
}

.inactive .date,
.inactive.disabled::before {
  color: ${en};
}

.disabled::before {
  content: '';
  display: inline-block;
  width: calc(var(--calendar-cell-size) * .8);
  height: calc(${Z} * 1px);
  background: currentColor;
  position: absolute;
  margin-top: calc(var(--calendar-cell-size) / 2);
  transform-origin: center;
  z-index: 1;
}

.selected {
  color: ${Ye};
  border: 1px solid ${Ye};
  background: ${Ee};
}

.selected + .selected {
  border-start-start-radius: 0;
  border-end-start-radius: 0;
  border-inline-start-width: 0;
  padding-inline-start: calc(var(--calendar-gap) + (${Z} + ${Ae}) * 1px);
  margin-inline-start: calc((${Ae} * -1px) - var(--calendar-gap));
}

.today.disabled::before {
  color: ${Ho};
}

.today .date {
  color: ${Ho};
  background: ${Ye};
  border-radius: 50%;
  position: relative;
}
`.withBehaviors(de(P`
          .day.selected {
              color: ${_.Highlight};
          }

          .today .date {
              background: ${_.Highlight};
              color: ${_.HighlightText};
          }
      `),new To(OO,$O))});var Qf,MO,x5=y(()=>{a();l();c();Uo();I();j();w5();Qf=class extends ao{constructor(){super(...arguments),this.readonly=!0}};Q([w({converter:_n})],Qf.prototype,"readonly",void 0);MO=Qf.compose({baseName:"calendar",template:wE,styles:C5,title:CE})});var S5,_5=y(()=>{a();l();c();I();j();pe();$e();Et();S5=(r,e)=>P`
    ${ne("block")} :host {
      display: block;
      contain: content;
      height: var(--card-height, 100%);
      width: var(--card-width, 100%);
      box-sizing: border-box;
      background: ${Ee};
      color: ${Pe};
      border: calc(${Z} * 1px) solid ${Hn};
      border-radius: calc(${ho} * 1px);
      box-shadow: ${t5};
    }

    :host {
      content-visibility: auto;
    }
  `.withBehaviors(de(P`
        :host {
          background: ${_.Canvas};
          color: ${_.CanvasText};
        }
      `))});var Wd,Qd,lb=y(()=>{a();l();c();Uo();j();I();ks();$e();Is();ef();_5();Wd=class extends bd{cardFillColorChanged(e,t){if(t){let o=Jr(t);o!==null&&(this.neutralPaletteSource=t,Ee.setValueFor(this,vr.create(o.r,o.g,o.b)))}}neutralPaletteSourceChanged(e,t){if(t){let o=Jr(t),i=vr.create(o.r,o.g,o.b);_t.setValueFor(this,Rs.create(i))}}handleChange(e,t){this.cardFillColor||Ee.setValueFor(this,o=>Dn.getValueFor(o).evaluate(o,Ee.getValueFor(e)).rest)}connectedCallback(){super.connectedCallback();let e=Ta(this);if(e){let t=ce.getNotifier(e);t.subscribe(this,"fillColor"),t.subscribe(this,"neutralPalette"),this.handleChange(e,"fillColor")}}};Q([w({attribute:"card-fill-color",mode:"fromView"})],Wd.prototype,"cardFillColor",void 0);Q([w({attribute:"neutral-palette-source",mode:"fromView"})],Wd.prototype,"neutralPaletteSource",void 0);Qd=Wd.compose({baseName:"card",baseClass:bd,template:_E,styles:S5})});var E5,T5=y(()=>{a();l();c();I();j();pe();Et();$e();Dt();Rr();E5=(r,e)=>P`
    ${ne("inline-flex")} :host {
      align-items: center;
      outline: none;
      ${""} user-select: none;
    }

    .control {
      position: relative;
      width: calc((${xe} / 2 + ${V}) * 1px);
      height: calc((${xe} / 2 + ${V}) * 1px);
      box-sizing: border-box;
      border-radius: calc(${Ae} * 1px);
      border: calc(${Z} * 1px) solid ${ai};
      background: ${Gl};
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      ${Ue}
      color: ${Pe};
      ${""} padding-inline-start: calc(${V} * 2px + 2px);
      margin-inline-end: calc(${V} * 2px + 2px);
      cursor: pointer;
    }

    slot[name='checked-indicator'],
    slot[name='indeterminate-indicator'] {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      fill: ${Pe};
      opacity: 0;
      pointer-events: none;
    }

    slot[name='indeterminate-indicator'] {
      position: absolute;
      top: 0;
    }

    :host(.checked) slot[name='checked-indicator'],
    :host(.checked) slot[name='indeterminate-indicator'] {
      fill: ${Ho};
    }

    :host(:not(.disabled):hover) .control {
      background: ${jl};
      border-color: ${Jl};
    }

    :host(:not(.disabled):active) .control {
      background: ${Kl};
      border-color: ${Xl};
    }

    :host(:${me}) .control {
      background: ${Wl};
      ${tn}
    }

    :host(.checked) .control {
      background: ${Ye};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .control {
      background: ${to};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .control {
      background: ${ro};
      border-color: transparent;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${Bt};
    }

    :host(.checked:not(.indeterminate)) slot[name='checked-indicator'],
    :host(.indeterminate) slot[name='indeterminate-indicator'] {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${Pt};
    }
  `.withBehaviors(de(P`
        .control {
          border-color: ${_.FieldText};
          background: ${_.Field};
        }
        :host(:not(.disabled):hover) .control,
        :host(:not(.disabled):active) .control {
          border-color: ${_.Highlight};
          background: ${_.Field};
        }
        slot[name='checked-indicator'],
        slot[name='indeterminate-indicator'] {
          fill: ${_.FieldText};
        }
        :host(:${me}) .control {
          forced-color-adjust: none;
          outline-color: ${_.FieldText};
          background: ${_.Field};
          border-color: ${_.Highlight};
        }
        :host(.checked) .control {
          background: ${_.Highlight};
          border-color: ${_.Highlight};
        }
        :host(.checked:not(.disabled):hover) .control,
        :host(.checked:not(.disabled):active) .control {
          background: ${_.HighlightText};
          border-color: ${_.Highlight};
        }
        :host(.checked) slot[name='checked-indicator'],
        :host(.checked) slot[name='indeterminate-indicator'] {
          fill: ${_.HighlightText};
        }
        :host(.checked:hover ) .control slot[name='checked-indicator'],
        :host(.checked:hover ) .control slot[name='indeterminate-indicator'] {
          fill: ${_.Highlight};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .control {
          border-color: ${_.GrayText};
          background: ${_.Field};
        }
        :host(.disabled) slot[name='checked-indicator'],
        :host(.checked.disabled:hover) .control slot[name='checked-indicator'],
        :host(.disabled) slot[name='indeterminate-indicator'],
        :host(.checked.disabled:hover) .control slot[name='indeterminate-indicator'] {
          fill: ${_.GrayText};
        }
      `))});var cb,db=y(()=>{a();l();c();j();T5();cb=Ea.compose({baseName:"checkbox",template:IE,styles:E5,checkedIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>
    </svg>
  `,indeterminateIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M3 8c0-.28.22-.5.5-.5h9a.5.5 0 010 1h-9A.5.5 0 013 8z"/>
    </svg>
  `})});var k5,Yf,I5,ub,FO,A5,hb=y(()=>{a();l();c();I();j();pe();tb();Ua();Un();$e();Dt();Rr();Et();k5=".control",Yf=":not([disabled]):not([open])",I5="[disabled]",ub=(r,e)=>P`
    ${ne("inline-flex")}
    
    :host {
      border-radius: calc(${Ae} * 1px);
      box-sizing: border-box;
      color: ${Pe};
      fill: currentcolor;
      font-family: ${eo};
      position: relative;
      user-select: none;
      min-width: 250px;
      vertical-align: top;
    }

    .listbox {
      box-shadow: ${Bf};
      background: ${Ee};
      border-radius: calc(${ho} * 1px);
      box-sizing: border-box;
      display: inline-flex;
      flex-direction: column;
      left: 0;
      max-height: calc(var(--max-height) - (${xe} * 1px));
      padding: calc((${V} - ${Z} ) * 1px);
      overflow-y: auto;
      position: absolute;
      width: 100%;
      z-index: 1;
      margin: 1px 0;
      border: calc(${Z} * 1px) solid transparent;
    }

    .listbox[hidden] {
      display: none;
    }

    .control {
      border: calc(${Z} * 1px) solid transparent;
      border-radius: calc(${Ae} * 1px);
      height: calc(${xe} * 1px);
      align-items: center;
      box-sizing: border-box;
      cursor: pointer;
      display: flex;
      ${Ue}
      min-height: 100%;
      padding: 0 calc(${V} * 2.25px);
      width: 100%;
    }

    :host(:${me}) {
      ${zt}
    }

    :host([disabled]) .control {
      cursor: ${Bt};
      opacity: ${Pt};
      user-select: none;
    }

    :host([open][position='above']) .listbox {
      bottom: calc((${xe} + ${V} * 2) * 1px);
    }

    :host([open][position='below']) .listbox {
      top: calc((${xe} + ${V} * 2) * 1px);
    }

    .selected-value {
      font-family: inherit;
      flex: 1 1 auto;
      text-align: start;
    }

    .indicator {
      flex: 0 0 auto;
      margin-inline-start: 1em;
    }

    slot[name='listbox'] {
      display: none;
      width: 100%;
    }

    :host([open]) slot[name='listbox'] {
      display: flex;
      position: absolute;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }

    .start,
    .end,
    .indicator,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([role='option']) {
      flex: 0 0 auto;
    }
  `,FO=(r,e)=>P`
    :host([open]) .listbox {
      background: ${_.ButtonFace};
      border-color: ${_.CanvasText};
    }
  `,A5=(r,e)=>ub(r,e).withBehaviors(dt("outline",tc(r,e,Yf,I5)),dt("filled",li(r,e,k5,Yf).withBehaviors(de(ci(r,e,k5,Yf)))),dt("stealth",rc(r,e,Yf,I5)),de(FO(r,e)))});var Zf,pb,R5,P5=y(()=>{a();l();c();I();j();hb();Un();$e();Dt();Et();Zf=".control",pb=":not([disabled]):not([open])",R5=(r,e)=>P`
    ${ub(r,e)}

    ${rn(r,e,Zf)}

    :host(:empty) .listbox {
      display: none;
    }

    :host([disabled]) *,
    :host([disabled]) {
      cursor: ${Bt};
      user-select: none;
    }

    :host(:active) .selected-value {
      user-select: none;
    }

    .selected-value {
      -webkit-appearance: none;
      background: transparent;
      border: none;
      color: inherit;
      ${Ue}
      height: calc(100% - ${Z} * 1px));
      margin: auto 0;
      width: 100%;
      outline: none;
    }
  `.withBehaviors(dt("outline",on(r,e,Zf,pb)),dt("filled",li(r,e,Zf,pb)),de(ci(r,e,Zf,pb)))});var Jf,DO,fb=y(()=>{a();l();c();Uo();I();j();$e();P5();Jf=class extends Jo{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&Ee.setValueFor(this.listbox,Yi)}};Q([w({mode:"fromView"})],Jf.prototype,"appearance",void 0);DO=Jf.compose({baseName:"combobox",baseClass:Jo,shadowOptions:{delegatesFocus:!0},template:FE,styles:R5,indicator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `})});var O5,$5=y(()=>{a();l();c();I();O5=(r,e)=>P`
  :host {
    display: flex;
    position: relative;
    flex-direction: column;
  }
`});var M5,F5=y(()=>{a();l();c();I();j();$e();M5=(r,e)=>P`
    :host {
      display: grid;
      padding: 1px 0;
      box-sizing: border-box;
      width: 100%;
      border-bottom: calc(${Z} * 1px) solid ${Ha};
    }

    :host(.header) {
    }

    :host(.sticky-header) {
      background: ${Ee};
      position: sticky;
      top: 0;
    }
  `.withBehaviors(de(P`
        :host {
        }
      `))});var D5,L5=y(()=>{a();l();c();I();pe();j();$e();Dt();Rr();D5=(r,e)=>P`
    :host {
      padding: calc((${V} + ${Vt} - ${Z}) * 1px) calc(((${V} * 3) + ${Vt} - ${Z}) * 1px);
      color: ${Pe};
      box-sizing: border-box;
      ${Ue}
      border: transparent calc(${Z} * 1px) solid;
      overflow: hidden;
      white-space: nowrap;
      border-radius: calc(${Ae} * 1px);
    }

    :host(.column-header) {
      font-weight: 600;
    }

    :host(:${me}) {
      ${zt}
    }
  `.withBehaviors(de(P`
        :host {
          forced-color-adjust: none;
          background: ${_.Field};
          color: ${_.FieldText};
        }

        :host(:${me}) {
          outline-color: ${_.FieldText};
        }
      `))});var LO,NO,HO,mb=y(()=>{a();l();c();j();$5();F5();L5();LO=xo.compose({baseName:"data-grid-cell",template:yE,styles:D5}),NO=Jt.compose({baseName:"data-grid-row",template:gE,styles:M5}),HO=dr.compose({baseName:"data-grid",template:pE,styles:O5})});function fe(r){return(e,t)=>{e[t+"Changed"]=function(o,i){i!=null?r.setValueFor(this,i):r.deleteValueFor(this)}}}var gb,N5,ue,UO,vb=y(()=>{a();l();c();Uo();ks();I();j();pe();Is();$e();gb={toView(r){return r==null?null:r?.toColorString()},fromView(r){if(r==null)return null;let e=Jr(r);return e?vr.create(e.r,e.g,e.b):null}},N5=P`
  :host {
    background-color: ${Ee};
    color: ${Pe};
  }
`.withBehaviors(de(P`
      :host {
        background-color: ${_.Canvas};
        box-shadow: 0 0 0 1px ${_.CanvasText};
        color: ${_.CanvasText};
      }
    `));ue=class extends B{constructor(){super(),this.noPaint=!1;let e={handleChange:this.noPaintChanged.bind(this)};ce.getNotifier(this).subscribe(e,"fillColor"),ce.getNotifier(this).subscribe(e,"baseLayerLuminance")}connectedCallback(){super.connectedCallback(),this.noPaintChanged()}noPaintChanged(){!this.noPaint&&(this.fillColor!==void 0||this.baseLayerLuminance)?this.$fastController.addStyles(N5):this.$fastController.removeStyles(N5)}};Q([w({attribute:"no-paint",mode:"boolean"})],ue.prototype,"noPaint",void 0);Q([w({attribute:"fill-color",converter:gb,mode:"fromView"}),fe(Ee)],ue.prototype,"fillColor",void 0);Q([w({attribute:"accent-base-color",converter:gb,mode:"fromView"}),fe(By)],ue.prototype,"accentBaseColor",void 0);Q([w({attribute:"neutral-base-color",converter:gb,mode:"fromView"}),fe(Uy)],ue.prototype,"neutralBaseColor",void 0);Q([w({converter:ee}),fe(Xr)],ue.prototype,"density",void 0);Q([w({attribute:"design-unit",converter:ee}),fe(V)],ue.prototype,"designUnit",void 0);Q([w({attribute:"direction"}),fe(zl)],ue.prototype,"direction",void 0);Q([w({attribute:"base-height-multiplier",converter:ee}),fe(Ps)],ue.prototype,"baseHeightMultiplier",void 0);Q([w({attribute:"base-horizontal-spacing-multiplier",converter:ee}),fe(CI)],ue.prototype,"baseHorizontalSpacingMultiplier",void 0);Q([w({attribute:"control-corner-radius",converter:ee}),fe(Ae)],ue.prototype,"controlCornerRadius",void 0);Q([w({attribute:"layer-corner-radius",converter:ee}),fe(ho)],ue.prototype,"layerCornerRadius",void 0);Q([w({attribute:"stroke-width",converter:ee}),fe(Z)],ue.prototype,"strokeWidth",void 0);Q([w({attribute:"focus-stroke-width",converter:ee}),fe(Vt)],ue.prototype,"focusStrokeWidth",void 0);Q([w({attribute:"disabled-opacity",converter:ee}),fe(Pt)],ue.prototype,"disabledOpacity",void 0);Q([w({attribute:"type-ramp-minus-2-font-size"}),fe(Ud)],ue.prototype,"typeRampMinus2FontSize",void 0);Q([w({attribute:"type-ramp-minus-2-line-height"}),fe(pf)],ue.prototype,"typeRampMinus2LineHeight",void 0);Q([w({attribute:"type-ramp-minus-1-font-size"}),fe(Hd)],ue.prototype,"typeRampMinus1FontSize",void 0);Q([w({attribute:"type-ramp-minus-1-line-height"}),fe(ql)],ue.prototype,"typeRampMinus1LineHeight",void 0);Q([w({attribute:"type-ramp-base-font-size"}),fe(Nd)],ue.prototype,"typeRampBaseFontSize",void 0);Q([w({attribute:"type-ramp-base-line-height"}),fe(hf)],ue.prototype,"typeRampBaseLineHeight",void 0);Q([w({attribute:"type-ramp-plus-1-font-size"}),fe(Bd)],ue.prototype,"typeRampPlus1FontSize",void 0);Q([w({attribute:"type-ramp-plus-1-line-height"}),fe(ff)],ue.prototype,"typeRampPlus1LineHeight",void 0);Q([w({attribute:"type-ramp-plus-2-font-size"}),fe(Vd)],ue.prototype,"typeRampPlus2FontSize",void 0);Q([w({attribute:"type-ramp-plus-2-line-height"}),fe(mf)],ue.prototype,"typeRampPlus2LineHeight",void 0);Q([w({attribute:"type-ramp-plus-3-font-size"}),fe(zd)],ue.prototype,"typeRampPlus3FontSize",void 0);Q([w({attribute:"type-ramp-plus-3-line-height"}),fe(gf)],ue.prototype,"typeRampPlus3LineHeight",void 0);Q([w({attribute:"type-ramp-plus-4-font-size"}),fe(qd)],ue.prototype,"typeRampPlus4FontSize",void 0);Q([w({attribute:"type-ramp-plus-4-line-height"}),fe(vf)],ue.prototype,"typeRampPlus4LineHeight",void 0);Q([w({attribute:"type-ramp-plus-5-font-size"}),fe(Gd)],ue.prototype,"typeRampPlus5FontSize",void 0);Q([w({attribute:"type-ramp-plus-5-line-height"}),fe(yf)],ue.prototype,"typeRampPlus5LineHeight",void 0);Q([w({attribute:"type-ramp-plus-6-font-size"}),fe(jd)],ue.prototype,"typeRampPlus6FontSize",void 0);Q([w({attribute:"type-ramp-plus-6-line-height"}),fe(bf)],ue.prototype,"typeRampPlus6LineHeight",void 0);Q([w({attribute:"accent-fill-rest-delta",converter:ee}),fe(af)],ue.prototype,"accentFillRestDelta",void 0);Q([w({attribute:"accent-fill-hover-delta",converter:ee}),fe(lf)],ue.prototype,"accentFillHoverDelta",void 0);Q([w({attribute:"accent-fill-active-delta",converter:ee}),fe(cf)],ue.prototype,"accentFillActiveDelta",void 0);Q([w({attribute:"accent-fill-focus-delta",converter:ee}),fe(df)],ue.prototype,"accentFillFocusDelta",void 0);Q([w({attribute:"accent-foreground-rest-delta",converter:ee}),fe(gy)],ue.prototype,"accentForegroundRestDelta",void 0);Q([w({attribute:"accent-foreground-hover-delta",converter:ee}),fe(vy)],ue.prototype,"accentForegroundHoverDelta",void 0);Q([w({attribute:"accent-foreground-active-delta",converter:ee}),fe(yy)],ue.prototype,"accentForegroundActiveDelta",void 0);Q([w({attribute:"accent-foreground-focus-delta",converter:ee}),fe(by)],ue.prototype,"accentForegroundFocusDelta",void 0);Q([w({attribute:"neutral-fill-rest-delta",converter:ee}),fe(Cy)],ue.prototype,"neutralFillRestDelta",void 0);Q([w({attribute:"neutral-fill-hover-delta",converter:ee}),fe(wy)],ue.prototype,"neutralFillHoverDelta",void 0);Q([w({attribute:"neutral-fill-active-delta",converter:ee}),fe(xy)],ue.prototype,"neutralFillActiveDelta",void 0);Q([w({attribute:"neutral-fill-focus-delta",converter:ee}),fe(Sy)],ue.prototype,"neutralFillFocusDelta",void 0);Q([w({attribute:"neutral-fill-input-rest-delta",converter:ee}),fe(_y)],ue.prototype,"neutralFillInputRestDelta",void 0);Q([w({attribute:"neutral-fill-input-hover-delta",converter:ee}),fe(Ey)],ue.prototype,"neutralFillInputHoverDelta",void 0);Q([w({attribute:"neutral-fill-input-active-delta",converter:ee}),fe(Ty)],ue.prototype,"neutralFillInputActiveDelta",void 0);Q([w({attribute:"neutral-fill-input-focus-delta",converter:ee}),fe(ky)],ue.prototype,"neutralFillInputFocusDelta",void 0);Q([w({attribute:"neutral-fill-layer-rest-delta",converter:ee}),fe(Mn)],ue.prototype,"neutralFillLayerRestDelta",void 0);Q([w({attribute:"neutral-fill-stealth-rest-delta",converter:ee}),fe(Iy)],ue.prototype,"neutralFillStealthRestDelta",void 0);Q([w({attribute:"neutral-fill-stealth-hover-delta",converter:ee}),fe(Ay)],ue.prototype,"neutralFillStealthHoverDelta",void 0);Q([w({attribute:"neutral-fill-stealth-active-delta",converter:ee}),fe(Ry)],ue.prototype,"neutralFillStealthActiveDelta",void 0);Q([w({attribute:"neutral-fill-stealth-focus-delta",converter:ee}),fe(Py)],ue.prototype,"neutralFillStealthFocusDelta",void 0);Q([w({attribute:"neutral-fill-strong-hover-delta",converter:ee}),fe(Oy)],ue.prototype,"neutralFillStrongHoverDelta",void 0);Q([w({attribute:"neutral-fill-strong-active-delta",converter:ee}),fe($y)],ue.prototype,"neutralFillStrongActiveDelta",void 0);Q([w({attribute:"neutral-fill-strong-focus-delta",converter:ee}),fe(My)],ue.prototype,"neutralFillStrongFocusDelta",void 0);Q([w({attribute:"base-layer-luminance",converter:ee}),fe(Os)],ue.prototype,"baseLayerLuminance",void 0);Q([w({attribute:"neutral-stroke-divider-rest-delta",converter:ee}),fe(Hy)],ue.prototype,"neutralStrokeDividerRestDelta",void 0);Q([w({attribute:"neutral-stroke-rest-delta",converter:ee}),fe(Fy)],ue.prototype,"neutralStrokeRestDelta",void 0);Q([w({attribute:"neutral-stroke-hover-delta",converter:ee}),fe(Dy)],ue.prototype,"neutralStrokeHoverDelta",void 0);Q([w({attribute:"neutral-stroke-active-delta",converter:ee}),fe(Ly)],ue.prototype,"neutralStrokeActiveDelta",void 0);Q([w({attribute:"neutral-stroke-focus-delta",converter:ee}),fe(Ny)],ue.prototype,"neutralStrokeFocusDelta",void 0);UO=ue.compose({baseName:"design-system-provider",template:R` <slot></slot> `,styles:P`
    ${ne("block")}
  `})});var H5,U5=y(()=>{a();l();c();I();Et();$e();H5=(r,e)=>P`
  :host([hidden]) {
    display: none;
  }

  :host {
    --dialog-height: 480px;
    --dialog-width: 640px;
    display: block;
  }

  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    touch-action: none;
  }

  .positioning-region {
    display: flex;
    justify-content: center;
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    overflow: auto;
  }

  .control {
    box-shadow: ${o5};
    margin-top: auto;
    margin-bottom: auto;
    border-radius: calc(${ho} * 1px);
    width: var(--dialog-width);
    height: var(--dialog-height);
    background: ${Ee};
    z-index: 1;
    border: calc(${Z} * 1px) solid transparent;
  }
`});var yb,bb=y(()=>{a();l();c();j();U5();yb=ji.compose({baseName:"dialog",template:zE,styles:H5})});var B5,V5=y(()=>{a();l();c();I();j();$e();B5=(r,e)=>P`
    ${ne("block")} :host {
      box-sizing: content-box;
      height: 0;
      border: none;
      border-top: calc(${Z} * 1px) solid ${Ha};
    }

    :host([orientation="vertical"]) {
      border: none;
      height: 100%;
      margin: 0 calc(${V} * 1px);
      border-left: calc(${Z} * 1px) solid ${Ha};
  }
  `});var BO,Cb=y(()=>{a();l();c();j();V5();BO=bs.compose({baseName:"divider",template:rT,styles:B5})});var z5,q5=y(()=>{a();l();c();I();j();pe();Et();$e();Rr();z5=(r,e)=>P`
    ${ne("inline-flex")} :host {
      height: calc((${xe} + ${V}) * 1px);
      justify-content: center;
      align-items: center;
      fill: currentcolor;
      color: ${Rf};
      background: padding-box linear-gradient(${po}, ${po}),
        border-box ${Zl};
      box-sizing: border-box;
      border: calc(${Z} * 1px) solid transparent;
      border-radius: calc(${Ae} * 1px);
      padding: 0;
    }

    :host(.disabled) {
      opacity: ${Pt};
      cursor: ${Bt};
      pointer-events: none;
    }

    .next,
    .previous {
      display: flex;
    }

    :host(:not(.disabled):hover) {
      cursor: pointer;
    }

    :host(:not(.disabled):hover) {
      color: ${VI};
    }

    :host(:not(.disabled):active) {
      color: ${zI};
    }

    :host(:${me}) {
      ${zt}
    }

    :host::-moz-focus-inner {
      border: 0;
    }
  `.withBehaviors(de(P`
        :host {
          background: ${_.ButtonFace};
          border-color: ${_.ButtonText};
        }
        :host .next,
        :host .previous {
          color: ${_.ButtonText};
          fill: currentcolor;
        }
        :host(:not(.disabled):hover) {
          background: ${_.Highlight};
        }
        :host(:not(.disabled):hover) .next,
        :host(:not(.disabled):hover) .previous {
          color: ${_.HighlightText};
          fill: currentcolor;
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled),
        :host(.disabled) .next,
        :host(.disabled) .previous {
          border-color: ${_.GrayText};
          color: ${_.GrayText};
          fill: currentcolor;
        }
        :host(:${me}) {
          forced-color-adjust: none;
          outline-color: ${_.Highlight};
        }
      `))});var VO,wb=y(()=>{a();l();c();j();q5();VO=Ia.compose({baseName:"flipper",template:lT,styles:z5,next:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M7.57 11.84A1 1 0 016 11.02V4.98a1 1 0 011.57-.82l3.79 2.62c.85.59.85 1.85 0 2.44l-3.79 2.62z"/>
    </svg>
  `,previous:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M9.43 11.84a1 1 0 001.57-.82V4.98a1 1 0 00-1.57-.82L5.64 6.78c-.85.59-.85 1.85 0 2.44l3.79 2.62z"/>
    </svg>
  `})});var zO,qO,G5,j5,K5=y(()=>{a();l();c();I();j();Et();zO=P`
  .scroll-prev {
    right: auto;
    left: 0;
  }

  .scroll.scroll-next::before,
  .scroll-next .scroll-action {
    left: auto;
    right: 0;
  }

  .scroll.scroll-next::before {
    background: linear-gradient(to right, transparent, var(--scroll-fade-next));
  }

  .scroll-next .scroll-action {
    transform: translate(50%, -50%);
  }
`,qO=P`
  .scroll.scroll-next {
    right: auto;
    left: 0;
  }

  .scroll.scroll-next::before {
    background: linear-gradient(to right, var(--scroll-fade-next), transparent);
    left: auto;
    right: 0;
  }

  .scroll.scroll-prev::before {
    background: linear-gradient(to right, transparent, var(--scroll-fade-previous));
  }

  .scroll-prev .scroll-action {
    left: auto;
    right: 0;
    transform: translate(50%, -50%);
  }
`,G5=P`
  .scroll-area {
    position: relative;
  }

  div.scroll-view {
    overflow-x: hidden;
  }

  .scroll {
    bottom: 0;
    pointer-events: none;
    position: absolute;
    right: 0;
    top: 0;
    user-select: none;
    width: 100px;
  }

  .scroll.disabled {
    display: none;
  }

  .scroll::before,
  .scroll-action {
    left: 0;
    position: absolute;
  }

  .scroll::before {
    background: linear-gradient(to right, var(--scroll-fade-previous), transparent);
    content: '';
    display: block;
    height: 100%;
    width: 100%;
  }

  .scroll-action {
    pointer-events: auto;
    right: auto;
    top: 50%;
    transform: translate(-50%, -50%);
  }

  ::slotted(fluent-flipper) {
    opacity: 0;
    transition: opacity 0.2s ease-in-out;
  }

  .scroll-area:hover ::slotted(fluent-flipper) {
    opacity: 1;
  }
`.withBehaviors(new To(zO,qO)),j5=(r,e)=>P`
  ${ne("block")} :host {
    --scroll-align: center;
    --scroll-item-spacing: 4px;
    contain: layout;
    position: relative;
  }

  .scroll-view {
    overflow-x: auto;
    scrollbar-width: none;
  }

  ::-webkit-scrollbar {
    display: none;
  }

  .content-container {
    align-items: var(--scroll-align);
    display: inline-flex;
    flex-wrap: nowrap;
    position: relative;
  }

  .content-container ::slotted(*) {
    margin-right: var(--scroll-item-spacing);
  }

  .content-container ::slotted(*:last-child) {
    margin-right: 0;
  }
`});var xb,GO,Sb=y(()=>{a();l();c();I();j();K5();xb=class extends Xo{connectedCallback(){super.connectedCallback(),this.view!=="mobile"&&this.$fastController.addStyles(G5)}},GO=xb.compose({baseName:"horizontal-scroll",baseClass:Xo,template:ak,styles:j5,nextFlipper:R`
    <fluent-flipper @click="${r=>r.scrollToNext()}" aria-hidden="${r=>r.flippersHiddenFromAT}"></fluent-flipper>
  `,previousFlipper:R`
    <fluent-flipper
      @click="${r=>r.scrollToPrevious()}"
      direction="previous"
      aria-hidden="${r=>r.flippersHiddenFromAT}"
    ></fluent-flipper>
  `})});var W5,Q5=y(()=>{a();l();c();I();j();$e();Rr();W5=(r,e)=>P`
    ${ne("inline-flex")} :host {
      border: calc(${Z} * 1px) solid ${$s};
      border-radius: calc(${Ae} * 1px);
      box-sizing: border-box;
      flex-direction: column;
      padding: calc(${V} * 1px) 0;
    }

    ::slotted(${r.tagFor(So)}) {
      margin: 0 calc(${V} * 1px);
    }

    :host(:focus-within:not([disabled])) {
      ${zt}
    }
  `});var _b,Eb,Tb=y(()=>{a();l();c();j();Q5();_b=class extends Xt{},Eb=_b.compose({baseName:"listbox",template:vT,styles:W5})});var Y5,Z5=y(()=>{a();l();c();I();j();pe();Ua();$e();Dt();Rr();eb();Y5=(r,e)=>P`
    ${ne("inline-flex")} :host {
      position: relative;
      ${Ue}
      background: ${Nn};
      border-radius: calc(${Ae} * 1px);
      border: calc(${Z} * 1px) solid transparent;
      box-sizing: border-box;
      color: ${Pe};
      cursor: pointer;
      fill: currentcolor;
      height: calc(${xe} * 1px);
      overflow: hidden;
      align-items: center;
      padding: 0 calc(((${V} * 3) - ${Z} - 1) * 1px);
      user-select: none;
      white-space: nowrap;
    }

    :host::before {
      content: '';
      display: block;
      position: absolute;
      left: calc((${Vt} - ${Z}) * 1px);
      top: calc((${xe} / 4) - ${Vt} * 1px);
      width: 3px;
      height: calc((${xe} / 2) * 1px);
      background: transparent;
      border-radius: calc(${Ae} * 1px);
    }

    :host(:not([disabled]):hover) {
      background: ${Ji};
    }

    :host(:not([disabled]):active) {
      background: ${Xi};
    }

    :host(:not([disabled]):active)::before {
      background: ${Ye};
      height: calc(((${xe} / 2) - 6) * 1px);
    }

    :host([aria-selected='true'])::before {
      background: ${Ye};
    }

    :host(:${me}) {
      ${zt}
      background: ${BI};
    }

    :host([aria-selected='true']) {
      background: ${si};
    }

    :host(:not([disabled])[aria-selected='true']:hover) {
      background: ${Ql};
    }

    :host(:not([disabled])[aria-selected='true']:active) {
      background: ${HI};
    }

    :host(:not([disabled]):not([aria-selected='true']):hover) {
      background: ${Ji};
    }

    :host(:not([disabled]):not([aria-selected='true']):active) {
      background: ${Xi};
    }

    :host([disabled]) {
      cursor: ${Bt};
      opacity: ${Pt};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([slot='end']) {
      margin-inline-start: 1ch;
    }

    ::slotted([slot='start']) {
      margin-inline-end: 1ch;
    }
  `.withBehaviors(new To(null,P`
      :host::before {
        right: calc((${Vt} - ${Z}) * 1px);
      }
    `),de(P`
        :host {
          background: ${_.ButtonFace};
          border-color: ${_.ButtonFace};
          color: ${_.ButtonText};
        }
        :host(:not([disabled]):not([aria-selected="true"]):hover),
        :host(:not([disabled])[aria-selected="true"]:hover),
        :host([aria-selected="true"]) {
          forced-color-adjust: none;
          background: ${_.Highlight};
          color: ${_.HighlightText};
        }
        :host(:not([disabled]):active)::before,
        :host([aria-selected='true'])::before {
          background: ${_.HighlightText};
        }
        :host([disabled]),
        :host([disabled]:not([aria-selected='true']):hover) {
          background: ${_.Canvas};
          color: ${_.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host(:${me}) {
          outline-color: ${_.CanvasText};
        }
      `))});var jO,kb=y(()=>{a();l();c();j();Z5();jO=So.compose({baseName:"option",template:fT,styles:Y5})});var J5,X5=y(()=>{a();l();c();I();j();pe();Et();$e();J5=(r,e)=>P`
    ${ne("block")} :host {
      background: ${Yi};
      border: calc(${Z} * 1px) solid transparent;
      border-radius: calc(${ho} * 1px);
      box-shadow: ${Bf};
      padding: calc((${V} - ${Z}) * 1px) 0;
      max-width: 368px;
      min-width: 64px;
    }

    :host([slot='submenu']) {
      width: max-content;
      margin: 0 calc(${V} * 2px);
    }

    ::slotted(${r.tagFor(Ir)}) {
      margin: 0 calc(${V} * 1px);
    }

    ::slotted(${r.tagFor(bs)}) {
      margin: calc(${V} * 1px) 0;
    }

    ::slotted(hr) {
      box-sizing: content-box;
      height: 0;
      margin: calc(${V} * 1px) 0;
      border: none;
      border-top: calc(${Z} * 1px) solid ${Ha};
    }
  `.withBehaviors(de(P`
        :host([slot='submenu']) {
          background: ${_.Canvas};
          border-color: ${_.CanvasText};
        }
      `))});var Ib,KO,Ab=y(()=>{a();l();c();j();$e();X5();Ib=class extends Oa{connectedCallback(){super.connectedCallback(),Ee.setValueFor(this,Yi)}},KO=Ib.compose({baseName:"menu",baseClass:Oa,template:PT,styles:J5})});var eA,tA=y(()=>{a();l();c();I();j();pe();Et();$e();Dt();Rr();eA=(r,e)=>P`
    ${ne("grid")} :host {
      contain: layout;
      overflow: visible;
      ${Ue}
      box-sizing: border-box;
      height: calc(${xe} * 1px);
      grid-template-columns: minmax(32px, auto) 1fr minmax(32px, auto);
      grid-template-rows: auto;
      justify-items: center;
      align-items: center;
      padding: 0;
      white-space: nowrap;
      color: ${Pe};
      fill: currentcolor;
      cursor: pointer;
      border-radius: calc(${Ae} * 1px);
      border: calc(${Z} * 1px) solid transparent;
      position: relative;
    }

    :host(.indent-0) {
      grid-template-columns: auto 1fr minmax(32px, auto);
    }

    :host(.indent-0) .content {
      grid-column: 1;
      grid-row: 1;
      margin-inline-start: 10px;
    }

    :host(.indent-0) .expand-collapse-glyph-container {
      grid-column: 5;
      grid-row: 1;
    }

    :host(.indent-2) {
      grid-template-columns: minmax(32px, auto) minmax(32px, auto) 1fr minmax(32px, auto) minmax(32px, auto);
    }

    :host(.indent-2) .content {
      grid-column: 3;
      grid-row: 1;
      margin-inline-start: 10px;
    }

    :host(.indent-2) .expand-collapse-glyph-container {
      grid-column: 5;
      grid-row: 1;
    }

    :host(.indent-2) .start {
      grid-column: 2;
    }

    :host(.indent-2) .end {
      grid-column: 4;
    }

    :host(:${me}) {
      ${zt}
    }

    :host(:not([disabled]):hover) {
      background: ${Ji};
    }

    :host(:not([disabled]):active),
    :host(.expanded) {
      background: ${Xi};
      color: ${Pe};
      z-index: 2;
    }

    :host([disabled]) {
      cursor: ${Bt};
      opacity: ${Pt};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end {
      display: flex;
      justify-content: center;
    }

    :host(.indent-0[aria-haspopup='menu']) {
      display: grid;
      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);
      align-items: center;
      min-height: 32px;
    }

    :host(.indent-1[aria-haspopup='menu']),
    :host(.indent-1[role='menuitemcheckbox']),
    :host(.indent-1[role='menuitemradio']) {
      display: grid;
      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);
      align-items: center;
      min-height: 32px;
    }

    :host(.indent-2:not([aria-haspopup='menu'])) .end {
      grid-column: 5;
    }

    :host .input-container,
    :host .expand-collapse-glyph-container {
      display: none;
    }

    :host([aria-haspopup='menu']) .expand-collapse-glyph-container,
    :host([role='menuitemcheckbox']) .input-container,
    :host([role='menuitemradio']) .input-container {
      display: grid;
    }

    :host([aria-haspopup='menu']) .content,
    :host([role='menuitemcheckbox']) .content,
    :host([role='menuitemradio']) .content {
      grid-column-start: 3;
    }

    :host([aria-haspopup='menu'].indent-0) .content {
      grid-column-start: 1;
    }

    :host([aria-haspopup='menu']) .end,
    :host([role='menuitemcheckbox']) .end,
    :host([role='menuitemradio']) .end {
      grid-column-start: 4;
    }

    :host .expand-collapse,
    :host .checkbox,
    :host .radio {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      box-sizing: border-box;
    }

    :host .checkbox-indicator,
    :host .radio-indicator,
    slot[name='checkbox-indicator'],
    slot[name='radio-indicator'] {
      display: none;
    }

    ::slotted([slot='end']:not(svg)) {
      margin-inline-end: 10px;
      color: ${en};
    }

    :host([aria-checked='true']) .checkbox-indicator,
    :host([aria-checked='true']) slot[name='checkbox-indicator'],
    :host([aria-checked='true']) .radio-indicator,
    :host([aria-checked='true']) slot[name='radio-indicator'] {
      display: flex;
    }
  `.withBehaviors(de(P`
        :host,
        ::slotted([slot='end']:not(svg)) {
          forced-color-adjust: none;
          color: ${_.ButtonText};
          fill: currentcolor;
        }
        :host(:not([disabled]):hover) {
          background: ${_.Highlight};
          color: ${_.HighlightText};
          fill: currentcolor;
        }
        :host(:hover) .start,
        :host(:hover) .end,
        :host(:hover)::slotted(svg),
        :host(:active) .start,
        :host(:active) .end,
        :host(:active)::slotted(svg),
        :host(:hover) ::slotted([slot='end']:not(svg)),
        :host(:${me}) ::slotted([slot='end']:not(svg)) {
          color: ${_.HighlightText};
          fill: currentcolor;
        }
        :host(.expanded) {
          background: ${_.Highlight};
          color: ${_.HighlightText};
        }
        :host(:${me}) {
          background: ${_.Highlight};
          outline-color: ${_.ButtonText};
          color: ${_.HighlightText};
          fill: currentcolor;
        }
        :host([disabled]),
        :host([disabled]:hover),
        :host([disabled]:hover) .start,
        :host([disabled]:hover) .end,
        :host([disabled]:hover)::slotted(svg),
        :host([disabled]:${me}) {
          background: ${_.ButtonFace};
          color: ${_.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host([disabled]:${me}) {
          outline-color: ${_.GrayText};
        }
        :host .expanded-toggle,
        :host .checkbox,
        :host .radio {
          border-color: ${_.ButtonText};
          background: ${_.HighlightText};
        }
        :host([checked]) .checkbox,
        :host([checked]) .radio {
          background: ${_.HighlightText};
          border-color: ${_.HighlightText};
        }
        :host(:hover) .expanded-toggle,
            :host(:hover) .checkbox,
            :host(:hover) .radio,
            :host(:${me}) .expanded-toggle,
            :host(:${me}) .checkbox,
            :host(:${me}) .radio,
            :host([checked]:hover) .checkbox,
            :host([checked]:hover) .radio,
            :host([checked]:${me}) .checkbox,
            :host([checked]:${me}) .radio {
          border-color: ${_.HighlightText};
        }
        :host([aria-checked='true']) {
          background: ${_.Highlight};
          color: ${_.HighlightText};
        }
        :host([aria-checked='true']) .checkbox-indicator,
        :host([aria-checked='true']) ::slotted([slot='checkbox-indicator']),
        :host([aria-checked='true']) ::slotted([slot='radio-indicator']) {
          fill: ${_.Highlight};
        }
        :host([aria-checked='true']) .radio-indicator {
          background: ${_.Highlight};
        }
      `),new To(P`
        .expand-collapse-glyph-container {
          transform: rotate(0deg);
        }
      `,P`
        .expand-collapse-glyph-container {
          transform: rotate(180deg);
        }
      `))});var WO,Rb=y(()=>{a();l();c();j();tA();WO=Ir.compose({baseName:"menu-item",template:AT,styles:eA,checkboxIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>
    </svg>
  `,expandCollapseGlyph:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M5.65 3.15a.5.5 0 000 .7L9.79 8l-4.14 4.15a.5.5 0 00.7.7l4.5-4.5a.5.5 0 000-.7l-4.5-4.5a.5.5 0 00-.7 0z"/>
    </svg>
  `,radioIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <circle cx="8" cy="8" r="2"/>
    </svg>
  `})});var Yd,rA,oA=y(()=>{a();l();c();I();j();Et();Un();$e();Yd=".root",rA=(r,e)=>P`
    ${ne("inline-block")}

    ${Ms(r,e,Yd)}

    ${rn(r,e,Yd)}

    .root {
      display: flex;
      flex-direction: row;
    }

    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${V} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    .start,
    .end {
      margin: auto;
      fill: currentcolor;
    }

    .start {
      display: flex;
      margin-inline-start: 11px;
    }

    .end {
      display: flex;
      margin-inline-end: 11px;
    }

    .controls {
      opacity: 0;
      position: relative;
      top: -1px;
      z-index: 3;
    }

    :host(:hover:not([disabled])) .controls,
    :host(:focus-within:not([disabled])) .controls {
      opacity: 1;
    }

    .step-up,
    .step-down {
      display: flex;
      padding: 0 8px;
      cursor: pointer;
    }

    .step-up {
      padding-top: 3px;
    }
  `.withBehaviors(dt("outline",on(r,e,Yd)),dt("filled",li(r,e,Yd)),de(ci(r,e,Yd)))});var Xf,QO,Pb=y(()=>{a();l();c();Uo();I();j();oA();Xf=class extends Ar{connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};Q([w],Xf.prototype,"appearance",void 0);QO=Xf.compose({baseName:"number-field",baseClass:Ar,styles:rA,template:FT,shadowOptions:{delegatesFocus:!0},stepDownGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `,stepUpGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 7.35c.2.2.5.2.7 0L6 4.21l3.15 3.14a.5.5 0 10.7-.7l-3.5-3.5a.5.5 0 00-.7 0l-3.5 3.5a.5.5 0 000 .7z"/>
    </svg>
`})});var iA,nA=y(()=>{a();l();c();I();pe();j();$e();iA=(r,e)=>P`
    ${ne("flex")} :host {
      align-items: center;
      height: calc((${Z} * 3) * 1px);
    }

    .progress {
      background-color: ${ai};
      border-radius: calc(${V} * 1px);
      width: 100%;
      height: calc(${Z} * 1px);
      display: flex;
      align-items: center;
      position: relative;
    }

    .determinate {
      background-color: ${Ye};
      border-radius: calc(${V} * 1px);
      height: calc((${Z} * 3) * 1px);
      transition: all 0.2s ease-in-out;
      display: flex;
    }

    .indeterminate {
      height: calc((${Z} * 3) * 1px);
      border-radius: calc(${V} * 1px);
      display: flex;
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .indeterminate-indicator-1 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${Ye};
      border-radius: calc(${V} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 40%;
      animation: indeterminate-1 2s infinite;
    }

    .indeterminate-indicator-2 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${Ye};
      border-radius: calc(${V} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 60%;
      animation: indeterminate-2 2s infinite;
    }

    :host(.paused) .indeterminate-indicator-1,
    :host(.paused) .indeterminate-indicator-2 {
      animation: none;
      background-color: ${en};
      width: 100%;
      opacity: 1;
    }

    :host(.paused) .determinate {
      background-color: ${en};
    }

    @keyframes indeterminate-1 {
      0% {
        opacity: 1;
        transform: translateX(-100%);
      }
      70% {
        opacity: 1;
        transform: translateX(300%);
      }
      70.01% {
        opacity: 0;
      }
      100% {
        opacity: 0;
        transform: translateX(300%);
      }
    }

    @keyframes indeterminate-2 {
      0% {
        opacity: 0;
        transform: translateX(-150%);
      }
      29.99% {
        opacity: 0;
      }
      30% {
        opacity: 1;
        transform: translateX(-150%);
      }
      100% {
        transform: translateX(166.66%);
        opacity: 1;
      }
    }
  `.withBehaviors(de(P`
        .indeterminate-indicator-1,
        .indeterminate-indicator-2,
        .determinate,
        .progress {
          background-color: ${_.ButtonText};
        }
        :host(.paused) .indeterminate-indicator-1,
        :host(.paused) .indeterminate-indicator-2,
        :host(.paused) .determinate {
          background-color: ${_.GrayText};
        }
      `))});var Ob,$b,sA=y(()=>{a();l();c();j();nA();Ob=class extends Ei{},$b=Ob.compose({baseName:"progress",template:WT,styles:iA,indeterminateIndicator1:`
    <span class="indeterminate-indicator-1" part="indeterminate-indicator-1"></span>
  `,indeterminateIndicator2:`
    <span class="indeterminate-indicator-2" part="indeterminate-indicator-2"></span>
  `})});var aA,lA=y(()=>{a();l();c();I();pe();j();Et();$e();aA=(r,e)=>P`
    ${ne("flex")} :host {
      align-items: center;
      height: calc(${xe} * 1px);
      width: calc(${xe} * 1px);
    }

    .progress {
      height: 100%;
      width: 100%;
    }

    .background {
      fill: none;
      stroke-width: 2px;
    }

    .determinate {
      stroke: ${Ye};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
    }

    .indeterminate-indicator-1 {
      stroke: ${Ye};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
      animation: spin-infinite 2s linear infinite;
    }

    :host(.paused) .indeterminate-indicator-1 {
      animation: none;
      stroke: ${en};
    }

    :host(.paused) .determinate {
      stroke: ${en};
    }

    @keyframes spin-infinite {
      0% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(0deg);
      }
      50% {
        stroke-dasharray: 21.99px 21.99px;
        transform: rotate(450deg);
      }
      100% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(1080deg);
      }
    }
  `.withBehaviors(de(P`
        .background {
          stroke: ${_.Field};
        }
        .determinate,
        .indeterminate-indicator-1 {
          stroke: ${_.ButtonText};
        }
        :host(.paused) .determinate,
        :host(.paused) .indeterminate-indicator-1 {
          stroke: ${_.GrayText};
        }
      `))});var Mb,Zd,cA=y(()=>{a();l();c();j();lA();Mb=class extends Ei{},Zd=Mb.compose({baseName:"progress-ring",template:qT,styles:aA,indeterminateIndicator:`
    <svg class="progress" part="progress" viewBox="0 0 16 16">
        <circle
            class="background"
            part="background"
            cx="8px"
            cy="8px"
            r="7px"
        ></circle>
        <circle
            class="indeterminate-indicator-1"
            part="indeterminate-indicator-1"
            cx="8px"
            cy="8px"
            r="7px"
        ></circle>
    </svg>
  `})});var Fb=y(()=>{a();l();c();sA();cA()});var dA,uA=y(()=>{a();l();c();I();pe();j();Et();$e();Dt();Rr();dA=(r,e)=>P`
    ${ne("inline-flex")} :host {
      --input-size: calc((${xe} / 2) + ${V});
      align-items: center;
      outline: none;
      ${""} user-select: none;
      position: relative;
      flex-direction: row;
      transition: all 0.2s ease-in-out;
    }

    .control {
      position: relative;
      width: calc(var(--input-size) * 1px);
      height: calc(var(--input-size) * 1px);
      box-sizing: border-box;
      border-radius: 50%;
      border: calc(${Z} * 1px) solid ${ai};
      background: ${Gl};
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      ${Ue}
      color: ${Pe};
      ${""} padding-inline-start: calc(${V} * 2px + 2px);
      margin-inline-end: calc(${V} * 2px + 2px);
      cursor: pointer;
    }

    .control,
    slot[name='checked-indicator'] {
      flex-shrink: 0;
    }

    slot[name='checked-indicator'] {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      fill: ${Ho};
      opacity: 0;
      pointer-events: none;
    }

    :host(:not(.disabled):hover) .control {
      background: ${jl};
      border-color: ${Jl};
    }

    :host(:not(.disabled):active) .control {
      background: ${Kl};
      border-color: ${Xl};
    }

    :host(:not(.disabled):active) slot[name='checked-indicator'] {
      opacity: 1;
    }

    :host(:${me}) .control {
      ${tn}
      background: ${Wl};
    }

    :host(.checked) .control {
      background: ${Ye};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .control {
      background: ${to};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .control {
      background: ${ro};
      border-color: transparent;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${Bt};
    }

    :host(.checked) slot[name='checked-indicator'] {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${Pt};
    }
  `.withBehaviors(de(P`
        .control {
          background: ${_.Field};
          border-color: ${_.FieldText};
        }
        :host(:not(.disabled):hover) .control,
        :host(:not(.disabled):active) .control {
          border-color: ${_.Highlight};
        }
        :host(:${me}) .control {
          forced-color-adjust: none;
          background: ${_.Field};
          outline-color: ${_.FieldText};
        }
        :host(.checked:not(.disabled):hover) .control,
        :host(.checked:not(.disabled):active) .control {
          border-color: ${_.Highlight};
          background: ${_.Highlight};
        }
        :host(.checked) slot[name='checked-indicator'] {
          fill: ${_.Highlight};
        }
        :host(.checked:hover) .control slot[name='checked-indicator'] {
          fill: ${_.HighlightText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .label {
          color: ${_.GrayText};
        }
        :host(.disabled) .control,
        :host(.checked.disabled) .control {
          background: ${_.Field};
          border-color: ${_.GrayText};
        }
        :host(.disabled) slot[name='checked-indicator'],
        :host(.checked.disabled) slot[name='checked-indicator'] {
          fill: ${_.GrayText};
        }
      `))});var YO,Db=y(()=>{a();l();c();j();uA();YO=$a.compose({baseName:"radio",template:tk,styles:dA,checkedIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <circle cx="8" cy="8" r="4"/>
    </svg>
  `})});var hA,pA=y(()=>{a();l();c();I();j();hA=(r,e)=>P`
  ${ne("flex")} :host {
    align-items: flex-start;
    flex-direction: column;
  }

  .positioning-region {
    display: flex;
    flex-wrap: wrap;
  }

  :host([orientation='vertical']) .positioning-region {
    flex-direction: column;
  }

  :host([orientation='horizontal']) .positioning-region {
    flex-direction: row;
  }
`});var ZO,Lb=y(()=>{a();l();c();j();pA();ZO=Ti.compose({baseName:"radio-group",template:ZT,styles:hA})});var fA,Nb=y(()=>{a();l();c();I();j();fA=(r,e)=>R`
  <template
    class="
            ${t=>t.readOnly?"readonly":""}
        "
  >
    <label
      part="label"
      for="control"
      class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
    >
      <slot ${Oe({property:"defaultSlottedNodes",filter:kd})}></slot>
    </label>
    <div class="root" part="root" ${we("root")}>
      ${pt(r,e)}
      <div class="input-wrapper" part="input-wrapper">
        <input
          class="control"
          part="control"
          id="control"
          @input="${t=>t.handleTextInput()}"
          @change="${t=>t.handleChange()}"
          ?autofocus="${t=>t.autofocus}"
          ?disabled="${t=>t.disabled}"
          list="${t=>t.list}"
          maxlength="${t=>t.maxlength}"
          minlength="${t=>t.minlength}"
          pattern="${t=>t.pattern}"
          placeholder="${t=>t.placeholder}"
          ?readonly="${t=>t.readOnly}"
          ?required="${t=>t.required}"
          size="${t=>t.size}"
          ?spellcheck="${t=>t.spellcheck}"
          :value="${t=>t.value}"
          type="search"
          aria-atomic="${t=>t.ariaAtomic}"
          aria-busy="${t=>t.ariaBusy}"
          aria-controls="${t=>t.ariaControls}"
          aria-current="${t=>t.ariaCurrent}"
          aria-describedby="${t=>t.ariaDescribedby}"
          aria-details="${t=>t.ariaDetails}"
          aria-disabled="${t=>t.ariaDisabled}"
          aria-errormessage="${t=>t.ariaErrormessage}"
          aria-flowto="${t=>t.ariaFlowto}"
          aria-haspopup="${t=>t.ariaHaspopup}"
          aria-hidden="${t=>t.ariaHidden}"
          aria-invalid="${t=>t.ariaInvalid}"
          aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
          aria-label="${t=>t.ariaLabel}"
          aria-labelledby="${t=>t.ariaLabelledby}"
          aria-live="${t=>t.ariaLive}"
          aria-owns="${t=>t.ariaOwns}"
          aria-relevant="${t=>t.ariaRelevant}"
          aria-roledescription="${t=>t.ariaRoledescription}"
          ${we("control")}
        />
        <slot name="clear-button">
          <button
            class="clear-button ${t=>t.value?"":"clear-button__hidden"}"
            part="clear-button"
            tabindex="-1"
            @click=${t=>t.handleClearInput()}
          >
            <slot name="clear-glyph">
              <svg width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="m2.09 2.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L6 5.29l3.15-3.14a.5.5 0 1 1 .7.7L6.71 6l3.14 3.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L6 6.71 2.85 9.85a.5.5 0 0 1-.7-.7L5.29 6 2.15 2.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"
                />
              </svg>
            </slot>
          </button>
        </slot>
      </div>
      ${ht(r,e)}
    </div>
  </template>
`});var Jd,JO,XO,mA,gA=y(()=>{a();l();c();I();j();Et();Un();$e();Dt();Jd=".root",JO=tt.create("clear-button-hover").withDefault(r=>{let e=Eo.getValueFor(r),t=Zi.getValueFor(r);return e.evaluate(r,t.evaluate(r).focus).hover}),XO=tt.create("clear-button-active").withDefault(r=>{let e=Eo.getValueFor(r),t=Zi.getValueFor(r);return e.evaluate(r,t.evaluate(r).focus).active}),mA=(r,e)=>P`
    ${ne("inline-block")}

    ${Ms(r,e,Jd)}

    ${rn(r,e,Jd)}

    .root {
      display: flex;
      flex-direction: row;
    }
    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${V} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }
    .clear-button {
      display: inline-flex;
      align-items: center;
      margin: 1px;
      height: calc(100% - 2px);
      opacity: 0;
      background: transparent;
      color: ${Pe};
      fill: currentcolor;
      border: none;
      border-radius: calc(${Ae} * 1px);
      min-width: calc(${xe} * 1px);
      ${Ue}
      outline: none;
      padding: 0 calc((10 + (${V} * 2 * ${Xr})) * 1px);
    }
    .clear-button:hover {
      background: ${JO};
    }
    .clear-button:active {
      background: ${XO};
    }
    :host(:hover:not([disabled], [readOnly])) .clear-button,
    :host(:active:not([disabled], [readOnly])) .clear-button,
    :host(:focus-within:not([disabled], [readOnly])) .clear-button {
        opacity: 1;
    }
    :host(:hover:not([disabled], [readOnly])) .clear-button__hidden,
    :host(:active:not([disabled], [readOnly])) .clear-button__hidden,
    :host(:focus-within:not([disabled], [readOnly])) .clear-button__hidden {
        opacity: 0;
    }
    .control::-webkit-search-cancel-button {
      -webkit-appearance: none;
    }
    .input-wrapper {
      display: flex;
      position: relative;
      width: 100%;
    }
    .start,
    .end {
      display: flex;
      margin: 1px;
      align-items: center;
    }
    .start {
      display: flex;
      margin-inline-start: 11px;
    }
    ::slotted([slot="end"]) {
      height: 100%
    }
    .clear-button__hidden {
      opacity: 0;
    }
    .end {
        margin-inline-end: 11px;
    }
    ::slotted(${r.tagFor(Hr)}) {
      margin-inline-end: 1px;
    }
  `.withBehaviors(dt("outline",on(r,e,Jd)),dt("filled",li(r,e,Jd)),de(ci(r,e,Jd)))});var em,e$,Hb=y(()=>{a();l();c();Uo();I();j();Nb();gA();Nb();em=class extends Yr{constructor(){super(...arguments),this.appearance="outline"}};Q([w],em.prototype,"appearance",void 0);e$=em.compose({baseName:"search",baseClass:Yr,template:fA,styles:mA,start:'<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg%22%3E"><path d="M8.5 3a5.5 5.5 0 0 1 4.23 9.02l4.12 4.13a.5.5 0 0 1-.63.76l-.07-.06-4.13-4.12A5.5 5.5 0 1 1 8.5 3Zm0 1a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9Z"/></svg>',shadowOptions:{delegatesFocus:!0}})});var tm,t$,Ub=y(()=>{a();l();c();Uo();I();j();$e();hb();tm=class extends ei{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&Ee.setValueFor(this.listbox,Yi)}};Q([w({mode:"fromView"})],tm.prototype,"appearance",void 0);t$=tm.compose({baseName:"select",baseClass:ei,template:gk,styles:A5,indicator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `})});var vA,yA=y(()=>{a();l();c();I();j();pe();$e();vA=(r,e)=>P`
    ${ne("block")} :host {
      --skeleton-fill-default: ${si};
      overflow: hidden;
      width: 100%;
      position: relative;
      background-color: var(--skeleton-fill, var(--skeleton-fill-default));
      --skeleton-animation-gradient-default: linear-gradient(
        270deg,
        var(--skeleton-fill, var(--skeleton-fill-default)) 0%,
        ${Ql} 51%,
        var(--skeleton-fill, var(--skeleton-fill-default)) 100%
      );
      --skeleton-animation-timing-default: ease-in-out;
    }

    :host(.rect) {
      border-radius: calc(${Ae} * 1px);
    }

    :host(.circle) {
      border-radius: 100%;
      overflow: hidden;
    }

    object {
      position: absolute;
      width: 100%;
      height: auto;
      z-index: 2;
    }

    object img {
      width: 100%;
      height: auto;
    }

    ${ne("block")} span.shimmer {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: var(--skeleton-animation-gradient, var(--skeleton-animation-gradient-default));
      background-size: 0px 0px / 90% 100%;
      background-repeat: no-repeat;
      background-color: var(--skeleton-animation-fill, ${si});
      animation: shimmer 2s infinite;
      animation-timing-function: var(--skeleton-animation-timing, var(--skeleton-timing-default));
      animation-direction: normal;
      z-index: 1;
    }

    ::slotted(svg) {
      z-index: 2;
    }

    ::slotted(.pattern) {
      width: 100%;
      height: 100%;
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%);
      }
      100% {
        transform: translateX(100%);
      }
    }
  `.withBehaviors(de(P`
        :host{
          background-color: ${_.CanvasText};
        }
      `))});var r$,Bb=y(()=>{a();l();c();j();yA();r$=ws.compose({baseName:"skeleton",template:bk,styles:vA})});var bA,CA=y(()=>{a();l();c();I();pe();j();Et();$e();bA=(r,e)=>P`
    ${ne("inline-grid")} :host {
      --thumb-size: calc((${xe} / 2) + ${V} + (${Z} * 2));
      --thumb-translate: calc(var(--thumb-size) * -0.5 + var(--track-width) / 2);
      --track-overhang: calc((${V} / 2) * -1);
      --track-width: ${V};
      align-items: center;
      width: 100%;
      user-select: none;
      box-sizing: border-box;
      border-radius: calc(${Ae} * 1px);
      outline: none;
      cursor: pointer;
    }
    :host(.horizontal) .positioning-region {
      position: relative;
      margin: 0 8px;
      display: grid;
      grid-template-rows: calc(var(--thumb-size) * 1px) 1fr;
    }
    :host(.vertical) .positioning-region {
      position: relative;
      margin: 0 8px;
      display: grid;
      height: 100%;
      grid-template-columns: calc(var(--thumb-size) * 1px) 1fr;
    }
    :host(:${me}) .thumb-cursor {
      box-shadow: 0 0 0 2px ${Ee}, 0 0 0 4px ${ec};
    }
    .thumb-container {
      position: absolute;
      height: calc(var(--thumb-size) * 1px);
      width: calc(var(--thumb-size) * 1px);
      transition: all 0.2s ease;
    }
    .thumb-cursor {
      display: flex;
      position: relative;
      border: none;
      width: calc(var(--thumb-size) * 1px);
      height: calc(var(--thumb-size) * 1px);
      background: padding-box linear-gradient(${po}, ${po}),
        border-box ${Zl};
      border: calc(${Z} * 1px) solid transparent;
      border-radius: 50%;
      box-sizing: border-box;
    }
    .thumb-cursor::after {
      content: '';
      display: block;
      border-radius: 50%;
      width: 100%;
      margin: 4px;
      background: ${Ye};
    }
    :host(:not(.disabled)) .thumb-cursor:hover::after {
      background: ${to};
      margin: 3px;
    }
    :host(:not(.disabled)) .thumb-cursor:active::after {
      background: ${ro};
      margin: 5px;
    }
    :host(:not(.disabled)) .thumb-cursor:hover {
      background: padding-box linear-gradient(${po}, ${po}),
        border-box ${Mf};
    }
    :host(:not(.disabled)) .thumb-cursor:active {
      background: padding-box linear-gradient(${po}, ${po}),
        border-box ${Ff};
    }
    .track-start {
      background: ${Ye};
      position: absolute;
      height: 100%;
      left: 0;
      border-radius: calc(${Ae} * 1px);
    }
    :host(.horizontal) .thumb-container {
      transform: translateX(calc(var(--thumb-size) * 0.5px)) translateY(calc(var(--thumb-translate) * 1px));
    }
    :host(.vertical) .thumb-container {
      transform: translateX(calc(var(--thumb-translate) * 1px)) translateY(calc(var(--thumb-size) * 0.5px));
    }
    :host(.horizontal) {
      min-width: calc(var(--thumb-size) * 1px);
    }
    :host(.horizontal) .track {
      right: calc(var(--track-overhang) * 1px);
      left: calc(var(--track-overhang) * 1px);
      align-self: start;
      height: calc(var(--track-width) * 1px);
    }
    :host(.vertical) .track {
      top: calc(var(--track-overhang) * 1px);
      bottom: calc(var(--track-overhang) * 1px);
      width: calc(var(--track-width) * 1px);
      height: 100%;
    }
    .track {
      background: ${Rf};
      border: 1px solid ${ai};
      border-radius: 2px;
      box-sizing: border-box;
      position: absolute;
    }
    :host(.vertical) {
      height: 100%;
      min-height: calc(${V} * 60px);
      min-width: calc(${V} * 20px);
    }
    :host(.vertical) .track-start {
      height: auto;
      width: 100%;
      top: 0;
    }
    :host(.disabled),
    :host(.readonly) {
      cursor: ${Bt};
    }
    :host(.disabled) {
      opacity: ${Pt};
    }
  `.withBehaviors(de(P`
        .thumb-cursor {
          forced-color-adjust: none;
          border-color: ${_.FieldText};
          background: ${_.FieldText};
        }
        :host(:not(.disabled)) .thumb-cursor:hover,
        :host(:not(.disabled)) .thumb-cursor:active {
          background: ${_.Highlight};
        }
        .track {
          forced-color-adjust: none;
          background: ${_.FieldText};
        }
        .thumb-cursor::after,
        :host(:not(.disabled)) .thumb-cursor:hover::after,
        :host(:not(.disabled)) .thumb-cursor:active::after {
          background: ${_.Field};
        }
        :host(:${me}) .thumb-cursor {
          background: ${_.Highlight};
          border-color: ${_.Highlight};
          box-shadow: 0 0 0 1px ${_.Field}, 0 0 0 3px ${_.FieldText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .track,
        :host(.disabled) .thumb-cursor {
          forced-color-adjust: none;
          background: ${_.GrayText};
        }
      `))});var o$,Vb=y(()=>{a();l();c();j();CA();o$=mr.compose({baseName:"slider",template:kk,styles:bA,thumb:`
    <div class="thumb-cursor"></div>
  `})});var wA,xA=y(()=>{a();l();c();I();pe();j();$e();Dt();wA=(r,e)=>P`
    ${ne("block")} :host {
      ${Uf}
    }
    .root {
      position: absolute;
      display: grid;
    }
    :host(.horizontal) {
      align-self: start;
      grid-row: 2;
      margin-top: -4px;
    }
    :host(.vertical) {
      justify-self: start;
      grid-column: 2;
      margin-left: 2px;
    }
    .container {
      display: grid;
      justify-self: center;
    }
    :host(.horizontal) .container {
      grid-template-rows: auto auto;
      grid-template-columns: 0;
    }
    :host(.vertical) .container {
      grid-template-columns: auto auto;
      grid-template-rows: 0;
      min-width: calc(var(--thumb-size) * 1px);
      height: calc(var(--thumb-size) * 1px);
    }
    .label {
      justify-self: center;
      align-self: center;
      white-space: nowrap;
      max-width: 30px;
      margin: 2px 0;
    }
    .mark {
      width: calc(${Z} * 1px);
      height: calc(${V} * 1px);
      background: ${ai};
      justify-self: center;
    }
    :host(.vertical) .mark {
      transform: rotate(90deg);
      align-self: center;
    }
    :host(.vertical) .label {
      margin-left: calc((${V} / 2) * 2px);
      align-self: center;
    }
    :host(.disabled) {
      opacity: ${Pt};
    }
  `.withBehaviors(de(P`
        .mark {
          forced-color-adjust: none;
          background: ${_.FieldText};
        }
        :host(.disabled) {
          forced-color-adjust: none;
          opacity: 1;
        }
        :host(.disabled) .label {
          color: ${_.GrayText};
        }
        :host(.disabled) .mark {
          background: ${_.GrayText};
        }
      `))});var i$,zb=y(()=>{a();l();c();j();xA();i$=ti.compose({baseName:"slider-label",template:Sk,styles:wA})});var SA,_A=y(()=>{a();l();c();I();pe();j();Et();$e();Dt();Rr();SA=(r,e)=>P`
    :host([hidden]) {
      display: none;
    }

    ${ne("inline-flex")} :host {
      align-items: center;
      outline: none;
      font-family: ${eo};
      ${""} user-select: none;
    }

    :host(.disabled) {
      opacity: ${Pt};
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.disabled) .switch,
    :host(.readonly) .switch,
    :host(.disabled) .status-message,
    :host(.readonly) .status-message {
      cursor: ${Bt};
    }

    .switch {
      position: relative;
      box-sizing: border-box;
      width: calc(((${xe} / 2) + ${V}) * 2px);
      height: calc(((${xe} / 2) + ${V}) * 1px);
      background: ${Gl};
      border-radius: calc(${xe} * 1px);
      border: calc(${Z} * 1px) solid ${ai};
      cursor: pointer;
    }

    :host(:not(.disabled):hover) .switch {
      background: ${jl};
      border-color: ${Jl};
    }

    :host(:not(.disabled):active) .switch {
      background: ${Kl};
      border-color: ${Xl};
    }

    :host(:${me}) .switch {
      ${tn}
      background: ${Wl};
    }

    :host(.checked) .switch {
      background: ${Ye};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .switch {
      background: ${to};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .switch {
      background: ${ro};
      border-color: transparent;
    }

    slot[name='switch'] {
      position: absolute;
      display: flex;
      border: 1px solid transparent; /* Spacing included in the transform reference box */
      fill: ${Pe};
      transition: all 0.2s ease-in-out;
    }

    .status-message {
      color: ${Pe};
      cursor: pointer;
      ${Ue}
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      color: ${Pe};
      ${Ue}
      margin-inline-end: calc(${V} * 2px + 2px);
      cursor: pointer;
    }

    ::slotted([slot="checked-message"]),
    ::slotted([slot="unchecked-message"]) {
        margin-inline-start: calc(${V} * 2px + 2px);
    }

    :host(.checked) .switch {
      background: ${Ye};
    }

    :host(.checked) .switch slot[name='switch'] {
      fill: ${Ho};
      filter: drop-shadow(0px 1px 1px rgba(0, 0, 0, 0.15));
    }

    :host(.checked:not(.disabled)) .switch:hover {
      background: ${to};
    }

    :host(.checked:not(.disabled)) .switch:hover slot[name='switch'] {
      fill: ${Sf};
    }

    :host(.checked:not(.disabled)) .switch:active {
      background: ${ro};
    }

    :host(.checked:not(.disabled)) .switch:active slot[name='switch'] {
      fill: ${_f};
    }

    .unchecked-message {
      display: block;
    }

    .checked-message {
      display: none;
    }

    :host(.checked) .unchecked-message {
      display: none;
    }

    :host(.checked) .checked-message {
      display: block;
    }
  `.withBehaviors(new To(P`
        slot[name='switch'] {
          left: 0;
        }

        :host(.checked) slot[name='switch'] {
          left: 100%;
          transform: translateX(-100%);
        }
      `,P`
        slot[name='switch'] {
          right: 0;
        }

        :host(.checked) slot[name='switch'] {
          right: 100%;
          transform: translateX(100%);
        }
      `),de(P`
        :host(:not(.disabled)) .switch slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${_.FieldText};
        }
        .switch {
          background: ${_.Field};
          border-color: ${_.FieldText};
        }
        :host(.checked) .switch {
          background: ${_.Highlight};
          border-color: ${_.Highlight};
        }
        :host(:not(.disabled):hover) .switch ,
        :host(:not(.disabled):active) .switch,
        :host(.checked:not(.disabled):hover) .switch {
          background: ${_.HighlightText};
          border-color: ${_.Highlight};
        }
        :host(.checked:not(.disabled)) .switch slot[name="switch"] {
          fill: ${_.HighlightText};
        }
        :host(.checked:not(.disabled):hover) .switch slot[name='switch'] {
          fill: ${_.Highlight};
        }
        :host(:${me}) .switch {
          forced-color-adjust: none;
          background: ${_.Field}; 
          border-color: ${_.Highlight};
          outline-color: ${_.FieldText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${_.GrayText};
        }
        :host(.disabled) .switch {
          background: ${_.Field};
          border-color: ${_.GrayText};
        }
        .status-message,
        .label {
          color: ${_.FieldText};
        }
      `))});var n$,qb=y(()=>{a();l();c();j();_A();n$=$l.compose({baseName:"switch",template:Ok,styles:SA,switch:`
    <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="12" height="12" rx="6"/>
    </svg>
  `})});var EA,TA=y(()=>{a();l();c();I();pe();j();$e();Et();Dt();EA=(r,e)=>P`
      ${ne("grid")} :host {
        box-sizing: border-box;
        ${Ue}
        color: ${Pe};
        grid-template-columns: auto 1fr auto;
        grid-template-rows: auto 1fr;
      }

      .tablist {
        display: grid;
        grid-template-rows: calc(${xe} * 1px); auto;
        grid-template-columns: auto;
        position: relative;
        width: max-content;
        align-self: end;
      }

      .start,
      .end {
        align-self: center;
      }

      .activeIndicator {
        grid-row: 2;
        grid-column: 1;
        width: 20px;
        height: 3px;
        border-radius: calc(${Ae} * 1px);
        justify-self: center;
        background: ${Ye};
      }

      .activeIndicatorTransition {
        transition: transform 0.2s ease-in-out;
      }

      .tabpanel {
        grid-row: 2;
        grid-column-start: 1;
        grid-column-end: 4;
        position: relative;
      }

      :host(.vertical) {
        grid-template-rows: auto 1fr auto;
        grid-template-columns: auto 1fr;
      }

      :host(.vertical) .tablist {
        grid-row-start: 2;
        grid-row-end: 2;
        display: grid;
        grid-template-rows: auto;
        grid-template-columns: auto 1fr;
        position: relative;
        width: max-content;
        justify-self: end;
        align-self: flex-start;
        width: 100%;
      }

      :host(.vertical) .tabpanel {
        grid-column: 2;
        grid-row-start: 1;
        grid-row-end: 4;
      }

      :host(.vertical) .end {
        grid-row: 3;
      }

      :host(.vertical) .activeIndicator {
        grid-column: 1;
        grid-row: 1;
        width: 3px;
        height: 20px;
        margin-inline-start: calc(${Vt} * 1px);
        border-radius: calc(${Ae} * 1px);
        align-self: center;
        background: ${Ye};
      }

      :host(.vertical) .activeIndicatorTransition {
        transition: transform 0.2s linear;
      }
    `.withBehaviors(de(P`
        .activeIndicator,
        :host(.vertical) .activeIndicator {
          background: ${_.Highlight};
        }
      `))});var kA,IA=y(()=>{a();l();c();I();pe();j();Et();$e();Dt();Rr();kA=(r,e)=>P`
      ${ne("inline-flex")} :host {
        box-sizing: border-box;
        ${Ue}
        height: calc((${xe} + (${V} * 2)) * 1px);
        padding: 0 calc((6 + (${V} * 2 * ${Xr})) * 1px);
        color: ${Pe};
        border-radius: calc(${Ae} * 1px);
        border: calc(${Z} * 1px) solid transparent;
        align-items: center;
        justify-content: center;
        grid-row: 1 / 3;
        cursor: pointer;
      }

      :host([aria-selected='true']) {
        z-index: 2;
      }

      :host(:hover),
      :host(:active) {
        color: ${Pe};
      }

      :host(:${me}) {
        ${zt}
      }

      :host(.vertical) {
        justify-content: start;
        grid-column: 1 / 3;
      }

      :host(.vertical[aria-selected='true']) {
        z-index: 2;
      }

      :host(.vertical:hover),
      :host(.vertical:active) {
        color: ${Pe};
      }

      :host(.vertical:hover[aria-selected='true']) {
      }
    `.withBehaviors(de(P`
          :host {
            forced-color-adjust: none;
            border-color: transparent;
            color: ${_.ButtonText};
            fill: currentcolor;
          }
          :host(:hover),
          :host(.vertical:hover),
          :host([aria-selected='true']:hover) {
            background: transparent;
            color: ${_.Highlight};
            fill: currentcolor;
          }
          :host([aria-selected='true']) {
            background: transparent;
            color: ${_.Highlight};
            fill: currentcolor;
          }
          :host(:${me}) {
            background: transparent;
            outline-color: ${_.ButtonText};
          }
        `))});var Gb,AA=y(()=>{a();l();c();j();IA();Gb=Rd.compose({baseName:"tab",template:Bk,styles:kA})});var RA,PA=y(()=>{a();l();c();I();j();$e();Dt();RA=(r,e)=>P`
  ${ne("block")} :host {
    box-sizing: border-box;
    ${Ue}
    padding: 0 calc((6 + (${V} * 2 * ${Xr})) * 1px);
  }
`});var jb,OA=y(()=>{a();l();c();j();PA();jb=Lp.compose({baseName:"tab-panel",template:Lk,styles:RA})});var Kb,Wb=y(()=>{a();l();c();j();TA();AA();OA();Kb=ri.compose({baseName:"tabs",template:Gk,styles:EA})});var Xd,$A,MA=y(()=>{a();l();c();I();j();Et();Un();$e();Xd=".control",$A=(r,e)=>P`
    ${ne("inline-flex")}

    ${Ms(r,e,Xd)}

    ${rn(r,e,Xd)}

    :host {
      flex-direction: column;
      vertical-align: bottom;
    }

    .control {
      height: calc((${xe} * 2) * 1px);
      padding: calc(${V} * 1.5px) calc(${V} * 2px + 1px);
    }

    :host .control {
      resize: none;
    }

    :host(.resize-both) .control {
      resize: both;
    }

    :host(.resize-horizontal) .control {
      resize: horizontal;
    }

    :host(.resize-vertical) .control {
      resize: vertical;
    }

    :host([cols]) {
      width: initial;
    }

    :host([rows]) .control {
      height: initial;
    }
  `.withBehaviors(dt("outline",on(r,e,Xd)),dt("filled",li(r,e,Xd)),de(ci(r,e,Xd)))});var rm,s$,Qb=y(()=>{a();l();c();Uo();I();j();MA();rm=class extends gr{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};Q([w],rm.prototype,"appearance",void 0);s$=rm.compose({baseName:"text-area",baseClass:gr,template:Jk,styles:$A,shadowOptions:{delegatesFocus:!0}})});var eu,FA,DA=y(()=>{a();l();c();I();j();Et();Un();$e();eu=".root",FA=(r,e)=>P`
    ${ne("inline-block")}

    ${Ms(r,e,eu)}

    ${rn(r,e,eu)}

    .root {
      display: flex;
      flex-direction: row;
    }

    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${V} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    .start,
    .end {
      display: flex;
      margin: auto;
    }

    .start {
      display: flex;
      margin-inline-start: 11px;
    }

    .end {
      display: flex;
      margin-inline-end: 11px;
    }
  `.withBehaviors(dt("outline",on(r,e,eu)),dt("filled",li(r,e,eu)),de(ci(r,e,eu)))});var om,Yb,Zb=y(()=>{a();l();c();Uo();I();j();DA();om=class extends Ur{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};Q([w],om.prototype,"appearance",void 0);Yb=om.compose({baseName:"text-field",baseClass:Ur,template:t2,styles:FA,shadowOptions:{delegatesFocus:!0}})});var LA,NA=y(()=>{a();l();c();I();j();pe();$e();Rr();LA=(r,e)=>P`
    ${ne("inline-flex")} :host {
      --toolbar-item-gap: calc(${V} * 1px);
      background: ${Ee};
      fill: currentcolor;
      padding: var(--toolbar-item-gap);
      box-sizing: border-box;
      align-items: center;
    }

    :host(${me}) {
      ${zt}
    }

    .positioning-region {
      align-items: center;
      display: inline-flex;
      flex-flow: row wrap;
      justify-content: flex-start;
      flex-grow: 1;
    }

    :host([orientation='vertical']) .positioning-region {
      flex-direction: column;
      align-items: start;
    }

    ::slotted(:not([slot])) {
      flex: 0 0 auto;
      margin: 0 var(--toolbar-item-gap);
    }

    :host([orientation='vertical']) ::slotted(:not([slot])) {
      margin: var(--toolbar-item-gap) 0;
    }

    :host([orientation='vertical']) {
      display: inline-flex;
      flex-direction: column;
    }

    .start,
    .end {
      display: flex;
      align-items: center;
    }

    .end {
      margin-inline-start: auto;
    }

    .start__hidden,
    .end__hidden {
      display: none;
    }

    ::slotted(svg) {
      ${""}
      width: 16px;
      height: 16px;
    }
  `.withBehaviors(de(P`
        :host(:${me}) {
          outline-color: ${_.Highlight};
          color: ${_.ButtonText};
          forced-color-adjust: none;
        }
      `))});var Jb,a$,Xb=y(()=>{a();l();c();j();NA();Jb=class extends ki{},a$=Jb.compose({baseName:"toolbar",baseClass:ki,template:i2,styles:LA})});var HA,UA=y(()=>{a();l();c();I();j();Et();$e();Dt();HA=(r,e)=>P`
    :host {
      position: relative;
      contain: layout;
      overflow: visible;
      height: 0;
      width: 0;
      z-index: 10000;
    }

    .tooltip {
      box-sizing: border-box;
      border-radius: calc(${Ae} * 1px);
      border: calc(${Z} * 1px) solid ${Hn};
      background: ${Ee};
      color: ${Pe};
      padding: 4px 12px;
      height: fit-content;
      width: fit-content;
      ${Ue}
      white-space: nowrap;
      box-shadow: ${r5};
    }

    ${r.tagFor(Re)} {
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: visible;
      flex-direction: row;
    }

    ${r.tagFor(Re)}.right,
    ${r.tagFor(Re)}.left {
      flex-direction: column;
    }

    ${r.tagFor(Re)}.top .tooltip::after,
    ${r.tagFor(Re)}.bottom .tooltip::after,
    ${r.tagFor(Re)}.left .tooltip::after,
    ${r.tagFor(Re)}.right .tooltip::after {
      content: '';
      width: 12px;
      height: 12px;
      background: ${Ee};
      border-top: calc(${Z} * 1px) solid ${Hn};
      border-left: calc(${Z} * 1px) solid ${Hn};
      position: absolute;
    }

    ${r.tagFor(Re)}.top .tooltip::after {
      transform: translateX(-50%) rotate(225deg);
      bottom: 5px;
      left: 50%;
    }

    ${r.tagFor(Re)}.top .tooltip {
      margin-bottom: 12px;
    }

    ${r.tagFor(Re)}.bottom .tooltip::after {
      transform: translateX(-50%) rotate(45deg);
      top: 5px;
      left: 50%;
    }

    ${r.tagFor(Re)}.bottom .tooltip {
      margin-top: 12px;
    }

    ${r.tagFor(Re)}.left .tooltip::after {
      transform: translateY(-50%) rotate(135deg);
      top: 50%;
      right: 5px;
    }

    ${r.tagFor(Re)}.left .tooltip {
      margin-right: 12px;
    }

    ${r.tagFor(Re)}.right .tooltip::after {
      transform: translateY(-50%) rotate(-45deg);
      top: 50%;
      left: 5px;
    }

    ${r.tagFor(Re)}.right .tooltip {
      margin-left: 12px;
    }
  `.withBehaviors(de(P`
        :host([disabled]) {
          opacity: 1;
        }
        ${r.tagFor(Re)}.top .tooltip::after,
        ${r.tagFor(Re)}.bottom .tooltip::after,
        ${r.tagFor(Re)}.left .tooltip::after,
        ${r.tagFor(Re)}.right .tooltip::after {
          content: '';
          width: unset;
          height: unset;
        }
      `))});var e1,l$,t1=y(()=>{a();l();c();j();$e();UA();e1=class extends Ht{connectedCallback(){super.connectedCallback(),Ee.setValueFor(this,Yi)}},l$=e1.compose({baseName:"tooltip",baseClass:Ht,template:c2,styles:HA})});var BA,VA=y(()=>{a();l();c();I();j();BA=(r,e)=>P`
  :host([hidden]) {
    display: none;
  }

  ${ne("flex")} :host {
    flex-direction: column;
    align-items: stretch;
    min-width: fit-content;
    font-size: 0;
  }
`});var c$,r1=y(()=>{a();l();c();j();VA();c$=Ma.compose({baseName:"tree-view",template:v2,styles:BA})});var d$,u$,zA,h$,p$,qA,GA=y(()=>{a();l();c();I();j();pe();Et();$e();Dt();Rr();d$=P`
  .expand-collapse-button svg {
    transform: rotate(0deg);
  }
  :host(.nested) .expand-collapse-button {
    left: var(--expand-collapse-button-nested-width, calc(${xe} * -1px));
  }
  :host([selected])::after {
    left: calc(${Vt} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,u$=P`
  .expand-collapse-button svg {
    transform: rotate(180deg);
  }
  :host(.nested) .expand-collapse-button {
    right: var(--expand-collapse-button-nested-width, calc(${xe} * -1px));
  }
  :host([selected])::after {
    right: calc(${Vt} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,zA=_r`((${Ps} / 2) * ${V}) + ((${V} * ${Xr}) / 2)`,h$=tt.create("tree-item-expand-collapse-hover").withDefault(r=>{let e=Eo.getValueFor(r);return e.evaluate(r,e.evaluate(r).hover).hover}),p$=tt.create("tree-item-expand-collapse-selected-hover").withDefault(r=>{let e=Ln.getValueFor(r);return Eo.getValueFor(r).evaluate(r,e.evaluate(r).rest).hover}),qA=(r,e)=>P`
    ${ne("block")} :host {
      contain: content;
      position: relative;
      outline: none;
      color: ${Pe};
      fill: currentcolor;
      cursor: pointer;
      font-family: ${eo};
      --expand-collapse-button-size: calc(${xe} * 1px);
      --tree-item-nested-width: 0;
    }

    .positioning-region {
      display: flex;
      position: relative;
      box-sizing: border-box;
      background: ${Nn};
      border: calc(${Z} * 1px) solid transparent;
      border-radius: calc(${Ae} * 1px);
      height: calc((${xe} + 1) * 1px);
    }

    :host(:${me}) .positioning-region {
      ${zt}
    }

    .positioning-region::before {
      content: '';
      display: block;
      width: var(--tree-item-nested-width);
      flex-shrink: 0;
    }

    :host(:not([disabled])) .positioning-region:hover {
      background: ${Ji};
    }

    :host(:not([disabled])) .positioning-region:active {
      background: ${Xi};
    }

    .content-region {
      display: inline-flex;
      align-items: center;
      white-space: nowrap;
      width: 100%;
      height: calc(${xe} * 1px);
      margin-inline-start: calc(${V} * 2px + 8px);
      ${Ue}
    }

    .items {
      display: none;
      ${""} font-size: calc(1em + (${V} + 16) * 1px);
    }

    .expand-collapse-button {
      background: none;
      border: none;
      border-radius: calc(${Ae} * 1px);
      ${""} width: calc((${zA} + (${V} * 2)) * 1px);
      height: calc((${zA} + (${V} * 2)) * 1px);
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      margin: 0 6px;
    }

    .expand-collapse-button svg {
      transition: transform 0.1s linear;
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
    }

    .start {
      ${""} margin-inline-end: calc(${V} * 2px + 2px);
    }

    .end {
      ${""} margin-inline-start: calc(${V} * 2px + 2px);
    }

    :host(.expanded) > .items {
      display: block;
    }

    :host([disabled]) {
      opacity: ${Pt};
      cursor: ${Bt};
    }

    :host(.nested) .content-region {
      position: relative;
      margin-inline-start: var(--expand-collapse-button-size);
    }

    :host(.nested) .expand-collapse-button {
      position: absolute;
    }

    :host(.nested) .expand-collapse-button:hover {
      background: ${h$};
    }

    :host(:not([disabled])[selected]) .positioning-region {
      background: ${si};
    }

    :host(:not([disabled])[selected]) .expand-collapse-button:hover {
      background: ${p$};
    }

    :host([selected])::after {
      content: '';
      display: block;
      position: absolute;
      top: calc((${xe} / 4) * 1px);
      width: 3px;
      height: calc((${xe} / 2) * 1px);
      ${""} background: ${Ye};
      border-radius: calc(${Ae} * 1px);
    }

    ::slotted(fluent-tree-item) {
      --tree-item-nested-width: 1em;
      --expand-collapse-button-nested-width: calc(${xe} * -1px);
    }
  `.withBehaviors(new To(d$,u$),de(P`
        :host {
          color: ${_.ButtonText};
        }
        .positioning-region {
          border-color: ${_.ButtonFace};
          background: ${_.ButtonFace};
        }
        :host(:not([disabled])) .positioning-region:hover,
        :host(:not([disabled])) .positioning-region:active,
        :host(:not([disabled])[selected]) .positioning-region {
          background: ${_.Highlight};
        }
        :host .positioning-region:hover .content-region,
        :host([selected]) .positioning-region .content-region {
          forced-color-adjust: none;
          color: ${_.HighlightText};
        }
        :host([disabled][selected]) .positioning-region .content-region {
          color: ${_.GrayText};
        }
        :host([selected])::after {
          background: ${_.HighlightText};
        }
        :host(:${me}) .positioning-region {
          forced-color-adjust: none;
          outline-color: ${_.ButtonFace};
        }
        :host([disabled]),
        :host([disabled]) .content-region,
        :host([disabled]) .positioning-region:hover .content-region {
          opacity: 1;
          color: ${_.GrayText};
        }
        :host(.nested) .expand-collapse-button:hover,
        :host(:not([disabled])[selected]) .expand-collapse-button:hover {
          background: ${_.ButtonFace};
          fill: ${_.ButtonText};
        }
      `))});var f$,o1=y(()=>{a();l();c();j();GA();f$=Ut.compose({baseName:"tree-item",template:f2,styles:qA,expandCollapseGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>
    </svg>
  `})});var jA=y(()=>{a();l();c();Jy();rb();ob();ib();nb();sb();ab();x5();lb();db();fb();mb();vb();bb();Cb();wb();Sb();Tb();kb();Ab();Rb();Pb();Fb();Db();Lb();Hb();Ub();Bb();Vb();zb();qb();Wb();Qb();Zb();Xb();t1();r1();o1()});function KA(r){return E0.getOrCreate(r).withPrefix("fluent")}var WA=y(()=>{a();l();c();j()});var oc=y(()=>{a();l();c();jA();WA();Jy();rb();ob();ib();nb();sb();ab();lb();db();fb();mb();vb();bb();Cb();wb();Sb();Tb();kb();Ab();Rb();Pb();Fb();Db();Lb();Hb();Ub();Bb();Vb();zb();qb();Wb();Qb();Zb();Xb();t1();o1();r1();$e();Et();ef();Is();Hl();of()});var m$,Ds,tu=y(()=>{a();l();c();oc();m$=KA(),Ds=(...r)=>{if(r?.length)for(let e of r)m$.register(e())}});var QA,YA=y(()=>{a();l();c();ut();QA=[xt`
:host .file-upload-area-button{width:auto;display:flex;align-items:end;justify-content:end;margin-inline-end:36px;margin-top:30px}:host fluent-button .upload-icon path{fill:var(--file-upload-button-text-color,var(--foreground-on-accent-rest))}:host fluent-button.file-upload-button::part(control){border:var(--file-upload-button-border,none);background:var(--file-upload-button-background-color,var(--accent-fill-rest))}:host fluent-button.file-upload-button::part(control):hover{background:var(--file-upload-button-background-color-hover,var(--accent-fill-hover))}:host fluent-button.file-upload-button .upload-text{color:var(--file-upload-button-text-color,var(--foreground-on-accent-rest));font-weight:400;line-height:20px}:host input{display:none}:host fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host fluent-dialog::part(overlay){opacity:.5}:host fluent-dialog::part(control){--dialog-width:$file-upload-dialog-width;--dialog-height:$file-upload-dialog-height;padding:var(--file-upload-dialog-padding,24px);border:var(--file-upload-dialog-border,1px solid var(--neutral-fill-rest))}:host fluent-dialog .file-upload-dialog-ok{background:var(--file-upload-dialog-keep-both-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-keep-both-button-border,none);color:var(--file-upload-dialog-keep-both-button-text-color,var(--foreground-on-accent-rest))}:host fluent-dialog .file-upload-dialog-ok:hover{background:var(--file-upload-dialog-keep-both-button-background-color-hover,var(--accent-fill-hover))}:host fluent-dialog .file-upload-dialog-cancel{background:var(--file-upload-dialog-replace-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-replace-button-border,1px solid var(--neutral-foreground-rest));color:var(--file-upload-dialog-replace-button-text-color,var(--neutral-foreground-rest))}:host fluent-dialog .file-upload-dialog-cancel:hover{background:var(--file-upload-dialog-replace-button-background-color-hover,var(--accent-fill-hover))}:host fluent-checkbox{margin-top:12px}:host fluent-checkbox .file-upload-dialog-check{color:var(--file-upload-dialog-text-color,--foreground-on-accent-rest)}:host .file-upload-table{display:flex}:host .file-upload-table.upload{display:flex}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell.percent-indicator{padding-inline-start:10px}:host .file-upload-table .file-upload-cell .description{opacity:.5;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:28px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-inline-start:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .mgt-file-item{--file-background-color:transparent;--file-padding:0 12px;--file-padding-inline-start:24px}:host .file-upload-template{clear:both}:host .file-upload-template .file-upload-folder-tab{padding-inline-start:20px}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-background-color,var(--accent-fill-rest));color:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{display:flex;align-items:end;justify-content:end;gap:5px}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));padding-right:5px}:host .file-upload-dialog.visible{display:block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{cursor:pointer;opacity:.5}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border-drag,1px dashed #0078d4);background-color:var(--file-upload-background-color-drag,rgba(0,120,212,.1));position:absolute;inset:0;z-index:1;display:inline-block}[dir=rtl] :host .file-upload-status{left:0;right:28px}
`]});var qt,ZA=y(()=>{a();l();c();qt={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep both",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep both files?',uploadButtonLabel:"File upload button"}});var JA,XA=y(()=>{a();l();c();ut();JA=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size);font-weight:var(--default-font-weight,400);border:var(--file-border,1px solid transparent);border-radius:var(--file-border-radius,4px);background-color:var(--file-background-color)}:host .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color);padding:var(--file-padding,0);margin:var(--file-margin,0)}:host .item:hover{background-color:var(--file-background-color-hover,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px);cursor:pointer;--secondary-text-color:var(--secondary-text-hover-color)}:host .item:focus,:host .item:focus-visible{background-color:var(--file-background-color-focus,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px)}:host .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1{font-size:var(--default-font-size);font-weight:var(--file-line1-font-weight,var(--default-font-weight,400));text-transform:var(--file-line1-text-transform,initial);line-height:20px;color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .item__details .line2{color:var(--file-line2-color,var(--secondary-text-color));font-size:var(--file-line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--file-line2-font-weight,var(--default-font-weight,400));text-transform:var(--file-line2-text-transform,initial);line-height:16px}:host .item__details .line3{color:var(--file-line3-color,var(--secondary-text-color));font-size:var(--file-line3-font-size,var(--size-font-size,12px));font-weight:var(--file-line3-font-weight,var(--default-font-weight,400));text-transform:var(--file-line3-text-transform,initial);line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}
`]});var eR,tR,rR,oR=y(()=>{a();l();c();eR={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},tR="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types",rR=(r,e,t)=>Object.keys(eR).find(i=>eR[i]===r)?`${tR}/${e.toString()}/${r}.${t}`:r==="jpg"||r==="png"?(r="photo",`${tR}/${e.toString()}/${r}.${t}`):null});var iR,nR=y(()=>{a();l();c();iR={modifiedSubtitle:"Modified",sizeSubtitle:"Size"}});var et,Se,g$,im,ze,i1=y(()=>{a();l();c();ut();Ao();XA();lt();Bh();da();es();oR();wi();nR();lt();et=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Se=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},g$=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},im=()=>Nt("file",ze),ze=class extends qr{static get styles(){return JA}get strings(){return iR}get fileQuery(){return this._fileQuery}set fileQuery(e){e!==this._fileQuery&&(this._fileQuery=e,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}get listId(){return this._listId}set listId(e){e!==this._listId&&(this._listId=e,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(e){e!==this._insightId&&(this._insightId=e,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(e){e!==this._fileDetails&&(this._fileDetails=e,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(e){e!==this._fileIcon&&(this._fileIcon=e,this.requestStateUpdate())}get driveItem(){return this._driveItem}set driveItem(e){e!==this._driveItem&&(this._driveItem=e,this.requestStateUpdate())}get line1Property(){return this._line1Property}set line1Property(e){e!==this._line1Property&&(this._line1Property=e,this.requestStateUpdate())}get line2Property(){return this._line2Property}set line2Property(e){e!==this._line2Property&&(this._line2Property=e,this.requestStateUpdate())}get line3Property(){return this._line3Property}set line3Property(e){e!==this._line3Property&&(this._line3Property=e,this.requestStateUpdate())}get view(){return this._view}set view(e){e!==this._view&&(this._view=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}constructor(){super(),this._getFromMyDrive=!1,this._line1Property="name",this._line2Property="lastModifiedDateTime",this._line3Property="size",this._view=be.threelines}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();let e=this.driveItem,t;if(t=this.renderTemplate("default",{file:e}),!t){let o=this.renderDetails(e),i=this.renderFileTypeIcon();t=T`
        <div class="item">
          ${i} ${o}
        </div>`}return t}renderLoading(){return this.renderTemplate("loading",null)||T``}renderNoData(){return this.renderTemplate("no-data",null)||T``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return T``;let e;if(this.fileIcon)e=this.fileIcon;else{let t=/(?:\.([^.]+))?$/,o=this.driveItem.package===void 0&&this.driveItem.folder===void 0?t.exec(this.driveItem.name)[1]?t.exec(this.driveItem.name)[1].toLowerCase():this.driveItem.size?"null":"folder":this.driveItem.package!==void 0&&this.driveItem.package.type==="oneNote"?"onetoc":"folder";e=rR(o,48,"svg")}return T`
      <div class="item__file-type-icon">
        ${e?T`
              <img src=${e} alt="File icon" />
            `:T`
              ${Ce(D.File)}
            `}
      </div>
    `}renderDetails(e){if(!e||this.view===be.image)return T``;let t=[],o="";return this.view>be.image&&(o=this.getTextFromProperty(e,this.line1Property),o&&t.push(T`
          <div class="line1" aria-label="${o}">${o}</div>
        `)),this.view>be.oneline&&(o=this.getTextFromProperty(e,this.line2Property),o&&t.push(T`
          <div class="line2" aria-label="${o}">${o}</div>
        `)),this.view>be.twolines&&(o=this.getTextFromProperty(e,this.line3Property),o&&t.push(T`
          <div class="line3" aria-label="${o}">${o}</div>
        `)),T`
      <div class="item__details">
        ${t}
      </div>
    `}loadState(){return g$(this,void 0,void 0,function*(){if(this.fileDetails){this._driveItem=this.fileDetails;return}let e=he.globalProvider;if(!e||e.state===Me.Loading)return;if(e.state===Me.SignedOut){this._driveItem=null;return}this._graph=e.graph.forComponent(this);let t;this._getFromMyDrive=!this.driveId&&!this.siteId&&!this.groupId&&!this.listId&&!this.userId,this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?t=null:this.fileQuery?t=yield Kr(this._graph,this.fileQuery):this.itemId&&this._getFromMyDrive?t=yield Fx(this._graph,this.itemId):this.itemPath&&this._getFromMyDrive?t=yield Dx(this._graph,this.itemPath):this.userId?this.itemId?t=yield Ux(this._graph,this.userId,this.itemId):this.itemPath?t=yield Bx(this._graph,this.userId,this.itemPath):this.insightType&&this.insightId&&(t=yield zx(this._graph,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?t=yield Px(this._graph,this.driveId,this.itemId):this.itemPath&&(t=yield Ox(this._graph,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?t=yield Lx(this._graph,this.siteId,this.itemId):this.itemPath&&(t=yield Nx(this._graph,this.siteId,this.itemPath)):this.listId?t=yield Hx(this._graph,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?t=yield $x(this._graph,this.groupId,this.itemId):this.itemPath&&(t=yield Mx(this._graph,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(t=yield Vx(this._graph,this.insightType,this.insightId)),this._driveItem=t})}getTextFromProperty(e,t){if(!t||t.length===0)return null;this._propertyList=t.trim().split(",");let o="",i=0;for(;!o&&i<this._propertyList.length;){switch(this._currentPropertyList=this._propertyList[i].trim(),this._currentPropertyList){case"size":{let n="0";e.size&&(n=Qc(e.size)),o=`${this.strings.sizeSubtitle}: ${n}`;break}case"lastModifiedDateTime":{let n,s;if(e.lastModifiedDateTime){let d=new Date(e.lastModifiedDateTime);n=Th(d),s=`${this.strings.modifiedSubtitle} ${n}`}else s="";o=s;break}default:o=e[this._currentPropertyList]}i++}return o}};et([G({attribute:"file-query"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"fileQuery",null);et([G({attribute:"site-id"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"siteId",null);et([G({attribute:"drive-id"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"driveId",null);et([G({attribute:"group-id"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"groupId",null);et([G({attribute:"list-id"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"listId",null);et([G({attribute:"user-id"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"userId",null);et([G({attribute:"item-id"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"itemId",null);et([G({attribute:"item-path"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"itemPath",null);et([G({attribute:"insight-type"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"insightType",null);et([G({attribute:"insight-id"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"insightId",null);et([G({type:Object}),Se("design:type",Object),Se("design:paramtypes",[Object])],ze.prototype,"fileDetails",null);et([G({attribute:"file-icon"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"fileIcon",null);et([G({type:Object}),Se("design:type",Object),Se("design:paramtypes",[Object])],ze.prototype,"driveItem",null);et([G({attribute:"line1-property"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"line1Property",null);et([G({attribute:"line2-property"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"line2Property",null);et([G({attribute:"line3-property"}),Se("design:type",String),Se("design:paramtypes",[String])],ze.prototype,"line3Property",null);et([G({attribute:"view",converter:r=>!r||r.length===0?be.threelines:(r=r.toLowerCase(),typeof be[r]>"u"?be.threelines:be[r])}),Se("design:type",Number),Se("design:paramtypes",[Number])],ze.prototype,"view",null);et([K(),Se("design:type",Object)],ze.prototype,"_driveItem",void 0);et([K(),Se("design:type",Number)],ze.prototype,"_view",void 0);et([K(),Se("design:type",String)],ze.prototype,"_line1Property",void 0);et([K(),Se("design:type",String)],ze.prototype,"_line2Property",void 0);et([K(),Se("design:type",String)],ze.prototype,"_line3Property",void 0);et([K(),Se("design:type",Object)],ze.prototype,"_graph",void 0);et([K(),Se("design:type",String)],ze.prototype,"_fileQuery",void 0);et([K(),Se("design:type",String)],ze.prototype,"_siteId",void 0);et([K(),Se("design:type",String)],ze.prototype,"_itemId",void 0);et([K(),Se("design:type",String)],ze.prototype,"_driveId",void 0);et([K(),Se("design:type",String)],ze.prototype,"_itemPath",void 0);et([K(),Se("design:type",String)],ze.prototype,"_listId",void 0);et([K(),Se("design:type",String)],ze.prototype,"_groupId",void 0);et([K(),Se("design:type",String)],ze.prototype,"_userId",void 0);et([K(),Se("design:type",String)],ze.prototype,"_insightType",void 0);et([K(),Se("design:type",String)],ze.prototype,"_insightId",void 0);et([K(),Se("design:type",Object)],ze.prototype,"_fileDetails",void 0);et([K(),Se("design:type",String)],ze.prototype,"_fileIcon",void 0);et([K(),Se("design:type",Object)],ze.prototype,"_getFromMyDrive",void 0);et([K(),Se("design:type",Array)],ze.prototype,"_propertyList",void 0);et([K(),Se("design:type",String)],ze.prototype,"_currentPropertyList",void 0)});var sR,aR,Ga,n1,v$,y$,b$,lR,ru,s1=y(()=>{a();l();c();oc();lt();ut();Ao();ca();Bh();es();tu();wi();da();YA();ZA();lt();i1();sR=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},aR=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Ga=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},n1=r=>r.isDirectory,v$=r=>r.isFile,y$=r=>"getAsEntry"in r&&typeof r.getAsEntry=="function",b$=r=>"getAsFile"in r&&typeof r.getAsFile=="function"||"webkitGetAsEntry"in r&&typeof r.webkitGetAsEntry=="function",lR=()=>{Ds($b,qa,cb,yb),im(),Nt("file-upload",ru)},ru=class extends Pr{static get styles(){return QA}get strings(){return qt}static get requiredScopes(){return[...new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"])]}get _dropEffect(){return"copy"}constructor(){super(),this._dragCounter=0,this._maxChunkSize=4*1024*1024,this._dialogTitle="",this._dialogContent="",this._dialogPrimaryButton="",this._dialogSecondaryButton="",this._dialogCheckBox="",this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.onFileUploadChange=e=>{let t=e.target;!e||t.files.length<1||this.readUploadedFiles(t.files,()=>t.value=null)},this.onFileUploadClick=()=>{this.renderRoot.querySelector("#file-upload-input").click()},this.handleonDragOver=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.dropEffect=e.dataTransfer.dropEffect=this._dropEffect)},this.handleonDragEnter=e=>{e.preventDefault(),e.stopPropagation(),this._dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.dropEffect=this._dropEffect,this.renderRoot.querySelector("#file-upload-border").classList.add("visible"))},this.handleonDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this._dragCounter--,this._dragCounter===0&&this.renderRoot.querySelector("#file-upload-border").classList.remove("visible")},this.handleonDrop=e=>{var t;e.preventDefault(),e.stopPropagation();let o=()=>{e.dataTransfer.clearData()};this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),!((t=e.dataTransfer)===null||t===void 0)&&t.items&&this.readUploadedFiles(e.dataTransfer.items,o),this._dragCounter=0},this.filesToUpload=[]}render(){if(this.parentElement!==null){let e=this.parentElement;e.addEventListener("dragenter",this.handleonDragEnter),e.addEventListener("dragleave",this.handleonDragLeave),e.addEventListener("dragover",this.handleonDragOver),e.addEventListener("drop",this.handleonDrop)}return T`
        <div id="file-upload-dialog" class="file-upload-dialog">
          <!-- Modal content -->
          <fluent-dialog modal="true" class="file-upload-dialog-content">
            <span
              class="file-upload-dialog-close"
              id="file-upload-dialog-close">
                ${Ce(D.Cancel)}
            </span>
            <div class="file-upload-dialog-content-text">
              <h2 class="file-upload-dialog-title">${this._dialogTitle}</h2>
              <div>${this._dialogContent}</div>
                <fluent-checkbox
                  id="file-upload-dialog-check"
                  class="file-upload-dialog-check">
                    ${this._dialogCheckBox}
                </fluent-checkbox>
            </div>
            <div class="file-upload-dialog-editor">
              <fluent-button
                appearance="accent"
                class="file-upload-dialog-ok">
                ${this._dialogPrimaryButton}
              </fluent-button>
              <fluent-button
                appearance="outline"
                class="file-upload-dialog-cancel">
                ${this._dialogSecondaryButton}
              </fluent-button>
            </div>
          </fluent-dialog>
        </div>
        <div id="file-upload-border"></div>
        <div class="file-upload-area-button">
          <input
            id="file-upload-input"
            title="${this.strings.uploadButtonLabel}"
            tabindex="-1"
            aria-label="file upload input"
            type="file"
            multiple
            @change="${this.onFileUploadChange}"
          />
          <fluent-button
            appearance="accent"
            class="file-upload-button"
            @click=${this.onFileUploadClick}
            label=${this.strings.uploadButtonLabel}>
              <span slot="start">${Ce(D.Upload)}</span>
              <span class="upload-text">${this.strings.buttonUploadFile}</span>
          </fluent-button>
        </div>
        <div class="file-upload-template">
          ${this.renderFolderTemplate(this.filesToUpload)}
        </div>
       `}renderFolderTemplate(e){let t=[];if(e.length>0){let o=e.map(i=>t.indexOf(i.fullPath.substring(0,i.fullPath.lastIndexOf("/")))===-1?i.fullPath.endsWith("/")?T`${this.renderFileTemplate(i,"")}`:(t.push(i.fullPath.substring(0,i.fullPath.lastIndexOf("/"))),Ot`
            <div class='file-upload-table'>
              <div class='file-upload-cell'>
                <mgt-file
                  .fileDetails=${{name:i.fullPath.substring(1,i.fullPath.lastIndexOf("/")),folder:"Folder"}}
                  .view=${be.oneline}
                  class="mgt-file-item">
                </mgt-file>
              </div>
            </div>
            ${this.renderFileTemplate(i,"file-upload-folder-tab")}`):T`${this.renderFileTemplate(i,"file-upload-folder-tab")}`);return T`${o}`}return T``}renderFileTemplate(e,t){let o=Qt({"file-upload-table":!0,upload:e.completed}),i=t+(e.fieldUploadResponse==="lastModifiedDateTime"?" file-upload-dialog-success":""),n=Qt({description:e.fieldUploadResponse==="description"}),s=e.completed?T``:this.renderFileUploadTemplate(e);return Ot`
        <div class="${o}">
          <div class="${i}">
            <div class='file-upload-cell'>
              <div class="${n}">
                <div class="file-upload-status">
                  ${e.iconStatus}
                </div>
                <mgt-file
                  .fileDetails=${e.driveItem}
                  .view=${e.view}
                  .line2Property=${e.fieldUploadResponse}
                  part="upload"
                  class="mgt-file-item">
                </mgt-file>
              </div>
            </div>
              ${s}
            </div>
          </div>
        </div>`}renderFileUploadTemplate(e){let t=Qt({"file-upload-table":!0,upload:e.completed});return T`
    <div class='file-upload-cell'>
      <div class='file-upload-table file-upload-name'>
        <div class='file-upload-cell'>
          <div
            title="${e.file.name}"
            class='file-upload-filename'>
            ${e.file.name}
          </div>
        </div>
      </div>
      <div class='file-upload-table'>
        <div class='file-upload-cell'>
          <div class="${t}">
            <fluent-progress class="file-upload-bar" value="${e.percent}"></fluent-progress>
            <div class='file-upload-cell percent-indicator'>
              <span>${e.percent}%</span>
              <span
                class="file-upload-cancel"
                @click=${()=>this.deleteFileUploadSession(e)}>
                ${Ce(D.Cancel)}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
    `}deleteFileUploadSession(e){return Ga(this,void 0,void 0,function*(){try{e.uploadUrl!==void 0?(yield dS(this.fileUploadList.graph,e.uploadUrl),e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,qt.cancelUploadFile)):(e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,qt.cancelUploadFile))}catch{e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,qt.cancelUploadFile)}})}readUploadedFiles(e,t){return Ga(this,void 0,void 0,function*(){let o=yield this.getFilesFromUploadArea(e);yield this.getSelectedFiles(o),t()})}getSelectedFiles(e){return Ga(this,void 0,void 0,function*(){let t=[],o=[];this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach(n=>{n.completed?o.push(n):t.push(n)});for(let n of e){let s=n.fullPath===""?"/"+n.name:n.fullPath;if(t.filter(d=>d.fullPath===s).length===0){let d=!0;if(this.fileUploadList.maxFileSize!==void 0&&d&&n.size>this.fileUploadList.maxFileSize*1024&&(d=!1,this._maximumFileSize===!1)){let u=yield this.getFileUploadStatus(n,s,"MaxFileSize",this.fileUploadList);u!==null&&u[0]===1&&(this._maximumFileSize=!0)}if(this.fileUploadList.excludedFileExtensions!==void 0&&this.fileUploadList.excludedFileExtensions.length>0&&d&&this.fileUploadList.excludedFileExtensions.filter(u=>n.name.toLowerCase().indexOf(u.toLowerCase())>-1).length>0&&(d=!1,this._excludedFileType===!1)){let u=yield this.getFileUploadStatus(n,s,"ExcludedFileType",this.fileUploadList);u!==null&&u[0]===1&&(this._excludedFileType=!0)}if(d){let u=yield this.getFileUploadStatus(n,s,"Upload",this.fileUploadList),h=!1;u!==null&&(u[0]===-1?h=!0:(this._applyAll=!!u[0],this._applyAllConflictBehavior=u[1]?1:0)),t.push({file:n,driveItem:{name:n.name},fullPath:s,conflictBehavior:u!==null?u[1]?1:0:null,iconStatus:null,percent:1,view:be.image,completed:h,maxSize:this._maxChunkSize,minSize:0})}}}t=t.sort((n,s)=>n.fullPath.substring(0,n.fullPath.lastIndexOf("/")).localeCompare(s.fullPath.substring(0,s.fullPath.lastIndexOf("/")))),t.forEach(n=>{if(o.filter(s=>s.fullPath===n.fullPath).length!==0){let s=o.findIndex(d=>d.fullPath===n.fullPath);o.splice(s,1)}}),t.push(...o),this.filesToUpload=t;let i=this.filesToUpload.map(n=>this.sendFileItemGraph(n));yield Promise.all(i)})}getFileUploadStatus(e,t,o,i){let n=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return Ga(this,void 0,void 0,function*(){let s=this.renderRoot.querySelector("#file-upload-dialog");switch(o){case"Upload":return(yield sS(this.fileUploadList.graph,`${this.getGrapQuery(t)}?$select=id`))!==null?this._applyAll===!0?[this._applyAll,this._applyAllConflictBehavior]:(s.classList.add("visible"),this._dialogTitle=qt.fileReplaceTitle,this._dialogContent=qt.fileReplace.replace("{FileName}",e.name),this._dialogCheckBox=qt.checkApplyAll,this._dialogPrimaryButton=qt.buttonReplace,this._dialogSecondaryButton=qt.buttonKeep,yield n.requestStateUpdate.call(this,!0),new Promise(u=>{let h=this.renderRoot.querySelector(".file-upload-dialog-close"),p=this.renderRoot.querySelector(".file-upload-dialog-ok"),v=this.renderRoot.querySelector(".file-upload-dialog-cancel"),C=this.renderRoot.querySelector("#file-upload-dialog-check");C.checked=!1,C.classList.remove("hide");let x=()=>{s.classList.remove("visible"),u([C.checked?1:0,1])},E=()=>{s.classList.remove("visible"),u([C.checked?1:0,0])},O=()=>{s.classList.remove("visible"),u([-1])};p.removeEventListener("click",x),v.removeEventListener("click",E),h.removeEventListener("click",O),p.addEventListener("click",x),v.addEventListener("click",E),h.addEventListener("click",O)})):null;case"ExcludedFileType":return s.classList.add("visible"),this._dialogTitle=qt.fileTypeTitle,this._dialogContent=qt.fileType.replace("{FileName}",e.name)+" ("+i.excludedFileExtensions.join(",")+")",this._dialogCheckBox=qt.checkAgain,this._dialogPrimaryButton=qt.buttonOk,this._dialogSecondaryButton=qt.buttonCancel,yield n.requestStateUpdate.call(this,!0),new Promise(d=>{let u=this.renderRoot.querySelector(".file-upload-dialog-ok"),h=this.renderRoot.querySelector(".file-upload-dialog-cancel"),p=this.renderRoot.querySelector(".file-upload-dialog-close"),v=this.renderRoot.querySelector("#file-upload-dialog-check");v.checked=!1,v.classList.remove("hide");let C=()=>{s.classList.remove("visible"),d([v.checked?1:0])},x=()=>{s.classList.remove("visible"),d([0])};u.removeEventListener("click",C),h.removeEventListener("click",x),p.removeEventListener("click",x),u.addEventListener("click",C),h.addEventListener("click",x),p.addEventListener("click",x)});case"MaxFileSize":return s.classList.add("visible"),this._dialogTitle=qt.maximumFileSizeTitle,this._dialogContent=qt.maximumFileSize.replace("{FileSize}",Qc(i.maxFileSize*1024)).replace("{FileName}",e.name)+Qc(e.size)+".",this._dialogCheckBox=qt.checkAgain,this._dialogPrimaryButton=qt.buttonOk,this._dialogSecondaryButton=qt.buttonCancel,yield n.requestStateUpdate.call(this,!0),new Promise(d=>{let u=this.renderRoot.querySelector(".file-upload-dialog-ok"),h=this.renderRoot.querySelector(".file-upload-dialog-cancel"),p=this.renderRoot.querySelector(".file-upload-dialog-close"),v=this.renderRoot.querySelector("#file-upload-dialog-check");v.checked=!1,v.classList.remove("hide");let C=()=>{s.classList.remove("visible"),d([v.checked?1:0])},x=()=>{s.classList.remove("visible"),d([0])};u.removeEventListener("click",C),h.removeEventListener("click",x),p.removeEventListener("click",x),u.addEventListener("click",C),h.addEventListener("click",x),p.addEventListener("click",x)});default:break}})}getGrapQuery(e){let t="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(t=this.fileUploadList.itemPath.startsWith("/")?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?`/users/${this.fileUploadList.userId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.userId&&this.fileUploadList.itemPath?`/users/${this.fileUploadList.userId}/drive/root:${t}${e}`:this.fileUploadList.groupId&&this.fileUploadList.itemId?`/groups/${this.fileUploadList.groupId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.groupId&&this.fileUploadList.itemPath?`/groups/${this.fileUploadList.groupId}/drive/root:${t}${e}`:this.fileUploadList.driveId&&this.fileUploadList.itemId?`/drives/${this.fileUploadList.driveId}/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.driveId&&this.fileUploadList.itemPath?`/drives/${this.fileUploadList.driveId}/root:${t}${e}`:this.fileUploadList.siteId&&this.fileUploadList.itemId?`/sites/${this.fileUploadList.siteId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.siteId&&this.fileUploadList.itemPath?`/sites/${this.fileUploadList.siteId}/drive/root:${t}${e}`:this.fileUploadList.itemId?`/me/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.itemPath?`/me/drive/root:${t}${e}`:`/me/drive/root:${e}`}sendFileItemGraph(e){return Ga(this,void 0,void 0,function*(){let t=this.fileUploadList.graph,o="";if(e.file.size<this._maxChunkSize)try{e.completed||((e.conflictBehavior===null||e.conflictBehavior===1)&&(o=`${this.getGrapQuery(e.fullPath)}:/content`),e.conflictBehavior===0&&(o=`${this.getGrapQuery(e.fullPath)}:/content?@microsoft.graph.conflictBehavior=rename`),e.driveItem=yield cS(t,o,e.file),e.driveItem!==null?this.setUploadSuccess(e):(e.driveItem={name:e.file.name},this.setUploadFail(e,qt.failUploadFile)))}catch{this.setUploadFail(e,qt.failUploadFile)}else if(!e.completed&&e.uploadUrl===void 0){let i=yield aS(t,`${this.getGrapQuery(e.fullPath)}:/createUploadSession`,e.conflictBehavior);try{if(i!==null){e.uploadUrl=i.uploadUrl;let n=yield this.sendSessionUrlGraph(t,e);n!==null?(e.driveItem=n,this.setUploadSuccess(e)):this.setUploadFail(e,qt.failUploadFile)}else this.setUploadFail(e,qt.failUploadFile)}catch{}}})}sendSessionUrlGraph(e,t){let o=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return Ga(this,void 0,void 0,function*(){for(;t.file.size>t.minSize;){t.mimeStreamString===void 0&&(t.mimeStreamString=yield this.readFileContent(t.file));let i=new Blob([t.mimeStreamString.slice(t.minSize,t.maxSize)]);if(t.percent=Math.round(t.maxSize/t.file.size*100),yield o.requestStateUpdate.call(this,!0),t.uploadUrl!==void 0){let n=yield lS(e,t.uploadUrl,`${t.maxSize-t.minSize}`,`bytes ${t.minSize}-${t.maxSize-1}/${t.file.size}`,i);if(n===null)return null;if(Ax(n))t.minSize=parseInt(n.nextExpectedRanges[0].split("-")[0],10),t.maxSize=t.minSize+this._maxChunkSize,t.maxSize>t.file.size&&(t.maxSize=t.file.size);else if(n.id!==void 0)return n}else return null}})}setUploadSuccess(e){e.percent=100,super.requestStateUpdate(!0),setTimeout(()=>{e.iconStatus=Ce(D.Success),e.view=be.twolines,e.fieldUploadResponse="lastModifiedDateTime",e.completed=!0,super.requestStateUpdate(!0),Uh()},500)}setUploadFail(e,t){setTimeout(()=>{e.iconStatus=Ce(D.Fail),e.view=be.twolines,e.driveItem.description=t,e.fieldUploadResponse="description",e.completed=!0,super.requestStateUpdate(!0)},500)}readFileContent(e){return new Promise((t,o)=>{let i=new FileReader;i.onloadend=()=>{t(i.result)},i.onerror=n=>{o(n)},i.readAsArrayBuffer(e)})}getFilesFromUploadArea(e){return Ga(this,void 0,void 0,function*(){let t=[],o,i=[];for(let n of e)if(b$(n))if(y$(n))if(o=n.getAsEntry(),n1(o))t.push(o);else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else if(n.webkitGetAsEntry)if(o=n.webkitGetAsEntry(),n1(o))t.push(o);else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else this.writeFilePath(n,""),i.push(n);if(t.length>0){let n=yield this.getFolderFiles(t);i.push(...n)}return i})}getFolderFiles(e){return new Promise(t=>{let o=0,i=[];e.forEach(d=>{n(d,"")});let n=(d,u)=>{n1(d)?s(d.createReader()):v$(d)&&(o++,d.file(h=>{o--,this.writeFilePath(h,u),i.push(h),o===0&&t(i)}))},s=d=>{o++,d.readEntries(u=>{o--;for(let h of u)n(h,h.fullPath);o===0&&t(i)})}})}writeFilePath(e,t){e.fullPath=t}};sR([G({type:Object}),aR("design:type",Array)],ru.prototype,"filesToUpload",void 0);sR([G({type:Object}),aR("design:type",Object)],ru.prototype,"fileUploadList",void 0)});var cR,dR=y(()=>{a();l();c();ut();cR=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}
`]});var uR,hR=y(()=>{a();l();c();uR={showMoreSubtitle:"Show more items",filesSectionTitle:"Files",sharedTextSubtitle:"Shared"}});var Je,Te,pR,fR,Be,mR=y(()=>{a();l();c();lt();ut();Ao();Ix();Bh();s1();wi();es();dR();hR();i1();s1();oc();tu();lt();Je=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Te=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},pR=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},fR=()=>{Ds(Zd),im(),lR(),Nt("file-list",Be)},Be=class extends qr{static get styles(){return cR}get strings(){return uR}get fileListQuery(){return this._fileListQuery}set fileListQuery(e){e!==this._fileListQuery&&(this._fileListQuery=e,this.requestStateUpdate())}get displayName(){return this.strings.filesSectionTitle}get cardTitle(){return this.strings.filesSectionTitle}renderIcon(){return Ce(D.Files)}get fileQueries(){return this._fileQueries}set fileQueries(e){$c(this._fileQueries,e)||(this._fileQueries=e,this.requestStateUpdate())}get files(){return this._files}set files(e){$c(this._files,e)||(this._files=e,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}get fileExtensions(){return this._fileExtensions}set fileExtensions(e){$c(this._fileExtensions,e)||(this._fileExtensions=e,this.requestStateUpdate())}get pageSize(){return this._pageSize}set pageSize(e){e!==this._pageSize&&(this._pageSize=e,this.requestStateUpdate())}get maxFileSize(){return this._maxFileSize}set maxFileSize(e){e!==this._maxFileSize&&(this._maxFileSize=e,this.requestStateUpdate())}get maxUploadFile(){return this._maxUploadFile}set maxUploadFile(e){e!==this._maxUploadFile&&(this._maxUploadFile=e,this.requestStateUpdate())}get excludedFileExtensions(){return this._excludedFileExtensions}set excludedFileExtensions(e){$c(this._excludedFileExtensions,e)||(this._excludedFileExtensions=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set([...ze.requiredScopes])]}constructor(){super(),this._isCompact=!1,this.disableOpenOnClick=!1,this._focusedItemIndex=-1,this.onFocusFirstItem=()=>this._focusedItemIndex=0,this.onFileListKeyDown=e=>{let t=this.renderRoot.querySelector(".file-list"),o;if(t?.children.length){if((e.code==="ArrowUp"||e.code==="ArrowDown")&&(e.code==="ArrowUp"&&(this._focusedItemIndex===-1&&(this._focusedItemIndex=t.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+t.children.length)%t.children.length),e.code==="ArrowDown"&&(this._focusedItemIndex=(this._focusedItemIndex+1)%t.children.length),o=t.children[this._focusedItemIndex],this.updateItemBackgroundColor(t,o,"focused")),e.code==="Enter"||e.code==="Space"){o=t.children[this._focusedItemIndex];let i=o.children[0];e.preventDefault(),this.fireCustomEvent("itemClick",i.fileDetails),this.handleFileClick(i.fileDetails),this.updateItemBackgroundColor(t,o,"selected")}e.code==="Tab"&&(o=t.children[this._focusedItemIndex])}},this.clearState(),this._pageSize=10,this.itemView=be.twolines,this._maxUploadFile=10,this.enableFileUpload=!1,this._preloadedFiles=[]}requestStateUpdate(e){return this.clearState(),super.requestStateUpdate(e)}clearState(){super.clearState(),this._files=null,this._pageSize=10,this._maxUploadFile=10}asCompactView(){return this._isCompact=!0,this}asFullView(){return this._isCompact=!1,this}render(){return!this.files&&this.isLoadingState?this.renderLoading():!this.files||this.files.length===0?this.renderNoData():this._isCompact?this.renderCompactView():this.renderFullView()}renderCompactView(){let e=this.files.slice(0,3);return this.renderFiles(e)}renderFullView(){return this.renderTemplate("default",{files:this.files})||this.renderFiles(this.files)}renderLoading(){return this.renderTemplate("loading",null)||T``}renderNoData(){return this.renderTemplate("no-data",null)||(this.enableFileUpload===!0&&he.globalProvider!==void 0?T`
            <div class="file-list-wrapper" dir=${this.direction}>
              ${this.renderFileUpload()}
            </div>`:T``)}renderFiles(e){return T`
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        ${this.enableFileUpload?this.renderFileUpload():null}
        <ul
          id="file-list"
          class="file-list"
        >
          <li
            tabindex="0"
            class="file-item"
            @keydown="${this.onFileListKeyDown}"
            @focus="${this.onFocusFirstItem}"
            @click=${t=>this.handleItemSelect(e[0],t)}>
            ${this.renderFile(e[0])}
          </li>
          ${Tx(e.slice(1),t=>t.id,t=>T`
              <li
                class="file-item"
                @keydown="${this.onFileListKeyDown}"
                @click=${o=>this.handleItemSelect(t,o)}>
                ${this.renderFile(t)}
              </li>
            `)}
        </ul>
        ${!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)&&!this._isCompact?this.renderMoreFileButton():null}
      </div>
    `}renderFile(e){let t=this.itemView;return this.renderTemplate("file",{file:e},e.id)||Ot`
        <mgt-file class="mgt-file-item" .fileDetails=${e} .view=${t}></mgt-file>
      `}renderMoreFileButton(){return this._isLoadingMore?T`
        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>
      `:T`
        <fluent-button
          appearance="stealth"
          id="show-more"
          class="show-more"
          @click=${()=>this.renderNextPage()}
        >
          <span class="show-more-text">${this.strings.showMoreSubtitle}</span>
        </fluent-button>`}renderFileUpload(){let e={graph:he.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return Ot`
        <mgt-file-upload .fileUploadList=${e} ></mgt-file-upload>
      `}loadState(){var e;return pR(this,void 0,void 0,function*(){let t=he.globalProvider;if(!t||t.state===Me.Loading)return;if(t.state===Me.SignedOut){this._files=null;return}this._graph=t.graph.forComponent(this);let o,i,n=!this.driveId&&!this.siteId&&!this.groupId&&!this.userId;if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this._files=null),!this.files){this.fileListQuery?i=yield tS(this._graph,this.fileListQuery,this.pageSize):this.fileQueries?o=yield iS(this._graph,this.fileQueries):n?this.itemId?i=yield Qx(this._graph,this.itemId,this.pageSize):this.itemPath?i=yield Yx(this._graph,this.itemPath,this.pageSize):this.insightType?o=yield rS(this._graph,this.insightType):i=yield qx(this._graph,this.pageSize):this.driveId?this.itemId?i=yield Gx(this._graph,this.driveId,this.itemId,this.pageSize):this.itemPath&&(i=yield jx(this._graph,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?i=yield Kx(this._graph,this.groupId,this.itemId,this.pageSize):this.itemPath&&(i=yield Wx(this._graph,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?i=yield Zx(this._graph,this.siteId,this.itemId,this.pageSize):this.itemPath&&(i=yield Jx(this._graph,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?i=yield Xx(this._graph,this.userId,this.itemId,this.pageSize):this.itemPath?i=yield eS(this._graph,this.userId,this.itemPath,this.pageSize):this.insightType&&(o=yield oS(this._graph,this.userId,this.insightType))),i&&(this.pageIterator=i,this._preloadedFiles=[...this.pageIterator.value],this._preloadedFiles.length>=this.pageSize?o=this._preloadedFiles.splice(0,this.pageSize):o=this._preloadedFiles.splice(0,this._preloadedFiles.length));let s;if(this.fileExtensions&&this.fileExtensions!==null){if(!((e=this.pageIterator)===null||e===void 0)&&e.value){for(;this.pageIterator.hasNext;)yield Xg(this.pageIterator);o=this.pageIterator.value,this._preloadedFiles=[]}s=o.filter(d=>{for(let u of this.fileExtensions)if(u===this.getFileExtension(d.name))return d})}s?.length>=0?(this._files=s,this.pageSize&&(o=this.files.splice(0,this.pageSize),this._files=o)):this._files=o}})}handleItemSelect(e,t){if(this.handleFileClick(e),this.fireCustomEvent("itemClick",e),t){let o=this.renderRoot.querySelector(".file-list"),i=Array.from(o.children),n=t.target.closest("li"),s=i.indexOf(n);this._focusedItemIndex=s;let d=o.children[this._focusedItemIndex];this.updateItemBackgroundColor(o,d,"selected")}}renderNextPage(){return pR(this,void 0,void 0,function*(){if(this._preloadedFiles.length>0)this._files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))];else if(this.pageIterator.hasNext){this._isLoadingMore=!0;let e=this.renderRoot.querySelector("#file-list-wrapper");e?.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),yield Xg(this.pageIterator),this._isLoadingMore=!1,this._files=this.pageIterator.value}})}handleFileClick(e){e?.webUrl&&!this.disableOpenOnClick&&window.open(e.webUrl,"_blank","noreferrer")}getFileExtension(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}updateItemBackgroundColor(e,t,o){for(let i of e.children)i.classList.remove(o),i.removeAttribute("tabindex");t&&(t.classList.add(o),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),t.setAttribute("tabindex","0"),t.focus());for(let i of e.children)i.classList.remove("selected")}reload(e=!1){e&&Uh(),this.requestStateUpdate()}};Je([K(),Te("design:type",Object)],Be.prototype,"_isCompact",void 0);Je([G({attribute:"file-list-query"}),Te("design:type",String),Te("design:paramtypes",[String])],Be.prototype,"fileListQuery",null);Je([G({attribute:"file-queries",converter:(r,e)=>r?r.split(",").map(t=>t.trim()):null}),Te("design:type",Array),Te("design:paramtypes",[Array])],Be.prototype,"fileQueries",null);Je([G({type:Object}),Te("design:type",Array),Te("design:paramtypes",[Array])],Be.prototype,"files",null);Je([G({attribute:"site-id"}),Te("design:type",String),Te("design:paramtypes",[String])],Be.prototype,"siteId",null);Je([G({attribute:"drive-id"}),Te("design:type",String),Te("design:paramtypes",[String])],Be.prototype,"driveId",null);Je([G({attribute:"group-id"}),Te("design:type",String),Te("design:paramtypes",[String])],Be.prototype,"groupId",null);Je([G({attribute:"item-id"}),Te("design:type",String),Te("design:paramtypes",[String])],Be.prototype,"itemId",null);Je([G({attribute:"item-path"}),Te("design:type",String),Te("design:paramtypes",[String])],Be.prototype,"itemPath",null);Je([G({attribute:"user-id"}),Te("design:type",String),Te("design:paramtypes",[String])],Be.prototype,"userId",null);Je([G({attribute:"insight-type"}),Te("design:type",String),Te("design:paramtypes",[String])],Be.prototype,"insightType",null);Je([G({attribute:"item-view",converter:r=>!r||r.length===0?be.threelines:(r=r.toLowerCase(),typeof be[r]>"u"?be.threelines:be[r])}),Te("design:type",Number)],Be.prototype,"itemView",void 0);Je([G({attribute:"file-extensions",converter:(r,e)=>r.split(",").map(t=>t.trim())}),Te("design:type",Array),Te("design:paramtypes",[Array])],Be.prototype,"fileExtensions",null);Je([G({attribute:"page-size",type:Number}),Te("design:type",Number),Te("design:paramtypes",[Number])],Be.prototype,"pageSize",null);Je([G({attribute:"disable-open-on-click",type:Boolean}),Te("design:type",Object)],Be.prototype,"disableOpenOnClick",void 0);Je([G({attribute:"hide-more-files-button",type:Boolean}),Te("design:type",Boolean)],Be.prototype,"hideMoreFilesButton",void 0);Je([G({attribute:"max-file-size",type:Number}),Te("design:type",Number),Te("design:paramtypes",[Number])],Be.prototype,"maxFileSize",null);Je([G({attribute:"enable-file-upload",type:Boolean}),Te("design:type",Boolean)],Be.prototype,"enableFileUpload",void 0);Je([G({attribute:"max-upload-file",type:Number}),Te("design:type",Number),Te("design:paramtypes",[Number])],Be.prototype,"maxUploadFile",null);Je([G({attribute:"excluded-file-extensions",converter:(r,e)=>r.split(",").map(t=>t.trim())}),Te("design:type",Array),Te("design:paramtypes",[Array])],Be.prototype,"excludedFileExtensions",null);Je([K(),Te("design:type",Array)],Be.prototype,"_files",void 0);Je([K(),Te("design:type",Object)],Be.prototype,"_graph",void 0);Je([K(),Te("design:type",String)],Be.prototype,"_fileListQuery",void 0);Je([K(),Te("design:type",Array)],Be.prototype,"_fileQueries",void 0);Je([K(),Te("design:type",String)],Be.prototype,"_siteId",void 0);Je([K(),Te("design:type",String)],Be.prototype,"_itemId",void 0);Je([K(),Te("design:type",String)],Be.prototype,"_driveId",void 0);Je([K(),Te("design:type",String)],Be.prototype,"_itemPath",void 0);Je([K(),Te("design:type",String)],Be.prototype,"_groupId",void 0);Je([K(),Te("design:type",String)],Be.prototype,"_insightType",void 0);Je([K(),Te("design:type",Array)],Be.prototype,"_fileExtensions",void 0);Je([K(),Te("design:type",Number)],Be.prototype,"_pageSize",void 0);Je([K(),Te("design:type",Array)],Be.prototype,"_excludedFileExtensions",void 0);Je([K(),Te("design:type",Number)],Be.prototype,"_maxUploadFile",void 0);Je([K(),Te("design:type",Number)],Be.prototype,"_maxFileSize",void 0);Je([K(),Te("design:type",String)],Be.prototype,"_userId",void 0);Je([K(),Te("design:type",Array)],Be.prototype,"_preloadedFiles",void 0);Je([K(),Te("design:type",Xs)],Be.prototype,"pageIterator",void 0);Je([K(),Te("design:type",Boolean)],Be.prototype,"_isLoadingMore",void 0)});var gR,vR=y(()=>{a();l();c();ut();gR=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--message-hover-color,var(--neutral-fill-hover));cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--message-subject-color,var(--neutral-foreground-color));font-size:var(--message-subject-font-size,14px);font-weight:var(--message-subject-font-weight,600);line-height:var(--message-subject-line-height,20px)}:host .root .message .message__detail .message__from{font-size:var(--message-subject-font-size,12px);color:var(--message-from-color,var(--neutral-foreground-color));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail .message__message{font-size:var(--message-subject-font-size,12px);color:var(--message-color,var(--neutral-foreground-hint));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{margin-top:8px;font-size:12px;color:var(--message-date,var(--neutral-foreground-hint));margin-left:10px;white-space:nowrap}
`]});var yR,bR=y(()=>{a();l();c();yR={emailsSectionTitle:"Emails"}});var CR,ou,wR=y(()=>{a();l();c();ut();nd();wi();da();vR();bR();lt();CR=()=>Nt("messages",ou),ou=class extends Fo{static get styles(){return gR}get strings(){return yR}constructor(e){super(),this._messages=e}get displayName(){return this.strings.emailsSectionTitle}get cardTitle(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return Ce(D.Messages)}renderCompactView(){var e;let t;if(this.isLoadingState)t=this.renderLoading();else if(!(!((e=this._messages)===null||e===void 0)&&e.length))t=this.renderNoData();else{let o=this._messages?this._messages.slice(0,3).map(i=>this.renderMessage(i)):[];t=T`
         ${o}
       `}return T`
       <div class="root compact">
         ${t}
       </div>
     `}renderFullView(){var e;let t;return this.isLoadingState?t=this.renderLoading():!((e=this._messages)===null||e===void 0)&&e.length?t=T`
         ${this._messages.slice(0,5).map(o=>this.renderMessage(o))}
       `:t=this.renderNoData(),T`
       <div class="root">
         ${t}
       </div>
     `}renderMessage(e){return T`
       <div class="message" @click=${()=>this.handleMessageClick(e)}>
         <div class="message__detail">
           <div class="message__subject">${e.subject}</div>
           <div class="message__from">${e.from.emailAddress.name}</div>
           <div class="message__message">${e.bodyPreview}</div>
         </div>
         <div class="message__date">${Th(new Date(e.receivedDateTime))}</div>
       </div>
     `}handleMessageClick(e){window.open(e.webLink,"_blank","noreferrer")}}});var xR,SR=y(()=>{a();l();c();ut();xR=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .subtitle{color:var(--organization-sub-title-color,var(--neutral-foreground-hint));font-size:14px;margin:0 20px 8px}:host .root .divider{display:flex;background:var(--organization-coworker-border-color,var(--neutral-stroke-rest));height:1px;margin:26px 20px 18px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--organization-active-org-member-target-background-color,var(--neutral-fill-active));border:1px solid var(--organization-active-org-member-border-color,var(--accent-foreground-rest))}:host .root .org-member:not(.org-member--target){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest))}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--organization-hover-color,var(--neutral-fill-hover))}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--organization-title-color,var(--neutral-foreground-rest));font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--organization-sub-title-color,var(--neutral-foreground-hint))}:host .root .org-member__separator:not(:last-child){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest));box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--organization-coworker-hover-color,var(--neutral-fill-hover))}:host .root .coworker .coworker__person{height:46px;border-radius:46px;margin-right:8px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{transform:scaleX(-1);filter:fliph;filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var _R,ER=y(()=>{a();l();c();_R={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"}});var TR,iu,kR=y(()=>{a();l();c();ut();nd();wi();SR();ER();es();lt();lt();nu();TR=()=>{Ls(),Nt("organization",iu)},iu=class extends Fo{static get styles(){return xR}get strings(){return _R}constructor(e,t){super(),this._state=e,this._me=t}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){let{person:e,directReports:t}=this._state;return!e.manager&&t?.length?`${this.strings.directReportsSectionTitle} (${t.length})`:this.strings.reportsToSectionTitle}get cardTitle(){return this.strings.organizationSectionTitle}renderIcon(){return Ce(D.Organization)}renderCompactView(){var e;let t;if(!(!((e=this._state)===null||e===void 0)&&e.person))return null;let{person:o,directReports:i}=this._state;if(o)o.manager?t=this.renderCoworker(o.manager):i?.length&&(t=this.renderCompactDirectReports());else return null;return T`
        <div class="root compact">
          ${t}
        </div>
      `}renderFullView(){var e;let t;if(!(!((e=this._state)===null||e===void 0)&&e.person))return null;let{person:o,directReports:i,people:n}=this._state;if(!o&&!i&&!n)return null;{let s=this.renderManagers(),d=this.renderCurrentUser(),u=this.renderDirectReports(),h=this.renderCoworkers();t=T`
          ${s} ${d} ${u} ${h}
        `}return T`
       <div class="root" dir=${this.direction}>
         ${t}
       </div>
     `}renderManager(e){return Ot`
      <div
        class="org-member"
        @keydown=${t=>{(t.code==="Enter"||t.code===" ")&&this.navigateCard(e)}}
        @click=${()=>this.navigateCard(e)}
      >
        <div class="org-member__person">
          <mgt-person
            .personDetails=${e}
            .fetchImage=${!0}
            .view=${be.twolines}
            .showPresence=${!0}
          ></mgt-person>
        </div>
        <div tabindex="0" class="org-member__more">
          ${Ce(D.ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
     `}renderManagers(){let{person:e}=this._state;if(!e?.manager)return null;let t=[],o=e;for(;o.manager;)t.push(o.manager),o=o.manager;return t.length?t.reverse().map(i=>this.renderManager(i)):null}renderDirectReports(){let{directReports:e}=this._state;return e?.length?T`
      <div class="org-member__separator"></div>
      <div>
        ${e.map(t=>Ot`
            <div
              class="org-member org-member--direct-report"
              @keydown=${o=>{(o.code==="Enter"||o.code===" ")&&this.navigateCard(t)}}
              @click=${()=>this.navigateCard(t)}
            >
              <div class="org-member__person">
                <mgt-person
                  .personDetails=${t}
                  .fetchImage=${!0}
                  .showPresence=${!0}
                  .view=${be.twolines}
                ></mgt-person>
              </div>
              <div tabindex="0" class="org-member__more">
                ${Ce(D.ExpandRight)}
              </div>
            </div>
            <div class="org-member__separator"></div>
          `)}
      </div>
     `:null}renderCompactDirectReports(){let{directReports:e}=this._state;return T`
      <div class="direct-report__compact">
        ${e.slice(0,6).map(t=>Ot`
            <div
              class="direct-report"
              @keydown=${o=>{(o.code==="Enter"||o.code===" ")&&this.navigateCard(t)}}
              @click=${()=>this.navigateCard(t)}
            >
              <mgt-person
                .personDetails=${t}
                .fetchImage=${!0}
                .showPresence=${!0}
                .view=${be.twolines}
              ></mgt-person>
            </div>
          `)}
      </div>
    `}renderCurrentUser(){let{person:e}=this._state;return Ot`
       <div class="org-member org-member--target">
         <div class="org-member__person">
           <mgt-person
             .personDetails=${e}
             .fetchImage=${!0}
             .showPresence=${!0}
             .view=${be.twolines}
           ></mgt-person>
         </div>
       </div>
     `}renderCoworker(e){return Ot`
      <div
        class="coworker"
        @keydown=${t=>{(t.code==="Enter"||t.code===" ")&&this.navigateCard(e)}}
        @click=${()=>this.navigateCard(e)}
      >
        <div class="coworker__person">
          <mgt-person
            .personDetails=${e}
            .fetchImage=${!0}
            .showPresence=${!0}
            .view=${be.twolines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworkers(){let{people:e}=this._state;if(!e?.length)return null;let t=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return T`
       <div class="divider"></div>
       <div class="subtitle" tabindex="0">${t}</div>
       <div>
         ${e.slice(0,6).map(o=>this.renderCoworker(o))}
       </div>
     `}}});var IR,AR=y(()=>{a();l();c();ut();IR=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none;background-color:var(--profile-background-color,--neutral-layer-1)}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--profile-title-color,var(--neutral-foreground-rest));margin:0 20px 12px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-flow:row wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--profile-token-item-background-color,var(--neutral-fill-secondary-rest));border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--profile-token-item-color,var(--neutral-foreground-rest))}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset;background:0 0;color:var(--profile-token-overflow-color,var(--accent-foreground-rest))}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--profile-title-color,var(--neutral-foreground-rest))}:host .root .data-list__item .data-list__item__date-range{color:var(--profile-section-title-color,var(--neutral-foreground-hint));font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#023b8f}:host .root .work-position .work-position__location{font-size:10px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--profile-title-color,var(--neutral-foreground-rest))}[dir=rtl] .token-list__item{margin-right:0!important}
`]});var RR,PR=y(()=>{a();l();c();RR={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current",socialMediaSubSectionTitle:"Social Media"}});var OR,su,$R=y(()=>{a();l();c();ut();nd();wi();AR();PR();lt();OR=()=>Nt("profile",su),su=class extends Fo{static get styles(){return IR}get strings(){return RR}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get cardTitle(){return this.strings.AboutCompactSectionTitle}get hasData(){var e,t;if(!this.profile)return!1;let{languages:o,skills:i,positions:n,educationalActivities:s}=this.profile;return[this._birthdayAnniversary,(e=this._personalInterests)===null||e===void 0?void 0:e.length,(t=this._professionalInterests)===null||t===void 0?void 0:t.length,o?.length,i?.length,n?.length,s?.length].filter(d=>!!d).length>0}get profile(){return this._profile}set profile(e){e!==this._profile&&(this._profile=e,this._birthdayAnniversary=e?.anniversaries?e.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=e?.interests?e.interests.filter(this.isPersonalInterest):null,this._professionalInterests=e?.interests?e.interests.filter(this.isProfessionalInterest):null)}constructor(e){super(),this.isPersonalInterest=t=>{var o;return(o=t.categories)===null||o===void 0?void 0:o.includes("personal")},this.isProfessionalInterest=t=>{var o;return(o=t.categories)===null||o===void 0?void 0:o.includes("professional")},this.isBirthdayAnniversary=t=>t.type==="birthday",this.profile=e}renderIcon(){return Ce(D.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return T`
       <div class="root compact" dir=${this.direction}>
         ${this.renderSubSections().slice(0,2)}
       </div>
     `}renderFullView(){return this.initPostRenderOperations(),T`
       <div class="root" dir=${this.direction}>
         ${this.renderSubSections()}
       </div>
     `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter(t=>!!t)}renderLanguages(){var e;let{languages:t}=this._profile;if(!t?.length)return null;let o=[];for(let n of t){let s=null;!((e=n.proficiency)===null||e===void 0)&&e.length&&(s=T`
           <span class="language__proficiency" tabindex="0">
             &nbsp;(${n.proficiency})
           </span>
         `),o.push(T`
         <div class="token-list__item language">
           <span class="language__title" tabindex="0">${n.displayName}</span>
           ${s}
         </div>
       `)}let i=o.length?this.strings.LanguagesSubSectionTitle:"";return T`
       <section>
         <div class="section__title" tabindex="0">${i}</div>
         <div class="section__content">
           <div class="token-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderSkills(){let{skills:e}=this._profile;if(!e?.length)return null;let t=[];for(let i of e)t.push(T`
         <div class="token-list__item skill" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.SkillsSubSectionTitle:"";return T`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderWorkExperience(){var e,t,o,i,n;let{positions:s}=this._profile;if(!s?.length)return null;let d=[];for(let h of this._profile.positions)(h.detail.description||h.detail.jobTitle!=="")&&d.push(T`
           <div class="data-list__item work-position">
             <div class="data-list__item__header">
               <div class="data-list__item__title" tabindex="0">${(e=h.detail)===null||e===void 0?void 0:e.jobTitle}</div>
               <div class="data-list__item__date-range" tabindex="0">
                 ${this.getDisplayDateRange(h.detail)}
               </div>
             </div>
             <div class="data-list__item__content">
               <div class="work-position__company" tabindex="0">
                 ${(o=(t=h?.detail)===null||t===void 0?void 0:t.company)===null||o===void 0?void 0:o.displayName}
               </div>
               <div class="work-position__location" tabindex="0">
                 ${this.displayLocation((n=(i=h?.detail)===null||i===void 0?void 0:i.company)===null||n===void 0?void 0:n.address)}
               </div>
             </div>
           </div>
         `);let u=d.length?this.strings.WorkExperienceSubSectionTitle:"";return T`
       <section>
         <div class="section__title" tabindex="0">${u}</div>
         <div class="section__content">
           <div class="data-list">
             ${d}
           </div>
         </div>
       </section>
     `}renderEducation(){let{educationalActivities:e}=this._profile;if(!e?.length)return null;let t=[];for(let i of e)t.push(T`
         <div class="data-list__item educational-activity">
           <div class="data-list__item__header">
             <div class="data-list__item__title" tabindex="0">${i.institution.displayName}</div>
             <div class="data-list__item__date-range" tabindex="0">
               ${this.getDisplayDateRange(i)}
             </div>
           </div>
           ${i.program.displayName?T`<div class="data-list__item__content">
                  <div class="educational-activity__degree" tabindex="0">
                  ${i.program.displayName}
                </div>`:yt}
         </div>
       `);let o=t.length?this.strings.EducationSubSectionTitle:"";return T`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="data-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderProfessionalInterests(){var e;if(!(!((e=this._professionalInterests)===null||e===void 0)&&e.length))return null;let t=[];for(let i of this._professionalInterests)t.push(T`
         <div class="token-list__item interest interest--professional" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.professionalInterestsSubSectionTitle:"";return T`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderPersonalInterests(){var e;if(!(!((e=this._personalInterests)===null||e===void 0)&&e.length))return null;let t=[];for(let i of this._personalInterests)t.push(T`
         <div class="token-list__item interest interest--personal" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.personalInterestsSubSectionTitle:"";return T`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderBirthday(){var e;return!((e=this._birthdayAnniversary)===null||e===void 0)&&e.date?T`
       <section>
         <div class="section__title" tabindex="0">Birthday</div>
         <div class="section__content">
           <div class="birthday">
             <div class="birthday__icon">
               ${Ce(D.Birthday)}
             </div>
             <div class="birthday__date" tabindex="0">
               ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
             </div>
           </div>
         </div>
       </section>
     `:null}getDisplayDate(e){return e.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(e){if(!e.startMonthYear)return yt;let t=new Date(e.startMonthYear).getFullYear();if(t===0||t===1)return yt;let o=e.endMonthYear?new Date(e.endMonthYear).getFullYear():this.strings.currentYearSubtitle;return`${t} \u2014 ${o}`}displayLocation(e){return e?.city?e.state?`${e.city}, ${e.state}`:e.city:yt}initPostRenderOperations(){setTimeout(()=>{try{this.shadowRoot.querySelectorAll("section").forEach(t=>{this.handleTokenOverflow(t)})}catch{}},0)}handleTokenOverflow(e){let t=e.querySelectorAll(".token-list");if(t?.length)for(let o of Array.from(t)){let i=o.querySelectorAll(".token-list__item");if(!i?.length)continue;let n=null,s=i[0].getBoundingClientRect(),d=o.getBoundingClientRect(),u=s.height*2+d.top;for(let h=0;h<i.length-1;h++)if(s=i[h].getBoundingClientRect(),s.top>u){n=Array.from(i).slice(h,i.length);break}if(n){n.forEach(v=>v.classList.add("overflow"));let h=document.createElement("div");h.classList.add("token-list__item"),h.classList.add("token-list__item--show-overflow"),h.tabIndex=0,h.innerText=`+ ${n.length} more`;let p=()=>{h.remove(),n.forEach(v=>v.classList.remove("overflow"))};h.addEventListener("click",()=>{p()}),h.addEventListener("keydown",v=>{v.code==="Enter"&&p()}),o.appendChild(h)}}}}});var MR,FR=y(()=>{a();l();c();Fh();MR=()=>{let r=[];return Rt.sections.files&&r.push("Sites.Read.All"),Rt.sections.mailMessages&&(r.push("Mail.Read"),r.push("Mail.ReadBasic")),Rt.sections.organization&&(r.push("User.Read.All"),Rt.sections.organization.showWorksWith&&r.push("People.Read.All")),Rt.sections.profile&&r.push("User.Read.All"),Rt.useContactApis&&r.push("Contacts.Read"),r.indexOf("User.Read.All")<0&&(r.push("User.ReadBasic.All"),r.push("User.Read")),r.indexOf("People.Read.All")<0&&r.push("People.Read"),Rt.isSendMessageVisible&&r.push("Chat.ReadWrite"),[...new Set(r)]}});var DR,LR=y(()=>{a();l();c();DR={showMoreSectionButton:"Show more",endOfCard:"End of the card",quickMessage:"Send a quick message",expandDetailsLabel:"Expand details",sendMessageLabel:"Send message",emailButtonLabel:"Email",callButtonLabel:"Call",chatButtonLabel:"Chat",closeCardLabel:"Close card",videoButtonLabel:"Video",goBackLabel:"Go Back"}});var NR=y(()=>{a();l();c()});var UR={};YR(UR,{MgtPersonCard:()=>yr,registerMgtPersonCardComponent:()=>C$});var fo,Vr,HR,C$,yr,BR=y(()=>{a();l();c();ut();Ao();ca();lt();ha();es();Rh();Oh();wi();Vg();cx();nu();ux();Cx();mR();wR();kR();$R();Fh();FR();LR();Kg();Lh();NR();oc();tu();lt();Lh();fo=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Vr=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},HR=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},C$=()=>{Ds(Qd,Kb,Gb,jb,qa,Yb),Nt("person-card",yr),fx(),bx(),TR(),CR(),fR(),OR(),customElements.get(Dc("person"))||Ls()},yr=class extends qr{static get styles(){return dx}get strings(){return DR}static get requiredScopes(){return MR()}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.personImage=this.getImage(),this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this._cardState=null,this.requestStateUpdate())}get internalPersonDetails(){var e;return((e=this._cardState)===null||e===void 0?void 0:e.person)||this.personDetails}constructor(){super(),this.isSending=!1,this.goBack=()=>{var e;if(!(!((e=this._history)===null||e===void 0)&&e.length))return;let t=this._history.pop();this._currentSection=null;let o=this.renderRoot.querySelector("fluent-tab");o&&o.click(),this._cardState=t.state,this._personDetails=t.state.person,this.personImage=t.personImage,this.loadSections()},this.handleEndOfCard=e=>{if(e&&e.code==="Tab"){let t=this.renderRoot.querySelector("#end-of-container");if(t){t.blur();let o=this.renderRoot.querySelector("mgt-person");o&&o.focus()}}},this.closeCard=()=>{this.updateCurrentSection(null),this.isExpanded=!1},this.sendQuickMessage=()=>HR(this,void 0,void 0,function*(){let e=this._chatInput.trim();if(!e?.length)return;let t=this.personDetails,o=this._me.userPrincipalName;this.isSending=!0;let i=yield ax(this._graph,t.userPrincipalName,o),n={body:{content:e}};yield lx(this._graph,i.id,n),this.isSending=!1,this.clearInputData()}),this.emailUser=()=>{let e=this.internalPersonDetails;if(e){let t=jr(e);t&&window.open("mailto:"+t,"_blank","noreferrer")}},this.callUser=()=>{var e,t;let o=this.personDetails,i=this.personDetails;if(!((e=o?.businessPhones)===null||e===void 0)&&e.length){let n=o.businessPhones[0];n&&window.open("tel:"+n,"_blank","noreferrer")}else if(!((t=i?.phones)===null||t===void 0)&&t.length){let s=this.getPersonBusinessPhones(i)[0];s&&window.open("tel:"+s,"_blank","noreferrer")}},this.chatUser=(e=null)=>{let t=this.personDetails;if(t?.userPrincipalName){let i=`https://teams.microsoft.com/l/chat/0/0?users=${t.userPrincipalName}`;e?.length&&(i+=`&message=${e}`);let n=()=>window.open(i,"_blank","noreferrer");Oi.isAvailable?Oi.executeDeepLink(i,s=>{s||n()}):n()}},this.videoCallUser=()=>{let e=this.personDetails;if(e?.userPrincipalName){let o=`https://teams.microsoft.com/l/call/0/0?users=${e.userPrincipalName}&withVideo=true`,i=()=>window.open(o,"_blank");Oi.isAvailable?Oi.executeDeepLink(o,n=>{n||i()}):i()}},this.showExpandedDetails=()=>{let e=this.renderRoot.querySelector(".root");e?.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)},this.sendQuickMessageOnEnter=e=>{e.code==="Enter"&&this.sendQuickMessage()},this.handleGoBack=e=>{e.code==="Enter"&&this.goBack()},this._chatInput="",this._currentSection=null,this._history=[],this.sections=[],this._graph=null}attributeChangedCallback(e,t,o){if(super.attributeChangedCallback(e,t,o),t!==o)switch(e){case"person-query":this.personDetails=null,this._cardState=null,this.requestStateUpdate();break}}navigate(e){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this._cardState}),this._personDetails=e,this._cardState=null,this.personImage=null,this._currentSection=null,this.sections=[],this._chatInput="",this.requestStateUpdate()}clearHistory(){var e;if(this._currentSection=null,!(!((e=this._history)===null||e===void 0)&&e.length))return;let t=this._history[0];this._history=[],this._cardState=t.state,this._personDetails=t.personDetails,this.personImage=t.personImage,this.loadSections()}render(){var e;if(!this.internalPersonDetails)return this.renderNoData();let t=this.internalPersonDetails,o=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:o});let i;i=this.strings.closeCardLabel;let n=this.isExpanded?T`
           <div class="close-card-container">
             <fluent-button 
              appearance="lightweight" 
              class="close-button" 
              aria-label=${i}
              @click=${this.closeCard} >
               ${Ce(D.Close)}
             </fluent-button>
           </div>
         `:null;i=this.strings.goBackLabel;let s=!((e=this._history)===null||e===void 0)&&e.length?T`
            <div class="nav">
              <fluent-button 
                appearance="lightweight"
                class="nav__back" 
                aria-label=${i} 
                @keydown=${this.handleGoBack}
                @click=${this.goBack}>${Ce(D.Back)}
               </fluent-button>
            </div>
          `:null,d=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:o});if(!d){let p=this.renderPerson(),v=this.renderContactIcons(t);d=T`
         ${p} ${v}
       `}let u=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0);let h=this.lockTabNavigation?T`<div @keydown=${this.handleEndOfCard} aria-label=${this.strings.endOfCard} tabindex="0" id="end-of-container"></div>`:T``;return T`
      <div class="root" dir=${this.direction}>
        <div class=${Qt({small:this._smallView})}>
          ${s}
          ${n}
          <div class="person-details-container">${d}</div>
          <div class="expanded-details-container">${u}</div>
          ${h}
        </div>
      </div>
     `}renderNoData(){return this.renderTemplate("no-data",null)||T``}renderPerson(){return Ot`
      <mgt-person
        tabindex="0"
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        .view=${be.threelines}
      ></mgt-person>
    `}renderPersonSubtitle(e){if(e=e||this.internalPersonDetails,!(!od(e)||!e.department))return T`
       <div class="department">${e.department}</div>
     `}renderContactIcons(e){e=e||this.internalPersonDetails;let t=e,o,i;jr(e)&&(o=`${this.strings.emailButtonLabel} ${e.displayName}`,i=T`
        <fluent-button class="icon"
          aria-label=${o}
          @click=${this.emailUser}>
          ${Ce(D.SmallEmail)}
        </fluent-button>
      `);let n;t?.userPrincipalName&&(o=`${this.strings.chatButtonLabel} ${e.displayName}`,n=T`
        <fluent-button class="icon"
          aria-label=${o}
          @click=${this.chatUser}>
          ${Ce(D.SmallChat)}
        </fluent-button>
       `),o=`${this.strings.videoButtonLabel} ${e.displayName}`;let s=T`
      <fluent-button class="icon"
        aria-label=${o}
        @click=${this.videoCallUser}>
        ${Ce(D.Video)}
      </fluent-button>
    `,d;return t.userPrincipalName&&(o=`${this.strings.callButtonLabel} ${e.displayName}`,d=T`
         <fluent-button class="icon"
          aria-label=${o}
          @click=${this.callUser}>
          ${Ce(D.Call)}
        </fluent-button>
       `),T`
       <div class="base-icons">
         ${i} ${n} ${s} ${d}
       </div>
     `}renderExpandedDetailsButton(){return T`
      <fluent-button
        aria-label=${this.strings.expandDetailsLabel}
        class="expanded-details-button"
        @click=${this.showExpandedDetails}
      >
        ${Ce(D.ExpandDown)}
      </fluent-button>
     `}renderExpandedDetails(){if(!this._cardState&&this._isStateLoading)return Ot`
         <div class="loading">
           <mgt-spinner></mgt-spinner>
         </div>
       `;he.globalProvider.state===Me.SignedOut&&this.loadSections();let t=this.renderSectionNavigation();return T`
      <div class="section-nav">
        ${t}
      </div>
      <hr class="divider"/>
      <div
        class="section-host ${this._smallView?"small":""} ${this._smallView?"small":""}"
        @wheel=${o=>this.handleSectionScroll(o)}
        tabindex=0
      ></div>
    `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;let e=this._currentSection?this.sections.indexOf(this._currentSection):-1,t=this.sections.map((n,s)=>{let d=n.tagName.toLowerCase(),u=Qt({active:s===e,"section-nav__icon":!0});return T`
        <fluent-tab
          id="${d}-Tab"
          class=${u}
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(n)}"
          @click=${()=>this.updateCurrentSection(n)}
        >
          ${n.renderIcon()}
        </fluent-tab>
      `}),o=this.sections.map(n=>T`
        <fluent-tab-panel slot="tabpanel">
          <div class="inserted">
            <div class="title">${n.cardTitle}</div>
            ${this._currentSection?n.asFullView():null}
          </div>
        </fluent-tab-panel>
      `),i=Qt({active:e===-1,"section-nav__icon":!0,overviewTab:!0});return T`
      <fluent-tabs
        orientation="horizontal"
        activeindicator
        @wheel=${n=>this.handleSectionScroll(n)}
      >
        <fluent-tab
          class="${i}"
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(null)}"
          @click=${()=>this.updateCurrentSection(null)}
        >
          <div>${Ce(D.Overview)}</div>
        </fluent-tab>
        ${t}
        <fluent-tab-panel slot="tabpanel" >
          <div class="overview-panel">${this._currentSection?null:this.renderOverviewSection()}</div>
        </fluent-tab-panel>
        ${o}
      </fluent-tabs>
    `}renderOverviewSection(){let e=this.sections.map(o=>T`
        <div class="section">
          <div class="section__header">
            <div class="section__title" tabindex=0>${o.displayName}</div>
              <fluent-button
                appearance="lightweight"
                class="section__show-more"
                @click=${()=>this.updateCurrentSection(o)}
              >
                ${this.strings.showMoreSectionButton}
              </fluent-button>
          </div>
          <div class="section__content">${o.asCompactView()}</div>
        </div>
      `),t=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this._cardState});return t&&e.splice(1,0,T`
           <div class="section">
             <div class="additional-details">${t}</div>
           </div>
         `),T`
       <div class="sections">
          ${this.renderMessagingSection()}
          ${e}
       </div>
     `}renderCurrentSection(){var e;if(!(!(!((e=this.sections)===null||e===void 0)&&e.length)&&!this.hasTemplate("additional-details")))return this.sections.length===1&&!this.hasTemplate("additional-details")?T`
         ${this.sections[0].asFullView()}
       `:this._currentSection?T`
       ${this._currentSection.asFullView()}
     `:this.renderOverviewSection()}renderMessagingSection(){let e=this.personDetails,t=this._me.userPrincipalName,o=this._chatInput;if(e?.userPrincipalName!==t)return Rt.isSendMessageVisible?T`
      <div class="message-section">
        <fluent-text-field
          autocomplete="off"
          appearance="outline"
          placeholder="${this.strings.quickMessage}"
          .value=${o}
          @input=${i=>{this._chatInput=i.target.value}}
          @keydown="${i=>this.sendQuickMessageOnEnter(i)}">
        </fluent-text-field>
        <fluent-button class="send-message-icon"
          aria-label=${this.strings.sendMessageLabel}
          @click=${this.sendQuickMessage}
          ?disabled=${this.isSending}>
          ${this.isSending?Ce(D.Confirmation):Ce(D.Send)}
        </fluent-button>
      </div>
      `:yt}loadState(){var e,t;return HR(this,void 0,void 0,function*(){if(this._cardState)return;if(!this.personDetails&&this.inheritDetails){let s=this.parentElement;for(;s&&s.tagName!==`${oo.prefix}-PERSON`.toUpperCase();)s=s.parentElement;let d=s.personDetails||s.personDetailsInternal;s&&d&&(this.personDetails=d,this.personImage=s.personImage)}let o=he.globalProvider;if(!o||o.state!==Me.SignedIn)return;let i=o.graph.forComponent(this);if(this._graph=i,this._isStateLoading=!0,this._me||(this._me=yield he.me()),this.personDetails){let s=this.personDetails,d;if(od(s)&&(d=s.userPrincipalName||s.id),d&&!jr(s)){let u=yield fa(i,d);this.personDetails=u,this.personImage=this.getImage()}}else if(this.userId||this.personQuery==="me"){let s=yield fa(i,this.userId);this.personDetails=s,this.personImage=this.getImage()}else if(this.personQuery){let s=yield Zc(i,this.personQuery,1);s?.length&&(this.personDetails=s[0],yield td(i,this.personDetails,Rt.useContactApis).then(d=>{d&&(this.personDetails.personImage=d,this.personImage=d)}))}let n={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{!((e=this.personDetails)===null||e===void 0)&&e.id?this.personPresence=yield Ph(i,this.personDetails.id):this.personPresence=n}catch{this.personPresence=n}!((t=this.personDetails)===null||t===void 0)&&t.id&&(this._cardState=yield sx(i,this.personDetails,this._me===this.personDetails.id)),this.loadSections(),this._isStateLoading=!1})}get hasPhone(){var e,t;let o=this.personDetails,i=this.personDetails;return!!(!((e=o?.businessPhones)===null||e===void 0)&&e.length)||!!(!((t=i?.phones)===null||t===void 0)&&t.length)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;let e=new sd(this.internalPersonDetails);if(e.hasData&&this.sections.push(e),!this._cardState)return;let{person:t,directReports:o,messages:i,files:n,profile:s}=this._cardState;if(Rt.sections.organization&&(t?.manager||o?.length)&&this.sections.push(new iu(this._cardState,this._me)),Rt.sections.mailMessages&&i?.length&&this.sections.push(new ou(i)),Rt.sections.files&&n?.length&&this.sections.push(new Be),Rt.sections.profile&&s){let d=new su(s);d.hasData&&this.sections.push(d)}}getImage(){if(this.personImage)return this.personImage;let e=this.personDetails;return e?.personImage?e.personImage:null}clearInputData(){this._chatInput=""}getPersonBusinessPhones(e){let t=e.phones,o=[];for(let i of t)i.type==="business"&&o.push(i.number);return o}updateCurrentSection(e){if(e){let o=e.tagName.toLowerCase();this.renderRoot.querySelector(`#${o}-Tab`).click()}let t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(let o of t)o.scrollTop=0;this._currentSection=e}handleSectionScroll(e){let t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(let o of t)o&&!(e.deltaY<0&&o.scrollTop===0)&&!(e.deltaY>0&&o.clientHeight+o.scrollTop>=o.scrollHeight-1)&&e.stopPropagation()}};fo([G({attribute:"person-details",type:Object}),Vr("design:type",Object),Vr("design:paramtypes",[Object])],yr.prototype,"personDetails",null);fo([G({attribute:"person-query"}),Vr("design:type",String)],yr.prototype,"personQuery",void 0);fo([G({attribute:"lock-tab-navigation",type:Boolean}),Vr("design:type",Boolean)],yr.prototype,"lockTabNavigation",void 0);fo([G({attribute:"user-id"}),Vr("design:type",String),Vr("design:paramtypes",[String])],yr.prototype,"userId",null);fo([G({attribute:"person-image",type:String}),Vr("design:type",String)],yr.prototype,"personImage",void 0);fo([G({attribute:"fetch-image",type:Boolean}),Vr("design:type",Boolean)],yr.prototype,"fetchImage",void 0);fo([G({attribute:"is-expanded",type:Boolean}),Vr("design:type",Boolean)],yr.prototype,"isExpanded",void 0);fo([G({attribute:"inherit-details",type:Boolean}),Vr("design:type",Boolean)],yr.prototype,"inheritDetails",void 0);fo([G({attribute:"show-presence",type:Boolean}),Vr("design:type",Boolean)],yr.prototype,"showPresence",void 0);fo([G({attribute:"person-presence",type:Object}),Vr("design:type",Object)],yr.prototype,"personPresence",void 0);fo([K(),Vr("design:type",Object)],yr.prototype,"isSending",void 0);fo([K(),Vr("design:type",Object)],yr.prototype,"_cardState",void 0);fo([K(),Vr("design:type",Boolean)],yr.prototype,"_isStateLoading",void 0);fo([K(),Vr("design:type",String)],yr.prototype,"_chatInput",void 0);fo([K(),Vr("design:type",Object)],yr.prototype,"_currentSection",void 0)});var rt,He,VR,w$,Ls,qe,nu=y(()=>{a();l();c();lt();ut();Ao();ca();ha();Rh();Vg();Ah();Oh();es();zg();wi();Mh();Mh();Gg();tx();jg();ox();Kg();Wg();lt();Gg();rt=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},He=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},VR=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},w$=["businessPhones","displayName","givenName","jobTitle","department","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id","userType"],Ls=()=>{Nt("person",qe),$h()},qe=class r extends qr{static get styles(){return ex}get strings(){return rx}get personQuery(){return this._personQuery}set personQuery(e){e!==this._personQuery&&(this._personQuery=e,this._personDetailsInternal=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,!this.personDetailsInternal&&this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this._personDetailsInternal=null,this.requestStateUpdate())}get usage(){return this._usage}set usage(e){e!==this._usage&&(this._usage=e,this.requestStateUpdate())}get personDetailsInternal(){return this._personDetailsInternal}set personDetailsInternal(e){this._personDetailsInternal!==e&&(this._personDetailsInternal=e,this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate())}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate())}get personImage(){return this._personImage||this._fetchedImage}set personImage(e){e!==this._personImage&&(this._isInvalidImageSrc=!e,this._personImage=e)}get avatarType(){return this._avatarType}set avatarType(e){e!==this._avatarType&&(this._avatarType=e,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(e){e!==this._personPresence&&(this._personPresence=e)}static get requiredScopes(){let e=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return r.config.useContactApis&&e.push("contacts.read"),e}get flyout(){return this.renderRoot.querySelector(".flyout")}constructor(){super(),this._hasLoadedPersonCard=!1,this._mouseLeaveTimeout=-1,this._mouseEnterTimeout=-1,this.handleMouseClick=e=>{let t=e.target;this.personCardInteraction===Mo.click&&t.tagName!==`${oo.prefix}-PERSON-CARD`.toUpperCase()&&this.showPersonCard()},this.handleKeyDown=e=>{e&&e.key==="Enter"&&this.showPersonCard()},this.handleMouseEnter=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===Mo.hover&&(this._mouseEnterTimeout=window.setTimeout(this.showPersonCard,500))},this.handleMouseLeave=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=window.setTimeout(this.hidePersonCard,500)},this.hidePersonCard=()=>{let e=this.flyout;e&&e.close();let t=this.querySelector(".mgt-person-card")||this.renderRoot.querySelector(".mgt-person-card");t&&(t.isExpanded=!1,t.clearHistory())},this.loadPersonCardResources=()=>VR(this,void 0,void 0,function*(){if(this.personCardInteraction!==Mo.none&&!this._hasLoadedPersonCard){let{registerMgtPersonCardComponent:e}=yield Promise.resolve().then(()=>(BR(),UR));customElements.get(Dc("person-card"))||e(),this._hasLoadedPersonCard=!0}}),this.showPersonCard=()=>{this._personCardShouldRender||(this._personCardShouldRender=!0,this.loadPersonCardResources());let e=this.flyout;e&&e.open()},this.clearState(),this.personCardInteraction=Mo.none,this.line1Property="displayName",this.line2Property="jobTitle",this.line3Property="department",this.line4Property="email",this.view=be.image,this.avatarSize="auto",this.disableImageFetch=!1,this._isInvalidImageSrc=!1,this._avatarType=jo.photo,this.verticalLayout=!1,this._personQuery="",this._userId=""}render(){if(this.isLoadingState&&!this.personDetails&&!this.personDetailsInternal&&!this.fallbackDetails)return this.renderLoading();let e=this.personDetails||this.personDetailsInternal||this.fallbackDetails,t=this.getImage(),o=this.personPresence||this._fetchedPresence;if(!e&&!t)return this.renderNoData();!e?.personImage&&t&&(e.personImage=t);let i=this.renderTemplate("default",{person:e,personImage:t,personPresence:o});if(!i){let d=this.renderDetails(e,o),u=this.renderAvatar(e,t,o);i=T`
        ${u}
        ${d}
      `}this.personCardInteraction!==Mo.none&&(i=this.renderFlyout(i,e,t,o));let s=Qt({"person-root":!0,small:!this.isThreeLines()&&!this.isFourLines()&&!this.isLargeAvatar(),large:this.avatarSize!=="auto"&&this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines(),vertical:this.isVertical()});return T`
      <div
        class="${s}"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
        @keydown=${this.handleKeyDown}
        tabindex="${ts(this.personCardInteraction!==Mo.none?"0":void 0)}"
      >
        ${i}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||T``}clearState(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null,this._personDetails=null,this._personPresence=null,this._usage="",this._fallbackDetails=null,this._personCardShouldRender=!1}renderNoData(){let e=this.renderTemplate("no-data",null);if(e)return e;let t={"avatar-icon":!0,vertical:this.isVertical(),small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines()};return T`
       <i class=${Qt(t)}></i>
     `}renderPersonIcon(){return Ce(D.Person)}renderImage(e,t){var o;let i=`${this.strings.photoFor} ${e.displayName}`,n=t&&!this._isInvalidImageSrc&&this.avatarType===jo.photo,s=this.avatarType===jo.photo&&this.view===be.image,d=(o=e?.displayName||jr(e))!==null&&o!==void 0?o:void 0,u=T`<img
      title="${ts(s?d:void 0)}"
      alt=${i}
      src=${t}
      @error=${()=>this._isInvalidImageSrc=!0} />`,h=e?this.getInitials(e):"",p=h?.length,v=Qt({initials:p&&!n,"contact-icon":!p}),C=T`<i>${this.renderPersonIcon()}</i>`,x=T`
      <span 
        title="${ts(this.view===be.image?d:void 0)}"
        role="${ts(this.view===be.image?void 0:"presentation")}"
        class="${v}"
      >
        ${p?h:C}
      </span>
`;return n&&this.fireCustomEvent("person-image-rendered"),n?u:x}renderPresence(e){var t;if(!this.showPresence||!e)return T``;let o,{activity:i,availability:n}=e;switch(n){case"Available":case"AvailableIdle":switch(i){case"OutOfOffice":o=Ce(D.PresenceOofAvailable);break;case"Available":default:o=Ce(D.PresenceAvailable);break}break;case"Busy":case"BusyIdle":switch(i){case"OutOfOffice":case"OnACall":o=Ce(D.PresenceOofBusy);break;case"Busy":case"InACall":case"InAMeeting":case"InAConferenceCall":default:o=Ce(D.PresenceBusy);break}break;case"DoNotDisturb":switch(i){case"OutOfOffice":o=Ce(D.PresenceOofDnd);break;case"Presenting":case"Focusing":case"UrgentInterruptionsOnly":default:o=Ce(D.PresenceDnd);break}break;case"Away":switch(i){case"OutOfOffice":o=Ce(D.PresenceOofAway);break;case"AwayLastSeenTime":default:o=Ce(D.PresenceAway);break}break;case"BeRightBack":switch(i){default:o=Ce(D.PresenceAway);break}break;case"Offline":switch(i){case"Offline":o=Ce(D.PresenceOffline);break;case"OutOfOffice":case"OffWork":o=Ce(D.PresenceOofAway);break;default:o=Ce(D.PresenceStatusUnknown);break}break;default:o=Ce(D.PresenceStatusUnknown);break}let s=Qt({"presence-wrapper":!0,noline:this.isNoLine(),oneline:this.isOneLine()}),d=(t=this.strings[i])!==null&&t!==void 0?t:yt;return T`
      <span
        class="${s}"
        title="${d}"
        aria-label="${d}"
        role="img">
          ${o}
      </span>
    `}renderAvatar(e,t,o){let i=!t||this._isInvalidImageSrc||this._avatarType===jo.initials,n="";if(i&&e?n=`${this.strings.initials} ${this.getInitials(e)}`:(n=e&&e.displayName||"",n!==""&&(n=`${this.strings.photoFor} ${n}`)),n===""){let u=jr(e);u!==null&&(n=`${this.strings.emailAddress} ${u}`)}let s=this.renderImage(e,t),d=this.renderPresence(o);return T`
      <div class="avatar-wrapper">
        ${s}
        ${d}
      </div>
    `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}handleLine4Clicked(){this.fireCustomEvent("line4clicked",this.personDetailsInternal)}renderDetails(e,t){if(!e||this.view===be.image||this.view===bl.avatar)return T``;let o=e;t&&(o.presenceActivity=t?.activity,o.presenceAvailability=t?.availability);let i=[],n="";if(this.view>be.image)if(n=this.getTextFromProperty(o,this.line1Property),this.hasTemplate("line1")){let d=this.renderTemplate("line1",{person:o});i.push(T`
           <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${n}">${d}</div>
         `)}else n&&i.push(T`
             <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${n}">${n}</div>
           `);if(this.view>be.oneline)if(n=this.getTextFromProperty(o,this.line2Property),this.hasTemplate("line2")){let d=this.renderTemplate("line2",{person:o});i.push(T`
           <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${n}">${d}</div>
         `)}else n&&i.push(T`
             <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${n}">${n}</div>
           `);if(this.view>be.twolines)if(n=this.getTextFromProperty(o,this.line3Property),this.hasTemplate("line3")){let d=this.renderTemplate("line3",{person:o});i.push(T`
           <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${n}">${d}</div>
         `)}else n&&i.push(T`
             <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${n}">${n}</div>
           `);if(this.view>be.threelines)if(n=this.getTextFromProperty(o,this.line4Property),this.hasTemplate("line4")){let d=this.renderTemplate("line4",{person:o});i.push(T`
          <div class="line4" @click=${()=>this.handleLine4Clicked()} role="presentation" aria-label="${n}">${d}</div>
        `)}else n&&i.push(T`
            <div class="line4" @click=${()=>this.handleLine4Clicked()} role="presentation" aria-label="${n}">${n}</div>
          `);let s=Qt({"details-wrapper":!0,vertical:this.isVertical()});return T`
      <div class="${s}">
        ${i}
      </div>
    `}renderFlyout(e,t,o,i){let n=this._personCardShouldRender&&this._hasLoadedPersonCard?T`
           <div slot="flyout" data-testid="flyout-slot">
             ${this.renderFlyoutContent(t,o,i)}
           </div>`:T``,s=Qt({vertical:this.isVertical()});return Ot`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        <div slot="anchor" class="${s}">${e}</div>
        ${n}
      </mgt-flyout>`}renderFlyoutContent(e,t,o){return this.fireCustomEvent("flyout-content-rendered"),this.renderTemplate("person-card",{person:e,personImage:t})||Ot`
        <mgt-person-card
          class="mgt-person-card"
          lock-tab-navigation
          .personDetails=${e}
          .personImage=${t}
          .personPresence=${o}
          .showPresence=${this.showPresence}>
        </mgt-person-card>`}loadState(){return VR(this,void 0,void 0,function*(){let e=he.globalProvider;if(!e||e.state===Me.Loading)return;if(e&&e.state===Me.SignedOut){this._personDetailsInternal=null;return}this._graph=e.graph.forComponent(this),(this.verticalLayout&&this.view<be.fourlines||this.fallbackDetails)&&(this.line2Property="email");let t=[...w$,this.line1Property,this.line2Property,this.line3Property,this.line4Property];t=t.filter(n=>n!=="email");let o=this.personDetailsInternal||this.personDetails;if(o){if(!o.personImage&&this.fetchImage&&this._avatarType===jo.photo&&!this.personImage&&!this._fetchedImage){let n;"groupTypes"in o?n=yield Bw(this._graph,o):n=yield td(this._graph,o,r.config.useContactApis),n&&(o.personImage=n,this._fetchedImage=n)}}else if(this.userId||this.personQuery==="me"){let n;this._avatarType===jo.photo&&!this.disableImageFetch?n=yield fa(this._graph,this.userId,t):this.personQuery==="me"?n=yield Nw(this._graph,t):n=yield Hw(this._graph,this.userId,t),this._personDetailsInternal=n,this._personDetails=n,this._fetchedImage=this.getImage()}else if(this.personQuery){let n=yield Zc(this._graph,this.personQuery,1);if((!n||n.length===0)&&(n=(yield Ih(this._graph,this.personQuery,1))||[]),n?.length&&(this._personDetailsInternal=n[0],this._personDetails=n[0],this._avatarType===jo.photo&&!this.disableImageFetch)){let s=yield td(this._graph,n[0],r.config.useContactApis);s&&(this._personDetailsInternal.personImage=s,this._personDetails.personImage=s,this._fetchedImage=s)}}o=this.personDetailsInternal||this.personDetails||this.fallbackDetails;let i={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(o){let n=this.personQuery!=="me"?o?.id:null;this._fetchedPresence=yield Ph(this._graph,n)}else this._fetchedPresence=i}catch{this._fetchedPresence=i}})}getInitials(e){var t,o,i,n,s,d;if(e||(e=this.personDetailsInternal),ix(e))return e.initials;let u="";if(od(e)&&(u+=(i=(o=(t=e.givenName)===null||t===void 0?void 0:t[0])===null||o===void 0?void 0:o.toUpperCase())!==null&&i!==void 0?i:"",u+=(d=(s=(n=e.surname)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.toUpperCase())!==null&&d!==void 0?d:""),!u&&e.displayName){let h=e.displayName.split(/\s+/);for(let p=0;p<2&&p<h.length;p++)h[p][0]&&this.isLetter(h[p][0])&&(u+=h[p][0].toUpperCase())}return u}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;let e=this.personDetailsInternal||this.personDetails;return e?.personImage?e.personImage:null}isLetter(e){try{return e.match(new RegExp("\\p{L}","u"))}catch{return e.toLowerCase()!==e.toUpperCase()}}getTextFromProperty(e,t){if(!t||t.length===0)return null;let o=t.trim().split(","),i,n=0;for(;!i&&n<o.length;){let s=o[n].trim();switch(s){case"mail":case"email":i=jr(e);break;default:i=e[s]}n++}return i}isLargeAvatar(){return this.avatarSize==="large"||this.avatarSize==="auto"&&this.view>be.oneline}isNoLine(){return this.view<be.oneline}isOneLine(){return this.view===be.oneline}isTwoLines(){return this.view===be.twolines}isThreeLines(){return this.view===be.threelines}isFourLines(){return this.view===be.fourlines}isVertical(){return this.verticalLayout}};qe.config={useContactApis:!0};rt([G({attribute:"person-query"}),He("design:type",String),He("design:paramtypes",[String])],qe.prototype,"personQuery",null);rt([G({attribute:"fallback-details",type:Object}),He("design:type",Object),He("design:paramtypes",[Object])],qe.prototype,"fallbackDetails",null);rt([G({attribute:"user-id"}),He("design:type",String),He("design:paramtypes",[String])],qe.prototype,"userId",null);rt([G({attribute:"usage"}),He("design:type",String),He("design:paramtypes",[String])],qe.prototype,"usage",null);rt([G({attribute:"show-presence",type:Boolean}),He("design:type",Boolean)],qe.prototype,"showPresence",void 0);rt([G({attribute:"avatar-size",type:String}),He("design:type",String)],qe.prototype,"avatarSize",void 0);rt([K(),He("design:type",Object),He("design:paramtypes",[Object])],qe.prototype,"personDetailsInternal",null);rt([G({attribute:"person-details",type:Object}),He("design:type",Object),He("design:paramtypes",[Object])],qe.prototype,"personDetails",null);rt([G({attribute:"person-image",type:String}),He("design:type",String),He("design:paramtypes",[String])],qe.prototype,"personImage",null);rt([G({attribute:"fetch-image",type:Boolean}),He("design:type",Boolean)],qe.prototype,"fetchImage",void 0);rt([G({attribute:"disable-image-fetch",type:Boolean}),He("design:type",Boolean)],qe.prototype,"disableImageFetch",void 0);rt([G({attribute:"vertical-layout",type:Boolean}),He("design:type",Boolean)],qe.prototype,"verticalLayout",void 0);rt([G({attribute:"avatar-type",converter:r=>(r=r.toLowerCase(),r==="initials"?jo.initials:jo.photo)}),He("design:type",String),He("design:paramtypes",[String])],qe.prototype,"avatarType",null);rt([G({attribute:"person-presence",type:Object}),He("design:type",Object),He("design:paramtypes",[Object])],qe.prototype,"personPresence",null);rt([G({attribute:"person-card",converter:r=>(r=r.toLowerCase(),typeof Mo[r]>"u"?Mo.none:Mo[r])}),He("design:type",Number)],qe.prototype,"personCardInteraction",void 0);rt([G({attribute:"line1-property"}),He("design:type",String)],qe.prototype,"line1Property",void 0);rt([G({attribute:"line2-property"}),He("design:type",String)],qe.prototype,"line2Property",void 0);rt([G({attribute:"line3-property"}),He("design:type",String)],qe.prototype,"line3Property",void 0);rt([G({attribute:"line4-property"}),He("design:type",String)],qe.prototype,"line4Property",void 0);rt([G({converter:r=>!r||r.length===0?be.image:(r=r.toLowerCase(),typeof be[r]>"u"?be.image:be[r])}),He("design:type",Number)],qe.prototype,"view",void 0);rt([K(),He("design:type",String)],qe.prototype,"_fetchedImage",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_fetchedPresence",void 0);rt([K(),He("design:type",Boolean)],qe.prototype,"_isInvalidImageSrc",void 0);rt([K(),He("design:type",Boolean)],qe.prototype,"_personCardShouldRender",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_hasLoadedPersonCard",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_personDetailsInternal",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_personDetails",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_fallbackDetails",void 0);rt([K(),He("design:type",String)],qe.prototype,"_personImage",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_personPresence",void 0);rt([K(),He("design:type",String)],qe.prototype,"_personQuery",void 0);rt([K(),He("design:type",String)],qe.prototype,"_userId",void 0);rt([K(),He("design:type",String)],qe.prototype,"_usage",void 0);rt([K(),He("design:type",String)],qe.prototype,"_avatarType",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_graph",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_mouseLeaveTimeout",void 0);rt([K(),He("design:type",Object)],qe.prototype,"_mouseEnterTimeout",void 0)});a();l();c();a();l();c();a();l();c();var P$=__STORYBOOKADDONS__,{addons:au,types:l1,mockChannel:O$}=__STORYBOOKADDONS__;a();l();c();a();l();c();a();l();c();a();l();c();var c1=(()=>{let r;return typeof window<"u"?r=window:typeof globalThis<"u"?r=globalThis:typeof window<"u"?r=window:typeof self<"u"?r=self:r={},r})();a();l();c();var B$=__STORYBOOKCLIENTLOGGER__,{deprecate:V$,logger:d1,once:z$,pretty:q$}=__STORYBOOKCLIENTLOGGER__;function Wa(){return Wa=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Wa.apply(this,arguments)}function ZR(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ic(r,e){return ic=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},ic(r,e)}function JR(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,ic(r,e)}function um(r){return um=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},um(r)}function XR(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function e4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lu(r,e,t){return e4()?lu=Reflect.construct.bind():lu=function(o,i,n){var s=[null];s.push.apply(s,i);var d=Function.bind.apply(o,s),u=new d;return n&&ic(u,n.prototype),u},lu.apply(null,arguments)}function hm(r){var e=typeof Map=="function"?new Map:void 0;return hm=function(t){if(t===null||!XR(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return lu(t,arguments,um(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),ic(o,t)},hm(r)}var t4={1:`Passed invalid arguments to hsl, please pass multiple numbers e.g. hsl(360, 0.75, 0.4) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75 }).

`,2:`Passed invalid arguments to hsla, please pass multiple numbers e.g. hsla(360, 0.75, 0.4, 0.7) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75, alpha: 0.7 }).

`,3:`Passed an incorrect argument to a color function, please pass a string representation of a color.

`,4:`Couldn't generate valid rgb string from %s, it returned %s.

`,5:`Couldn't parse the color string. Please provide the color as a string in hex, rgb, rgba, hsl or hsla notation.

`,6:`Passed invalid arguments to rgb, please pass multiple numbers e.g. rgb(255, 205, 100) or an object e.g. rgb({ red: 255, green: 205, blue: 100 }).

`,7:`Passed invalid arguments to rgba, please pass multiple numbers e.g. rgb(255, 205, 100, 0.75) or an object e.g. rgb({ red: 255, green: 205, blue: 100, alpha: 0.75 }).

`,8:`Passed invalid argument to toColorString, please pass a RgbColor, RgbaColor, HslColor or HslaColor object.

`,9:`Please provide a number of steps to the modularScale helper.

`,10:`Please pass a number or one of the predefined scales to the modularScale helper as the ratio.

`,11:`Invalid value passed as base to modularScale, expected number or em string but got "%s"

`,12:`Expected a string ending in "px" or a number passed as the first argument to %s(), got "%s" instead.

`,13:`Expected a string ending in "px" or a number passed as the second argument to %s(), got "%s" instead.

`,14:`Passed invalid pixel value ("%s") to %s(), please pass a value like "12px" or 12.

`,15:`Passed invalid base value ("%s") to %s(), please pass a value like "12px" or 12.

`,16:`You must provide a template to this method.

`,17:`You passed an unsupported selector state to this method.

`,18:`minScreen and maxScreen must be provided as stringified numbers with the same units.

`,19:`fromSize and toSize must be provided as stringified numbers with the same units.

`,20:`expects either an array of objects or a single object with the properties prop, fromSize, and toSize.

`,21:"expects the objects in the first argument array to have the properties `prop`, `fromSize`, and `toSize`.\n\n",22:"expects the first argument object to have the properties `prop`, `fromSize`, and `toSize`.\n\n",23:`fontFace expects a name of a font-family.

`,24:`fontFace expects either the path to the font file(s) or a name of a local copy.

`,25:`fontFace expects localFonts to be an array.

`,26:`fontFace expects fileFormats to be an array.

`,27:`radialGradient requries at least 2 color-stops to properly render.

`,28:`Please supply a filename to retinaImage() as the first argument.

`,29:`Passed invalid argument to triangle, please pass correct pointingDirection e.g. 'right'.

`,30:"Passed an invalid value to `height` or `width`. Please provide a pixel based unit.\n\n",31:`The animation shorthand only takes 8 arguments. See the specification for more information: http://mdn.io/animation

`,32:`To pass multiple animations please supply them in arrays, e.g. animation(['rotate', '2s'], ['move', '1s'])
To pass a single animation please supply them in simple values, e.g. animation('rotate', '2s')

`,33:`The animation shorthand arrays can only have 8 elements. See the specification for more information: http://mdn.io/animation

`,34:`borderRadius expects a radius value as a string or number as the second argument.

`,35:`borderRadius expects one of "top", "bottom", "left" or "right" as the first argument.

`,36:`Property must be a string value.

`,37:`Syntax Error at %s.

`,38:`Formula contains a function that needs parentheses at %s.

`,39:`Formula is missing closing parenthesis at %s.

`,40:`Formula has too many closing parentheses at %s.

`,41:`All values in a formula must have the same unit or be unitless.

`,42:`Please provide a number of steps to the modularScale helper.

`,43:`Please pass a number or one of the predefined scales to the modularScale helper as the ratio.

`,44:`Invalid value passed as base to modularScale, expected number or em/rem string but got %s.

`,45:`Passed invalid argument to hslToColorString, please pass a HslColor or HslaColor object.

`,46:`Passed invalid argument to rgbToColorString, please pass a RgbColor or RgbaColor object.

`,47:`minScreen and maxScreen must be provided as stringified numbers with the same units.

`,48:`fromSize and toSize must be provided as stringified numbers with the same units.

`,49:`Expects either an array of objects or a single object with the properties prop, fromSize, and toSize.

`,50:`Expects the objects in the first argument array to have the properties prop, fromSize, and toSize.

`,51:`Expects the first argument object to have the properties prop, fromSize, and toSize.

`,52:`fontFace expects either the path to the font file(s) or a name of a local copy.

`,53:`fontFace expects localFonts to be an array.

`,54:`fontFace expects fileFormats to be an array.

`,55:`fontFace expects a name of a font-family.

`,56:`linearGradient requries at least 2 color-stops to properly render.

`,57:`radialGradient requries at least 2 color-stops to properly render.

`,58:`Please supply a filename to retinaImage() as the first argument.

`,59:`Passed invalid argument to triangle, please pass correct pointingDirection e.g. 'right'.

`,60:"Passed an invalid value to `height` or `width`. Please provide a pixel based unit.\n\n",61:`Property must be a string value.

`,62:`borderRadius expects a radius value as a string or number as the second argument.

`,63:`borderRadius expects one of "top", "bottom", "left" or "right" as the first argument.

`,64:`The animation shorthand only takes 8 arguments. See the specification for more information: http://mdn.io/animation.

`,65:`To pass multiple animations please supply them in arrays, e.g. animation(['rotate', '2s'], ['move', '1s'])\\nTo pass a single animation please supply them in simple values, e.g. animation('rotate', '2s').

`,66:`The animation shorthand arrays can only have 8 elements. See the specification for more information: http://mdn.io/animation.

`,67:`You must provide a template to this method.

`,68:`You passed an unsupported selector state to this method.

`,69:`Expected a string ending in "px" or a number passed as the first argument to %s(), got %s instead.

`,70:`Expected a string ending in "px" or a number passed as the second argument to %s(), got %s instead.

`,71:`Passed invalid pixel value %s to %s(), please pass a value like "12px" or 12.

`,72:`Passed invalid base value %s to %s(), please pass a value like "12px" or 12.

`,73:`Please provide a valid CSS variable.

`,74:`CSS variable not found and no default was provided.

`,75:`important requires a valid style object, got a %s instead.

`,76:`fromSize and toSize must be provided as stringified numbers with the same units as minScreen and maxScreen.

`,77:`remToPx expects a value in "rem" but you provided it in "%s".

`,78:`base must be set in "px" or "%" but you set it in "%s".
`};function r4(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var o=e[0],i=[],n;for(n=1;n<e.length;n+=1)i.push(e[n]);return i.forEach(function(s){o=o.replace(/%[a-z]/,s)}),o}var Ii=function(r){JR(e,r);function e(t){for(var o,i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];return o=r.call(this,r4.apply(void 0,[t4[t]].concat(n)))||this,ZR(o)}return e}(hm(Error));function sm(r){return Math.round(r*255)}function o4(r,e,t){return sm(r)+","+sm(e)+","+sm(t)}function nc(r,e,t,o){if(o===void 0&&(o=o4),e===0)return o(t,t,t);var i=(r%360+360)%360/60,n=(1-Math.abs(2*t-1))*e,s=n*(1-Math.abs(i%2-1)),d=0,u=0,h=0;i>=0&&i<1?(d=n,u=s):i>=1&&i<2?(d=s,u=n):i>=2&&i<3?(u=n,h=s):i>=3&&i<4?(u=s,h=n):i>=4&&i<5?(d=s,h=n):i>=5&&i<6&&(d=n,h=s);var p=t-n/2,v=d+p,C=u+p,x=h+p;return o(v,C,x)}var u1={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function i4(r){if(typeof r!="string")return r;var e=r.toLowerCase();return u1[e]?"#"+u1[e]:r}var n4=/^#[a-fA-F0-9]{6}$/,s4=/^#[a-fA-F0-9]{8}$/,a4=/^#[a-fA-F0-9]{3}$/,l4=/^#[a-fA-F0-9]{4}$/,am=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,c4=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,d4=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,u4=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function hu(r){if(typeof r!="string")throw new Ii(3);var e=i4(r);if(e.match(n4))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(s4)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(a4))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(l4)){var o=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:o}}var i=am.exec(e);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var n=c4.exec(e.substring(0,50));if(n)return{red:parseInt(""+n[1],10),green:parseInt(""+n[2],10),blue:parseInt(""+n[3],10),alpha:parseFloat(""+n[4])>1?parseFloat(""+n[4])/100:parseFloat(""+n[4])};var s=d4.exec(e);if(s){var d=parseInt(""+s[1],10),u=parseInt(""+s[2],10)/100,h=parseInt(""+s[3],10)/100,p="rgb("+nc(d,u,h)+")",v=am.exec(p);if(!v)throw new Ii(4,e,p);return{red:parseInt(""+v[1],10),green:parseInt(""+v[2],10),blue:parseInt(""+v[3],10)}}var C=u4.exec(e.substring(0,50));if(C){var x=parseInt(""+C[1],10),E=parseInt(""+C[2],10)/100,O=parseInt(""+C[3],10)/100,q="rgb("+nc(x,E,O)+")",_e=am.exec(q);if(!_e)throw new Ii(4,e,q);return{red:parseInt(""+_e[1],10),green:parseInt(""+_e[2],10),blue:parseInt(""+_e[3],10),alpha:parseFloat(""+C[4])>1?parseFloat(""+C[4])/100:parseFloat(""+C[4])}}throw new Ii(5)}function h4(r){var e=r.red/255,t=r.green/255,o=r.blue/255,i=Math.max(e,t,o),n=Math.min(e,t,o),s=(i+n)/2;if(i===n)return r.alpha!==void 0?{hue:0,saturation:0,lightness:s,alpha:r.alpha}:{hue:0,saturation:0,lightness:s};var d,u=i-n,h=s>.5?u/(2-i-n):u/(i+n);switch(i){case e:d=(t-o)/u+(t<o?6:0);break;case t:d=(o-e)/u+2;break;default:d=(e-t)/u+4;break}return d*=60,r.alpha!==void 0?{hue:d,saturation:h,lightness:s,alpha:r.alpha}:{hue:d,saturation:h,lightness:s}}function f1(r){return h4(hu(r))}var p4=function(r){return r.length===7&&r[1]===r[2]&&r[3]===r[4]&&r[5]===r[6]?"#"+r[1]+r[3]+r[5]:r},pm=p4;function Ns(r){var e=r.toString(16);return e.length===1?"0"+e:e}function lm(r){return Ns(Math.round(r*255))}function f4(r,e,t){return pm("#"+lm(r)+lm(e)+lm(t))}function du(r,e,t){return nc(r,e,t,f4)}function m4(r,e,t){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number")return du(r,e,t);if(typeof r=="object"&&e===void 0&&t===void 0)return du(r.hue,r.saturation,r.lightness);throw new Ii(1)}function g4(r,e,t,o){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number"&&typeof o=="number")return o>=1?du(r,e,t):"rgba("+nc(r,e,t)+","+o+")";if(typeof r=="object"&&e===void 0&&t===void 0&&o===void 0)return r.alpha>=1?du(r.hue,r.saturation,r.lightness):"rgba("+nc(r.hue,r.saturation,r.lightness)+","+r.alpha+")";throw new Ii(2)}function fm(r,e,t){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number")return pm("#"+Ns(r)+Ns(e)+Ns(t));if(typeof r=="object"&&e===void 0&&t===void 0)return pm("#"+Ns(r.red)+Ns(r.green)+Ns(r.blue));throw new Ii(6)}function sc(r,e,t,o){if(typeof r=="string"&&typeof e=="number"){var i=hu(r);return"rgba("+i.red+","+i.green+","+i.blue+","+e+")"}else{if(typeof r=="number"&&typeof e=="number"&&typeof t=="number"&&typeof o=="number")return o>=1?fm(r,e,t):"rgba("+r+","+e+","+t+","+o+")";if(typeof r=="object"&&e===void 0&&t===void 0&&o===void 0)return r.alpha>=1?fm(r.red,r.green,r.blue):"rgba("+r.red+","+r.green+","+r.blue+","+r.alpha+")"}throw new Ii(7)}var v4=function(r){return typeof r.red=="number"&&typeof r.green=="number"&&typeof r.blue=="number"&&(typeof r.alpha!="number"||typeof r.alpha>"u")},y4=function(r){return typeof r.red=="number"&&typeof r.green=="number"&&typeof r.blue=="number"&&typeof r.alpha=="number"},b4=function(r){return typeof r.hue=="number"&&typeof r.saturation=="number"&&typeof r.lightness=="number"&&(typeof r.alpha!="number"||typeof r.alpha>"u")},C4=function(r){return typeof r.hue=="number"&&typeof r.saturation=="number"&&typeof r.lightness=="number"&&typeof r.alpha=="number"};function m1(r){if(typeof r!="object")throw new Ii(8);if(y4(r))return sc(r);if(v4(r))return fm(r);if(C4(r))return g4(r);if(b4(r))return m4(r);throw new Ii(8)}function g1(r,e,t){return function(){var o=t.concat(Array.prototype.slice.call(arguments));return o.length>=e?r.apply(this,o):g1(r,e,o)}}function pu(r){return g1(r,r.length,[])}function fu(r,e,t){return Math.max(r,Math.min(e,t))}function w4(r,e){if(e==="transparent")return e;var t=f1(e);return m1(Wa({},t,{lightness:fu(0,1,t.lightness-parseFloat(r))}))}var x4=pu(w4),S4=x4;function _4(r,e){if(e==="transparent")return e;var t=f1(e);return m1(Wa({},t,{lightness:fu(0,1,t.lightness+parseFloat(r))}))}var E4=pu(_4),T4=E4;function k4(r,e){if(e==="transparent")return e;var t=hu(e),o=typeof t.alpha=="number"?t.alpha:1,i=Wa({},t,{alpha:fu(0,1,(o*100+parseFloat(r)*100)/100)});return sc(i)}var Z$=pu(k4);function I4(r,e){if(e==="transparent")return e;var t=hu(e),o=typeof t.alpha=="number"?t.alpha:1,i=Wa({},t,{alpha:fu(0,1,+(o*100-parseFloat(r)*100).toFixed(2)/100)});return sc(i)}var A4=pu(I4),R4=A4,er={primary:"#FF4785",secondary:"#029CFD",tertiary:"#FAFBFC",ancillary:"#22a699",orange:"#FC521F",gold:"#FFAE00",green:"#66BF3C",seafoam:"#37D5D3",purple:"#6F2CAC",ultraviolet:"#2A0481",lightest:"#FFFFFF",lighter:"#F7FAFC",light:"#EEF3F6",mediumlight:"#ECF4F9",medium:"#D9E8F2",mediumdark:"#73828C",dark:"#5C6870",darker:"#454E54",darkest:"#2E3438",border:"hsla(203, 50%, 30%, 0.15)",positive:"#66BF3C",negative:"#FF4400",warning:"#E69D00",critical:"#FFFFFF",defaultText:"#2E3438",inverseText:"#FFFFFF",positiveText:"#448028",negativeText:"#D43900",warningText:"#A15C20"},h1={app:"#F6F9FC",bar:er.lightest,content:er.lightest,gridCellSize:10,hoverable:R4(.9,er.secondary),positive:"#E1FFD4",negative:"#FEDED2",warning:"#FFF5CF",critical:"#FF4400"},uu={fonts:{base:['"Nunito Sans"',"-apple-system",'".SFNSText-Regular"','"San Francisco"',"BlinkMacSystemFont",'"Segoe UI"','"Helvetica Neue"',"Helvetica","Arial","sans-serif"].join(", "),mono:["ui-monospace","Menlo","Monaco",'"Roboto Mono"','"Oxygen Mono"','"Ubuntu Monospace"','"Source Code Pro"','"Droid Sans Mono"','"Courier New"',"monospace"].join(", ")},weight:{regular:400,bold:700},size:{s1:12,s2:14,s3:16,m1:20,m2:24,m3:28,l1:32,l2:40,l3:48,code:90}},P4={base:"light",colorPrimary:"#FF4785",colorSecondary:"#029CFD",appBg:h1.app,appContentBg:er.lightest,appBorderColor:er.border,appBorderRadius:4,fontBase:uu.fonts.base,fontCode:uu.fonts.mono,textColor:er.darkest,textInverseColor:er.lightest,textMutedColor:er.mediumdark,barTextColor:er.mediumdark,barHoverColor:er.secondary,barSelectedColor:er.secondary,barBg:er.lightest,buttonBg:h1.app,buttonBorder:er.medium,booleanBg:er.mediumlight,booleanSelectedBg:er.lightest,inputBg:er.lightest,inputBorder:er.border,inputTextColor:er.darkest,inputBorderRadius:4},p1=P4,O4={base:"dark",colorPrimary:"#FF4785",colorSecondary:"#029CFD",appBg:"#222425",appContentBg:"#1B1C1D",appBorderColor:"rgba(255,255,255,.1)",appBorderRadius:4,fontBase:uu.fonts.base,fontCode:uu.fonts.mono,textColor:"#C9CDCF",textInverseColor:"#222425",textMutedColor:"#798186",barTextColor:"#798186",barHoverColor:er.secondary,barSelectedColor:er.secondary,barBg:"#292C2E",buttonBg:"#222425",buttonBorder:"rgba(255,255,255,.1)",booleanBg:"#222425",booleanSelectedBg:"#2E3438",inputBg:"#1B1C1D",inputBorder:"rgba(255,255,255,.1)",inputTextColor:er.lightest,inputBorderRadius:4},$4=O4,{window:cm}=c1;var M4=r=>typeof r!="string"?(d1.warn(`Color passed to theme object should be a string. Instead ${r}(${typeof r}) was passed.`),!1):!0,F4=r=>!/(gradient|var|calc)/.test(r),D4=(r,e)=>r==="darken"?sc(`${S4(1,e)}`,.95):r==="lighten"?sc(`${T4(1,e)}`,.95):e,v1=r=>e=>{if(!M4(e)||!F4(e))return e;try{return D4(r,e)}catch{return e}},J$=v1("lighten"),X$=v1("darken"),L4=()=>!cm||!cm.matchMedia?"light":cm.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",cu={light:p1,dark:$4,normal:p1},dm=L4(),mm=(r={base:dm},e)=>{let t={...cu[dm],...cu[r.base]||{},...r,base:cu[r.base]?r.base:dm};return{...e,...t,barSelectedColor:r.barSelectedColor||t.colorSecondary}};var y1=mm({base:"light",colorSecondary:"#0360B9",textColor:"#1A1A1A",textInverseColor:"rgba(255,255,255,0.9)",barTextColor:"#717171",brandTitle:"Microsoft Graph Toolkit Playground",brandUrl:"https://aka.ms/mgt"});a();l();c();var an=__REACT__,{Children:f7,Component:m7,Fragment:g7,Profiler:v7,PureComponent:y7,StrictMode:b7,Suspense:C7,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:w7,cloneElement:x7,createContext:S7,createElement:_7,createFactory:E7,createRef:T7,forwardRef:k7,isValidElement:I7,lazy:A7,memo:R7,useCallback:P7,useContext:O7,useDebugValue:$7,useEffect:M7,useImperativeHandle:F7,useLayoutEffect:D7,useMemo:L7,useReducer:N7,useRef:H7,useState:b1,version:U7}=__REACT__;a();l();c();var G7=__STORYBOOKAPI__,{ActiveTabs:j7,Consumer:K7,ManagerContext:W7,Provider:Q7,addons:Y7,combineParameters:Z7,controlOrMetaKey:J7,controlOrMetaSymbol:X7,eventMatchesShortcut:e9,eventToShortcut:t9,isMacLike:r9,isShortcutTaken:o9,keyToSymbol:i9,merge:n9,mockChannel:s9,optionOrAltSymbol:a9,shortcutMatchesShortcut:l9,shortcutToHumanString:c9,types:d9,useAddonState:u9,useArgTypes:h9,useArgs:p9,useChannel:C1,useGlobalTypes:f9,useGlobals:m9,useParameter:g9,useSharedState:v9,useStoryPrepared:y9,useStorybookApi:b9,useStorybookState:C9}=__STORYBOOKAPI__;Us();Bn();a();l();c();lt();a();l();c();a();l();c();a();l();c();a();l();c();var ng=function(r,e){return ng=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])},ng(r,e)};function ct(r,e){ng(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var te=function(){return te=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},te.apply(this,arguments)};function sg(r,e){var t={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(r);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(r,o[i])&&(t[o[i]]=r[o[i]]);return t}function $(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})}function M(r,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,s;return s={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function d(h){return function(p){return u([h,p])}}function u(h){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,i&&(n=h[0]&2?i.return:h[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,h[1])).done)return n;switch(i=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,i=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(r,t)}catch(p){h=[6,p],i=0}finally{o=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function g3(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var o=t.call(r),i,n=[],s;try{for(;(e===void 0||e-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(d){s={error:d}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(s)throw s.error}}return n}function al(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(g3(arguments[e]));return r}a();l();c();a();l();c();a();l();c();var ag=function(r,e){return ag=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])},ag(r,e)};function ot(r,e){ag(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Xe=function(){return Xe=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Xe.apply(this,arguments)};function oe(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})}function ie(r,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,s;return s={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function d(h){return function(p){return u([h,p])}}function u(h){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,i&&(n=h[0]&2?i.return:h[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,h[1])).done)return n;switch(i=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,i=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(r,t)}catch(p){h=[6,p],i=0}finally{o=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function jn(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var o=Array(r),i=0,e=0;e<t;e++)for(var n=arguments[e],s=0,d=n.length;s<d;s++,i++)o[i]=n[s];return o}a();l();c();a();l();c();a();l();c();a();l();c();a();l();c();var S={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},gi=[S.OPENID_SCOPE,S.PROFILE_SCOPE,S.OFFLINE_ACCESS_SCOPE],lg=jn(gi,[S.EMAIL_SCOPE]),kt;(function(r){r.CONTENT_TYPE="Content-Type",r.RETRY_AFTER="Retry-After",r.CCS_HEADER="X-AnchorMailbox",r.WWWAuthenticate="WWW-Authenticate",r.AuthenticationInfo="Authentication-Info",r.X_MS_REQUEST_ID="x-ms-request-id",r.X_MS_HTTP_VERSION="x-ms-httpver"})(kt||(kt={}));var tr;(function(r){r.ID_TOKEN="idtoken",r.CLIENT_INFO="client.info",r.ADAL_ID_TOKEN="adal.idtoken",r.ERROR="error",r.ERROR_DESC="error.description",r.ACTIVE_ACCOUNT="active-account",r.ACTIVE_ACCOUNT_FILTERS="active-account-filters"})(tr||(tr={}));var hn;(function(r){r.COMMON="common",r.ORGANIZATIONS="organizations",r.CONSUMERS="consumers"})(hn||(hn={}));var Fe;(function(r){r.CLIENT_ID="client_id",r.REDIRECT_URI="redirect_uri",r.RESPONSE_TYPE="response_type",r.RESPONSE_MODE="response_mode",r.GRANT_TYPE="grant_type",r.CLAIMS="claims",r.SCOPE="scope",r.ERROR="error",r.ERROR_DESCRIPTION="error_description",r.ACCESS_TOKEN="access_token",r.ID_TOKEN="id_token",r.REFRESH_TOKEN="refresh_token",r.EXPIRES_IN="expires_in",r.STATE="state",r.NONCE="nonce",r.PROMPT="prompt",r.SESSION_STATE="session_state",r.CLIENT_INFO="client_info",r.CODE="code",r.CODE_CHALLENGE="code_challenge",r.CODE_CHALLENGE_METHOD="code_challenge_method",r.CODE_VERIFIER="code_verifier",r.CLIENT_REQUEST_ID="client-request-id",r.X_CLIENT_SKU="x-client-SKU",r.X_CLIENT_VER="x-client-VER",r.X_CLIENT_OS="x-client-OS",r.X_CLIENT_CPU="x-client-CPU",r.X_CLIENT_CURR_TELEM="x-client-current-telemetry",r.X_CLIENT_LAST_TELEM="x-client-last-telemetry",r.X_MS_LIB_CAPABILITY="x-ms-lib-capability",r.X_APP_NAME="x-app-name",r.X_APP_VER="x-app-ver",r.POST_LOGOUT_URI="post_logout_redirect_uri",r.ID_TOKEN_HINT="id_token_hint",r.DEVICE_CODE="device_code",r.CLIENT_SECRET="client_secret",r.CLIENT_ASSERTION="client_assertion",r.CLIENT_ASSERTION_TYPE="client_assertion_type",r.TOKEN_TYPE="token_type",r.REQ_CNF="req_cnf",r.OBO_ASSERTION="assertion",r.REQUESTED_TOKEN_USE="requested_token_use",r.ON_BEHALF_OF="on_behalf_of",r.FOCI="foci",r.CCS_HEADER="X-AnchorMailbox",r.RETURN_SPA_CODE="return_spa_code",r.NATIVE_BROKER="nativebroker",r.LOGOUT_HINT="logout_hint"})(Fe||(Fe={}));var Kn;(function(r){r.ACCESS_TOKEN="access_token",r.XMS_CC="xms_cc"})(Kn||(Kn={}));var Kt={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},ea;(function(r){r.ACCOUNT="account",r.SID="sid",r.LOGIN_HINT="login_hint",r.ID_TOKEN="id_token",r.DOMAIN_HINT="domain_hint",r.ORGANIZATIONS="organizations",r.CONSUMERS="consumers",r.ACCOUNT_ID="accountIdentifier",r.HOMEACCOUNT_ID="homeAccountIdentifier"})(ea||(ea={}));var ah={PLAIN:"plain",S256:"S256"},ta;(function(r){r.QUERY="query",r.FRAGMENT="fragment",r.FORM_POST="form_post"})(ta||(ta={}));var go;(function(r){r.IMPLICIT_GRANT="implicit",r.AUTHORIZATION_CODE_GRANT="authorization_code",r.CLIENT_CREDENTIALS_GRANT="client_credentials",r.RESOURCE_OWNER_PASSWORD_GRANT="password",r.REFRESH_TOKEN_GRANT="refresh_token",r.DEVICE_CODE_GRANT="device_code",r.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"})(go||(go={}));var mi;(function(r){r.MSSTS_ACCOUNT_TYPE="MSSTS",r.ADFS_ACCOUNT_TYPE="ADFS",r.MSAV1_ACCOUNT_TYPE="MSA",r.GENERIC_ACCOUNT_TYPE="Generic"})(mi||(mi={}));var It;(function(r){r.CACHE_KEY_SEPARATOR="-",r.CLIENT_INFO_SEPARATOR="."})(It||(It={}));var ae;(function(r){r.ID_TOKEN="IdToken",r.ACCESS_TOKEN="AccessToken",r.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",r.REFRESH_TOKEN="RefreshToken"})(ae||(ae={}));var Vo;(function(r){r[r.ADFS=1001]="ADFS",r[r.MSA=1002]="MSA",r[r.MSSTS=1003]="MSSTS",r[r.GENERIC=1004]="GENERIC",r[r.ACCESS_TOKEN=2001]="ACCESS_TOKEN",r[r.REFRESH_TOKEN=2002]="REFRESH_TOKEN",r[r.ID_TOKEN=2003]="ID_TOKEN",r[r.APP_METADATA=3001]="APP_METADATA",r[r.UNDEFINED=9999]="UNDEFINED"})(Vo||(Vo={}));var Nc="appmetadata",nw="client_info",Wn="1",oa={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Ro;(function(r){r.CONFIG="config",r.CACHE="cache",r.NETWORK="network",r.HARDCODED_VALUES="hardcoded_values"})(Ro||(Ro={}));var pr={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Ne;(function(r){r.BEARER="Bearer",r.POP="pop",r.SSH="ssh-cert"})(Ne||(Ne={}));var fn={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},lh={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},ll;(function(r){r.username="username",r.password="password"})(ll||(ll={}));var ra;(function(r){r[r.httpSuccess=200]="httpSuccess",r[r.httpBadRequest=400]="httpBadRequest"})(ra||(ra={}));var pn;(function(r){r.FAILED_AUTO_DETECTION="1",r.INTERNAL_CACHE="2",r.ENVIRONMENT_VARIABLE="3",r.IMDS="4"})(pn||(pn={}));var cl;(function(r){r.CONFIGURED_MATCHES_DETECTED="1",r.CONFIGURED_NO_AUTO_DETECTION="2",r.CONFIGURED_NOT_DETECTED="3",r.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",r.AUTO_DETECTION_REQUESTED_FAILED="5"})(cl||(cl={}));var Gr;(function(r){r.NO_CACHE_HIT="0",r.FORCE_REFRESH="1",r.NO_CACHED_ACCESS_TOKEN="2",r.CACHED_ACCESS_TOKEN_EXPIRED="3",r.REFRESH_CACHED_ACCESS_TOKEN="4",r.CLAIMS_REQUESTED_CACHE_SKIPPED="5"})(Gr||(Gr={}));var sh;(function(r){r.Jwt="JWT",r.Jwk="JWK",r.Pop="pop"})(sh||(sh={}));var dl={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}},Y=function(r){ot(e,r);function e(t,o,i){var n=this,s=o?t+": "+o:t;return n=r.call(this,s)||this,Object.setPrototypeOf(n,e.prototype),n.errorCode=t||S.EMPTY_STRING,n.errorMessage=o||S.EMPTY_STRING,n.subError=i||S.EMPTY_STRING,n.name="AuthError",n}return e.prototype.setCorrelationId=function(t){this.correlationId=t},e.createUnexpectedError=function(t){return new e(dl.unexpectedError.code,dl.unexpectedError.desc+": "+t)},e.createPostRequestFailed=function(t){return new e(dl.postRequestFailed.code,dl.postRequestFailed.desc+": "+t)},e}(Error);var Qn={createNewGuid:function(){var r="Crypto interface - createNewGuid() has not been implemented";throw Y.createUnexpectedError(r)},base64Decode:function(){var r="Crypto interface - base64Decode() has not been implemented";throw Y.createUnexpectedError(r)},base64Encode:function(){var r="Crypto interface - base64Encode() has not been implemented";throw Y.createUnexpectedError(r)},generatePkceCodes:function(){return oe(this,void 0,void 0,function(){var r;return ie(this,function(e){throw r="Crypto interface - generatePkceCodes() has not been implemented",Y.createUnexpectedError(r)})})},getPublicKeyThumbprint:function(){return oe(this,void 0,void 0,function(){var r;return ie(this,function(e){throw r="Crypto interface - getPublicKeyThumbprint() has not been implemented",Y.createUnexpectedError(r)})})},removeTokenBindingKey:function(){return oe(this,void 0,void 0,function(){var r;return ie(this,function(e){throw r="Crypto interface - removeTokenBindingKey() has not been implemented",Y.createUnexpectedError(r)})})},clearKeystore:function(){return oe(this,void 0,void 0,function(){var r;return ie(this,function(e){throw r="Crypto interface - clearKeystore() has not been implemented",Y.createUnexpectedError(r)})})},signJwt:function(){return oe(this,void 0,void 0,function(){var r;return ie(this,function(e){throw r="Crypto interface - signJwt() has not been implemented",Y.createUnexpectedError(r)})})},hashString:function(){return oe(this,void 0,void 0,function(){var r;return ie(this,function(e){throw r="Crypto interface - hashString() has not been implemented",Y.createUnexpectedError(r)})})}};a();l();c();a();l();c();a();l();c();var z={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},authTimeNotFoundError:{code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},maxAgeTranspiredError:{code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},userCanceledError:{code:"user_canceled",desc:"User canceled the flow."}},L=function(r){ot(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,e.prototype),i}return e.createClientInfoDecodingError=function(t){return new e(z.clientInfoDecodingError.code,z.clientInfoDecodingError.desc+" Failed with error: "+t)},e.createClientInfoEmptyError=function(){return new e(z.clientInfoEmptyError.code,""+z.clientInfoEmptyError.desc)},e.createTokenParsingError=function(t){return new e(z.tokenParsingError.code,z.tokenParsingError.desc+" Failed with error: "+t)},e.createTokenNullOrEmptyError=function(t){return new e(z.nullOrEmptyToken.code,z.nullOrEmptyToken.desc+" Raw Token Value: "+t)},e.createEndpointDiscoveryIncompleteError=function(t){return new e(z.endpointResolutionError.code,z.endpointResolutionError.desc+" Detail: "+t)},e.createNetworkError=function(t,o){return new e(z.networkError.code,z.networkError.desc+" | Fetch client threw: "+o+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToGetOpenidConfigError=function(t){return new e(z.unableToGetOpenidConfigError.code,z.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+t)},e.createHashNotDeserializedError=function(t){return new e(z.hashNotDeserialized.code,z.hashNotDeserialized.desc+" Given Object: "+t)},e.createInvalidStateError=function(t,o){return new e(z.invalidStateError.code,z.invalidStateError.desc+" Invalid State: "+t+", Root Err: "+o)},e.createStateMismatchError=function(){return new e(z.stateMismatchError.code,z.stateMismatchError.desc)},e.createStateNotFoundError=function(t){return new e(z.stateNotFoundError.code,z.stateNotFoundError.desc+":  "+t)},e.createNonceMismatchError=function(){return new e(z.nonceMismatchError.code,z.nonceMismatchError.desc)},e.createAuthTimeNotFoundError=function(){return new e(z.authTimeNotFoundError.code,z.authTimeNotFoundError.desc)},e.createMaxAgeTranspiredError=function(){return new e(z.maxAgeTranspiredError.code,z.maxAgeTranspiredError.desc)},e.createNonceNotFoundError=function(t){return new e(z.nonceNotFoundError.code,z.nonceNotFoundError.desc+":  "+t)},e.createMultipleMatchingTokensInCacheError=function(){return new e(z.multipleMatchingTokens.code,z.multipleMatchingTokens.desc+".")},e.createMultipleMatchingAccountsInCacheError=function(){return new e(z.multipleMatchingAccounts.code,z.multipleMatchingAccounts.desc)},e.createMultipleMatchingAppMetadataInCacheError=function(){return new e(z.multipleMatchingAppMetadata.code,z.multipleMatchingAppMetadata.desc)},e.createTokenRequestCannotBeMadeError=function(){return new e(z.tokenRequestCannotBeMade.code,z.tokenRequestCannotBeMade.desc)},e.createAppendEmptyScopeToSetError=function(t){return new e(z.appendEmptyScopeError.code,z.appendEmptyScopeError.desc+" Given Scope: "+t)},e.createRemoveEmptyScopeFromSetError=function(t){return new e(z.removeEmptyScopeError.code,z.removeEmptyScopeError.desc+" Given Scope: "+t)},e.createAppendScopeSetError=function(t){return new e(z.appendScopeSetError.code,z.appendScopeSetError.desc+" Detail Error: "+t)},e.createEmptyInputScopeSetError=function(){return new e(z.emptyInputScopeSetError.code,""+z.emptyInputScopeSetError.desc)},e.createDeviceCodeCancelledError=function(){return new e(z.DeviceCodePollingCancelled.code,""+z.DeviceCodePollingCancelled.desc)},e.createDeviceCodeExpiredError=function(){return new e(z.DeviceCodeExpired.code,""+z.DeviceCodeExpired.desc)},e.createDeviceCodeUnknownError=function(){return new e(z.DeviceCodeUnknownError.code,""+z.DeviceCodeUnknownError.desc)},e.createNoAccountInSilentRequestError=function(){return new e(z.NoAccountInSilentRequest.code,""+z.NoAccountInSilentRequest.desc)},e.createNullOrUndefinedCacheRecord=function(){return new e(z.invalidCacheRecord.code,z.invalidCacheRecord.desc)},e.createInvalidCacheEnvironmentError=function(){return new e(z.invalidCacheEnvironment.code,z.invalidCacheEnvironment.desc)},e.createNoAccountFoundError=function(){return new e(z.noAccountFound.code,z.noAccountFound.desc)},e.createCachePluginError=function(){return new e(z.CachePluginError.code,""+z.CachePluginError.desc)},e.createNoCryptoObjectError=function(t){return new e(z.noCryptoObj.code,""+z.noCryptoObj.desc+t)},e.createInvalidCacheTypeError=function(){return new e(z.invalidCacheType.code,""+z.invalidCacheType.desc)},e.createUnexpectedAccountTypeError=function(){return new e(z.unexpectedAccountType.code,""+z.unexpectedAccountType.desc)},e.createUnexpectedCredentialTypeError=function(){return new e(z.unexpectedCredentialType.code,""+z.unexpectedCredentialType.desc)},e.createInvalidAssertionError=function(){return new e(z.invalidAssertion.code,""+z.invalidAssertion.desc)},e.createInvalidCredentialError=function(){return new e(z.invalidClientCredential.code,""+z.invalidClientCredential.desc)},e.createRefreshRequiredError=function(){return new e(z.tokenRefreshRequired.code,z.tokenRefreshRequired.desc)},e.createUserTimeoutReachedError=function(){return new e(z.userTimeoutReached.code,z.userTimeoutReached.desc)},e.createTokenClaimsRequiredError=function(){return new e(z.tokenClaimsRequired.code,z.tokenClaimsRequired.desc)},e.createNoAuthCodeInServerResponseError=function(){return new e(z.noAuthorizationCodeFromServer.code,z.noAuthorizationCodeFromServer.desc)},e.createBindingKeyNotRemovedError=function(){return new e(z.bindingKeyNotRemovedError.code,z.bindingKeyNotRemovedError.desc)},e.createLogoutNotSupportedError=function(){return new e(z.logoutNotSupported.code,z.logoutNotSupported.desc)},e.createKeyIdMissingError=function(){return new e(z.keyIdMissing.code,z.keyIdMissing.desc)},e.createNoNetworkConnectivityError=function(){return new e(z.noNetworkConnectivity.code,z.noNetworkConnectivity.desc)},e.createUserCanceledError=function(){return new e(z.userCanceledError.code,z.userCanceledError.desc)},e}(Y);var N=function(){function r(){}return r.decodeAuthToken=function(e){if(r.isEmpty(e))throw L.createTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,o=t.exec(e);if(!o||o.length<4)throw L.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));var i={header:o[1],JWSPayload:o[2],JWSSig:o[3]};return i},r.isEmpty=function(e){return typeof e>"u"||!e||e.length===0},r.isEmptyObj=function(e){if(e&&!r.isEmpty(e))try{var t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0},r.startsWith=function(e,t){return e.indexOf(t)===0},r.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},r.queryStringToObject=function(e){var t={},o=e.split("&"),i=function(n){return decodeURIComponent(n.replace(/\+/g," "))};return o.forEach(function(n){if(n.trim()){var s=n.split(/=(.+)/g,2),d=s[0],u=s[1];d&&u&&(t[i(d)]=i(u))}}),t},r.trimArrayEntries=function(e){return e.map(function(t){return t.trim()})},r.removeEmptyStringsFromArray=function(e){return e.filter(function(t){return!r.isEmpty(t)})},r.jsonParseHelper=function(e){try{return JSON.parse(e)}catch{return null}},r.matchPattern=function(e,t){var o=new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?"));return o.test(t)},r}();var Wt;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace"})(Wt||(Wt={}));var $i=function(){function r(e,t,o){this.level=Wt.Info;var i=function(){},n=e||r.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||i,this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level=typeof n.logLevel=="number"?n.logLevel:Wt.Info,this.correlationId=n.correlationId||S.EMPTY_STRING,this.packageName=t||S.EMPTY_STRING,this.packageVersion=o||S.EMPTY_STRING}return r.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Wt.Info}},r.prototype.clone=function(e,t,o){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:o||this.correlationId},e,t)},r.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var o=new Date().toUTCString(),i;N.isEmpty(t.correlationId)?N.isEmpty(this.correlationId)?i="["+o+"]":i="["+o+"] : ["+this.correlationId+"]":i="["+o+"] : ["+t.correlationId+"]";var n=i+" : "+this.packageName+"@"+this.packageVersion+" : "+Wt[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},r.prototype.executeCallback=function(e,t,o){this.localCallback&&this.localCallback(e,t,o)},r.prototype.error=function(e,t){this.logMessage(e,{logLevel:Wt.Error,containsPii:!1,correlationId:t||S.EMPTY_STRING})},r.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:Wt.Error,containsPii:!0,correlationId:t||S.EMPTY_STRING})},r.prototype.warning=function(e,t){this.logMessage(e,{logLevel:Wt.Warning,containsPii:!1,correlationId:t||S.EMPTY_STRING})},r.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:Wt.Warning,containsPii:!0,correlationId:t||S.EMPTY_STRING})},r.prototype.info=function(e,t){this.logMessage(e,{logLevel:Wt.Info,containsPii:!1,correlationId:t||S.EMPTY_STRING})},r.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:Wt.Info,containsPii:!0,correlationId:t||S.EMPTY_STRING})},r.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:Wt.Verbose,containsPii:!1,correlationId:t||S.EMPTY_STRING})},r.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:Wt.Verbose,containsPii:!0,correlationId:t||S.EMPTY_STRING})},r.prototype.trace=function(e,t){this.logMessage(e,{logLevel:Wt.Trace,containsPii:!1,correlationId:t||S.EMPTY_STRING})},r.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:Wt.Trace,containsPii:!0,correlationId:t||S.EMPTY_STRING})},r.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},r}();a();l();c();var ch="@azure/msal-common",ia="13.3.1";a();l();c();var Mi;(function(r){r[r.None=0]="None",r.AzurePublic="https://login.microsoftonline.com",r.AzurePpe="https://login.windows-ppe.net",r.AzureChina="https://login.chinacloudapi.cn",r.AzureGermany="https://login.microsoftonline.de",r.AzureUsGovernment="https://login.microsoftonline.us"})(Mi||(Mi={}));a();l();c();a();l();c();a();l();c();var Le={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"},authorityMismatch:{code:"authority_mismatch",desc:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."}},Ge=function(r){ot(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,e.prototype),i}return e.createRedirectUriEmptyError=function(){return new e(Le.redirectUriNotSet.code,Le.redirectUriNotSet.desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(Le.postLogoutUriNotSet.code,Le.postLogoutUriNotSet.desc)},e.createClaimsRequestParsingError=function(t){return new e(Le.claimsRequestParsingError.code,Le.claimsRequestParsingError.desc+" Given value: "+t)},e.createInsecureAuthorityUriError=function(t){return new e(Le.authorityUriInsecure.code,Le.authorityUriInsecure.desc+" Given URI: "+t)},e.createUrlParseError=function(t){return new e(Le.urlParseError.code,Le.urlParseError.desc+" Given Error: "+t)},e.createUrlEmptyError=function(){return new e(Le.urlEmptyError.code,Le.urlEmptyError.desc)},e.createEmptyScopesArrayError=function(){return new e(Le.emptyScopesError.code,""+Le.emptyScopesError.desc)},e.createClientIdSingleScopeError=function(t){return new e(Le.clientIdSingleScopeError.code,Le.clientIdSingleScopeError.desc+" Given Scopes: "+t)},e.createInvalidPromptError=function(t){return new e(Le.invalidPrompt.code,Le.invalidPrompt.desc+" Given value: "+t)},e.createInvalidClaimsRequestError=function(){return new e(Le.invalidClaimsRequest.code,Le.invalidClaimsRequest.desc)},e.createEmptyLogoutRequestError=function(){return new e(Le.logoutRequestEmptyError.code,Le.logoutRequestEmptyError.desc)},e.createEmptyTokenRequestError=function(){return new e(Le.tokenRequestEmptyError.code,Le.tokenRequestEmptyError.desc)},e.createInvalidCodeChallengeMethodError=function(){return new e(Le.invalidCodeChallengeMethod.code,Le.invalidCodeChallengeMethod.desc)},e.createInvalidCodeChallengeParamsError=function(){return new e(Le.invalidCodeChallengeParams.code,Le.invalidCodeChallengeParams.desc)},e.createInvalidCloudDiscoveryMetadataError=function(){return new e(Le.invalidCloudDiscoveryMetadata.code,Le.invalidCloudDiscoveryMetadata.desc)},e.createInvalidAuthorityMetadataError=function(){return new e(Le.invalidAuthorityMetadata.code,Le.invalidAuthorityMetadata.desc)},e.createUntrustedAuthorityError=function(){return new e(Le.untrustedAuthority.code,Le.untrustedAuthority.desc)},e.createInvalidAzureCloudInstanceError=function(){return new e(Le.invalidAzureCloudInstance.code,Le.invalidAzureCloudInstance.desc)},e.createMissingSshJwkError=function(){return new e(Le.missingSshJwk.code,Le.missingSshJwk.desc)},e.createMissingSshKidError=function(){return new e(Le.missingSshKid.code,Le.missingSshKid.desc)},e.createMissingNonceAuthenticationHeadersError=function(){return new e(Le.missingNonceAuthenticationHeader.code,Le.missingNonceAuthenticationHeader.desc)},e.createInvalidAuthenticationHeaderError=function(t,o){return new e(Le.invalidAuthenticationHeader.code,Le.invalidAuthenticationHeader.desc+". Invalid header: "+t+". Details: "+o)},e.createAuthorityMismatchError=function(){return new e(Le.authorityMismatch.code,Le.authorityMismatch.desc)},e}(L);var bt=function(){function r(e){var t=this,o=e?N.trimArrayEntries(jn(e)):[],i=o?N.removeEmptyStringsFromArray(o):[];this.validateInputScopes(i),this.scopes=new Set,i.forEach(function(n){return t.scopes.add(n)})}return r.fromString=function(e){var t=e||S.EMPTY_STRING,o=t.split(" ");return new r(o)},r.createSearchScopes=function(e){var t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(S.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t},r.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Ge.createEmptyScopesArrayError()},r.prototype.containsScope=function(e){var t=this.printScopesLowerCase().split(" "),o=new r(t);return N.isEmpty(e)?!1:o.scopes.has(e.toLowerCase())},r.prototype.containsScopeSet=function(e){var t=this;return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(function(o){return t.containsScope(o)})},r.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return lg.forEach(function(o){e.containsScope(o)&&(t+=1)}),this.scopes.size===t},r.prototype.appendScope=function(e){N.isEmpty(e)||this.scopes.add(e.trim())},r.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(o){return t.appendScope(o)})}catch(o){throw L.createAppendScopeSetError(o)}},r.prototype.removeScope=function(e){if(N.isEmpty(e))throw L.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},r.prototype.removeOIDCScopes=function(){var e=this;lg.forEach(function(t){e.scopes.delete(t)})},r.prototype.unionScopeSets=function(e){if(!e)throw L.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach(function(o){return t.add(o.toLowerCase())}),this.scopes.forEach(function(o){return t.add(o.toLowerCase())}),t},r.prototype.intersectingScopeSets=function(e){if(!e)throw L.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),o=e.getScopeCount(),i=this.getScopeCount(),n=t.size;return n<i+o},r.prototype.getScopeCount=function(){return this.scopes.size},r.prototype.asArray=function(){var e=[];return this.scopes.forEach(function(t){return e.push(t)}),e},r.prototype.printScopes=function(){if(this.scopes){var e=this.asArray();return e.join(" ")}return S.EMPTY_STRING},r.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},r}();a();l();c();a();l();c();function Yn(r,e){if(N.isEmpty(r))throw L.createClientInfoEmptyError();try{var t=e.base64Decode(r);return JSON.parse(t)}catch(o){throw L.createClientInfoDecodingError(o.message)}}function Fi(r){if(N.isEmpty(r))throw L.createClientInfoDecodingError("Home account ID was empty.");var e=r.split(It.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?S.EMPTY_STRING:e[1]}}a();l();c();var nr;(function(r){r[r.Default=0]="Default",r[r.Adfs=1]="Adfs",r[r.Dsts=2]="Dsts",r[r.Ciam=3]="Ciam"})(nr||(nr={}));var At=function(){function r(){}return r.prototype.generateAccountId=function(){var e=[this.homeAccountId,this.environment];return e.join(It.CACHE_KEY_SEPARATOR).toLowerCase()},r.prototype.generateAccountKey=function(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},r.prototype.generateType=function(){switch(this.authorityType){case mi.ADFS_ACCOUNT_TYPE:return Vo.ADFS;case mi.MSAV1_ACCOUNT_TYPE:return Vo.MSA;case mi.MSSTS_ACCOUNT_TYPE:return Vo.MSSTS;case mi.GENERIC_ACCOUNT_TYPE:return Vo.GENERIC;default:throw L.createUnexpectedAccountTypeError()}},r.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},r.generateAccountCacheKey=function(e){var t=[e.homeAccountId,e.environment||S.EMPTY_STRING,e.tenantId||S.EMPTY_STRING];return t.join(It.CACHE_KEY_SEPARATOR).toLowerCase()},r.createAccount=function(e,t,o,i,n,s,d,u){var h,p,v,C,x,E,O=new r;O.authorityType=mi.MSSTS_ACCOUNT_TYPE,O.clientInfo=e,O.homeAccountId=t,O.nativeAccountId=u;var q=d||i&&i.getPreferredCache();if(!q)throw L.createInvalidCacheEnvironmentError();if(O.environment=q,O.realm=((h=o?.claims)===null||h===void 0?void 0:h.tid)||S.EMPTY_STRING,o){O.idTokenClaims=o.claims,O.localAccountId=((p=o?.claims)===null||p===void 0?void 0:p.oid)||((v=o?.claims)===null||v===void 0?void 0:v.sub)||S.EMPTY_STRING;var _e=(C=o?.claims)===null||C===void 0?void 0:C.preferred_username,se=!((x=o?.claims)===null||x===void 0)&&x.emails?o.claims.emails[0]:null;O.username=_e||se||S.EMPTY_STRING,O.name=(E=o?.claims)===null||E===void 0?void 0:E.name}return O.cloudGraphHostName=n,O.msGraphHost=s,O},r.createGenericAccount=function(e,t,o,i,n,s){var d,u,h,p,v=new r;v.authorityType=o&&o.authorityType===nr.Adfs?mi.ADFS_ACCOUNT_TYPE:mi.GENERIC_ACCOUNT_TYPE,v.homeAccountId=e,v.realm=S.EMPTY_STRING;var C=s||o&&o.getPreferredCache();if(!C)throw L.createInvalidCacheEnvironmentError();return t&&(v.localAccountId=((d=t?.claims)===null||d===void 0?void 0:d.oid)||((u=t?.claims)===null||u===void 0?void 0:u.sub)||S.EMPTY_STRING,v.username=((h=t?.claims)===null||h===void 0?void 0:h.upn)||S.EMPTY_STRING,v.name=((p=t?.claims)===null||p===void 0?void 0:p.name)||S.EMPTY_STRING,v.idTokenClaims=t?.claims),v.environment=C,v.cloudGraphHostName=i,v.msGraphHost=n,v},r.generateHomeAccountId=function(e,t,o,i,n){var s,d=!((s=n?.claims)===null||s===void 0)&&s.sub?n.claims.sub:S.EMPTY_STRING;if(t===nr.Adfs||t===nr.Dsts)return d;if(e)try{var u=Yn(e,i);if(!N.isEmpty(u.uid)&&!N.isEmpty(u.utid))return""+u.uid+It.CLIENT_INFO_SEPARATOR+u.utid}catch{}return o.verbose("No client info in response"),d},r.isAccountEntity=function(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1},r.accountInfoIsEqual=function(e,t,o){if(!e||!t)return!1;var i=!0;if(o){var n=e.idTokenClaims||{},s=t.idTokenClaims||{};i=n.iat===s.iat&&n.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i},r}();a();l();c();var rr=function(){function r(e,t){if(N.isEmpty(e))throw L.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=r.extractTokenClaims(e,t)}return r.extractTokenClaims=function(e,t){var o=N.decodeAuthToken(e);try{var i=o.JWSPayload,n=t.base64Decode(i);return JSON.parse(n)}catch(s){throw L.createTokenParsingError(s)}},r.checkMaxAge=function(e,t){var o=3e5;if(t===0||Date.now()-o>e+t)throw L.createMaxAgeTranspiredError()},r}();var Or=function(){function r(e,t,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=o.clone(ch,ia)}return r.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var o=t.reduce(function(n,s){var d=e.getAccount(s);return d&&n.push(d),n},[]);if(o.length<1)return[];var i=o.map(function(n){return e.getAccountInfoFromEntity(n)});return i},r.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},r.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),o=this.getIdToken(t);return o&&(t.idToken=o.secret,t.idTokenClaims=new rr(o.secret,this.cryptoImpl).claims),t},r.prototype.saveCacheRecord=function(e){return oe(this,void 0,void 0,function(){return ie(this,function(t){switch(t.label){case 0:if(!e)throw L.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}})})},r.prototype.saveAccessToken=function(e){return oe(this,void 0,void 0,function(){var t,o,i,n,s=this;return ie(this,function(d){switch(d.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),i=bt.fromString(e.target),n=[],o.accessToken.forEach(function(u){if(s.accessTokenKeyMatchesFilter(u,t,!1)){var h=s.getAccessTokenCredential(u);if(h&&s.credentialMatchesFilter(h,t)){var p=bt.fromString(h.target);p.intersectingScopeSets(i)&&n.push(s.removeAccessToken(u))}}}),[4,Promise.all(n)];case 1:return d.sent(),this.setAccessTokenCredential(e),[2]}})})},r.prototype.getAccountsFilteredBy=function(e){var t=this,o=this.getAccountKeys(),i=[];return o.forEach(function(n){if(t.isAccountKey(n,e.homeAccountId,e.realm)){var s=t.getAccount(n);s&&(e.homeAccountId&&!t.matchHomeAccountId(s,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(s,e.localAccountId)||e.username&&!t.matchUsername(s,e.username)||e.environment&&!t.matchEnvironment(s,e.environment)||e.realm&&!t.matchRealm(s,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(s,e.nativeAccountId)||i.push(s))}}),i},r.prototype.isAccountKey=function(e,t,o){return!(e.split(It.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||o&&!e.toLowerCase().includes(o.toLowerCase()))},r.prototype.isCredentialKey=function(e){if(e.split(It.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(t.indexOf(ae.ID_TOKEN.toLowerCase())===-1&&t.indexOf(ae.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(ae.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(ae.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(ae.REFRESH_TOKEN.toLowerCase())>-1){var o=""+ae.REFRESH_TOKEN+It.CACHE_KEY_SEPARATOR+this.clientId+It.CACHE_KEY_SEPARATOR,i=""+ae.REFRESH_TOKEN+It.CACHE_KEY_SEPARATOR+Wn+It.CACHE_KEY_SEPARATOR;if(t.indexOf(o.toLowerCase())===-1&&t.indexOf(i.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0},r.prototype.credentialMatchesFilter=function(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===ae.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===Ne.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))},r.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},r.prototype.getAppMetadataFilteredByInternal=function(e,t){var o=this,i=this.getKeys(),n={};return i.forEach(function(s){if(o.isAppMetadata(s)){var d=o.getAppMetadata(s);d&&(e&&!o.matchEnvironment(d,e)||t&&!o.matchClientId(d,t)||(n[s]=d))}}),n},r.prototype.getAuthorityMetadataByAlias=function(e){var t=this,o=this.getAuthorityMetadataKeys(),i=null;return o.forEach(function(n){if(!(!t.isAuthorityMetadata(n)||n.indexOf(t.clientId)===-1)){var s=t.getAuthorityMetadata(n);s&&s.aliases.indexOf(e)!==-1&&(i=s)}}),i},r.prototype.removeAllAccounts=function(){return oe(this,void 0,void 0,function(){var e,t,o=this;return ie(this,function(i){switch(i.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach(function(n){t.push(o.removeAccount(n))}),[4,Promise.all(t)];case 1:return i.sent(),[2]}})})},r.prototype.removeAccount=function(e){return oe(this,void 0,void 0,function(){var t;return ie(this,function(o){switch(o.label){case 0:if(t=this.getAccount(e),!t)throw L.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return o.sent(),this.removeItem(e),[2]}})})},r.prototype.removeAccountContext=function(e){return oe(this,void 0,void 0,function(){var t,o,i,n=this;return ie(this,function(s){switch(s.label){case 0:return t=this.getTokenKeys(),o=e.generateAccountId(),i=[],t.idToken.forEach(function(d){d.indexOf(o)===0&&n.removeIdToken(d)}),t.accessToken.forEach(function(d){d.indexOf(o)===0&&i.push(n.removeAccessToken(d))}),t.refreshToken.forEach(function(d){d.indexOf(o)===0&&n.removeRefreshToken(d)}),[4,Promise.all(i)];case 1:return s.sent(),[2]}})})},r.prototype.removeAccessToken=function(e){return oe(this,void 0,void 0,function(){var t,o,i;return ie(this,function(n){switch(n.label){case 0:if(t=this.getAccessTokenCredential(e),!t)return[2];if(t.credentialType.toLowerCase()!==ae.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==Ne.POP)return[3,4];if(o=t,i=o.keyId,!i)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(i)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),L.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}})})},r.prototype.removeAppMetadata=function(){var e=this,t=this.getKeys();return t.forEach(function(o){e.isAppMetadata(o)&&e.removeItem(o)}),!0},r.prototype.readCacheRecord=function(e,t,o){var i=this.getTokenKeys(),n=this.readAccountFromCache(e),s=this.getIdToken(e,i),d=this.getAccessToken(e,t,i),u=this.getRefreshToken(e,!1,i),h=this.readAppMetadataFromCache(o);return n&&s&&(n.idTokenClaims=new rr(s.secret,this.cryptoImpl).claims),{account:n,idToken:s,accessToken:d,refreshToken:u,appMetadata:h}},r.prototype.readAccountFromCache=function(e){var t=At.generateAccountCacheKey(e);return this.getAccount(t)},r.prototype.getIdToken=function(e,t){var o=this;this.commonLogger.trace("CacheManager - getIdToken called");var i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ae.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},n=this.getIdTokensByFilter(i,t),s=n.length;return s<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):s>1?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),n.forEach(function(d){o.removeIdToken(d.generateCredentialKey())}),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),n[0])},r.prototype.getIdTokensByFilter=function(e,t){var o=this,i=t&&t.idToken||this.getTokenKeys().idToken,n=[];return i.forEach(function(s){if(o.idTokenKeyMatchesFilter(s,Xe({clientId:o.clientId},e))){var d=o.getIdTokenCredential(s);d&&o.credentialMatchesFilter(d,e)&&n.push(d)}}),n},r.prototype.idTokenKeyMatchesFilter=function(e,t){var o=e.toLowerCase();return!(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1)},r.prototype.removeIdToken=function(e){this.removeItem(e)},r.prototype.removeRefreshToken=function(e){this.removeItem(e)},r.prototype.getAccessToken=function(e,t,o){var i=this;this.commonLogger.trace("CacheManager - getAccessToken called");var n=bt.createSearchScopes(t.scopes),s=t.authenticationScheme||Ne.BEARER,d=s&&s.toLowerCase()!==Ne.BEARER.toLowerCase()?ae.ACCESS_TOKEN_WITH_AUTH_SCHEME:ae.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:d,clientId:this.clientId,realm:e.tenantId,target:n,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},h=o&&o.accessToken||this.getTokenKeys().accessToken,p=[];h.forEach(function(C){if(i.accessTokenKeyMatchesFilter(C,u,!0)){var x=i.getAccessTokenCredential(C);x&&i.credentialMatchesFilter(x,u)&&p.push(x)}});var v=p.length;return v<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):v>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),p.forEach(function(C){i.removeAccessToken(C.generateCredentialKey())}),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),p[0])},r.prototype.accessTokenKeyMatchesFilter=function(e,t,o){var i=e.toLowerCase();if(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&i.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&i.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target)for(var n=t.target.asArray(),s=0;s<n.length;s++){if(o&&!i.includes(n[s].toLowerCase()))return!1;if(!o&&i.includes(n[s].toLowerCase()))return!0}return!0},r.prototype.getAccessTokensByFilter=function(e){var t=this,o=this.getTokenKeys(),i=[];return o.accessToken.forEach(function(n){if(t.accessTokenKeyMatchesFilter(n,e,!0)){var s=t.getAccessTokenCredential(n);s&&t.credentialMatchesFilter(s,e)&&i.push(s)}}),i},r.prototype.getRefreshToken=function(e,t,o){var i=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var n=t?Wn:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ae.REFRESH_TOKEN,clientId:this.clientId,familyId:n},d=o&&o.refreshToken||this.getTokenKeys().refreshToken,u=[];d.forEach(function(p){if(i.refreshTokenKeyMatchesFilter(p,s)){var v=i.getRefreshTokenCredential(p);v&&i.credentialMatchesFilter(v,s)&&u.push(v)}});var h=u.length;return h<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),u[0])},r.prototype.refreshTokenKeyMatchesFilter=function(e,t){var o=e.toLowerCase();return!(t.familyId&&o.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1)},r.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},o=this.getAppMetadataFilteredBy(t),i=Object.keys(o).map(function(s){return o[s]}),n=i.length;if(n<1)return null;if(n>1)throw L.createMultipleMatchingAppMetadataInCacheError();return i[0]},r.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Wn)},r.prototype.matchHomeAccountId=function(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId},r.prototype.matchLocalAccountId=function(e,t){return typeof e.localAccountId=="string"&&t===e.localAccountId},r.prototype.matchUsername=function(e,t){return typeof e.username=="string"&&t.toLowerCase()===e.username.toLowerCase()},r.prototype.matchUserAssertionHash=function(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)},r.prototype.matchEnvironment=function(e,t){var o=this.getAuthorityMetadataByAlias(t);return!!(o&&o.aliases.indexOf(e.environment)>-1)},r.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},r.prototype.matchClientId=function(e,t){return!!(e.clientId&&t===e.clientId)},r.prototype.matchFamilyId=function(e,t){return!!(e.familyId&&t===e.familyId)},r.prototype.matchRealm=function(e,t){return!!(e.realm&&t===e.realm)},r.prototype.matchNativeAccountId=function(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)},r.prototype.matchTarget=function(e,t){var o=e.credentialType!==ae.ACCESS_TOKEN&&e.credentialType!==ae.ACCESS_TOKEN_WITH_AUTH_SCHEME;if(o||!e.target)return!1;var i=bt.fromString(e.target);return i.containsScopeSet(t)},r.prototype.matchTokenType=function(e,t){return!!(e.tokenType&&e.tokenType===t)},r.prototype.matchKeyId=function(e,t){return!!(e.keyId&&e.keyId===t)},r.prototype.isAppMetadata=function(e){return e.indexOf(Nc)!==-1},r.prototype.isAuthorityMetadata=function(e){return e.indexOf(oa.CACHE_KEY)!==-1},r.prototype.generateAuthorityMetadataCacheKey=function(e){return oa.CACHE_KEY+"-"+this.clientId+"-"+e},r.toObject=function(e,t){for(var o in t)e[o]=t[o];return e},r}(),cg=function(r){ot(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setAccount=function(){var t="Storage interface - setAccount() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getAccount=function(){var t="Storage interface - getAccount() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.setIdTokenCredential=function(){var t="Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getIdTokenCredential=function(){var t="Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.setAccessTokenCredential=function(){var t="Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getAccessTokenCredential=function(){var t="Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.setRefreshTokenCredential=function(){var t="Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getRefreshTokenCredential=function(){var t="Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.setAppMetadata=function(){var t="Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getAppMetadata=function(){var t="Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.setServerTelemetry=function(){var t="Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getServerTelemetry=function(){var t="Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.setAuthorityMetadata=function(){var t="Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getAuthorityMetadata=function(){var t="Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getAuthorityMetadataKeys=function(){var t="Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.setThrottlingCache=function(){var t="Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getThrottlingCache=function(){var t="Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.removeItem=function(){var t="Storage interface - removeItem() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.containsKey=function(){var t="Storage interface - containsKey() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getKeys=function(){var t="Storage interface - getKeys() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getAccountKeys=function(){var t="Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.getTokenKeys=function(){var t="Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e.prototype.clear=function(){return oe(this,void 0,void 0,function(){var t;return ie(this,function(o){throw t="Storage interface - clear() has not been implemented for the cacheStorage interface.",Y.createUnexpectedError(t)})})},e.prototype.updateCredentialCacheKey=function(){var t="Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.";throw Y.createUnexpectedError(t)},e}(Or);var v3=300,dh={tokenRenewalOffsetSeconds:v3,preventCorsPreflight:!1},y3={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Wt.Info,correlationId:S.EMPTY_STRING},b3={claimsBasedCachingEnabled:!0},C3={sendGetRequestAsync:function(){return oe(this,void 0,void 0,function(){var r;return ie(this,function(e){throw r="Network interface - sendGetRequestAsync() has not been implemented",Y.createUnexpectedError(r)})})},sendPostRequestAsync:function(){return oe(this,void 0,void 0,function(){var r;return ie(this,function(e){throw r="Network interface - sendPostRequestAsync() has not been implemented",Y.createUnexpectedError(r)})})}},w3={sku:S.SKU,version:ia,cpu:S.EMPTY_STRING,os:S.EMPTY_STRING},x3={clientSecret:S.EMPTY_STRING,clientAssertion:void 0},S3={azureCloudInstance:Mi.None,tenant:""+S.DEFAULT_COMMON_TENANT},_3={application:{appName:"",appVersion:""}};function sw(r){var e=r.authOptions,t=r.systemOptions,o=r.loggerOptions,i=r.cacheOptions,n=r.storageInterface,s=r.networkInterface,d=r.cryptoInterface,u=r.clientCredentials,h=r.libraryInfo,p=r.telemetry,v=r.serverTelemetryManager,C=r.persistencePlugin,x=r.serializableCache,E=Xe(Xe({},y3),o);return{authOptions:E3(e),systemOptions:Xe(Xe({},dh),t),loggerOptions:E,cacheOptions:Xe(Xe({},b3),i),storageInterface:n||new cg(e.clientId,Qn,new $i(E)),networkInterface:s||C3,cryptoInterface:d||Qn,clientCredentials:u||x3,libraryInfo:Xe(Xe({},w3),h),telemetry:Xe(Xe({},_3),p),serverTelemetryManager:v||null,persistencePlugin:C||null,serializableCache:x||null}}function E3(r){return Xe({clientCapabilities:[],azureCloudOptions:S3,skipAuthorityMetadataCache:!1},r)}a();l();c();a();l();c();a();l();c();var $r=function(r){ot(e,r);function e(t,o,i){var n=r.call(this,t,o,i)||this;return n.name="ServerError",Object.setPrototypeOf(n,e.prototype),n}return e}(Y);var Zn=function(){function r(){}return r.generateThrottlingStorageKey=function(e){return fn.THROTTLING_PREFIX+"."+JSON.stringify(e)},r.preProcess=function(e,t){var o,i=r.generateThrottlingStorageKey(t),n=e.getThrottlingCache(i);if(n){if(n.throttleTime<Date.now()){e.removeItem(i);return}throw new $r(((o=n.errorCodes)===null||o===void 0?void 0:o.join(" "))||S.EMPTY_STRING,n.errorMessage,n.subError)}},r.postProcess=function(e,t,o){if(r.checkResponseStatus(o)||r.checkResponseForRetryAfter(o)){var i={throttleTime:r.calculateThrottleTime(parseInt(o.headers[kt.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),i)}},r.checkResponseStatus=function(e){return e.status===429||e.status>=500&&e.status<600},r.checkResponseForRetryAfter=function(e){return e.headers?e.headers.hasOwnProperty(kt.RETRY_AFTER)&&(e.status<200||e.status>=300):!1},r.calculateThrottleTime=function(e){var t=e<=0?0:e,o=Date.now()/1e3;return Math.floor(Math.min(o+(t||fn.DEFAULT_THROTTLE_TIME_SECONDS),o+fn.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)},r.removeThrottle=function(e,t,o,i){var n={clientId:t,authority:o.authority,scopes:o.scopes,homeAccountIdentifier:i,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},s=this.generateThrottlingStorageKey(n);e.removeItem(s)},r}();var dg=function(){function r(e,t){this.networkClient=e,this.cacheManager=t}return r.prototype.sendPostRequest=function(e,t,o){return oe(this,void 0,void 0,function(){var i,n;return ie(this,function(s){switch(s.label){case 0:Zn.preProcess(this.cacheManager,e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,o)];case 2:return i=s.sent(),[3,4];case 3:throw n=s.sent(),n instanceof Y?n:L.createNetworkError(t,n);case 4:return Zn.postProcess(this.cacheManager,e,i),[2,i]}})})},r}();a();l();c();var sr;(function(r){r.HOME_ACCOUNT_ID="home_account_id",r.UPN="UPN"})(sr||(sr={}));a();l();c();a();l();c();var mn=function(){function r(){}return r.validateRedirectUri=function(e){if(N.isEmpty(e))throw Ge.createRedirectUriEmptyError()},r.validatePrompt=function(e){var t=[];for(var o in Kt)t.push(Kt[o]);if(t.indexOf(e)<0)throw Ge.createInvalidPromptError(e)},r.validateClaims=function(e){try{JSON.parse(e)}catch{throw Ge.createInvalidClaimsRequestError()}},r.validateCodeChallengeParams=function(e,t){if(N.isEmpty(e)||N.isEmpty(t))throw Ge.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},r.validateCodeChallengeMethod=function(e){if([ah.PLAIN,ah.S256].indexOf(e)<0)throw Ge.createInvalidCodeChallengeMethodError()},r.sanitizeEQParams=function(e,t){return e?(t.forEach(function(o,i){e[i]&&delete e[i]}),Object.fromEntries(Object.entries(e).filter(function(o){var i=o[1];return i!==""}))):{}},r}();var wr=function(){function r(){this.parameters=new Map}return r.prototype.addResponseTypeCode=function(){this.parameters.set(Fe.RESPONSE_TYPE,encodeURIComponent(S.CODE_RESPONSE_TYPE))},r.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(Fe.RESPONSE_TYPE,encodeURIComponent(S.TOKEN_RESPONSE_TYPE+" "+S.ID_TOKEN_RESPONSE_TYPE))},r.prototype.addResponseMode=function(e){this.parameters.set(Fe.RESPONSE_MODE,encodeURIComponent(e||ta.QUERY))},r.prototype.addNativeBroker=function(){this.parameters.set(Fe.NATIVE_BROKER,encodeURIComponent("1"))},r.prototype.addScopes=function(e,t){t===void 0&&(t=!0);var o=t?jn(e||[],gi):e||[],i=new bt(o);this.parameters.set(Fe.SCOPE,encodeURIComponent(i.printScopes()))},r.prototype.addClientId=function(e){this.parameters.set(Fe.CLIENT_ID,encodeURIComponent(e))},r.prototype.addRedirectUri=function(e){mn.validateRedirectUri(e),this.parameters.set(Fe.REDIRECT_URI,encodeURIComponent(e))},r.prototype.addPostLogoutRedirectUri=function(e){mn.validateRedirectUri(e),this.parameters.set(Fe.POST_LOGOUT_URI,encodeURIComponent(e))},r.prototype.addIdTokenHint=function(e){this.parameters.set(Fe.ID_TOKEN_HINT,encodeURIComponent(e))},r.prototype.addDomainHint=function(e){this.parameters.set(ea.DOMAIN_HINT,encodeURIComponent(e))},r.prototype.addLoginHint=function(e){this.parameters.set(ea.LOGIN_HINT,encodeURIComponent(e))},r.prototype.addCcsUpn=function(e){this.parameters.set(kt.CCS_HEADER,encodeURIComponent("UPN:"+e))},r.prototype.addCcsOid=function(e){this.parameters.set(kt.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},r.prototype.addSid=function(e){this.parameters.set(ea.SID,encodeURIComponent(e))},r.prototype.addClaims=function(e,t){var o=this.addClientCapabilitiesToClaims(e,t);mn.validateClaims(o),this.parameters.set(Fe.CLAIMS,encodeURIComponent(o))},r.prototype.addCorrelationId=function(e){this.parameters.set(Fe.CLIENT_REQUEST_ID,encodeURIComponent(e))},r.prototype.addLibraryInfo=function(e){this.parameters.set(Fe.X_CLIENT_SKU,e.sku),this.parameters.set(Fe.X_CLIENT_VER,e.version),e.os&&this.parameters.set(Fe.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(Fe.X_CLIENT_CPU,e.cpu)},r.prototype.addApplicationTelemetry=function(e){e?.appName&&this.parameters.set(Fe.X_APP_NAME,e.appName),e?.appVersion&&this.parameters.set(Fe.X_APP_VER,e.appVersion)},r.prototype.addPrompt=function(e){mn.validatePrompt(e),this.parameters.set(""+Fe.PROMPT,encodeURIComponent(e))},r.prototype.addState=function(e){N.isEmpty(e)||this.parameters.set(Fe.STATE,encodeURIComponent(e))},r.prototype.addNonce=function(e){this.parameters.set(Fe.NONCE,encodeURIComponent(e))},r.prototype.addCodeChallengeParams=function(e,t){if(mn.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(Fe.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(Fe.CODE_CHALLENGE_METHOD,encodeURIComponent(t));else throw Ge.createInvalidCodeChallengeParamsError()},r.prototype.addAuthorizationCode=function(e){this.parameters.set(Fe.CODE,encodeURIComponent(e))},r.prototype.addDeviceCode=function(e){this.parameters.set(Fe.DEVICE_CODE,encodeURIComponent(e))},r.prototype.addRefreshToken=function(e){this.parameters.set(Fe.REFRESH_TOKEN,encodeURIComponent(e))},r.prototype.addCodeVerifier=function(e){this.parameters.set(Fe.CODE_VERIFIER,encodeURIComponent(e))},r.prototype.addClientSecret=function(e){this.parameters.set(Fe.CLIENT_SECRET,encodeURIComponent(e))},r.prototype.addClientAssertion=function(e){N.isEmpty(e)||this.parameters.set(Fe.CLIENT_ASSERTION,encodeURIComponent(e))},r.prototype.addClientAssertionType=function(e){N.isEmpty(e)||this.parameters.set(Fe.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},r.prototype.addOboAssertion=function(e){this.parameters.set(Fe.OBO_ASSERTION,encodeURIComponent(e))},r.prototype.addRequestTokenUse=function(e){this.parameters.set(Fe.REQUESTED_TOKEN_USE,encodeURIComponent(e))},r.prototype.addGrantType=function(e){this.parameters.set(Fe.GRANT_TYPE,encodeURIComponent(e))},r.prototype.addClientInfo=function(){this.parameters.set(nw,"1")},r.prototype.addExtraQueryParameters=function(e){var t=this,o=mn.sanitizeEQParams(e,this.parameters);Object.keys(o).forEach(function(i){t.parameters.set(i,e[i])})},r.prototype.addClientCapabilitiesToClaims=function(e,t){var o;if(!e)o={};else try{o=JSON.parse(e)}catch{throw Ge.createInvalidClaimsRequestError()}return t&&t.length>0&&(o.hasOwnProperty(Kn.ACCESS_TOKEN)||(o[Kn.ACCESS_TOKEN]={}),o[Kn.ACCESS_TOKEN][Kn.XMS_CC]={values:t}),JSON.stringify(o)},r.prototype.addUsername=function(e){this.parameters.set(ll.username,encodeURIComponent(e))},r.prototype.addPassword=function(e){this.parameters.set(ll.password,encodeURIComponent(e))},r.prototype.addPopToken=function(e){N.isEmpty(e)||(this.parameters.set(Fe.TOKEN_TYPE,Ne.POP),this.parameters.set(Fe.REQ_CNF,encodeURIComponent(e)))},r.prototype.addSshJwk=function(e){N.isEmpty(e)||(this.parameters.set(Fe.TOKEN_TYPE,Ne.SSH),this.parameters.set(Fe.REQ_CNF,encodeURIComponent(e)))},r.prototype.addServerTelemetry=function(e){this.parameters.set(Fe.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(Fe.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},r.prototype.addThrottling=function(){this.parameters.set(Fe.X_MS_LIB_CAPABILITY,fn.X_MS_LIB_CAPABILITY_VALUE)},r.prototype.addLogoutHint=function(e){this.parameters.set(Fe.LOGOUT_HINT,encodeURIComponent(e))},r.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach(function(t,o){e.push(o+"="+t)}),e.join("&")},r}();var vo=function(){function r(e,t){this.config=sw(e),this.logger=new $i(this.config.loggerOptions,ch,ia),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new dg(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return r.prototype.createTokenRequestHeaders=function(e){var t={};if(t[kt.CONTENT_TYPE]=S.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case sr.HOME_ACCOUNT_ID:try{var o=Fi(e.credential);t[kt.CCS_HEADER]="Oid:"+o.uid+"@"+o.utid}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case sr.UPN:t[kt.CCS_HEADER]="UPN: "+e.credential;break}return t},r.prototype.executePostToTokenEndpoint=function(e,t,o,i){return oe(this,void 0,void 0,function(){var n;return ie(this,function(s){switch(s.label){case 0:return[4,this.networkManager.sendPostRequest(i,e,{body:t,headers:o})];case 1:return n=s.sent(),this.config.serverTelemetryManager&&n.status<500&&n.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,n]}})})},r.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw L.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},r.prototype.createTokenQueryParameters=function(e){var t=new wr;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},r}();a();l();c();a();l();c();a();l();c();var na=function(){function r(){}return r.prototype.generateAccountId=function(){return r.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},r.prototype.generateCredentialId=function(){return r.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},r.prototype.generateTarget=function(){return r.generateTargetForCacheKey(this.target)},r.prototype.generateCredentialKey=function(){return r.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},r.prototype.generateType=function(){switch(this.credentialType){case ae.ID_TOKEN:return Vo.ID_TOKEN;case ae.ACCESS_TOKEN:case ae.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Vo.ACCESS_TOKEN;case ae.REFRESH_TOKEN:return Vo.REFRESH_TOKEN;default:throw L.createUnexpectedCredentialTypeError()}},r.generateCredentialCacheKey=function(e,t,o,i,n,s,d,u,h){var p=[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(o,i,n,d),this.generateTargetForCacheKey(s),this.generateClaimsHashForCacheKey(h),this.generateSchemeForCacheKey(u)];return p.join(It.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateAccountIdForCacheKey=function(e,t){var o=[e,t];return o.join(It.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateCredentialIdForCacheKey=function(e,t,o,i){var n=e===ae.REFRESH_TOKEN&&i||t,s=[e,n,o||S.EMPTY_STRING];return s.join(It.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateTargetForCacheKey=function(e){return(e||S.EMPTY_STRING).toLowerCase()},r.generateClaimsHashForCacheKey=function(e){return(e||S.EMPTY_STRING).toLowerCase()},r.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==Ne.BEARER.toLowerCase()?e.toLowerCase():S.EMPTY_STRING},r}();var zo=function(r){ot(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createIdTokenEntity=function(t,o,i,n,s){var d=new e;return d.credentialType=ae.ID_TOKEN,d.homeAccountId=t,d.environment=o,d.clientId=n,d.secret=i,d.realm=s,d},e.isIdTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===ae.ID_TOKEN:!1},e}(na);a();l();c();a();l();c();var it=function(){function r(){}return r.nowSeconds=function(){return Math.round(new Date().getTime()/1e3)},r.isTokenExpired=function(e,t){var o=Number(e)||0,i=r.nowSeconds()+t;return i>o},r.wasClockTurnedBack=function(e){var t=Number(e);return t>r.nowSeconds()},r.delay=function(e,t){return new Promise(function(o){return setTimeout(function(){return o(t)},e)})},r}();var qo=function(r){ot(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createAccessTokenEntity=function(t,o,i,n,s,d,u,h,p,v,C,x,E,O,q){var _e,se,ke=new e;ke.homeAccountId=t,ke.credentialType=ae.ACCESS_TOKEN,ke.secret=i;var Tt=it.nowSeconds();if(ke.cachedAt=Tt.toString(),ke.expiresOn=u.toString(),ke.extendedExpiresOn=h.toString(),v&&(ke.refreshOn=v.toString()),ke.environment=o,ke.clientId=n,ke.realm=s,ke.target=d,ke.userAssertionHash=x,ke.tokenType=N.isEmpty(C)?Ne.BEARER:C,O&&(ke.requestedClaims=O,ke.requestedClaimsHash=q),((_e=ke.tokenType)===null||_e===void 0?void 0:_e.toLowerCase())!==Ne.BEARER.toLowerCase())switch(ke.credentialType=ae.ACCESS_TOKEN_WITH_AUTH_SCHEME,ke.tokenType){case Ne.POP:var Gt=rr.extractTokenClaims(i,p);if(!(!((se=Gt?.cnf)===null||se===void 0)&&se.kid))throw L.createTokenClaimsRequiredError();ke.keyId=Gt.cnf.kid;break;case Ne.SSH:ke.keyId=E}return ke},e.isAccessTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===ae.ACCESS_TOKEN||t.credentialType===ae.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1},e}(na);a();l();c();var Di=function(r){ot(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createRefreshTokenEntity=function(t,o,i,n,s,d){var u=new e;return u.clientId=n,u.credentialType=ae.REFRESH_TOKEN,u.environment=o,u.homeAccountId=t,u.secret=i,u.userAssertionHash=d,s&&(u.familyId=s),u},e.isRefreshTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===ae.REFRESH_TOKEN:!1},e}(na);a();l();c();var aw=["interaction_required","consent_required","login_required"],T3=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Li={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}},ar=function(r){ot(e,r);function e(t,o,i,n,s,d,u){var h=r.call(this,t,o,i)||this;return Object.setPrototypeOf(h,e.prototype),h.timestamp=n||S.EMPTY_STRING,h.traceId=s||S.EMPTY_STRING,h.correlationId=d||S.EMPTY_STRING,h.claims=u||S.EMPTY_STRING,h.name="InteractionRequiredAuthError",h}return e.isInteractionRequiredError=function(t,o,i){var n=!!t&&aw.indexOf(t)>-1,s=!!i&&T3.indexOf(i)>-1,d=!!o&&aw.some(function(u){return o.indexOf(u)>-1});return n||d||s},e.createNoTokensFoundError=function(){return new e(Li.noTokensFoundError.code,Li.noTokensFoundError.desc)},e.createNativeAccountUnavailableError=function(){return new e(Li.native_account_unavailable.code,Li.native_account_unavailable.desc)},e}(Y);a();l();c();var gn=function(){function r(e,t,o,i,n){this.account=e||null,this.idToken=t||null,this.accessToken=o||null,this.refreshToken=i||null,this.appMetadata=n||null}return r}();a();l();c();var Mr=function(){function r(){}return r.setRequestState=function(e,t,o){var i=r.generateLibraryState(e,o);return N.isEmpty(t)?i:""+i+S.RESOURCE_DELIM+t},r.generateLibraryState=function(e,t){if(!e)throw L.createNoCryptoObjectError("generateLibraryState");var o={id:e.createNewGuid()};t&&(o.meta=t);var i=JSON.stringify(o);return e.base64Encode(i)},r.parseRequestState=function(e,t){if(!e)throw L.createNoCryptoObjectError("parseRequestState");if(N.isEmpty(t))throw L.createInvalidStateError(t,"Null, undefined or empty state");try{var o=t.split(S.RESOURCE_DELIM),i=o[0],n=o.length>1?o.slice(1).join(S.RESOURCE_DELIM):S.EMPTY_STRING,s=e.base64Decode(i),d=JSON.parse(s);return{userRequestState:N.isEmpty(n)?S.EMPTY_STRING:n,libraryState:d}}catch(u){throw L.createInvalidStateError(t,u)}},r}();a();l();c();a();l();c();var ge=function(){function r(e){if(this._urlString=e,N.isEmpty(this._urlString))throw Ge.createUrlEmptyError();N.isEmpty(this.getHash())&&(this._urlString=r.canonicalizeUri(e))}return Object.defineProperty(r.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),r.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return N.endsWith(t,"?")?t=t.slice(0,-1):N.endsWith(t,"?/")&&(t=t.slice(0,-2)),N.endsWith(t,"/")||(t+="/"),t}return e},r.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw Ge.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw Ge.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Ge.createInsecureAuthorityUriError(this.urlString)},r.appendQueryString=function(e,t){return N.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},r.removeHashFromUrl=function(e){return r.canonicalizeUri(e.split("#")[0])},r.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),o=t.PathSegments;return e&&o.length!==0&&(o[0]===hn.COMMON||o[0]===hn.ORGANIZATIONS)&&(o[0]=e),r.constructAuthorityUriFromObject(t)},r.prototype.getHash=function(){return r.parseHash(this.urlString)},r.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Ge.createUrlParseError("Given url string: "+this.urlString);var o={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},i=o.AbsolutePath.split("/");return i=i.filter(function(n){return n&&n.length>0}),o.PathSegments=i,!N.isEmpty(o.QueryString)&&o.QueryString.endsWith("/")&&(o.QueryString=o.QueryString.substring(0,o.QueryString.length-1)),o},r.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),o=e.match(t);if(!o)throw Ge.createUrlParseError("Given url string: "+e);return o[2]},r.getAbsoluteUrl=function(e,t){if(e[0]===S.FORWARD_SLASH){var o=new r(t),i=o.getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e},r.parseHash=function(e){var t=e.indexOf("#"),o=e.indexOf("#/");return o>-1?e.substring(o+2):t>-1?e.substring(t+1):S.EMPTY_STRING},r.parseQueryString=function(e){var t=e.indexOf("?"),o=e.indexOf("/?");return o>-1?e.substring(o+2):t>-1?e.substring(t+1):S.EMPTY_STRING},r.constructAuthorityUriFromObject=function(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},r.getDeserializedHash=function(e){if(N.isEmpty(e))return{};var t=r.parseHash(e),o=N.queryStringToObject(N.isEmpty(t)?e:t);if(!o)throw L.createHashNotDeserializedError(JSON.stringify(o));return o},r.getDeserializedQueryString=function(e){if(N.isEmpty(e))return{};var t=r.parseQueryString(e),o=N.queryStringToObject(N.isEmpty(t)?e:t);if(!o)throw L.createHashNotDeserializedError(JSON.stringify(o));return o},r.hashContainsKnownProperties=function(e){if(N.isEmpty(e)||e.indexOf("=")<0)return!1;var t=r.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},r}();a();l();c();var A;(function(r){r.AcquireTokenByCode="acquireTokenByCode",r.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",r.AcquireTokenSilent="acquireTokenSilent",r.AcquireTokenSilentAsync="acquireTokenSilentAsync",r.AcquireTokenPopup="acquireTokenPopup",r.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",r.CryptoOptsSignJwt="cryptoOptsSignJwt",r.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",r.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",r.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",r.SsoSilent="ssoSilent",r.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",r.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",r.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",r.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",r.BrokerHandhshake="brokerHandshake",r.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",r.AcquireTokenByBroker="acquireTokenByBroker",r.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",r.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",r.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",r.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",r.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",r.AcquireTokenFromCache="acquireTokenFromCache",r.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",r.InitializeBaseRequest="initializeBaseRequest",r.InitializeSilentRequest="initializeSilentRequest",r.InitializeClientApplication="initializeClientApplication",r.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",r.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",r.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",r.SilentHandlerLoadFrame="silentHandlerLoadFrame",r.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",r.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",r.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",r.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",r.GetAuthCodeUrl="getAuthCodeUrl",r.HandleCodeResponseFromServer="handleCodeResponseFromServer",r.HandleCodeResponseFromHash="handleCodeResponseFromHash",r.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",r.AuthClientAcquireToken="authClientAcquireToken",r.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",r.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",r.AuthClientCreateQueryString="authClientCreateQueryString",r.PopTokenGenerateCnf="popTokenGenerateCnf",r.PopTokenGenerateKid="popTokenGenerateKid",r.HandleServerTokenResponse="handleServerTokenResponse",r.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",r.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",r.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",r.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",r.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",r.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",r.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",r.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",r.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",r.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",r.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",r.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",r.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",r.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",r.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",r.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",r.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake",r.ClearTokensAndKeysWithClaims="clearTokensAndKeysWithClaims"})(A||(A={}));var ul;(function(r){r[r.NotStarted=0]="NotStarted",r[r.InProgress=1]="InProgress",r[r.Completed=2]="Completed"})(ul||(ul={}));var ug=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);var hg;(function(r){r.SW="sw",r.UHW="uhw"})(hg||(hg={}));var Po=function(){function r(e,t){this.cryptoUtils=e,this.performanceClient=t}return r.prototype.generateCnf=function(e){var t,o;return oe(this,void 0,void 0,function(){var i,n,s;return ie(this,function(d){switch(d.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement(A.PopTokenGenerateCnf,e.correlationId),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime(A.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return i=d.sent(),n=this.cryptoUtils.base64Encode(JSON.stringify(i)),s={kid:i.kid,reqCnfString:n},[4,this.cryptoUtils.hashString(n)];case 2:return[2,(s.reqCnfHash=d.sent(),s)]}})})},r.prototype.generateKid=function(e){var t;return oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement(A.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return o=i.sent(),[2,{kid:o,xms_ksl:hg.SW}]}})})},r.prototype.signPopToken=function(e,t,o){return oe(this,void 0,void 0,function(){return ie(this,function(i){return[2,this.signPayload(e,t,o)]})})},r.prototype.signPayload=function(e,t,o,i){return oe(this,void 0,void 0,function(){var n,s,d,u,h,p;return ie(this,function(v){switch(v.label){case 0:return n=o.resourceRequestMethod,s=o.resourceRequestUri,d=o.shrClaims,u=o.shrNonce,h=s?new ge(s):void 0,p=h?.getUrlComponents(),[4,this.cryptoUtils.signJwt(Xe({at:e,ts:it.nowSeconds(),m:n?.toUpperCase(),u:p?.HostNameAndPort,nonce:u||this.cryptoUtils.createNewGuid(),p:p?.AbsolutePath,q:p?.QueryString?[[],p.QueryString]:void 0,client_claims:d||void 0},i),t,o.correlationId)];case 1:return[2,v.sent()]}})})},r}();a();l();c();var hl=function(){function r(){}return r.prototype.generateAppMetadataKey=function(){return r.generateAppMetadataCacheKey(this.environment,this.clientId)},r.generateAppMetadataCacheKey=function(e,t){var o=[Nc,e,t];return o.join(It.CACHE_KEY_SEPARATOR).toLowerCase()},r.createAppMetadataEntity=function(e,t,o){var i=new r;return i.clientId=e,i.environment=t,o&&(i.familyId=o),i},r.isAppMetadataEntity=function(e,t){return t?e.indexOf(Nc)===0&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"):!1},r}();a();l();c();var pg=function(){function r(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(r.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),r}();var Fr=function(){function r(e,t,o,i,n,s,d){this.clientId=e,this.cacheStorage=t,this.cryptoObj=o,this.logger=i,this.serializableCache=n,this.persistencePlugin=s,this.performanceClient=d}return r.prototype.validateServerAuthorizationCodeResponse=function(e,t,o){if(!e.state||!t)throw e.state?L.createStateNotFoundError("Cached State"):L.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw L.createStateMismatchError();if(e.error||e.error_description||e.suberror)throw ar.isInteractionRequiredError(e.error,e.error_description,e.suberror)?new ar(e.error||S.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||S.EMPTY_STRING,e.trace_id||S.EMPTY_STRING,e.correlation_id||S.EMPTY_STRING,e.claims||S.EMPTY_STRING):new $r(e.error||S.EMPTY_STRING,e.error_description,e.suberror);e.client_info&&Yn(e.client_info,o)},r.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(ar.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new ar(e.error,e.error_description,e.suberror,e.timestamp||S.EMPTY_STRING,e.trace_id||S.EMPTY_STRING,e.correlation_id||S.EMPTY_STRING,e.claims||S.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new $r(e.error,t,e.suberror)}},r.prototype.handleServerTokenResponse=function(e,t,o,i,n,s,d,u,h){var p;return oe(this,void 0,void 0,function(){var v,C,x,E,O,q,_e;return ie(this,function(se){switch(se.label){case 0:if((p=this.performanceClient)===null||p===void 0||p.addQueueMeasurement(A.HandleServerTokenResponse,e.correlation_id),e.id_token){if(v=new rr(e.id_token||S.EMPTY_STRING,this.cryptoObj),n&&!N.isEmpty(n.nonce)&&v.claims.nonce!==n.nonce)throw L.createNonceMismatchError();if(i.maxAge||i.maxAge===0){if(C=v.claims.auth_time,!C)throw L.createAuthTimeNotFoundError();rr.checkMaxAge(C,i.maxAge)}}this.homeAccountIdentifier=At.generateHomeAccountId(e.client_info||S.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,v),n&&n.state&&(x=Mr.parseRequestState(this.cryptoObj,n.state)),e.key_id=e.key_id||i.sshKid||void 0,E=this.generateCacheRecord(e,t,o,i,v,s,n),se.label=1;case 1:return se.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),O=new pg(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(O)]):[3,3];case 2:se.sent(),se.label=3;case 3:return d&&!u&&E.account&&(q=E.account.generateAccountKey(),_e=this.cacheStorage.getAccount(q),!_e)?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,r.generateAuthenticationResult(this.cryptoObj,t,E,!1,i,v,x,void 0,h)]):[4,this.cacheStorage.saveCacheRecord(E)];case 4:return se.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&O?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(O)]):[3,7];case 6:se.sent(),se.label=7;case 7:return[7];case 8:return[2,r.generateAuthenticationResult(this.cryptoObj,t,E,!1,i,v,x,e,h)]}})})},r.prototype.generateCacheRecord=function(e,t,o,i,n,s,d){var u=t.getPreferredCache();if(N.isEmpty(u))throw L.createInvalidCacheEnvironmentError();var h,p;!N.isEmpty(e.id_token)&&n&&(h=zo.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||S.EMPTY_STRING,this.clientId,n.claims.tid||S.EMPTY_STRING),p=this.generateAccountEntity(e,n,t,d));var v=null;if(!N.isEmpty(e.access_token)){var C=e.scope?bt.fromString(e.scope):new bt(i.scopes||[]),x=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,E=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,O=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,q=o+x,_e=q+E,se=O&&O>0?o+O:void 0;v=qo.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||S.EMPTY_STRING,this.clientId,n?n.claims.tid||S.EMPTY_STRING:t.tenant,C.printScopes(),q,_e,this.cryptoObj,se,e.token_type,s,e.key_id,i.claims,i.requestedClaimsHash)}var ke=null;N.isEmpty(e.refresh_token)||(ke=Di.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||S.EMPTY_STRING,this.clientId,e.foci,s));var Tt=null;return N.isEmpty(e.foci)||(Tt=hl.createAppMetadataEntity(this.clientId,u,e.foci)),new gn(p,h,v,ke,Tt)},r.prototype.generateAccountEntity=function(e,t,o,i){var n=o.authorityType,s=i?i.cloud_graph_host_name:S.EMPTY_STRING,d=i?i.msgraph_host:S.EMPTY_STRING;if(n===nr.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),At.createGenericAccount(this.homeAccountIdentifier,t,o,s,d);if(N.isEmpty(e.client_info)&&o.protocolMode==="AAD")throw L.createClientInfoEmptyError();return e.client_info?At.createAccount(e.client_info,this.homeAccountIdentifier,t,o,s,d):At.createGenericAccount(this.homeAccountIdentifier,t,o,s,d)},r.generateAuthenticationResult=function(e,t,o,i,n,s,d,u,h){var p,v,C;return oe(this,void 0,void 0,function(){var x,E,O,q,_e,se,ke,Tt,Gt,Lt,sn;return ie(this,function(ur){switch(ur.label){case 0:if(x=S.EMPTY_STRING,E=[],O=null,_e=S.EMPTY_STRING,!o.accessToken)return[3,4];if(o.accessToken.tokenType!==Ne.POP)return[3,2];if(se=new Po(e),ke=o.accessToken,Tt=ke.secret,Gt=ke.keyId,!Gt)throw L.createKeyIdMissingError();return[4,se.signPopToken(Tt,Gt,n)];case 1:return x=ur.sent(),[3,3];case 2:x=o.accessToken.secret,ur.label=3;case 3:E=bt.fromString(o.accessToken.target).asArray(),O=new Date(Number(o.accessToken.expiresOn)*1e3),q=new Date(Number(o.accessToken.extendedExpiresOn)*1e3),ur.label=4;case 4:return o.appMetadata&&(_e=o.appMetadata.familyId===Wn?Wn:S.EMPTY_STRING),Lt=s?.claims.oid||s?.claims.sub||S.EMPTY_STRING,sn=s?.claims.tid||S.EMPTY_STRING,u?.spa_accountid&&o.account&&(o.account.nativeAccountId=u?.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:Lt,tenantId:sn,scopes:E,account:o.account?o.account.getAccountInfo():null,idToken:s?s.rawToken:S.EMPTY_STRING,idTokenClaims:s?s.claims:{},accessToken:x,fromCache:i,expiresOn:O,correlationId:n.correlationId,requestId:h||S.EMPTY_STRING,extExpiresOn:q,familyId:_e,tokenType:((p=o.accessToken)===null||p===void 0?void 0:p.tokenType)||S.EMPTY_STRING,state:d?d.userRequestState:S.EMPTY_STRING,cloudGraphHostName:((v=o.account)===null||v===void 0?void 0:v.cloudGraphHostName)||S.EMPTY_STRING,msGraphHost:((C=o.account)===null||C===void 0?void 0:C.msGraphHost)||S.EMPTY_STRING,code:u?.spa_code,fromNativeBroker:!1}]}})})},r}();var Hc=function(r){ot(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.includeRedirectUri=!0,i}return e.prototype.getAuthCodeUrl=function(t){var o,i;return oe(this,void 0,void 0,function(){var n;return ie(this,function(s){switch(s.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement(A.GetAuthCodeUrl,t.correlationId),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime(A.AuthClientCreateQueryString,t.correlationId),[4,this.createAuthCodeUrlQueryString(t)];case 1:return n=s.sent(),[2,ge.appendQueryString(this.authority.authorizationEndpoint,n)]}})})},e.prototype.acquireToken=function(t,o){var i,n,s,d,u,h;return oe(this,void 0,void 0,function(){var p,v,C,x,E,O,q=this;return ie(this,function(_e){switch(_e.label){case 0:if(!t||!t.code)throw L.createTokenRequestCannotBeMadeError();return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement(A.AuthClientAcquireToken,t.correlationId),p=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement("AuthCodeClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in auth-code client"),v=it.nowSeconds(),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime(A.AuthClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(this.authority,t)];case 1:return C=_e.sent(),x=(d=C.headers)===null||d===void 0?void 0:d[kt.X_MS_REQUEST_ID],E=(u=C.headers)===null||u===void 0?void 0:u[kt.X_MS_HTTP_VERSION],E&&p?.addStaticFields({httpVerAuthority:E}),O=new Fr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient),O.validateTokenResponse(C.body),(h=this.performanceClient)===null||h===void 0||h.setPreQueueTime(A.HandleServerTokenResponse,t.correlationId),[2,O.handleServerTokenResponse(C.body,this.authority,v,t,o,void 0,void 0,void 0,x).then(function(se){return p?.endMeasurement({success:!0}),se}).catch(function(se){throw q.logger.verbose("Error in fetching token in ACC",t.correlationId),p?.endMeasurement({errorCode:se.errorCode,subErrorCode:se.subError,success:!1}),se})]}})})},e.prototype.handleFragmentResponse=function(t,o){var i=new Fr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new ge(t),s=ge.getDeserializedHash(n.getHash());if(i.validateServerAuthorizationCodeResponse(s,o,this.cryptoUtils),!s.code)throw L.createNoAuthCodeInServerResponseError();return Xe(Xe({},s),{code:s.code})},e.prototype.getLogoutUri=function(t){if(!t)throw Ge.createEmptyLogoutRequestError();var o=this.createLogoutUrlQueryString(t);return ge.appendQueryString(this.authority.endSessionEndpoint,o)},e.prototype.executeTokenRequest=function(t,o){var i,n;return oe(this,void 0,void 0,function(){var s,d,u,h,p,v,C;return ie(this,function(x){switch(x.label){case 0:return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement(A.AuthClientExecuteTokenRequest,o.correlationId),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime(A.AuthClientCreateTokenRequestBody,o.correlationId),s=this.createTokenQueryParameters(o),d=ge.appendQueryString(t.tokenEndpoint,s),[4,this.createTokenRequestBody(o)];case 1:if(u=x.sent(),h=void 0,o.clientInfo)try{p=Yn(o.clientInfo,this.cryptoUtils),h={credential:""+p.uid+It.CLIENT_INFO_SEPARATOR+p.utid,type:sr.HOME_ACCOUNT_ID}}catch(E){this.logger.verbose("Could not parse client info for CCS Header: "+E)}return v=this.createTokenRequestHeaders(h||o.ccsCredential),C={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},[2,this.executePostToTokenEndpoint(d,u,v,C)]}})})},e.prototype.createTokenRequestBody=function(t){var o,i;return oe(this,void 0,void 0,function(){var n,s,d,u,h,p,v,v,C;return ie(this,function(x){switch(x.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement(A.AuthClientCreateTokenRequestBody,t.correlationId),n=new wr,n.addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(t.redirectUri):mn.validateRedirectUri(t.redirectUri),n.addScopes(t.scopes),n.addAuthorizationCode(t.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&n.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(s=this.config.clientCredentials.clientAssertion,n.addClientAssertion(s.assertion),n.addClientAssertionType(s.assertionType)),n.addGrantType(go.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),t.authenticationScheme!==Ne.POP?[3,2]:(d=new Po(this.cryptoUtils,this.performanceClient),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime(A.PopTokenGenerateCnf,t.correlationId),[4,d.generateCnf(t)]);case 1:return u=x.sent(),n.addPopToken(u.reqCnfString),[3,3];case 2:if(t.authenticationScheme===Ne.SSH)if(t.sshJwk)n.addSshJwk(t.sshJwk);else throw Ge.createMissingSshJwkError();x.label=3;case 3:if(h=t.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(h),(!N.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(t.claims,this.config.authOptions.clientCapabilities),p=void 0,t.clientInfo)try{v=Yn(t.clientInfo,this.cryptoUtils),p={credential:""+v.uid+It.CLIENT_INFO_SEPARATOR+v.utid,type:sr.HOME_ACCOUNT_ID}}catch(E){this.logger.verbose("Could not parse client info for CCS Header: "+E)}else p=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&p)switch(p.type){case sr.HOME_ACCOUNT_ID:try{v=Fi(p.credential),n.addCcsOid(v)}catch(E){this.logger.verbose("Could not parse home account ID for CCS Header: "+E)}break;case sr.UPN:n.addCcsUpn(p.credential);break}return t.tokenBodyParameters&&n.addExtraQueryParameters(t.tokenBodyParameters),t.enableSpaAuthorizationCode&&(!t.tokenBodyParameters||!t.tokenBodyParameters[Fe.RETURN_SPA_CODE])&&n.addExtraQueryParameters((C={},C[Fe.RETURN_SPA_CODE]="1",C)),[2,n.createQueryString()]}})})},e.prototype.createAuthCodeUrlQueryString=function(t){var o;return oe(this,void 0,void 0,function(){var i,n,s,d,u,h,h,h,p,v;return ie(this,function(C){switch(C.label){case 0:if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement(A.AuthClientCreateQueryString,t.correlationId),i=new wr,i.addClientId(this.config.authOptions.clientId),n=jn(t.scopes||[],t.extraScopesToConsent||[]),i.addScopes(n),i.addRedirectUri(t.redirectUri),s=t.correlationId||this.config.cryptoInterface.createNewGuid(),i.addCorrelationId(s),i.addResponseMode(t.responseMode),i.addResponseTypeCode(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&i.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&i.addPrompt(t.prompt),t.domainHint&&i.addDomainHint(t.domainHint),t.prompt!==Kt.SELECT_ACCOUNT)if(t.sid&&t.prompt===Kt.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),i.addSid(t.sid);else if(t.account){if(d=this.extractAccountSid(t.account),u=this.extractLoginHint(t.account),u){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),i.addLoginHint(u);try{h=Fi(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(d&&t.prompt===Kt.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),i.addSid(d);try{h=Fi(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),i.addLoginHint(t.loginHint),i.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),i.addLoginHint(t.account.username);try{h=Fi(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),i.addLoginHint(t.loginHint),i.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&i.addNonce(t.nonce),t.state&&i.addState(t.state),(!N.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&i.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(i.addNativeBroker(),t.authenticationScheme!==Ne.POP?[3,2]:(p=new Po(this.cryptoUtils),[4,p.generateCnf(t)])):[3,2];case 1:v=C.sent(),i.addPopToken(v.reqCnfString),C.label=2;case 2:return[2,i.createQueryString()]}})})},e.prototype.createLogoutUrlQueryString=function(t){var o=new wr;return t.postLogoutRedirectUri&&o.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&o.addCorrelationId(t.correlationId),t.idTokenHint&&o.addIdTokenHint(t.idTokenHint),t.state&&o.addState(t.state),t.logoutHint&&o.addLogoutHint(t.logoutHint),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),o.createQueryString()},e.prototype.extractAccountSid=function(t){var o;return((o=t.idTokenClaims)===null||o===void 0?void 0:o.sid)||null},e.prototype.extractLoginHint=function(t){var o;return((o=t.idTokenClaims)===null||o===void 0?void 0:o.login_hint)||null},e}(vo);a();l();c();var k3=function(r){ot(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){return oe(this,void 0,void 0,function(){var o,i,n,s;return ie(this,function(d){switch(d.label){case 0:return[4,this.getDeviceCode(t)];case 1:return o=d.sent(),t.deviceCodeCallback(o),i=it.nowSeconds(),[4,this.acquireTokenWithDeviceCode(t,o)];case 2:return n=d.sent(),s=new Fr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),s.validateTokenResponse(n),[4,s.handleServerTokenResponse(n,this.authority,i,t)];case 3:return[2,d.sent()]}})})},e.prototype.getDeviceCode=function(t){return oe(this,void 0,void 0,function(){var o,i,n,s,d;return ie(this,function(u){return o=this.createExtraQueryParameters(t),i=ge.appendQueryString(this.authority.deviceCodeEndpoint,o),n=this.createQueryString(t),s=this.createTokenRequestHeaders(),d={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostRequestToDeviceCodeEndpoint(i,n,s,d)]})})},e.prototype.createExtraQueryParameters=function(t){var o=new wr;return t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),o.createQueryString()},e.prototype.executePostRequestToDeviceCodeEndpoint=function(t,o,i,n){return oe(this,void 0,void 0,function(){var s,d,u,h,p,v,C;return ie(this,function(x){switch(x.label){case 0:return[4,this.networkManager.sendPostRequest(n,t,{body:o,headers:i})];case 1:return s=x.sent().body,d=s.user_code,u=s.device_code,h=s.verification_uri,p=s.expires_in,v=s.interval,C=s.message,[2,{userCode:d,deviceCode:u,verificationUri:h,expiresIn:p,interval:v,message:C}]}})})},e.prototype.createQueryString=function(t){var o=new wr;return o.addScopes(t.scopes),o.addClientId(this.config.authOptions.clientId),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),(!N.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e.prototype.continuePolling=function(t,o,i){if(i)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),L.createDeviceCodeCancelledError();if(o&&o<t&&it.nowSeconds()>o)throw this.logger.error("User defined timeout for device code polling reached. The timeout was set for "+o),L.createUserTimeoutReachedError();if(it.nowSeconds()>t)throw o&&this.logger.verbose("User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for "+o),this.logger.error("Device code expired. Expiration time of device code was "+t),L.createDeviceCodeExpiredError();return!0},e.prototype.acquireTokenWithDeviceCode=function(t,o){return oe(this,void 0,void 0,function(){var i,n,s,d,u,h,p,v,C;return ie(this,function(x){switch(x.label){case 0:i=this.createTokenQueryParameters(t),n=ge.appendQueryString(this.authority.tokenEndpoint,i),s=this.createTokenRequestBody(t,o),d=this.createTokenRequestHeaders(),u=t.timeout?it.nowSeconds()+t.timeout:void 0,h=it.nowSeconds()+o.expiresIn,p=o.interval*1e3,x.label=1;case 1:return this.continuePolling(h,u,t.cancel)?(v={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[4,this.executePostToTokenEndpoint(n,s,d,v)]):[3,8];case 2:return C=x.sent(),C.body&&C.body.error?C.body.error!==S.AUTHORIZATION_PENDING?[3,4]:(this.logger.info("Authorization pending. Continue polling."),[4,it.delay(p)]):[3,6];case 3:return x.sent(),[3,5];case 4:throw this.logger.info("Unexpected error in polling from the server"),$r.createPostRequestFailed(C.body.error);case 5:return[3,7];case 6:return this.logger.verbose("Authorization completed successfully. Polling stopped."),[2,C.body];case 7:return[3,1];case 8:throw this.logger.error("Polling stopped for unknown reasons."),L.createDeviceCodeUnknownError()}})})},e.prototype.createTokenRequestBody=function(t,o){var i=new wr;i.addScopes(t.scopes),i.addClientId(this.config.authOptions.clientId),i.addGrantType(go.DEVICE_CODE_GRANT),i.addDeviceCode(o.deviceCode);var n=t.correlationId||this.config.cryptoInterface.createNewGuid();return i.addCorrelationId(n),i.addClientInfo(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addThrottling(),this.serverTelemetryManager&&i.addServerTelemetry(this.serverTelemetryManager),(!N.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(t.claims,this.config.authOptions.clientCapabilities),i.createQueryString()},e}(vo);a();l();c();var Uc=function(r){ot(e,r);function e(t,o){return r.call(this,t,o)||this}return e.prototype.acquireToken=function(t){var o,i,n,s,d,u,h;return oe(this,void 0,void 0,function(){var p,v,C,x,E,O,q=this;return ie(this,function(_e){switch(_e.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement(A.RefreshTokenClientAcquireToken,t.correlationId),p=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement(A.RefreshTokenClientAcquireToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",t.correlationId),v=it.nowSeconds(),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime(A.RefreshTokenClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(t,this.authority)];case 1:return C=_e.sent(),x=(s=C.headers)===null||s===void 0?void 0:s[kt.X_MS_HTTP_VERSION],p?.addStaticFields({refreshTokenSize:((d=C.body.refresh_token)===null||d===void 0?void 0:d.length)||0}),x&&p?.addStaticFields({httpVerToken:x}),E=(u=C.headers)===null||u===void 0?void 0:u[kt.X_MS_REQUEST_ID],O=new Fr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),O.validateTokenResponse(C.body),(h=this.performanceClient)===null||h===void 0||h.setPreQueueTime(A.HandleServerTokenResponse,t.correlationId),[2,O.handleServerTokenResponse(C.body,this.authority,v,t,void 0,void 0,!0,t.forceCache,E).then(function(se){return p?.endMeasurement({success:!0}),se}).catch(function(se){throw q.logger.verbose("Error in fetching refresh token",t.correlationId),p?.endMeasurement({errorCode:se.errorCode,subErrorCode:se.subError,success:!1}),se})]}})})},e.prototype.acquireTokenByRefreshToken=function(t){var o,i,n,s;return oe(this,void 0,void 0,function(){var d,u,h;return ie(this,function(p){if(!t)throw Ge.createEmptyTokenRequestError();if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement(A.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),!t.account)throw L.createNoAccountInSilentRequestError();if(d=this.cacheManager.isAppMetadataFOCI(t.account.environment),d)try{return(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime(A.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(v){if(u=v instanceof ar&&v.errorCode===Li.noTokensFoundError.code,h=v instanceof $r&&v.errorCode===lh.INVALID_GRANT_ERROR&&v.subError===lh.CLIENT_MISMATCH_ERROR,u||h)return(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime(A.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw v}return(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime(A.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)]})})},e.prototype.acquireTokenWithCachedRefreshToken=function(t,o){var i,n,s;return oe(this,void 0,void 0,function(){var d,u,h;return ie(this,function(p){if((i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement(A.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),d=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement(A.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",t.correlationId),u=this.cacheManager.getRefreshToken(t.account,o),!u)throw d?.discardMeasurement(),ar.createNoTokensFoundError();return d?.endMeasurement({success:!0}),h=Xe(Xe({},t),{refreshToken:u.secret,authenticationScheme:t.authenticationScheme||Ne.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:sr.HOME_ACCOUNT_ID}}),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime(A.RefreshTokenClientAcquireToken,t.correlationId),[2,this.acquireToken(h)]})})},e.prototype.executeTokenRequest=function(t,o){var i,n,s;return oe(this,void 0,void 0,function(){var d,u,h,p,v,C;return ie(this,function(x){switch(x.label){case 0:return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement(A.RefreshTokenClientExecuteTokenRequest,t.correlationId),d=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement(A.RefreshTokenClientExecuteTokenRequest,t.correlationId),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime(A.RefreshTokenClientCreateTokenRequestBody,t.correlationId),u=this.createTokenQueryParameters(t),h=ge.appendQueryString(o.tokenEndpoint,u),[4,this.createTokenRequestBody(t)];case 1:return p=x.sent(),v=this.createTokenRequestHeaders(t.ccsCredential),C={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(h,p,v,C).then(function(E){return d?.endMeasurement({success:!0}),E}).catch(function(E){throw d?.endMeasurement({success:!1}),E})]}})})},e.prototype.createTokenRequestBody=function(t){var o,i,n;return oe(this,void 0,void 0,function(){var s,d,u,h,p,v,C;return ie(this,function(x){switch(x.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement(A.RefreshTokenClientCreateTokenRequestBody,t.correlationId),s=t.correlationId,d=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement(A.BaseClientCreateTokenRequestHeaders,s),u=new wr,u.addClientId(this.config.authOptions.clientId),u.addScopes(t.scopes),u.addGrantType(go.REFRESH_TOKEN_GRANT),u.addClientInfo(),u.addLibraryInfo(this.config.libraryInfo),u.addApplicationTelemetry(this.config.telemetry.application),u.addThrottling(),this.serverTelemetryManager&&u.addServerTelemetry(this.serverTelemetryManager),u.addCorrelationId(s),u.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&u.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(h=this.config.clientCredentials.clientAssertion,u.addClientAssertion(h.assertion),u.addClientAssertionType(h.assertionType)),t.authenticationScheme!==Ne.POP?[3,2]:(p=new Po(this.cryptoUtils,this.performanceClient),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime(A.PopTokenGenerateCnf,t.correlationId),[4,p.generateCnf(t)]);case 1:return v=x.sent(),u.addPopToken(v.reqCnfString),[3,3];case 2:if(t.authenticationScheme===Ne.SSH)if(t.sshJwk)u.addSshJwk(t.sshJwk);else throw d?.endMeasurement({success:!1}),Ge.createMissingSshJwkError();x.label=3;case 3:if((!N.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&u.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case sr.HOME_ACCOUNT_ID:try{C=Fi(t.ccsCredential.credential),u.addCcsOid(C)}catch(E){this.logger.verbose("Could not parse home account ID for CCS Header: "+E)}break;case sr.UPN:u.addCcsUpn(t.ccsCredential.credential);break}return d?.endMeasurement({success:!0}),[2,u.createQueryString()]}})})},e}(vo);a();l();c();var I3=function(r){ot(e,r);function e(t,o){var i=r.call(this,t)||this;return i.appTokenProvider=o,i}return e.prototype.acquireToken=function(t){return oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return this.scopeSet=new bt(t.scopes||[]),t.skipCache?[4,this.executeTokenRequest(t,this.authority)]:[3,2];case 1:return[2,i.sent()];case 2:return[4,this.getCachedAuthenticationResult(t)];case 3:return o=i.sent(),o?[2,o]:[3,4];case 4:return[4,this.executeTokenRequest(t,this.authority)];case 5:return[2,i.sent()]}})})},e.prototype.getCachedAuthenticationResult=function(t){var o,i;return oe(this,void 0,void 0,function(){var n;return ie(this,function(s){switch(s.label){case 0:return n=this.readAccessTokenFromCache(),n?it.isTokenExpired(n.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?((i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(Gr.CACHED_ACCESS_TOKEN_EXPIRED),[2,null]):[4,Fr.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:null,idToken:null,accessToken:n,refreshToken:null,appMetadata:null},!0,t)]:((o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(Gr.NO_CACHED_ACCESS_TOKEN),[2,null]);case 1:return[2,s.sent()]}})})},e.prototype.readAccessTokenFromCache=function(){var t={homeAccountId:S.EMPTY_STRING,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ae.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:bt.createSearchScopes(this.scopeSet.asArray())},o=this.cacheManager.getAccessTokensByFilter(t);if(o.length<1)return null;if(o.length>1)throw L.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.executeTokenRequest=function(t,o){return oe(this,void 0,void 0,function(){var i,n,s,d,u,h,p,v,C,x,E,O;return ie(this,function(q){switch(q.label){case 0:return this.appTokenProvider?(this.logger.info("Using appTokenProvider extensibility."),s={correlationId:t.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:t.scopes,claims:t.claims},n=it.nowSeconds(),[4,this.appTokenProvider(s)]):[3,2];case 1:return d=q.sent(),i={access_token:d.accessToken,expires_in:d.expiresInSeconds,refresh_in:d.refreshInSeconds,token_type:Ne.BEARER},[3,4];case 2:return u=this.createTokenQueryParameters(t),h=ge.appendQueryString(o.tokenEndpoint,u),p=this.createTokenRequestBody(t),v=this.createTokenRequestHeaders(),C={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},n=it.nowSeconds(),[4,this.executePostToTokenEndpoint(h,p,v,C)];case 3:x=q.sent(),i=x.body,q.label=4;case 4:return E=new Fr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),E.validateTokenResponse(i),[4,E.handleServerTokenResponse(i,this.authority,n,t)];case 5:return O=q.sent(),[2,O]}})})},e.prototype.createTokenRequestBody=function(t){var o=new wr;o.addClientId(this.config.authOptions.clientId),o.addScopes(t.scopes,!1),o.addGrantType(go.CLIENT_CREDENTIALS_GRANT),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();o.addCorrelationId(i),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret);var n=t.clientAssertion||this.config.clientCredentials.clientAssertion;return n&&(o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)),(!N.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e}(vo);a();l();c();var A3=function(r){ot(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){return oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:return this.scopeSet=new bt(t.scopes||[]),o=this,[4,this.cryptoUtils.hashString(t.oboAssertion)];case 1:return o.userAssertionHash=i.sent(),t.skipCache?[4,this.executeTokenRequest(t,this.authority,this.userAssertionHash)]:[3,3];case 2:return[2,i.sent()];case 3:return i.trys.push([3,5,,7]),[4,this.getCachedAuthenticationResult(t)];case 4:return[2,i.sent()];case 5:return i.sent(),[4,this.executeTokenRequest(t,this.authority,this.userAssertionHash)];case 6:return[2,i.sent()];case 7:return[2]}})})},e.prototype.getCachedAuthenticationResult=function(t){var o,i;return oe(this,void 0,void 0,function(){var n,s,d,u,h,p;return ie(this,function(v){switch(v.label){case 0:if(n=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,t),n){if(it.isTokenExpired(n.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(Gr.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),L.createRefreshRequiredError()}else throw(o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(Gr.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),L.createRefreshRequiredError();return s=this.readIdTokenFromCacheForOBO(n.homeAccountId),u=null,s&&(d=new rr(s.secret,this.config.cryptoInterface),h=d.claims.oid?d.claims.oid:d.claims.sub,p={homeAccountId:s.homeAccountId,environment:s.environment,tenantId:s.realm,username:S.EMPTY_STRING,localAccountId:h||S.EMPTY_STRING},u=this.cacheManager.readAccountFromCache(p)),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,Fr.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:u,accessToken:n,idToken:s,refreshToken:null,appMetadata:null},!0,t,d)];case 1:return[2,v.sent()]}})})},e.prototype.readIdTokenFromCacheForOBO=function(t){var o={homeAccountId:t,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ae.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},i=this.cacheManager.getIdTokensByFilter(o);return i.length<1?null:i[0]},e.prototype.readAccessTokenFromCacheForOBO=function(t,o){var i=o.authenticationScheme||Ne.BEARER,n=i&&i.toLowerCase()!==Ne.BEARER.toLowerCase()?ae.ACCESS_TOKEN_WITH_AUTH_SCHEME:ae.ACCESS_TOKEN,s={credentialType:n,clientId:t,target:bt.createSearchScopes(this.scopeSet.asArray()),tokenType:i,keyId:o.sshKid,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:this.userAssertionHash},d=this.cacheManager.getAccessTokensByFilter(s),u=d.length;if(u<1)return null;if(u>1)throw L.createMultipleMatchingTokensInCacheError();return d[0]},e.prototype.executeTokenRequest=function(t,o,i){return oe(this,void 0,void 0,function(){var n,s,d,u,h,p,v,C,x;return ie(this,function(E){switch(E.label){case 0:return n=this.createTokenQueryParameters(t),s=ge.appendQueryString(o.tokenEndpoint,n),d=this.createTokenRequestBody(t),u=this.createTokenRequestHeaders(),h={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},p=it.nowSeconds(),[4,this.executePostToTokenEndpoint(s,d,u,h)];case 1:return v=E.sent(),C=new Fr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),C.validateTokenResponse(v.body),[4,C.handleServerTokenResponse(v.body,this.authority,p,t,void 0,i)];case 2:return x=E.sent(),[2,x]}})})},e.prototype.createTokenRequestBody=function(t){var o=new wr;o.addClientId(this.config.authOptions.clientId),o.addScopes(t.scopes),o.addGrantType(go.JWT_BEARER),o.addClientInfo(),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();if(o.addCorrelationId(i),o.addRequestTokenUse(Fe.ON_BEHALF_OF),o.addOboAssertion(t.oboAssertion),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)}return(t.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e}(vo);a();l();c();var fg=function(r){ot(e,r);function e(t,o){return r.call(this,t,o)||this}return e.prototype.acquireToken=function(t){return oe(this,void 0,void 0,function(){var o,i;return ie(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,n.sent()];case 2:if(o=n.sent(),o instanceof L&&o.errorCode===z.tokenRefreshRequired.code)return i=new Uc(this.config,this.performanceClient),[2,i.acquireTokenByRefreshToken(t)];throw o;case 3:return[2]}})})},e.prototype.acquireCachedToken=function(t){var o,i,n,s,d;return oe(this,void 0,void 0,function(){var u,h;return ie(this,function(p){switch(p.label){case 0:if(!t)throw Ge.createEmptyTokenRequestError();if(t.forceRefresh)throw(o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(Gr.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),L.createRefreshRequiredError();if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!N.isEmptyObj(t.claims))throw(i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(Gr.CLAIMS_REQUESTED_CACHE_SKIPPED),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),L.createRefreshRequiredError();if(!t.account)throw L.createNoAccountInSilentRequestError();if(u=t.authority||this.authority.getPreferredCache(),h=this.cacheManager.readCacheRecord(t.account,t,u),h.accessToken){if(it.wasClockTurnedBack(h.accessToken.cachedAt)||it.isTokenExpired(h.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(s=this.serverTelemetryManager)===null||s===void 0||s.setCacheOutcome(Gr.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),L.createRefreshRequiredError();if(h.accessToken.refreshOn&&it.isTokenExpired(h.accessToken.refreshOn,0))throw(d=this.serverTelemetryManager)===null||d===void 0||d.setCacheOutcome(Gr.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),L.createRefreshRequiredError()}else throw(n=this.serverTelemetryManager)===null||n===void 0||n.setCacheOutcome(Gr.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),L.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(h,t)];case 1:return[2,p.sent()]}})})},e.prototype.generateResultFromCacheRecord=function(t,o){return oe(this,void 0,void 0,function(){var i,n;return ie(this,function(s){switch(s.label){case 0:if(t.idToken&&(i=new rr(t.idToken.secret,this.config.cryptoInterface)),o.maxAge||o.maxAge===0){if(n=i?.claims.auth_time,!n)throw L.createAuthTimeNotFoundError();rr.checkMaxAge(n,o.maxAge)}return[4,Fr.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,o,i)];case 1:return[2,s.sent()]}})})},e}(vo);a();l();c();var R3=function(r){ot(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){var o,i;return oe(this,void 0,void 0,function(){var n,s,d,u,h,p;return ie(this,function(v){switch(v.label){case 0:return n=(o=this.performanceClient)===null||o===void 0?void 0:o.startMeasurement("UsernamePasswordClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in username-password client"),s=it.nowSeconds(),[4,this.executeTokenRequest(this.authority,t)];case 1:return d=v.sent(),u=(i=d.headers)===null||i===void 0?void 0:i[kt.X_MS_HTTP_VERSION],n?.addStaticFields({httpVerToken:u}),h=new Fr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),h.validateTokenResponse(d.body),p=h.handleServerTokenResponse(d.body,this.authority,s,t),[2,p]}})})},e.prototype.executeTokenRequest=function(t,o){return oe(this,void 0,void 0,function(){var i,n,s,d,u;return ie(this,function(h){return i=this.createTokenQueryParameters(o),n=ge.appendQueryString(t.tokenEndpoint,i),s=this.createTokenRequestBody(o),d=this.createTokenRequestHeaders({credential:o.username,type:sr.UPN}),u={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},[2,this.executePostToTokenEndpoint(n,s,d,u)]})})},e.prototype.createTokenRequestBody=function(t){var o=new wr;o.addClientId(this.config.authOptions.clientId),o.addUsername(t.username),o.addPassword(t.password),o.addScopes(t.scopes),o.addResponseTypeForTokenAndIdToken(),o.addGrantType(go.RESOURCE_OWNER_PASSWORD_GRANT),o.addClientInfo(),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();if(o.addCorrelationId(i),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)}return(!N.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.username&&o.addCcsUpn(t.username),o.createQueryString()},e}(vo);a();l();c();a();l();c();function lw(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}a();l();c();var cw={endpointMetadata:{"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},instanceDiscoveryMetadata:{"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}}},mg=cw.endpointMetadata,gg=cw.instanceDiscoveryMetadata;a();l();c();var vn;(function(r){r.AAD="AAD",r.OIDC="OIDC"})(vn||(vn={}));a();l();c();var pl=function(){function r(){this.expiresAt=it.nowSeconds()+oa.REFRESH_TIME_SECONDS}return r.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},r.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},r.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},r.prototype.resetExpiresAt=function(){this.expiresAt=it.nowSeconds()+oa.REFRESH_TIME_SECONDS},r.prototype.isExpired=function(){return this.expiresAt<=it.nowSeconds()},r.isAuthorityMetadataEntity=function(e,t){return t?e.indexOf(oa.CACHE_KEY)===0&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"):!1},r}();a();l();c();function dw(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}a();l();c();function uw(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}a();l();c();var hw=function(){function r(e,t,o){this.networkInterface=e,this.performanceClient=t,this.correlationId=o}return r.prototype.detectRegion=function(e,t){var o,i,n,s;return oe(this,void 0,void 0,function(){var d,u,h,p,v;return ie(this,function(C){switch(C.label){case 0:if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement(A.RegionDiscoveryDetectRegion,this.correlationId),d=e,d)return[3,8];u=r.IMDS_OPTIONS,C.label=1;case 1:return C.trys.push([1,6,,7]),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime(A.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(S.IMDS_VERSION,u)];case 2:return h=C.sent(),h.status===ra.httpSuccess&&(d=h.body,t.region_source=pn.IMDS),h.status!==ra.httpBadRequest?[3,5]:((n=this.performanceClient)===null||n===void 0||n.setPreQueueTime(A.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(u)]);case 3:return p=C.sent(),p?((s=this.performanceClient)===null||s===void 0||s.setPreQueueTime(A.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(p,u)]):(t.region_source=pn.FAILED_AUTO_DETECTION,[2,null]);case 4:v=C.sent(),v.status===ra.httpSuccess&&(d=v.body,t.region_source=pn.IMDS),C.label=5;case 5:return[3,7];case 6:return C.sent(),t.region_source=pn.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=pn.ENVIRONMENT_VARIABLE,C.label=9;case 9:return d||(t.region_source=pn.FAILED_AUTO_DETECTION),[2,d||null]}})})},r.prototype.getRegionFromIMDS=function(e,t){var o;return oe(this,void 0,void 0,function(){return ie(this,function(i){return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement(A.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(S.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,S.IMDS_TIMEOUT)]})})},r.prototype.getCurrentVersion=function(e){var t;return oe(this,void 0,void 0,function(){var o;return ie(this,function(i){switch(i.label){case 0:(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement(A.RegionDiscoveryGetCurrentVersion,this.correlationId),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(S.IMDS_ENDPOINT+"?format=json",e)];case 2:return o=i.sent(),o.status===ra.httpBadRequest&&o.body&&o.body["newest-versions"]&&o.body["newest-versions"].length>0?[2,o.body["newest-versions"][0]]:[2,null];case 3:return i.sent(),[2,null];case 4:return[2]}})})},r.IMDS_OPTIONS={headers:{Metadata:"true"}},r}();var yn=function(){function r(e,t,o,i,n,s,d){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=o,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=n,this.performanceClient=s,this.correlationId=d,this.regionDiscovery=new hw(t,this.performanceClient,this.correlationId)}return r.prototype.getAuthorityType=function(e){if(e.HostNameAndPort.endsWith(S.CIAM_AUTH_URL))return nr.Ciam;var t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case S.ADFS:return nr.Adfs;case S.DSTS:return nr.Dsts}return nr.Default},Object.defineProperty(r.prototype,"authorityType",{get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new ge(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw L.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw L.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw L.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw L.createLogoutNotSupportedError();return this.replacePath(this.metadata.end_session_endpoint)}else throw L.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw L.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"jwksUri",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw L.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),r.prototype.canReplaceTenant=function(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===nr.Default&&this.protocolMode===vn.AAD},r.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},r.prototype.replacePath=function(e){var t=this,o=e,i=new ge(this.metadata.canonical_authority),n=i.getUrlComponents(),s=n.PathSegments,d=this.canonicalAuthorityUrlComponents.PathSegments;return d.forEach(function(u,h){var p=s[h];if(h===0&&t.canReplaceTenant(n)){var v=new ge(t.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];p!==v&&(t.logger.verbose("Replacing tenant domain name "+p+" with id "+v),p=v)}u!==p&&(o=o.replace("/"+p+"/","/"+u+"/"))}),this.replaceTenant(o)},Object.defineProperty(r.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===nr.Adfs||this.authorityType===nr.Dsts||this.protocolMode===vn.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),r.prototype.discoveryComplete=function(){return!!this.metadata},r.prototype.resolveEndpointsAsync=function(){var e,t,o;return oe(this,void 0,void 0,function(){var i,n,s,d;return ie(this,function(u){switch(u.label){case 0:return(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement(A.AuthorityResolveEndpointsAsync,this.correlationId),i=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort),i||(i=new pl,i.updateCanonicalAuthority(this.canonicalAuthority)),(t=this.performanceClient)===null||t===void 0||t.setPreQueueTime(A.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(i)];case 1:return n=u.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,i.preferred_network),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime(A.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(i)];case 2:return s=u.sent(),n!==Ro.CACHE&&s!==Ro.CACHE&&(i.resetExpiresAt(),i.updateCanonicalAuthority(this.canonicalAuthority)),d=this.cacheManager.generateAuthorityMetadataCacheKey(i.preferred_cache),this.cacheManager.setAuthorityMetadata(d,i),this.metadata=i,[2]}})})},r.prototype.updateEndpointMetadata=function(e){var t,o,i,n,s,d;return oe(this,void 0,void 0,function(){var u,h;return ie(this,function(p){switch(p.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement(A.AuthorityUpdateEndpointMetadata,this.correlationId),u=this.getEndpointMetadataFromConfig(),u?(e.updateEndpointMetadata(u,!1),[2,Ro.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,Ro.CACHE]:((o=this.performanceClient)===null||o===void 0||o.setPreQueueTime(A.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return u=p.sent(),u?!((i=this.authorityOptions.azureRegionConfiguration)===null||i===void 0)&&i.azureRegion?((n=this.performanceClient)===null||n===void 0||n.setPreQueueTime(A.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(u)]):[3,3]:[3,4];case 2:u=p.sent(),p.label=3;case 3:return e.updateEndpointMetadata(u,!0),[2,Ro.NETWORK];case 4:return h=this.getEndpointMetadataFromHardcodedValues(),h&&!this.authorityOptions.skipAuthorityMetadataCache?!((s=this.authorityOptions.azureRegionConfiguration)===null||s===void 0)&&s.azureRegion?((d=this.performanceClient)===null||d===void 0||d.setPreQueueTime(A.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(h)]):[3,6]:[3,7];case 5:h=p.sent(),p.label=6;case 6:return e.updateEndpointMetadata(h,!1),[2,Ro.HARDCODED_VALUES];case 7:throw L.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},r.prototype.isAuthoritySameType=function(e){var t=new ge(e.canonical_authority),o=t.getUrlComponents().PathSegments;return o.length===this.canonicalAuthorityUrlComponents.PathSegments.length},r.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Ge.createInvalidAuthorityMetadataError()}return null},r.prototype.getEndpointMetadataFromNetwork=function(){var e;return oe(this,void 0,void 0,function(){var t,o;return ie(this,function(i){switch(i.label){case 0:(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement(A.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return o=i.sent(),[2,lw(o.body)?o.body:null];case 3:return i.sent(),[2,null];case 4:return[2]}})})},r.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in mg?mg[this.canonicalAuthority]:null},r.prototype.updateMetadataWithRegionalInformation=function(e){var t,o,i,n;return oe(this,void 0,void 0,function(){var s,d;return ie(this,function(u){switch(u.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement(A.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),s=(o=this.authorityOptions.azureRegionConfiguration)===null||o===void 0?void 0:o.azureRegion,s?s!==S.AZURE_REGION_AUTO_DISCOVER_FLAG?(this.regionDiscoveryMetadata.region_outcome=cl.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=s,[2,r.replaceWithRegionalInformation(e,s)]):((i=this.performanceClient)===null||i===void 0||i.setPreQueueTime(A.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion((n=this.authorityOptions.azureRegionConfiguration)===null||n===void 0?void 0:n.environmentRegion,this.regionDiscoveryMetadata)]):[3,2];case 1:if(d=u.sent(),d)return this.regionDiscoveryMetadata.region_outcome=cl.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=d,[2,r.replaceWithRegionalInformation(e,d)];this.regionDiscoveryMetadata.region_outcome=cl.AUTO_DETECTION_REQUESTED_FAILED,u.label=2;case 2:return[2,e]}})})},r.prototype.updateCloudDiscoveryMetadata=function(e){var t,o;return oe(this,void 0,void 0,function(){var i,n,s;return ie(this,function(d){switch(d.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement(A.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||S.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||S.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||S.NOT_APPLICABLE)),i=this.getCloudDiscoveryMetadataFromConfig(),i?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(i,!1),[2,Ro.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),n=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found metadata in the cache."),[2,Ro.CACHE]):(n&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime(A.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(i=d.sent(),i)return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(i,!0),[2,Ro.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),s=this.getCloudDiscoveryMetadataFromHarcodedValues(),s&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(s,!1),[2,Ro.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),Ge.createUntrustedAuthorityError()}})})},r.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===nr.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=r.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ge.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},r.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var e;return oe(this,void 0,void 0,function(){var t,o,i,n,s,d,u,h;return ie(this,function(p){switch(p.label){case 0:(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement(A.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),t=""+S.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",o={},i=null,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t,o)];case 2:if(n=p.sent(),s=void 0,d=void 0,dw(n.body))s=n.body,d=s.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+s.tenant_discovery_endpoint);else if(uw(n.body)){if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+n.status),s=n.body,s.error===S.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+s.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+s.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),d=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=r.getCloudDiscoveryMetadataFromNetworkResponse(d,this.hostnameAndPort),[3,4];case 3:return u=p.sent(),u instanceof Y?this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: `+u.errorCode+`
Error Description: `+u.errorMessage):(h=u,this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: `+h.name+`
Error Description: `+h.message)),[2,null];case 4:return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,i]}})})},r.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in gg?gg[this.canonicalAuthority]:null},r.prototype.isInKnownAuthorities=function(){var e=this,t=this.authorityOptions.knownAuthorities.filter(function(o){return ge.getDomainFromUrl(o).toLowerCase()===e.hostnameAndPort});return t.length>0},r.generateAuthority=function(e,t){var o;if(t&&t.azureCloudInstance!==Mi.None){var i=t.tenant?t.tenant:S.DEFAULT_COMMON_TENANT;o=t.azureCloudInstance+"/"+i+"/"}return o||e},r.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},r.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var o=0;o<e.length;o++){var i=e[o];if(i.aliases.indexOf(t)>-1)return i}return null},r.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw L.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},r.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},r.isPublicCloudAuthority=function(e){return S.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},r.buildRegionalAuthorityString=function(e,t,o){var i=new ge(e);i.validateAsUri();var n=i.getUrlComponents(),s=t+"."+n.HostNameAndPort;this.isPublicCloudAuthority(n.HostNameAndPort)&&(s=t+"."+S.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var d=ge.constructAuthorityUriFromObject(Xe(Xe({},i.getUrlComponents()),{HostNameAndPort:s})).urlString;return o?d+"?"+o:d},r.replaceWithRegionalInformation=function(e,t){return e.authorization_endpoint=r.buildRegionalAuthorityString(e.authorization_endpoint,t),e.token_endpoint=r.buildRegionalAuthorityString(e.token_endpoint,t,S.REGIONAL_AUTH_NON_MSI_QUERY_STRING),e.end_session_endpoint&&(e.end_session_endpoint=r.buildRegionalAuthorityString(e.end_session_endpoint,t)),e},r.transformCIAMAuthority=function(e){var t=e.endsWith(S.FORWARD_SLASH)?e:""+e+S.FORWARD_SLASH,o=new ge(e),i=o.getUrlComponents();if(i.PathSegments.length===0&&i.HostNameAndPort.endsWith(S.CIAM_AUTH_URL)){var n=i.HostNameAndPort.split(".")[0];t=""+t+n+S.AAD_TENANT_DOMAIN_SUFFIX}return t},r.reservedTenantDomains=new Set(["{tenant}","{tenantid}",hn.COMMON,hn.CONSUMERS,hn.ORGANIZATIONS]),r}();a();l();c();var Jn=function(){function r(){}return r.createDiscoveredInstance=function(e,t,o,i,n,s,d){return oe(this,void 0,void 0,function(){var u,h,p;return ie(this,function(v){switch(v.label){case 0:s?.addQueueMeasurement(A.AuthorityFactoryCreateDiscoveredInstance,d),u=yn.transformCIAMAuthority(e),h=r.createInstance(u,t,o,i,n,s,d),v.label=1;case 1:return v.trys.push([1,3,,4]),s?.setPreQueueTime(A.AuthorityResolveEndpointsAsync,d),[4,h.resolveEndpointsAsync()];case 2:return v.sent(),[2,h];case 3:throw p=v.sent(),L.createEndpointDiscoveryIncompleteError(p);case 4:return[2]}})})},r.createInstance=function(e,t,o,i,n,s,d){if(N.isEmpty(e))throw Ge.createUrlEmptyError();return new yn(e,t,o,i,n,s,d)},r}();a();l();c();var sa=function(){function r(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return r.isServerTelemetryEntity=function(e,t){var o=e.indexOf(pr.CACHE_KEY)===0,i=!0;return t&&(i=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),o&&i},r}();a();l();c();var uh=function(){function r(){}return r.isThrottlingEntity=function(e,t){var o=!1;e&&(o=e.indexOf(fn.THROTTLING_PREFIX)===0);var i=!0;return t&&(i=t.hasOwnProperty("throttleTime")),o&&i},r}();a();l();c();var vg={sendGetRequestAsync:function(){var r="Network interface - sendGetRequestAsync() has not been implemented for the Network interface.";return Promise.reject(Y.createUnexpectedError(r))},sendPostRequestAsync:function(){var r="Network interface - sendPostRequestAsync() has not been implemented for the Network interface.";return Promise.reject(Y.createUnexpectedError(r))}};a();l();c();a();l();c();var hh={missingKidError:{code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},missingAlgError:{code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."}},yg=function(r){ot(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="JoseHeaderError",Object.setPrototypeOf(i,e.prototype),i}return e.createMissingKidError=function(){return new e(hh.missingKidError.code,hh.missingKidError.desc)},e.createMissingAlgError=function(){return new e(hh.missingAlgError.code,hh.missingAlgError.desc)},e}(Y);var bg=function(){function r(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return r.getShrHeaderString=function(e){if(!e.kid)throw yg.createMissingKidError();if(!e.alg)throw yg.createMissingAlgError();var t=new r({typ:e.typ||sh.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)},r}();a();l();c();var pw=function(){function r(e){this.headers=e}return r.prototype.getShrNonce=function(){var e=this.headers[kt.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw Ge.createInvalidAuthenticationHeaderError(kt.AuthenticationInfo,"nextnonce challenge is missing.")}var o=this.headers[kt.WWWAuthenticate];if(o){var i=this.parseChallenges(o);if(i.nonce)return i.nonce;throw Ge.createInvalidAuthenticationHeaderError(kt.WWWAuthenticate,"nonce challenge is missing.")}throw Ge.createMissingNonceAuthenticationHeadersError()},r.prototype.parseChallenges=function(e){var t=e.indexOf(" "),o=e.substr(t+1).split(","),i={};return o.forEach(function(n){var s=n.split("="),d=s[0],u=s[1];i[d]=unescape(u.replace(/['"]+/g,S.EMPTY_STRING))}),i},r}();a();l();c();var Cg=function(){function r(e,t){this.cacheOutcome=Gr.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||S.EMPTY_STRING,this.wrapperVer=e.wrapperVer||S.EMPTY_STRING,this.telemetryCacheKey=pr.CACHE_KEY+It.CACHE_KEY_SEPARATOR+e.clientId}return r.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+pr.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(pr.VALUE_SEPARATOR),o=this.getRegionDiscoveryFields(),i=[e,o].join(pr.VALUE_SEPARATOR);return[pr.SCHEMA_VERSION,i,t].join(pr.CATEGORY_SEPARATOR)},r.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=r.maxErrorsToSend(e),o=e.failedRequests.slice(0,2*t).join(pr.VALUE_SEPARATOR),i=e.errors.slice(0,t).join(pr.VALUE_SEPARATOR),n=e.errors.length,s=t<n?pr.OVERFLOW_TRUE:pr.OVERFLOW_FALSE,d=[n,s].join(pr.VALUE_SEPARATOR);return[pr.SCHEMA_VERSION,e.cacheHits,o,i,d].join(pr.CATEGORY_SEPARATOR)},r.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=pr.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),N.isEmpty(e.subError)?N.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(pr.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},r.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},r.prototype.getLastRequests=function(){var e=new sa,t=this.cacheManager.getServerTelemetry(this.telemetryCacheKey);return t||e},r.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=r.maxErrorsToSend(e),o=e.errors.length;if(t===o)this.cacheManager.removeItem(this.telemetryCacheKey);else{var i=new sa;i.failedRequests=e.failedRequests.slice(t*2),i.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i)}},r.maxErrorsToSend=function(e){var t,o=0,i=0,n=e.errors.length;for(t=0;t<n;t++){var s=e.failedRequests[2*t]||S.EMPTY_STRING,d=e.failedRequests[2*t+1]||S.EMPTY_STRING,u=e.errors[t]||S.EMPTY_STRING;if(i+=s.toString().length+d.toString().length+u.length+3,i<pr.MAX_LAST_HEADER_BYTES)o+=1;else break}return o},r.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||S.EMPTY_STRING),e.push(this.regionSource||S.EMPTY_STRING),e.push(this.regionOutcome||S.EMPTY_STRING),e.join(",")},r.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},r.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},r}();a();l();c();var Bc=function(){function r(e,t,o,i,n,s){this.authority=t,this.libraryName=i,this.libraryVersion=n,this.applicationTelemetry=s,this.clientId=e,this.logger=o,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return r.prototype.startPerformanceMeasurement=function(e,t){return{}},r.prototype.startPerformanceMeasuremeant=function(e,t){return{}},r.prototype.getIntFields=function(){return ug},r.prototype.getPreQueueTime=function(e,t){var o=this.preQueueTimeByCorrelationId.get(t);if(o){if(o.name!==e){this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement");return}}else{this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement");return}return o.time},r.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},r.prototype.addQueueMeasurement=function(e,t,o,i){if(!t){this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement");return}if(o===0)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+o);else if(!o){this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);return}var n={eventName:e,queueTime:o,manuallyCompleted:i},s=this.queueMeasurements.get(t);if(s)s.push(n),this.queueMeasurements.set(t,s);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var d=[n];this.queueMeasurements.set(t,d)}this.preQueueTimeByCorrelationId.delete(t)},r.prototype.startMeasurement=function(e,t){var o=this,i,n,s=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",s),this.logger.trace("PerformanceClient: Performance measurement started for "+e,s);var d=this.startPerformanceMeasuremeant(e,s);d.startMeasurement();var u={eventId:this.generateId(),status:ul.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:s,appName:(i=this.applicationTelemetry)===null||i===void 0?void 0:i.appName,appVersion:(n=this.applicationTelemetry)===null||n===void 0?void 0:n.appVersion};return this.cacheEventByCorrelationId(u),{endMeasurement:function(h){return o.endMeasurement(Xe(Xe({},u),h),d)},discardMeasurement:function(){return o.discardMeasurements(u.correlationId)},addStaticFields:function(h){return o.addStaticFields(h,u.correlationId)},increment:function(h){return o.increment(h,u.correlationId)},measurement:d,event:u}},r.prototype.endMeasurement=function(e,t){var o=this,i,n,s=this.eventsByCorrelationId.get(e.correlationId);if(!s)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var d=e.eventId===s.eventId,u={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};d?(u=this.getQueueInfo(e.correlationId),this.discardCache(s.correlationId)):(i=s.incompleteSubMeasurements)===null||i===void 0||i.delete(e.eventId),t?.endMeasurement();var h=t?.flushMeasurement();if(!h)return this.logger.trace("PerformanceClient: Performance measurement not taken",s.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+h+" ms",e.correlationId),!d)return s[e.name+"DurationMs"]=Math.floor(h),Xe({},s);var p=Xe(Xe({},s),e),v=0;return(n=p.incompleteSubMeasurements)===null||n===void 0||n.forEach(function(C){o.logger.trace("PerformanceClient: Incomplete submeasurement "+C.name+" found for "+e.name,p.correlationId),v++}),p.incompleteSubMeasurements=void 0,p=Xe(Xe({},p),{durationMs:Math.round(h),queuedTimeMs:u.totalQueueTime,queuedCount:u.totalQueueCount,queuedManuallyCompletedCount:u.manuallyCompletedCount,status:ul.Completed,incompleteSubsCount:v}),this.truncateIntegralFields(p,this.getIntFields()),this.emitEvents([p],e.correlationId),p},r.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var o=this.eventsByCorrelationId.get(t);o?this.eventsByCorrelationId.set(t,Xe(Xe({},o),e)):this.logger.trace("PerformanceClient: Event not found for",t)},r.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var o=this.eventsByCorrelationId.get(t);if(o)for(var i in e)o.hasOwnProperty(i)||(o[i]=0),o[i]+=e[i];else this.logger.trace("PerformanceClient: Event not found for",t)},r.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,Xe({},e)))},r.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var o=0,i=0,n=0;return t?.forEach(function(s){o+=s.queueTime,i++,n+=s.manuallyCompleted?1:0}),{totalQueueTime:o,totalQueueCount:i,manuallyCompletedCount:n}},r.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},r.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},r.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},r.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},r.prototype.emitEvents=function(e,t){var o=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach(function(i,n){o.logger.trace("PerformanceClient: Emitting event to callback "+n,t),i.apply(null,[e])})},r.prototype.truncateIntegralFields=function(e,t){t.forEach(function(o){o in e&&typeof e[o]=="number"&&(e[o]=Math.floor(e[o]))})},r}();a();l();c();var fw=function(){function r(){}return r.prototype.startMeasurement=function(){},r.prototype.endMeasurement=function(){},r.prototype.flushMeasurement=function(){return null},r}(),wg=function(r){ot(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.generateId=function(){return"callback-id"},e.prototype.startPerformanceMeasuremeant=function(){return new fw},e.prototype.startPerformanceMeasurement=function(){return new fw},e.prototype.calculateQueuedTime=function(t,o){return 0},e.prototype.addQueueMeasurement=function(t,o,i){},e.prototype.setPreQueueTime=function(t,o){},e}(Bc);a();l();c();var U={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},authCodeOrNativeAccountRequired:{code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},spaCodeAndNativeAccountPresent:{code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},unableToAcquireTokenFromNativePlatform:{code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},nativeHandshakeTimeout:{code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},nativeExtensionNotInstalled:{code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},nativeConnectionNotEstablished:{code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},nativeBrokerCalledBeforeInitialize:{code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},nativePromptNotSupported:{code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."}},H=function(r){ct(e,r);function e(t,o){var i=r.call(this,t,o)||this;return Object.setPrototypeOf(i,e.prototype),i.name="BrowserAuthError",i}return e.createPkceNotGeneratedError=function(t){return new e(U.pkceNotGenerated.code,U.pkceNotGenerated.desc+" Detail:"+t)},e.createCryptoNotAvailableError=function(t){return new e(U.cryptoDoesNotExist.code,U.cryptoDoesNotExist.desc+" Detail:"+t)},e.createHttpMethodNotImplementedError=function(t){return new e(U.httpMethodNotImplementedError.code,U.httpMethodNotImplementedError.desc+" Given Method: "+t)},e.createEmptyNavigationUriError=function(){return new e(U.emptyNavigateUriError.code,U.emptyNavigateUriError.desc)},e.createEmptyHashError=function(t){return new e(U.hashEmptyError.code,U.hashEmptyError.desc+" Given Url: "+t)},e.createHashDoesNotContainStateError=function(){return new e(U.hashDoesNotContainStateError.code,U.hashDoesNotContainStateError.desc)},e.createHashDoesNotContainKnownPropertiesError=function(){return new e(U.hashDoesNotContainKnownPropertiesError.code,U.hashDoesNotContainKnownPropertiesError.desc)},e.createUnableToParseStateError=function(){return new e(U.unableToParseStateError.code,U.unableToParseStateError.desc)},e.createStateInteractionTypeMismatchError=function(){return new e(U.stateInteractionTypeMismatchError.code,U.stateInteractionTypeMismatchError.desc)},e.createInteractionInProgressError=function(){return new e(U.interactionInProgress.code,U.interactionInProgress.desc)},e.createPopupWindowError=function(t){var o=U.popupWindowError.desc;return o=N.isEmpty(t)?o:o+" Details: "+t,new e(U.popupWindowError.code,o)},e.createEmptyWindowCreatedError=function(){return new e(U.emptyWindowError.code,U.emptyWindowError.desc)},e.createUserCancelledError=function(){return new e(U.userCancelledError.code,U.userCancelledError.desc)},e.createMonitorPopupTimeoutError=function(){return new e(U.monitorPopupTimeoutError.code,U.monitorPopupTimeoutError.desc)},e.createMonitorIframeTimeoutError=function(){return new e(U.monitorIframeTimeoutError.code,U.monitorIframeTimeoutError.desc)},e.createRedirectInIframeError=function(t){return new e(U.redirectInIframeError.code,U.redirectInIframeError.desc+" (window.parent !== window) => "+t)},e.createBlockReloadInHiddenIframeError=function(){return new e(U.blockTokenRequestsInHiddenIframeError.code,U.blockTokenRequestsInHiddenIframeError.desc)},e.createBlockAcquireTokenInPopupsError=function(){return new e(U.blockAcquireTokenInPopupsError.code,U.blockAcquireTokenInPopupsError.desc)},e.createIframeClosedPrematurelyError=function(){return new e(U.iframeClosedPrematurelyError.code,U.iframeClosedPrematurelyError.desc)},e.createSilentLogoutUnsupportedError=function(){return new e(U.silentLogoutUnsupportedError.code,U.silentLogoutUnsupportedError.desc)},e.createNoAccountError=function(){return new e(U.noAccountError.code,U.noAccountError.desc)},e.createSilentPromptValueError=function(t){return new e(U.silentPromptValueError.code,U.silentPromptValueError.desc+" Given value: "+t)},e.createUnableToParseTokenRequestCacheError=function(){return new e(U.unableToParseTokenRequestCacheError.code,U.unableToParseTokenRequestCacheError.desc)},e.createNoTokenRequestCacheError=function(){return new e(U.noTokenRequestCacheError.code,U.noTokenRequestCacheError.desc)},e.createAuthRequestNotSetError=function(){return new e(U.authRequestNotSet.code,U.authRequestNotSet.desc)},e.createNoCachedAuthorityError=function(){return new e(U.noCachedAuthorityError.code,U.noCachedAuthorityError.desc)},e.createInvalidCacheTypeError=function(){return new e(U.invalidCacheType.code,""+U.invalidCacheType.desc)},e.createNonBrowserEnvironmentError=function(){return new e(U.notInBrowserEnvironment.code,U.notInBrowserEnvironment.desc)},e.createDatabaseNotOpenError=function(){return new e(U.databaseNotOpen.code,U.databaseNotOpen.desc)},e.createNoNetworkConnectivityError=function(){return new e(U.noNetworkConnectivity.code,U.noNetworkConnectivity.desc)},e.createPostRequestFailedError=function(t,o){return new e(U.postRequestFailed.code,U.postRequestFailed.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},e.createGetRequestFailedError=function(t,o){return new e(U.getRequestFailed.code,U.getRequestFailed.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},e.createFailedToParseNetworkResponseError=function(t){return new e(U.failedToParseNetworkResponse.code,U.failedToParseNetworkResponse.desc+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToLoadTokenError=function(t){return new e(U.unableToLoadTokenError.code,U.unableToLoadTokenError.desc+" | "+t)},e.createSigningKeyNotFoundInStorageError=function(t){return new e(U.signingKeyNotFoundInStorage.code,U.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+t)},e.createAuthCodeRequiredError=function(){return new e(U.authCodeRequired.code,U.authCodeRequired.desc)},e.createAuthCodeOrNativeAccountIdRequiredError=function(){return new e(U.authCodeOrNativeAccountRequired.code,U.authCodeOrNativeAccountRequired.desc)},e.createSpaCodeAndNativeAccountIdPresentError=function(){return new e(U.spaCodeAndNativeAccountPresent.code,U.spaCodeAndNativeAccountPresent.desc)},e.createDatabaseUnavailableError=function(){return new e(U.databaseUnavailable.code,U.databaseUnavailable.desc)},e.createUnableToAcquireTokenFromNativePlatformError=function(){return new e(U.unableToAcquireTokenFromNativePlatform.code,U.unableToAcquireTokenFromNativePlatform.desc)},e.createNativeHandshakeTimeoutError=function(){return new e(U.nativeHandshakeTimeout.code,U.nativeHandshakeTimeout.desc)},e.createNativeExtensionNotInstalledError=function(){return new e(U.nativeExtensionNotInstalled.code,U.nativeExtensionNotInstalled.desc)},e.createNativeConnectionNotEstablishedError=function(){return new e(U.nativeConnectionNotEstablished.code,U.nativeConnectionNotEstablished.desc)},e.createNativeBrokerCalledBeforeInitialize=function(){return new e(U.nativeBrokerCalledBeforeInitialize.code,U.nativeBrokerCalledBeforeInitialize.desc)},e.createNativePromptParameterNotSupportedError=function(){return new e(U.nativePromptNotSupported.code,U.nativePromptNotSupported.desc)},e}(Y);a();l();c();var Sr={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},la={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},vi;(function(r){r.HandshakeRequest="Handshake",r.HandshakeResponse="HandshakeResponse",r.GetToken="GetToken",r.Response="Response"})(vi||(vi={}));var $t;(function(r){r.LocalStorage="localStorage",r.SessionStorage="sessionStorage",r.MemoryStorage="memoryStorage"})($t||($t={}));var Go;(function(r){r.GET="GET",r.POST="POST"})(Go||(Go={}));var We;(function(r){r.AUTHORITY="authority",r.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",r.SESSION_STATE="session.state",r.REQUEST_STATE="request.state",r.NONCE_IDTOKEN="nonce.id_token",r.ORIGIN_URI="request.origin",r.RENEW_STATUS="token.renew.status",r.URL_HASH="urlHash",r.REQUEST_PARAMS="request.params",r.SCOPES="scopes",r.INTERACTION_STATUS_KEY="interaction.status",r.CCS_CREDENTIAL="ccs.credential",r.CORRELATION_ID="request.correlationId",r.NATIVE_REQUEST="request.native",r.REDIRECT_CONTEXT="request.redirect.context"})(We||(We={}));var yi;(function(r){r.ACCOUNT_KEYS="msal.account.keys",r.TOKEN_KEYS="msal.token.keys"})(yi||(yi={}));var aa;(function(r){r.WRAPPER_SKU="wrapper.sku",r.WRAPPER_VER="wrapper.version"})(aa||(aa={}));var nt;(function(r){r[r.acquireTokenRedirect=861]="acquireTokenRedirect",r[r.acquireTokenPopup=862]="acquireTokenPopup",r[r.ssoSilent=863]="ssoSilent",r[r.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",r[r.handleRedirectPromise=865]="handleRedirectPromise",r[r.acquireTokenByCode=866]="acquireTokenByCode",r[r.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",r[r.logout=961]="logout",r[r.logoutPopup=962]="logoutPopup"})(nt||(nt={}));var X;(function(r){r.Redirect="redirect",r.Popup="popup",r.Silent="silent",r.None="none"})(X||(X={}));var xr;(function(r){r.Startup="startup",r.Login="login",r.Logout="logout",r.AcquireToken="acquireToken",r.SsoSilent="ssoSilent",r.HandleRedirect="handleRedirect",r.None="none"})(xr||(xr={}));var Sg={scopes:gi},bn="jwk",xg;(function(r){r.React="@azure/msal-react",r.Angular="@azure/msal-angular"})(xg||(xg={}));var ph="msal.db",mw=1,gw=ph+".keys",Dr;(function(r){r[r.Default=0]="Default",r[r.AccessToken=1]="AccessToken",r[r.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",r[r.RefreshToken=3]="RefreshToken",r[r.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",r[r.Skip=5]="Skip"})(Dr||(Dr={}));a();l();c();a();l();c();var io={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}},Cn=function(r){ct(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="BrowserConfigurationAuthError",Object.setPrototypeOf(i,e.prototype),i}return e.createRedirectUriEmptyError=function(){return new e(io.redirectUriNotSet.code,io.redirectUriNotSet.desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(io.postLogoutUriNotSet.code,io.postLogoutUriNotSet.desc)},e.createStorageNotSupportedError=function(t){return new e(io.storageNotSupportedError.code,io.storageNotSupportedError.desc+" Given Location: "+t)},e.createRedirectCallbacksNotSetError=function(){return new e(io.noRedirectCallbacksSet.code,io.noRedirectCallbacksSet.desc)},e.createStubPcaInstanceCalledError=function(){return new e(io.stubPcaInstanceCalled.code,io.stubPcaInstanceCalled.desc)},e.createInMemoryRedirectUnavailableError=function(){return new e(io.inMemRedirectUnavailable.code,io.inMemRedirectUnavailable.desc)},e.createEntropyNotProvided=function(){return new e(io.entropyNotProvided.code,io.entropyNotProvided.desc)},e}(Y);var _g=function(){function r(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return r.prototype.validateWindowStorage=function(e){if(e!==$t.LocalStorage&&e!==$t.SessionStorage)throw Cn.createStorageNotSupportedError(e);var t=!!window[e];if(!t)throw Cn.createStorageNotSupportedError(e)},r.prototype.getItem=function(e){return this.windowStorage.getItem(e)},r.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},r.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},r.prototype.getKeys=function(){return Object.keys(this.windowStorage)},r.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},r}();a();l();c();var Vc=function(){function r(){this.cache=new Map}return r.prototype.getItem=function(e){return this.cache.get(e)||null},r.prototype.setItem=function(e,t){this.cache.set(e,t)},r.prototype.removeItem=function(e){this.cache.delete(e)},r.prototype.getKeys=function(){var e=[];return this.cache.forEach(function(t,o){e.push(o)}),e},r.prototype.containsKey=function(e){return this.cache.has(e)},r.prototype.clear=function(){this.cache.clear()},r}();a();l();c();var fh=function(){function r(){}return r.extractBrowserRequestState=function(e,t){if(N.isEmpty(t))return null;try{var o=Mr.parseRequestState(e,t);return o.libraryState.meta}catch(i){throw L.createInvalidStateError(t,i)}},r.parseServerResponseFromHash=function(e){if(!e)return{};var t=new ge(e);return ge.getDeserializedHash(t.getHash())},r}();var zc=function(r){ct(e,r);function e(t,o,i,n){var s=r.call(this,t,i,n)||this;return s.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,s.cacheConfig=o,s.logger=n,s.internalStorage=new Vc,s.browserStorage=s.setupBrowserStorage(s.cacheConfig.cacheLocation),s.temporaryCacheStorage=s.setupTemporaryCacheStorage(s.cacheConfig.temporaryCacheLocation,s.cacheConfig.cacheLocation),o.cacheMigrationEnabled&&(s.migrateCacheEntries(),s.createKeyMaps()),s}return e.prototype.setupBrowserStorage=function(t){switch(t){case $t.LocalStorage:case $t.SessionStorage:try{return new _g(t)}catch(o){this.logger.verbose(o);break}}return this.cacheConfig.cacheLocation=$t.MemoryStorage,new Vc},e.prototype.setupTemporaryCacheStorage=function(t,o){switch(o){case $t.LocalStorage:case $t.SessionStorage:try{return new _g(t||$t.SessionStorage)}catch(i){return this.logger.verbose(i),this.internalStorage}case $t.MemoryStorage:default:return this.internalStorage}},e.prototype.migrateCacheEntries=function(){var t=this,o=S.CACHE_PREFIX+"."+tr.ID_TOKEN,i=S.CACHE_PREFIX+"."+tr.CLIENT_INFO,n=S.CACHE_PREFIX+"."+tr.ERROR,s=S.CACHE_PREFIX+"."+tr.ERROR_DESC,d=this.browserStorage.getItem(o),u=this.browserStorage.getItem(i),h=this.browserStorage.getItem(n),p=this.browserStorage.getItem(s),v=[d,u,h,p],C=[tr.ID_TOKEN,tr.CLIENT_INFO,tr.ERROR,tr.ERROR_DESC];C.forEach(function(x,E){return t.migrateCacheEntry(x,v[E])})},e.prototype.migrateCacheEntry=function(t,o){o&&this.setTemporaryCache(t,o,!0)},e.prototype.createKeyMaps=function(){var t=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var o=this.getItem(yi.ACCOUNT_KEYS),i=this.getItem(yi.TOKEN_KEYS+"."+this.clientId);if(o&&i){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}var n=this.browserStorage.getKeys();n.forEach(function(s){if(t.isCredentialKey(s)){var d=t.getItem(s);if(d){var u=t.validateAndParseJson(d);if(u&&u.hasOwnProperty("credentialType"))switch(u.credentialType){case ae.ID_TOKEN:if(zo.isIdTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+s+" found, saving key to token key map");var h=Or.toObject(new zo,u),p=t.updateCredentialCacheKey(s,h);t.addTokenKey(p,ae.ID_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+s);break;case ae.ACCESS_TOKEN:case ae.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(qo.isAccessTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+s+" found, saving key to token key map");var v=Or.toObject(new qo,u),p=t.updateCredentialCacheKey(s,v);t.addTokenKey(p,ae.ACCESS_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+s);break;case ae.REFRESH_TOKEN:if(Di.isRefreshTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+s+" found, saving key to token key map");var C=Or.toObject(new Di,u),p=t.updateCredentialCacheKey(s,C);t.addTokenKey(p,ae.REFRESH_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+s);break}}}if(t.isAccountKey(s)){var d=t.getItem(s);if(d){var x=t.validateAndParseJson(d);x&&At.isAccountEntity(x)&&(t.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+s+" found, saving key to account key map"),t.addAccountKeyToMap(s))}}})},e.prototype.validateAndParseJson=function(t){try{var o=JSON.parse(t);return o&&typeof o=="object"?o:null}catch{return null}},e.prototype.getItem=function(t){return this.browserStorage.getItem(t)},e.prototype.setItem=function(t,o){this.browserStorage.setItem(t,o)},e.prototype.getAccount=function(t){this.logger.trace("BrowserCacheManager.getAccount called");var o=this.getItem(t);if(!o)return this.removeAccountKeyFromMap(t),null;var i=this.validateAndParseJson(o);return!i||!At.isAccountEntity(i)?(this.removeAccountKeyFromMap(t),null):Or.toObject(new At,i)},e.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var o=t.generateAccountKey();this.setItem(o,JSON.stringify(t)),this.addAccountKeyToMap(o)},e.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var t=this.getItem(yi.ACCOUNT_KEYS);return t?JSON.parse(t):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},e.prototype.addAccountKeyToMap=function(t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+t);var o=this.getAccountKeys();o.indexOf(t)===-1?(o.push(t),this.setItem(yi.ACCOUNT_KEYS,JSON.stringify(o)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},e.prototype.removeAccountKeyFromMap=function(t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+t);var o=this.getAccountKeys(),i=o.indexOf(t);i>-1?(o.splice(i,1),this.setItem(yi.ACCOUNT_KEYS,JSON.stringify(o)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},e.prototype.removeAccount=function(t){return $(this,void 0,void 0,function(){return M(this,function(o){return r.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]})})},e.prototype.removeIdToken=function(t){r.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,ae.ID_TOKEN)},e.prototype.removeAccessToken=function(t){return $(this,void 0,void 0,function(){return M(this,function(o){return r.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,ae.ACCESS_TOKEN),[2]})})},e.prototype.removeRefreshToken=function(t){r.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,ae.REFRESH_TOKEN)},e.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var t=this.getItem(yi.TOKEN_KEYS+"."+this.clientId);if(t){var o=this.validateAndParseJson(t);if(o&&o.hasOwnProperty("idToken")&&o.hasOwnProperty("accessToken")&&o.hasOwnProperty("refreshToken"))return o;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},e.prototype.addTokenKey=function(t,o){this.logger.trace("BrowserCacheManager addTokenKey called");var i=this.getTokenKeys();switch(o){case ae.ID_TOKEN:i.idToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),i.idToken.push(t));break;case ae.ACCESS_TOKEN:i.accessToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),i.accessToken.push(t));break;case ae.REFRESH_TOKEN:i.refreshToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),i.refreshToken.push(t));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+o),L.createUnexpectedCredentialTypeError()}this.setItem(yi.TOKEN_KEYS+"."+this.clientId,JSON.stringify(i))},e.prototype.removeTokenKey=function(t,o){this.logger.trace("BrowserCacheManager removeTokenKey called");var i=this.getTokenKeys();switch(o){case ae.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+t+" from map");var n=i.idToken.indexOf(t);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),i.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case ae.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+t+" from map");var s=i.accessToken.indexOf(t);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),i.accessToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case ae.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+t+" from map");var d=i.refreshToken.indexOf(t);d>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),i.refreshToken.splice(d,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+o),L.createUnexpectedCredentialTypeError()}this.setItem(yi.TOKEN_KEYS+"."+this.clientId,JSON.stringify(i))},e.prototype.getIdTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,ae.ID_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!zo.isIdTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,ae.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Or.toObject(new zo,i))},e.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,ae.ID_TOKEN)},e.prototype.getAccessTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,ae.ACCESS_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!qo.isAccessTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,ae.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Or.toObject(new qo,i))},e.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,ae.ACCESS_TOKEN)},e.prototype.getRefreshTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,ae.REFRESH_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!Di.isRefreshTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,ae.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Or.toObject(new Di,i))},e.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,ae.REFRESH_TOKEN)},e.prototype.getAppMetadata=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!hl.isAppMetadataEntity(t,i)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Or.toObject(new hl,i))},e.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var o=t.generateAppMetadataKey();this.setItem(o,JSON.stringify(t))},e.prototype.getServerTelemetry=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!sa.isServerTelemetryEntity(t,i)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Or.toObject(new sa,i))},e.prototype.setServerTelemetry=function(t,o){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(o))},e.prototype.getAuthorityMetadata=function(t){var o=this.internalStorage.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var i=this.validateAndParseJson(o);return i&&pl.isAuthorityMetadataEntity(t,i)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Or.toObject(new pl,i)):null},e.prototype.getAuthorityMetadataKeys=function(){var t=this,o=this.internalStorage.getKeys();return o.filter(function(i){return t.isAuthorityMetadata(i)})},e.prototype.setWrapperMetadata=function(t,o){this.internalStorage.setItem(aa.WRAPPER_SKU,t),this.internalStorage.setItem(aa.WRAPPER_VER,o)},e.prototype.getWrapperMetadata=function(){var t=this.internalStorage.getItem(aa.WRAPPER_SKU)||S.EMPTY_STRING,o=this.internalStorage.getItem(aa.WRAPPER_VER)||S.EMPTY_STRING;return[t,o]},e.prototype.setAuthorityMetadata=function(t,o){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(o))},e.prototype.getActiveAccount=function(){var t=this.generateCacheKey(tr.ACTIVE_ACCOUNT_FILTERS),o=this.getItem(t);if(!o){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var i=this.generateCacheKey(tr.ACTIVE_ACCOUNT),n=this.getItem(i);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var s=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}var d=this.validateAndParseJson(o);return d?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:d.homeAccountId,localAccountId:d.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},e.prototype.setActiveAccount=function(t){var o=this.generateCacheKey(tr.ACTIVE_ACCOUNT_FILTERS),i=this.generateCacheKey(tr.ACTIVE_ACCOUNT);if(t){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:t.homeAccountId,localAccountId:t.localAccountId};this.browserStorage.setItem(o,JSON.stringify(n)),this.browserStorage.setItem(i,t.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(o),this.browserStorage.removeItem(i)},e.prototype.getAccountInfoByFilter=function(t){var o=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+o.length+" accounts found"),o.filter(function(i){return!(t.username&&t.username.toLowerCase()!==i.username.toLowerCase()||t.homeAccountId&&t.homeAccountId!==i.homeAccountId||t.localAccountId&&t.localAccountId!==i.localAccountId||t.tenantId&&t.tenantId!==i.tenantId||t.environment&&t.environment!==i.environment)})},e.prototype.getAccountInfoByHints=function(t,o){var i=this.getAllAccounts().filter(function(n){if(o){var s=n.idTokenClaims&&n.idTokenClaims.sid;return o===s}return t?t===n.username:!1});if(i.length===1)return i[0];if(i.length>1)throw L.createMultipleMatchingAccountsInCacheError();return null},e.prototype.getThrottlingCache=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!uh.isThrottlingEntity(t,i)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Or.toObject(new uh,i))},e.prototype.setThrottlingCache=function(t,o){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(o))},e.prototype.getTemporaryCache=function(t,o){var i=o?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(i);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var s=this.temporaryCacheStorage.getItem(i);if(!s){if(this.cacheConfig.cacheLocation===$t.LocalStorage){var d=this.browserStorage.getItem(i);if(d)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),d}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s},e.prototype.setTemporaryCache=function(t,o,i){var n=i?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(n,o),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,o))},e.prototype.removeItem=function(t){this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t))},e.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},e.prototype.getKeys=function(){return al(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},e.prototype.clear=function(){return $(this,void 0,void 0,function(){var t=this;return M(this,function(o){switch(o.label){case 0:return[4,this.removeAllAccounts()];case 1:return o.sent(),this.removeAppMetadata(),this.getKeys().forEach(function(i){(t.browserStorage.containsKey(i)||t.temporaryCacheStorage.containsKey(i))&&(i.indexOf(S.CACHE_PREFIX)!==-1||i.indexOf(t.clientId)!==-1)&&t.removeItem(i)}),this.internalStorage.clear(),[2]}})})},e.prototype.clearTokensAndKeysWithClaims=function(){return $(this,void 0,void 0,function(){var t,o,i=this;return M(this,function(n){switch(n.label){case 0:return this.logger.trace("BrowserCacheManager.clearTokensAndKeysWithClaims called"),t=this.getTokenKeys(),o=[],t.accessToken.forEach(function(s){var d=i.getAccessTokenCredential(s);d?.requestedClaimsHash&&s.includes(d.requestedClaimsHash.toLowerCase())&&o.push(i.removeAccessToken(s))}),[4,Promise.all(o)];case 1:return n.sent(),o.length>0&&this.logger.warning(o.length+" access tokens with claims in the cache keys have been removed from the cache."),[2]}})})},e.prototype.setItemCookie=function(t,o,i){var n=encodeURIComponent(t)+"="+encodeURIComponent(o)+";path=/;SameSite=Lax;";if(i){var s=this.getCookieExpirationTime(i);n+="expires="+s+";"}this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},e.prototype.getItemCookie=function(t){for(var o=encodeURIComponent(t)+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var s=i[n];s.charAt(0)===" ";)s=s.substring(1);if(s.indexOf(o)===0)return decodeURIComponent(s.substring(o.length,s.length))}return S.EMPTY_STRING},e.prototype.clearMsalCookies=function(){var t=this,o=S.CACHE_PREFIX+"."+this.clientId,i=document.cookie.split(";");i.forEach(function(n){for(;n.charAt(0)===" ";)n=n.substring(1);if(n.indexOf(o)===0){var s=n.split("=")[0];t.clearItemCookie(s)}})},e.prototype.clearItemCookie=function(t){this.setItemCookie(t,S.EMPTY_STRING,-1)},e.prototype.getCookieExpirationTime=function(t){var o=new Date,i=new Date(o.getTime()+t*this.COOKIE_LIFE_MULTIPLIER);return i.toUTCString()},e.prototype.getCache=function(){return this.browserStorage},e.prototype.setCache=function(){},e.prototype.generateCacheKey=function(t){var o=this.validateAndParseJson(t);return o?JSON.stringify(t):N.startsWith(t,S.CACHE_PREFIX)||N.startsWith(t,tr.ADAL_ID_TOKEN)?t:S.CACHE_PREFIX+"."+this.clientId+"."+t},e.prototype.generateAuthorityKey=function(t){var o=Mr.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(We.AUTHORITY+"."+o)},e.prototype.generateNonceKey=function(t){var o=Mr.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(We.NONCE_IDTOKEN+"."+o)},e.prototype.generateStateKey=function(t){var o=Mr.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(We.REQUEST_STATE+"."+o)},e.prototype.getCachedAuthority=function(t){var o=this.generateStateKey(t),i=this.getTemporaryCache(o);if(!i)return null;var n=this.generateAuthorityKey(i);return this.getTemporaryCache(n)},e.prototype.updateCacheEntries=function(t,o,i,n,s){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var d=this.generateStateKey(t);this.setTemporaryCache(d,t,!1);var u=this.generateNonceKey(t);this.setTemporaryCache(u,o,!1);var h=this.generateAuthorityKey(t);if(this.setTemporaryCache(h,i,!1),s){var p={credential:s.homeAccountId,type:sr.HOME_ACCOUNT_ID};this.setTemporaryCache(We.CCS_CREDENTIAL,JSON.stringify(p),!0)}else if(!N.isEmpty(n)){var p={credential:n,type:sr.UPN};this.setTemporaryCache(We.CCS_CREDENTIAL,JSON.stringify(p),!0)}},e.prototype.resetRequestCache=function(t){var o=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),N.isEmpty(t)||this.getKeys().forEach(function(i){i.indexOf(t)!==-1&&o.removeItem(i)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(We.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(We.ORIGIN_URI)),this.removeItem(this.generateCacheKey(We.URL_HASH)),this.removeItem(this.generateCacheKey(We.CORRELATION_ID)),this.removeItem(this.generateCacheKey(We.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(We.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},e.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var o=this.generateStateKey(t),i=this.temporaryCacheStorage.getItem(o);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+i),this.resetRequestCache(i||S.EMPTY_STRING)}this.clearMsalCookies()},e.prototype.cleanRequestByInteractionType=function(t){var o=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(i){if(i.indexOf(We.REQUEST_STATE)!==-1){var n=o.temporaryCacheStorage.getItem(i);if(n){var s=fh.extractBrowserRequestState(o.cryptoImpl,n);s&&s.interactionType===t&&(o.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),o.resetRequestCache(n))}}}),this.clearMsalCookies(),this.setInteractionInProgress(!1)},e.prototype.cacheCodeRequest=function(t,o){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var i=o.base64Encode(JSON.stringify(t));this.setTemporaryCache(We.REQUEST_PARAMS,i,!0)},e.prototype.getCachedRequest=function(t,o){this.logger.trace("BrowserCacheManager.getCachedRequest called");var i=this.getTemporaryCache(We.REQUEST_PARAMS,!0);if(!i)throw H.createNoTokenRequestCacheError();var n=this.validateAndParseJson(o.base64Decode(i));if(!n)throw H.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(We.REQUEST_PARAMS)),N.isEmpty(n.authority)){var s=this.generateAuthorityKey(t),d=this.getTemporaryCache(s);if(!d)throw H.createNoCachedAuthorityError();n.authority=d}return n},e.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var t=this.getTemporaryCache(We.NATIVE_REQUEST,!0);if(!t)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var o=this.validateAndParseJson(t);return o||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},e.prototype.isInteractionInProgress=function(t){var o=this.getInteractionInProgress();return t?o===this.clientId:!!o},e.prototype.getInteractionInProgress=function(){var t=S.CACHE_PREFIX+"."+We.INTERACTION_STATUS_KEY;return this.getTemporaryCache(t,!1)},e.prototype.setInteractionInProgress=function(t){var o=S.CACHE_PREFIX+"."+We.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw H.createInteractionInProgressError();this.setTemporaryCache(o,this.clientId,!1)}else!t&&this.getInteractionInProgress()===this.clientId&&this.removeItem(o)},e.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(tr.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(tr.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var o=this.getTemporaryCache(tr.ID_TOKEN,!0);o&&(this.removeItem(this.generateCacheKey(tr.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var i=o||t;if(i){var n=new rr(i,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},e.prototype.updateCredentialCacheKey=function(t,o){var i=o.generateCredentialKey();if(t!==i){var n=this.getItem(t);if(n)return this.removeItem(t),this.setItem(i,n),this.logger.verbose("Updated an outdated "+o.credentialType+" cache key"),i;this.logger.error("Attempted to update an outdated "+o.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},e.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(We.REDIRECT_CONTEXT,!0)},e.prototype.setRedirectRequestContext=function(t){this.setTemporaryCache(We.REDIRECT_CONTEXT,t,!0)},e}(Or),vw=function(r,e){var t={cacheLocation:$t.MemoryStorage,temporaryCacheLocation:$t.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};return new zc(r,t,Qn,e)};a();l();c();a();l();c();a();l();c();var fl="@azure/msal-browser",bi="2.38.3";a();l();c();a();l();c();var yw=function(){function r(){}return r.prototype.sendGetRequestAsync=function(e,t){return $(this,void 0,void 0,function(){var o,i,n;return M(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,fetch(e,{method:Go.GET,headers:this.getFetchHeaders(t)})];case 1:return o=s.sent(),[3,3];case 2:throw i=s.sent(),window.navigator.onLine?H.createGetRequestFailedError(i,e):H.createNoNetworkConnectivityError();case 3:return s.trys.push([3,5,,6]),n={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 4:return[2,(n.body=s.sent(),n.status=o.status,n)];case 5:throw s.sent(),H.createFailedToParseNetworkResponseError(e);case 6:return[2]}})})},r.prototype.sendPostRequestAsync=function(e,t){return $(this,void 0,void 0,function(){var o,i,n,s;return M(this,function(d){switch(d.label){case 0:o=t&&t.body||S.EMPTY_STRING,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,fetch(e,{method:Go.POST,headers:this.getFetchHeaders(t),body:o})];case 2:return i=d.sent(),[3,4];case 3:throw n=d.sent(),window.navigator.onLine?H.createPostRequestFailedError(n,e):H.createNoNetworkConnectivityError();case 4:return d.trys.push([4,6,,7]),s={headers:this.getHeaderDict(i.headers)},[4,i.json()];case 5:return[2,(s.body=d.sent(),s.status=i.status,s)];case 6:throw d.sent(),H.createFailedToParseNetworkResponseError(e);case 7:return[2]}})})},r.prototype.getFetchHeaders=function(e){var t=new Headers;if(!(e&&e.headers))return t;var o=e.headers;return Object.keys(o).forEach(function(i){t.append(i,o[i])}),t},r.prototype.getHeaderDict=function(e){var t={};return e.forEach(function(o,i){t[i]=o}),t},r}();a();l();c();var bw=function(){function r(){}return r.prototype.sendGetRequestAsync=function(e,t){return $(this,void 0,void 0,function(){return M(this,function(o){return[2,this.sendRequestAsync(e,Go.GET,t)]})})},r.prototype.sendPostRequestAsync=function(e,t){return $(this,void 0,void 0,function(){return M(this,function(o){return[2,this.sendRequestAsync(e,Go.POST,t)]})})},r.prototype.sendRequestAsync=function(e,t,o){var i=this;return new Promise(function(n,s){var d=new XMLHttpRequest;if(d.open(t,e,!0),i.setXhrHeaders(d,o),d.onload=function(){(d.status<200||d.status>=300)&&(t===Go.POST?s(H.createPostRequestFailedError("Failed with status "+d.status,e)):s(H.createGetRequestFailedError("Failed with status "+d.status,e)));try{var u=JSON.parse(d.responseText),h={headers:i.getHeaderDict(d),body:u,status:d.status};n(h)}catch{s(H.createFailedToParseNetworkResponseError(e))}},d.onerror=function(){window.navigator.onLine?t===Go.POST?s(H.createPostRequestFailedError("Failed with status "+d.status,e)):s(H.createGetRequestFailedError("Failed with status "+d.status,e)):s(H.createNoNetworkConnectivityError())},t===Go.POST&&o&&o.body)d.send(o.body);else if(t===Go.GET)d.send();else throw H.createHttpMethodNotImplementedError(t)})},r.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var o=t.headers;Object.keys(o).forEach(function(i){e.setRequestHeader(i,o[i])})}},r.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders(),o=t.trim().split(/[\r\n]+/),i={};return o.forEach(function(n){var s=n.split(": "),d=s.shift(),u=s.join(": ");d&&u&&(i[d]=u)}),i},r}();var ft=function(){function r(){}return r.clearHash=function(e){e.location.hash=S.EMPTY_STRING,typeof e.history.replaceState=="function"&&e.history.replaceState(null,S.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},r.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):S.EMPTY_STRING},r.isInIframe=function(){return window.parent!==window},r.isInPopup=function(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(Sr.POPUP_NAME_PREFIX+".")===0},r.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},r.getHomepage=function(){var e=new ge(window.location.href),t=e.getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},r.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new yw:new bw},r.blockReloadInHiddenIframes=function(){var e=ge.hashContainsKnownProperties(window.location.hash);if(e&&r.isInIframe())throw H.createBlockReloadInHiddenIframeError()},r.blockRedirectInIframe=function(e,t){var o=r.isInIframe();if(e===X.Redirect&&o&&!t)throw H.createRedirectInIframeError(o)},r.blockAcquireTokenInPopups=function(){if(r.isInPopup())throw H.createBlockAcquireTokenInPopupsError()},r.blockNonBrowserEnvironment=function(e){if(!e)throw H.createNonBrowserEnvironmentError()},r.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw H.createNativeBrokerCalledBeforeInitialize()},r.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),o=e.indexOf("Trident/"),i=e.indexOf("Edge/"),n=t>0||o>0,s=i>0;return n||s},r}();var mh=function(){function r(e,t,o,i,n,s,d,u,h){this.config=e,this.browserStorage=t,this.browserCrypto=o,this.networkClient=this.config.system.networkClient,this.eventHandler=n,this.navigationClient=s,this.nativeMessageHandler=u,this.correlationId=h||this.browserCrypto.createNewGuid(),this.logger=i.clone(Sr.MSAL_SKU,bi,this.correlationId),this.performanceClient=d}return r.prototype.clearCacheOnLogout=function(e){return $(this,void 0,void 0,function(){return M(this,function(t){switch(t.label){case 0:if(!e)return[3,5];At.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(At.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}})})},r.prototype.initializeBaseRequest=function(e,t){return $(this,void 0,void 0,function(){var o,i,n,s;return M(this,function(d){switch(d.label){case 0:return this.performanceClient.addQueueMeasurement(A.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),o=e.authority||this.config.auth.authority,t?[4,this.validateRequestAuthority(o,t)]:[3,2];case 1:d.sent(),d.label=2;case 2:if(i=al(e&&e.scopes||[]),n=te(te({},e),{correlationId:this.correlationId,authority:o,scopes:i}),!n.authenticationScheme)n.authenticationScheme=Ne.BEARER,this.logger.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(n.authenticationScheme===Ne.SSH){if(!e.sshJwk)throw Ge.createMissingSshJwkError();if(!e.sshKid)throw Ge.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+n.authenticationScheme+'" as configured in Auth request')}return this.config.cache.claimsBasedCachingEnabled&&e.claims&&!N.isEmptyObj(e.claims)?(s=n,[4,this.browserCrypto.hashString(e.claims)]):[3,4];case 3:s.requestedClaimsHash=d.sent(),d.label=4;case 4:return[2,n]}})})},r.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||ft.getCurrentUri();return ge.getAbsoluteUrl(t,ft.getCurrentUri())},r.prototype.validateRequestAuthority=function(e,t){return $(this,void 0,void 0,function(){var o;return M(this,function(i){switch(i.label){case 0:return[4,this.getDiscoveredAuthority(e)];case 1:if(o=i.sent(),!o.isAlias(t.environment))throw Ge.createAuthorityMismatchError();return[2]}})})},r.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var o={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Cg(o,this.browserStorage)},r.prototype.getDiscoveredAuthority=function(e){return $(this,void 0,void 0,function(){var t;return M(this,function(o){switch(o.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,Jn.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:return[2,o.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,Jn.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)];case 3:return[2,o.sent()]}})})},r}();var Oo=function(r){ct(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.initializeAuthorizationCodeRequest=function(t){return $(this,void 0,void 0,function(){var o,i;return M(this,function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(A.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return o=n.sent(),i=te(te({},t),{redirectUri:t.redirectUri,code:S.EMPTY_STRING,codeVerifier:o.verifier}),t.codeChallenge=o.challenge,t.codeChallengeMethod=S.S256_CODE_CHALLENGE_METHOD,[2,i]}})})},e.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",t?.correlationId);var o=te({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var i=this.getLogoutHintFromIdTokenClaims(t.account);i&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),o.logoutHint=i)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!t||t.postLogoutRedirectUri!==null?t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",o.correlationId),o.postLogoutRedirectUri=ge.getAbsoluteUrl(t.postLogoutRedirectUri,ft.getCurrentUri())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",o.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",o.correlationId),o.postLogoutRedirectUri=ge.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ft.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",o.correlationId),o.postLogoutRedirectUri=ge.getAbsoluteUrl(ft.getCurrentUri(),ft.getCurrentUri())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",o.correlationId),o},e.prototype.getLogoutHintFromIdTokenClaims=function(t){var o=t.idTokenClaims;if(o){if(o.login_hint)return o.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},e.prototype.createAuthCodeClient=function(t,o,i){return $(this,void 0,void 0,function(){var n;return M(this,function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(A.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(A.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new Hc(n,this.performanceClient)]}})})},e.prototype.getClientConfiguration=function(t,o,i){return $(this,void 0,void 0,function(){var n,s;return M(this,function(d){switch(d.label){case 0:return this.performanceClient.addQueueMeasurement(A.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(A.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(o,i)];case 1:return n=d.sent(),s=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Sr.MSAL_SKU,version:bi,cpu:S.EMPTY_STRING,os:S.EMPTY_STRING},telemetry:this.config.telemetry}]}})})},e.prototype.validateAndExtractStateFromHash=function(t,o,i){if(this.logger.verbose("validateAndExtractStateFromHash called",i),!t.state)throw H.createHashDoesNotContainStateError();var n=fh.extractBrowserRequestState(this.browserCrypto,t.state);if(!n)throw H.createUnableToParseStateError();if(n.interactionType!==o)throw H.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",i),t.state},e.prototype.getDiscoveredAuthority=function(t,o){var i;return $(this,void 0,void 0,function(){var n,s,d,u;return M(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(A.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement(A.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},d=t||this.config.auth.authority,u=yn.generateAuthority(d,o||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(A.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,Jn.createDiscoveredInstance(u,this.config.system.networkClient,this.browserStorage,s,this.logger,this.performanceClient,this.correlationId).then(function(p){return n.endMeasurement({success:!0}),p}).catch(function(p){throw n.endMeasurement({errorCode:p.errorCode,subErrorCode:p.subError,success:!1}),p})];case 1:return[2,h.sent()]}})})},e.prototype.initializeAuthorizationRequest=function(t,o){return $(this,void 0,void 0,function(){var i,n,s,d,u,h,p;return M(this,function(v){switch(v.label){case 0:return this.performanceClient.addQueueMeasurement(A.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),i=this.getRedirectUri(t.redirectUri),n={interactionType:o},s=Mr.setRequestState(this.browserCrypto,t&&t.state||S.EMPTY_STRING,n),this.performanceClient.setPreQueueTime(A.InitializeBaseRequest,this.correlationId),u=[{}],[4,this.initializeBaseRequest(t)];case 1:return d=te.apply(void 0,[te.apply(void 0,u.concat([v.sent()])),{redirectUri:i,state:s,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:ta.FRAGMENT}]),h=t.account||this.browserStorage.getActiveAccount(),h&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+h.homeAccountId,this.correlationId),d.account=h),N.isEmpty(d.loginHint)&&!h&&(p=this.browserStorage.getLegacyLoginHint(),p&&(d.loginHint=p)),[2,d]}})})},e}(mh);a();l();c();a();l();c();a();l();c();var ml=function(){function r(e,t,o,i,n){this.authModule=e,this.browserStorage=t,this.authCodeRequest=o,this.logger=i,this.performanceClient=n}return r.prototype.handleCodeResponseFromHash=function(e,t,o,i){return $(this,void 0,void 0,function(){var n,s,d;return M(this,function(u){if(this.performanceClient.addQueueMeasurement(A.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),N.isEmpty(e))throw H.createEmptyHashError(e);if(n=this.browserStorage.generateStateKey(t),s=this.browserStorage.getTemporaryCache(n),!s)throw L.createStateNotFoundError("Cached State");try{d=this.authModule.handleFragmentResponse(e,s)}catch(h){throw h instanceof $r&&h.subError===U.userCancelledError.code?H.createUserCancelledError():h}return this.performanceClient.setPreQueueTime(A.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(d,t,o,i)]})})},r.prototype.handleCodeResponseFromServer=function(e,t,o,i,n){return n===void 0&&(n=!0),$(this,void 0,void 0,function(){var s,d,u,h,p,v;return M(this,function(C){switch(C.label){case 0:if(this.performanceClient.addQueueMeasurement(A.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),s=this.browserStorage.generateStateKey(t),d=this.browserStorage.getTemporaryCache(s),!d)throw L.createStateNotFoundError("Cached State");return u=this.browserStorage.generateNonceKey(d),h=this.browserStorage.getTemporaryCache(u),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(A.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,o,i)]):[3,2];case 1:C.sent(),C.label=2;case 2:return n&&(e.nonce=h||void 0),e.state=d,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(p=this.checkCcsCredentials(),p&&(this.authCodeRequest.ccsCredential=p)),this.performanceClient.setPreQueueTime(A.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return v=C.sent(),this.browserStorage.cleanRequestByState(t),[2,v]}})})},r.prototype.updateTokenEndpointAuthority=function(e,t,o){return $(this,void 0,void 0,function(){var i,n;return M(this,function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(A.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),i="https://"+e+"/"+t.tenant+"/",[4,Jn.createDiscoveredInstance(i,o,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return n=s.sent(),this.authModule.updateAuthority(n),[2]}})})},r.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(We.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},r}();var gh=function(r){ct(e,r);function e(t,o,i,n,s,d){var u=r.call(this,t,o,i,n,d)||this;return u.browserCrypto=s,u}return e.prototype.initiateAuthRequest=function(t,o){return $(this,void 0,void 0,function(){var i,n;return M(this,function(s){switch(s.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),N.isEmpty(t)?[3,7]:(o.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(We.ORIGIN_URI,o.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(We.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),i={apiId:nt.acquireTokenRedirect,timeout:o.redirectTimeout,noHistory:!1},typeof o.onRedirectNavigate!="function"?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),n=o.onRedirectNavigate(t),n===!1?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,o.navigationClient.navigateExternal(t,i)])));case 1:return s.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,o.navigationClient.navigateExternal(t,i)];case 5:return s.sent(),[2];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),H.createEmptyNavigationUriError();case 8:return[2]}})})},e.prototype.handleCodeResponseFromHash=function(t,o,i,n){return $(this,void 0,void 0,function(){var s,d,u,h,p,v,C;return M(this,function(x){switch(x.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),N.isEmpty(t))throw H.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),s=this.browserStorage.generateStateKey(o),d=this.browserStorage.getTemporaryCache(s),!d)throw L.createStateNotFoundError("Cached State");try{u=this.authModule.handleFragmentResponse(t,d)}catch(E){throw E instanceof $r&&E.subError===U.userCancelledError.code?H.createUserCancelledError():E}return h=this.browserStorage.generateNonceKey(d),p=this.browserStorage.getTemporaryCache(h),this.authCodeRequest.code=u.code,u.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(u.cloud_instance_host_name,i,n)]:[3,2];case 1:x.sent(),x.label=2;case 2:return u.nonce=p||void 0,u.state=d,u.client_info?this.authCodeRequest.clientInfo=u.client_info:(v=this.checkCcsCredentials(),v&&(this.authCodeRequest.ccsCredential=v)),[4,this.authModule.acquireToken(this.authCodeRequest,u)];case 3:return C=x.sent(),this.browserStorage.cleanRequestByState(o),[2,C]}})})},e}(ml);a();l();c();var le;(function(r){r.INITIALIZE_START="msal:initializeStart",r.INITIALIZE_END="msal:initializeEnd",r.ACCOUNT_ADDED="msal:accountAdded",r.ACCOUNT_REMOVED="msal:accountRemoved",r.LOGIN_START="msal:loginStart",r.LOGIN_SUCCESS="msal:loginSuccess",r.LOGIN_FAILURE="msal:loginFailure",r.ACQUIRE_TOKEN_START="msal:acquireTokenStart",r.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",r.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",r.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",r.SSO_SILENT_START="msal:ssoSilentStart",r.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",r.SSO_SILENT_FAILURE="msal:ssoSilentFailure",r.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",r.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",r.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",r.HANDLE_REDIRECT_START="msal:handleRedirectStart",r.HANDLE_REDIRECT_END="msal:handleRedirectEnd",r.POPUP_OPENED="msal:popupOpened",r.LOGOUT_START="msal:logoutStart",r.LOGOUT_SUCCESS="msal:logoutSuccess",r.LOGOUT_FAILURE="msal:logoutFailure",r.LOGOUT_END="msal:logoutEnd",r.RESTORE_FROM_BFCACHE="msal:restoreFromBFCache"})(le||(le={}));a();l();c();a();l();c();var Xn;(function(r){r.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",r.USER_CANCEL="USER_CANCEL",r.NO_NETWORK="NO_NETWORK",r.TRANSIENT_ERROR="TRANSIENT_ERROR",r.PERSISTENT_ERROR="PERSISTENT_ERROR",r.DISABLED="DISABLED",r.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"})(Xn||(Xn={}));var qc={extensionError:{code:"ContentError"},userSwitch:{code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},tokensNotFoundInCache:{code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"}},no=function(r){ct(e,r);function e(t,o,i){var n=r.call(this,t,o)||this;return Object.setPrototypeOf(n,e.prototype),n.name="NativeAuthError",n.ext=i,n}return e.prototype.isFatal=function(){if(this.ext&&this.ext.status&&(this.ext.status===Xn.PERSISTENT_ERROR||this.ext.status===Xn.DISABLED))return!0;switch(this.errorCode){case qc.extensionError.code:return!0;default:return!1}},e.createError=function(t,o,i){if(i&&i.status)switch(i.status){case Xn.ACCOUNT_UNAVAILABLE:return ar.createNativeAccountUnavailableError();case Xn.USER_INTERACTION_REQUIRED:return new ar(t,o);case Xn.USER_CANCEL:return H.createUserCancelledError();case Xn.NO_NETWORK:return H.createNoNetworkConnectivityError()}return new e(t,o,i)},e.createUserSwitchError=function(){return new e(qc.userSwitch.code,qc.userSwitch.desc)},e.createTokensNotFoundInCacheError=function(){return new e(qc.tokensNotFoundInCache.code,qc.tokensNotFoundInCache.desc)},e}(Y);a();l();c();var Gc=function(r){ct(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d;return M(this,function(u){switch(u.label){case 0:return o=this.performanceClient.startMeasurement(A.SilentCacheClientAcquireToken,t.correlationId),i=this.initializeServerTelemetryManager(nt.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(i,t.authority,t.azureCloudOptions)];case 1:n=u.sent(),this.logger.verbose("Silent auth client created"),u.label=2;case 2:return u.trys.push([2,4,,5]),[4,n.acquireCachedToken(t)];case 3:return s=u.sent(),o.endMeasurement({success:!0,fromCache:!0}),[2,s];case 4:throw d=u.sent(),d instanceof H&&d.errorCode===U.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o.endMeasurement({errorCode:d instanceof Y&&d.errorCode||void 0,subErrorCode:d instanceof Y&&d.subError||void 0,success:!1}),d;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(H.createSilentLogoutUnsupportedError())},e.prototype.createSilentFlowClient=function(t,o,i){return $(this,void 0,void 0,function(){var n;return M(this,function(s){switch(s.label){case 0:return this.performanceClient.setPreQueueTime(A.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new fg(n,this.performanceClient)]}})})},e.prototype.initializeSilentRequest=function(t,o){return $(this,void 0,void 0,function(){var i;return M(this,function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(A.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(A.InitializeBaseRequest,this.correlationId),i=[te({},t)],[4,this.initializeBaseRequest(t,o)];case 1:return[2,te.apply(void 0,[te.apply(void 0,i.concat([n.sent()])),{account:o,forceRefresh:t.forceRefresh||!1}])]}})})},e}(Oo);var Ci=function(r){ct(e,r);function e(t,o,i,n,s,d,u,h,p,v,C,x){var E=r.call(this,t,o,i,n,s,d,h,p,x)||this;return E.apiId=u,E.accountId=v,E.nativeMessageHandler=p,E.nativeStorageManager=C,E.silentCacheClient=new Gc(t,E.nativeStorageManager,i,n,s,d,h,p,x),E}return e.prototype.acquireToken=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u,h;return M(this,function(p){switch(p.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),o=this.performanceClient.startMeasurement(A.NativeInteractionClientAcquireToken,t.correlationId),i=it.nowSeconds(),[4,this.initializeNativeRequest(t)];case 1:n=p.sent(),p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return s=p.sent(),o.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,s];case 4:return p.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return d={method:vi.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(d)];case 6:return u=p.sent(),h=this.validateNativeResponse(u),[2,this.handleNativeResponse(h,n,i).then(function(v){return o.endMeasurement({success:!0,isNativeBroker:!0,requestId:v.requestId}),v}).catch(function(v){throw o.endMeasurement({success:!1,errorCode:v.errorCode,subErrorCode:v.subError,isNativeBroker:!0}),v})]}})})},e.prototype.createSilentCacheRequest=function(t,o){return{authority:t.authority,correlationId:this.correlationId,scopes:bt.fromString(t.scope).asArray(),account:o,forceRefresh:!1}},e.prototype.acquireTokensFromCache=function(t,o){return $(this,void 0,void 0,function(){var i,n,s,d;return M(this,function(u){switch(u.label){case 0:if(!t)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),L.createNoAccountFoundError();if(i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t}),!i)throw L.createNoAccountFoundError();u.label=1;case 1:return u.trys.push([1,3,,4]),n=this.createSilentCacheRequest(o,i),[4,this.silentCacheClient.acquireToken(n)];case 2:return s=u.sent(),[2,s];case 3:throw d=u.sent(),d;case 4:return[2]}})})},e.prototype.acquireTokenRedirect=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u;return M(this,function(h){switch(h.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:o=h.sent(),i={method:vi.GetToken,request:o},h.label=2;case 2:return h.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(i)];case 3:return n=h.sent(),this.validateNativeResponse(n),[3,5];case 4:if(s=h.sent(),s instanceof no&&s.isFatal())throw s;return[3,5];case 5:return this.browserStorage.setTemporaryCache(We.NATIVE_REQUEST,JSON.stringify(o),!0),d={apiId:nt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(u,d)];case 6:return h.sent(),[2]}})})},e.prototype.handleRedirectPromise=function(){return $(this,void 0,void 0,function(){var t,o,i,n,s,d,u,h;return M(this,function(p){switch(p.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(t=this.browserStorage.getCachedNativeRequest(),!t)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];o=t.prompt,i=sg(t,["prompt"]),o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(We.NATIVE_REQUEST)),n={method:vi.GetToken,request:i},s=it.nowSeconds(),p.label=1;case 1:return p.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return d=p.sent(),this.validateNativeResponse(d),u=this.handleNativeResponse(d,i,s),this.browserStorage.setInteractionInProgress(!1),[2,u];case 3:throw h=p.sent(),this.browserStorage.setInteractionInProgress(!1),h;case 4:return[2]}})})},e.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},e.prototype.handleNativeResponse=function(t,o,i){return $(this,void 0,void 0,function(){var n,s,d,u,h,p;return M(this,function(v){switch(v.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),t.account.id!==o.accountId)throw no.createUserSwitchError();return[4,this.getDiscoveredAuthority(o.authority)];case 1:return n=v.sent(),s=n.getPreferredCache(),d=this.createIdTokenObj(t),u=this.createHomeAccountIdentifier(t,d),h=this.createAccountEntity(t,u,d,s),[4,this.generateAuthenticationResult(t,o,d,h,n.canonicalAuthority,i)];case 2:return p=v.sent(),this.cacheAccount(h),this.cacheNativeTokens(t,o,u,h,d,p.accessToken,p.tenantId,i),[2,p]}})})},e.prototype.createIdTokenObj=function(t){return new rr(t.id_token||S.EMPTY_STRING,this.browserCrypto)},e.prototype.createHomeAccountIdentifier=function(t,o){var i=At.generateHomeAccountId(t.client_info||S.EMPTY_STRING,nr.Default,this.logger,this.browserCrypto,o);return i},e.prototype.createAccountEntity=function(t,o,i,n){return At.createAccount(t.client_info,o,i,void 0,void 0,void 0,n,t.account.id)},e.prototype.generateScopes=function(t,o){return t.scope?bt.fromString(t.scope):bt.fromString(o.scope)},e.prototype.generatePopAccessToken=function(t,o){return $(this,void 0,void 0,function(){var i,n;return M(this,function(s){switch(s.label){case 0:if(o.tokenType!==Ne.POP)return[3,2];if(t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,t.shr];if(i=new Po(this.browserCrypto),n={resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,shrNonce:o.shrNonce},!o.keyId)throw L.createKeyIdMissingError();return[4,i.signPopToken(t.access_token,o.keyId,n)];case 1:return[2,s.sent()];case 2:return[2,t.access_token]}})})},e.prototype.generateAuthenticationResult=function(t,o,i,n,s,d){return $(this,void 0,void 0,function(){var u,h,p,v,C,x,E,O;return M(this,function(q){switch(q.label){case 0:return u=this.addTelemetryFromNativeResponse(t),h=t.scope?bt.fromString(t.scope):bt.fromString(o.scope),p=t.account.properties||{},v=p.UID||i.claims.oid||i.claims.sub||S.EMPTY_STRING,C=p.TenantId||i.claims.tid||S.EMPTY_STRING,[4,this.generatePopAccessToken(t,o)];case 1:return x=q.sent(),E=o.tokenType===Ne.POP?Ne.POP:Ne.BEARER,O={authority:s,uniqueId:v,tenantId:C,scopes:h.asArray(),account:n.getAccountInfo(),idToken:t.id_token,idTokenClaims:i.claims,accessToken:x,fromCache:u?this.isResponseFromCache(u):!1,expiresOn:new Date(Number(d+t.expires_in)*1e3),tokenType:E,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0},[2,O]}})})},e.prototype.cacheAccount=function(t){var o=this;this.browserStorage.setAccount(t),this.browserStorage.removeAccountContext(t).catch(function(i){o.logger.error("Error occurred while removing account context from browser storage. "+i)})},e.prototype.cacheNativeTokens=function(t,o,i,n,s,d,u,h){var p=zo.createIdTokenEntity(i,o.authority,t.id_token||S.EMPTY_STRING,o.clientId,s.claims.tid||S.EMPTY_STRING),v=o.tokenType===Ne.POP?S.SHR_NONCE_VALIDITY:(typeof t.expires_in=="string"?parseInt(t.expires_in,10):t.expires_in)||0,C=h+v,x=this.generateScopes(t,o),E=qo.createAccessTokenEntity(i,o.authority,d,o.clientId,s?s.claims.tid||S.EMPTY_STRING:u,x.printScopes(),C,0,this.browserCrypto),O=new gn(n,p,E);this.nativeStorageManager.saveCacheRecord(O)},e.prototype.addTelemetryFromNativeResponse=function(t){var o=this.getMATSFromResponse(t);return o?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:o.broker_version,matsAccountJoinOnStart:o.account_join_on_start,matsAccountJoinOnEnd:o.account_join_on_end,matsDeviceJoin:o.device_join,matsPromptBehavior:o.prompt_behavior,matsApiErrorCode:o.api_error_code,matsUiVisible:o.ui_visible,matsSilentCode:o.silent_code,matsSilentBiSubCode:o.silent_bi_sub_code,matsSilentMessage:o.silent_message,matsSilentStatus:o.silent_status,matsHttpStatus:o.http_status,matsHttpEventCount:o.http_event_count},this.correlationId),o):null},e.prototype.validateNativeResponse=function(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw no.createUnexpectedError("Response missing expected properties.")},e.prototype.getMATSFromResponse=function(t){if(t.properties.MATS)try{return JSON.parse(t.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},e.prototype.isResponseFromCache=function(t){return typeof t.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached},e.prototype.initializeNativeRequest=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u,h,p,v,C,x=this;return M(this,function(E){switch(E.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),o=t.authority||this.config.auth.authority,t.account?[4,this.validateRequestAuthority(o,t.account)]:[3,2];case 1:E.sent(),E.label=2;case 2:return i=new ge(o),i.validateAsUri(),n=t.scopes,s=sg(t,["scopes"]),d=new bt(n||[]),d.appendScopes(gi),u=function(){switch(x.apiId){case nt.ssoSilent:case nt.acquireTokenSilent_silentFlow:return x.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Kt.NONE}if(!t.prompt){x.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(t.prompt){case Kt.NONE:case Kt.CONSENT:case Kt.LOGIN:return x.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw x.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),H.createNativePromptParameterNotSupportedError()}},h=te(te({},s),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:i.urlString,scope:d.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:u(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:te(te(te({},t.extraQueryParameters),t.tokenQueryParameters),{telemetry:la.MATS_TELEMETRY}),extendedExpiryToken:!1}),t.authenticationScheme!==Ne.POP?[3,4]:(p={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},v=new Po(this.browserCrypto),[4,v.generateCnf(p)]);case 3:C=E.sent(),h.reqCnf=C.reqCnfString,h.keyId=C.kid,E.label=4;case 4:return[2,h]}})})},e}(mh);a();l();c();var $o=function(){function r(e,t,o,i){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=i,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=o,this.handshakeEvent=o.startMeasurement(A.NativeMessageHandlerHandshake)}return r.prototype.sendMessage=function(e){return $(this,void 0,void 0,function(){var t,o=this;return M(this,function(i){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:la.CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise(function(n,s){o.resolvers.set(t.responseId,{resolve:n,reject:s})})]})})},r.createProvider=function(e,t,o){return $(this,void 0,void 0,function(){var i,n;return M(this,function(s){switch(s.label){case 0:e.trace("NativeMessageHandler - createProvider called."),s.label=1;case 1:return s.trys.push([1,3,,5]),i=new r(e,t,o,la.PREFERRED_EXTENSION_ID),[4,i.sendHandshakeRequest()];case 2:return s.sent(),[2,i];case 3:return s.sent(),n=new r(e,t,o),[4,n.sendHandshakeRequest()];case 4:return s.sent(),[2,n];case 5:return[2]}})})},r.prototype.sendHandshakeRequest=function(){return $(this,void 0,void 0,function(){var e,t=this;return M(this,function(o){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:la.CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:{method:vi.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(i){t.onChannelMessage(i)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise(function(i,n){t.handshakeResolvers.set(e.responseId,{resolve:i,reject:n}),t.timeoutId=window.setTimeout(function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(H.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)},t.handshakeTimeoutMs)})]})})},r.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(!(!t.channel||t.channel!==la.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===vi.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var o=this.handshakeResolvers.get(t.responseId);o&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),o.reject(H.createNativeExtensionNotInstalledError()))}}},r.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,o=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{var n=t.body.method;if(n===vi.Response){if(!o)return;var s=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(s)),s.status!=="Success")o.reject(no.createError(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?o.reject(no.createError(s.result.code,s.result.description,s.result.ext)):o.resolve(s.result);else throw Y.createUnexpectedError("Event does not contain result.");this.resolvers.delete(t.responseId)}else if(n===vi.HandshakeResponse){if(!i)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(d){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+d.toString()),this.logger.errorPii("Unable to parse "+e),o?o.reject(d):i&&i.reject(d)}},r.prototype.getExtensionId=function(){return this.extensionId},r.prototype.getExtensionVersion=function(){return this.extensionVersion},r.isNativeAvailable=function(e,t,o,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!o)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case Ne.BEARER:case Ne.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},r}();var Eg=function(r){ct(e,r);function e(t,o,i,n,s,d,u,h,p,v){var C=r.call(this,t,o,i,n,s,d,u,p,v)||this;return C.nativeStorage=h,C}return e.prototype.acquireToken=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u,h,p,v,C=this;return M(this,function(x){switch(x.label){case 0:return this.performanceClient.setPreQueueTime(A.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,X.Redirect)];case 1:o=x.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||S.EMPTY_STRING,o.account||null),i=this.initializeServerTelemetryManager(nt.acquireTokenRedirect),n=function(E){E.persisted&&(C.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),C.browserStorage.cleanRequestByState(o.state),C.eventHandler.emitEvent(le.RESTORE_FROM_BFCACHE,X.Redirect))},x.label=2;case 2:return x.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(A.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 3:return s=x.sent(),this.performanceClient.setPreQueueTime(A.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(i,o.authority,o.azureCloudOptions)];case 4:return d=x.sent(),this.logger.verbose("Auth code client created"),u=new gh(d,this.browserStorage,s,this.logger,this.browserCrypto,this.performanceClient),[4,d.getAuthCodeUrl(te(te({},o),{nativeBroker:$o.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return h=x.sent(),p=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+p),window.addEventListener("pageshow",n),[4,u.initiateAuthRequest(h,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:p,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,x.sent()];case 7:throw v=x.sent(),v instanceof Y&&v.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),i.cacheFailedRequest(v),this.browserStorage.cleanRequestByState(o.state),v;case 8:return[2]}})})},e.prototype.handleRedirectPromise=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u,h,p,v,C,x,E;return M(this,function(O){switch(O.label){case 0:o=this.initializeServerTelemetryManager(nt.handleRedirectPromise),O.label=1;case 1:if(O.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(i=this.getRedirectResponseHash(t||window.location.hash),!i)return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(X.Redirect),[2,null];n=void 0;try{s=ge.getDeserializedHash(i),n=this.validateAndExtractStateFromHash(s,X.Redirect),this.logger.verbose("State extracted from hash")}catch(q){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+q),this.browserStorage.cleanRequestByInteractionType(X.Redirect),[2,null]}return d=this.browserStorage.getTemporaryCache(We.ORIGIN_URI,!0)||S.EMPTY_STRING,u=ge.removeHashFromUrl(d),h=ge.removeHashFromUrl(window.location.href),u===h&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(i,n,o)]):[3,3];case 2:return p=O.sent(),d.indexOf("#")>-1&&ft.replaceHash(d),[2,p];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(i,n,o)]);case 4:return!ft.isInIframe()||this.config.system.allowRedirectInIframe?(this.browserStorage.setTemporaryCache(We.URL_HASH,i,!0),v={apiId:nt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},C=!0,!d||d==="null"?(x=ft.getHomepage(),this.browserStorage.setTemporaryCache(We.ORIGIN_URI,x,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(x,v)]):[3,6]):[3,9];case 5:return C=O.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+d),[4,this.navigationClient.navigateInternal(d,v)];case 7:C=O.sent(),O.label=8;case 8:if(!C)return[2,this.handleHash(i,n,o)];O.label=9;case 9:return[2,null];case 10:throw E=O.sent(),E instanceof Y&&E.setCorrelationId(this.correlationId),o.cacheFailedRequest(E),this.browserStorage.cleanRequestByInteractionType(X.Redirect),E;case 11:return[2]}})})},e.prototype.getRedirectResponseHash=function(t){this.logger.verbose("getRedirectResponseHash called");var o=ge.hashContainsKnownProperties(t);if(o)return ft.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var i=this.browserStorage.getTemporaryCache(We.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(We.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),i},e.prototype.handleHash=function(t,o,i){return $(this,void 0,void 0,function(){var n,s,d,u,h,p,v,C=this;return M(this,function(x){switch(x.label){case 0:if(n=this.browserStorage.getCachedRequest(o,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),s=ge.getDeserializedHash(t),s.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw H.createNativeConnectionNotEstablishedError();return d=new Ci(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,s.accountId,this.nativeStorage,n.correlationId),u=Mr.parseRequestState(this.browserCrypto,o).userRequestState,[2,d.acquireToken(te(te({},n),{state:u,prompt:void 0})).finally(function(){C.browserStorage.cleanRequestByState(o)})]}if(h=this.browserStorage.getCachedAuthority(o),!h)throw H.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(A.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(i,h)];case 1:return p=x.sent(),this.logger.verbose("Auth code client created"),Zn.removeThrottle(this.browserStorage,this.config.auth.clientId,n),v=new gh(p,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient),[4,v.handleCodeResponseFromHash(t,o,p.authority,this.networkClient)];case 2:return[2,x.sent()]}})})},e.prototype.logout=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u,h;return M(this,function(p){switch(p.label){case 0:this.logger.verbose("logoutRedirect called"),o=this.initializeLogoutRequest(t),i=this.initializeServerTelemetryManager(nt.logout),p.label=1;case 1:return p.trys.push([1,10,,11]),this.eventHandler.emitEvent(le.LOGOUT_START,X.Redirect,t),[4,this.clearCacheOnLogout(o.account)];case 2:return p.sent(),n={apiId:nt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(A.StandardInteractionClientCreateAuthCodeClient,o.correlationId),[4,this.createAuthCodeClient(i,t&&t.authority)];case 3:return s=p.sent(),this.logger.verbose("Auth code client created"),d=s.getLogoutUri(o),this.eventHandler.emitEvent(le.LOGOUT_SUCCESS,X.Redirect,o),t&&typeof t.onRedirectNavigate=="function"?(u=t.onRedirectNavigate(d),u===!1?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(d,n)])):[3,7];case 4:return p.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),p.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(d,n)];case 8:return p.sent(),[2];case 9:return[3,11];case 10:throw h=p.sent(),h instanceof Y&&h.setCorrelationId(this.correlationId),i.cacheFailedRequest(h),this.eventHandler.emitEvent(le.LOGOUT_FAILURE,X.Redirect,null,h),this.eventHandler.emitEvent(le.LOGOUT_END,X.Redirect),h;case 11:return this.eventHandler.emitEvent(le.LOGOUT_END,X.Redirect),[2]}})})},e.prototype.getRedirectStartPage=function(t){var o=t||window.location.href;return ge.getAbsoluteUrl(o,ft.getCurrentUri())},e}(Oo);a();l();c();var Tg=function(r){ct(e,r);function e(t,o,i,n,s,d,u,h,p,v){var C=r.call(this,t,o,i,n,s,d,u,p,v)||this;return C.unloadWindow=C.unloadWindow.bind(C),C.nativeStorage=h,C}return e.prototype.acquireToken=function(t){try{var o=this.generatePopupName(t.scopes||gi,t.authority||this.config.auth.authority),i=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,o,i);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",o,i);return this.acquireTokenPopupAsync(t,o,i,n)}catch(s){return Promise.reject(s)}},e.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var o=this.initializeLogoutRequest(t),i=this.generateLogoutPopupName(o),n=t&&t.authority,s=t&&t.mainWindowRedirectUri,d=t?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(o,i,d,n,void 0,s);this.logger.verbose("asyncPopup set to false, opening popup");var u=this.openSizedPopup("about:blank",i,d);return this.logoutPopupAsync(o,i,d,n,u,s)}catch(h){return Promise.reject(h)}},e.prototype.acquireTokenPopupAsync=function(t,o,i,n){return $(this,void 0,void 0,function(){var s,d,u,h,p,v,C,x,E,O,q,_e,se,ke,Tt,Gt,Lt,sn=this;return M(this,function(ur){switch(ur.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),s=this.initializeServerTelemetryManager(nt.acquireTokenPopup),this.performanceClient.setPreQueueTime(A.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,X.Popup)];case 1:d=ur.sent(),this.browserStorage.updateCacheEntries(d.state,d.nonce,d.authority,d.loginHint||S.EMPTY_STRING,d.account||null),ur.label=2;case 2:return ur.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(A.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(d)];case 3:return u=ur.sent(),this.performanceClient.setPreQueueTime(A.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(s,d.authority,d.azureCloudOptions)];case 4:return h=ur.sent(),this.logger.verbose("Auth code client created"),p=$o.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),v=void 0,p&&(v=this.performanceClient.startMeasurement(A.FetchAccountIdWithNativeBroker,t.correlationId)),[4,h.getAuthCodeUrl(te(te({},d),{nativeBroker:p}))];case 5:return C=ur.sent(),x=new ml(h,this.browserStorage,u,this.logger,this.performanceClient),E={popup:n,popupName:o,popupWindowAttributes:i},O=this.initiateAuthRequest(C,E),this.eventHandler.emitEvent(le.POPUP_OPENED,X.Popup,{popupWindow:O},null),[4,this.monitorPopupForHash(O)];case 6:if(q=ur.sent(),_e=ge.getDeserializedHash(q),se=this.validateAndExtractStateFromHash(_e,X.Popup,d.correlationId),Zn.removeThrottle(this.browserStorage,this.config.auth.clientId,u),_e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),v&&v.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw H.createNativeConnectionNotEstablishedError();return ke=new Ci(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,_e.accountId,this.nativeStorage,d.correlationId),Tt=Mr.parseRequestState(this.browserCrypto,se).userRequestState,[2,ke.acquireToken(te(te({},d),{state:Tt,prompt:void 0})).finally(function(){sn.browserStorage.cleanRequestByState(se)})]}return[4,x.handleCodeResponseFromHash(q,se,h.authority,this.networkClient)];case 7:return Gt=ur.sent(),[2,Gt];case 8:throw Lt=ur.sent(),n&&n.close(),Lt instanceof Y&&Lt.setCorrelationId(this.correlationId),s.cacheFailedRequest(Lt),this.browserStorage.cleanRequestByState(d.state),Lt;case 9:return[2]}})})},e.prototype.logoutPopupAsync=function(t,o,i,n,s,d){return $(this,void 0,void 0,function(){var u,h,p,v,C,x,E;return M(this,function(O){switch(O.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(le.LOGOUT_START,X.Popup,t),u=this.initializeServerTelemetryManager(nt.logoutPopup),O.label=1;case 1:return O.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(t.account)];case 2:return O.sent(),this.performanceClient.setPreQueueTime(A.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(u,n)];case 3:return h=O.sent(),this.logger.verbose("Auth code client created"),p=h.getLogoutUri(t),this.eventHandler.emitEvent(le.LOGOUT_SUCCESS,X.Popup,t),v=this.openPopup(p,{popupName:o,popupWindowAttributes:i,popup:s}),this.eventHandler.emitEvent(le.POPUP_OPENED,X.Popup,{popupWindow:v},null),[4,this.waitForLogoutPopup(v)];case 4:return O.sent(),d?(C={apiId:nt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},x=ge.getAbsoluteUrl(d,ft.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+x),this.navigationClient.navigateInternal(x,C)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw E=O.sent(),s&&s.close(),E instanceof Y&&E.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(le.LOGOUT_FAILURE,X.Popup,null,E),this.eventHandler.emitEvent(le.LOGOUT_END,X.Popup),u.cacheFailedRequest(E),E;case 6:return this.eventHandler.emitEvent(le.LOGOUT_END,X.Popup),[2]}})})},e.prototype.initiateAuthRequest=function(t,o){if(N.isEmpty(t))throw this.logger.error("Navigate url is empty"),H.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+t),this.openPopup(t,o)},e.prototype.monitorPopupForHash=function(t){var o=this;return new Promise(function(i,n){var s=o.config.system.windowHashTimeout/o.config.system.pollIntervalMilliseconds,d=0;o.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var u=setInterval(function(){if(t.closed){o.logger.error("PopupHandler.monitorPopupForHash - window closed"),o.cleanPopup(),clearInterval(u),n(H.createUserCancelledError());return}var h=S.EMPTY_STRING,p=S.EMPTY_STRING;try{h=t.location.href,p=t.location.hash}catch{}N.isEmpty(h)||h==="about:blank"||(o.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),d++,p?(o.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(u),o.cleanPopup(t),ge.hashContainsKnownProperties(p)?(o.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),i(p)):(o.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),o.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+p),n(H.createHashDoesNotContainKnownPropertiesError()))):d>s&&(o.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(u),n(H.createMonitorPopupTimeoutError())))},o.config.system.pollIntervalMilliseconds)})},e.prototype.waitForLogoutPopup=function(t){var o=this;return new Promise(function(i){o.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval(function(){t.closed&&(o.logger.error("PopupHandler.waitForLogoutPopup - window closed"),o.cleanPopup(),clearInterval(n),i());var s=S.EMPTY_STRING;try{s=t.location.href}catch{}N.isEmpty(s)||s==="about:blank"||(o.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),o.cleanPopup(t),i())},o.config.system.pollIntervalMilliseconds)})},e.prototype.openPopup=function(t,o){try{var i=void 0;if(o.popup?(i=o.popup,this.logger.verbosePii("Navigating popup window to: "+t),i.location.assign(t)):typeof o.popup>"u"&&(this.logger.verbosePii("Opening popup window to: "+t),i=this.openSizedPopup(t,o.popupName,o.popupWindowAttributes)),!i)throw H.createEmptyWindowCreatedError();return i.focus&&i.focus(),this.currentWindow=i,window.addEventListener("beforeunload",this.unloadWindow),i}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),H.createPopupWindowError(n.toString())}},e.prototype.openSizedPopup=function(t,o,i){var n,s,d,u,h=window.screenLeft?window.screenLeft:window.screenX,p=window.screenTop?window.screenTop:window.screenY,v=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,C=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,x=(n=i.popupSize)===null||n===void 0?void 0:n.width,E=(s=i.popupSize)===null||s===void 0?void 0:s.height,O=(d=i.popupPosition)===null||d===void 0?void 0:d.top,q=(u=i.popupPosition)===null||u===void 0?void 0:u.left;return(!x||x<0||x>v)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),x=Sr.POPUP_WIDTH),(!E||E<0||E>C)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),E=Sr.POPUP_HEIGHT),(!O||O<0||O>C)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),O=Math.max(0,C/2-Sr.POPUP_HEIGHT/2+p)),(!q||q<0||q>v)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),q=Math.max(0,v/2-Sr.POPUP_WIDTH/2+h)),window.open(t,o,"width="+x+", height="+E+", top="+O+", left="+q+", scrollbars=yes")},e.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(X.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()},e.prototype.cleanPopup=function(t){t&&t.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},e.prototype.generatePopupName=function(t,o){return Sr.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+t.join("-")+"."+o+"."+this.correlationId},e.prototype.generateLogoutPopupName=function(t){var o=t.account&&t.account.homeAccountId;return Sr.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+o+"."+this.correlationId},e}(Oo);a();l();c();a();l();c();a();l();c();a();l();c();var kg=function(){function r(){}return r.prototype.navigateInternal=function(e,t){return r.defaultNavigateWindow(e,t)},r.prototype.navigateExternal=function(e,t){return r.defaultNavigateWindow(e,t)},r.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(function(o){setTimeout(function(){o(!0)},t.timeout)})},r}();var P3=6e4,jc=6e3,O3=3e4,$3=2e3;function Cw(r,e){var t=r.auth,o=r.cache,i=r.system,n=r.telemetry,s={clientId:S.EMPTY_STRING,authority:""+S.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:S.EMPTY_STRING,authorityMetadata:S.EMPTY_STRING,redirectUri:S.EMPTY_STRING,postLogoutRedirectUri:S.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:vn.AAD,azureCloudOptions:{azureCloudInstance:Mi.None,tenant:S.EMPTY_STRING},skipAuthorityMetadataCache:!1},d={cacheLocation:$t.SessionStorage,temporaryCacheLocation:$t.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(o&&o.cacheLocation===$t.LocalStorage),claimsBasedCachingEnabled:!0},u={loggerCallback:function(){},logLevel:Wt.Info,piiLoggingEnabled:!1},h=te(te({},dh),{loggerOptions:u,networkClient:e?ft.getBrowserNetworkClient():vg,navigationClient:new kg,loadFrameTimeout:0,windowHashTimeout:i?.loadFrameTimeout||P3,iframeHashTimeout:i?.loadFrameTimeout||jc,navigateFrameWait:e&&ft.detectIEOrEdge()?500:0,redirectNavigationTimeout:O3,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:i?.nativeBrokerHandshakeTimeout||$3,pollIntervalMilliseconds:Sr.DEFAULT_POLL_INTERVAL_MS,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),p=te(te({},i),{loggerOptions:i?.loggerOptions||u}),v={application:{appName:S.EMPTY_STRING,appVersion:S.EMPTY_STRING}},C={auth:te(te({},s),t),cache:te(te({},d),o),system:te(te({},h),p),telemetry:te(te({},v),n)};return C}var vh=function(r){ct(e,r);function e(t,o,i,n,s,d){var u=r.call(this,t,o,i,n,d)||this;return u.navigateFrameWait=s.navigateFrameWait,u.pollIntervalMilliseconds=s.pollIntervalMilliseconds,u}return e.prototype.initiateAuthRequest=function(t){return $(this,void 0,void 0,function(){return M(this,function(o){switch(o.label){case 0:if(this.performanceClient.addQueueMeasurement(A.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),N.isEmpty(t))throw this.logger.info("Navigate url is empty"),H.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(A.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(t)]):[3,2];case 1:return[2,o.sent()];case 2:return[2,this.loadFrameSync(t)]}})})},e.prototype.monitorIframeForHash=function(t,o){var i=this;return this.performanceClient.addQueueMeasurement(A.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise(function(n,s){o<jc&&i.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+o+"ms) than the default ("+jc+"ms). This may result in timeouts.");var d=window.performance.now(),u=d+o,h=setInterval(function(){if(window.performance.now()>u){i.removeHiddenIframe(t),clearInterval(h),s(H.createMonitorIframeTimeoutError());return}var p=S.EMPTY_STRING,v=t.contentWindow;try{p=v?v.location.href:S.EMPTY_STRING}catch{}if(!N.isEmpty(p)){var C=v?v.location.hash:S.EMPTY_STRING;if(ge.hashContainsKnownProperties(C)){i.removeHiddenIframe(t),clearInterval(h),n(C);return}}},i.pollIntervalMilliseconds)})},e.prototype.loadFrame=function(t){var o=this;return this.performanceClient.addQueueMeasurement(A.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise(function(i,n){var s=o.createHiddenIframe();setTimeout(function(){if(!s){n("Unable to load iframe");return}s.src=t,i(s)},o.navigateFrameWait)})},e.prototype.loadFrameSync=function(t){var o=this.createHiddenIframe();return o.src=t,o},e.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},e.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},e}(ml);var Ig=function(r){ct(e,r);function e(t,o,i,n,s,d,u,h,p,v,C){var x=r.call(this,t,o,i,n,s,d,h,v,C)||this;return x.apiId=u,x.nativeStorage=p,x}return e.prototype.acquireToken=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d;return M(this,function(u){switch(u.label){case 0:if(this.performanceClient.addQueueMeasurement(A.SilentIframeClientAcquireToken,t.correlationId),this.logger.verbose("acquireTokenByIframe called"),o=this.performanceClient.startMeasurement(A.SilentIframeClientAcquireToken,t.correlationId),N.isEmpty(t.loginHint)&&N.isEmpty(t.sid)&&(!t.account||N.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==Kt.NONE&&t.prompt!==Kt.NO_SESSION)throw o.endMeasurement({success:!1}),H.createSilentPromptValueError(t.prompt);return this.performanceClient.setPreQueueTime(A.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(te(te({},t),{prompt:t.prompt||Kt.NONE}),X.Silent)];case 1:i=u.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||S.EMPTY_STRING,i.account||null),n=this.initializeServerTelemetryManager(this.apiId),u.label=2;case 2:return u.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(A.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(n,i.authority,i.azureCloudOptions)];case 3:return s=u.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(A.SilentIframeClientTokenHelper,t.correlationId),[4,this.silentTokenHelper(s,i).then(function(h){return o.endMeasurement({success:!0,fromCache:!1,requestId:h.requestId}),h})];case 4:return[2,u.sent()];case 5:throw d=u.sent(),d instanceof Y&&d.setCorrelationId(this.correlationId),n.cacheFailedRequest(d),this.browserStorage.cleanRequestByState(i.state),o.endMeasurement({errorCode:d instanceof Y&&d.errorCode||void 0,subErrorCode:d instanceof Y&&d.subError||void 0,success:!1}),d;case 6:return[2]}})})},e.prototype.logout=function(){return Promise.reject(H.createSilentLogoutUnsupportedError())},e.prototype.silentTokenHelper=function(t,o){return $(this,void 0,void 0,function(){var i,n,s,d,u,h,p,v,C,x=this;return M(this,function(E){switch(E.label){case 0:return this.performanceClient.addQueueMeasurement(A.SilentIframeClientTokenHelper,o.correlationId),this.performanceClient.setPreQueueTime(A.StandardInteractionClientInitializeAuthorizationCodeRequest,o.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 1:return i=E.sent(),this.performanceClient.setPreQueueTime(A.GetAuthCodeUrl,o.correlationId),[4,t.getAuthCodeUrl(te(te({},o),{nativeBroker:$o.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,o.authenticationScheme)}))];case 2:return n=E.sent(),s=new vh(t,this.browserStorage,i,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(A.SilentHandlerInitiateAuthRequest,o.correlationId),[4,s.initiateAuthRequest(n)];case 3:return d=E.sent(),this.performanceClient.setPreQueueTime(A.SilentHandlerMonitorIframeForHash,o.correlationId),[4,s.monitorIframeForHash(d,this.config.system.iframeHashTimeout)];case 4:if(u=E.sent(),h=ge.getDeserializedHash(u),p=this.validateAndExtractStateFromHash(h,X.Silent,i.correlationId),h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw H.createNativeConnectionNotEstablishedError();return v=new Ci(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,this.correlationId),C=Mr.parseRequestState(this.browserCrypto,p).userRequestState,[2,v.acquireToken(te(te({},o),{state:C,prompt:o.prompt||Kt.NONE})).finally(function(){x.browserStorage.cleanRequestByState(p)})]}return this.performanceClient.setPreQueueTime(A.HandleCodeResponseFromHash,o.correlationId),[2,s.handleCodeResponseFromHash(u,p,t.authority,this.networkClient)]}})})},e}(Oo);a();l();c();var Ag=function(r){ct(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u=this;return M(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(A.SilentRefreshClientAcquireToken,t.correlationId),this.performanceClient.setPreQueueTime(A.InitializeBaseRequest,t.correlationId),i=[te({},t)],[4,this.initializeBaseRequest(t,t.account)];case 1:return o=te.apply(void 0,i.concat([h.sent()])),n=this.performanceClient.startMeasurement(A.SilentRefreshClientAcquireToken,o.correlationId),s=this.initializeServerTelemetryManager(nt.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(s,o.authority,o.azureCloudOptions)];case 2:return d=h.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(A.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),[2,d.acquireTokenByRefreshToken(o).then(function(p){return n.endMeasurement({success:!0,fromCache:p.fromCache,requestId:p.requestId}),p}).catch(function(p){throw p instanceof Y&&p.setCorrelationId(u.correlationId),s.cacheFailedRequest(p),n.endMeasurement({errorCode:p.errorCode,subErrorCode:p.subError,success:!1}),p})]}})})},e.prototype.logout=function(){return Promise.reject(H.createSilentLogoutUnsupportedError())},e.prototype.createRefreshTokenClient=function(t,o,i){return $(this,void 0,void 0,function(){var n;return M(this,function(s){switch(s.label){case 0:return this.performanceClient.setPreQueueTime(A.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new Uc(n,this.performanceClient)]}})})},e}(Oo);a();l();c();var Rg=function(){function r(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return r.prototype.addEventCallback=function(e){if(typeof window<"u"){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},r.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},r.prototype.enableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},r.prototype.disableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},r.prototype.emitEvent=function(e,t,o,i){var n=this;if(typeof window<"u"){var s={eventType:e,interactionType:t||null,payload:o||null,error:i||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach(function(d,u){n.logger.verbose("Emitting event to callback "+u+": "+e),d.apply(null,[s])})}},r.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var o=JSON.parse(t);if(typeof o!="object"||!At.isAccountEntity(o))return;var i=Or.toObject(new At,o),n=i.getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(le.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(le.ACCOUNT_REMOVED,void 0,n))}catch{return}},r}();a();l();c();a();l();c();a();l();c();var Lr=function(){function r(){}return r.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r}();var yh=function(){function r(e){this.cryptoObj=e}return r.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Lr.decimalToHex(e[0])+Lr.decimalToHex(e[1])+Lr.decimalToHex(e[2])+Lr.decimalToHex(e[3])+"-"+Lr.decimalToHex(e[4])+Lr.decimalToHex(e[5])+"-"+Lr.decimalToHex(e[6])+Lr.decimalToHex(e[7])+"-"+Lr.decimalToHex(e[8])+Lr.decimalToHex(e[9])+"-"+Lr.decimalToHex(e[10])+Lr.decimalToHex(e[11])+Lr.decimalToHex(e[12])+Lr.decimalToHex(e[13])+Lr.decimalToHex(e[14])+Lr.decimalToHex(e[15])}catch{for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,n=S.EMPTY_STRING,s=0;s<36;s++)t[s]!=="-"&&t[s]!=="4"&&(i=Math.random()*16|0),t[s]==="x"?n+=o[i]:t[s]==="y"?(i&=3,i|=8,n+=o[i]):n+=t[s];return n}},r.prototype.isGuid=function(e){var t=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return t.test(e)},r}();a();l();c();a();l();c();var yo=function(){function r(){}return r.stringToUtf8Arr=function(e){for(var t,o=0,i=e.length,n=0;n<i;n++)t=e.charCodeAt(n),o+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var s=new Uint8Array(o),d=0,u=0;d<o;u++)t=e.charCodeAt(u),t<128?s[d++]=t:t<2048?(s[d++]=192+(t>>>6),s[d++]=128+(t&63)):t<65536?(s[d++]=224+(t>>>12),s[d++]=128+(t>>>6&63),s[d++]=128+(t&63)):t<2097152?(s[d++]=240+(t>>>18),s[d++]=128+(t>>>12&63),s[d++]=128+(t>>>6&63),s[d++]=128+(t&63)):t<67108864?(s[d++]=248+(t>>>24),s[d++]=128+(t>>>18&63),s[d++]=128+(t>>>12&63),s[d++]=128+(t>>>6&63),s[d++]=128+(t&63)):(s[d++]=252+(t>>>30),s[d++]=128+(t>>>24&63),s[d++]=128+(t>>>18&63),s[d++]=128+(t>>>12&63),s[d++]=128+(t>>>6&63),s[d++]=128+(t&63));return s},r.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),o=new Uint8Array(t),i=0;i<e.length;i++)o[i]=e.charCodeAt(i);return t},r.utf8ArrToString=function(e){for(var t=S.EMPTY_STRING,o=void 0,i=e.length,n=0;n<i;n++)o=e[n],t+=String.fromCharCode(o>251&&o<254&&n+5<i?(o-252)*1073741824+(e[++n]-128<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>247&&o<252&&n+4<i?(o-248<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>239&&o<248&&n+3<i?(o-240<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>223&&o<240&&n+2<i?(o-224<<12)+(e[++n]-128<<6)+e[++n]-128:o>191&&o<224&&n+1<i?(o-192<<6)+e[++n]-128:o);return t},r.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},r}();var bh=function(){function r(){}return r.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,S.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},r.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,S.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},r.prototype.encode=function(e){var t=yo.stringToUtf8Arr(e);return this.base64EncArr(t)},r.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,o=S.EMPTY_STRING,i=void 0,n=e.length,s=0,d=0;d<n;d++)i=d%3,s|=e[d]<<(16>>>i&24),(i===2||e.length-d===1)&&(o+=String.fromCharCode(this.uint6ToB64(s>>>18&63),this.uint6ToB64(s>>>12&63),this.uint6ToB64(s>>>6&63),this.uint6ToB64(s&63)),s=0);return t===0?o:o.substring(0,o.length-t)+(t===1?"=":"==")},r.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:e===62?43:e===63?47:65},r}();a();l();c();var ww=function(){function r(){}return r.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var o=this.base64DecToArr(t);return yo.utf8ArrToString(o)},r.prototype.base64DecToArr=function(e,t){for(var o=e.replace(/[^A-Za-z0-9\+\/]/g,S.EMPTY_STRING),i=o.length,n=t?Math.ceil((i*3+1>>>2)/t)*t:i*3+1>>>2,s=new Uint8Array(n),d=void 0,u=void 0,h=0,p=0,v=0;v<i;v++)if(u=v&3,h|=this.b64ToUint6(o.charCodeAt(v))<<18-6*u,u===3||i-v===1){for(d=0;d<3&&p<n;d++,p++)s[p]=h>>>(16>>>d&24)&255;h=0}return s},r.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:e===43?62:e===47?63:0},r}();a();l();c();var M3=32,xw=function(){function r(e){this.base64Encode=new bh,this.cryptoObj=e}return r.prototype.generateCodes=function(){return $(this,void 0,void 0,function(){var e,t;return M(this,function(o){switch(o.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=o.sent(),[2,{verifier:e,challenge:t}]}})})},r.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(M3);this.cryptoObj.getRandomValues(e);var t=this.base64Encode.urlEncodeArr(e);return t}catch(o){throw H.createPkceNotGeneratedError(o)}},r.prototype.generateCodeChallengeFromVerifier=function(e){return $(this,void 0,void 0,function(){var t,o;return M(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=i.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw o=i.sent(),H.createPkceNotGeneratedError(o);case 3:return[2]}})})},r}();a();l();c();a();l();c();var Sw=function(){function r(){}return r.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){return[2,window.crypto.subtle.generateKey(e,t,o)]})})},r.prototype.exportKey=function(e){return $(this,void 0,void 0,function(){return M(this,function(t){return[2,window.crypto.subtle.exportKey(bn,e)]})})},r.prototype.importKey=function(e,t,o,i){return $(this,void 0,void 0,function(){return M(this,function(n){return[2,window.crypto.subtle.importKey(bn,e,t,o,i)]})})},r.prototype.sign=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){return[2,window.crypto.subtle.sign(e,t,o)]})})},r.prototype.digest=function(e,t){return $(this,void 0,void 0,function(){return M(this,function(o){return[2,window.crypto.subtle.digest(e,t)]})})},r}();a();l();c();var _w=function(){function r(){}return r.prototype.initPrng=function(e){return window.msrCrypto.initPrng(al(e))},r.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){return[2,window.msrCrypto.subtle.generateKey(e,t,o)]})})},r.prototype.exportKey=function(e){return $(this,void 0,void 0,function(){return M(this,function(t){return[2,window.msrCrypto.subtle.exportKey(bn,e)]})})},r.prototype.importKey=function(e,t,o,i){return $(this,void 0,void 0,function(){return M(this,function(n){return[2,window.msrCrypto.subtle.importKey(bn,e,t,o,i)]})})},r.prototype.sign=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){return[2,window.msrCrypto.subtle.sign(e,t,o)]})})},r.prototype.digest=function(e,t){return $(this,void 0,void 0,function(){return M(this,function(o){return[2,window.msrCrypto.subtle.digest(e,t)]})})},r}();a();l();c();var Ew=function(){function r(){}return r.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){return[2,new Promise(function(n,s){var d=window.msCrypto.subtle.generateKey(e,t,o);d.addEventListener("complete",function(u){n(u.target.result)}),d.addEventListener("error",function(u){s(u)})})]})})},r.prototype.exportKey=function(e){return $(this,void 0,void 0,function(){return M(this,function(t){return[2,new Promise(function(o,i){var n=window.msCrypto.subtle.exportKey(bn,e);n.addEventListener("complete",function(s){var d=s.target.result,u=yo.utf8ArrToString(new Uint8Array(d)).replace(/\r/g,S.EMPTY_STRING).replace(/\n/g,S.EMPTY_STRING).replace(/\t/g,S.EMPTY_STRING).split(" ").join(S.EMPTY_STRING).replace("\0",S.EMPTY_STRING);try{o(JSON.parse(u))}catch(h){i(h)}}),n.addEventListener("error",function(s){i(s)})})]})})},r.prototype.importKey=function(e,t,o,i){return $(this,void 0,void 0,function(){var n,s;return M(this,function(d){return n=yo.getSortedObjectString(e),s=yo.stringToArrayBuffer(n),[2,new Promise(function(u,h){var p=window.msCrypto.subtle.importKey(bn,s,t,o,i);p.addEventListener("complete",function(v){u(v.target.result)}),p.addEventListener("error",function(v){h(v)})})]})})},r.prototype.sign=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){return[2,new Promise(function(n,s){var d=window.msCrypto.subtle.sign(e,t,o);d.addEventListener("complete",function(u){n(u.target.result)}),d.addEventListener("error",function(u){s(u)})})]})})},r.prototype.digest=function(e,t){return $(this,void 0,void 0,function(){return M(this,function(o){return[2,new Promise(function(i,n){var s=window.msCrypto.subtle.digest(e,t.buffer);s.addEventListener("complete",function(d){i(d.target.result)}),s.addEventListener("error",function(d){n(d)})})]})})},r}();var F3="RSASSA-PKCS1-v1_5",Tw="SHA-256",D3=2048,L3=new Uint8Array([1,0,1]),Ch=function(){function r(e,t){var o,i;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new Sw;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new Ew;else if(this.hasMsrCrypto()&&(!((o=this.cryptoOptions)===null||o===void 0)&&o.useMsrCrypto))this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new _w;else throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),H.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(!((i=this.cryptoOptions)===null||i===void 0)&&i.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),Cn.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:F3,hash:Tw,modulusLength:D3,publicExponent:L3}}return r.prototype.hasIECrypto=function(){return"msCrypto"in window},r.prototype.hasBrowserCrypto=function(){return"crypto"in window},r.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},r.prototype.sha256Digest=function(e){return $(this,void 0,void 0,function(){var t;return M(this,function(o){return t=yo.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:Tw},t)]})})},r.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},r.prototype.generateKeyPair=function(e,t){return $(this,void 0,void 0,function(){return M(this,function(o){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]})})},r.prototype.exportJwk=function(e){return $(this,void 0,void 0,function(){return M(this,function(t){return[2,this.subtleCrypto.exportKey(e)]})})},r.prototype.importJwk=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,o)]})})},r.prototype.sign=function(e,t){return $(this,void 0,void 0,function(){return M(this,function(o){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]})})},r}();a();l();c();a();l();c();a();l();c();var kw=function(){function r(){this.dbName=ph,this.version=mw,this.tableName=gw,this.dbOpen=!1}return r.prototype.open=function(){return $(this,void 0,void 0,function(){var e=this;return M(this,function(t){return[2,new Promise(function(o,i){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",function(s){var d=s;d.target.result.createObjectStore(e.tableName)}),n.addEventListener("success",function(s){var d=s;e.db=d.target.result,e.dbOpen=!0,o()}),n.addEventListener("error",function(){return i(H.createDatabaseUnavailableError())})})]})})},r.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},r.prototype.validateDbIsOpen=function(){return $(this,void 0,void 0,function(){return M(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}})})},r.prototype.getItem=function(e){return $(this,void 0,void 0,function(){var t=this;return M(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(H.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readonly"),d=s.objectStore(t.tableName),u=d.get(e);u.addEventListener("success",function(h){var p=h;t.closeConnection(),i(p.target.result)}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.setItem=function(e,t){return $(this,void 0,void 0,function(){var o=this;return M(this,function(i){switch(i.label){case 0:return[4,this.validateDbIsOpen()];case 1:return i.sent(),[2,new Promise(function(n,s){if(!o.db)return s(H.createDatabaseNotOpenError());var d=o.db.transaction([o.tableName],"readwrite"),u=d.objectStore(o.tableName),h=u.put(t,e);h.addEventListener("success",function(){o.closeConnection(),n()}),h.addEventListener("error",function(p){o.closeConnection(),s(p)})})]}})})},r.prototype.removeItem=function(e){return $(this,void 0,void 0,function(){var t=this;return M(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(H.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readwrite"),d=s.objectStore(t.tableName),u=d.delete(e);u.addEventListener("success",function(){t.closeConnection(),i()}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.getKeys=function(){return $(this,void 0,void 0,function(){var e=this;return M(this,function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise(function(o,i){if(!e.db)return i(H.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly"),s=n.objectStore(e.tableName),d=s.getAllKeys();d.addEventListener("success",function(u){var h=u;e.closeConnection(),o(h.target.result)}),d.addEventListener("error",function(u){e.closeConnection(),i(u)})})]}})})},r.prototype.containsKey=function(e){return $(this,void 0,void 0,function(){var t=this;return M(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(H.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readonly"),d=s.objectStore(t.tableName),u=d.count(e);u.addEventListener("success",function(h){var p=h;t.closeConnection(),i(p.target.result===1)}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.deleteDatabase=function(){return $(this,void 0,void 0,function(){return M(this,function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise(function(t,o){var i=window.indexedDB.deleteDatabase(ph);i.addEventListener("success",function(){return t(!0)}),i.addEventListener("blocked",function(){return t(!0)}),i.addEventListener("error",function(){return o(!1)})})]})})},r}();var Pg=function(){function r(e,t){this.inMemoryCache=new Vc,this.indexedDBCache=new kw,this.logger=e,this.storeName=t}return r.prototype.handleDatabaseAccessError=function(e){if(e instanceof H&&e.errorCode===U.databaseUnavailable.code)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e},r.prototype.getItem=function(e){return $(this,void 0,void 0,function(){var t,o;return M(this,function(i){switch(i.label){case 0:if(t=this.inMemoryCache.getItem(e),t)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,i.sent()];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}})})},r.prototype.setItem=function(e,t){return $(this,void 0,void 0,function(){var o;return M(this,function(i){switch(i.label){case 0:this.inMemoryCache.setItem(e,t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return i.sent(),[3,4];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2]}})})},r.prototype.removeItem=function(e){return $(this,void 0,void 0,function(){var t;return M(this,function(o){switch(o.label){case 0:this.inMemoryCache.removeItem(e),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return o.sent(),[3,4];case 3:return t=o.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}})})},r.prototype.getKeys=function(){return $(this,void 0,void 0,function(){var e,t;return M(this,function(o){switch(o.label){case 0:if(e=this.inMemoryCache.getKeys(),e.length!==0)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,o.sent()];case 3:return t=o.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}})})},r.prototype.containsKey=function(e){return $(this,void 0,void 0,function(){var t,o;return M(this,function(i){switch(i.label){case 0:if(t=this.inMemoryCache.containsKey(e),t)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,i.sent()];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}})})},r.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},r.prototype.clearPersistent=function(){return $(this,void 0,void 0,function(){var e,t;return M(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return e=o.sent(),e&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=o.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}})})},r}();var wh;(function(r){r.asymmetricKeys="asymmetricKeys",r.symmetricKeys="symmetricKeys"})(wh||(wh={}));var Iw=function(){function r(e){this.logger=e,this.asymmetricKeys=new Pg(this.logger,wh.asymmetricKeys),this.symmetricKeys=new Pg(this.logger,wh.symmetricKeys)}return r.prototype.clear=function(){return $(this,void 0,void 0,function(){var e;return M(this,function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return e=t.sent(),e instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}})})},r}();var Kc=function(){function r(e,t,o){this.logger=e,this.browserCrypto=new Ch(this.logger,o),this.b64Encode=new bh,this.b64Decode=new ww,this.guidGenerator=new yh(this.browserCrypto),this.pkceGenerator=new xw(this.browserCrypto),this.cache=new Iw(this.logger),this.performanceClient=t}return r.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},r.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},r.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},r.prototype.generatePkceCodes=function(){return $(this,void 0,void 0,function(){return M(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},r.prototype.getPublicKeyThumbprint=function(e){var t;return $(this,void 0,void 0,function(){var o,i,n,s,d,u,h,p;return M(this,function(v){switch(v.label){case 0:return o=(t=this.performanceClient)===null||t===void 0?void 0:t.startMeasurement(A.CryptoOptsGetPublicKeyThumbprint,e.correlationId),[4,this.browserCrypto.generateKeyPair(r.EXTRACTABLE,r.POP_KEY_USAGES)];case 1:return i=v.sent(),[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return n=v.sent(),s={e:n.e,kty:n.kty,n:n.n},d=yo.getSortedObjectString(s),[4,this.hashString(d)];case 3:return u=v.sent(),[4,this.browserCrypto.exportJwk(i.privateKey)];case 4:return h=v.sent(),[4,this.browserCrypto.importJwk(h,!1,["sign"])];case 5:return p=v.sent(),[4,this.cache.asymmetricKeys.setItem(u,{privateKey:p,publicKey:i.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri})];case 6:return v.sent(),o&&o.endMeasurement({success:!0}),[2,u]}})})},r.prototype.removeTokenBindingKey=function(e){return $(this,void 0,void 0,function(){var t;return M(this,function(o){switch(o.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return o.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return t=o.sent(),[2,!t]}})})},r.prototype.clearKeystore=function(){return $(this,void 0,void 0,function(){return M(this,function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}})})},r.prototype.signJwt=function(e,t,o){var i;return $(this,void 0,void 0,function(){var n,s,d,u,h,p,v,C,x,E,O,q,_e;return M(this,function(se){switch(se.label){case 0:return n=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement(A.CryptoOptsSignJwt,o),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(s=se.sent(),!s)throw H.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(s.publicKey)];case 2:return d=se.sent(),u=yo.getSortedObjectString(d),h=this.b64Encode.urlEncode(JSON.stringify({kid:t})),p=bg.getShrHeaderString({kid:h,alg:d.alg}),v=this.b64Encode.urlEncode(p),e.cnf={jwk:JSON.parse(u)},C=this.b64Encode.urlEncode(JSON.stringify(e)),x=v+"."+C,E=yo.stringToArrayBuffer(x),[4,this.browserCrypto.sign(s.privateKey,E)];case 3:return O=se.sent(),q=this.b64Encode.urlEncodeArr(new Uint8Array(O)),_e=x+"."+q,n&&n.endMeasurement({success:!0}),[2,_e]}})})},r.prototype.hashString=function(e){return $(this,void 0,void 0,function(){var t,o;return M(this,function(i){switch(i.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=i.sent(),o=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(o)]}})})},r.POP_KEY_USAGES=["sign","verify"],r.EXTRACTABLE=!0,r}();a();l();c();a();l();c();var xh=function(){function r(e,t){this.correlationId=t,this.measureName=r.makeMeasureName(e,t),this.startMark=r.makeStartMark(e,t),this.endMark=r.makeEndMark(e,t)}return r.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},r.makeStartMark=function(e,t){return"msal.start."+e+"."+t},r.makeEndMark=function(e,t){return"msal.end."+e+"."+t},r.supportsBrowserPerformance=function(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.mark=="function"&&typeof window.performance.measure=="function"&&typeof window.performance.clearMarks=="function"&&typeof window.performance.clearMeasures=="function"&&typeof window.performance.getEntriesByName=="function"},r.flushMeasurements=function(e,t){if(r.supportsBrowserPerformance())try{t.forEach(function(o){var i=r.makeMeasureName(o.name,e),n=window.performance.getEntriesByName(i,"measure");n.length>0&&(window.performance.clearMeasures(i),window.performance.clearMarks(r.makeStartMark(i,e)),window.performance.clearMarks(r.makeEndMark(i,e)))})}catch{}},r.prototype.startMeasurement=function(){if(r.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch{}},r.prototype.endMeasurement=function(){if(r.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch{}},r.prototype.flushMeasurement=function(){if(r.supportsBrowserPerformance())try{var e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){var t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch{}return null},r}();var Og=function(r){ct(e,r);function e(t,o,i,n,s,d,u){var h=r.call(this,t,o,i,n,s,d)||this;return h.browserCrypto=new Ch(h.logger,u),h.guidGenerator=new yh(h.browserCrypto),h}return e.prototype.startPerformanceMeasuremeant=function(t,o){return new xh(t,o)},e.prototype.generateId=function(){return this.guidGenerator.generateGuid()},e.prototype.getPageVisibility=function(){var t;return((t=document.visibilityState)===null||t===void 0?void 0:t.toString())||null},e.prototype.deleteIncompleteSubMeasurements=function(t){var o=this.eventsByCorrelationId.get(t.event.correlationId),i=o&&o.eventId===t.event.eventId,n=[];i&&o?.incompleteSubMeasurements&&o.incompleteSubMeasurements.forEach(function(s){n.push(te({},s))}),n.length>0&&xh.flushMeasurements(t.event.correlationId,n)},e.prototype.supportsBrowserPerformanceNow=function(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.now=="function"},e.prototype.startMeasurement=function(t,o){var i=this,n=this.getPageVisibility(),s=r.prototype.startMeasurement.call(this,t,o);return te(te({},s),{endMeasurement:function(d){var u=s.endMeasurement(te({startPageVisibility:n,endPageVisibility:i.getPageVisibility()},d));return i.deleteIncompleteSubMeasurements(s),u},discardMeasurement:function(){s.discardMeasurement(),i.deleteIncompleteSubMeasurements(s),s.measurement.flushMeasurement()}})},e.prototype.setPreQueueTime=function(t,o){if(!this.supportsBrowserPerformanceNow()){this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+t);return}if(!o){this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to set telemetry queue time");return}var i=this.preQueueTimeByCorrelationId.get(o);i&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+i.name+" found",o),this.addQueueMeasurement(i.name,o,void 0,!0)),this.preQueueTimeByCorrelationId.set(o,{name:t,time:window.performance.now()})},e.prototype.addQueueMeasurement=function(t,o,i,n){if(!this.supportsBrowserPerformanceNow()){this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t);return}if(!o){this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");return}var s=r.prototype.getPreQueueTime.call(this,t,o);if(s){var d=window.performance.now(),u=i||r.prototype.calculateQueuedTime.call(this,s,d);return r.prototype.addQueueMeasurement.call(this,t,o,u,n)}},e}(Bc);a();l();c();a();l();c();a();l();c();var Aw=function(){function r(e,t,o,i){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=o,this.cryptoObj=i}return r.prototype.loadExternalTokens=function(e,t,o){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw H.createUnableToLoadTokenError("Please ensure server response includes id token.");var i=new rr(t.id_token,this.cryptoObj),n,s;if(e.account){var d=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new gn(d,this.loadIdToken(i,d.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,d.homeAccountId,e.account.environment,e.account.tenantId,o),this.loadRefreshToken(e,t,d.homeAccountId,e.account.environment))}else if(e.authority){var u=yn.generateAuthority(e.authority,e.azureCloudOptions),h={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(s=new yn(u,this.config.system.networkClient,this.storage,h,this.logger),o.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");var d=this.loadAccount(i,s.hostnameAndPort,o.clientInfo,s.authorityType);n=new gn(d,this.loadIdToken(i,d.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,t,d.homeAccountId,s.hostnameAndPort,s.tenant,o),this.loadRefreshToken(e,t,d.homeAccountId,s.hostnameAndPort))}else if(t.client_info){this.logger.trace("TokenCache - homeAccountId from response");var d=this.loadAccount(i,s.hostnameAndPort,t.client_info,s.authorityType);n=new gn(d,this.loadIdToken(i,d.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,t,d.homeAccountId,s.hostnameAndPort,s.tenant,o),this.loadRefreshToken(e,t,d.homeAccountId,s.hostnameAndPort))}else throw H.createUnableToLoadTokenError("Please provide clientInfo in the response or options.")}else throw H.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");return this.generateAuthenticationResult(e,i,n,s)},r.prototype.loadAccount=function(e,t,o,i,n){var s;if(n?s=n:i!==void 0&&o&&(s=At.generateHomeAccountId(o,i,this.logger,this.cryptoObj,e)),!s)throw H.createUnableToLoadTokenError("Unexpected missing homeAccountId");var d=o?At.createAccount(o,s,e,void 0,void 0,void 0,t):At.createGenericAccount(s,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(d),d;throw H.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadIdToken=function(e,t,o,i){var n=zo.createIdTokenEntity(t,o,e.rawToken,this.config.auth.clientId,i);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(n),n;throw H.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadAccessToken=function(e,t,o,i,n,s){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw H.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!s.extendedExpiresOn)throw H.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var d=new bt(e.scopes).printScopes(),u=s.expiresOn||t.expires_in+new Date().getTime()/1e3,h=s.extendedExpiresOn,p=qo.createAccessTokenEntity(o,i,t.access_token,this.config.auth.clientId,n,d,u,h,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(p),p;throw H.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadRefreshToken=function(e,t,o,i){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var n=Di.createRefreshTokenEntity(o,i,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(n),n;throw H.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.generateAuthenticationResult=function(e,t,o,i){var n,s,d,u=S.EMPTY_STRING,h=[],p=null,v;o?.accessToken&&(u=o.accessToken.secret,h=bt.fromString(o.accessToken.target).asArray(),p=new Date(Number(o.accessToken.expiresOn)*1e3),v=new Date(Number(o.accessToken.extendedExpiresOn)*1e3));var C=t?.claims.oid||t?.claims.sub||S.EMPTY_STRING,x=t?.claims.tid||S.EMPTY_STRING;return{authority:i?i.canonicalAuthority:S.EMPTY_STRING,uniqueId:C,tenantId:x,scopes:h,account:o?.account?o.account.getAccountInfo():null,idToken:t?t.rawToken:S.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:u,fromCache:!0,expiresOn:p,correlationId:e.correlationId||S.EMPTY_STRING,requestId:S.EMPTY_STRING,extExpiresOn:v,familyId:S.EMPTY_STRING,tokenType:((n=o?.accessToken)===null||n===void 0?void 0:n.tokenType)||S.EMPTY_STRING,state:S.EMPTY_STRING,cloudGraphHostName:((s=o?.account)===null||s===void 0?void 0:s.cloudGraphHostName)||S.EMPTY_STRING,msGraphHost:((d=o?.account)===null||d===void 0?void 0:d.msGraphHost)||S.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},r}();a();l();c();a();l();c();var Rw=function(r){ct(e,r);function e(t){var o=r.call(this,t)||this;return o.includeRedirectUri=!1,o}return e}(Hc);var Pw=function(r){ct(e,r);function e(t,o,i,n,s,d,u,h,p,v){var C=r.call(this,t,o,i,n,s,d,h,p,v)||this;return C.apiId=u,C}return e.prototype.acquireToken=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u,h;return M(this,function(p){switch(p.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw H.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(A.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,X.Silent)];case 1:o=p.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||S.EMPTY_STRING,o.account||null),i=this.initializeServerTelemetryManager(this.apiId),p.label=2;case 2:return p.trys.push([2,4,,5]),n=te(te({},o),{code:t.code}),this.performanceClient.setPreQueueTime(A.StandardInteractionClientGetClientConfiguration,t.correlationId),[4,this.getClientConfiguration(i,o.authority)];case 3:return s=p.sent(),d=new Rw(s),this.logger.verbose("Auth code client created"),u=new vh(d,this.browserStorage,n,this.logger,this.config.system,this.performanceClient),[2,u.handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},o.state,d.authority,this.networkClient,!1)];case 4:throw h=p.sent(),h instanceof Y&&h.setCorrelationId(this.correlationId),i.cacheFailedRequest(h),this.browserStorage.cleanRequestByState(o.state),h;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(H.createSilentLogoutUnsupportedError())},e}(Oo);var Ow=function(){function r(e){this.isBrowserEnvironment=typeof window<"u",this.config=Cw(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new $i(this.config.system.loggerOptions,fl,bi),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new Og(this.config.auth.clientId,this.config.auth.authority,this.logger,fl,bi,this.config.telemetry.application,this.config.system.cryptoOptions):new wg(this.config.auth.clientId,this.config.auth.authority,this.logger,fl,bi,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Kc(this.logger,this.performanceClient,this.config.system.cryptoOptions):Qn,this.eventHandler=new Rg(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new zc(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):vw(this.config.auth.clientId,this.logger);var t={cacheLocation:$t.MemoryStorage,temporaryCacheLocation:$t.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};this.nativeInternalStorage=new zc(this.config.auth.clientId,t,this.browserCrypto,this.logger),this.tokenCache=new Aw(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return r.prototype.initialize=function(){return $(this,void 0,void 0,function(){var e,t,o,i,n;return M(this,function(s){switch(s.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(A.InitializeClientApplication),this.eventHandler.emitEvent(le.INITIALIZE_START),!e)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),o=this,[4,$o.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return o.nativeExtensionProvider=s.sent(),[3,4];case 3:return i=s.sent(),this.logger.verbose(i),[3,4];case 4:return this.config.cache.claimsBasedCachingEnabled?[3,6]:(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),n=this.performanceClient.startMeasurement(A.ClearTokensAndKeysWithClaims),[4,this.browserStorage.clearTokensAndKeysWithClaims()]);case 5:s.sent(),n.endMeasurement({success:!0}),s.label=6;case 6:return this.initialized=!0,this.eventHandler.emitEvent(le.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}})})},r.prototype.handleRedirectPromise=function(e){return $(this,void 0,void 0,function(){var t,o,i,n,s,d,u,h,p=this;return M(this,function(v){return this.logger.verbose("handleRedirectPromise called"),ft.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(o=e||S.EMPTY_STRING,i=this.redirectResponse.get(o),typeof i>"u"?(this.eventHandler.emitEvent(le.HANDLE_REDIRECT_START,X.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),n=this.browserStorage.getCachedNativeRequest(),s=void 0,n&&$o.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),d=new Ci(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId),s=d.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),u=this.browserStorage.getTemporaryCache(We.CORRELATION_ID,!0)||S.EMPTY_STRING,h=this.createRedirectClient(u),s=h.handleRedirectPromise(e)),i=s.then(function(C){if(C){var x=t.length<p.getAllAccounts().length;x?(p.eventHandler.emitEvent(le.LOGIN_SUCCESS,X.Redirect,C),p.logger.verbose("handleRedirectResponse returned result, login success")):(p.eventHandler.emitEvent(le.ACQUIRE_TOKEN_SUCCESS,X.Redirect,C),p.logger.verbose("handleRedirectResponse returned result, acquire token success"))}return p.eventHandler.emitEvent(le.HANDLE_REDIRECT_END,X.Redirect),C}).catch(function(C){throw t.length>0?p.eventHandler.emitEvent(le.ACQUIRE_TOKEN_FAILURE,X.Redirect,null,C):p.eventHandler.emitEvent(le.LOGIN_FAILURE,X.Redirect,null,C),p.eventHandler.emitEvent(le.HANDLE_REDIRECT_END,X.Redirect),C}),this.redirectResponse.set(o,i)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,i]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},r.prototype.acquireTokenRedirect=function(e){return $(this,void 0,void 0,function(){var t,o,i,n,s,d=this;return M(this,function(u){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(X.Redirect),o=this.getAllAccounts().length>0,o?this.eventHandler.emitEvent(le.ACQUIRE_TOKEN_START,X.Redirect,e):this.eventHandler.emitEvent(le.LOGIN_START,X.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(n=new Ci(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),i=n.acquireTokenRedirect(e).catch(function(h){if(h instanceof no&&h.isFatal()){d.nativeExtensionProvider=void 0;var p=d.createRedirectClient(e.correlationId);return p.acquireToken(e)}else if(h instanceof ar){d.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");var p=d.createRedirectClient(e.correlationId);return p.acquireToken(e)}throw d.browserStorage.setInteractionInProgress(!1),h})):(s=this.createRedirectClient(e.correlationId),i=s.acquireToken(e)),[2,i.catch(function(h){throw o?d.eventHandler.emitEvent(le.ACQUIRE_TOKEN_FAILURE,X.Redirect,null,h):d.eventHandler.emitEvent(le.LOGIN_FAILURE,X.Redirect,null,h),h})]})})},r.prototype.acquireTokenPopup=function(e){var t=this,o=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement(A.AcquireTokenPopup,o);try{this.logger.verbose("acquireTokenPopup called",o),this.preflightBrowserEnvironmentCheck(X.Popup)}catch(u){return Promise.reject(u)}var n=this.getAllAccounts();n.length>0?this.eventHandler.emitEvent(le.ACQUIRE_TOKEN_START,X.Popup,e):this.eventHandler.emitEvent(le.LOGIN_START,X.Popup,e);var s;if(this.canUseNative(e))s=this.acquireTokenNative(e,nt.acquireTokenPopup).then(function(u){return t.browserStorage.setInteractionInProgress(!1),i.endMeasurement({success:!0,isNativeBroker:!0,requestId:u.requestId}),u}).catch(function(u){if(u instanceof no&&u.isFatal()){t.nativeExtensionProvider=void 0;var h=t.createPopupClient(e.correlationId);return h.acquireToken(e)}else if(u instanceof ar){t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");var h=t.createPopupClient(e.correlationId);return h.acquireToken(e)}throw t.browserStorage.setInteractionInProgress(!1),u});else{var d=this.createPopupClient(e.correlationId);s=d.acquireToken(e)}return s.then(function(u){var h=n.length<t.getAllAccounts().length;return h?t.eventHandler.emitEvent(le.LOGIN_SUCCESS,X.Popup,u):t.eventHandler.emitEvent(le.ACQUIRE_TOKEN_SUCCESS,X.Popup,u),i.addStaticFields({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),i.endMeasurement({success:!0,requestId:u.requestId}),u}).catch(function(u){return n.length>0?t.eventHandler.emitEvent(le.ACQUIRE_TOKEN_FAILURE,X.Popup,null,u):t.eventHandler.emitEvent(le.LOGIN_FAILURE,X.Popup,null,u),i.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),Promise.reject(u)})},r.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},r.prototype.ssoSilent=function(e){var t;return $(this,void 0,void 0,function(){var o,i,n,s,d=this;return M(this,function(u){return o=this.getRequestCorrelationId(e),i=te(te({},e),{prompt:e.prompt,correlationId:o}),this.preflightBrowserEnvironmentCheck(X.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(A.SsoSilent,o),(t=this.ssoSilentMeasurement)===null||t===void 0||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",o),this.eventHandler.emitEvent(le.SSO_SILENT_START,X.Silent,i),this.canUseNative(i)?n=this.acquireTokenNative(i,nt.ssoSilent).catch(function(h){if(h instanceof no&&h.isFatal()){d.nativeExtensionProvider=void 0;var p=d.createSilentIframeClient(i.correlationId);return p.acquireToken(i)}throw h}):(s=this.createSilentIframeClient(i.correlationId),n=s.acquireToken(i)),[2,n.then(function(h){var p,v;return d.eventHandler.emitEvent(le.SSO_SILENT_SUCCESS,X.Silent,h),(p=d.ssoSilentMeasurement)===null||p===void 0||p.addStaticFields({accessTokenSize:h.accessToken.length,idTokenSize:h.idToken.length}),(v=d.ssoSilentMeasurement)===null||v===void 0||v.endMeasurement({success:!0,isNativeBroker:h.fromNativeBroker,requestId:h.requestId}),h}).catch(function(h){var p;throw d.eventHandler.emitEvent(le.SSO_SILENT_FAILURE,X.Silent,null,h),(p=d.ssoSilentMeasurement)===null||p===void 0||p.endMeasurement({errorCode:h.errorCode,subErrorCode:h.subError,success:!1}),h}).finally(function(){document.removeEventListener("visibilitychange",d.trackPageVisibilityWithMeasurement)})]})})},r.prototype.acquireTokenByCode=function(e){return $(this,void 0,void 0,function(){var t,o,i,n,s=this;return M(this,function(d){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(X.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(le.ACQUIRE_TOKEN_BY_CODE_START,X.Silent,e),o=this.performanceClient.startMeasurement(A.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw H.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return i=e.code,n=this.hybridAuthCodeResponses.get(i),n?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),o.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),n=this.acquireTokenByCodeAsync(te(te({},e),{correlationId:t})).then(function(u){return s.eventHandler.emitEvent(le.ACQUIRE_TOKEN_BY_CODE_SUCCESS,X.Silent,u),s.hybridAuthCodeResponses.delete(i),o.addStaticFields({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),o.endMeasurement({success:!0,isNativeBroker:u.fromNativeBroker,requestId:u.requestId}),u}).catch(function(u){throw s.hybridAuthCodeResponses.delete(i),s.eventHandler.emitEvent(le.ACQUIRE_TOKEN_BY_CODE_FAILURE,X.Silent,null,u),o.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),u}),this.hybridAuthCodeResponses.set(i,n)),[2,n];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,nt.acquireTokenByCode,e.nativeAccountId).catch(function(u){throw u instanceof no&&u.isFatal()&&(s.nativeExtensionProvider=void 0),u})];throw H.createUnableToAcquireTokenFromNativePlatformError()}else throw H.createAuthCodeOrNativeAccountIdRequiredError()}catch(u){throw this.eventHandler.emitEvent(le.ACQUIRE_TOKEN_BY_CODE_FAILURE,X.Silent,null,u),o.endMeasurement({errorCode:u instanceof Y&&u.errorCode||void 0,subErrorCode:u instanceof Y&&u.subError||void 0,success:!1}),u}return[2]})})},r.prototype.acquireTokenByCodeAsync=function(e){var t;return $(this,void 0,void 0,function(){var o,i,n=this;return M(this,function(s){switch(s.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(A.AcquireTokenByCodeAsync,e.correlationId),(t=this.acquireTokenByCodeAsyncMeasurement)===null||t===void 0||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),o=this.createSilentAuthCodeClient(e.correlationId),[4,o.acquireToken(e).then(function(d){var u;return(u=n.acquireTokenByCodeAsyncMeasurement)===null||u===void 0||u.endMeasurement({success:!0,fromCache:d.fromCache,isNativeBroker:d.fromNativeBroker,requestId:d.requestId}),d}).catch(function(d){var u;throw(u=n.acquireTokenByCodeAsyncMeasurement)===null||u===void 0||u.endMeasurement({errorCode:d.errorCode,subErrorCode:d.subError,success:!1}),d}).finally(function(){document.removeEventListener("visibilitychange",n.trackPageVisibilityWithMeasurement)})];case 1:return i=s.sent(),[2,i]}})})},r.prototype.acquireTokenFromCache=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){switch(this.performanceClient.addQueueMeasurement(A.AcquireTokenFromCache,t.correlationId),o.cacheLookupPolicy){case Dr.Default:case Dr.AccessToken:case Dr.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw L.createRefreshRequiredError()}return[2]})})},r.prototype.acquireTokenByRefreshToken=function(e,t){return $(this,void 0,void 0,function(){var o;return M(this,function(i){switch(this.performanceClient.addQueueMeasurement(A.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case Dr.Default:case Dr.AccessTokenAndRefreshToken:case Dr.RefreshToken:case Dr.RefreshTokenAndNetwork:return o=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(A.SilentRefreshClientAcquireToken,e.correlationId),[2,o.acquireToken(e)];default:throw L.createRefreshRequiredError()}return[2]})})},r.prototype.acquireTokenBySilentIframe=function(e){return $(this,void 0,void 0,function(){var t;return M(this,function(o){return this.performanceClient.addQueueMeasurement(A.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(A.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]})})},r.prototype.logout=function(e){return $(this,void 0,void 0,function(){var t;return M(this,function(o){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(te({correlationId:t},e))]})})},r.prototype.logoutRedirect=function(e){return $(this,void 0,void 0,function(){var t,o;return M(this,function(i){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(X.Redirect),o=this.createRedirectClient(t),[2,o.logout(e)]})})},r.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);this.preflightBrowserEnvironmentCheck(X.Popup);var o=this.createPopupClient(t);return o.logout(e)}catch(i){return Promise.reject(i)}},r.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},r.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},r.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},r.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},r.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},r.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},r.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(t===void 0&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),ft.blockNonBrowserEnvironment(this.isBrowserEnvironment),ft.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),ft.blockReloadInHiddenIframes(),ft.blockAcquireTokenInPopups(),ft.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===X.Redirect&&this.config.cache.cacheLocation===$t.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Cn.createInMemoryRedirectUnavailableError();(e===X.Redirect||e===X.Popup)&&this.preflightInteractiveRequest(t)},r.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),ft.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},r.prototype.acquireTokenNative=function(e,t,o){return $(this,void 0,void 0,function(){var i;return M(this,function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw H.createNativeConnectionNotEstablishedError();return i=new Ci(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,o||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),[2,i.acquireToken(e)]})})},r.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!$o.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Kt.NONE:case Kt.CONSENT:case Kt.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0},r.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},r.prototype.createPopupClient=function(e){return new Tg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createRedirectClient=function(e){return new Eg(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createSilentIframeClient=function(e){return new Ig(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createSilentCacheClient=function(e){return new Gc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.createSilentRefreshClient=function(e){return new Ag(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.createSilentAuthCodeClient=function(e){return new Pw(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},r.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},r.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},r.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},r.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},r.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},r.prototype.getTokenCache=function(){return this.tokenCache},r.prototype.getLogger=function(){return this.logger},r.prototype.setLogger=function(e){this.logger=e},r.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},r.prototype.setNavigationClient=function(e){this.navigationClient=e},r.prototype.getConfiguration=function(){return this.config},r.prototype.getRequestCorrelationId=function(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():S.EMPTY_STRING},r}();var $g=function(r){ct(e,r);function e(t){var o=r.call(this,t)||this;return o.astsAsyncMeasurement=void 0,o.activeSilentTokenRequests=new Map,o.trackPageVisibility=o.trackPageVisibility.bind(o),o}return e.prototype.loginRedirect=function(t){return $(this,void 0,void 0,function(){var o;return M(this,function(i){return o=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",o),[2,this.acquireTokenRedirect(te({correlationId:o},t||Sg))]})})},e.prototype.loginPopup=function(t){var o=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",o),this.acquireTokenPopup(te({correlationId:o},t||Sg))},e.prototype.acquireTokenSilent=function(t){return $(this,void 0,void 0,function(){var o,i,n,s,d,u,h,p=this;return M(this,function(v){if(o=this.getRequestCorrelationId(t),i=this.performanceClient.startMeasurement(A.AcquireTokenSilent,o),i.addStaticFields({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(X.Silent),this.logger.verbose("acquireTokenSilent called",o),n=t.account||this.getActiveAccount(),!n)throw H.createNoAccountError();return s={clientId:this.config.auth.clientId,authority:t.authority||S.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:n.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},d=JSON.stringify(s),u=this.activeSilentTokenRequests.get(d),typeof u>"u"?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",o),this.performanceClient.setPreQueueTime(A.AcquireTokenSilentAsync,o),h=this.acquireTokenSilentAsync(te(te({},t),{correlationId:o}),n).then(function(C){return p.activeSilentTokenRequests.delete(d),i.addStaticFields({accessTokenSize:C.accessToken.length,idTokenSize:C.idToken.length}),i.endMeasurement({success:!0,fromCache:C.fromCache,isNativeBroker:C.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:C.requestId}),C}).catch(function(C){throw p.activeSilentTokenRequests.delete(d),i.endMeasurement({errorCode:C.errorCode,subErrorCode:C.subError,success:!1}),C}),this.activeSilentTokenRequests.set(d,h),[2,h]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",o),i.discardMeasurement(),[2,u])})})},e.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},e.prototype.acquireTokenSilentAsync=function(t,o){var i;return $(this,void 0,void 0,function(){var n,s,d,u,h,p=this;return M(this,function(v){switch(v.label){case 0:return this.performanceClient.addQueueMeasurement(A.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(le.ACQUIRE_TOKEN_START,X.Silent,t),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(A.AcquireTokenSilentAsync,t.correlationId),(i=this.astsAsyncMeasurement)===null||i===void 0||i.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),$o.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&o.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),s=te(te({},t),{account:o}),n=this.acquireTokenNative(s,nt.acquireTokenSilent_silentFlow).catch(function(C){return $(p,void 0,void 0,function(){var x;return M(this,function(E){if(C instanceof no&&C.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,x=this.createSilentIframeClient(t.correlationId),[2,x.acquireToken(t)];throw C})})}),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),d=this.createSilentCacheClient(t.correlationId),this.performanceClient.setPreQueueTime(A.InitializeSilentRequest,t.correlationId),[4,d.initializeSilentRequest(t,o)];case 2:u=v.sent(),h=te(te({},t),{cacheLookupPolicy:t.cacheLookupPolicy||Dr.Default}),this.performanceClient.setPreQueueTime(A.AcquireTokenFromCache,u.correlationId),n=this.acquireTokenFromCache(d,u,h).catch(function(C){if(h.cacheLookupPolicy===Dr.AccessToken)throw C;return ft.blockReloadInHiddenIframes(),p.eventHandler.emitEvent(le.ACQUIRE_TOKEN_NETWORK_START,X.Silent,u),p.performanceClient.setPreQueueTime(A.AcquireTokenByRefreshToken,u.correlationId),p.acquireTokenByRefreshToken(u,h).catch(function(x){var E=x instanceof $r,O=x instanceof ar,q=x.errorCode===Li.noTokensFoundError.code,_e=x.errorCode===Sr.INVALID_GRANT_ERROR;if((!E||!_e||O||h.cacheLookupPolicy===Dr.AccessTokenAndRefreshToken||h.cacheLookupPolicy===Dr.RefreshToken)&&h.cacheLookupPolicy!==Dr.Skip&&!q)throw x;return p.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),p.performanceClient.setPreQueueTime(A.AcquireTokenBySilentIframe,u.correlationId),p.acquireTokenBySilentIframe(u)})}),v.label=3;case 3:return[2,n.then(function(C){var x;return p.eventHandler.emitEvent(le.ACQUIRE_TOKEN_SUCCESS,X.Silent,C),(x=p.astsAsyncMeasurement)===null||x===void 0||x.endMeasurement({success:!0,fromCache:C.fromCache,isNativeBroker:C.fromNativeBroker,requestId:C.requestId}),C}).catch(function(C){var x;throw p.eventHandler.emitEvent(le.ACQUIRE_TOKEN_FAILURE,X.Silent,null,C),(x=p.astsAsyncMeasurement)===null||x===void 0||x.endMeasurement({errorCode:C.errorCode,subErrorCode:C.subError,success:!1}),C}).finally(function(){document.removeEventListener("visibilitychange",p.trackPageVisibility)})]}})})},e}(Ow);a();l();c();a();l();c();var H3=function(){function r(){}return r.getInteractionStatusFromEvent=function(e,t){switch(e.eventType){case le.LOGIN_START:return xr.Login;case le.SSO_SILENT_START:return xr.SsoSilent;case le.ACQUIRE_TOKEN_START:if(e.interactionType===X.Redirect||e.interactionType===X.Popup)return xr.AcquireToken;break;case le.HANDLE_REDIRECT_START:return xr.HandleRedirect;case le.LOGOUT_START:return xr.Logout;case le.SSO_SILENT_SUCCESS:case le.SSO_SILENT_FAILURE:if(t&&t!==xr.SsoSilent)break;return xr.None;case le.LOGOUT_END:if(t&&t!==xr.Logout)break;return xr.None;case le.HANDLE_REDIRECT_END:if(t&&t!==xr.HandleRedirect)break;return xr.None;case le.LOGIN_SUCCESS:case le.LOGIN_FAILURE:case le.ACQUIRE_TOKEN_SUCCESS:case le.ACQUIRE_TOKEN_FAILURE:case le.RESTORE_FROM_BFCACHE:if(e.interactionType===X.Redirect||e.interactionType===X.Popup){if(t&&t!==xr.Login&&t!==xr.AcquireToken)break;return xr.None}break}return null},r}();a();l();c();var U3=function(){function r(e,t){var o=t&&t.loggerOptions||{};this.logger=new $i(o,fl,bi),this.cryptoOps=new Kc(this.logger),this.popTokenGenerator=new Po(this.cryptoOps),this.shrParameters=e}return r.prototype.generatePublicKeyThumbprint=function(){return $(this,void 0,void 0,function(){var e;return M(this,function(t){switch(t.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:return e=t.sent().kid,[2,e]}})})},r.prototype.signRequest=function(e,t,o){return $(this,void 0,void 0,function(){return M(this,function(i){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,o)]})})},r.prototype.removeKeys=function(e){return $(this,void 0,void 0,function(){return M(this,function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}})})},r}();var Wc=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},Mg;(function(r){r.SELECT_ACCOUNT="select_account",r.LOGIN="login",r.CONSENT="consent"})(Mg||(Mg={}));var Sh=class extends Hs{get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}get isMultiAccountDisabled(){return!this.isMultipleAccountEnabled}set isMultiAccountDisabled(e){this.isMultipleAccountEnabled=!e}get isMultiAccountSupportedAndEnabled(){return this.isMultipleAccountEnabled}get sessionStorageRequestedScopesKey(){return"mgt-requested-scopes"}get sessionStorageDeniedScopesKey(){return"mgt-denied-scopes"}get homeAccountKey(){return"275f3731-e4a4-468a-bf9c-baca24b31e26"}constructor(e){super(),this.isMultipleAccountEnabled=!0,this.initProvider(e)}initProvider(e){return Wc(this,void 0,void 0,function*(){let t=e.options||{auth:{clientId:""}};if(this.ms_config=t,this.ms_config.cache=t.cache||{},this.ms_config.cache.cacheLocation=t.cache.cacheLocation||"localStorage",(typeof this.ms_config.cache.storeAuthStateInCookie>"u"||this.ms_config.cache.storeAuthStateInCookie===null)&&(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,e.authority&&(this.ms_config.auth.authority=e.authority),e.redirectUri&&(this.ms_config.auth.redirectUri=e.redirectUri),"clientId"in e)if(e.clientId)this.ms_config.auth.clientId=e.clientId,this._publicClientApplication=new $g(this.ms_config);else throw new Error("clientId must be provided");else if("publicClientApplication"in e)if(e.publicClientApplication)this._publicClientApplication=e.publicClientApplication;else throw new Error("publicClientApplication must be provided");else throw new Error("either clientId or publicClientApplication must be provided");yield this._publicClientApplication.initialize(),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,this._loginType=typeof e.loginType<"u"?e.loginType:ln.Redirect,this._loginHint=typeof e.loginHint<"u"?e.loginHint:null,this._sid=typeof e.sid<"u"?e.sid:null,this.isIncrementalConsentDisabled=typeof e.isIncrementalConsentDisabled<"u"?e.isIncrementalConsentDisabled:!1,this._domainHint=typeof e.domainHint<"u"?e.domainHint:null,this.scopes=typeof e.scopes<"u"?e.scopes:["user.read"],this._prompt=typeof e.prompt<"u"?e.prompt:Mg.SELECT_ACCOUNT;let o=e;this.isMultipleAccountEnabled=typeof o.isMultiAccountEnabled<"u"?o.isMultiAccountEnabled:!0,this.baseURL=typeof o.baseURL<"u"?o.baseURL:this.baseURL,this.customHosts=o.customHosts,this.graph=Dm(this);try{let i=yield this._publicClientApplication.handleRedirectPromise();i!==null?this.handleResponse(i?.account):yield this.trySilentSignIn()}catch(i){throw console.error("\u{1F992}: Problem attempting to sign in",i),i}})}trySilentSignIn(){return Wc(this,void 0,void 0,function*(){let e={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){e.sid=this._sid,e.loginHint=this._loginHint;try{this.setState(Me.Loading);let t=yield this._publicClientApplication.ssoSilent(e);t&&this.handleResponse(t?.account)}catch{this.setState(Me.SignedOut)}}else{let t=this.getAccount();if(t&&(yield this.getAccessToken(null))){this.handleResponse(t);return}this.setState(Me.SignedOut)}})}login(){return Wc(this,void 0,void 0,function*(){let e={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType===ln.Popup){let t=yield this._publicClientApplication.loginPopup(e);this.handleResponse(t?.account)}else{let t=Object.assign({},e);yield this._publicClientApplication.loginRedirect(t)}})}getAllAccounts(){let e=[];return this._publicClientApplication.getAllAccounts().forEach(t=>{e.push({name:t.name,mail:t.username,id:t.homeAccountId})}),e}setActiveAccount(e){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(e.id)),this.setStoredAccount(),super.setActiveAccount(e)}getActiveAccount(){let e=this._publicClientApplication.getActiveAccount();return{name:e.name,mail:e.username,id:e.homeAccountId,tenantId:e.tenantId}}handleResponse(e){e!==null?(this.setActiveAccount({name:e.name,id:e.homeAccountId,mail:e.username}),this.setState(Me.SignedIn)):this.setState(Me.SignedOut),this.clearRequestedScopes()}storage(){switch(this.ms_config.cache.cacheLocation){case"localStorage":return window.localStorage;case"sessionStorage":default:return window.sessionStorage}}setStoredAccount(){this.clearStoredAccount(),this.storage().setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){let e=this.storage().getItem(this.homeAccountKey);return this._publicClientApplication.getAccountByHomeId(e)}clearStoredAccount(){this.storage().removeItem(this.homeAccountKey)}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let o=t.indexOf("openid");o!==-1&&t.splice(o,1),o=t.indexOf("profile"),o!==-1&&t.splice(o,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){let e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){let t=this.getDeniedScopes();if(t&&t.filter(o=>e.indexOf(o)!==-1).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){let e=this.getStoredAccount();return e||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return Wc(this,void 0,void 0,function*(){let t={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType===ln.Redirect?(this.setState(Me.SignedOut),yield this._publicClientApplication.logoutRedirect(t)):(yield this._publicClientApplication.logoutPopup(Object.assign({},t)),this._publicClientApplication.getAllAccounts.length===1||!this.isMultipleAccountEnabled?this.setState(Me.SignedOut):yield this.trySilentSignIn())})}getAccessToken(e){return Wc(this,void 0,void 0,function*(){let t=e?e.scopes||this.scopes:this.scopes,o={scopes:t,account:this.getAccount()};try{let i=o;return(yield this._publicClientApplication.acquireTokenSilent(i)).accessToken}catch(i){if(i instanceof ar){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===ln.Redirect)if(!this.areScopesDenied(t))this.setRequestedScopes(t),yield this._publicClientApplication.acquireTokenRedirect(o);else throw i;else try{return(yield this._publicClientApplication.acquireTokenPopup(o)).accessToken}catch(n){throw console.error("\u{1F992}: problem with pop-up sign in",n),n}}else this.setState(Me.SignedOut)}throw null})}};a();l();c();var $w="9aeac104-a6b6-45ca-bb7c-bf7c3083eeb2";var Fg="mgt/setProvider",Mw="blank.html";lt();Cc();nu();a();l();c();ut();Ao();ca();Wg();lt();es();Mh();Oh();nu();jg();wi();a();l();c();ut();var zR=[xt`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .signed-in-person{--person-background-color:$signed-in-background-color;padding:var(--login-button-padding,10px 16px)}:host .account{padding:0;margin:7px 0}:host fluent-button.signed-in{height:auto;min-width:auto}:host fluent-button.signed-in::part(control){width:100%;height:100%;padding:var(--login-button-padding,0);background:var(--login-signed-in-background,transparent);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-button.signed-in::part(control):focus-within,:host fluent-button.signed-in::part(control):hover{background:var(--login-signed-in-hover-background,var(--neutral-fill-stealth-hover));--secondary-text-color:var(--secondary-text-hover-color)}:host fluent-button.signed-out::part(control){color:var(--login-signed-out-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-signed-out-button-background,padding-box linear-gradient(var(--neutral-fill-rest),var(--neutral-fill-rest)),border-box var(--neutral-stroke-control-rest))}:host fluent-button.signed-out::part(control):focus-within,:host fluent-button.signed-out::part(control):hover{background:var(--login-signed-out-button-hover-background,var(--neutral-fill-stealth-hover))}:host fluent-button.small::part(control):hover{background:0 0}:host fluent-button:focus-visible{outline-style:var(--focus-ring-style,auto)}:host fluent-card{--fill-color:var(--login-popup-background-color, var(--neutral-layer-1));padding:var(--login-popup-padding,16px)}:host .login-root .small .signed-in-person{padding:0;background:0 0}:host .login-root .small .signed-in-person:focus-within,:host .login-root .small .signed-in-person:hover{background:0 0}:host .login-root .account-list{padding:calc(var(--design-unit) * 1px) 0;margin:0}:host .login-root .account-item{height:auto;min-width:auto;margin-top:4px;background:var(--login-popup-background-color,var(--neutral-layer-1));list-style-type:none;cursor:pointer}:host .login-root .account-item:hover{background:var(--login-account-item-hover-bg-color,var(--neutral-fill-stealth-hover));--person-background-color:$login-account-item-hover-bg-color}:host .login-root .flyout .flyout-command{color:var(--login-flyout-command-text-color,var(--accent-foreground-rest))}:host .login-root .flyout .popup-content .commands{display:flex;align-items:flex-end;justify-content:flex-end}:host .login-root .flyout .popup-content .commands fluent-button::part(control){color:var(--login-command-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-command-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .commands fluent-button::part(control):hover{background:var(--login-command-button-hover-background-color,var(--neutral-fill-stealth-hover))}:host .login-root .flyout .popup-content .content .main-profile{margin-bottom:56px;margin-top:27px}:host .login-root .flyout .popup-content .add-account{padding-top:16px}:host .login-root .flyout .popup-content .add-account fluent-button::part(control){color:var(--login-add-account-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-add-account-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .add-account fluent-button::part(control):hover{background:var(--login-add-account-button-hover-background-color,var(--neutral-fill-stealth-hover))}
`];a();l();c();var qR={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out",signInWithADifferentAccount:"Sign in with a different account"};zg();oc();tu();lt();var ja=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var d=r.length-1;d>=0;d--)(s=r[d])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Ka=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},a1=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function d(p){try{h(o.next(p))}catch(v){s(v)}}function u(p){try{h(o.throw(p))}catch(v){s(v)}}function h(p){p.done?n(p.value):i(p.value).then(d,u)}h((o=o.apply(r,e||[])).next())})},GR=()=>{Ds(Eb,Zd,qa,Qd),$h(),Ls(),Nt("login",nn)},nn=class extends qr{static get styles(){return zR}get strings(){return qR}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...qe.requiredScopes])]}constructor(){super(),this.showPresence=!1,this.loginView="full",this._arrowKeyLocation=-1,this.logout=()=>a1(this,void 0,void 0,function*(){if(!this.fireCustomEvent("logoutInitiated"))return;let e=he.globalProvider;e?.isMultiAccountSupportedAndEnabled&&localStorage.removeItem(e.getActiveAccount().id+this._userDetailsKey),e?.logout&&(yield e.logout(),this.userDetails=null,e.isMultiAccountSupportedAndEnabled&&localStorage.removeItem(e.getActiveAccount().id+this._userDetailsKey),this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))}),this.flyoutOpened=()=>{this._isFlyoutOpen=!0},this.flyoutClosed=()=>{this._isFlyoutOpen=!1},this.onUserKeyDown=e=>{if(!this.flyout.isOpen)return;let t=this.renderRoot.querySelector(".popup-content"),o=t.querySelectorAll("ul, fluent-button"),i=t.querySelector("#signout-button")||o[0],n=t.querySelector("#signin-different-account-button")||o[o.length-1];if(e.key==="Tab"&&e.shiftKey&&i===e.target&&(e.preventDefault(),n?.focus()),e.key==="Tab"&&!e.shiftKey&&n===e.target&&(e.preventDefault(),i?.focus()),e.key==="Escape"){let d=this.renderRoot.querySelector("#login-button");d?.focus()}let s=this.renderRoot.querySelector("fluent-card");e.shiftKey&&e.key==="Tab"&&e.target===s&&this.hideFlyout()},this.handleAccountListKeyDown=e=>{let t=this.renderRoot.querySelector("ul.account-list"),o,i=t?.children;for(let d of i){let u=d;u.setAttribute("tabindex","-1"),u.blur()}let n=t.childElementCount,s=e.key;if(s==="ArrowDown")this._arrowKeyLocation=(this._arrowKeyLocation+1+n)%n;else if(s==="ArrowUp")this._arrowKeyLocation=(this._arrowKeyLocation-1+n)%n;else if(s==="Tab"||s==="Escape"){this._arrowKeyLocation=-1,t.blur(),s==="Escape"&&(e.preventDefault(),e.stopPropagation());return}this._arrowKeyLocation>-1&&(o=i[this._arrowKeyLocation],o.setAttribute("tabindex","1"),o.focus())},this.onClick=()=>{this.userDetails&&this._isFlyoutOpen?this.hideFlyout():this.userDetails?this.showFlyout():this.login()},this._isFlyoutOpen=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("click",e=>e.stopPropagation())}login(){return a1(this,void 0,void 0,function*(){let e=he.globalProvider;!e.isMultiAccountSupportedAndEnabled&&(this.userDetails||!this.fireCustomEvent("loginInitiated"))||e?.login&&(yield e.login(),e.state===Me.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))})}render(){return T`
      <div class="login-root">
        ${this.renderButton()}
        ${this.renderFlyout()}
      </div>
    `}loadState(){return a1(this,void 0,void 0,function*(){let e=he.globalProvider;e&&!this.userDetails&&(e.state===Me.SignedIn?(this.userDetails=yield fa(e.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),e.isMultiAccountSupportedAndEnabled&&localStorage.setItem(he.globalProvider.getActiveAccount().id+this._userDetailsKey,JSON.stringify(this.userDetails)),this.fireCustomEvent("loginCompleted")):this.userDetails=null)})}renderButton(){var e;let t=((e=he.globalProvider)===null||e===void 0?void 0:e.state)===Me.SignedIn,o=Qt({"signed-in":t&&!!this.userDetails,"signed-out":!t,small:this.loginView==="avatar"}),i=t?"stealth":"neutral",n=t&&this.userDetails,s=n?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent(),d=n?this._isFlyoutOpen:void 0;return T`
      <fluent-button
        id="login-button"
        aria-expanded="${ts(d)}"
        appearance=${i}
        aria-label="${ts(t?void 0:this.strings.signInLinkSubtitle)}"
        ?disabled=${this.isLoadingState}
        @click=${this.onClick}
        class=${o}>
          ${s}
      </fluent-button>`}renderFlyout(){return Ot`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${this.flyoutOpened}
        @closed=${this.flyoutClosed}>
        <fluent-card 
          slot="flyout" 
          tabindex="0" 
          class="flyout-card"
          @keydown=${this.onUserKeyDown}
          >
          ${this.renderFlyoutContent()}
        </fluent-card>
      </mgt-flyout>`}renderFlyoutContent(){if(this.userDetails)return T`
       <div class="popup">
         <div class="popup-content">
           <div class="commands">
             ${this.renderFlyoutCommands()}
           </div>
           <div class="content">
             <div class="main-profile">
               ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
             </div>
             ${this.renderAccounts()}
           </div>
           ${this.renderAddAccountContent()}
         </div>
       </div>
     `}get hasMultipleAccounts(){var e,t,o,i;return((e=he.globalProvider)===null||e===void 0?void 0:e.isMultiAccountSupportedAndEnabled)&&((i=(o=(t=he.globalProvider)===null||t===void 0?void 0:t.getAllAccounts)===null||o===void 0?void 0:o.call(t))===null||i===void 0?void 0:i.length)>1}get usesVerticalPersonCard(){return this.loginView==="full"||this.hasMultipleAccounts}renderFlyoutPersonDetails(e,t){return this.renderTemplate("flyout-person-details",{personDetails:e,personImage:t})||Ot`
        <mgt-person
          .personDetails=${e}
          .personImage=${t}
          .view=${be.twolines}
          .line2Property=${"email"}
          ?vertical-layout=${this.usesVerticalPersonCard}
          class="person">
        </mgt-person>`}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||T`
        <fluent-button
          id="signout-button"
          appearance="stealth"
          size="medium"
          class="flyout-command"
          @click=${this.logout}
          aria-label=${this.strings.signOutLinkSubtitle}>
            ${this.strings.signOutLinkSubtitle}
        </fluent-button>`}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderAddAccountContent(){if(he.globalProvider.isMultiAccountSupportedAndEnabled)return T`
        <div class="add-account">
          <fluent-button
            id="signin-different-account-button"
            appearance="stealth"
            aria-label="${this.strings.signInWithADifferentAccount}"
            @click=${()=>void this.login()}>
            <span slot="start"><i>${Ce(D.SelectAccount,"currentColor")}</i></span>
            ${this.strings.signInWithADifferentAccount}
          </fluent-button>
        </div>`}parsePersonDisplayConfiguration(){let e={view:be.twolines,avatarSize:"small"};switch(this.loginView){case"avatar":e.view=be.image,e.avatarSize="small";break;case"compact":e.view=be.oneline,e.avatarSize="small";break;case"full":default:e.view=be.twolines,e.avatarSize="auto";break}return e}renderSignedInButtonContent(e,t){let o=this.renderTemplate("signed-in-button-content",{personDetails:e,personImage:t}),i=this.parsePersonDisplayConfiguration();return o||Ot`
        <mgt-person
          .personDetails=${this.userDetails}
          .personImage=${this._image}
          .view=${i.view}
          .showPresence=${this.showPresence}
          .avatarSize=${i.avatarSize}
          line2-property="email"
          class="signed-in-person"
        ></mgt-person>`}renderAccounts(){if(he.globalProvider.state===Me.SignedIn&&he.globalProvider.isMultiAccountSupportedAndEnabled){let e=he.globalProvider,t=e.getAllAccounts();if(t?.length>1)return T`
          <div id="accounts">
            <ul
              tabindex="0"
              class="account-list"
              part="account-list"
              aria-label="${this.ariaLabel}"
              @keydown=${this.handleAccountListKeyDown}
            >
              ${t.filter(o=>o.id!==e.getActiveAccount().id).map(o=>{let i=localStorage.getItem(o.id+this._userDetailsKey);return Ot`
                    <li
                      tabindex="-1"
                      part="account-item"
                      class="account-item"
                      @click=${()=>this.setActiveAccount(o)}
                      @keyup=${n=>{n.key==="Enter"&&this.setActiveAccount(o)}}
                    >
                      <mgt-person
                        .personDetails=${i?JSON.parse(i):null}
                        .fallbackDetails=${{displayName:o.name,mail:o.mail}}
                        .view=${bl.twolines}
                        class="account"
                      ></mgt-person>
                    </li>`})}
            </ul>
          </div>
       `}}setActiveAccount(e){he.globalProvider.setActiveAccount(e)}clearState(){this.userDetails=null,this._image=null,this._userDetailsKey=null,this._isFlyoutOpen=!1}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||T`
        <span>${this.strings.signInLinkSubtitle}</span>`}showFlyout(){let e=this.flyout;e&&e.open()}hideFlyout(){let e=this.flyout;e&&e.close()}};ja([G({attribute:"user-details",type:Object}),Ka("design:type",Object)],nn.prototype,"userDetails",void 0);ja([G({attribute:"show-presence",type:Boolean}),Ka("design:type",Object)],nn.prototype,"showPresence",void 0);ja([G({attribute:"login-view",type:String}),Ka("design:type",String)],nn.prototype,"loginView",void 0);ja([K(),Ka("design:type",Boolean)],nn.prototype,"_isFlyoutOpen",void 0);ja([K(),Ka("design:type",String)],nn.prototype,"_image",void 0);ja([K(),Ka("design:type",String)],nn.prototype,"_userDetailsKey",void 0);ja([K(),Ka("design:type",Object)],nn.prototype,"_arrowKeyLocation",void 0);Ls();GR();var x$=()=>{let e=new window.URL(window.location.href).searchParams.get("clientId");return e||$w};document.getElementById("mgt-version").innerText=js;var jR=new nh(!0),KR=new Sh({clientId:x$(),redirectUri:window.location.origin+"/"+Mw,scopes:["user.read","user.read.all","mail.readBasic","people.read","people.read.all","sites.read.all","user.readbasic.all","contacts.read","presence.read","presence.read.all","tasks.readwrite","tasks.read","calendars.read","group.read.all","files.read","files.read.all","files.readwrite","files.readwrite.all"],loginType:ln.Popup});he.globalProvider=KR;var S$=()=>{let[r,e]=b1(he.globalProvider.state),t=C1({STORY_RENDERED:n=>{console.log("storyRendered",n)}}),o=n=>{he.globalProvider.state===Me.SignedOut&&he.globalProvider!==jR?t(Fg,{state:n,provider:jR,name:"MgtMockProvider"}):t(Fg,{state:n,provider:KR,name:"MgtMsal2Provider"})};he.onProviderUpdated(()=>{e(he.globalProvider.state),o(he.globalProvider.state)});let i=()=>{he.globalProvider.logout()};return o(r),an.createElement(an.Fragment,null,he.globalProvider.state!==Me.SignedIn?an.createElement("mgt-login",{"login-view":"compact",style:{marginTop:"3px"}}):an.createElement(an.Fragment,null,an.createElement("mgt-person",{"person-query":"me",style:{marginTop:"8px"}}),an.createElement("fluent-button",{appearance:"lightweight",style:{marginTop:"3px"},onClick:i},"Sign Out")))};au.setConfig({enableShortcuts:!1,theme:y1});au.register("microsoft/graph-toolkit",r=>{let e=({active:t})=>an.createElement(S$,null);au.add("mgt/sign-in",{type:l1.TOOLEXTRA,title:"Sign In",match:({viewMode:t})=>!0,render:e})});
}catch(e){ console.error("[Storybook] One of your manager-entries failed: " + import.meta.url, e); }
