try{
(()=>{var E6=Object.defineProperty;var pv=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var y=(r,e)=>()=>(r&&(e=r(r=0)),e);var I6=(r,e)=>{for(var t in e)E6(r,t,{get:e[t],enumerable:!0})};var l=y(()=>{});var c=y(()=>{});var d=y(()=>{});var en,Fd=y(()=>{l();c();d();en=class{constructor(){this.eventHandlers=[]}fire(e){for(let t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}});var Dd,jC,Ld=y(()=>{l();c();d();Dd="https://graph.microsoft.com",jC=new Set([Dd,"https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn","https://canary.graph.microsoft.com"])});var ip,np=y(()=>{l();c();d();Ld();ip=r=>{try{let t=new URL(r).origin;if(jC.has(t))return t}catch{return}}});var Qa,ls,ce,Ws=y(()=>{l();c();d();np();Ld();Fd();Qa=class{get isMultiAccountSupportedAndEnabled(){return!1}get approvedScopes(){return this._approvedScopes}set approvedScopes(e){this._approvedScopes=e.map(t=>t.toLowerCase())}hasAtLeastOneApprovedScope(e){return e.some(t=>this.approvedScopes.includes(t.toLowerCase().trim()))}hasAllOneApprovedScope(e){return e.some(t=>!this.approvedScopes.includes(t.toLowerCase().trim()))}needsAdditionalScopes(e){let t=[];return e.length&&!this.hasAtLeastOneApprovedScope(e)&&t.push(e[0].trim()),t}set baseURL(e){if(ip(e)){this._baseURL=e;return}else throw new Error(`${e} is not a valid Graph URL endpoint.`)}get baseURL(){return this._baseURL}set customHosts(e){this._customHosts=e}get customHosts(){return this._customHosts}get isMultiAccountSupported(){return this.isMultipleAccountSupported}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(e){this._isIncrementalConsentDisabled=e}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new en,this._activeAccountChangedDispatcher=new en,this._baseURL=Dd,this._approvedScopes=[],this._customHosts=void 0,this._isIncrementalConsentDisabled=!1,this.isMultipleAccountSupported=!1,this._state=ce.Loading}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}setActiveAccount(e){this.fireActiveAccountChanged()}onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}removeActiveAccountChangedHandler(e){this._activeAccountChangedDispatcher.remove(e)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...e){return this.getAccessToken({scopes:e})}};(function(r){r[r.Popup=0]="Popup",r[r.Redirect=1]="Redirect"})(ls||(ls={}));(function(r){r[r.Loading=0]="Loading",r[r.SignedOut=1]="SignedOut",r[r.SignedIn=2]="SignedIn"})(ce||(ce={}))});var sp,K,ap,Ya=y(()=>{l();c();d();Fd();Ws();sp=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},K=class r{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.isMultiAccountSupportedAndEnabled&&this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.isMultiAccountSupportedAndEnabled&&e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(ap.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}static removeActiveAccountChangedListener(e){this._activeAccountChangedDispatcher.remove(e)}static me(){return this.client?(this._mePromise||(this._mePromise=this.getMe()),this._mePromise):(this._mePromise=null,null)}static getMe(){return sp(this,void 0,void 0,function*(){try{let e=yield this.client.api("me").get();if(e?.id)return e}catch{}return null})}static getCacheId(){var e;return sp(this,void 0,void 0,function*(){if(this._cacheId)return this._cacheId;if(((e=r.globalProvider)===null||e===void 0?void 0:e.state)===ce.SignedIn&&!this._cacheId&&this.client)try{this._cacheId=yield this.createCacheId()}catch{}return this._cacheId})}static unsetCacheId(){this._cacheId=null,this._mePromise=null}static createCacheId(){return sp(this,void 0,void 0,function*(){if(r.globalProvider.isMultiAccountSupportedAndEnabled){let e=this.createCacheIdWithAccountDetails();if(e)return e}return yield this.createCacheIdWithUserDetails()})}static createCacheIdWithUserDetails(){return sp(this,void 0,void 0,function*(){let e=yield this.me();return e?.id?e.id+"-"+e.userPrincipalName:null})}static createCacheIdWithAccountDetails(){let e=r.globalProvider.getActiveAccount();return e.tenantId&&e.id?e.tenantId+e.id:null}static get client(){return r.globalProvider&&r.globalProvider.state===ce.SignedIn?r.globalProvider.graph.client:null}};K._eventDispatcher=new en;K._activeAccountChangedDispatcher=new en;K.handleProviderStateChanged=()=>{(!K.globalProvider||K.globalProvider.state!==ce.SignedIn)&&(K._mePromise=null),K._eventDispatcher.fire(ap.ProviderStateChanged)};K.handleActiveAccountChanged=()=>{K.unsetCacheId(),K._activeAccountChangedDispatcher.fire(null)};(function(r){r[r.ProviderChanged=0]="ProviderChanged",r[r.ProviderStateChanged=1]="ProviderStateChanged"})(ap||(ap={}))});var lp,Sv=y(()=>{l();c();d();lp=class{}});function _e(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})}var Nr=y(()=>{l();c();d()});var wr,Nd=y(()=>{l();c();d();(function(r){r.GET="GET",r.PATCH="PATCH",r.POST="POST",r.PUT="PUT",r.DELETE="DELETE"})(wr||(wr={}))});var lc,KC=y(()=>{l();c();d();Nr();Nd();lc=class r{constructor(e){if(this.requests=new Map,typeof e<"u"){let t=r.requestLimit;if(e.length>t){let o=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw o.name="Limit Exceeded Error",o}for(let o of e)this.addRequest(o)}}static validateDependencies(e){let t=n=>{let s=n.entries(),a=s.next();for(;!a.done;){let u=a.value[1];if(u.dependsOn!==void 0&&u.dependsOn.length>0)return!1;a=s.next()}return!0},o=n=>{let s=n.entries(),a=s.next(),u=a.value[1];if(u.dependsOn!==void 0&&u.dependsOn.length>0)return!1;let h=a;for(a=s.next();!a.done;){let p=a.value[1];if(p.dependsOn===void 0||p.dependsOn.length!==1||p.dependsOn[0]!==h.value[1].id)return!1;h=a,a=s.next()}return!0},i=n=>{let s=n.entries(),a=s.next(),u=a.value[1],h;if(u.dependsOn===void 0||u.dependsOn.length===0)h=u.id;else if(u.dependsOn.length===1){let p=u.dependsOn[0];if(p!==u.id&&n.has(p))h=p;else return!1}else return!1;for(a=s.next();!a.done;){let p=a.value[1];if((p.dependsOn===void 0||p.dependsOn.length===0)&&h!==p.id||p.dependsOn!==void 0&&p.dependsOn.length!==0&&(p.dependsOn.length===1&&(p.id===h||p.dependsOn[0]!==h)||p.dependsOn.length>1))return!1;a=s.next()}return!0};if(e.size===0){let n=new Error("Empty requests map, Please provide at least one request.");throw n.name="Empty Requests Error",n}return t(e)||o(e)||i(e)}static getRequestData(e){return _e(this,void 0,void 0,function*(){let t={url:""},o=new RegExp("^https?://");t.url=o.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;let i={};return e.headers.forEach((n,s)=>{i[s]=n}),Object.keys(i).length&&(t.headers=i),(e.method===wr.PATCH||e.method===wr.POST||e.method===wr.PUT)&&(t.body=yield r.getRequestBody(e)),t})}static getRequestBody(e){return _e(this,void 0,void 0,function*(){let t=!1,o;try{o=yield e.clone().json(),t=!0}catch{}if(!t)try{if(typeof Blob<"u"){let i=yield e.blob(),n=new FileReader;o=yield new Promise(s=>{n.addEventListener("load",()=>{let a=n.result,h=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(a);s(h[4])},!1),n.readAsDataURL(i)})}else typeof Buffer<"u"&&(o=(yield e.buffer()).toString("base64"));t=!0}catch{}return o})}addRequest(e){let t=r.requestLimit;if(e.id===""){let o=new Error("Id for a request is empty, Please provide an unique id");throw o.name="Empty Id For Request",o}if(this.requests.size===t){let o=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw o.name="Limit Exceeded Error",o}if(this.requests.has(e.id)){let o=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw o.name="Duplicate RequestId Error",o}return this.requests.set(e.id,e),e.id}removeRequest(e){let t=this.requests.delete(e),o=this.requests.entries(),i=o.next();for(;!i.done;){let n=i.value[1].dependsOn;if(typeof n<"u"){let s=n.indexOf(e);s!==-1&&n.splice(s,1),n.length===0&&delete i.value[1].dependsOn}i=o.next()}return t}getContent(){return _e(this,void 0,void 0,function*(){let e=[],t={requests:e},o=this.requests.entries(),i=o.next();if(i.done){let n=new Error("No requests added yet, Please add at least one request.");throw n.name="Empty Payload",n}if(!r.validateDependencies(this.requests)){let n=new Error(`Invalid dependency found, Dependency should be:
1. Parallel - no individual request states a dependency in the dependsOn property.
2. Serial - all individual requests depend on the previous individual request.
3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);throw n.name="Invalid Dependency",n}for(;!i.done;){let n=i.value[1],s=yield r.getRequestData(n.request);if(s.body!==void 0&&(s.headers===void 0||s.headers["content-type"]===void 0)){let a=new Error(`Content-type header is not mentioned for request #${n.id}, For request having body, Content-type header should be mentioned`);throw a.name="Invalid Content-type header",a}s.id=n.id,n.dependsOn!==void 0&&n.dependsOn.length>0&&(s.dependsOn=n.dependsOn),e.push(s),i=o.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){let o=new Error(`Dependent ${e} does not exists, Please check the id`);throw o.name="Invalid Dependent",o}if(typeof t<"u"&&!this.requests.has(t)){let o=new Error(`Dependency ${t} does not exists, Please check the id`);throw o.name="Invalid Dependency",o}if(typeof t<"u"){let o=this.requests.get(e);if(o.dependsOn===void 0&&(o.dependsOn=[]),o.dependsOn.indexOf(t)!==-1){let i=new Error(`Dependency ${t} is already added for the request ${e}`);throw i.name="Duplicate Dependency",i}o.dependsOn.push(t)}else{let o=this.requests.entries(),i,n=o.next();for(;!n.done&&n.value[1].id!==e;)i=n,n=o.next();if(typeof i<"u"){let s=i.value[0];if(n.value[1].dependsOn===void 0&&(n.value[1].dependsOn=[]),n.value[1].dependsOn.indexOf(s)!==-1){let a=new Error(`Dependency ${s} is already added for the request ${e}`);throw a.name="Duplicate Dependency",a}n.value[1].dependsOn.push(s)}else{let s=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw s.name="Invalid Dependency Addition",s}}}removeDependency(e,t){let o=this.requests.get(e);if(typeof o>"u"||o.dependsOn===void 0||o.dependsOn.length===0)return!1;if(typeof t<"u"){let i=o.dependsOn.indexOf(t);return i===-1?!1:(o.dependsOn.splice(i,1),!0)}else return delete o.dependsOn,!0}};lc.requestLimit=20});var WC=y(()=>{l();c();d()});var QC,YC,ZC,_v=y(()=>{l();c();d();QC="v1.0",YC="https://graph.microsoft.com/",ZC=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"])});var Cr,cs=y(()=>{l();c();d();Cr=class r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,r.prototype)}static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new r,t.customError=e),t}}});var JC,XC,cp,dp,up,ex,g$,hp=y(()=>{l();c();d();_v();cs();JC=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],XC=r=>{let e=n=>n.replace(/\/+$/,""),t=n=>n.replace(/^\/+/,""),o=(n,s)=>[e(n),t(s)].join("/");return Array.prototype.slice.call(r).reduce(o)},cp=r=>{let e=r&&r.constructor&&r.constructor.name;if(e==="Buffer"||e==="Blob"||e==="File"||e==="FormData"||typeof r=="string")return r;if(e==="ArrayBuffer")r=Buffer.from(r);else if(e==="Int8Array"||e==="Int16Array"||e==="Int32Array"||e==="Uint8Array"||e==="Uint16Array"||e==="Uint32Array"||e==="Uint8ClampedArray"||e==="Float32Array"||e==="Float64Array"||e==="DataView")r=Buffer.from(r.buffer);else try{r=JSON.stringify(r)}catch{throw new Error("Unable to stringify the content")}return r},dp=r=>ex(r),up=(r,e)=>(e.forEach(t=>g$(t)),ex(r,e)),ex=(r,e=ZC)=>{if(r=r.toLowerCase(),r.indexOf("https://")!==-1){r=r.replace("https://","");let t=r.indexOf(":"),o=r.indexOf("/"),i="";if(o!==-1)return t!==-1&&t<o?(i=r.substring(0,t),e.has(i)):(i=r.substring(0,o),e.has(i))}return!1},g$=r=>{if(r.indexOf("/")!==-1)throw new Cr("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")}});var bo,Qs=y(()=>{l();c();d();bo=class{constructor(e=[]){this.middlewareOptions=new Map;for(let t of e){let o=t.constructor;this.middlewareOptions.set(o,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}});var Tv,cc,dc,pp,tx,Za=y(()=>{l();c();d();Nr();Tv=()=>{let r="";for(let e=0;e<32;e++)(e===8||e===12||e===16||e===20)&&(r+="-"),r+=Math.floor(Math.random()*16).toString(16);return r},cc=(r,e,t)=>{let o=null;if(typeof Request<"u"&&r instanceof Request)o=r.headers.get(t);else if(typeof e<"u"&&e.headers!==void 0)if(typeof Headers<"u"&&e.headers instanceof Headers)o=e.headers.get(t);else if(e.headers instanceof Array){let i=e.headers;for(let n=0,s=i.length;n<s;n++)if(i[n][0]===t){o=i[n][1];break}}else e.headers[t]!==void 0&&(o=e.headers[t]);return o},dc=(r,e,t,o)=>{if(typeof Request<"u"&&r instanceof Request)r.headers.set(t,o);else if(typeof e<"u")if(e.headers===void 0)e.headers=new Headers({[t]:o});else if(typeof Headers<"u"&&e.headers instanceof Headers)e.headers.set(t,o);else if(e.headers instanceof Array){let i=0,n=e.headers.length;for(;i<n;i++){let s=e.headers[i];if(s[0]===t){s[1]=o;break}}i===n&&e.headers.push([t,o])}else Object.assign(e.headers,{[t]:o})},pp=(r,e,t,o)=>{typeof Request<"u"&&r instanceof Request?r.headers.append(t,o):typeof e<"u"&&(e.headers===void 0?e.headers=new Headers({[t]:o}):typeof Headers<"u"&&e.headers instanceof Headers?e.headers.append(t,o):e.headers instanceof Array?e.headers.push([t,o]):e.headers===void 0?e.headers={[t]:o}:e.headers[t]===void 0?e.headers[t]=o:e.headers[t]+=`, ${o}`)},tx=(r,e)=>_e(void 0,void 0,void 0,function*(){let t=e.headers.get("Content-Type")?yield e.blob():yield Promise.resolve(void 0),{method:o,headers:i,referrer:n,referrerPolicy:s,mode:a,credentials:u,cache:h,redirect:p,integrity:f,keepalive:b,signal:x}=e;return new Request(r,{method:o,headers:i,body:t,referrer:n,referrerPolicy:s,mode:a,credentials:u,cache:h,redirect:p,integrity:f,keepalive:b,signal:x})})});var Ja,Ev=y(()=>{l();c();d();Ja=class{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}});var In,tn,uc=y(()=>{l();c();d();Qs();(function(r){r[r.NONE=0]="NONE",r[r.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",r[r.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",r[r.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(In||(In={}));tn=class r{constructor(){this.featureUsage=In.NONE}static updateFeatureUsageFlag(e,t){let o;e.middlewareControl instanceof bo?o=e.middlewareControl.getMiddlewareOptions(r):e.middlewareControl=new bo,typeof o>"u"&&(o=new r,e.middlewareControl.setMiddlewareOptions(r,o)),o.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}});var rn,fp=y(()=>{l();c();d();Nr();hp();Qs();Za();Ev();uc();rn=class r{constructor(e){this.authenticationProvider=e}execute(e){return _e(this,void 0,void 0,function*(){let t=typeof e.request=="string"?e.request:e.request.url;if(dp(t)||e.customHosts&&up(t,e.customHosts)){let o;e.middlewareControl instanceof bo&&(o=e.middlewareControl.getMiddlewareOptions(Ja));let i,n;o&&(i=o.authenticationProvider,n=o.authenticationProviderOptions),i||(i=this.authenticationProvider);let a=`Bearer ${yield i.getAccessToken(n)}`;pp(e.request,e.options,r.AUTHORIZATION_HEADER,a),tn.updateFeatureUsageFlag(e,In.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[r.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}};rn.AUTHORIZATION_HEADER="Authorization"});var An,mp=y(()=>{l();c();d();Nr();An=class{execute(e){return _e(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}});var Hr,Hd=y(()=>{l();c();d();Hr=class r{constructor(e=r.DEFAULT_DELAY,t=r.DEFAULT_MAX_RETRIES,o=r.defaultShouldRetry){if(e>r.MAX_DELAY&&t>r.MAX_MAX_RETRIES){let i=new Error(`Delay and MaxRetries should not be more than ${r.MAX_DELAY} and ${r.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e>r.MAX_DELAY){let i=new Error(`Delay should not be more than ${r.MAX_DELAY}`);throw i.name="MaxLimitExceeded",i}else if(t>r.MAX_MAX_RETRIES){let i=new Error(`MaxRetries should not be more than ${r.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e<0&&t<0){let i=new Error("Delay and MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}else if(e<0){let i=new Error("Delay should not be negative");throw i.name="MinExpectationNotMet",i}else if(t<0){let i=new Error("MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}this.delay=Math.min(e,r.MAX_DELAY),this.maxRetries=Math.min(t,r.MAX_MAX_RETRIES),this.shouldRetry=o}getMaxDelay(){return r.MAX_DELAY}};Hr.DEFAULT_DELAY=3;Hr.DEFAULT_MAX_RETRIES=3;Hr.MAX_DELAY=180;Hr.MAX_MAX_RETRIES=10;Hr.defaultShouldRetry=()=>!0});var li,gp=y(()=>{l();c();d();Nr();Nd();Qs();Za();Hd();uc();li=class r{constructor(e=new Hr){this.options=e}isRetry(e){return r.RETRY_STATUS_CODES.indexOf(e.status)!==-1}isBuffered(e,t){let o=typeof e=="string"?t.method:e.method;return!((o===wr.PUT||o===wr.PATCH||o===wr.POST)&&cc(e,t,"Content-Type")==="application/octet-stream")}getDelay(e,t,o){let i=()=>Number(Math.random().toFixed(3)),n=e.headers!==void 0?e.headers.get(r.RETRY_AFTER_HEADER):null,s;return n!==null?Number.isNaN(Number(n))?s=Math.round((new Date(n).getTime()-Date.now())/1e3):s=Number(n):s=t>=2?this.getExponentialBackOffTime(t)+o+i():o+i(),Math.min(s,this.options.getMaxDelay()+i())}getExponentialBackOffTime(e){return Math.round(1/2*(Math.pow(2,e)-1))}sleep(e){return _e(this,void 0,void 0,function*(){let t=e*1e3;return new Promise(o=>setTimeout(o,t))})}getOptions(e){let t;return e.middlewareControl instanceof bo&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),typeof t>"u"&&(t=Object.assign(new Hr,this.options)),t}executeWithRetry(e,t,o){return _e(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),t<o.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&o.shouldRetry(o.delay,t,e.request,e.options,e.response)){++t,dc(e.request,e.options,r.RETRY_ATTEMPT_HEADER,t.toString());let i=this.getDelay(e.response,t,o.delay);return yield this.sleep(i),yield this.executeWithRetry(e,t,o)}else return})}execute(e){return _e(this,void 0,void 0,function*(){let o=this.getOptions(e);return tn.updateFeatureUsageFlag(e,In.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,o)})}setNext(e){this.nextMiddleware=e}};li.RETRY_STATUS_CODES=[429,503,504];li.RETRY_ATTEMPT_HEADER="Retry-Attempt";li.RETRY_AFTER_HEADER="Retry-After"});var ci,Ud=y(()=>{l();c();d();ci=class r{constructor(e=r.DEFAULT_MAX_REDIRECTS,t=r.defaultShouldRedirect){if(e>r.MAX_MAX_REDIRECTS){let o=new Error(`MaxRedirects should not be more than ${r.MAX_MAX_REDIRECTS}`);throw o.name="MaxLimitExceeded",o}if(e<0){let o=new Error("MaxRedirects should not be negative");throw o.name="MinExpectationNotMet",o}this.maxRedirects=e,this.shouldRedirect=t}};ci.DEFAULT_MAX_REDIRECTS=5;ci.MAX_MAX_REDIRECTS=20;ci.defaultShouldRedirect=()=>!0});var on,vp=y(()=>{l();c();d();Nr();Nd();Qs();Za();Ud();uc();on=class r{constructor(e=new ci){this.options=e}isRedirect(e){return r.REDIRECT_STATUS_CODES.indexOf(e.status)!==-1}hasLocationHeader(e){return e.headers.has(r.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(r.LOCATION_HEADER)}isRelativeURL(e){return e.indexOf("://")===-1}shouldDropAuthorizationHeader(e,t){let o=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=o.exec(e),n,s;i!==null&&(n=i[0]);let a=o.exec(t);return a!==null&&(s=a[0]),typeof n<"u"&&typeof s<"u"&&n!==s}updateRequestUrl(e,t){return _e(this,void 0,void 0,function*(){t.request=typeof t.request=="string"?e:yield tx(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof bo&&(t=e.middlewareControl.getMiddlewareOptions(ci)),typeof t>"u"&&(t=Object.assign(new ci,this.options)),t}executeWithRedirect(e,t,o){return _e(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);let i=e.response;if(t<o.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&o.shouldRedirect(i)){if(++t,i.status===r.STATUS_CODE_SEE_OTHER)e.options.method=wr.GET,delete e.options.body;else{let n=this.getLocationHeader(i);!this.isRelativeURL(n)&&this.shouldDropAuthorizationHeader(i.url,n)&&delete e.options.headers[r.AUTHORIZATION_HEADER],yield this.updateRequestUrl(n,e)}yield this.executeWithRedirect(e,t,o)}else return})}execute(e){return _e(this,void 0,void 0,function*(){let o=this.getOptions(e);return e.options.redirect=r.MANUAL_REDIRECT,tn.updateFeatureUsageFlag(e,In.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,o)})}setNext(e){this.nextMiddleware=e}};on.REDIRECT_STATUS_CODES=[301,302,303,307,308];on.STATUS_CODE_SEE_OTHER=303;on.LOCATION_HEADER="Location";on.AUTHORIZATION_HEADER="Authorization";on.MANUAL_REDIRECT="manual"});var rx,ox=y(()=>{l();c();d();rx="3.0.2"});var qo,yp=y(()=>{l();c();d();Nr();hp();ox();Qs();Za();uc();qo=class r{execute(e){return _e(this,void 0,void 0,function*(){let t=typeof e.request=="string"?e.request:e.request.url;if(dp(t)||e.customHosts&&up(t,e.customHosts)){let o=cc(e.request,e.options,r.CLIENT_REQUEST_ID_HEADER);o||(o=Tv(),dc(e.request,e.options,r.CLIENT_REQUEST_ID_HEADER,o));let i=`${r.PRODUCT_NAME}/${rx}`,n;if(e.middlewareControl instanceof bo&&(n=e.middlewareControl.getMiddlewareOptions(tn)),n){let s=n.getFeatureUsage();i+=` (${r.FEATURE_USAGE_STRING}=${s})`}pp(e.request,e.options,r.SDK_VERSION_HEADER,i)}else delete e.options.headers[r.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[r.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}};qo.CLIENT_REQUEST_ID_HEADER="client-request-id";qo.SDK_VERSION_HEADER="SdkVersion";qo.PRODUCT_NAME="graph-js";qo.FEATURE_USAGE_STRING="featureUsage"});var ix=y(()=>{l();c();d();fp();mp();Ud();Hd();vp();gp();yp()});var Bd,bp=y(()=>{l();c();d();(function(r){r[r.MANUAL=0]="MANUAL",r[r.RANDOM=1]="RANDOM"})(Bd||(Bd={}))});var Iv=y(()=>{l();c();d();bp()});var nx=y(()=>{l();c();d()});var sx=y(()=>{l();c();d();Nr();Qs();Za();nx();Iv();bp()});var xr,zd=y(()=>{l();c();d();(function(r){r.ARRAYBUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.RAW="raw",r.STREAM="stream",r.TEXT="text"})(xr||(xr={}))});var Av,wp,Cp,hc,Rv=y(()=>{l();c();d();Nr();zd();(function(r){r.TEXT_HTML="text/html",r.TEXT_XML="text/xml",r.APPLICATION_XML="application/xml",r.APPLICATION_XHTML="application/xhtml+xml"})(Av||(Av={}));(function(r){r.TEXT_PLAIN="text/plain",r.APPLICATION_JSON="application/json"})(wp||(wp={}));(function(r){r.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",r.IMAGE="^image\\/.+"})(Cp||(Cp={}));hc=class r{static parseDocumentResponse(e,t){return typeof DOMParser<"u"?new Promise((o,i)=>{e.text().then(n=>{try{let a=new DOMParser().parseFromString(n,t);o(a)}catch(s){i(s)}})}):Promise.resolve(e.body)}static convertResponse(e,t){return _e(this,void 0,void 0,function*(){if(e.status===204)return Promise.resolve();let o,i=e.headers.get("Content-type");switch(t){case xr.ARRAYBUFFER:o=yield e.arrayBuffer();break;case xr.BLOB:o=yield e.blob();break;case xr.DOCUMENT:o=yield r.parseDocumentResponse(e,Av.TEXT_XML);break;case xr.JSON:o=yield e.json();break;case xr.STREAM:o=yield Promise.resolve(e.body);break;case xr.TEXT:o=yield e.text();break;default:if(i!==null){let n=i.split(";")[0];new RegExp(Cp.DOCUMENT).test(n)?o=yield r.parseDocumentResponse(e,n):new RegExp(Cp.IMAGE).test(n)?o=e.blob():n===wp.TEXT_PLAIN?o=yield e.text():n===wp.APPLICATION_JSON?o=yield e.json():o=Promise.resolve(e.body)}else o=Promise.resolve(e.body);break}return o})}static getResponse(e,t,o){return _e(this,void 0,void 0,function*(){if(t===xr.RAW)return Promise.resolve(e);{let i=yield r.convertResponse(e,t);if(e.ok)if(typeof o=="function")o(null,i);else return i;else throw i}})}}});var Ys,Pv=y(()=>{l();c();d();Ys=class{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}});var Vd,$v=y(()=>{l();c();d();Vd=class r{constructor(e,t){this._location=t,this._responseBody=e}get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}static CreateUploadResult(e,t){return new r(e,t.get("location"))}}});var qd,Ov=y(()=>{l();c();d();Nr();cs();Rv();zd();Pv();$v();qd=class{constructor(e,t,o,i={}){if(this.DEFAULT_FILE_SIZE=5*1024*1024,this.client=e,t.sliceFile)this.file=t;else throw new Cr("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,i.rangeSize||(i.rangeSize=this.DEFAULT_FILE_SIZE),this.options=i,this.uploadSession=o,this.nextRange=new Ys(0,this.options.rangeSize-1)}static createUploadSession(e,t,o,i={}){return _e(this,void 0,void 0,function*(){let n=yield e.api(t).headers(i).post(o);return{url:n.uploadUrl,expiry:new Date(n.expirationDateTime),isCancelled:!1}})}parseRange(e){let t=e[0];if(typeof t>"u"||t==="")return new Ys;let o=t.split("-"),i=parseInt(o[0],10),n=parseInt(o[1],10);return Number.isNaN(n)&&(n=this.file.size-1),new Ys(i,n)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(this.nextRange.minValue===-1)return this.nextRange;let e=this.nextRange.minValue,t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new Ys(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new Cr("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return _e(this,void 0,void 0,function*(){let e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){let t=this.getNextRange();if(t.maxValue===-1){let a=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw a.name="Invalid Session",a}let o=yield this.file.sliceFile(t),i=yield this.uploadSliceGetRawResponse(o,t,this.file.size);if(!i)throw new Cr("Something went wrong! Large file upload slice response is null.");let n=yield hc.getResponse(i);if(i.status===201||i.status===200&&n.id)return Vd.CreateUploadResult(n,i.headers);let s={expirationDateTime:n.expirationDateTime||n.ExpirationDateTime,nextExpectedRanges:n.NextExpectedRanges||n.nextExpectedRanges};this.updateTaskStatus(s),e&&e.progress&&e.progress(t,e.extraCallbackParam)}})}uploadSlice(e,t,o){return _e(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${o}`,"Content-Type":"application/octet-stream"}).put(e)})}uploadSliceGetRawResponse(e,t,o){return _e(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${o}`,"Content-Type":"application/octet-stream"}).responseType(xr.RAW).put(e)})}cancel(){return _e(this,void 0,void 0,function*(){let e=yield this.client.api(this.uploadSession.url).responseType(xr.RAW).delete();return e.status===204&&(this.uploadSession.isCancelled=!0),e})}getStatus(){return _e(this,void 0,void 0,function*(){let e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e})}resume(){return _e(this,void 0,void 0,function*(){return yield this.getStatus(),yield this.upload()})}getUploadSession(){return this.uploadSession}}});var Gd,Mv=y(()=>{l();c();d();cs();Gd=class{constructor(e,t,o){if(this.content=e,this.name=t,this.size=o,!e||!t||!o)throw new Cr("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}});var y$,Fv,Dv=y(()=>{l();c();d();y$=r=>(r>327680&&(r=Math.floor(r/327680)*320*1024),r),Fv=(r=5242880)=>(r>62914560&&(r=62914560),y$(r))});var xp,ax=y(()=>{l();c();d();Nr();cs();Mv();Ov();Dv();xp=class r extends qd{constructor(e,t,o,i){super(e,t,o,i)}static constructCreateSessionUrl(e,t=r.DEFAULT_UPLOAD_PATH){return e=e.trim(),t=t.trim(),t===""&&(t="/"),t[0]!=="/"&&(t=`/${t}`),t[t.length-1]!=="/"&&(t=`${t}/`),`/me/drive/root:${t.split("/").map(o=>encodeURIComponent(o)).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let o,i;if(typeof Blob<"u"&&e instanceof Blob)o=new File([e],t),i=o.size;else if(typeof File<"u"&&e instanceof File)o=e,i=o.size;else if(typeof Uint8Array<"u"&&e instanceof Uint8Array){let n=e;i=n.byteLength,o=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}return{content:o,size:i}}static create(e,t,o){return _e(this,void 0,void 0,function*(){if(!e||!t||!o)throw new Cr("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");let i=o.fileName,n=r.getFileInfo(t,i),s=new Gd(n.content,i,n.size);return this.createTaskWithFileObject(e,s,o)})}static createTaskWithFileObject(e,t,o){return _e(this,void 0,void 0,function*(){if(!e||!t||!o)throw new Cr("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");let i=r.constructCreateSessionUrl(o.fileName,o.path),n={fileName:o.fileName,fileDescription:o.fileDescription,conflictBehavior:o.conflictBehavior},s=yield r.createUploadSession(e,i,n),a=Fv(o.rangeSize);return new r(e,t,s,{rangeSize:a,uploadEventHandlers:o.uploadEventHandlers})})}static createUploadSession(e,t,o){let i=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return _e(this,void 0,void 0,function*(){let n={item:{"@microsoft.graph.conflictBehavior":o?.conflictBehavior||"rename",name:o?.fileName,description:o?.fileDescription}};return i.createUploadSession.call(this,e,t,n)})}commit(e,t="rename"){return _e(this,void 0,void 0,function*(){let o={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(o)})}};xp.DEFAULT_UPLOAD_PATH="/"});var lx=y(()=>{l();c();d();Nr();cs()});var cx=y(()=>{l();c();d();Nr()});var jd,Lv=y(()=>{l();c();d();Nr();cs();jd=class{constructor(e){this.provider=e}getAccessToken(){return _e(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((o,i)=>_e(this,void 0,void 0,function*(){if(i)e(i);else{if(!o){let s="Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md";o=new Cr(s)}let n=yield Cr.setGraphClientError(o);t(n)}}))})})}}});var Xa,Nv=y(()=>{l();c();d();Xa=class r extends Error{constructor(e=-1,t,o){super(t||o&&o.message),Object.setPrototypeOf(this,r.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=o?o.stack:this.stack}}});var kp,dx=y(()=>{l();c();d();Nr();Nv();kp=class r{static constructError(e,t){let o=new Xa(t,"",e);return e.name!==void 0&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o}static constructErrorFromResponse(e,t){let o=e.error,i=new Xa(t,o.message);return i.code=o.code,o.innerError!==void 0&&(i.requestId=o.innerError["request-id"],i.date=new Date(o.innerError.date)),i.body=JSON.stringify(o),i}static getError(e=null,t=-1,o){return _e(this,void 0,void 0,function*(){let i;if(e&&e.error?i=r.constructErrorFromResponse(e,t):e instanceof Error?i=r.constructError(e,t):(i=new Xa(t),i.body=e),typeof o=="function")o(i,null);else return i})}}});var Kd,Hv=y(()=>{l();c();d();Nr();cs();dx();hp();Rv();Qs();Nd();zd();Kd=class{constructor(e,t,o){this.parsePath=i=>{if(i.indexOf("https://")!==-1){i=i.replace("https://","");let s=i.indexOf("/");s!==-1&&(this.urlComponents.host="https://"+i.substring(0,s),i=i.substring(s+1,i.length));let a=i.indexOf("/");a!==-1&&(this.urlComponents.version=i.substring(0,a),i=i.substring(a+1,i.length))}i.charAt(0)==="/"&&(i=i.substr(1));let n=i.indexOf("?");if(n===-1)this.urlComponents.path=i;else{this.urlComponents.path=i.substr(0,n);let s=i.substring(n+1,i.length).split("&");for(let a of s)this.parseQueryParameter(a)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(o)}addCsvQueryParameter(e,t,o){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let i=[];o.length>1&&typeof t=="string"?i=Array.prototype.slice.call(o):typeof t=="string"?i.push(t):i=i.concat(t),this.urlComponents.oDataQueryParams[e]+=i.join(",")}buildFullUrl(){let e=XC([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){let e=this.urlComponents,t=[];if(Object.keys(e.oDataQueryParams).length!==0)for(let o in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,o)&&t.push(o+"="+e.oDataQueryParams[o]);if(Object.keys(e.otherURLQueryParams).length!==0)for(let o in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,o)&&t.push(o+"="+e.otherURLQueryParams[o]);if(e.otherURLQueryOptions.length!==0)for(let o of e.otherURLQueryOptions)t.push(o);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if(typeof e=="string")if(e.charAt(0)==="?"&&(e=e.substring(1)),e.indexOf("&")!==-1){let t=e.split("&");for(let o of t)this.parseQueryParamenterString(o)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){let t=e.indexOf("="),o=e.substring(0,t),i=e.substring(t+1);this.setURLComponentsQueryParamater(o,i)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(JC.indexOf(e)!==-1){let o=this.urlComponents.oDataQueryParams[e],i=o&&(e==="$expand"||e==="$select"||e==="$orderby");this.urlComponents.oDataQueryParams[e]=i?o+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){let t=e.indexOf("=");return!(t===-1||e.indexOf("(")!==-1&&e.indexOf("(")<t)}updateRequestOptions(e){let t=Object.assign({},e.headers);if(this.config.fetchOptions!==void 0){let o=Object.assign({},this.config.fetchOptions);Object.assign(e,o),typeof this.config.fetchOptions.headers!==void 0&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),e.headers!==void 0&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,o){var i;return _e(this,void 0,void 0,function*(){let n,s=new bo(this._middlewareOptions);this.updateRequestOptions(t);let a=(i=this.config)===null||i===void 0?void 0:i.customHosts;try{return n=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:s,customHosts:a})).response,yield hc.getResponse(n,this._responseType,o)}catch(u){if(u instanceof Cr)throw u;let h;throw n&&(h=n.status),yield kp.getError(u,h,o)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}let e=Object.keys(this._headers);for(let t of e)if(t.toLowerCase()==="content-type")return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return _e(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:wr.GET};return yield this.send(t,o,e)})}post(e,t){return _e(this,void 0,void 0,function*(){let o=this.buildFullUrl(),i={method:wr.POST,body:cp(e)};return(e&&e.constructor&&e.constructor.name)==="FormData"?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers),yield this.send(o,i,t)})}create(e,t){return _e(this,void 0,void 0,function*(){return yield this.post(e,t)})}put(e,t){return _e(this,void 0,void 0,function*(){let o=this.buildFullUrl();this.setHeaderContentType();let i={method:wr.PUT,body:cp(e)};return yield this.send(o,i,t)})}patch(e,t){return _e(this,void 0,void 0,function*(){let o=this.buildFullUrl();this.setHeaderContentType();let i={method:wr.PATCH,body:cp(e)};return yield this.send(o,i,t)})}update(e,t){return _e(this,void 0,void 0,function*(){return yield this.patch(e,t)})}delete(e){return _e(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:wr.DELETE};return yield this.send(t,o,e)})}del(e){return _e(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return _e(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:wr.GET};return this.responseType(xr.STREAM),yield this.send(t,o,e)})}putStream(e,t){return _e(this,void 0,void 0,function*(){let o=this.buildFullUrl(),i={method:wr.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(o,i,t)})}}});var pc,Uv=y(()=>{l();c();d();Nr();pc=class{constructor(...e){if(!e||!e.length){let t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,o)=>{o<e.length-1&&t.setNext(e[o+1])}),this.middleware=e[0]}sendRequest(e){return _e(this,void 0,void 0,function*(){if(typeof e.request=="string"&&e.options===void 0){let t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(e),e})}}});var b$,Sp,ux=y(()=>{l();c();d();Uv();fp();mp();Ud();Hd();vp();gp();yp();b$=()=>typeof process=="object"&&typeof pv=="function",Sp=class r{static createWithAuthenticationProvider(e){let t=new rn(e),o=new li(new Hr),i=new qo,n=new An;if(t.setNext(o),b$()){let s=new on(new ci);o.setNext(s),s.setNext(i)}else o.setNext(i);return i.setNext(n),r.createWithMiddleware(t)}static createWithMiddleware(...e){return new pc(...e)}}});var hx,px=y(()=>{l();c();d();hx=()=>{if(typeof Promise>"u"&&typeof fetch>"u"){let r=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw r.name="PolyFillNotAvailable",r}else if(typeof Promise>"u"){let r=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}else if(typeof fetch>"u"){let r=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}return!0}});var el,fx=y(()=>{l();c();d();_v();Lv();Hv();Uv();ux();px();el=class r{constructor(e){this.config={baseUrl:YC,debugLogging:!1,defaultVersion:QC},hx();for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&(this.config[o]=e[o]);let t;if(e.authProvider!==void 0&&e.middleware!==void 0){let o=new Error;throw o.name="AmbiguityInInitialization",o.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",o}else if(e.authProvider!==void 0)t=Sp.createWithAuthenticationProvider(e.authProvider);else if(e.middleware!==void 0)t=new pc(...[].concat(e.middleware));else{let o=new Error;throw o.name="InvalidMiddlewareChain",o.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",o}this.httpClient=t}static init(e){let t={};for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=o==="authProvider"?new jd(e[o]):e[o]);return r.initWithMiddleware(t)}static initWithMiddleware(e){return new r(e)}api(e){return new Kd(this.httpClient,this.config,e)}}});var tl=y(()=>{l();c();d();KC();WC();fp();mp();gp();vp();yp();ix();Ev();Hd();Ud();uc();Iv();bp();sx();Ov();ax();Dv();lx();Mv();$v();Pv();cx();fx();Lv();Nv();cs();Hv();zd()});var w$,mx,gx=y(()=>{l();c();d();w$=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},mx=r=>w$(void 0,void 0,void 0,function*(){return new Promise(e=>{setTimeout(e,r)})})});var ye,Bv=y(()=>{l();c();d();tl();Ya();ye=(r,e=K.globalProvider)=>{let o={scopes:e.needsAdditionalScopes(r)};return e.isIncrementalConsentDisabled?[]:[new Ja(void 0,o)]}});var _p,vx=y(()=>{l();c();d();_p=class{constructor(e,t,o,i){this.resource=o.startsWith("/")?o:`/${o}`,this.method=i,this.index=e,this.id=t}}});var yx,Tp,bx=y(()=>{l();c();d();Sv();tl();gx();Bv();vx();yx=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Tp=class r{static get baseUrl(){return"https://graph.microsoft.com"}constructor(e){this.graph=e,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(e,t,o,i){let n=this.nextIndex++,s=new _p(n,e,t,"GET");s.headers=i,this.allRequests.push(s),this.requestsQueue.push(n),o&&(this.scopes=this.scopes.concat(o))}executeNext(){return yx(this,void 0,void 0,function*(){let e=new Map;if(this.retryAfter&&(yield mx(this.retryAfter*1e3),this.retryAfter=0),!this.hasRequests)return e;let t=this.requestsQueue.splice(0,20),o=new lc;for(let u of t.map(h=>this.allRequests[h]))o.addRequest({id:u.index.toString(),request:new Request(r.baseUrl+u.resource,{method:u.method,headers:u.headers})});let i=this.scopes.length?ye(this.scopes):[],n=this.graph.api("$batch").middlewareOptions(i),s=yield o.getContent(),a=yield n.post(s);for(let u of a.responses){let h=new lp,p=parseInt(u.id,10),f=this.allRequests[p];if(h.id=f.id,h.index=f.index,h.headers=u.headers,u.status!==200){if(u.status===429){this.requestsQueue.unshift(p);let b=u.headers["Retry-After"];this.retryAfter=Math.max(this.retryAfter,parseInt(b,10)||1)}continue}else typeof u.body=="string"?u.headers["Content-Type"].includes("image/jpeg")?h.content="data:image/jpeg;base64,"+u.body:u.headers["Content-Type"].includes("image/pjpeg")?h.content="data:image/pjpeg;base64,"+u.body:u.headers["Content-Type"].includes("image/png")&&(h.content="data:image/png;base64,"+u.body):h.content=u.body;e.set(f.id,h)}return e})}executeAll(){return yx(this,void 0,void 0,function*(){let e=new Map;for(;this.hasRequests;){let t=yield this.executeNext();for(let[o,i]of t)e.set(o,i)}return e})}}});var fc,zv=y(()=>{l();c();d();fc=class{constructor(e){typeof e=="string"?this.componentName=e:this.componentName=e.tagName.toLowerCase()}}});var Ep,Ip=y(()=>{l();c();d();Ep=(...r)=>{let e=r[0],t=e;for(let o=1;o<r.length;++o){let i=r[o];t.setNext&&t.setNext(i),t=i}return e}});var C$,Ap,wx=y(()=>{l();c();d();Za();zv();np();C$=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Ap=class{constructor(e,t){this._packageVersion=e,this._providerName=t}execute(e){var t;return C$(this,void 0,void 0,function*(){try{if(typeof e.request=="string")if(ip(e.request)){let o=[],i=e.middlewareControl.getMiddlewareOptions(fc);if(i){let a=`${i.componentName}/${this._packageVersion}`;o.push(a)}if(this._providerName){let a=`${this._providerName}/${this._packageVersion}`;o.push(a)}let n=`mgt/${this._packageVersion}`;o.push(n),o.push(cc(e.request,e.options,"SdkVersion"));let s=o.join(", ");dc(e.request,e.options,"SdkVersion",s)}else(t=e?.options)===null||t===void 0||delete t.headers.SdkVersion}catch{}return yield this._nextMiddleware.execute(e)})}setNext(e){this._nextMiddleware=e}}});var rl,Wd=y(()=>{l();c();d();rl="3.1.3-pr.2934.d78a16f"});var Vv,oo,mc=y(()=>{l();c();d();Vv=class{constructor(){this._disambiguation=""}get defaultPrefix(){return"mgt"}withDisambiguation(e){return e&&!this._disambiguation&&(this._disambiguation=e.toLowerCase(),e!==this._disambiguation&&console.warn(`\u{1F992}: Disambiguation value, ${e}, should be lowercase. Value has been converted to lowercase, ${this._disambiguation}.`)),this}get prefix(){return this._disambiguation?`${this.defaultPrefix}-${this._disambiguation}`:this.defaultPrefix}get disambiguation(){return this._disambiguation}get isDisambiguated(){return!!this._disambiguation}normalize(e){return this.isDisambiguated?e.toUpperCase().replace(this.prefix.toUpperCase(),this.defaultPrefix.toUpperCase()):e}},oo=new Vv});var x$,ol,qv,Qd=y(()=>{l();c();d();tl();Ld();bx();zv();Ip();wx();Wd();mc();x$="v1.0",ol=class r{get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}constructor(e,t=x$){this._client=e,this._version=t}forComponent(e){let t=new r(this._client,this._version);return t.setComponent(e),t}api(e){let t=this._client.api(e).version(this._version);return this._componentName&&(t.middlewareOptions=o=>(t._middlewareOptions=t._middlewareOptions.concat(o),t),t=t.middlewareOptions([new fc(this._componentName)])),t}createBatch(){return new Tp(this)}setComponent(e){this._componentName=e instanceof Element?oo.normalize(e.tagName):e}},qv=(r,e,t)=>{let o=[new rn(r),new li(new Hr),new qo,new Ap(rl,r.name),new An],i=r.baseURL?r.baseURL:Dd,n=el.initWithMiddleware({middleware:Ep(...o),customHosts:r.customHosts?new Set(r.customHosts):null,baseUrl:i}),s=new ol(n,e);return t?s.forComponent(t):s}});var k$,Zs,Cx=y(()=>{l();c();d();Qd();k$="beta",Zs=class r extends ol{static fromGraph(e){let t=new r(e.client);return t.setComponent(e.componentName),t}constructor(e,t=k$){super(e,t)}forComponent(e){let t=new r(this.client);return this.setComponent(e),t}}});var Rp,Pp,Gv,xx,Yd,kx,Me,jv,$p,Kv=y(()=>{l();c();d();Rp=globalThis,Pp=Rp.ShadowRoot&&(Rp.ShadyCSS===void 0||Rp.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Gv=Symbol(),xx=new WeakMap,Yd=class{constructor(e,t,o){if(this._$cssResult$=!0,o!==Gv)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o,t=this.t;if(Pp&&e===void 0){let o=t!==void 0&&t.length===1;o&&(e=xx.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&xx.set(t,e))}return e}toString(){return this.cssText}},kx=r=>new Yd(typeof r=="string"?r:r+"",void 0,Gv),Me=(r,...e)=>{let t=r.length===1?r[0]:e.reduce((o,i,n)=>o+(s=>{if(s._$cssResult$===!0)return s.cssText;if(typeof s=="number")return s;throw Error("Value passed to 'css' function must be a 'css' function result: "+s+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+r[n+1],r[0]);return new Yd(t,r,Gv)},jv=(r,e)=>{if(Pp)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(let t of e){let o=document.createElement("style"),i=Rp.litNonce;i!==void 0&&o.setAttribute("nonce",i),o.textContent=t.cssText,r.appendChild(o)}},$p=Pp?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(let o of e.cssRules)t+=o.cssText;return kx(t)})(r):r});var S$,_$,T$,E$,I$,A$,Op,Sx,R$,P$,Zd,Jd,Mp,_x,ds,Xd=y(()=>{l();c();d();Kv();Kv();({is:S$,defineProperty:_$,getOwnPropertyDescriptor:T$,getOwnPropertyNames:E$,getOwnPropertySymbols:I$,getPrototypeOf:A$}=Object),Op=globalThis,Sx=Op.trustedTypes,R$=Sx?Sx.emptyScript:"",P$=Op.reactiveElementPolyfillSupport,Zd=(r,e)=>r,Jd={toAttribute(r,e){switch(e){case Boolean:r=r?R$:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},Mp=(r,e)=>!S$(r,e),_x={attribute:!0,type:String,converter:Jd,reflect:!1,hasChanged:Mp};Symbol.metadata??=Symbol("metadata"),Op.litPropertyMetadata??=new WeakMap;ds=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=_x){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){let o=Symbol(),i=this.getPropertyDescriptor(e,o,t);i!==void 0&&_$(this.prototype,e,i)}}static getPropertyDescriptor(e,t,o){let{get:i,set:n}=T$(this.prototype,e)??{get(){return this[t]},set(s){this[t]=s}};return{get(){return i?.call(this)},set(s){let a=i?.call(this);n.call(this,s),this.requestUpdate(e,a,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??_x}static _$Ei(){if(this.hasOwnProperty(Zd("elementProperties")))return;let e=A$(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Zd("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Zd("properties"))){let t=this.properties,o=[...E$(t),...I$(t)];for(let i of o)this.createProperty(i,t[i])}let e=this[Symbol.metadata];if(e!==null){let t=litPropertyMetadata.get(e);if(t!==void 0)for(let[o,i]of t)this.elementProperties.set(o,i)}this._$Eh=new Map;for(let[t,o]of this.elementProperties){let i=this._$Eu(t,o);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e)){let o=new Set(e.flat(1/0).reverse());for(let i of o)t.unshift($p(i))}else e!==void 0&&t.push($p(e));return t}static _$Eu(e,t){let o=t.attribute;return o===!1?void 0:typeof o=="string"?o:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$Eg=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$ES??=[]).push(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$ES?.splice(this._$ES.indexOf(e)>>>0,1)}_$E_(){let e=new Map,t=this.constructor.elementProperties;for(let o of t.keys())this.hasOwnProperty(o)&&(e.set(o,this[o]),delete this[o]);e.size>0&&(this._$Ep=e)}createRenderRoot(){let e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return jv(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$ES?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$ES?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EO(e,t){let o=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,o);if(i!==void 0&&o.reflect===!0){let n=(o.converter?.toAttribute!==void 0?o.converter:Jd).toAttribute(t,o.type);this._$Em=e,n==null?this.removeAttribute(i):this.setAttribute(i,n),this._$Em=null}}_$AK(e,t){let o=this.constructor,i=o._$Eh.get(e);if(i!==void 0&&this._$Em!==i){let n=o.getPropertyOptions(i),s=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:Jd;this._$Em=i,this[i]=s.fromAttribute(t,n.type),this._$Em=null}}requestUpdate(e,t,o,i=!1,n){if(e!==void 0){if(o??=this.constructor.getPropertyOptions(e),!(o.hasChanged??Mp)(i?n:this[e],t))return;this.C(e,t,o)}this.isUpdatePending===!1&&(this._$Eg=this._$EP())}C(e,t,o){this._$AL.has(e)||this._$AL.set(e,t),o.reflect===!0&&this._$Em!==e&&(this._$Ej??=new Set).add(e)}async _$EP(){this.isUpdatePending=!0;try{await this._$Eg}catch(t){Promise.reject(t)}let e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this._$Ep){for(let[i,n]of this._$Ep)this[i]=n;this._$Ep=void 0}let o=this.constructor.elementProperties;if(o.size>0)for(let[i,n]of o)n.wrapped!==!0||this._$AL.has(i)||this[i]===void 0||this.C(i,this[i],n)}let e=!1,t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$ES?.forEach(o=>o.hostUpdate?.()),this.update(t)):this._$ET()}catch(o){throw e=!1,this._$ET(),o}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$ES?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$ET(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Eg}shouldUpdate(e){return!0}update(e){this._$Ej&&=this._$Ej.forEach(t=>this._$EO(t,this[t])),this._$ET()}updated(e){}firstUpdated(e){}};ds.elementStyles=[],ds.shadowRootOptions={mode:"open"},ds[Zd("elementProperties")]=new Map,ds[Zd("finalized")]=new Map,P$?.({ReactiveElement:ds}),(Op.reactiveElementVersions??=[]).push("2.0.0")});function Dx(r,e){if(!Array.isArray(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return Tx!==void 0?Tx.createHTML(e):e}function al(r,e,t=r,o){if(e===nn)return e;let i=o!==void 0?t._$Co?.[o]:t._$Cl,n=ru(e)?void 0:e._$litDirective$;return i?.constructor!==n&&(i?._$AO?.(!1),n===void 0?i=void 0:(i=new n(r),i._$AT(r,t,o)),o!==void 0?(t._$Co??=[])[o]=i:t._$Cl=i),i!==void 0&&(e=al(r,i._$AS(r,e.values),i,o)),e}var Qv,Fp,Tx,Yv,us,Zv,$$,sl,tu,ru,$x,Ox,Wv,eu,Ex,Ix,il,Ax,Rx,Mx,Fx,k,tq,nn,rt,Px,nl,Lx,ou,Dp,gc,ll,Lp,Np,Hp,Up,Nx,O$,Hx,Js=y(()=>{l();c();d();Qv=globalThis,Fp=Qv.trustedTypes,Tx=Fp?Fp.createPolicy("lit-html",{createHTML:r=>r}):void 0,Yv="$lit$",us=`lit$${(Math.random()+"").slice(9)}$`,Zv="?"+us,$$=`<${Zv}>`,sl=document,tu=()=>sl.createComment(""),ru=r=>r===null||typeof r!="object"&&typeof r!="function",$x=Array.isArray,Ox=r=>$x(r)||typeof r?.[Symbol.iterator]=="function",Wv=`[ 	
\f\r]`,eu=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ex=/-->/g,Ix=/>/g,il=RegExp(`>|${Wv}(?:([^\\s"'>=/]+)(${Wv}*=${Wv}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Ax=/'/g,Rx=/"/g,Mx=/^(?:script|style|textarea|title)$/i,Fx=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),k=Fx(1),tq=Fx(2),nn=Symbol.for("lit-noChange"),rt=Symbol.for("lit-nothing"),Px=new WeakMap,nl=sl.createTreeWalker(sl,129);Lx=(r,e)=>{let t=r.length-1,o=[],i,n=e===2?"<svg>":"",s=eu;for(let a=0;a<t;a++){let u=r[a],h,p,f=-1,b=0;for(;b<u.length&&(s.lastIndex=b,p=s.exec(u),p!==null);)b=s.lastIndex,s===eu?p[1]==="!--"?s=Ex:p[1]!==void 0?s=Ix:p[2]!==void 0?(Mx.test(p[2])&&(i=RegExp("</"+p[2],"g")),s=il):p[3]!==void 0&&(s=il):s===il?p[0]===">"?(s=i??eu,f=-1):p[1]===void 0?f=-2:(f=s.lastIndex-p[2].length,h=p[1],s=p[3]===void 0?il:p[3]==='"'?Rx:Ax):s===Rx||s===Ax?s=il:s===Ex||s===Ix?s=eu:(s=il,i=void 0);let x=s===il&&r[a+1].startsWith("/>")?" ":"";n+=s===eu?u+$$:f>=0?(o.push(h),u.slice(0,f)+Yv+u.slice(f)+us+x):u+us+(f===-2?a:x)}return[Dx(r,n+(r[t]||"<?>")+(e===2?"</svg>":"")),o]},ou=class r{constructor({strings:e,_$litType$:t},o){let i;this.parts=[];let n=0,s=0,a=e.length-1,u=this.parts,[h,p]=Lx(e,t);if(this.el=r.createElement(h,o),nl.currentNode=this.el.content,t===2){let f=this.el.content.firstChild;f.replaceWith(...f.childNodes)}for(;(i=nl.nextNode())!==null&&u.length<a;){if(i.nodeType===1){if(i.hasAttributes())for(let f of i.getAttributeNames())if(f.endsWith(Yv)){let b=p[s++],x=i.getAttribute(f).split(us),S=/([.?@])?(.*)/.exec(b);u.push({type:1,index:n,name:S[2],strings:x,ctor:S[1]==="."?Lp:S[1]==="?"?Np:S[1]==="@"?Hp:ll}),i.removeAttribute(f)}else f.startsWith(us)&&(u.push({type:6,index:n}),i.removeAttribute(f));if(Mx.test(i.tagName)){let f=i.textContent.split(us),b=f.length-1;if(b>0){i.textContent=Fp?Fp.emptyScript:"";for(let x=0;x<b;x++)i.append(f[x],tu()),nl.nextNode(),u.push({type:2,index:++n});i.append(f[b],tu())}}}else if(i.nodeType===8)if(i.data===Zv)u.push({type:2,index:n});else{let f=-1;for(;(f=i.data.indexOf(us,f+1))!==-1;)u.push({type:7,index:n}),f+=us.length-1}n++}}static createElement(e,t){let o=sl.createElement("template");return o.innerHTML=e,o}};Dp=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){let{el:{content:t},parts:o}=this._$AD,i=(e?.creationScope??sl).importNode(t,!0);nl.currentNode=i;let n=nl.nextNode(),s=0,a=0,u=o[0];for(;u!==void 0;){if(s===u.index){let h;u.type===2?h=new gc(n,n.nextSibling,this,e):u.type===1?h=new u.ctor(n,u.name,u.strings,this,e):u.type===6&&(h=new Up(n,this,e)),this._$AV.push(h),u=o[++a]}s!==u?.index&&(n=nl.nextNode(),s++)}return nl.currentNode=sl,i}p(e){let t=0;for(let o of this._$AV)o!==void 0&&(o.strings!==void 0?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}},gc=class r{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,o,i){this.type=2,this._$AH=rt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode,t=this._$AM;return t!==void 0&&e?.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=al(this,e,t),ru(e)?e===rt||e==null||e===""?(this._$AH!==rt&&this._$AR(),this._$AH=rt):e!==this._$AH&&e!==nn&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):Ox(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==rt&&ru(this._$AH)?this._$AA.nextSibling.data=e:this.$(sl.createTextNode(e)),this._$AH=e}g(e){let{values:t,_$litType$:o}=e,i=typeof o=="number"?this._$AC(e):(o.el===void 0&&(o.el=ou.createElement(Dx(o.h,o.h[0]),this.options)),o);if(this._$AH?._$AD===i)this._$AH.p(t);else{let n=new Dp(i,this),s=n.u(this.options);n.p(t),this.$(s),this._$AH=n}}_$AC(e){let t=Px.get(e.strings);return t===void 0&&Px.set(e.strings,t=new ou(e)),t}T(e){$x(this._$AH)||(this._$AH=[],this._$AR());let t=this._$AH,o,i=0;for(let n of e)i===t.length?t.push(o=new r(this.k(tu()),this.k(tu()),this,this.options)):o=t[i],o._$AI(n),i++;i<t.length&&(this._$AR(o&&o._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e&&e!==this._$AB;){let o=e.nextSibling;e.remove(),e=o}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},ll=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,o,i,n){this.type=1,this._$AH=rt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=n,o.length>2||o[0]!==""||o[1]!==""?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=rt}_$AI(e,t=this,o,i){let n=this.strings,s=!1;if(n===void 0)e=al(this,e,t,0),s=!ru(e)||e!==this._$AH&&e!==nn,s&&(this._$AH=e);else{let a=e,u,h;for(e=n[0],u=0;u<n.length-1;u++)h=al(this,a[o+u],t,u),h===nn&&(h=this._$AH[u]),s||=!ru(h)||h!==this._$AH[u],h===rt?e=rt:e!==rt&&(e+=(h??"")+n[u+1]),this._$AH[u]=h}s&&!i&&this.j(e)}j(e){e===rt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},Lp=class extends ll{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===rt?void 0:e}},Np=class extends ll{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==rt)}},Hp=class extends ll{constructor(e,t,o,i,n){super(e,t,o,i,n),this.type=5}_$AI(e,t=this){if((e=al(this,e,t,0)??rt)===nn)return;let o=this._$AH,i=e===rt&&o!==rt||e.capture!==o.capture||e.once!==o.once||e.passive!==o.passive,n=e!==rt&&(o===rt||i);i&&this.element.removeEventListener(this.name,this,o),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},Up=class{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){al(this,e)}},Nx={S:Yv,A:us,P:Zv,C:1,M:Lx,L:Dp,R:Ox,V:al,D:gc,I:ll,H:Np,N:Hp,U:Lp,B:Up},O$=Qv.litHtmlPolyfillSupport;O$?.(ou,gc),(Qv.litHtmlVersions??=[]).push("3.0.0");Hx=(r,e,t)=>{let o=t?.renderBefore??e,i=o._$litPart$;if(i===void 0){let n=t?.renderBefore??null;o._$litPart$=i=new gc(e.insertBefore(tu(),n),n,void 0,t??{})}return i._$AI(r),i}});var Xs,M$,Ux=y(()=>{l();c();d();Xd();Xd();Js();Js();Xs=class extends ds{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){let e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){let t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Hx(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return nn}};Xs._$litElement$=!0,Xs["finalized"]=!0,globalThis.litElementHydrateSupport?.({LitElement:Xs});M$=globalThis.litElementPolyfillSupport;M$?.({LitElement:Xs});(globalThis.litElementVersions??=[]).push("4.0.0")});var Bx=y(()=>{l();c();d();});var Te=y(()=>{l();c();d();Xd();Js();Ux();Bx()});var zx=y(()=>{l();c();d();});function E(r){return(e,t)=>typeof t=="object"?D$(r,e,t):((o,i,n)=>{let s=i.hasOwnProperty(n);return i.constructor.createProperty(n,s?{...o,wrapped:!0}:o),s?Object.getOwnPropertyDescriptor(i,n):void 0})(r,e,t)}var F$,D$,Jv=y(()=>{l();c();d();Xd();F$={attribute:!0,type:String,converter:Jd,reflect:!1,hasChanged:Mp},D$=(r=F$,e,t)=>{let{kind:o,metadata:i}=t,n=globalThis.litPropertyMetadata.get(i);if(n===void 0&&globalThis.litPropertyMetadata.set(i,n=new Map),n.set(t.name,r),o==="accessor"){let{name:s}=t;return{set(a){let u=e.get.call(this);e.set.call(this,a),this.requestUpdate(s,u,r)},init(a){return a!==void 0&&this.C(s,void 0,r),a}}}if(o==="setter"){let{name:s}=t;return function(a){let u=this[s];e.call(this,a),this.requestUpdate(s,u,r)}}throw Error("Unsupported decorator location: "+o)}});function le(r){return E({...r,state:!0,attribute:!1})}var Vx=y(()=>{l();c();d();Jv();});var qx=y(()=>{l();c();d();});var vc=y(()=>{l();c();d();});var Gx=y(()=>{l();c();d();vc();});var jx=y(()=>{l();c();d();vc();});var Kx=y(()=>{l();c();d();vc();});var Wx=y(()=>{l();c();d();vc();});var Qx=y(()=>{l();c();d();vc();});var At=y(()=>{l();c();d();zx();Jv();Vx();qx();Gx();jx();Kx();Wx();Qx()});var Si,Xv=y(()=>{l();c();d();Fd();Si=class{static get strings(){return this._strings}static set strings(e){this._strings=e,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){var e,t;switch(((e=document.body)===null||e===void 0?void 0:e.getAttribute("dir"))||((t=document.documentElement)===null||t===void 0?void 0:t.getAttribute("dir"))){case"rtl":return"rtl";case"auto":return"auto";case"ltr":default:return"ltr"}}static onStringsUpdated(e){this._stringsEventDispatcher.add(e)}static removeOnStringsUpdated(e){this._stringsEventDispatcher.remove(e)}static onDirectionUpdated(e){this._directionEventDispatcher.add(e),this.initDirection()}static removeOnDirectionUpdated(e){this._directionEventDispatcher.remove(e)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver(t=>{t.forEach(o=>{o.attributeName==="dir"&&this._directionEventDispatcher.fire(null)})});let e={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,e),this.mutationObserver.observe(document.documentElement,e)}static updateStringsForTag(e,t){var o;if(e=e.toLowerCase(),e.startsWith("mgt-")&&(e=e.substring(4)),this._strings&&t){for(let i of Object.entries(t)){let n=this._strings[i[0]];typeof n=="string"&&(t[i[0]]=n)}if(!((o=this._strings._components)===null||o===void 0)&&o[e]){let i=this._strings._components[e];for(let n of Object.keys(i))t[n]&&(t[n]=i[n])}}return t}};Si._stringsEventDispatcher=new en;Si._directionEventDispatcher=new en;Si._isDirectionInit=!1});var L$,N$,Yx,iu,fr,zp=y(()=>{l();c();d();Te();At();Ws();Ya();Xv();Wd();L$=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},N$=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Yx=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})};(function(r){r.mobile="",r.tablet="tablet",r.desktop="desktop"})(iu||(iu={}));fr=class extends Xs{static get packageVersion(){return rl}get mediaQuery(){return this.offsetWidth<768?iu.mobile:this.offsetWidth<1200?iu.tablet:iu.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}constructor(){super(),this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.setLoadingState=e=>{this._isLoadingState!==e&&(this._isLoadingState=e,this.requestUpdate("isLoadingState"))},this.handleProviderUpdates=()=>{this.requestStateUpdate()},this.handleActiveAccountUpdates=()=>{this.clearState(),this.requestStateUpdate()},this.handleLocalizationChanged=()=>{Si.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()},this.handleDirectionChanged=()=>{this.direction=Si.getDocumentDirection()},this.handleDirectionChanged(),this.handleLocalizationChanged()}connectedCallback(){super.connectedCallback(),Si.onStringsUpdated(this.handleLocalizationChanged),Si.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),Si.removeOnStringsUpdated(this.handleLocalizationChanged),Si.removeOnDirectionUpdated(this.handleDirectionChanged),K.removeProviderUpdatedListener(this.handleProviderUpdates),K.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(e){super.firstUpdated(e),this._isFirstUpdated=!0,K.onProviderUpdated(this.handleProviderUpdates),K.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(e,t,o=!1,i=!1,n=!1){let s=new CustomEvent(e,{bubbles:o,cancelable:i,composed:n,detail:t});return this.dispatchEvent(s)}updated(e){super.updated(e);let t=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(t)}requestStateUpdate(e=!1){return Yx(this,void 0,void 0,function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!e&&(yield this._currentLoadStatePromise);let t=K.globalProvider;if(!t)return Promise.resolve();if(t.state===ce.SignedOut){this.clearState();return}else{if(t.state===ce.Loading)return Promise.resolve();{let o=new Promise((i,n)=>Yx(this,void 0,void 0,function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),i()}catch(s){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),n(s)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&e?this._currentLoadStatePromise.then(()=>o):o}))}}})}};L$([le(),N$("design:type",String)],fr.prototype,"direction",void 0)});var e0,t0,yc,Zx=y(()=>{l();c();d();At();zp();e0=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},t0=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},yc=class extends fr{constructor(){super(...arguments),this.stateChangedHandler=()=>{this.fireCustomEvent("onStateChanged",this.provider.state)}}get provider(){return this._provider}set provider(e){this._provider&&this.provider.removeStateChangedHandler(()=>this.stateChangedHandler),this._provider=e,this._provider&&this.provider.onStateChanged(()=>this.stateChangedHandler)}get isAvailable(){return!0}firstUpdated(e){super.firstUpdated(e);let t=!1;if(this.dependsOn){let o=this.dependsOn;for(;o;){if(o.isAvailable){t=!0;break}o=o.dependsOn}}!t&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}};e0([E({attribute:"depends-on",converter:r=>document.querySelector(r),type:String}),t0("design:type",yc)],yc.prototype,"dependsOn",void 0);e0([E({attribute:"base-url",type:String}),t0("design:type",String)],yc.prototype,"baseUrl",void 0);e0([E({attribute:"custom-hosts",type:String,converter:r=>r.split(",").map(e=>e.trim())}),t0("design:type",Array)],yc.prototype,"customHosts",void 0)});var cl,r0,Go,o0=y(()=>{l();c();d();cl=(r,e)=>r0(r,e,new Set),r0=(r,e,t)=>{let o=Object.prototype.toString.call(r),i=Object.prototype.toString.call(e);if(typeof r=="object"&&typeof e=="object"&&o===i&&o==="[object Object]"&&!t.has(r)){t.add(r);for(let n in r)if(!r0(r[n],e[n],t))return!1;for(let n in e)if(!Object.prototype.hasOwnProperty.call(r,n))return!1;return!0}if(Array.isArray(r)&&Array.isArray(e)&&!t.has(r)){if(t.add(r),r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!r0(r[n],e[n],t))return!1;return!0}return r===e},Go=(r,e)=>{if(r===e)return!0;if(!r||!e||r.length!==e.length)return!1;if(r.length===0)return!0;let t=new Set(r);for(let o of e)if(!t.has(o))return!1;return!0}});var nu,i0=y(()=>{l();c();d();nu=class{static renderTemplate(e,t,o){var i;t.$parentTemplateContext&&(o=Object.assign(Object.assign({},o),{$parent:t.$parentTemplateContext}));let n;if(!((i=t.content)===null||i===void 0)&&i.childNodes.length){let s=t.content.cloneNode(!0);n=this.renderNode(s,e,o)}else if(t.childNodes.length){let s=document.createElement("div");for(let a of t.childNodes)s.appendChild(this.simpleCloneNode(a));n=this.renderNode(s,e,o)}n&&e.appendChild(n)}static setBindingSyntax(e,t){this._startExpression=e,this._endExpression=t;let o=this.escapeRegex(this._startExpression),i=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${o}\\s*([$\\w\\.,'"\\s()\\[\\]]+)\\s*${i}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(e){if(!e)return null;let t=e.cloneNode(!1);for(let o of e.childNodes){let i=this.simpleCloneNode(o);i&&t.appendChild(i)}return t}static expandExpressionsAsString(e,t){return e.replace(this.expression,(o,i)=>{let n=this.evalInContext(i||this.trimExpression(o),t);return n?typeof n=="object"?JSON.stringify(n):n.toString():""})}static renderNode(e,t,o){if(e.nodeName==="#text")return e.textContent=this.expandExpressionsAsString(e.textContent,o),e;if(e.nodeName==="TEMPLATE")return e.$parentTemplateContext=o,e;let i=e;if(i.attributes)for(let u of i.attributes)if(u.name==="data-props"){let h=this.trimExpression(u.value);for(let p of h.split(",")){let f=p.trim().split(":");if(f.length===2){let b=f[0].trim(),x=this.evalInContext(f[1].trim(),o);b.startsWith("@")?typeof x=="function"&&i.addEventListener(b.substring(1),S=>x(S,o,t)):i[b]=x}}}else i.setAttribute(u.name,this.expandExpressionsAsString(u.value,o));let n=[],s=[],a=!1;for(let u of e.childNodes){let h=u,p=!1;if(h.dataset){let f=!1;if(h.dataset.if){let b=h.dataset.if;this.evalBoolInContext(this.trimExpression(b),o)?(h.removeAttribute("data-if"),a=!0,p=!0):(s.push(h),f=!0)}else typeof h.dataset.else<"u"&&(a?(s.push(h),f=!0):h.removeAttribute("data-else"));h.dataset.for&&!f?n.push(h):f||this.renderNode(u,t,o)}else this.renderNode(u,t,o);!p&&u.nodeName!=="#text"&&(a=!1)}for(let u of s)i.removeChild(u);for(let u of n){let h=u.dataset.for,p=this.trimExpression(h).split(/\s(in|of)\s/i);if(p.length===3){let f=p[0].trim(),b=p[2].trim(),x=this.evalInContext(b,o);if(Array.isArray(x)){u.removeAttribute("data-for");for(let S=0;S<x.length;S++){let R=Object.assign({$index:S},o);R[f]=x[S];let z=u.cloneNode(!0);this.renderNode(z,t,R),i.insertBefore(z,u)}}i.removeChild(u)}}return e}static evalBoolInContext(e,t){return t=Object.assign(Object.assign({},t),this.globalContext),new Function("with(this) { return !!("+e+")}").call(t)}static evalInContext(e,t){t=Object.assign(Object.assign({},t),this.globalContext);let o=new Function("with(this) { return "+e+";}"),i;try{i=o.call(t)}catch{}return i}static trimExpression(e){return e=e.trim(),e.startsWith(this._startExpression)&&e.endsWith(this._endExpression)&&(e=e.substr(this._startExpression.length,e.length-this._startExpression.length-this._endExpression.length),e=e.trim()),e}};nu._globalContext={}});var Jx,Xx,st,ek=y(()=>{l();c();d();At();Te();o0();zp();i0();Jx=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Xx=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},st=class extends fr{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,o){if(!this.hasTemplate(e))return null;o=o||e,this._slotNamesAddedDuringRender.push(o),this._renderedSlots=!0;let i=k`
      <slot name=${o}></slot>
    `,n=Object.assign(Object.assign({},t),this.templateContext);if(Object.prototype.hasOwnProperty.call(this._renderedTemplates,o)){let{context:u,slot:h}=this._renderedTemplates[o];if(cl(u,n))return i;this.removeChild(h)}let s=document.createElement("div");s.slot=o,s.dataset.generated="template",nu.renderTemplate(s,this.templates[e],n),this.appendChild(s),this._renderedTemplates[o]={context:n,slot:s};let a={templateType:e,context:n,element:s};return this.fireCustomEvent("templateRendered",a),i}hasTemplate(e){var t;return!!(!((t=this.templates)===null||t===void 0)&&t[e])}getTemplates(){let e={};for(let t=0;t<this.children.length;t++){let o=this.children[t];if(o.nodeName==="TEMPLATE"){let i=o;i.dataset.type?e[i.dataset.type]=i:e.default=i,i.templateOrder=t}}return e}renderError(){return this.hasTemplate("error")?this.renderTemplate("error",this.error):k`
      <div class="error">
        ${this.error}
      </div>
    `}removeUnusedSlottedElements(){var e;if(this._renderedSlots){for(let t=0;t<this.children.length;t++){let o=this.children[t];!((e=o.dataset)===null||e===void 0)&&e.generated&&!this._slotNamesAddedDuringRender.includes(o.slot)&&(this.removeChild(o),delete this._renderedTemplates[o.slot],t--)}this._renderedSlots=!1}}};Jx([E({attribute:!1}),Xx("design:type",Object)],st.prototype,"templateContext",void 0);Jx([le(),Xx("design:type",Object)],st.prototype,"error",void 0)});var tk=y(()=>{l();c();d();Qd();Ws()});var rk=y(()=>{l();c();d()});var ok=y(()=>{l();c();d()});function U$(){return ik||(ik=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function B$(){return nk||(nk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}function z$(r){let e=new Promise((t,o)=>{let i=()=>{r.removeEventListener("success",n),r.removeEventListener("error",s)},n=()=>{t(Rn(r.result)),i()},s=()=>{o(r.error),i()};r.addEventListener("success",n),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&sk.set(t,r)}).catch(()=>{}),l0.set(e,r),e}function V$(r){if(s0.has(r))return;let e=new Promise((t,o)=>{let i=()=>{r.removeEventListener("complete",n),r.removeEventListener("error",s),r.removeEventListener("abort",s)},n=()=>{t(),i()},s=()=>{o(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",n),r.addEventListener("error",s),r.addEventListener("abort",s)});s0.set(r,e)}function lk(r){a0=r(a0)}function q$(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let o=r.call(Vp(this),e,...t);return ak.set(o,e.sort?e.sort():[e]),Rn(o)}:B$().includes(r)?function(...e){return r.apply(Vp(this),e),Rn(sk.get(this))}:function(...e){return Rn(r.apply(Vp(this),e))}}function G$(r){return typeof r=="function"?q$(r):(r instanceof IDBTransaction&&V$(r),H$(r,U$())?new Proxy(r,a0):r)}function Rn(r){if(r instanceof IDBRequest)return z$(r);if(n0.has(r))return n0.get(r);let e=G$(r);return e!==r&&(n0.set(r,e),l0.set(e,r)),e}var H$,ik,nk,sk,s0,ak,n0,l0,a0,Vp,c0=y(()=>{l();c();d();H$=(r,e)=>e.some(t=>r instanceof t);sk=new WeakMap,s0=new WeakMap,ak=new WeakMap,n0=new WeakMap,l0=new WeakMap;a0={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return s0.get(r);if(e==="objectStoreNames")return r.objectStoreNames||ak.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Rn(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};Vp=r=>l0.get(r)});function dk(r,e,{blocked:t,upgrade:o,blocking:i,terminated:n}={}){let s=indexedDB.open(r,e),a=Rn(s);return o&&s.addEventListener("upgradeneeded",u=>{o(Rn(s.result),u.oldVersion,u.newVersion,Rn(s.transaction))}),t&&s.addEventListener("blocked",()=>t()),a.then(u=>{n&&u.addEventListener("close",()=>n()),i&&u.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function ck(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(d0.get(e))return d0.get(e);let t=e.replace(/FromIndex$/,""),o=e!==t,i=K$.includes(t);if(!(t in(o?IDBIndex:IDBObjectStore).prototype)||!(i||j$.includes(t)))return;let n=async function(s,...a){let u=this.transaction(s,i?"readwrite":"readonly"),h=u.store;return o&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),i&&u.done]))[0]};return d0.set(e,n),n}var j$,K$,d0,uk=y(()=>{l();c();d();c0();c0();j$=["get","getKey","getAll","getAllKeys","count"],K$=["put","add","delete","clear"],d0=new Map;lk(r=>({...r,get:(e,t,o)=>ck(e,t)||r.get(e,t,o),has:(e,t)=>!!ck(e,t)||r.has(e,t)}))});var dl,qp=y(()=>{l();c();d();dl="mgt-db-list"});var su,Gp,u0=y(()=>{l();c();d();uk();Ya();qp();su=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Gp=class{constructor(e,t){if(!(t in e.stores))throw Error('"store" must be defined in the "schema"');this.schema=e,this.store=t}getValue(e){return su(this,void 0,void 0,function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,e)}catch{return null}})}putValue(e,t){return su(this,void 0,void 0,function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},t),{timeCached:Date.now()}),e)}catch{return}})}clearStore(){return su(this,void 0,void 0,function*(){if(window.indexedDB)try{yield(yield this.getDb()).clear(this.store)}catch{return}})}getDBName(){return su(this,void 0,void 0,function*(){let e=yield K.getCacheId();if(e)return`mgt-${this.schema.name}-${e}`})}getDb(){return su(this,void 0,void 0,function*(){let e=yield this.getDBName();if(e)return dk(e,this.schema.version,{upgrade:(t,o,i,n)=>{let s=JSON.parse(localStorage.getItem(dl))||[];s.includes(e)||s.push(e),localStorage.setItem(dl,JSON.stringify(s));for(let a in this.schema.stores)Object.prototype.hasOwnProperty.call(this.schema.stores,a)&&!t.objectStoreNames.contains(a)&&t.createObjectStore(a)}})})}}});var W$,Q,hk=y(()=>{l();c();d();Ya();Ws();u0();qp();W$=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Q=class{static getCache(e,t){let o=`${e.name}/${t}`;return this.isInitialized||this.init(),this.cacheStore.has(t)||this.cacheStore.set(o,new Gp(e,t)),this.cacheStore.get(o)}static clearCacheById(e){let t=[],o=JSON.parse(localStorage.getItem(dl));if(o){let i=[];o.forEach(n=>{n.includes(e)?t.push(new Promise((s,a)=>{let u=indexedDB.deleteDatabase(n);u.onsuccess=()=>s(),u.onerror=()=>{console.error(`\u{1F992}: ${u.error.name} occurred deleting cache: ${n}`,u.error.message),a()}})):i.push(n)}),i.length>0?localStorage.setItem(dl,JSON.stringify(i)):localStorage.removeItem(dl)}return Promise.all(t)}static get config(){return this.cacheConfig}static init(){let e;K.globalProvider&&(e=K.globalProvider.state),K.onProviderUpdated(()=>W$(this,void 0,void 0,function*(){if(e===ce.SignedIn&&K.globalProvider.state===ce.SignedOut){let t=yield K.getCacheId();t!==null&&(yield this.clearCacheById(t))}e=K.globalProvider.state})),this.isInitialized=!0}};Q.cacheStore=new Map;Q.isInitialized=!1;Q.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}}});var Pn,pk=y(()=>{l();c();d();Pn=class{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(e){this._microsoftTeamsLib=e}static get isAvailable(){return this.microsoftTeamsLib?window.parent===window.self&&window.nativeInterface?!0:window.name==="embedded-page-container"||window.name==="extension-tab-frame":!1}static executeDeepLink(e,t){let o=this.microsoftTeamsLib;o.initialize(),o.executeDeepLink(e,t)}}});var fk=y(()=>{l();c();d()});var mk,ul,gk=y(()=>{l();c();d();mk=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},ul=class r{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(e,t,o){return mk(this,void 0,void 0,function*(){let i=yield t.get();if(i?.value){let n=new r;return n._graph=e,n._value=i.value,n._nextLink=i["@odata.nextLink"],n._version=o||e.version,n}return null})}static createFromValue(e,t,o=null){let i=new r;return i._graph=e,i._value=t,i._nextLink=o,i._version=e.version,i}get nextLink(){return this._nextLink||""}next(){var e;return mk(this,void 0,void 0,function*(){if(this._nextLink){let t=this._nextLink.split(this._version)[1],o=yield this._graph.api(t).version(this._version).get();if(!((e=o?.value)===null||e===void 0)&&e.length)return this._value=this._value.concat(o.value),this._nextLink=o["@odata.nextLink"],o.value}return null})}}});var vk,yk,Q$,Ee,bk=y(()=>{l();c();d();Te();mc();vk=new WeakMap,yk=(r,e,t)=>{let o=[];for(let i of r)o.push(i.replace(e,t));return o},Q$=(r,...e)=>{if(oo.isDisambiguated){let t=vk.get(r);if(!t){let o=new RegExp("(</?)mgt-(?!"+oo.disambiguation+"-)"),i=`$1${oo.prefix}-`;t=Object.assign(yk(r,o,i),{raw:yk(r.raw,o,i)}),vk.set(r,t)}r=t}return k(r,...e)},Ee=Q$});var wk=y(()=>{l();c();d();At();mc()});var au,Pe,Ck=y(()=>{l();c();d();mc();au=r=>`${oo.prefix}-${r}`,Pe=(r,e,t)=>{let o=au(r);customElements.get(o)||customElements.define(o,e,t)}});var xk=y(()=>{l();c();d()});var jp,kk,Sk=y(()=>{l();c();d();jp=class{constructor(){this.session=window.sessionStorage}setItem(e,t){this.session.setItem(e,t)}getItem(e){return this.session.getItem(e)}clear(){this.session.clear()}},kk=r=>{let e;try{r==="sessionStorage"?e=window.sessionStorage:e=window.localStorage;let t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0}}});var _k,lu,Tk=y(()=>{l();c();d();Sk();_k=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},lu=class r{static get _sessionCache(){return!this._cache&&kk("sessionStorage")&&(this._cache=new jp),this._cache}execute(e){return _k(this,void 0,void 0,function*(){try{let t=yield r.getBaseUrl();e.request=t+encodeURIComponent(e.request)}catch{}return yield this._nextMiddleware.execute(e)})}setNext(e){this._nextMiddleware=e}static getBaseUrl(){var e,t;return _k(this,void 0,void 0,function*(){if(!this._baseUrl){let o=(e=this._sessionCache)===null||e===void 0?void 0:e.getItem("endpointURL");if(o)this._baseUrl=o;else{try{let n=yield(yield fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint")).json();typeof n!="string"?r.setBaseFallbackUrl():this._baseUrl=n+"?url="}catch{r.setBaseFallbackUrl()}(t=this._sessionCache)===null||t===void 0||t.setItem("endpointURL",this._baseUrl)}}return this._baseUrl})}static setBaseFallbackUrl(){this._baseUrl="https://graph.office.net/en-us/graph/api/proxy?url="}}});var Y$,Kp,Ek=y(()=>{l();c();d();tl();Qd();Ip();Tk();Y$=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Kp=class r extends ol{static create(e){return Y$(this,void 0,void 0,function*(){let t=[new rn(e),new li(new Hr),new qo,new lu,new An];return new r(el.initWithMiddleware({middleware:Ep(...t),customHosts:new Set([new URL(yield lu.getBaseUrl()).hostname])}))})}forComponent(e){return this}}});var h0,Wp,Ik=y(()=>{l();c();d();Ws();Ek();h0=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Wp=class extends Qa{constructor(e=!1,t=[]){super(),this._accounts=[],this._mockGraphPromise=Kp.create(this);let o=!!t.length;this.isMultipleAccountSupported=o,this.isMultipleAccountDisabled=!o,this._accounts=t,this.initializeMockGraph(e)}get isMultiAccountSupportedAndEnabled(){return!this.isMultipleAccountDisabled&&this.isMultipleAccountSupported}getAllAccounts(){return this._accounts}getActiveAccount(){if(this._accounts.length)return this._accounts[0]}login(){return h0(this,void 0,void 0,function*(){this.setState(ce.Loading),yield this._mockGraphPromise,yield new Promise(e=>setTimeout(e,3e3)),this.setState(ce.SignedIn)})}logout(){return h0(this,void 0,void 0,function*(){this.setState(ce.Loading),yield this._mockGraphPromise,yield new Promise(e=>setTimeout(e,3e3)),this.setState(ce.SignedOut)})}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}initializeMockGraph(e=!1){return h0(this,void 0,void 0,function*(){this.graph=yield this._mockGraphPromise,e?this.setState(ce.SignedIn):this.setState(ce.SignedOut)})}}});var ue=y(()=>{l();c();d();Sv();Ld();Qd();Cx();zp();Zx();ek();mc();Ws();Ya();tk();rk();ok();hk();u0();qp();Fd();o0();Ip();Bv();np();pk();fk();i0();gk();Xv();bk();wk();Ck();Wd();xk();Ik()});var nS,sS=y(()=>{l();c();d();Te();nS=[Me`

`]});var aS,lS,Cs=y(()=>{l();c();d();sS();aS=document.createElement("style");aS.appendChild(document.createTextNode(`
@font-face {
    font-family: 'FabricMDL2Icons';
    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),
    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format("woff"),
    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format("truetype");
}
`));document.head.appendChild(aS);lS=document.createElement("style");lS.innerHTML=nS.toString();document.head.appendChild(lS)});var ff,mf,Ic,q0=y(()=>{l();c();d();ff={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},mf=r=>(...e)=>({_$litDirective$:r,values:e}),Ic=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,o){this._$Ct=e,this._$AM=t,this._$Ci=o}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}});var Ve,cS=y(()=>{l();c();d();Js();q0();Ve=mf(class extends Ic{constructor(r){if(super(r),r.type!==ff.ATTRIBUTE||r.name!=="class"||r.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(r){return" "+Object.keys(r).filter(e=>r[e]).join(" ")+" "}update(r,[e]){if(this.it===void 0){this.it=new Set,r.strings!==void 0&&(this.st=new Set(r.strings.join(" ").split(/\s/).filter(o=>o!=="")));for(let o in e)e[o]&&!this.st?.has(o)&&this.it.add(o);return this.render(e)}let t=r.element.classList;for(let o of this.it)o in e||(t.remove(o),this.it.delete(o));for(let o in e){let i=!!e[o];i===this.it.has(o)||this.st?.has(o)||(i?(t.add(o),this.it.add(o)):(t.remove(o),this.it.delete(o)))}return nn}})});var fi=y(()=>{l();c();d();cS()});var Cl,dS,x7,Ac,gf,vf,yf,wu,Rc,Pc,bf,uS,wf,Ai=y(()=>{l();c();d();ue();Cl=r=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate());if(r>=t)return r.toLocaleString("default",{hour:"numeric",minute:"numeric"});let o=new Date(t);if(o.setDate(e.getDate()-e.getDay()),r>=o)return r.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});let i=new Date(o);return i.setDate(o.getDate()-7),r>=i?r.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):r.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},dS=r=>{let e=r.getMonth(),t=r.getDate();return`${x7(e)} ${t}`},x7=r=>{switch(r){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}},Ac=(r,e)=>{let t;return function(){let o=()=>r.apply(this,arguments);window.clearTimeout(t),t=window.setTimeout(o,e)}},gf=r=>new Promise((e,t)=>{let o=new FileReader;o.onerror=t,o.onload=()=>{e(o.result)},o.readAsDataURL(r)}),vf=r=>r.startsWith("[")?r.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():r,yf=r=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r),wu=(r,e=2)=>{if(r===0)return"0 Bytes";let t=1024,o=e<0?0:e,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(r)/Math.log(t));return`${parseFloat((r/Math.pow(t,n)).toFixed(o))} ${i[n]}`},Rc=r=>(r&&(r=r?.replace(/<ddd\/>/gi,"..."),r=r?.replace(/<c0>/gi,"<b>"),r=r?.replace(/<\/c0>/gi,"</b>")),r),Pc=r=>r?.replace(/\.[^/.]+$/,""),bf=r=>new URL(r).pathname.split("/").pop().replace(/-/g," "),uS=r=>r||Q.config.response.invalidationPeriod||Q.config.defaultInvalidationPeriod,wf=()=>Q.config.response.isEnabled&&Q.config.isEnabled});var N,hn=y(()=>{l();c();d();N={presence:{name:"presence",stores:{presence:"presence"},version:2},users:{name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters"},version:3},photos:{name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups",teams:"teams"},version:2},people:{name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:3},groups:{name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:5},get:{name:"responses",stores:{responses:"responses"},version:2},search:{name:"search",stores:{responses:"responses"},version:2},files:{name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:2},fileLists:{name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:2}}});var Cf,Ut,vr,xf,xs,hS,k7,la,kf,Co,G0,pS,Ln=y(()=>{l();c();d();ue();Ai();hn();Cf=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})};(function(r){r[r.any=0]="any",r.person="person",r.group="group"})(Ut||(Ut={}));(function(r){r.any="any",r.user="user",r.contact="contact"})(vr||(vr={}));xf=()=>Q.config.people.invalidationPeriod||Q.config.defaultInvalidationPeriod,xs=()=>Q.config.people.isEnabled&&Q.config.isEnabled,hS=["People.Read","People.Read.All"],k7=["Contacts.Read","Contacts.ReadWrite"],la=(r,e,t=10,o=vr.any,i="")=>Cf(void 0,void 0,void 0,function*(){let n=`${e}:${t}:${o}`,s;if(xs()){let h=N.people,p=N.people.stores.peopleQuery;s=Q.getCache(h,p);let f=xs()?yield s.getValue(n):null;if(f&&xf()>Date.now()-f.timeCached)return f.results.map(b=>JSON.parse(b))}let a="personType/class eq 'Person'";o!==vr.any&&(o===vr.user?a+="and personType/subclass eq 'OrganizationUser'":a+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),i!==""&&(a+=` and  ${i}`);let u;try{let h=r.api("/me/people").search('"'+e+'"').top(t).filter(a).middlewareOptions(ye(hS));if(o!==vr.contact&&(h=h.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),u=yield h.get(),xs()&&u){let p={maxResults:t,results:null};p.results=u.value.map(f=>JSON.stringify(f)),yield s.putValue(n,p)}}catch{}return u?.value}),kf=(r,e=vr.any,t="",o=10)=>Cf(void 0,void 0,void 0,function*(){let i,n=`${t||`*:${e}`}:${o}`;if(xs()){i=Q.getCache(N.people,N.people.stores.peopleQuery);let h=yield i.getValue(n);if(h&&xf()>Date.now()-h.timeCached)return h.results.map(p=>JSON.parse(p))}let s="/me/people",a="personType/class eq 'Person'";e!==vr.any&&(e===vr.user?a+="and personType/subclass eq 'OrganizationUser'":a+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),t&&(a+=` and ${t}`);let u;try{let h=r.api(s).middlewareOptions(ye(hS)).top(o).filter(a);e!==vr.contact&&(h=h.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),u=yield h.get(),xs()&&u&&(yield i.putValue(n,{maxResults:10,results:u.value.map(p=>JSON.stringify(p))}))}catch{}return u?u.value:null}),Co=r=>{var e,t;let o=r,i=r,n=r;return i.mail?vf(i.mail):!((e=o.scoredEmailAddresses)===null||e===void 0)&&e.length?vf(o.scoredEmailAddresses[0].address):!((t=n.emailAddresses)===null||t===void 0)&&t.length?vf(n.emailAddresses[0].address):null},G0=(r,e)=>Cf(void 0,void 0,void 0,function*(){let t;if(xs()){t=Q.getCache(N.people,N.people.stores.contacts);let n=yield t.getValue(e);if(n&&xf()>Date.now()-n.timeCached)return JSON.parse(n.person)}let o=`${e.replace(/#/g,"%2523")}`,i=yield r.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${o}')`).middlewareOptions(ye(k7)).get();return xs()&&i&&(yield t.putValue(e,{person:JSON.stringify(i.value)})),i?i.value:null}),pS=(r,e,t,o)=>Cf(void 0,void 0,void 0,function*(){var i;let n,s=`${e}${t}`;if(xs()){n=Q.getCache(N.people,N.people.stores.peopleQuery);let h=yield n.getValue(s);if(h&&xf()>Date.now()-h.timeCached)return h.results.map(p=>JSON.parse(p))}let a=r.api(t).version(e);o?.length&&(a=a.middlewareOptions(ye(o)));let u=yield a.get();if(u&&Array.isArray(u.value)&&u["@odata.nextLink"]){let h=u;for(;h?.["@odata.nextLink"];){let f=h["@odata.nextLink"].split(e)[1];h=yield r.api(f).version(e).get(),!((i=h?.value)===null||i===void 0)&&i.length&&(h.value=u.value.concat(h.value),u=h)}}if(xs()&&u){let h={results:null};Array.isArray(u.value)?h.results=u.value.map(p=>JSON.stringify(p)):h.results=[JSON.stringify(u)],yield n.putValue(s,h)}return u?.value})});var Nn,ks,nr,fS,S7,Cu,ca,xu,xl,mS,kl,Sl,j0,da=y(()=>{l();c();d();ue();hn();Ln();Nn=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},ks=()=>Q.config.users.invalidationPeriod||Q.config.defaultInvalidationPeriod,nr=()=>Q.config.users.isEnabled&&Q.config.isEnabled,fS=(r,e="",t=10)=>Nn(void 0,void 0,void 0,function*(){let o=["User.ReadBasic.All","User.Read.All","Directory.Read.All","User.ReadWrite.All","Directory.ReadWrite.All"],i="/users",n,s=`${e===""?"*":e}:${t}`,a={maxResults:t,results:null};if(nr()){n=Q.getCache(N.users,N.users.stores.userFilters);let h=yield n.getValue(s);if(h&&ks()>Date.now()-h.timeCached)return h.results.map(p=>JSON.parse(p))}let u=r.api(i).top(t);e&&u.filter(e);try{let h=yield u.middlewareOptions(ye(o)).get();return nr()&&h&&(a.results=h.value.map(p=>JSON.stringify(p)),yield n.putValue(e,a)),h.value}catch{}}),S7=["User.Read","User.ReadWrite"],Cu=(r,e)=>Nn(void 0,void 0,void 0,function*(){let t;if(nr()){t=Q.getCache(N.users,N.users.stores.users);let n=yield t.getValue("me");if(n&&ks()>Date.now()-n.timeCached){let s=JSON.parse(n.user),a=e?e.filter(u=>!Object.keys(s).includes(u)):null;if(!a||a.length<=1)return s}}let o="me";e&&(o=o+"?$select="+e.toString());let i=yield r.api(o).middlewareOptions(ye(S7)).get();return nr()&&(yield t.putValue("me",{user:JSON.stringify(i)})),i}),ca=["User.ReadBasic.All","User.Read.All","Directory.Read.All","User.ReadWrite.All","Directory.ReadWrite.All"],xu=(r,e,t)=>Nn(void 0,void 0,void 0,function*(){let o;if(nr()){o=Q.getCache(N.users,N.users.stores.users);let s=yield o.getValue(e);if(s&&ks()>Date.now()-s.timeCached){let a=s.user?JSON.parse(s.user):null,u=t&&a?t.filter(h=>!Object.keys(a).includes(h)):null;if(!u||u.length<=1)return a}}let i=`/users/${e}`;t&&(i=i+"?$select="+t.toString());let n;try{n=yield r.api(i).middlewareOptions(ye(ca)).get()}catch{}return nr()&&(yield o.putValue(e,{user:JSON.stringify(n)})),n}),xl=(r,e,t="",o="",i)=>Nn(void 0,void 0,void 0,function*(){if(!e||e.length===0)return[];let n=r.createBatch(),s={},a={},u=[];t=t.toLowerCase();let h;nr()&&(h=Q.getCache(N.users,N.users.stores.users));for(let p of e){s[p]=null;let f=`/users/${p}`,b,x;if(nr()&&(x=yield h.getValue(p)),x?.user&&ks()>Date.now()-x.timeCached)if(b=JSON.parse(x?.user),t){if(b){let S=b.displayName;S?.toLowerCase().includes(t)&&(a[p]=b)}}else b?s[p]=b:(n.get(p,f,ca),u.push(p));else p!==""&&(p==="me"?s[p]=yield Cu(r):(f=`/users/${p}`,o&&(f+=`${f}?$filter=${o}`),n.get(p,f,ca),u.push(p)))}try{if(n.hasRequests){let p=yield n.executeAll();for(let f of e){let b=p.get(f);if(b?.content){let x=b.content;t?(x?.displayName.toLowerCase()||"").includes(t)&&(a[f]=x):s[f]=x,nr()&&(yield h.putValue(f,{user:JSON.stringify(x)}))}else{let x=i.find(S=>Object.values(S).includes(f));x&&(s[f]=x)}}}return t&&Object.keys(a).length?Promise.all(Object.values(a)):Promise.all(Object.values(s))}catch{try{return e.filter(f=>u.includes(f)).forEach(f=>{s[f]=xu(r,f)}),nr()&&(yield Promise.all(e.filter(f=>u.includes(f)).map(f=>Nn(void 0,void 0,void 0,function*(){return yield h.putValue(f,{user:JSON.stringify(yield s[f])})})))),Promise.all(Object.values(s))}catch{return[]}}}),mS=(r,e,t)=>Nn(void 0,void 0,void 0,function*(){var o;let i=["People.Read","People.Read.All"];if(!e||e.length===0)return[];let n=r.createBatch(),s=[],a,u;nr()&&(u=Q.getCache(N.users,N.users.stores.usersQuery));for(let h of e)if(nr()&&(a=yield u.getValue(h)),nr()&&a?.results[0]&&ks()>Date.now()-a.timeCached){let p=JSON.parse(a.results[0]);s.push(p)}else n.get(h,`/me/people?$search="${h}"`,i,{"X-PeopleQuery-QuerySources":"Mailbox,Directory"});if(n.hasRequests)try{let h=yield n.executeAll();for(let p of e){let f=h.get(p);if(!((o=f?.content)===null||o===void 0)&&o.value&&f.content.value.length>0)s.push(f.content.value[0]),nr()&&(yield u.putValue(p,{maxResults:1,results:[JSON.stringify(f.content.value[0])]}));else{let b=t.find(x=>Object.values(x).includes(p));b&&s.push(b)}}return s}catch{try{return Promise.all(e.filter(p=>p&&p!=="").map(p=>Nn(void 0,void 0,void 0,function*(){let f=yield la(r,p,1);if(f?.length)return nr()&&(yield u.putValue(p,{maxResults:1,results:[JSON.stringify(f[0])]})),f[0]})))}catch{return[]}}return s}),kl=(r,e,t=10,o="")=>Nn(void 0,void 0,void 0,function*(){let i=ca,n={maxResults:t,results:null},s=`${e}:${t}:${o}`,a;if(nr()){a=Q.getCache(N.users,N.users.stores.usersQuery);let f=yield a.getValue(s);if(f&&ks()>Date.now()-f.timeCached)return f.results.map(b=>JSON.parse(b))}let u=`${e.replace(/#/g,"%2523")}`,h=r.api("users").header("ConsistencyLevel","eventual").count(!0).search(`"displayName:${u}" OR "mail:${u}"`),p;o!==""&&h.filter(o);try{p=yield h.top(t).middlewareOptions(ye(i)).get()}catch{}return nr()&&p&&(n.results=p.value.map(f=>JSON.stringify(f)),yield a.putValue(e,n)),p?p.value:null}),Sl=(r,e,t,o=10,i=Ut.person,n=!1,s="",a="")=>Nn(void 0,void 0,void 0,function*(){let u=["GroupMember.Read.All","Group.Read.All","Directory.Read.All","GroupMember.ReadWrite.All","Group.ReadWrite.All"],h={maxResults:o,results:null},p,f=`${t||"*"}:${e||"*"}:${o}:${i}:${n}:${s}`;if(nr()){p=Q.getCache(N.users,N.users.stores.usersQuery);let R=yield p.getValue(f);if(R&&ks()>Date.now()-R.timeCached)return R.results.map(z=>JSON.parse(z))}let b="";e&&(b=`startswith(displayName,'${e}') or startswith(givenName,'${e}') or startswith(surname,'${e}') or startswith(mail,'${e}') or startswith(userPrincipalName,'${e}')`);let x=`/groups/${t}/${n?"transitiveMembers":"members"}`;i===Ut.person?x+="/microsoft.graph.user":i===Ut.group&&(x+="/microsoft.graph.group",e&&(b=`startswith(displayName,'${e}') or startswith(mail,'${e}')`)),s&&(b+=e?` and ${s}`:s),a&&(b+=e?` and ${a}`:a);let S=yield r.api(x).count(!0).top(o).filter(b).header("ConsistencyLevel","eventual").middlewareOptions(ye(u)).get();return nr()&&S&&(h.results=S.value.map(R=>JSON.stringify(R)),yield p.putValue(f,h)),S?S.value:null}),j0=(r,e,t,o=10,i=Ut.person,n=!1,s="")=>Nn(void 0,void 0,void 0,function*(){let a=[];for(let u of t)try{let h=yield Sl(r,e,u,o,i,n,s);a.push(...h)}catch{continue}return a})});var _l,Tl,mi,Sf,vS,Ss,gS,K0,ku,yS,bS,Su,$c=y(()=>{l();c();d();ue();tl();Ai();hn();Ln();da();_l=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Tl=()=>Q.config.photos.invalidationPeriod||Q.config.defaultInvalidationPeriod,mi=()=>Q.config.photos.isEnabled&&Q.config.isEnabled,Sf=["User.ReadBasic.All","User.Read.All","User.ReadWrite.All"],vS=["User.Read","User.ReadWrite",...Sf],Ss=(r,e,t)=>_l(void 0,void 0,void 0,function*(){try{let o=yield r.api(`${e}/photo/$value`).responseType(xr.RAW).middlewareOptions(ye(t)).get();if(o.status===404)return{eTag:null,photo:null};if(!o.ok)return null;let i=o["@odata.mediaEtag"],n=yield gf(yield o.blob());return{eTag:i,photo:n}}catch{return null}}),gS=(r,e)=>_l(void 0,void 0,void 0,function*(){let t,o;if(mi()&&(t=Q.getCache(N.photos,N.photos.stores.contacts),o=yield t.getValue(e),o&&Tl()>Date.now()-o.timeCached))return o.photo;let i=["Contacts.Read","Contacts.ReadWrite"];return o=yield Ss(r,`me/contacts/${e}`,i),mi()&&o&&(yield t.putValue(e,o)),o?o.photo:null}),K0=(r,e)=>_l(void 0,void 0,void 0,function*(){let t,o;if(mi()){if(t=Q.getCache(N.photos,N.photos.stores.users),o=yield t.getValue(e),o&&Tl()>Date.now()-o.timeCached)return o.photo;if(o)try{let i=yield r.api(`users/${e}/photo`).get();i&&(i["@odata.mediaEtag"]!==o.eTag||i["@odata.mediaEtag"]===null&&o.eTag===null)&&(o=null)}catch{return null}}return o=o||(yield Ss(r,`users/${e}`,Sf)),mi()&&o&&(yield t.putValue(e,o)),o?o.photo:null}),ku=(r,e,t=!0)=>_l(void 0,void 0,void 0,function*(){if("personType"in e&&e.personType.subclass!=="OrganizationUser"){if(e.personType.subclass==="PersonalContact"&&t){let i=Co(e),n=yield G0(r,i);if(n?.length&&n[0].id)return yield gS(r,n[0].id)}return null}if(e.userPrincipalName||e.id){let i=e.userPrincipalName||e.id;return yield K0(r,i)}if(e.id){let i=yield K0(r,e.id);if(i)return i}let o=Co(e);if(o){let i=yield kl(r,o,1);if(i?.length)return yield K0(r,i[0].id);if(t){let n=yield G0(r,o);if(n?.length)return yield gS(r,n[0].id)}}return null}),yS=(r,e)=>_l(void 0,void 0,void 0,function*(){let t,o,i=e.id;if(mi()){if(o=Q.getCache(N.photos,N.photos.stores.groups),t=yield o.getValue(i),t&&Tl()>Date.now()-t.timeCached)return t.photo;if(t)try{let s=yield r.api(`groups/${i}/photo`).get();s&&(s["@odata.mediaEtag"]!==t.eTag||s["@odata.mediaEtag"]===null&&t.eTag===null)&&(t=null)}catch{return null}}let n=["Group.Read.All","Group.ReadWrite.All"];return t=t||(yield Ss(r,`groups/${i}`,n)),mi()&&t&&(yield o.putValue(i,t)),t?t.photo:null}),bS=(r,e)=>_l(void 0,void 0,void 0,function*(){return yield Q.getCache(N.photos,e).getValue(r)}),Su=(r,e,t)=>_l(void 0,void 0,void 0,function*(){yield Q.getCache(N.photos,e).putValue(r,t)})});var wS,CS,Oc,_u,xS,_f=y(()=>{l();c();d();ue();hn();wS=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},CS=()=>Q.config.presence.invalidationPeriod||Q.config.defaultInvalidationPeriod,Oc=()=>Q.config.presence.isEnabled&&Q.config.isEnabled,_u=(r,e)=>wS(void 0,void 0,void 0,function*(){let t;if(Oc()){t=Q.getCache(N.presence,N.presence.stores.presence);let s=yield t.getValue(e||"me");if(s&&CS()>Date.now()-s.timeCached)return JSON.parse(s.presence)}let o=e?["presence.read.all"]:["presence.read","presence.read.all"],i=e?`/users/${e}/presence`:"/me/presence",n=yield r.api(i).middlewareOptions(ye(o)).get();return Oc()&&(yield t.putValue(e||"me",{presence:JSON.stringify(n)})),n}),xS=(r,e)=>wS(void 0,void 0,void 0,function*(){if(!e||e.length===0)return{};let t={},o=[],i=["presence.read.all"],n;Oc()&&(n=Q.getCache(N.presence,N.presence.stores.presence));for(let s of e)if(s?.id){let a=s.id;t[a]=null;let u;Oc()&&(u=yield n.getValue(a)),Oc()&&u&&CS()>Date.now()-u.timeCached?t[a]=JSON.parse(u.presence):o.push(a)}try{if(o.length>0){let s=yield r.api("/communications/getPresencesByUserId").middlewareOptions(ye(i)).post({ids:o});for(let a of s.value)t[a.id]=a,Oc()&&(yield n.putValue(a.id,{presence:JSON.stringify(a)}))}return t}catch{try{let a=yield Promise.all(e.filter(u=>u?.id&&!t[u.id]&&"personType"in u&&u.personType.subclass==="OrganizationUser").map(u=>_u(r,u.id)));for(let u of a)t[u.id]=u;return t}catch{return null}}})});var Tf,W0=y(()=>{l();c();d();Tf=r=>{let e=r;return e.statusCode&&"code"in e&&"body"in e&&e.date&&"message"in e&&"name"in e&&"requestId"in e}});var _7,El,Ef=y(()=>{l();c();d();ue();$c();da();hn();W0();_7=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},El=(r,e,t)=>_7(void 0,void 0,void 0,function*(){let o=["User.ReadBasic.All","User.Read.All","Directory.Read.All","User.ReadWrite.All","Directory.ReadWrite.All"],i=["User.Read","User.ReadWrite",...o],n=e?o:i,s=e?Sf:vS,a,u=null,h,p,f=e?`users/${e}`:"me",b=f+(t?`?$select=${t.toString()}`:"");if(nr()&&(p=yield Q.getCache(N.users,N.users.stores.users).getValue(e||"me"),p&&ks()>Date.now()-p.timeCached?(u=p.user?JSON.parse(p.user):null,u!==null&&t&&t.filter(R=>!Object.keys(u).includes(R)).length>=1&&(u=null,p=null)):p=null),mi()){if(h=yield bS(e||"me",N.photos.stores.users),h&&Tl()>Date.now()-h.timeCached)a=h.photo;else if(h)try{let x=yield r.api(`${f}/photo`).get();x?.["@odata.mediaEtag"]&&x["@odata.mediaEtag"]===h.eTag?(yield Su(e||"me",N.photos.stores.users,h),a=h.photo):h=null}catch(x){Tf(x)&&(x.code==="ErrorItemNotFound"||x.code==="ImageNotFound")&&(yield Su(e||"me",N.photos.stores.users,{eTag:null,photo:null}))}}if(!h&&!p){let x,S=r.createBatch();e?(S.get("user",`/users/${e}${t?"?$select="+t.toString():""}`,n),S.get("photo",`users/${e}/photo/$value`,s)):(S.get("user","me",n),S.get("photo","me/photo/$value",s));let R=yield S.executeAll(),z=R.get("photo");z&&(x=z.headers.ETag,a=z.content);let we=R.get("user");we&&(u=we.content),nr()&&(yield Q.getCache(N.users,N.users.stores.users).putValue(e||"me",{user:JSON.stringify(u)})),mi()&&(yield Su(e||"me",N.photos.stores.users,{eTag:x,photo:a}))}else if(h){if(!p)try{let x=yield r.api(b).middlewareOptions(ye(n)).get();x&&(nr()&&(yield Q.getCache(N.users,N.users.stores.users).putValue(e||"me",{user:JSON.stringify(x)})),u=x)}catch{}}else try{let x=yield Ss(r,f,s);x&&(mi()&&(yield Su(e||"me",N.photos.stores.users,{eTag:x.eTag,photo:x.photo})),a=x.photo)}catch{}return u&&(u.personImage=a),u})});var xe,_s=y(()=>{l();c();d();(function(r){r[r.image=2]="image",r[r.oneline=3]="oneline",r[r.twolines=4]="twolines",r[r.threelines=5]="threelines",r[r.fourlines=6]="fourlines"})(xe||(xe={}))});var P,Y,Vr=y(()=>{l();c();d();Te();(function(r){r[r.ArrowDown=0]="ArrowDown",r[r.TeamSeparator=1]="TeamSeparator",r[r.Search=2]="Search",r[r.SkypeArrow=3]="SkypeArrow",r[r.SmallEmail=4]="SmallEmail",r[r.SmallEmailHovered=5]="SmallEmailHovered",r[r.SmallChat=6]="SmallChat",r[r.SmallChatHovered=7]="SmallChatHovered",r[r.Video=8]="Video",r[r.VideoHovered=9]="VideoHovered",r[r.ExpandDown=10]="ExpandDown",r[r.Overview=11]="Overview",r[r.Send=12]="Send",r[r.Contact=13]="Contact",r[r.Copy=14]="Copy",r[r.Phone=15]="Phone",r[r.CellPhone=16]="CellPhone",r[r.Chat=17]="Chat",r[r.Call=18]="Call",r[r.CallHovered=19]="CallHovered",r[r.Confirmation=20]="Confirmation",r[r.Department=21]="Department",r[r.Dot=22]="Dot",r[r.Email=23]="Email",r[r.OfficeLocation=24]="OfficeLocation",r[r.Person=25]="Person",r[r.Messages=26]="Messages",r[r.Organization=27]="Organization",r[r.ExpandRight=28]="ExpandRight",r[r.Profile=29]="Profile",r[r.Birthday=30]="Birthday",r[r.File=31]="File",r[r.Files=32]="Files",r[r.Back=33]="Back",r[r.Close=34]="Close",r[r.Upload=35]="Upload",r[r.FileCloud=36]="FileCloud",r[r.DragFile=37]="DragFile",r[r.Cancel=38]="Cancel",r[r.CheckMark=39]="CheckMark",r[r.Radio=40]="Radio",r[r.Success=41]="Success",r[r.Fail=42]="Fail",r[r.SelectAccount=43]="SelectAccount",r[r.News=44]="News",r[r.DoubleBookmark=45]="DoubleBookmark",r[r.ChevronLeft=46]="ChevronLeft",r[r.ChevronRight=47]="ChevronRight",r[r.Event=48]="Event",r[r.BookOpen=49]="BookOpen",r[r.FileOuter=50]="FileOuter",r[r.BookQuestion=51]="BookQuestion",r[r.Globe=52]="Globe",r[r.Delete=53]="Delete",r[r.Add=54]="Add",r[r.Calendar=55]="Calendar",r[r.Planner=56]="Planner",r[r.Milestone=57]="Milestone",r[r.PersonAdd=58]="PersonAdd",r[r.PresenceAvailable=59]="PresenceAvailable",r[r.PresenceOofAvailable=60]="PresenceOofAvailable",r[r.PresenceBusy=61]="PresenceBusy",r[r.PresenceOofBusy=62]="PresenceOofBusy",r[r.PresenceDnd=63]="PresenceDnd",r[r.PresenceOofDnd=64]="PresenceOofDnd",r[r.PresenceAway=65]="PresenceAway",r[r.PresenceOofAway=66]="PresenceOofAway",r[r.PresenceOffline=67]="PresenceOffline",r[r.PresenceStatusUnknown=68]="PresenceStatusUnknown"})(P||(P={}));Y=(r,e)=>{switch(r){case P.ArrowDown:return k`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case P.TeamSeparator:return k`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${e}
          />
        </svg>
      `;case P.Search:return k`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.30887 8.01596C6.53903 8.63179 5.56252 9.00004 4.5 9.00004C2.01472 9.00004 0 6.98531 0 4.50002C0 2.01473 2.01472 0 4.5 0C6.98528 0 9 2.01473 9 4.50002C9 5.56252 8.63177 6.53901 8.01597 7.30885L11.8536 11.1464C12.0488 11.3417 12.0488 11.6583 11.8536 11.8536C11.6583 12.0488 11.3417 12.0488 11.1464 11.8536L7.30887 8.01596ZM8 4.50002C8 2.56701 6.433 1 4.5 1C2.567 1 1 2.56701 1 4.50002C1 6.43302 2.567 8.00003 4.5 8.00003C6.433 8.00003 8 6.43302 8 4.50002Z" fill="currentColor"/>
        </svg>`;case P.SkypeArrow:return k`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case P.SmallEmail:return k`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M16 3.373V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 -7.62939e-05 11.8807 -7.62939e-05 10.5V3.373L7.74649 7.93097C7.90297 8.02301 8.09704 8.02301 8.25351 7.93097L16 3.373ZM13.5 0C14.7871 0 15.847 0.972604 15.9848 2.22293L8 6.91991L0.0151832 2.22293C0.15304 0.972604 1.21294 0 2.5 0H13.5Z" fill="currentColor"/>
          <path class="regular" d="M13.608 0.833496C14.9887 0.833496 16.108 1.95278 16.108 3.3335V11.3335C16.108 12.7142 14.9887 13.8335 13.608 13.8335H2.60803C1.22732 13.8335 0.108032 12.7142 0.108032 11.3335V3.3335C0.108032 1.95278 1.22732 0.833496 2.60803 0.833496H13.608ZM15.108 4.7945L8.36154 8.76446C8.23115 8.84117 8.07464 8.85395 7.93554 8.80281L7.85452 8.76446L1.10803 4.7965V11.3335C1.10803 12.1619 1.77961 12.8335 2.60803 12.8335H13.608C14.4365 12.8335 15.108 12.1619 15.108 11.3335V4.7945ZM13.608 1.8335H2.60803C1.77961 1.8335 1.10803 2.50507 1.10803 3.3335V3.6355L8.10803 7.75341L15.108 3.6345V3.3335C15.108 2.50507 14.4365 1.8335 13.608 1.8335Z" fill="currentColor"/>
        </svg>
      `;case P.SmallChat:return k`
        <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8.5 9H5.5L5.41012 9.00806C5.17688 9.05039 5 9.25454 5 9.5C5 9.74546 5.17688 9.94961 5.41012 9.99194L5.5 10H8.5L8.58988 9.99194C8.82312 9.94961 9 9.74546 9 9.5C9 9.25454 8.82312 9.05039 8.58988 9.00806L8.5 9ZM10.5 6H5.5L5.41012 6.00806C5.17688 6.05039 5 6.25454 5 6.5C5 6.74546 5.17688 6.94961 5.41012 6.99194L5.5 7H10.5L10.5899 6.99194C10.8231 6.94961 11 6.74546 11 6.5C11 6.25454 10.8231 6.05039 10.5899 6.00806L10.5 6Z" fill="currentColor"/>
          <path class="regular" d="M8.38599 0.833496C12.8043 0.833496 16.386 4.41522 16.386 8.8335C16.386 13.2518 12.8043 16.8335 8.38599 16.8335C7.11277 16.8335 5.8819 16.5353 4.77267 15.9728L4.65199 15.9085L1.00708 16.8186C0.697255 16.8959 0.41221 16.6704 0.387296 16.3773L0.387128 16.2959L0.400919 16.2122L1.31099 12.5685L1.24768 12.4488C0.792589 11.5521 0.510317 10.5757 0.418733 9.56176L0.393362 9.17984L0.385986 8.8335C0.385986 4.41522 3.96771 0.833496 8.38599 0.833496ZM8.38599 1.8335C4.51999 1.8335 1.38599 4.9675 1.38599 8.8335C1.38599 10.0505 1.69653 11.2213 2.27951 12.2584C2.32645 12.3419 2.34809 12.4365 2.34291 12.5308L2.32873 12.6247L1.57299 15.6455L4.59703 14.8918C4.65892 14.8764 4.72261 14.8731 4.78472 14.8814L4.87629 14.9026L4.963 14.941C5.9996 15.5233 7.16969 15.8335 8.38599 15.8335C12.252 15.8335 15.386 12.6995 15.386 8.8335C15.386 4.9675 12.252 1.8335 8.38599 1.8335ZM8.88599 9.8335C9.16213 9.8335 9.38599 10.0574 9.38599 10.3335C9.38599 10.579 9.20911 10.7831 8.97586 10.8254L8.88599 10.8335H5.88599C5.60984 10.8335 5.38599 10.6096 5.38599 10.3335C5.38599 10.088 5.56286 9.88389 5.79611 9.84155L5.88599 9.8335H8.88599ZM10.886 6.8335C11.1621 6.8335 11.386 7.05735 11.386 7.3335C11.386 7.57896 11.2091 7.7831 10.9759 7.82544L10.886 7.8335L5.88599 7.8335C5.60984 7.8335 5.38599 7.60964 5.38599 7.3335C5.38599 7.08804 5.56286 6.88389 5.79611 6.84155L5.88599 6.8335L10.886 6.8335Z" fill="currentColor"/>
        </svg>
      `;case P.Video:return k`
        <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="filled" d="M11 2.5C11 1.11929 9.88071 0 8.5 0H2.5C1.11929 0 0 1.11929 0 2.5V9.5C0 10.8807 1.11929 12 2.5 12H8.5C9.88071 12 11 10.8807 11 9.5V2.5ZM12 3.93082V8.08149L14.7642 10.4319C15.2512 10.8461 16 10.4999 16 9.86055V2.19315C16 1.55685 15.2575 1.20962 14.7692 1.61756L12 3.93082Z" fill="currentColor"/>
          <path class="regular" d="M2.72095 0.833496C1.34024 0.833496 0.220947 1.95278 0.220947 3.3335V10.3335C0.220947 11.7142 1.34024 12.8335 2.72095 12.8335H9.72095C11.1017 12.8335 12.2209 11.7142 12.2209 10.3335V9.33348L14.6209 11.1335C15.2802 11.6279 16.2209 11.1575 16.2209 10.3335V3.33348C16.2209 2.50944 15.2802 2.03905 14.6209 2.53348L12.2209 4.33348V3.3335C12.2209 1.95278 11.1017 0.833496 9.72095 0.833496H2.72095ZM12.2209 5.58348L15.2209 3.33348V10.3335L12.2209 8.08348V5.58348ZM11.2209 3.3335V10.3335C11.2209 11.1619 10.5494 11.8335 9.72095 11.8335H2.72095C1.89252 11.8335 1.22095 11.1619 1.22095 10.3335V3.3335C1.22095 2.50507 1.89252 1.8335 2.72095 1.8335H9.72095C10.5494 1.8335 11.2209 2.50507 11.2209 3.3335Z" fill="currentColor"/>
        </svg>
      `;case P.ExpandDown:return k`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="currentColor" />
        </svg>
      `;case P.Overview:return k`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.5 10.5C2.67157 10.5 2 9.82843 2 9V4C2 3.17157 2.67157 2.5 3.5 2.5H12.5C13.3284 2.5 14 3.17157 14 4V9C14 9.82843 13.3284 10.5 12.5 10.5H3.5ZM3.5 3.5C3.22386 3.5 3 3.72386 3 4V5.5H13V4C13 3.72386 12.7761 3.5 12.5 3.5H3.5ZM5 6.5H3V9C3 9.27614 3.22386 9.5 3.5 9.5H5V6.5ZM6 9.5H12.5C12.7761 9.5 13 9.27614 13 9V6.5H6V9.5ZM0 3C0 1.61929 1.11929 0.5 2.5 0.5H13.5C14.8807 0.5 16 1.61929 16 3V10C16 11.3807 14.8807 12.5 13.5 12.5H2.5C1.11929 12.5 0 11.3807 0 10V3ZM2.5 1.5C1.67157 1.5 1 2.17157 1 3V10C1 10.8284 1.67157 11.5 2.5 11.5H13.5C14.3284 11.5 15 10.8284 15 10V3C15 2.17157 14.3284 1.5 13.5 1.5H2.5Z" fill="#717171"/>
        </svg>
      `;case P.Send:return k`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case P.Contact:return k`
        <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5ZM2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879ZM9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5ZM0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z" fill="#717171"/>
        </svg>
      `;case P.Call:return k`
        <svg width="13" height="17" viewBox="0 0 13 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M3.98706 1.06589C4.89545 0.792081 5.86254 1.19479 6.31418 2.01224L6.38841 2.16075L7.04987 3.63213C7.46246 4.54992 7.28209 5.61908 6.60754 6.3496L6.47529 6.48248L5.43194 7.45541C5.24417 7.63298 5.38512 8.32181 6.06527 9.49986C6.67716 10.5597 7.17487 11.0552 7.41986 11.0823L7.4628 11.082L7.5158 11.0716L9.56651 10.4446C10.1332 10.2713 10.7438 10.4487 11.1298 10.8865L11.2215 11.0014L12.5781 12.8815C13.1299 13.6462 13.0689 14.6842 12.4533 15.378L12.3314 15.5039L11.7886 16.018C10.7948 16.9592 9.34348 17.2346 8.07389 16.7231C6.13867 15.9433 4.38077 14.1607 2.78368 11.3945C1.18323 8.62242 0.519004 6.20438 0.815977 4.13565C0.99977 2.85539 1.87301 1.78674 3.07748 1.3462L3.27036 1.28192L3.98706 1.06589Z" fill="currentColor"/>
          <path class="regular" d="M3.9292 0.399388L3.2125 0.615419C1.90898 1.00834 0.951582 2.1215 0.758116 3.46915C0.461142 5.53787 1.12537 7.95591 2.72582 10.728C4.32291 13.4942 6.0808 15.2768 8.01603 16.0565C9.28562 16.5681 10.7369 16.2927 11.7308 15.3515L12.2736 14.8374C13.0011 14.1485 13.1065 13.0275 12.5202 12.215L11.1636 10.3349C10.788 9.81423 10.1226 9.59039 9.50865 9.7781L7.45794 10.4051L7.40494 10.4154C7.17877 10.4485 6.65754 9.95942 6.00741 8.83335C5.32726 7.65531 5.1863 6.96648 5.37408 6.7889L6.41743 5.81598C7.19937 5.08681 7.43039 3.94078 6.99201 2.96562L6.33055 1.49424C5.91866 0.578005 4.89102 0.109471 3.9292 0.399388ZM5.41847 1.90427L6.07993 3.37564C6.34277 3.96031 6.20426 4.64744 5.73543 5.08463L4.68953 6.05994C4.02044 6.69268 4.24206 7.77567 5.14138 9.33335C5.98759 10.799 6.75958 11.5233 7.58908 11.3977L7.71341 11.3711L9.80102 10.7344C10.0057 10.6718 10.2275 10.7464 10.3527 10.92L11.7093 12.8001C12.0024 13.2064 11.9497 13.7669 11.586 14.1113L11.0432 14.6254C10.3333 15.2977 9.29663 15.4944 8.38977 15.129C6.6917 14.4448 5.08689 12.8175 3.59185 10.228C2.09375 7.63319 1.48745 5.42604 1.74797 3.61125C1.88616 2.64864 2.57001 1.85352 3.5011 1.57287L4.2178 1.35684C4.69871 1.21188 5.21253 1.44615 5.41847 1.90427Z" fill="currentColor"/>
        </svg>
      `;case P.Confirmation:return k`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.03212 13.9072L3.56056 10.0017C3.28538 9.69214 2.81132 9.66425 2.50174 9.93944C2.19215 10.2146 2.16426 10.6887 2.43945 10.9983L6.43945 15.4983C6.72614 15.8208 7.2252 15.8355 7.53034 15.5303L18.0303 5.03033C18.3232 4.73744 18.3232 4.26256 18.0303 3.96967C17.7374 3.67678 17.2626 3.67678 16.9697 3.96967L7.03212 13.9072Z" fill="#009E00"/>
      </svg>
      `;case P.Copy:return k`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case P.Phone:return k`
        <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" fill="none">
            <path d="M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z" fill="${e}"></path>
        </svg>
      `;case P.CellPhone:return k`
        <svg width="10" height="16" viewBox="0 0 10 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 12C3.72386 12 3.5 12.2239 3.5 12.5C3.5 12.7761 3.72386 13 4 13H6C6.27614 13 6.5 12.7761 6.5 12.5C6.5 12.2239 6.27614 12 6 12H4ZM2 0C0.89543 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H8C9.10457 16 10 15.1046 10 14V2C10 0.89543 9.10457 0 8 0H2ZM1 2C1 1.44772 1.44772 1 2 1H8C8.55228 1 9 1.44772 9 2V14C9 14.5523 8.55228 15 8 15H2C1.44772 15 1 14.5523 1 14V2Z" fill="#717171"/>
        </svg>
      `;case P.Chat:return k`
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7L5.5 7C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6L10.5 6Z" fill="#717171"/>
        </svg>
      `;case P.Department:return k`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 1.5V3H2C0.895431 3 0 3.89543 0 5V12C0 13.1046 0.895432 14 2 14H14.0026C15.1071 14 16.0026 13.1046 16.0026 12V5C16.0026 3.89543 15.1071 3 14.0026 3H12V1.5C12 0.671573 11.3284 0 10.5 0H5.5C4.67157 0 4 0.671573 4 1.5ZM5.5 1H10.5C10.7761 1 11 1.22386 11 1.5V3H5V1.5C5 1.22386 5.22386 1 5.5 1ZM2 4H14.0026C14.5549 4 15.0026 4.44772 15.0026 5V7H12L12 6.50073C12 6.22459 11.7761 6.00073 11.5 6.00073C11.2239 6.00073 11 6.22459 11 6.50074L11 7H5V6.50073C5 6.22459 4.77614 6.00073 4.5 6.00073C4.22386 6.00073 4 6.22459 4 6.50073V7H1V5C1 4.44772 1.44772 4 2 4ZM11 8L11 8.5C11 8.77615 11.2239 9 11.5 9C11.7762 9 12 8.77614 12 8.5L12 8H15.0026V12C15.0026 12.5523 14.5549 13 14.0026 13H2C1.44772 13 1 12.5523 1 12V8H4V8.5C4 8.77614 4.22386 9 4.5 9C4.77614 9 5 8.77614 5 8.5V8H11Z" fill="#717171"/>
        </svg>
      `;case P.Dot:return k`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.25 10C6.25 10.6904 5.69036 11.25 5 11.25C4.30964 11.25 3.75 10.6904 3.75 10C3.75 9.30964 4.30964 8.75 5 8.75C5.69036 8.75 6.25 9.30964 6.25 10ZM11.25 10C11.25 10.6904 10.6904 11.25 10 11.25C9.30964 11.25 8.75 10.6904 8.75 10C8.75 9.30964 9.30964 8.75 10 8.75C10.6904 8.75 11.25 9.30964 11.25 10ZM15 11.25C15.6904 11.25 16.25 10.6904 16.25 10C16.25 9.30964 15.6904 8.75 15 8.75C14.3096 8.75 13.75 9.30964 13.75 10C13.75 10.6904 14.3096 11.25 15 11.25Z" fill="#242424"/>
        </svg>
        `;case P.Email:return k`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case P.OfficeLocation:return k`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <title>Location icon</title>
          <path d="M10 7C10 8.65685 8.65685 10 7 10C5.34315 10 4 8.65685 4 7C4 5.34315 5.34315 4 7 4C8.65685 4 10 5.34315 10 7ZM9 7C9 5.89543 8.10457 5 7 5C5.89543 5 5 5.89543 5 7C5 8.10457 5.89543 9 7 9C8.10457 9 9 8.10457 9 7ZM11.9497 11.955C14.6834 9.2201 14.6834 4.78601 11.9497 2.05115C9.21608 -0.683716 4.78392 -0.683716 2.05025 2.05115C-0.683418 4.78601 -0.683418 9.2201 2.05025 11.955L3.57128 13.4538L5.61408 15.4389L5.74691 15.5567C6.52168 16.1847 7.65623 16.1455 8.38611 15.4391L10.8223 13.0691L11.9497 11.955ZM2.75499 2.75619C5.09944 0.410715 8.90055 0.410715 11.245 2.75619C13.5294 5.04153 13.5879 8.71039 11.4207 11.0667L11.245 11.2499L9.92371 12.5539L7.69315 14.7225L7.60016 14.8021C7.24594 15.0699 6.7543 15.0698 6.40012 14.802L6.30713 14.7224L3.3263 11.817L2.75499 11.2499L2.57927 11.0667C0.412077 8.71039 0.47065 5.04153 2.75499 2.75619Z" fill="#717171"/>
        </svg>
      `;case P.Birthday:return k`
        <svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.81357 0.667333C6.07581 0.320242 6.48151 0 7 0C7.51849 0 7.92419 0.320242 8.18643 0.667333C8.45471 1.0224 8.63508 1.47991 8.69561 1.93392C8.75552 2.3832 8.70532 2.89341 8.42852 3.3086C8.134 3.75039 7.63965 4 7 4C6.36035 4 5.866 3.75039 5.57148 3.3086C5.29468 2.89341 5.24448 2.3832 5.30439 1.93392C5.36492 1.47991 5.54529 1.0224 5.81357 0.667333ZM6.40353 2.7539C6.484 2.87461 6.63965 3 7 3C7.36035 3 7.516 2.87461 7.59647 2.7539C7.69468 2.60659 7.74448 2.3668 7.70439 2.06608C7.66492 1.77009 7.54529 1.4776 7.38857 1.27017C7.22581 1.05476 7.08151 1 7 1C6.91849 1 6.77419 1.05476 6.61143 1.27017C6.45471 1.4776 6.33508 1.77009 6.29561 2.06608C6.25552 2.3668 6.30532 2.60659 6.40353 2.7539ZM1 7C1 5.89543 1.89543 5 3 5H11C12.1046 5 13 5.89543 13 7V12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H0.5C0.223858 13 0 12.7761 0 12.5C0 12.2239 0.223858 12 0.5 12H1V7ZM2 12H12V9.01931C11.9109 9.10285 11.8174 9.18842 11.7208 9.27412C11.4006 9.55804 11.0346 9.85319 10.6715 10.0802C10.3274 10.2953 9.90815 10.5 9.5 10.5C8.77182 10.5 8.30806 9.98986 8.00471 9.65617C7.9834 9.63273 7.96289 9.61016 7.94312 9.58869C7.5876 9.20261 7.35769 9 7 9C6.64231 9 6.4124 9.20261 6.05688 9.58869C6.03711 9.61016 6.0166 9.63273 5.99529 9.65617C5.69194 9.98986 5.22818 10.5 4.5 10.5C4.10587 10.5 3.69263 10.2897 3.35907 10.0789C3.00198 9.85313 2.63516 9.55951 2.31117 9.27666C2.20329 9.18247 2.09896 9.08844 2 8.9971V12ZM2 7.59993C2.05039 7.65198 2.11363 7.71652 2.1873 7.7902C2.38843 7.99132 2.6649 8.25801 2.96883 8.52334C3.27484 8.79049 3.59802 9.04687 3.89343 9.23362C4.21237 9.43525 4.41413 9.5 4.5 9.5C4.75817 9.5 4.93171 9.33433 5.32125 8.91131L5.32447 8.90781C5.65956 8.5439 6.16039 8 7 8C7.83961 8 8.34044 8.5439 8.67553 8.90781L8.67875 8.91131C9.06828 9.33433 9.24183 9.5 9.5 9.5C9.6106 9.5 9.82569 9.42967 10.1414 9.23229C10.4381 9.04681 10.7573 8.79196 11.0573 8.52588C11.3554 8.26163 11.6238 7.99594 11.8184 7.7955C11.89 7.72165 11.9513 7.65703 12 7.60506V7C12 6.44772 11.5523 6 11 6H3C2.44772 6 2 6.44772 2 7V7.59993Z" fill="#717171"/>
        </svg>
      `;case P.Person:return k`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case P.Messages:return k`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case P.Organization:return k`
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.99992 0C6.34271 0 4.99927 1.34344 4.99927 3.00066C4.99927 4.48754 6.08073 5.72183 7.49999 5.95985V7.5H4.5C3.67157 7.5 3 8.17157 3 9V10.0416C1.5811 10.2799 0.5 11.514 0.5 13.0007C0.5 14.6579 1.84344 16.0013 3.50066 16.0013C5.15787 16.0013 6.50131 14.6579 6.50131 13.0007C6.50131 11.5136 5.41954 10.2791 4 10.0414V9C4 8.72386 4.22386 8.5 4.5 8.5H11.5C11.7761 8.5 12 8.72386 12 9V10.0416C10.5811 10.2799 9.5 11.514 9.5 13.0007C9.5 14.6579 10.8434 16.0013 12.5007 16.0013C14.1579 16.0013 15.5013 14.6579 15.5013 13.0007C15.5013 11.5136 14.4195 10.2791 13 10.0414V9C13 8.17157 12.3284 7.5 11.5 7.5H8.49999V5.95983C9.91918 5.72176 11.0006 4.48749 11.0006 3.00066C11.0006 1.34344 9.65714 0 7.99992 0ZM5.99927 3.00066C5.99927 1.89572 6.89499 1 7.99992 1C9.10485 1 10.0006 1.89572 10.0006 3.00066C10.0006 4.10559 9.10485 5.00131 7.99992 5.00131C6.89499 5.00131 5.99927 4.10559 5.99927 3.00066ZM1.5 13.0007C1.5 11.8957 2.39572 11 3.50066 11C4.60559 11 5.50131 11.8957 5.50131 13.0007C5.50131 14.1056 4.60559 15.0013 3.50066 15.0013C2.39572 15.0013 1.5 14.1056 1.5 13.0007ZM12.5007 11C13.6056 11 14.5013 11.8957 14.5013 13.0007C14.5013 14.1056 13.6056 15.0013 12.5007 15.0013C11.3957 15.0013 10.5 14.1056 10.5 13.0007C10.5 11.8957 11.3957 11 12.5007 11Z" fill="#717171"/>
        </svg>
      `;case P.ExpandRight:return k`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case P.Profile:return k`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case P.File:return k`
        <svg width="28" height="28" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case P.Files:return k`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.9956 4.07309V4C14.9956 2.61929 13.8763 1.5 12.4956 1.5H7.66418L6.06391 0.299946C5.80428 0.105247 5.48851 0 5.16399 0H2.5C1.11916 0 -0.000181445 1.11949 2.20615e-08 2.50033L0.0011832 11.4978C0.00135142 12.7772 0.962583 13.8321 2.2023 13.9798C2.2867 13.9945 2.37375 14.0021 2.46289 14.0021H13.1798C13.8981 14.0021 14.5156 13.4929 14.6524 12.7877L16.0097 5.78769C16.1587 5.01967 15.696 4.29703 14.9956 4.07309ZM2.5 1H5.16399C5.27216 1 5.37742 1.03508 5.46396 1.09998L7.19756 2.40002C7.2841 2.46492 7.38936 2.5 7.49753 2.5H12.4956C13.324 2.5 13.9956 3.17157 13.9956 4V4.00214H3.824C3.10596 4.00214 2.48863 4.511 2.35158 5.21583L1.05351 11.8916C1.01941 11.7661 1.0012 11.634 1.00118 11.4976L1 2.5002C0.999891 1.67169 1.6715 1 2.5 1ZM3.33319 5.4067C3.37888 5.17176 3.58465 5.00214 3.824 5.00214H14.5372C14.8515 5.00214 15.0879 5.28874 15.028 5.59732L13.6706 12.5973C13.6251 12.8324 13.4192 13.0021 13.1798 13.0021H2.46289C2.14845 13.0021 1.91206 12.7154 1.97208 12.4067L3.33319 5.4067Z" fill="#717171"/>
        </svg>
      `;case P.Back:return k`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `;case P.Close:return k`
        <svg width="10" height="10" viewBox="0 0 10 10" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.73838 5.032L9.70337 1.067L8.99638 0.360001L5.03137 4.325L1.06637 0.360001L0.359375 1.067L4.32438 5.032L0.359375 8.997L1.06637 9.704L5.03137 5.739L8.99638 9.704L9.70337 8.997L5.73838 5.032Z" fill="currentColor"/>
        </svg>
     `;case P.Upload:return k`
        <svg class="upload-icon" width="21" height="12" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4.5 2C4.08579 2 3.75 2.33579 3.75 2.75C3.75 3.16421 4.08579 3.5 4.5 3.5H15C15.4142 3.5 15.75 3.16421 15.75 2.75C15.75 2.33579 15.4142 2 15 2H4.5ZM10.4963 17.3493C10.4466 17.7154 10.1328 17.9976 9.75311 17.9976C9.3389 17.9976 9.00311 17.6618 9.00311 17.2476L9.00249 7.05856L6.02995 10.026L5.94578 10.0986C5.65202 10.3162 5.23537 10.2917 4.96929 10.0253C4.67661 9.73215 4.67695 9.25728 4.97005 8.96459L9.25962 4.67989C9.33377 4.61512 9.42089 4.56485 9.5169 4.53385L9.59777 4.51072C9.64749 4.50019 9.69837 4.4947 9.74849 4.4947L9.80855 4.49661L9.87781 4.50451L9.99828 4.53462L10.0895 4.57254L10.1259 4.59371L10.2169 4.6523L10.2875 4.71481L14.5303 8.96546L14.6029 9.04964C14.8205 9.34345 14.7959 9.7601 14.5294 10.0261L14.4452 10.0987C14.1514 10.3162 13.7347 10.2917 13.4687 10.0251L10.5025 7.05456L10.5031 17.2476L10.4963 17.3493Z" fill="#ffffff"/>
        </svg>
      `;case P.FileCloud:return k`
        <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">
          <path
            d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"
          />
        </svg>
      `;case P.DragFile:return k`
        <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z"
          />
        </svg>
      `;case P.Cancel:return k`
        <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.588591 0.715694L0.646447 0.646447C0.820013 0.47288 1.08944 0.453595 1.28431 0.588591L1.35355 0.646447L6 5.293L10.6464 0.646447C10.8417 0.451185 11.1583 0.451185 11.3536 0.646447C11.5488 0.841709 11.5488 1.15829 11.3536 1.35355L6.707 6L11.3536 10.6464C11.5271 10.82 11.5464 11.0894 11.4114 11.2843L11.3536 11.3536C11.18 11.5271 10.9106 11.5464 10.7157 11.4114L10.6464 11.3536L6 6.707L1.35355 11.3536C1.15829 11.5488 0.841709 11.5488 0.646447 11.3536C0.451185 11.1583 0.451185 10.8417 0.646447 10.6464L5.293 6L0.646447 1.35355C0.47288 1.17999 0.453595 0.910563 0.588591 0.715694L0.646447 0.646447L0.588591 0.715694Z" fill="currentColor"/>
        </svg>
     `;case P.Success:return k`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>
          <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>
        </svg>
      `;case P.CheckMark:return k`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="filled" d="M10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0ZM13.2197 6.96967L8.75 11.4393L6.78033 9.46967C6.48744 9.17678 6.01256 9.17678 5.71967 9.46967C5.42678 9.76256 5.42678 10.2374 5.71967 10.5303L8.21967 13.0303C8.51256 13.3232 8.98744 13.3232 9.28033 13.0303L14.2803 8.03033C14.5732 7.73744 14.5732 7.26256 14.2803 6.96967C13.9874 6.67678 13.5126 6.67678 13.2197 6.96967Z" fill="currentColor"/>
        <path class="regular" d="M10 1.5C5.30558 1.5 1.5 5.30558 1.5 10C1.5 14.6944 5.30558 18.5 10 18.5C14.6944 18.5 18.5 14.6944 18.5 10C18.5 5.30558 14.6944 1.5 10 1.5ZM0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10Z" fill="currentColor"/>
      </svg>
      `;case P.Radio:return k`
      <svg width="66" height="20" viewBox="0 0 66 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="0.5" y="0.5" width="19" height="19" rx="9.5" fill="#F3F3F3"/>
        <rect x="0.5" y="0.5" width="19" height="19" rx="9.5" stroke="#636363"/>
        <path d="M36.5596 16H35.1924L33.5107 13.2178C33.1963 12.6982 32.9274 12.3656 32.7041 12.2197C32.4808 12.0693 32.2096 11.9941 31.8906 11.9941H30.7627V16H29.6143V6.19727H32.54C33.3923 6.19727 34.1009 6.42285 34.666 6.87402C35.2357 7.3252 35.5205 7.99056 35.5205 8.87012C35.5205 9.56283 35.3405 10.1439 34.9805 10.6133C34.6204 11.0827 34.126 11.4222 33.4971 11.6318V11.6592C33.7021 11.7822 33.8822 11.9167 34.0371 12.0625C34.1921 12.2083 34.3561 12.4225 34.5293 12.7051L36.5596 16ZM30.7627 7.23633V10.9551H32.3213C32.891 10.9551 33.3649 10.7705 33.7432 10.4014C34.126 10.0322 34.3174 9.55371 34.3174 8.96582C34.3174 8.44173 34.1465 8.02246 33.8047 7.70801C33.4674 7.39355 32.9775 7.23633 32.335 7.23633H30.7627ZM42.8008 16H41.6797V14.9062H41.6523C41.4108 15.3255 41.1123 15.64 40.7568 15.8496C40.4059 16.0592 39.9958 16.1641 39.5264 16.1641C38.8701 16.1641 38.3392 15.9727 37.9336 15.5898C37.528 15.207 37.3252 14.6989 37.3252 14.0654C37.3252 13.4684 37.5303 12.974 37.9404 12.582C38.3506 12.1901 38.9316 11.9395 39.6836 11.8301L41.6797 11.5635V11.4062C41.6797 10.8184 41.543 10.4014 41.2695 10.1553C40.9961 9.90462 40.6315 9.7793 40.1758 9.7793C39.8112 9.7793 39.4603 9.84766 39.123 9.98438C38.7858 10.1211 38.4691 10.3307 38.1729 10.6133L37.5166 9.93652C37.9085 9.55827 38.3255 9.28027 38.7676 9.10254C39.2096 8.9248 39.7018 8.83594 40.2441 8.83594C41.0918 8.83594 41.7298 9.05469 42.1582 9.49219C42.5866 9.92513 42.8008 10.5768 42.8008 11.4473V16ZM41.6797 13.1562V12.459L39.9912 12.6914C39.4762 12.7643 39.0889 12.8942 38.8291 13.0811C38.5693 13.2679 38.4395 13.5618 38.4395 13.9629C38.4395 14.3822 38.5602 14.7035 38.8018 14.9268C39.0479 15.1455 39.3464 15.2549 39.6973 15.2549C40.3034 15.2549 40.7842 15.0566 41.1396 14.6602C41.4997 14.2637 41.6797 13.7624 41.6797 13.1562ZM49.7939 14.8105C49.5342 15.2617 49.2038 15.6012 48.8027 15.8291C48.4062 16.0524 47.9346 16.1641 47.3877 16.1641C46.5081 16.1641 45.804 15.8519 45.2754 15.2275C44.7513 14.5986 44.4893 13.7441 44.4893 12.6641C44.4893 11.5065 44.7809 10.5791 45.3643 9.88184C45.9476 9.18457 46.7246 8.83594 47.6953 8.83594C48.1784 8.83594 48.5931 8.93164 48.9395 9.12305C49.2904 9.3099 49.5752 9.59245 49.7939 9.9707H49.8213V5.63672H50.9424V16H49.8213V14.8105H49.7939ZM45.6377 12.6094C45.6377 13.416 45.8245 14.054 46.1982 14.5234C46.5765 14.9883 47.0824 15.2207 47.7158 15.2207C48.3447 15.2207 48.8529 14.9951 49.2402 14.5439C49.6276 14.0928 49.8213 13.5231 49.8213 12.835V11.8027C49.8213 11.2376 49.6322 10.7591 49.2539 10.3672C48.8802 9.97526 48.4085 9.7793 47.8389 9.7793C47.1553 9.7793 46.6175 10.0299 46.2256 10.5312C45.8337 11.0326 45.6377 11.7253 45.6377 12.6094ZM53.7861 7.3252C53.5583 7.3252 53.3669 7.25 53.2119 7.09961C53.057 6.94466 52.9795 6.75553 52.9795 6.53223C52.9795 6.30892 53.057 6.12207 53.2119 5.97168C53.3669 5.81673 53.5583 5.73926 53.7861 5.73926C54.014 5.73926 54.2054 5.81673 54.3604 5.97168C54.5153 6.12207 54.5928 6.30892 54.5928 6.53223C54.5928 6.75553 54.5153 6.94466 54.3604 7.09961C54.2054 7.25 54.014 7.3252 53.7861 7.3252ZM54.333 16H53.2119V9H54.333V16ZM59.5283 16.1641C58.4938 16.1641 57.6667 15.8382 57.0469 15.1865C56.4316 14.5303 56.124 13.6621 56.124 12.582C56.124 11.4108 56.443 10.4948 57.0811 9.83398C57.7191 9.17318 58.5895 8.84049 59.6924 8.83594C60.736 8.83138 61.5495 9.15267 62.1328 9.7998C62.7207 10.4469 63.0146 11.3379 63.0146 12.4727C63.0146 13.5938 62.6979 14.4893 62.0645 15.1592C61.4355 15.8291 60.5902 16.1641 59.5283 16.1641ZM59.6104 15.2207C60.335 15.2207 60.891 14.986 61.2783 14.5166C61.6702 14.0426 61.8662 13.375 61.8662 12.5137C61.8662 11.6341 61.6702 10.9596 61.2783 10.4902C60.8864 10.0163 60.3304 9.7793 59.6104 9.7793C58.8903 9.7793 58.3206 10.0254 57.9014 10.5176C57.4821 11.0098 57.2725 11.6842 57.2725 12.541C57.2725 13.3704 57.4844 14.0244 57.9082 14.5029C58.332 14.9814 58.8994 15.2207 59.6104 15.2207Z" fill="#1A1A1A"/>
      </svg>
      `;case P.Fail:return k`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>
          <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />
        </svg>
      `;case P.SelectAccount:return k`
    <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
      <path fill=${e} d="M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM10.5 15C12.9853 15 15 12.9853 15 10.5C15 8.01472 12.9853 6 10.5 6C8.01472 6 6 8.01472 6 10.5C6 12.9853 8.01472 15 10.5 15ZM10.5 8C10.7761 8 11 8.22386 11 8.5V10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H11V12.5C11 12.7761 10.7761 13 10.5 13C10.2239 13 10 12.7761 10 12.5V11H8.5C8.22386 11 8 10.7761 8 10.5C8 10.2239 8.22386 10 8.5 10H10V8.5C10 8.22386 10.2239 8 10.5 8Z"/>
    </svg>
  `;case P.News:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.75 20H5.25C3.51697 20 2.10075 18.6435 2.00514 16.9344L2 16.75V6.25C2 5.05914 2.92516 4.08436 4.09595 4.00519L4.25 4H16.75C17.9409 4 18.9156 4.92516 18.9948 6.09595L19 6.25V7H19.75C20.9409 7 21.9156 7.92516 21.9948 9.09595L22 9.25V16.75C22 18.483 20.6435 19.8992 18.9344 19.9949L18.75 20H5.25H18.75ZM5.25 18.5H18.75C19.6682 18.5 20.4212 17.7929 20.4942 16.8935L20.5 16.75V9.25C20.5 8.8703 20.2178 8.55651 19.8518 8.50685L19.75 8.5H19V16.25C19 16.6297 18.7178 16.9435 18.3518 16.9932L18.25 17C17.8703 17 17.5565 16.7178 17.5068 16.3518L17.5 16.25V6.25C17.5 5.8703 17.2178 5.55651 16.8518 5.50685L16.75 5.5H4.25C3.8703 5.5 3.55651 5.78215 3.50685 6.14823L3.5 6.25V16.75C3.5 17.6682 4.20711 18.4212 5.10647 18.4942L5.25 18.5H18.75H5.25ZM12.246 14.5H15.2522C15.6665 14.5 16.0022 14.8358 16.0022 15.25C16.0022 15.6297 15.7201 15.9435 15.354 15.9932L15.2522 16H12.246C11.8318 16 11.496 15.6642 11.496 15.25C11.496 14.8703 11.7782 14.5565 12.1442 14.5068L12.246 14.5H15.2522H12.246ZM9.24328 11.0045C9.6575 11.0045 9.99328 11.3403 9.99328 11.7545V15.25C9.99328 15.6642 9.6575 16 9.24328 16H5.74776C5.33355 16 4.99776 15.6642 4.99776 15.25V11.7545C4.99776 11.3403 5.33355 11.0045 5.74776 11.0045H9.24328ZM8.49328 12.5045H6.49776V14.5H8.49328V12.5045ZM12.246 11.0045H15.2522C15.6665 11.0045 16.0022 11.3403 16.0022 11.7545C16.0022 12.1342 15.7201 12.448 15.354 12.4976L15.2522 12.5045H12.246C11.8318 12.5045 11.496 12.1687 11.496 11.7545C11.496 11.3748 11.7782 11.061 12.1442 11.0113L12.246 11.0045H15.2522H12.246ZM5.74776 7.50247H15.2522C15.6665 7.50247 16.0022 7.83826 16.0022 8.25247C16.0022 8.63217 15.7201 8.94596 15.354 8.99563L15.2522 9.00247H5.74776C5.33355 9.00247 4.99776 8.66669 4.99776 8.25247C4.99776 7.87278 5.27991 7.55898 5.64599 7.50932L5.74776 7.50247H15.2522H5.74776Z" fill="none" />
      </svg>
      `;case P.DoubleBookmark:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 6.74814C4 5.50535 5.00742 4.49786 6.25013 4.49786H15.2506C16.4933 4.49786 17.5008 5.50535 17.5008 6.74814V21.2499C17.5008 21.5185 17.3572 21.7666 17.1243 21.9003C16.8914 22.0341 16.6048 22.0332 16.3728 21.8978L10.7504 18.6179L5.12797 21.8978C4.89599 22.0332 4.60936 22.0341 4.37648 21.9003C4.14359 21.7666 4 21.5185 4 21.2499V6.74814ZM6.25013 5.99805C5.83589 5.99805 5.50008 6.33387 5.50008 6.74814V19.944L10.3725 17.1016C10.606 16.9653 10.8948 16.9653 11.1283 17.1016L16.0007 19.944V6.74814C16.0007 6.33387 15.6649 5.99805 15.2506 5.99805H6.25013ZM15.2497 2C17.8732 2 20 4.12691 20 6.75058V18.6232C20 19.0374 19.6642 19.3733 19.25 19.3733C18.8357 19.3733 18.4999 19.0374 18.4999 18.6232V6.75058C18.4999 4.95543 17.0448 3.50018 15.2497 3.50018H6.63687C6.63687 3.50018 6.75016 2.94339 7.43379 2.41948C8.00023 2 8.60182 2 8.60182 2H15.2497Z" fill="none" />
        </svg>
      `;case P.ChevronLeft:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.5303 4.21967C15.8232 4.51256 15.8232 4.98744 15.5303 5.28033L8.81066 12L15.5303 18.7197C15.8232 19.0126 15.8232 19.4874 15.5303 19.7803C15.2374 20.0732 14.7626 20.0732 14.4697 19.7803L7.21967 12.5303C6.92678 12.2374 6.92678 11.7626 7.21967 11.4697L14.4697 4.21967C14.7626 3.92678 15.2374 3.92678 15.5303 4.21967Z" fill="none" />
        </svg>`;case P.ChevronRight:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z" fill="currentColor" />
        </svg>`;case P.Delete:return k`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.5 4H11.5C11.5 3.17157 10.8284 2.5 10 2.5C9.17157 2.5 8.5 3.17157 8.5 4ZM7.5 4C7.5 2.61929 8.61929 1.5 10 1.5C11.3807 1.5 12.5 2.61929 12.5 4H17.5C17.7761 4 18 4.22386 18 4.5C18 4.77614 17.7761 5 17.5 5H16.4456L15.2521 15.3439C15.0774 16.8576 13.7957 18 12.2719 18H7.72813C6.20431 18 4.92256 16.8576 4.7479 15.3439L3.55437 5H2.5C2.22386 5 2 4.77614 2 4.5C2 4.22386 2.22386 4 2.5 4H7.5ZM5.74131 15.2292C5.85775 16.2384 6.71225 17 7.72813 17H12.2719C13.2878 17 14.1422 16.2384 14.2587 15.2292L15.439 5H4.56101L5.74131 15.2292ZM8.5 7.5C8.77614 7.5 9 7.72386 9 8V14C9 14.2761 8.77614 14.5 8.5 14.5C8.22386 14.5 8 14.2761 8 14V8C8 7.72386 8.22386 7.5 8.5 7.5ZM12 8C12 7.72386 11.7761 7.5 11.5 7.5C11.2239 7.5 11 7.72386 11 8V14C11 14.2761 11.2239 14.5 11.5 14.5C11.7761 14.5 12 14.2761 12 14V8Z" fill="currentColor"/>
        </svg>
    `;case P.Add:return k`
        <svg width="16" height="15" viewBox="0 0 16 15" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.39563 0.5C8.39563 0.223858 8.17177 0 7.89563 0C7.61949 0 7.39563 0.223858 7.39563 0.5V7H0.89563C0.619487 7 0.39563 7.22386 0.39563 7.5C0.39563 7.77614 0.619487 8 0.89563 8H7.39563V14.5C7.39563 14.7761 7.61949 15 7.89563 15C8.17177 15 8.39563 14.7761 8.39563 14.5V8H14.8956C15.1718 8 15.3956 7.77614 15.3956 7.5C15.3956 7.22386 15.1718 7 14.8956 7H8.39563V0.5Z" fill="${e}"/>
        </svg>`;case P.Calendar:return k`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 11C7.55228 11 8 10.5523 8 10C8 9.44771 7.55228 9 7 9C6.44772 9 6 9.44771 6 10C6 10.5523 6.44772 11 7 11ZM8 13C8 13.5523 7.55228 14 7 14C6.44772 14 6 13.5523 6 13C6 12.4477 6.44772 12 7 12C7.55228 12 8 12.4477 8 13ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44771 10.5523 9 10 9C9.44771 9 9 9.44771 9 10C9 10.5523 9.44771 11 10 11ZM11 13C11 13.5523 10.5523 14 10 14C9.44771 14 9 13.5523 9 13C9 12.4477 9.44771 12 10 12C10.5523 12 11 12.4477 11 13ZM13 11C13.5523 11 14 10.5523 14 10C14 9.44771 13.5523 9 13 9C12.4477 9 12 9.44771 12 10C12 10.5523 12.4477 11 13 11ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM4 7H16V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V7ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V6H4V5.5C4 4.67157 4.67157 4 5.5 4Z" fill=${e}/>
        </svg>
    `;case P.Planner:return k`
        <svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm1.75 5.5h-15v9.25c0 .966.784 1.75 1.75 1.75h11.5a1.75 1.75 0 0 0 1.75-1.75V8.5Zm-11.75 6a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm-4.25-4a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm1.5-6H6.25A1.75 1.75 0 0 0 4.5 6.25V7h15v-.75a1.75 1.75 0 0 0-1.75-1.75Z" fill="${e}"/>
        </svg>`;case P.Milestone:return k`
        <svg width="24" height="24" fill="${e}" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.25 13c.966 0 1.75.784 1.75 1.75v4.5A1.75 1.75 0 0 1 15.25 21H3.75A1.75 1.75 0 0 1 2 19.25v-4.5c0-.966.783-1.75 1.75-1.75h11.5ZM21 14.899v5.351a.75.75 0 0 1-1.494.102l-.006-.102v-5.338a3.006 3.006 0 0 0 1.5-.013Zm-5.75-.399H3.75a.25.25 0 0 0-.25.25v4.5c0 .138.111.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25Zm5-4.408a1.908 1.908 0 1 1 0 3.816 1.908 1.908 0 0 1 0-3.816ZM15.244 3c.967 0 1.75.784 1.75 1.75v4.5a1.75 1.75 0 0 1-1.75 1.75h-11.5a1.75 1.75 0 0 1-1.75-1.75v-4.5a1.75 1.75 0 0 1 1.607-1.744L3.745 3h11.5Zm0 1.5h-11.5l-.057.007a.25.25 0 0 0-.193.243v4.5c0 .138.112.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25ZM20.25 3a.75.75 0 0 1 .743.648L21 3.75v5.351a3.004 3.004 0 0 0-1.5-.013V3.75a.75.75 0 0 1 .75-.75Z" fill="${e}"/>
        </svg>`;case P.PersonAdd:return k`
        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">
          <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>
          <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>
          <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>
        </svg>`;case P.Event:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.75 3C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25C3 4.45507 4.45507 3 6.25 3H17.75ZM19.5 8.5H4.5V17.75C4.5 18.7165 5.2835 19.5 6.25 19.5H17.75C18.7165 19.5 19.5 18.7165 19.5 17.75V8.5ZM7.75 14.5C8.44036 14.5 9 15.0596 9 15.75C9 16.4404 8.44036 17 7.75 17C7.05964 17 6.5 16.4404 6.5 15.75C6.5 15.0596 7.05964 14.5 7.75 14.5ZM12 14.5C12.6904 14.5 13.25 15.0596 13.25 15.75C13.25 16.4404 12.6904 17 12 17C11.3096 17 10.75 16.4404 10.75 15.75C10.75 15.0596 11.3096 14.5 12 14.5ZM7.75 10.5C8.44036 10.5 9 11.0596 9 11.75C9 12.4404 8.44036 13 7.75 13C7.05964 13 6.5 12.4404 6.5 11.75C6.5 11.0596 7.05964 10.5 7.75 10.5ZM12 10.5C12.6904 10.5 13.25 11.0596 13.25 11.75C13.25 12.4404 12.6904 13 12 13C11.3096 13 10.75 12.4404 10.75 11.75C10.75 11.0596 11.3096 10.5 12 10.5ZM16.25 10.5C16.9404 10.5 17.5 11.0596 17.5 11.75C17.5 12.4404 16.9404 13 16.25 13C15.5596 13 15 12.4404 15 11.75C15 11.0596 15.5596 10.5 16.25 10.5ZM17.75 4.5H6.25C5.2835 4.5 4.5 5.2835 4.5 6.25V7H19.5V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5Z" fill="none" />
        </svg>
      `;case P.BookOpen:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 19.1375C11.4986 19.6686 10.788 20 10 20H3.75C2.7835 20 2 19.2165 2 18.25V5.75C2 4.7835 2.7835 4 3.75 4H10C10.788 4 11.4986 4.33145 12 4.86253C12.5014 4.33145 13.212 4 14 4H20.25C21.2165 4 22 4.7835 22 5.75V18.25C22 19.2165 21.2165 20 20.25 20H14C13.212 20 12.5014 19.6686 12 19.1375ZM3.5 5.75V18.25C3.5 18.3881 3.61193 18.5 3.75 18.5H10C10.6904 18.5 11.25 17.9404 11.25 17.25V6.75C11.25 6.05964 10.6904 5.5 10 5.5H3.75C3.61193 5.5 3.5 5.61193 3.5 5.75ZM12.75 17.25C12.75 17.9404 13.3096 18.5 14 18.5H20.25C20.3881 18.5 20.5 18.3881 20.5 18.25V5.75C20.5 5.61193 20.3881 5.5 20.25 5.5H14C13.3096 5.5 12.75 6.05964 12.75 6.75V17.25Z" fill="none" />
        </svg>
      `;case P.FileOuter:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 2C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V9.82777C20 9.29733 19.7893 8.78863 19.4142 8.41355L13.5864 2.58579C13.2114 2.21071 12.7027 2 12.1722 2H6ZM5.5 4C5.5 3.72386 5.72386 3.5 6 3.5H12V8C12 9.10457 12.8954 10 14 10H18.5V20C18.5 20.2761 18.2761 20.5 18 20.5H6C5.72386 20.5 5.5 20.2761 5.5 20V4ZM17.3793 8.5H14C13.7239 8.5 13.5 8.27614 13.5 8V4.62066L17.3793 8.5Z" fill="none" />
        </svg>
      `;case P.BookQuestion:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.9998 8.01752C10.9905 8.42363 10.6584 8.74999 10.25 8.74999C9.5 8.74999 9.5 7.9989 9.5 7.9989L9.5 7.99777L9.50001 7.99539L9.50006 7.99017C9.50032 7.9755 9.50072 7.96084 9.50144 7.94618C9.50262 7.92198 9.50473 7.89159 9.50846 7.8559C9.51591 7.78477 9.52996 7.69092 9.55665 7.58186C9.60973 7.36492 9.71565 7.07652 9.92848 6.78906C10.3825 6.17582 11.1982 5.72727 12.513 5.7501C13.4627 5.76659 14.3059 6.16497 14.834 6.82047C15.371 7.48704 15.5517 8.3902 15.1964 9.27853C14.8342 10.1839 14.0149 10.5437 13.5442 10.7503L13.4932 10.7728C13.2147 10.8957 13.0813 10.9599 13.0013 11.024L13 11.0251L13 11.7492C13.0001 12.1634 12.6643 12.4999 12.2501 12.5C11.8359 12.5 11.5001 12.1643 11.5 11.7501L11.5 11C11.5 10.4769 11.752 10.1029 12.0633 9.85345C12.3134 9.65303 12.6276 9.51483 12.8491 9.4174L12.8875 9.40049C13.4292 9.16137 13.6868 9.01346 13.8036 8.72145C13.9483 8.35977 13.8789 8.02596 13.6659 7.76153C13.4439 7.48604 13.0371 7.25943 12.487 7.24988C11.5518 7.23364 11.2425 7.53509 11.134 7.68162C11.0656 7.77404 11.0309 7.86797 11.0137 7.93838C11.0052 7.973 11.0017 7.99908 11.0003 8.01197L10.9998 8.01752ZM12.25 15.5C12.8023 15.5 13.25 15.0523 13.25 14.5C13.25 13.9477 12.8023 13.5 12.25 13.5C11.6977 13.5 11.25 13.9477 11.25 14.5C11.25 15.0523 11.6977 15.5 12.25 15.5ZM4 4.5C4 3.11929 5.11929 2 6.5 2H18C19.3807 2 20.5 3.11929 20.5 4.5V18.75C20.5 19.1642 20.1642 19.5 19.75 19.5H5.5C5.5 20.0523 5.94772 20.5 6.5 20.5H19.75C20.1642 20.5 20.5 20.8358 20.5 21.25C20.5 21.6642 20.1642 22 19.75 22H6.5C5.11929 22 4 20.8807 4 19.5V4.5ZM5.5 4.5V18H19V4.5C19 3.94772 18.5523 3.5 18 3.5H6.5C5.94772 3.5 5.5 3.94772 5.5 4.5Z" fill="none" />
        </svg>
      `;case P.Globe:return k`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M12.0001 1.99805C17.5238 1.99805 22.0016 6.47589 22.0016 11.9996C22.0016 17.5233 17.5238 22.0011 12.0001 22.0011C6.47638 22.0011 1.99854 17.5233 1.99854 11.9996C1.99854 6.47589 6.47638 1.99805 12.0001 1.99805ZM14.939 16.4993H9.06118C9.71322 18.9135 10.8466 20.5011 12.0001 20.5011C13.1536 20.5011 14.2869 18.9135 14.939 16.4993ZM7.5084 16.4999L4.78591 16.4998C5.74425 18.0328 7.1777 19.2384 8.88008 19.9104C8.3578 19.0906 7.92681 18.0643 7.60981 16.8949L7.5084 16.4999ZM19.2143 16.4998L16.4918 16.4999C16.168 17.8337 15.7004 18.9995 15.119 19.9104C16.716 19.2804 18.0757 18.1814 19.0291 16.7833L19.2143 16.4998ZM7.09351 9.99895H3.7359L3.73115 10.0162C3.57906 10.6525 3.49854 11.3166 3.49854 11.9996C3.49854 13.0558 3.69112 14.0669 4.0431 14.9999L7.21626 14.9995C7.07396 14.0504 6.99854 13.0422 6.99854 11.9996C6.99854 11.3156 7.031 10.6464 7.09351 9.99895ZM15.397 9.99901H8.60316C8.53514 10.6393 8.49853 11.309 8.49853 11.9996C8.49853 13.0591 8.58468 14.0694 8.73827 14.9997H15.2619C15.4155 14.0694 15.5016 13.0591 15.5016 11.9996C15.5016 11.309 15.465 10.6393 15.397 9.99901ZM20.2647 9.99811L16.9067 9.99897C16.9692 10.6464 17.0016 11.3156 17.0016 11.9996C17.0016 13.0422 16.9262 14.0504 16.7839 14.9995L19.9571 14.9999C20.309 14.0669 20.5016 13.0558 20.5016 11.9996C20.5016 11.3102 20.4196 10.64 20.2647 9.99811ZM8.88114 4.08875L8.85823 4.09747C6.81092 4.91218 5.1549 6.49949 4.25023 8.49935L7.29835 8.49972C7.61171 6.74693 8.15855 5.221 8.88114 4.08875ZM12.0001 3.49805L11.8844 3.50335C10.619 3.6191 9.39651 5.62107 8.8288 8.4993H15.1714C14.6052 5.62914 13.388 3.63033 12.1264 3.50436L12.0001 3.49805ZM15.1201 4.08881L15.2269 4.2629C15.8961 5.37537 16.4043 6.83525 16.7018 8.49972L19.7499 8.49935C18.8853 6.58795 17.3343 5.05341 15.4113 4.21008L15.1201 4.08881Z" />
        </svg>
      `;case P.PresenceAvailable:return k`
        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm2.1-5.9L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 0 1 .7-.7l.65.64 1.9-1.9a.5.5 0 0 1 .7.71Z" fill="#13a10e"></path>
        </svg>`;case P.PresenceOofAvailable:return k`
        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm6.1-1.6c.2.2.2.5 0 .7L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 1 1 .7-.7l.65.64 1.9-1.9c.2-.19.5-.19.7 0Z" fill="#13a10e"></path>
        </svg>`;case P.PresenceBusy:return k`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M10 5A5 5 0 1 1 0 5a5 5 0 0 1 10 0Z" fill="#d13438"></path>
        </svg>`;case P.PresenceOofBusy:return k`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>
        </svg>
      `;case P.PresenceDnd:return k`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10ZM3.5 4.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z" fill="#d13438"></path>
        </svg>`;case P.PresenceOofDnd:return k`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm2 0c0-.28.22-.5.5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 3 5Z" fill="#d13438"></path>
        </svg>`;case P.PresenceAway:return k`
        <svg fill="#eaa300" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm0-7v1.8l1.35 1.35a.5.5 0 1 1-.7.7l-1.5-1.5A.5.5 0 0 1 4 5V3a.5.5 0 0 1 1 0Z" fill="#eaa300"></path>
        </svg>`;case P.PresenceOofAway:return k`
        <svg fill="#c239b3" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.35 3.85a.5.5 0 1 0-.7-.7l-1.5 1.5a.5.5 0 0 0 0 .7l1.5 1.5a.5.5 0 1 0 .7-.7L4.7 5.5h1.8a.5.5 0 1 0 0-1H4.7l.65-.65ZM5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Z" fill="#c239b3"></path>
        </svg>`;case P.PresenceOffline:return k`
        <svg fill="#929292" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.85 3.15c.2.2.2.5 0 .7L5.71 5l1.14 1.15a.5.5 0 1 1-.7.7L5 5.71 3.85 6.85a.5.5 0 1 1-.7-.7L4.29 5 3.15 3.85a.5.5 0 1 1 .7-.7L5 4.29l1.15-1.14c.2-.2.5-.2.7 0ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Zm5-4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z" fill="#929292"></path>
        </svg>`;case P.PresenceStatusUnknown:return k`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>
        </svg>`}}});var Q0,kS,SS=y(()=>{l();c();d();Q0=()=>window.getWindowSegments!==void 0,kS=()=>Q0()?window:null});var _S,TS=y(()=>{l();c();d();Te();_S=[Me`
.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--mgt-flyout-box-shadow,var(--elevation-shadow-card-rest));border-radius:8px}.root .flyout.small{overflow:hidden auto}.root.visible .flyout{display:inline-block;animation-name:fade-in;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}.root.visible .flyout.small{overflow:hidden auto}@keyframes fade-in{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`]});var Y0,If,ua,Mc,Fc=y(()=>{l();c();d();Te();At();fi();SS();TS();ue();ue();Y0=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},If=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},ua=()=>Pe("flyout",Mc),Mc=class extends fr{static get styles(){return _S}get isOpen(){return this._isOpen}set isOpen(e){let t=this._isOpen;t!==e&&(this._isOpen=e,window.requestAnimationFrame(()=>{this.setupWindowEvents(this.isOpen);let o=this._flyout;!this.isOpen&&o&&(o.style.width=null,o.style.setProperty("--mgt-flyout-set-width",null),o.style.setProperty("--mgt-flyout-set-height",null),o.style.maxHeight=null,o.style.top=null,o.style.left=null,o.style.bottom=null)}),this.requestUpdate("isOpen",t),this.dispatchEvent(new Event(e?"opened":"closed")))}get _edgePadding(){return 24}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}constructor(){super(),this._renderedOnce=!1,this._isOpen=!1,this._smallView=!1,this.handleWindowEvent=e=>{let t=this._flyout;if(t)if(e.composedPath){let o=e.composedPath();if(o.includes(t)||e.type==="pointerdown"&&o.includes(this))return}else{let o=e.target;for(;o;)if(o=o.parentElement,o===t||e.type==="pointerdown"&&o===this)return}this.close()},this.handleResize=()=>{this.close()},this.handleKeyUp=e=>{e.key==="Escape"&&this.close()},this.handleFlyoutWheel=e=>{e.preventDefault()},this.avoidHidingAnchor=!0,this.addEventListener("expanded",()=>{window.requestAnimationFrame(()=>{this.updateFlyout()})})}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(e){super.updated(e),window.requestAnimationFrame(()=>{this.updateFlyout()})}render(){let e={root:!0,visible:this.isOpen},t=this.renderAnchor(),o=null;if(this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0),this.isOpen||this._renderedOnce){this._renderedOnce=!0;let i=Ve({flyout:!0,small:this._smallView});o=k`
        <div class=${i} @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `}return k`
      <div class=${Ve(e)}>
        <div class="anchor">
          ${t}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${o}
      </div>
    `}renderAnchor(){return k`
      <slot name="anchor"></slot>
    `}renderFlyout(){return k`
      <slot name="flyout"></slot>
    `}updateFlyout(e=!0){if(!this.isOpen)return;let t=this._anchor,o=this._flyout;if(o&&t){let i=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth;this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let n=0,s,a=0,u,h,p=o.getBoundingClientRect(),f=t.getBoundingClientRect(),b=this._topScout.getBoundingClientRect(),x=this._bottomScout.getBoundingClientRect(),S={height:this._windowHeight,left:0,top:0,width:i};if(Q0()){let re=kS().getWindowSegments(),ge,wt=f.left+f.width/2,je=f.top+f.height/2;for(let it of re)if(wt>=it.left&&je>=it.top){ge=it;break}ge&&(S.left=ge.left,S.top=ge.top,S.width=ge.width,S.height=ge.height)}p.width+2*this._edgePadding>S.width?p.width>S.width?(h=S.width,n=0):n=(S.width-p.width)/2:f.left+p.width+this._edgePadding>S.width?n=f.left-(f.left+p.width+this._edgePadding-S.width):f.left<this._edgePadding?n=this._edgePadding:n=f.left;let R=S.height-(f.top+f.height),z=f.top;this.avoidHidingAnchor?R<=p.height?z<p.height?z>R?(s=S.height-f.top,u=z):(a=f.bottom,u=R):(s=S.height-f.top,u=z):(a=f.bottom,u=R):p.height+2*this._edgePadding>S.height?p.height>=S.height?(u=S.height,a=0):a=(S.height-p.height)/2:f.top+f.height+p.height+this._edgePadding>S.height?a=S.height-p.height-this._edgePadding:a=Math.max(f.top+f.height,this._edgePadding),(b.top!==0||b.left!==0)&&(n-=b.left,typeof s<"u"?s+=x.top-this._windowHeight:a-=b.top),this.direction==="rtl"?n>100&&this.offsetLeft>100&&(o.style.left=`${S.width-n+p.left-p.width-30}px`):o.style.left=`${n+S.left}px`,typeof s<"u"?(o.style.top="unset",o.style.bottom=`${s}px`):(o.style.bottom="unset",o.style.top=`${a+S.top}px`),h&&(o.style.width=`${h}px`,o.style.setProperty("--mgt-flyout-set-width",`${h}px`),window.requestAnimationFrame(()=>this.updateFlyout())),u&&!e?(o.style.maxHeight=`${u}px`,o.style.setProperty("--mgt-flyout-set-height",`${u}px`)):(o.style.maxHeight=null,o.style.setProperty("--mgt-flyout-set-height","unset")),e&&window.requestAnimationFrame(()=>this.updateFlyout(!1))}}setupWindowEvents(e){e&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}};Y0([E({attribute:"light-dismiss",type:Boolean}),If("design:type",Boolean)],Mc.prototype,"isLightDismiss",void 0);Y0([E({attribute:null,type:Boolean}),If("design:type",Boolean)],Mc.prototype,"avoidHidingAnchor",void 0);Y0([E({attribute:"isOpen",type:Boolean}),If("design:type",Boolean),If("design:paramtypes",[Boolean])],Mc.prototype,"isOpen",null)});var Kt,Il=y(()=>{l();c();d();(function(r){r[r.none=0]="none",r[r.hover=1]="hover",r[r.click=2]="click"})(Kt||(Kt={}))});var ES,IS=y(()=>{l();c();d();Te();ES=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size)}:host .flyout [slot=anchor]{display:flex;cursor:pointer}:host .flyout [slot=anchor].vertical{flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root{display:flex;flex-direction:row;align-items:center;background-color:var(--person-background-color,transparent);border-radius:var(--person-border-radius,4px)}:host .person-root.small .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.small .contact-icon,:host .person-root.small .initials{font-size:calc(var(--person-avatar-size,24px) * .4)}:host .person-root.small .presence-wrapper svg{width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root.noline .avatar-wrapper,:host .person-root.oneline .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.noline .avatar-wrapper .contact-icon,:host .person-root.noline .avatar-wrapper .initials,:host .person-root.oneline .avatar-wrapper .contact-icon,:host .person-root.oneline .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,24px) * .4)}:host .person-root.noline .avatar-wrapper .presence-wrapper svg,:host .person-root.oneline .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root.noline .presence-basic,:host .person-root.oneline .presence-basic{border-width:1px;position:relative;bottom:calc(var(--person-avatar-size,24px) * .12 - 4px)}:host .person-root.twolines .avatar-wrapper{min-width:var(--person-avatar-size,40px);width:var(--person-avatar-size,40px);height:var(--person-avatar-size,40px)}:host .person-root.twolines .avatar-wrapper .contact-icon,:host .person-root.twolines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,40px) * .4)}:host .person-root.twolines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,40px) * .28);height:calc(var(--person-avatar-size,40px) * .28)}:host .person-root.large .avatar-wrapper,:host .person-root.threelines .avatar-wrapper{min-width:var(--person-avatar-size,56px);width:var(--person-avatar-size,56px);height:var(--person-avatar-size,56px)}:host .person-root.large .avatar-wrapper .contact-icon,:host .person-root.large .avatar-wrapper .initials,:host .person-root.threelines .avatar-wrapper .contact-icon,:host .person-root.threelines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,56px) * .4)}:host .person-root.large .avatar-wrapper .presence-wrapper svg,:host .person-root.threelines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,56px) * .28);height:calc(var(--person-avatar-size,56px) * .28)}:host .person-root.fourlines .avatar-wrapper,:host .person-root.vertical .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.fourlines .avatar-wrapper .contact-icon,:host .person-root.fourlines .avatar-wrapper .initials,:host .person-root.vertical .avatar-wrapper .contact-icon,:host .person-root.vertical .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.fourlines .avatar-wrapper .presence-wrapper svg,:host .person-root.vertical .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root.vertical{flex-direction:column;justify-content:center;align-items:center}:host .person-root .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px);position:relative;box-sizing:border-box}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials,:host .person-root .avatar-wrapper img{height:100%;width:100%;border:var(--person-avatar-border,none);border-radius:var(--person-avatar-border-radius,50%);margin-block-start:var(--person-avatar-top-spacing,0)}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials{display:flex;justify-content:center;align-items:center;font-size:calc(var(--person-avatar-size,24px) * .4);font-weight:400;background:var(--person-initials-background-color,var(--neutral-fill-secondary-rest));color:var(--person-initials-text-color,var(--neutral-fill-strong-hover))}:host .person-root .avatar-wrapper .presence-wrapper{bottom:var(--person-presence-wrapper-bottom,0);right:0;position:absolute;border-radius:50%;background-color:var(--neutral-layer-1);border:1px solid var(--neutral-layer-1)}:host .person-root .avatar-wrapper .presence-wrapper svg{display:flex;width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root .details-wrapper{display:flex;flex-direction:column;align-items:flex-start;min-width:var(--person-details-wrapper-width,168px);margin-inline-start:var(--person-details-left-spacing,12px);margin-block-end:var(--person-details-bottom-spacing,0)}:host .person-root .details-wrapper.vertical{display:inline-flex;flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root .details-wrapper .line1{font-size:var(--person-line1-font-size,ms-font-size-14);font-weight:var(--person-line1-font-weight,600);color:var(--person-line1-text-color,var(--neutral-foreground-rest));text-transform:var(--person-line1-text-transform,inherit);line-height:var(--person-line1-text-line-height,20px)}:host .person-root .details-wrapper .line2{font-size:var(--person-line2-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line2-font-weight,400);color:var(--person-line2-text-color,var(--secondary-text-color));text-transform:var(--person-line2-text-transform,inherit);line-height:var(--person-line2-text-line-height,16px)}:host .person-root .details-wrapper .line3{font-size:var(--person-line3-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line3-font-weight,400);color:var(--person-line3-text-color,var(--secondary-text-color));text-transform:var(--person-line3-text-transform,inherit);line-height:var(--person-line3-text-line-height,16px)}:host .person-root .details-wrapper .line4{font-size:var(--person-line4-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line4-font-weight,400);color:var(--person-line4-text-color,var(--secondary-text-color));text-transform:var(--person-line4-text-transform,inherit);line-height:var(--person-line4-text-line-height,16px)}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff;fill-rule:nonzero;clip-rule:nonzero}}[dir=rtl] .presence-wrapper{right:unset!important;left:0}
`]});var Dc,Ri,Tu=y(()=>{l();c();d();(function(r){r[r.avatar=2]="avatar",r[r.oneline=3]="oneline",r[r.twolines=4]="twolines",r[r.threelines=5]="threelines",r[r.fourlines=6]="fourlines"})(Dc||(Dc={}));(function(r){r.photo="photo",r.initials="initials"})(Ri||(Ri={}))});var T7,AS,RS=y(()=>{l();c();d();T7={Available:"Available",Away:"Away",BeRightBack:"Be right back",Busy:"Busy",DoNotDisturb:"Do not disturb",InACall:"In a call",InAConferenceCall:"In a conference call",Inactive:"Inactive",InAMeeting:"In a meeting",Offline:"Offline",OffWork:"Off work",OutOfOffice:"Out of office",PresenceUnknown:"Presence unknown",Presenting:"Presenting",UrgentInterruptionsOnly:"Urgent interruptions only"},AS=Object.assign(Object.assign({},T7),{photoFor:"Photo for",emailAddress:"Email address",initials:"Initials"})});var Eu,PS,Z0=y(()=>{l();c();d();Eu=r=>"personType"in r||"userType"in r,PS=r=>"initials"in r});var Qo,$S=y(()=>{l();c();d();Js();Qo=r=>r??rt});var Lc=y(()=>{l();c();d();$S()});var Bt,Iu=y(()=>{l();c();d();Bt=class{};Bt.sections={files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0};Bt.useContactApis=!0;Bt.isSendMessageVisible=!0});var qe,OS,Af,MS,Al,E7,Au,Rf,ha,Pf,xo,FS,DS,LS,NS,HS,US,BS,zS,VS,qS,GS,jS,KS,Pi,WS,QS,YS,ZS,JS,XS,e_,t_,r_,o_,i_,n_,s_,a_,l_,c_,I7,A7,R7,J0,X0,d_,u_,h_,p_,f_,m_,Nc=y(()=>{l();c();d();ue();hn();tl();Ai();qe=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},OS=r=>Array.isArray(r.nextExpectedRanges),Af=()=>qe(void 0,void 0,void 0,function*(){yield Q.getCache(N.fileLists,N.fileLists.stores.fileLists).clearStore()}),MS=()=>Q.config.files.invalidationPeriod||Q.config.defaultInvalidationPeriod,Al=()=>Q.config.files.isEnabled&&Q.config.isEnabled,E7=()=>Q.config.fileLists.invalidationPeriod||Q.config.defaultInvalidationPeriod,Au=()=>Q.config.fileLists.isEnabled&&Q.config.isEnabled,Rf=["Files.Read","Files.ReadWrite","Files.Read.All","Files.ReadWrite.All","Group.Read.All","Group.ReadWrite.All","Sites.Read.All","Sites.ReadWrite.All"],ha=["Sites.Read.All","Sites.ReadWrite.All"],Pf=["Files.ReadWrite","Files.ReadWrite.All","Sites.ReadWrite.All"],xo=(r,e,t=N.files.stores.fileQueries,o=Rf)=>qe(void 0,void 0,void 0,function*(){let i=Q.getCache(N.files,t),n=yield R7(i,e);if(n)return n;let s;try{s=yield r.api(e).middlewareOptions(ye(o)).get(),Al()&&(yield i.putValue(e,{file:JSON.stringify(s)}))}catch{}return s||null}),FS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/drives/${e}/items/${t}`;return xo(r,o,N.files.stores.driveFiles)}),DS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/drives/${e}/root:/${t}`;return xo(r,o,N.files.stores.driveFiles)}),LS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/groups/${e}/drive/items/${t}`;return xo(r,o,N.files.stores.groupFiles)}),NS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/groups/${e}/drive/root:/${t}`;return xo(r,o,N.files.stores.groupFiles)}),HS=(r,e)=>qe(void 0,void 0,void 0,function*(){let t=`/me/drive/items/${e}`;return xo(r,t,N.files.stores.userFiles)}),US=(r,e)=>qe(void 0,void 0,void 0,function*(){let t=`/me/drive/root:/${e}`;return xo(r,t,N.files.stores.userFiles)}),BS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/sites/${e}/drive/items/${t}`;return xo(r,o,N.files.stores.siteFiles)}),zS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/sites/${e}/drive/root:/${t}`;return xo(r,o,N.files.stores.siteFiles)}),VS=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/sites/${e}/lists/${t}/items/${o}/driveItem`;return xo(r,i,N.files.stores.siteFiles)}),qS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/users/${e}/drive/items/${t}`;return xo(r,o,N.files.stores.userFiles)}),GS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/users/${e}/drive/root:/${t}`;return xo(r,o,N.files.stores.userFiles)}),jS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/me/insights/${e}/${t}/resource`;return xo(r,o,N.files.stores.insightFiles,ha)}),KS=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/users/${e}/insights/${t}/${o}/resource`;return xo(r,i,N.files.stores.insightFiles,ha)}),Pi=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i,n=Q.getCache(N.fileLists,t),s=yield J0(n,t,`${e}:${o}`);if(s)return i=A7(r,s.files,s.nextLink),i;let a;try{if(a=r.api(e).middlewareOptions(ye(Rf)),o&&a.top(o),i=yield I7(r,a),Au()){let u=i.nextLink;yield n.putValue(e,{files:i.value.map(h=>JSON.stringify(h)),nextLink:u})}}catch{}return i||null}),WS=(r,e)=>qe(void 0,void 0,void 0,function*(){let t="/me/drive/root/children",o=N.fileLists.stores.fileLists;return Pi(r,t,o,e)}),QS=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/drives/${e}/items/${t}/children`,n=N.fileLists.stores.fileLists;return Pi(r,i,n,o)}),YS=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/drives/${e}/root:/${t}:/children`,n=N.fileLists.stores.fileLists;return Pi(r,i,n,o)}),ZS=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/groups/${e}/drive/items/${t}/children`,n=N.fileLists.stores.fileLists;return Pi(r,i,n,o)}),JS=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/groups/${e}/drive/root:/${t}:/children`,n=N.fileLists.stores.fileLists;return Pi(r,i,n,o)}),XS=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/me/drive/items/${e}/children`,i=N.fileLists.stores.fileLists;return Pi(r,o,i,t)}),e_=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/me/drive/root:/${e}:/children`,i=N.fileLists.stores.fileLists;return Pi(r,o,i,t)}),t_=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/sites/${e}/drive/items/${t}/children`,n=N.fileLists.stores.fileLists;return Pi(r,i,n,o)}),r_=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/sites/${e}/drive/root:/${t}:/children`,n=N.fileLists.stores.fileLists;return Pi(r,i,n,o)}),o_=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/users/${e}/drive/items/${t}/children`,n=N.fileLists.stores.fileLists;return Pi(r,i,n,o)}),i_=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/users/${e}/drive/root:/${t}:/children`,n=N.fileLists.stores.fileLists;return Pi(r,i,n,o)}),n_=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=N.fileLists.stores.fileLists;return Pi(r,e,o,t)}),s_=(r,e)=>qe(void 0,void 0,void 0,function*(){let t=`/me/insights/${e}`,o=N.fileLists.stores.insightfileLists,i=Q.getCache(N.fileLists,o),n=yield J0(i,o,t);if(n)return n.files.map(u=>JSON.parse(u));let s;try{s=yield r.api(t).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(ye(ha)).get()}catch{}let a=yield c_(r,s,ha);return Au()&&(yield i.putValue(t,{files:a.map(u=>JSON.stringify(u))})),a||null}),a_=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o,i;t==="shared"?(o="/me/insights/shared",i=`((lastshared/sharedby/id eq '${e}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(o=`/users/${e}/insights/${t}`,i="resourceReference/type eq 'microsoft.graph.driveItem'");let n=`${o}?$filter=${i}`,s=N.fileLists.stores.insightfileLists,a=Q.getCache(N.fileLists,s),u=yield J0(a,s,n);if(u)return u.files.map(f=>JSON.parse(f));let h;try{h=yield r.api(o).filter(i).middlewareOptions(ye(ha)).get()}catch{}let p=yield c_(r,h,ha);return Au()&&(yield a.putValue(o,{files:p.map(f=>JSON.stringify(f))})),p||null}),l_=(r,e)=>qe(void 0,void 0,void 0,function*(){if(!e||e.length===0)return[];let t=r.createBatch(),o=[],i,n;Al()&&(i=Q.getCache(N.files,N.files.stores.fileQueries));for(let s of e)Al()&&(n=yield i.getValue(s)),Al()&&n&&MS()>Date.now()-n.timeCached?o.push(JSON.parse(n.file)):s!==""&&t.get(s,s,Rf);try{let s=yield t.executeAll();for(let a of e){let u=s.get(a);u?.content&&(o.push(u.content),Al()&&(yield i.putValue(a,{file:JSON.stringify(u.content)})))}return o}catch{try{return Promise.all(e.filter(a=>a&&a!=="").map(a=>qe(void 0,void 0,void 0,function*(){let u=yield xo(r,a);if(u)return Al()&&(yield i.putValue(a,{file:JSON.stringify(u)})),u})))}catch{return[]}}}),c_=(r,e,t)=>qe(void 0,void 0,void 0,function*(){if(!e)return[];let o=e.value,i=r.createBatch(),n=[];for(let s of o){let a=s.resourceReference.id;a!==""&&i.get(a,a,t)}try{let s=yield i.executeAll();for(let a of o){let u=s.get(a.resourceReference.id);u?.content&&n.push(u.content)}return n}catch{try{return Promise.all(o.filter(a=>!!a.resourceReference.id).map(a=>qe(void 0,void 0,void 0,function*(){return yield r.api(a.resourceReference.id).middlewareOptions(ye(t)).get()})))}catch{return[]}}}),I7=(r,e)=>qe(void 0,void 0,void 0,function*(){return ul.create(r,e)}),A7=(r,e,t)=>ul.createFromValue(r,e.map(o=>JSON.parse(o)),t),R7=(r,e)=>qe(void 0,void 0,void 0,function*(){if(Al()){let t=yield r.getValue(e);if(t&&MS()>Date.now()-t.timeCached)return JSON.parse(t.file)}return null}),J0=(r,e,t)=>qe(void 0,void 0,void 0,function*(){if(r||(r=Q.getCache(N.fileLists,e)),Au()){let o=yield r.getValue(t);if(o&&E7()>Date.now()-o.timeCached)return o}return null}),X0=r=>qe(void 0,void 0,void 0,function*(){let e=r.nextLink;if(r.hasNext&&(yield r.next()),Au()){let t=Q.getCache(N.fileLists,N.fileLists.stores.fileLists),n=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(e)[3];yield t.putValue(n,{files:r.value.map(s=>JSON.stringify(s)),nextLink:e})}}),d_=(r,e,t)=>qe(void 0,void 0,void 0,function*(){try{let o=yield r.api(e).responseType(xr.RAW).middlewareOptions(ye(t)).get();if(o.status===404)return{eTag:null,thumbnail:null};if(!o.ok)return null;let i=o.headers.get("eTag"),n=yield gf(yield o.blob());return{eTag:i,thumbnail:n}}catch{return null}}),u_=(r,e)=>qe(void 0,void 0,void 0,function*(){try{return(yield r.api(e).middlewareOptions(ye(Rf)).get())||null}catch{}return null}),h_=(r,e,t)=>qe(void 0,void 0,void 0,function*(){try{let o={item:{"@microsoft.graph.conflictBehavior":t===0||t===null?"rename":"replace"}},i;try{i=yield r.api(e).middlewareOptions(ye(Pf)).post(JSON.stringify(o))}catch{}return i||null}catch{return null}}),p_=(r,e,t,o,i)=>qe(void 0,void 0,void 0,function*(){try{let n={"Content-Length":t,"Content-Range":o},s;try{s=yield r.client.api(e).middlewareOptions(ye(Pf)).headers(n).put(i)}catch{}return s||null}catch{return null}}),f_=(r,e,t)=>qe(void 0,void 0,void 0,function*(){try{let o;try{o=yield r.client.api(e).middlewareOptions(ye(Pf)).put(t)}catch{}return o||null}catch{return null}}),m_=(r,e)=>qe(void 0,void 0,void 0,function*(){try{yield r.client.api(e).middlewareOptions(ye(Pf)).delete()}catch{return null}})});var $f,ey,Ru,g_,P7,$7,O7,M7,F7,D7,L7,v_,N7,y_,b_=y(()=>{l();c();d();ue();Ln();Iu();da();Nc();$f=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},ey="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id,accountEnabled",Ru={directReports:"directReports",files:"files",messages:"messages",people:"people",person:"person"},g_=(r,e,t)=>$f(void 0,void 0,void 0,function*(){var o;let i=e.id,n=Co(e),s="classification"in e||"personType"in e&&(e.personType.subclass==="PersonalContact"||e.personType.class==="Group"),a=r.createBatch();s||Bt.sections.organization&&(P7(a,i),Bt.sections.organization.showWorksWith&&$7(a,i)),Bt.sections.mailMessages&&n&&M7(a,n),Bt.sections.files&&F7(a,t?null:n);let u,h={};try{u=yield a.executeAll()}catch{}if(u)for(let[p,f]of u)h[p]=((o=f.content)===null||o===void 0?void 0:o.value)||f.content;if(!s&&Bt.sections.profile)try{let p=yield D7(r,i);p&&(h.profile=p)}catch{}return h.directReports&&h.directReports.length>0&&(h.directReports=h.directReports.filter(p=>p.accountEnabled)),h}),P7=(r,e)=>{let t=`manager($levels=max;$select=${ey})`;r.get(Ru.person,`users/${e}?$expand=${t}&$select=${ey}&$count=true`,ca,{ConsistencyLevel:"eventual"}),r.get(Ru.directReports,`users/${e}/directReports?$select=${ey}`)},$7=(r,e)=>{r.get(Ru.people,`users/${e}/people?$filter=personType/class eq 'Person'`,ca)},O7=["Mail.ReadBasic","Mail.Read","Mail.ReadWrite"],M7=(r,e)=>{r.get(Ru.messages,`me/messages?$search="from:${e}"`,O7)},F7=(r,e)=>{let t;e?t=`me/insights/shared?$filter=lastshared/sharedby/address eq '${e}'`:t="me/insights/used",r.get(Ru.files,t,ha)},D7=(r,e)=>$f(void 0,void 0,void 0,function*(){return yield r.api(`/users/${e}/profile`).version("beta").middlewareOptions(ye(ca)).get()}),L7=["Chat.Create","Chat.ReadWrite"],v_=(r,e,t)=>$f(void 0,void 0,void 0,function*(){let o={chatType:"oneOnOne",members:[{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${t}')`},{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${e}')`}]};return yield r.api("/chats").header("Cache-Control","no-store").middlewareOptions(ye(L7)).post(o)}),N7=["ChatMessage.Send","Chat.ReadWrite"],y_=(r,e,t)=>$f(void 0,void 0,void 0,function*(){return yield r.api(`/chats/${e}/messages`).header("Cache-Control","no-store").middlewareOptions(ye(N7)).post(t)})});var w_,C_=y(()=>{l();c();d();Te();w_=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{box-shadow:var(--person-card-box-shadow,var(--elevation-shadow-card-rest));width:var(--mgt-flyout-set-width,375px);overflow:hidden;user-select:none;border-radius:8px;background-color:var(--person-card-background-color,var(--neutral-layer-floating));--file-list-background-color:transparent;--file-list-box-shadow:none;--file-item-background-color:transparent}:host .small{max-height:100vh;overflow:hidden auto}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding-top:18px;padding-inline-start:12px;height:32px;width:32px}:host .nav__back svg{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,var(--neutral-foreground-rest))}:host .close-card-container{position:relative;z-index:100}:host .close-card-container .close-button{position:absolute;right:10px;margin-top:9px;z-index:1;border:1px solid transparent}:host .close-card-container .close-button svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .close-card-container .close-button:hover svg path{fill:var(--person-card-close-button-hover-color,var(--neutral-foreground-rest))}:host .person-details-container{display:flex;flex-direction:column;padding-inline-start:22px;padding-block:36px;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .person-details-container .person-image{--person-avatar-top-spacing:var(--person-card-avatar-top-spacing, 15px);--person-details-left-spacing:var(--person-card-details-left-spacing, 15px);--person-details-bottom-spacing:var(--person-card-details-bottom-spacing, 0);--person-background-color:var(--person-card-background-color, var(--neutral-layer-floating));--person-line1-font-size:var(--person-card-line1-font-size, 20px);--person-line1-font-weight:var(--person-card-line1-font-weight, 600);--person-line1-text-line-height:var(--person-card-line1-line-height, 28px);--person-line1-text-color:var(--person-card-line1-text-color, var(--neutral-foreground-rest));--person-line2-font-size:var(--person-card-line2-font-size, 14px);--person-line2-font-weight:var(--person-card-line2-font-weight, 400);--person-line2-text-line-height:var(--person-card-line2-line-height, 20px);--person-line2-text-color:var(--person-card-line2-text-color, var(--neutral-foreground-hint));--person-line3-font-size:var(--person-card-line3-font-size, 14px);--person-line3-font-weight:var(--person-card-line3-font-weight, 400);--person-line3-text-line-height:var(--person-card-line3-line-height, 19px);--person-line3-text-color:var(--person-card-line3-text-color, var(--neutral-foreground-hint));--person-avatar-size:var(--person-card-avatar-size, 75px);--person-presence-wrapper-bottom:-15px}:host .person-details-container .base-icons{display:flex;align-items:center;margin-inline-start:var(--person-card-base-icons-left-spacing,calc(var(--person-card-avatar-size,75px) + var(--person-card-details-left-spacing,15px) - 8px));z-index:1}:host .person-details-container .base-icons .icon{display:flex;align-items:center;font-size:13px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-inline-end:28px}:host .person-details-container .base-icons .icon svg .filled{display:none}:host .person-details-container .base-icons .icon svg .regular{display:block}:host .person-details-container .base-icons .icon svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .person-details-container .base-icons .icon:active svg .filled,:host .person-details-container .base-icons .icon:hover svg .filled{display:block}:host .person-details-container .base-icons .icon:active svg .regular,:host .person-details-container .base-icons .icon:hover svg .regular{display:none}:host .person-details-container .base-icons .icon:active svg path,:host .person-details-container .base-icons .icon:hover svg path{fill:var(--person-card-icon-hover-color,var(--accent-foreground-hover))}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;height:32px}:host .expanded-details-container .expanded-details-button svg path{stroke:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .expanded-details-container .expanded-details-button:hover{cursor:pointer;background-color:var(--person-card-expanded-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section{padding:20px 0;display:flex;flex-direction:column;position:relative}:host .expanded-details-container .sections .section:not(:last-child)::after{position:absolute;content:"";width:90%;transform:translateX(-50%);border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest));left:50%;bottom:0}:host .expanded-details-container .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .expanded-details-container .sections .section__title{flex-grow:1;color:var(--person-card-line1-text-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;line-height:19px}:host .expanded-details-container .sections .section__show-more{font-size:12px;font-weight:600;align-self:center;vertical-align:top;--base-height-multiplier:6}:host .expanded-details-container .sections .section__show-more:hover{background-color:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section__content{margin-top:14px}:host .expanded-details-container .sections .section .additional-details{padding:0 20px}:host .expanded-details-container .divider{z-index:100;position:relative;width:375px;margin:0;border-style:none;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .expanded-details-container .section-nav{height:35px}:host .expanded-details-container .section-nav fluent-tabs{grid-template-columns:minmax(1px,.1fr)}:host .expanded-details-container .section-nav fluent-tabs.horizontal::part(activeIndicator){width:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel{max-height:360px;min-height:360px;overflow:hidden auto;padding:0;scrollbar-width:thin}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted{padding:20px 0;max-width:var(--mgt-flyout-set-width,375px);min-width:var(--mgt-flyout-set-width,360px);--file-list-box-shadow:none;--file-list-padding:0}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 20px;line-height:19px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .overview-panel{max-width:var(--mgt-flyout-set-width,375px)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-button{height:1px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track{border-radius:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab{padding-bottom:1px!important;border:1px solid transparent!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab:focus-visible{border:1px solid #2b2b2b!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon{cursor:pointer;box-sizing:border-box;width:53px;height:36px;display:flex;align-items:center;justify-content:center}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon svg{fill:var(--person-card-fluent-background-color,transparent)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon:hover{background:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover));border-radius:4px;z-index:0;position:relative}:host .expanded-details-container .section-host{min-height:360px;overflow:hidden auto}:host .expanded-details-container .section-host::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-host::-webkit-scrollbar-button{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .expanded-details-container .section-host::-webkit-scrollbar-track-piece{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-host.small{overflow-y:hidden}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .message-section{border-bottom:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint));display:flex}:host .message-section fluent-text-field{margin:10px 10px 10px 16px;--neutral-fill-input-rest:$person-card-background-color;--neutral-fill-input-hover:$person-card-chat-input-hover-color;--neutral-fill-input-focus:$person-card-chat-input-focus-color;width:300px;margin-inline-start:16px;border-radius:4px;border:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section .send-message-icon{max-width:15px;margin-top:10px}:host .message-section svg{height:17px;width:16px;fill:var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section svg:hover{filter:brightness(.5)}:host .message-section svg:disabled{filter:none}:host .person-root.large,:host .person-root.threelines{--person-avatar-size-3-lines:75px}:host fluent-button.close-button.lightweight::part(control),:host fluent-button.expanded-details-button::part(control),:host fluent-button.section__show-more.lightweight::part(control){background:var(--person-card-fluent-background-color,transparent)}:host fluent-button.icon::part(control),:host fluent-button.nav__back::part(control){border:none;padding:0;background:0 0}:host fluent-button.icon::part(control) :hover,:host fluent-button.nav__back::part(control) :hover{background:0 0}[dir=rtl] .base-icons{right:91px}[dir=rtl] .nav__back{width:20px!important;transform:scaleX(-1);filter:fliph;filter:FlipH}[dir=rtl] .close-card-container .close-button{right:auto;left:10px}[dir=rtl] .message-section svg{transform:scale(-1,1)}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var x_,k_=y(()=>{l();c();d();Te();x_=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}
`]});var Hn,ty,pn=y(()=>{l();c();d();Te();ue();k_();ue();Hn=()=>Pe("spinner",ty),ty=class extends fr{static get styles(){return x_}render(){return k`<fluent-progress-ring title="spinner"></fluent-progress-ring>`}}});var H7,S_,fn,Pu=y(()=>{l();c();d();ue();Te();At();pn();H7=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},S_=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},fn=class extends st{get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.requestStateUpdate())}get isCompact(){return this._isCompact}constructor(){super(),this._isCompact=!1,this._personDetails=null}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this.requestUpdate(),this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return Ee`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `}renderNoData(){return k`
      <div class="no-data">No data</div>
    `}navigateCard(e){var t;let o=this.parentNode;for(;o;){o=o.parentNode;let n=o;if(((t=n?.host)===null||t===void 0?void 0:t.tagName)===`${oo.prefix}-PERSON-CARD`.toUpperCase()){o=n.host;break}}o.navigate(e)}};H7([E({attribute:"person-details",type:Object}),S_("design:type",Object),S_("design:paramtypes",[Object])],fn.prototype,"personDetails",null)});var __,T_=y(()=>{l();c();d();Te();__=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__icon svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint))}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--contact-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .part .part__details .part__value{grid-column:2;color:var(--contact-value-color,var(--neutral-foreground-rest));font-size:14px;font-weight:400;line-height:19px}:host .root .part .part__details .part__value .part__link{color:var(--contact-link-color,var(--accent-foreground-rest));font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--contact-link-hover-color,var(--accent-foreground-hover))}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--contact-background-color,transparent);visibility:hidden;display:flex;align-items:center;justify-content:flex-start}:host .root .part .part__copy svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint));cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px;margin-bottom:2px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var E_,I_=y(()=>{l();c();d();E_={contactSectionTitle:"Contact",emailTitle:"Email",chatTitle:"Teams",businessPhoneTitle:"Business Phone",cellPhoneTitle:"Mobile Phone",departmentTitle:"Department",personTitle:"Title",officeLocationTitle:"Office Location",copyToClipboardButton:"Copy to clipboard"}});var A_,$u,Ou=y(()=>{l();c();d();Te();ue();fi();Ln();Pu();T_();Vr();I_();ue();A_=()=>{Pe("contact",$u)},$u=class extends fn{static get styles(){return __}get strings(){return E_}get hasData(){return this._contactParts?!!Object.values(this._contactParts).filter(t=>!!t.value).length:!1}constructor(e){var t;super(),this._contactParts={email:{icon:Y(P.Email),onClick:()=>this.sendEmail(Co(this._person)),showCompact:!0,title:this.strings.emailTitle},chat:{icon:Y(P.Chat),onClick:()=>{var o;return this.sendChat((o=this._person)===null||o===void 0?void 0:o.userPrincipalName)},showCompact:!1,title:this.strings.chatTitle},businessPhone:{icon:Y(P.Phone),onClick:()=>{var o,i;return this.sendCall(((i=(o=this._person)===null||o===void 0?void 0:o.businessPhones)===null||i===void 0?void 0:i.length)>0?this._person.businessPhones[0]:null)},showCompact:!0,title:this.strings.businessPhoneTitle},cellPhone:{icon:Y(P.CellPhone),onClick:()=>{var o;return this.sendCall((o=this._person)===null||o===void 0?void 0:o.mobilePhone)},showCompact:!0,title:this.strings.cellPhoneTitle},department:{icon:Y(P.Department),showCompact:!1,title:this.strings.departmentTitle},title:{icon:Y(P.Person),showCompact:!1,title:this.strings.personTitle},officeLocation:{icon:Y(P.OfficeLocation),showCompact:!0,title:this.strings.officeLocationTitle}},this.sendCall=o=>{this.sendLink("tel:",o)},this._person=e,this._contactParts.email.value=Co(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,!((t=this._person.businessPhones)===null||t===void 0)&&t.length&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}get displayName(){return this.strings.contactSectionTitle}get cardTitle(){return this.strings.contactSectionTitle}renderIcon(){return Y(P.Contact)}clearState(){super.clearState();for(let e of Object.keys(this._contactParts))this._contactParts[e].value=null}renderCompactView(){if(!this.hasData)return null;let e=Object.values(this._contactParts).filter(i=>!!i.value),t=Object.values(e).filter(i=>!!i.value&&i.showCompact);t?.length||(t=Object.values(e).slice(0,2));let o=k`
      ${t.map(i=>this.renderContactPart(i))}
    `;return k`
      <div class="root compact" dir=${this.direction}>
        ${o}
      </div>
    `}renderFullView(){let e;if(this.hasData){let t=Object.values(this._contactParts).filter(o=>!!o.value);e=k`
        ${t.map(o=>this.renderContactPart(o))}
      `}return k`
      <div class="root" dir=${this.direction}>
        ${e}
      </div>
    `}renderContactPart(e){let t=!1;(e.title==="Mobile Phone"||e.title==="Business Phone")&&(t=!0);let o={part__link:!0,phone:t},i=e.onClick?k`
          <span class=${Ve(o)} @click=${n=>e.onClick(n)}>${e.value}</span>
        `:k`
          ${e.value}
        `;return k`
      <div class="part" role="button" @click=${n=>this.handlePartClick(n,e.value)} tabindex="0">
        <div class="part__icon" aria-label=${e.title} title=${e.title}>${e.icon}</div>
        <div class="part__details">
          <div class="part__title">${e.title}</div>
          <div class="part__value" title=${e.title}>${i}</div>
        </div>
        <div
          class="part__copy"
          aria-label=${this.strings.copyToClipboardButton}
          title=${this.strings.copyToClipboardButton}
        >
          ${Y(P.Copy)}
        </div>
      </div>
    `}handlePartClick(e,t){t&&navigator.clipboard.writeText(t)}sendLink(e,t){t?window.open(`${e}${t}`,"_blank","noreferrer"):console.error(`\u{1F992}: Target resource for ${e} link was not provided: resource: ${t}`)}sendChat(e){if(!e){console.error("\u{1F992}: Can't send chat when upn is not provided");return}let t=`https://teams.microsoft.com/l/chat/0/0?users=${e}`,o=()=>window.open(t,"_blank","noreferrer");Pn.isAvailable?Pn.executeDeepLink(t,i=>{i||o()}):o()}sendEmail(e){this.sendLink("mailto:",e)}}});var U7,R_,Hc,pa,B7,P_,$_,Of,O_=y(()=>{l();c();d();Js();({D:U7}=Nx),R_=()=>document.createComment(""),Hc=(r,e,t)=>{let o=r._$AA.parentNode,i=e===void 0?r._$AB:e._$AA;if(t===void 0){let n=o.insertBefore(R_(),i),s=o.insertBefore(R_(),i);t=new U7(n,s,r,r.options)}else{let n=t._$AB.nextSibling,s=t._$AM,a=s!==r;if(a){let u;t._$AQ?.(r),t._$AM=r,t._$AP!==void 0&&(u=r._$AU)!==s._$AU&&t._$AP(u)}if(n!==i||a){let u=t._$AA;for(;u!==n;){let h=u.nextSibling;o.insertBefore(u,i),u=h}}}return t},pa=(r,e,t=r)=>(r._$AI(e,t),r),B7={},P_=(r,e=B7)=>r._$AH=e,$_=r=>r._$AH,Of=r=>{r._$AP?.(!1,!0);let e=r._$AA,t=r._$AB.nextSibling;for(;e!==t;){let o=e.nextSibling;e.remove(),e=o}}});var M_,uo,F_=y(()=>{l();c();d();Js();q0();O_();M_=(r,e,t)=>{let o=new Map;for(let i=e;i<=t;i++)o.set(r[i],i);return o},uo=mf(class extends Ic{constructor(r){if(super(r),r.type!==ff.CHILD)throw Error("repeat() can only be used in text expressions")}ht(r,e,t){let o;t===void 0?t=e:e!==void 0&&(o=e);let i=[],n=[],s=0;for(let a of r)i[s]=o?o(a,s):s,n[s]=t(a,s),s++;return{values:n,keys:i}}render(r,e,t){return this.ht(r,e,t).values}update(r,[e,t,o]){let i=$_(r),{values:n,keys:s}=this.ht(e,t,o);if(!Array.isArray(i))return this.dt=s,n;let a=this.dt??=[],u=[],h,p,f=0,b=i.length-1,x=0,S=n.length-1;for(;f<=b&&x<=S;)if(i[f]===null)f++;else if(i[b]===null)b--;else if(a[f]===s[x])u[x]=pa(i[f],n[x]),f++,x++;else if(a[b]===s[S])u[S]=pa(i[b],n[S]),b--,S--;else if(a[f]===s[S])u[S]=pa(i[f],n[S]),Hc(r,u[S+1],i[f]),f++,S--;else if(a[b]===s[x])u[x]=pa(i[b],n[x]),Hc(r,i[f],i[b]),b--,x++;else if(h===void 0&&(h=M_(s,x,S),p=M_(a,f,b)),h.has(a[f]))if(h.has(a[b])){let R=p.get(s[x]),z=R!==void 0?i[R]:null;if(z===null){let we=Hc(r,i[f]);pa(we,n[x]),u[x]=we}else u[x]=pa(z,n[x]),Hc(r,i[f],z),i[R]=null;x++}else Of(i[b]),b--;else Of(i[f]),f++;for(;x<=S;){let R=Hc(r,u[S+1]);pa(R,n[x]),u[x++]=R}for(;f<=b;){let R=i[f++];R!==null&&Of(R)}return this.dt=s,P_(r,u),nn}})});var Rl=y(()=>{l();c();d();F_()});function Mf(){let r=new WeakMap;return function(e){let t=r.get(e);if(t===void 0){let o=Reflect.getPrototypeOf(e);for(;t===void 0&&o!==null;)t=r.get(o),o=Reflect.getPrototypeOf(o);t=t===void 0?[]:t.slice(0),r.set(e,t)}return t}}var mn,D_,Pl,$i,Ts=y(()=>{l();c();d();mn=function(){if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof window<"u")return window;try{return new Function("return this")()}catch{return{}}}();mn.trustedTypes===void 0&&(mn.trustedTypes={createPolicy:(r,e)=>e});D_={configurable:!1,enumerable:!1,writable:!1};mn.FAST===void 0&&Reflect.defineProperty(mn,"FAST",Object.assign({value:Object.create(null)},D_));Pl=mn.FAST;if(Pl.getById===void 0){let r=Object.create(null);Reflect.defineProperty(Pl,"getById",Object.assign({value(e,t){let o=r[e];return o===void 0&&(o=t?r[e]=t():null),o}},D_))}$i=Object.freeze([])});var ry,L_,oy,Mu,iy,Ff,Z,Oi=y(()=>{l();c();d();Ts();ry=mn.FAST.getById(1,()=>{let r=[],e=[];function t(){if(e.length)throw e.shift()}function o(s){try{s.call()}catch(a){e.push(a),setTimeout(t,0)}}function i(){let a=0;for(;a<r.length;)if(o(r[a]),a++,a>1024){for(let u=0,h=r.length-a;u<h;u++)r[u]=r[u+a];r.length-=a,a=0}r.length=0}function n(s){r.length<1&&mn.requestAnimationFrame(i),r.push(s)}return Object.freeze({enqueue:n,process:i})}),L_=mn.trustedTypes.createPolicy("fast-html",{createHTML:r=>r}),oy=L_,Mu=`fast-${Math.random().toString(36).substring(2,8)}`,iy=`${Mu}{`,Ff=`}${Mu}`,Z=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(r){if(oy!==L_)throw new Error("The HTML policy can only be set once.");oy=r},createHTML(r){return oy.createHTML(r)},isMarker(r){return r&&r.nodeType===8&&r.data.startsWith(Mu)},extractDirectiveIndexFromMarker(r){return parseInt(r.data.replace(`${Mu}:`,""))},createInterpolationPlaceholder(r){return`${iy}${r}${Ff}`},createCustomAttributePlaceholder(r,e){return`${r}="${this.createInterpolationPlaceholder(e)}"`},createBlockPlaceholder(r){return`<!--${Mu}:${r}-->`},queueUpdate:ry.enqueue,processUpdates:ry.process,nextUpdate(){return new Promise(ry.enqueue)},setAttribute(r,e,t){t==null?r.removeAttribute(e):r.setAttribute(e,t)},setBooleanAttribute(r,e,t){t?r.setAttribute(e,""):r.removeAttribute(e)},removeChildNodes(r){for(let e=r.firstChild;e!==null;e=r.firstChild)r.removeChild(e)},createTemplateWalker(r){return document.createTreeWalker(r,133,null,!1)}})});var Un,Uc,Fu=y(()=>{l();c();d();Un=class{constructor(e,t){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=e,this.sub1=t}has(e){return this.spillover===void 0?this.sub1===e||this.sub2===e:this.spillover.indexOf(e)!==-1}subscribe(e){let t=this.spillover;if(t===void 0){if(this.has(e))return;if(this.sub1===void 0){this.sub1=e;return}if(this.sub2===void 0){this.sub2=e;return}this.spillover=[this.sub1,this.sub2,e],this.sub1=void 0,this.sub2=void 0}else t.indexOf(e)===-1&&t.push(e)}unsubscribe(e){let t=this.spillover;if(t===void 0)this.sub1===e?this.sub1=void 0:this.sub2===e&&(this.sub2=void 0);else{let o=t.indexOf(e);o!==-1&&t.splice(o,1)}}notify(e){let t=this.spillover,o=this.source;if(t===void 0){let i=this.sub1,n=this.sub2;i!==void 0&&i.handleChange(o,e),n!==void 0&&n.handleChange(o,e)}else for(let i=0,n=t.length;i<n;++i)t[i].handleChange(o,e)}},Uc=class{constructor(e){this.subscribers={},this.sourceSubscribers=null,this.source=e}notify(e){var t;let o=this.subscribers[e];o!==void 0&&o.notify(e),(t=this.sourceSubscribers)===null||t===void 0||t.notify(e)}subscribe(e,t){var o;if(t){let i=this.subscribers[t];i===void 0&&(this.subscribers[t]=i=new Un(this.source)),i.subscribe(e)}else this.sourceSubscribers=(o=this.sourceSubscribers)!==null&&o!==void 0?o:new Un(this.source),this.sourceSubscribers.subscribe(e)}unsubscribe(e,t){var o;if(t){let i=this.subscribers[t];i!==void 0&&i.unsubscribe(e)}else(o=this.sourceSubscribers)===null||o===void 0||o.unsubscribe(e)}}});function I(r,e){fe.defineProperty(r,e)}function H_(r,e,t){return Object.assign({},t,{get:function(){return fe.trackVolatile(),t.get.apply(this)}})}var fe,N_,fa,ma,Bn=y(()=>{l();c();d();Oi();Ts();Fu();fe=Pl.getById(2,()=>{let r=/(:|&&|\|\||if)/,e=new WeakMap,t=Z.queueUpdate,o,i=h=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function n(h){let p=h.$fastController||e.get(h);return p===void 0&&(Array.isArray(h)?p=i(h):e.set(h,p=new Uc(h))),p}let s=Mf();class a{constructor(p){this.name=p,this.field=`_${p}`,this.callback=`${p}Changed`}getValue(p){return o!==void 0&&o.watch(p,this.name),p[this.field]}setValue(p,f){let b=this.field,x=p[b];if(x!==f){p[b]=f;let S=p[this.callback];typeof S=="function"&&S.call(p,x,f),n(p).notify(this.name)}}}class u extends Un{constructor(p,f,b=!1){super(p,f),this.binding=p,this.isVolatileBinding=b,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(p,f){this.needsRefresh&&this.last!==null&&this.disconnect();let b=o;o=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;let x=this.binding(p,f);return o=b,x}disconnect(){if(this.last!==null){let p=this.first;for(;p!==void 0;)p.notifier.unsubscribe(this,p.propertyName),p=p.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(p,f){let b=this.last,x=n(p),S=b===null?this.first:{};if(S.propertySource=p,S.propertyName=f,S.notifier=x,x.subscribe(this,f),b!==null){if(!this.needsRefresh){let R;o=void 0,R=b.propertySource[b.propertyName],o=this,p===R&&(this.needsRefresh=!0)}b.next=S}this.last=S}handleChange(){this.needsQueue&&(this.needsQueue=!1,t(this))}call(){this.last!==null&&(this.needsQueue=!0,this.notify(this))}records(){let p=this.first;return{next:()=>{let f=p;return f===void 0?{value:void 0,done:!0}:(p=p.next,{value:f,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(h){i=h},getNotifier:n,track(h,p){o!==void 0&&o.watch(h,p)},trackVolatile(){o!==void 0&&(o.needsRefresh=!0)},notify(h,p){n(h).notify(p)},defineProperty(h,p){typeof p=="string"&&(p=new a(p)),s(h).push(p),Reflect.defineProperty(h,p.name,{enumerable:!0,get:function(){return p.getValue(this)},set:function(f){p.setValue(this,f)}})},getAccessors:s,binding(h,p,f=this.isVolatileBinding(h)){return new u(h,p,f)},isVolatileBinding(h){return r.test(h.toString())}})});N_=Pl.getById(3,()=>{let r=null;return{get(){return r},set(e){r=e}}}),fa=class{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return N_.get()}get isEven(){return this.index%2===0}get isOdd(){return this.index%2!==0}get isFirst(){return this.index===0}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(e){N_.set(e)}};fe.defineProperty(fa.prototype,"index");fe.defineProperty(fa.prototype,"length");ma=Object.seal(new fa)});var ga,Bc,Es,va=y(()=>{l();c();d();Oi();ga=class{constructor(){this.targetIndex=0}},Bc=class extends ga{constructor(){super(...arguments),this.createPlaceholder=Z.createInterpolationPlaceholder}},Es=class extends ga{constructor(e,t,o){super(),this.name=e,this.behavior=t,this.options=o}createPlaceholder(e){return Z.createCustomAttributePlaceholder(this.name,e)}createBehavior(e){return new this.behavior(e,this.options)}}});function z7(r,e){this.source=r,this.context=e,this.bindingObserver===null&&(this.bindingObserver=fe.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(r,e))}function V7(r,e){this.source=r,this.context=e,this.target.addEventListener(this.targetName,this)}function q7(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function G7(){this.bindingObserver.disconnect(),this.source=null,this.context=null;let r=this.target.$fastView;r!==void 0&&r.isComposed&&(r.unbind(),r.needsBindOnly=!0)}function j7(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function K7(r){Z.setAttribute(this.target,this.targetName,r)}function W7(r){Z.setBooleanAttribute(this.target,this.targetName,r)}function Q7(r){if(r==null&&(r=""),r.create){this.target.textContent="";let e=this.target.$fastView;e===void 0?e=r.create():this.target.$fastTemplate!==r&&(e.isComposed&&(e.remove(),e.unbind()),e=r.create()),e.isComposed?e.needsBindOnly&&(e.needsBindOnly=!1,e.bind(this.source,this.context)):(e.isComposed=!0,e.bind(this.source,this.context),e.insertBefore(this.target),this.target.$fastView=e,this.target.$fastTemplate=r)}else{let e=this.target.$fastView;e!==void 0&&e.isComposed&&(e.isComposed=!1,e.remove(),e.needsBindOnly?e.needsBindOnly=!1:e.unbind()),this.target.textContent=r}}function Y7(r){this.target[this.targetName]=r}function Z7(r){let e=this.classVersions||Object.create(null),t=this.target,o=this.version||0;if(r!=null&&r.length){let i=r.split(/\s+/);for(let n=0,s=i.length;n<s;++n){let a=i[n];a!==""&&(e[a]=o,t.classList.add(a))}}if(this.classVersions=e,this.version=o+1,o!==0){o-=1;for(let i in e)e[i]===o&&t.classList.remove(i)}}var $l,ny,Df=y(()=>{l();c();d();Oi();Bn();va();$l=class extends Bc{constructor(e){super(),this.binding=e,this.bind=z7,this.unbind=q7,this.updateTarget=K7,this.isBindingVolatile=fe.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(e){if(this.originalTargetName=e,e!==void 0)switch(e[0]){case":":if(this.cleanedTargetName=e.substr(1),this.updateTarget=Y7,this.cleanedTargetName==="innerHTML"){let t=this.binding;this.binding=(o,i)=>Z.createHTML(t(o,i))}break;case"?":this.cleanedTargetName=e.substr(1),this.updateTarget=W7;break;case"@":this.cleanedTargetName=e.substr(1),this.bind=V7,this.unbind=j7;break;default:this.cleanedTargetName=e,e==="class"&&(this.updateTarget=Z7);break}}targetAtContent(){this.updateTarget=Q7,this.unbind=G7}createBehavior(e){return new ny(e,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}},ny=class{constructor(e,t,o,i,n,s,a){this.source=null,this.context=null,this.bindingObserver=null,this.target=e,this.binding=t,this.isBindingVolatile=o,this.bind=i,this.unbind=n,this.updateTarget=s,this.targetName=a}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(e){fa.setEvent(e);let t=this.binding(this.source,this.context);fa.setEvent(null),t!==!0&&e.preventDefault()}}});function J7(r){if(r.length===1)return r[0];let e,t=r.length,o=r.map(s=>typeof s=="string"?()=>s:(e=s.targetName||e,s.binding)),i=(s,a)=>{let u="";for(let h=0;h<t;++h)u+=o[h](s,a);return u},n=new $l(i);return n.targetName=e,n}function B_(r,e){let t=e.split(iy);if(t.length===1)return null;let o=[];for(let i=0,n=t.length;i<n;++i){let s=t[i],a=s.indexOf(Ff),u;if(a===-1)u=s;else{let h=parseInt(s.substring(0,a));o.push(r.directives[h]),u=s.substring(a+X7)}u!==""&&o.push(u)}return o}function U_(r,e,t=!1){let o=e.attributes;for(let i=0,n=o.length;i<n;++i){let s=o[i],a=s.value,u=B_(r,a),h=null;u===null?t&&(h=new $l(()=>a),h.targetName=s.name):h=J7(u),h!==null&&(e.removeAttributeNode(s),i--,n--,r.addFactory(h))}}function e9(r,e,t){let o=B_(r,e.textContent);if(o!==null){let i=e;for(let n=0,s=o.length;n<s;++n){let a=o[n],u=n===0?e:i.parentNode.insertBefore(document.createTextNode(""),i.nextSibling);typeof a=="string"?u.textContent=a:(u.textContent=" ",r.captureContentBinding(a)),i=u,r.targetIndex++,u!==e&&t.nextNode()}r.targetIndex--}}function z_(r,e){let t=r.content;document.adoptNode(t);let o=ay.borrow(e);U_(o,r,!0);let i=o.behaviorFactories;o.reset();let n=Z.createTemplateWalker(t),s;for(;s=n.nextNode();)switch(o.targetIndex++,s.nodeType){case 1:U_(o,s);break;case 3:e9(o,s,n);break;case 8:Z.isMarker(s)&&o.addFactory(e[Z.extractDirectiveIndexFromMarker(s)])}let a=0;(Z.isMarker(t.firstChild)||t.childNodes.length===1&&e.length)&&(t.insertBefore(document.createComment(""),t.firstChild),a=-1);let u=o.behaviorFactories;return o.release(),{fragment:t,viewBehaviorFactories:u,hostBehaviorFactories:i,targetOffset:a}}var sy,ay,X7,ly=y(()=>{l();c();d();Oi();Df();sy=null,ay=class r{addFactory(e){e.targetIndex=this.targetIndex,this.behaviorFactories.push(e)}captureContentBinding(e){e.targetAtContent(),this.addFactory(e)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){sy=this}static borrow(e){let t=sy||new r;return t.directives=e,t.reset(),sy=null,t}};X7=Ff.length});var cy,zc,Lf=y(()=>{l();c();d();cy=document.createRange(),zc=class{constructor(e,t){this.fragment=e,this.behaviors=t,this.source=null,this.context=null,this.firstChild=e.firstChild,this.lastChild=e.lastChild}appendTo(e){e.appendChild(this.fragment)}insertBefore(e){if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{let t=this.lastChild;if(e.previousSibling===t)return;let o=e.parentNode,i=this.firstChild,n;for(;i!==t;)n=i.nextSibling,o.insertBefore(i,e),i=n;o.insertBefore(t,e)}}remove(){let e=this.fragment,t=this.lastChild,o=this.firstChild,i;for(;o!==t;)i=o.nextSibling,e.appendChild(o),o=i;e.appendChild(t)}dispose(){let e=this.firstChild.parentNode,t=this.lastChild,o=this.firstChild,i;for(;o!==t;)i=o.nextSibling,e.removeChild(o),o=i;e.removeChild(t);let n=this.behaviors,s=this.source;for(let a=0,u=n.length;a<u;++a)n[a].unbind(s)}bind(e,t){let o=this.behaviors;if(this.source!==e)if(this.source!==null){let i=this.source;this.source=e,this.context=t;for(let n=0,s=o.length;n<s;++n){let a=o[n];a.unbind(i),a.bind(e,t)}}else{this.source=e,this.context=t;for(let i=0,n=o.length;i<n;++i)o[i].bind(e,t)}}unbind(){if(this.source===null)return;let e=this.behaviors,t=this.source;for(let o=0,i=e.length;o<i;++o)e[o].unbind(t);this.source=null}static disposeContiguousBatch(e){if(e.length!==0){cy.setStartBefore(e[0].firstChild),cy.setEndAfter(e[e.length-1].lastChild),cy.deleteContents();for(let t=0,o=e.length;t<o;++t){let i=e[t],n=i.behaviors,s=i.source;for(let a=0,u=n.length;a<u;++a)n[a].unbind(s)}}}}});function O(r,...e){let t=[],o="";for(let i=0,n=r.length-1;i<n;++i){let s=r[i],a=e[i];if(o+=s,a instanceof Nf){let u=a;a=()=>u}if(typeof a=="function"&&(a=new $l(a)),a instanceof Bc){let u=t9.exec(s);u!==null&&(a.targetName=u[2])}a instanceof ga?(o+=a.createPlaceholder(t.length),t.push(a)):o+=a}return o+=r[r.length-1],new Nf(o,t)}var Nf,t9,V_=y(()=>{l();c();d();Oi();Bn();ly();Lf();va();Df();Nf=class{constructor(e,t){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=e,this.directives=t}create(e){if(this.fragment===null){let h,p=this.html;if(typeof p=="string"){h=document.createElement("template"),h.innerHTML=Z.createHTML(p);let b=h.content.firstElementChild;b!==null&&b.tagName==="TEMPLATE"&&(h=b)}else h=p;let f=z_(h,this.directives);this.fragment=f.fragment,this.viewBehaviorFactories=f.viewBehaviorFactories,this.hostBehaviorFactories=f.hostBehaviorFactories,this.targetOffset=f.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}let t=this.fragment.cloneNode(!0),o=this.viewBehaviorFactories,i=new Array(this.behaviorCount),n=Z.createTemplateWalker(t),s=0,a=this.targetOffset,u=n.nextNode();for(let h=o.length;s<h;++s){let p=o[s],f=p.targetIndex;for(;u!==null;)if(a===f){i[s]=p.createBehavior(u);break}else u=n.nextNode(),a++}if(this.hasHostBehaviors){let h=this.hostBehaviorFactories;for(let p=0,f=h.length;p<f;++p,++s)i[s]=h[p].createBehavior(e)}return new zc(t,i)}render(e,t,o){typeof t=="string"&&(t=document.getElementById(t)),o===void 0&&(o=t);let i=this.create(o);return i.bind(e,ma),i.appendTo(t),i}},t9=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/});function hy(r){return r.map(e=>e instanceof cr?hy(e.styles):[e]).reduce((e,t)=>e.concat(t),[])}function q_(r){return r.map(e=>e instanceof cr?e.behaviors:null).reduce((e,t)=>t===null?e:(e===null&&(e=[]),e.concat(t)),null)}function o9(){return`fast-style-class-${++r9}`}var cr,G_,j_,dy,r9,uy,Hf=y(()=>{l();c();d();Oi();cr=class{constructor(){this.targets=new WeakSet}addStylesTo(e){this.targets.add(e)}removeStylesFrom(e){this.targets.delete(e)}isAttachedTo(e){return this.targets.has(e)}withBehaviors(...e){return this.behaviors=this.behaviors===null?e:this.behaviors.concat(e),this}};cr.create=(()=>{if(Z.supportsAdoptedStyleSheets){let r=new Map;return e=>new dy(e,r)}return r=>new uy(r)})();G_=(r,e)=>{r.adoptedStyleSheets=[...r.adoptedStyleSheets,...e]},j_=(r,e)=>{r.adoptedStyleSheets=r.adoptedStyleSheets.filter(t=>e.indexOf(t)===-1)};if(Z.supportsAdoptedStyleSheets)try{document.adoptedStyleSheets.push(),document.adoptedStyleSheets.splice(),G_=(r,e)=>{r.adoptedStyleSheets.push(...e)},j_=(r,e)=>{for(let t of e){let o=r.adoptedStyleSheets.indexOf(t);o!==-1&&r.adoptedStyleSheets.splice(o,1)}}}catch{}dy=class extends cr{constructor(e,t){super(),this.styles=e,this.styleSheetCache=t,this._styleSheets=void 0,this.behaviors=q_(e)}get styleSheets(){if(this._styleSheets===void 0){let e=this.styles,t=this.styleSheetCache;this._styleSheets=hy(e).map(o=>{if(o instanceof CSSStyleSheet)return o;let i=t.get(o);return i===void 0&&(i=new CSSStyleSheet,i.replaceSync(o),t.set(o,i)),i})}return this._styleSheets}addStylesTo(e){G_(e,this.styleSheets),super.addStylesTo(e)}removeStylesFrom(e){j_(e,this.styleSheets),super.removeStylesFrom(e)}},r9=0;uy=class extends cr{constructor(e){super(),this.styles=e,this.behaviors=null,this.behaviors=q_(e),this.styleSheets=hy(e),this.styleClass=o9()}addStylesTo(e){let t=this.styleSheets,o=this.styleClass;e=this.normalizeTarget(e);for(let i=0;i<t.length;i++){let n=document.createElement("style");n.innerHTML=t[i],n.className=o,e.append(n)}super.addStylesTo(e)}removeStylesFrom(e){e=this.normalizeTarget(e);let t=e.querySelectorAll(`.${this.styleClass}`);for(let o=0,i=t.length;o<i;++o)e.removeChild(t[o]);super.removeStylesFrom(e)}isAttachedTo(e){return super.isAttachedTo(this.normalizeTarget(e))}normalizeTarget(e){return e===document?document.body:e}}});function C(r,e){let t;function o(i,n){arguments.length>1&&(t.property=n),Du.locate(i.constructor).push(t)}if(arguments.length>1){t={},o(r,e);return}return t=r===void 0?{}:r,o}var Du,Is,ie,Uf,py=y(()=>{l();c();d();Bn();Oi();Ts();Du=Object.freeze({locate:Mf()}),Is={toView(r){return r?"true":"false"},fromView(r){return!(r==null||r==="false"||r===!1||r===0)}},ie={toView(r){if(r==null)return null;let e=r*1;return isNaN(e)?null:e.toString()},fromView(r){if(r==null)return null;let e=r*1;return isNaN(e)?null:e}},Uf=class r{constructor(e,t,o=t.toLowerCase(),i="reflect",n){this.guards=new Set,this.Owner=e,this.name=t,this.attribute=o,this.mode=i,this.converter=n,this.fieldName=`_${t}`,this.callbackName=`${t}Changed`,this.hasCallback=this.callbackName in e.prototype,i==="boolean"&&n===void 0&&(this.converter=Is)}setValue(e,t){let o=e[this.fieldName],i=this.converter;i!==void 0&&(t=i.fromView(t)),o!==t&&(e[this.fieldName]=t,this.tryReflectToAttribute(e),this.hasCallback&&e[this.callbackName](o,t),e.$fastController.notify(this.name))}getValue(e){return fe.track(e,this.name),e[this.fieldName]}onAttributeChangedCallback(e,t){this.guards.has(e)||(this.guards.add(e),this.setValue(e,t),this.guards.delete(e))}tryReflectToAttribute(e){let t=this.mode,o=this.guards;o.has(e)||t==="fromView"||Z.queueUpdate(()=>{o.add(e);let i=e[this.fieldName];switch(t){case"reflect":let n=this.converter;Z.setAttribute(e,this.attribute,n!==void 0?n.toView(i):i);break;case"boolean":Z.setBooleanAttribute(e,this.attribute,i);break}o.delete(e)})}static collect(e,...t){let o=[];t.push(Du.locate(e));for(let i=0,n=t.length;i<n;++i){let s=t[i];if(s!==void 0)for(let a=0,u=s.length;a<u;++a){let h=s[a];typeof h=="string"?o.push(new r(e,h)):o.push(new r(e,h.property,h.attribute,h.mode,h.converter))}}return o}}});var K_,W_,fy,zn,Bf=y(()=>{l();c();d();Ts();Bn();Hf();py();K_={mode:"open"},W_={},fy=Pl.getById(4,()=>{let r=new Map;return Object.freeze({register(e){return r.has(e.type)?!1:(r.set(e.type,e),!0)},getByType(e){return r.get(e)}})}),zn=class{constructor(e,t=e.definition){typeof t=="string"&&(t={name:t}),this.type=e,this.name=t.name,this.template=t.template;let o=Uf.collect(e,t.attributes),i=new Array(o.length),n={},s={};for(let a=0,u=o.length;a<u;++a){let h=o[a];i[a]=h.attribute,n[h.name]=h,s[h.attribute]=h}this.attributes=o,this.observedAttributes=i,this.propertyLookup=n,this.attributeLookup=s,this.shadowOptions=t.shadowOptions===void 0?K_:t.shadowOptions===null?void 0:Object.assign(Object.assign({},K_),t.shadowOptions),this.elementOptions=t.elementOptions===void 0?W_:Object.assign(Object.assign({},W_),t.elementOptions),this.styles=t.styles===void 0?void 0:Array.isArray(t.styles)?cr.create(t.styles):t.styles instanceof cr?t.styles:cr.create([t.styles])}get isDefined(){return!!fy.getByType(this.type)}define(e=customElements){let t=this.type;if(fy.register(this)){let o=this.attributes,i=t.prototype;for(let n=0,s=o.length;n<s;++n)fe.defineProperty(i,o[n]);Reflect.defineProperty(t,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return e.get(this.name)||e.define(this.name,t,this.elementOptions),this}};zn.forType=fy.getByType});function my(r){return r.shadowRoot||Q_.get(r)||null}var Q_,i9,zf,gy=y(()=>{l();c();d();Oi();Fu();Bn();Bf();Q_=new WeakMap,i9={bubbles:!0,composed:!0,cancelable:!0};zf=class r extends Uc{constructor(e,t){super(e),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=e,this.definition=t;let o=t.shadowOptions;if(o!==void 0){let n=e.attachShadow(o);o.mode==="closed"&&Q_.set(e,n)}let i=fe.getAccessors(e);if(i.length>0){let n=this.boundObservables=Object.create(null);for(let s=0,a=i.length;s<a;++s){let u=i[s].name,h=e[u];h!==void 0&&(delete e[u],n[u]=h)}}}get isConnected(){return fe.track(this,"isConnected"),this._isConnected}setIsConnected(e){this._isConnected=e,fe.notify(this,"isConnected")}get template(){return this._template}set template(e){this._template!==e&&(this._template=e,this.needsInitialization||this.renderTemplate(e))}get styles(){return this._styles}set styles(e){this._styles!==e&&(this._styles!==null&&this.removeStyles(this._styles),this._styles=e,!this.needsInitialization&&e!==null&&this.addStyles(e))}addStyles(e){let t=my(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.append(e);else if(!e.isAttachedTo(t)){let o=e.behaviors;e.addStylesTo(t),o!==null&&this.addBehaviors(o)}}removeStyles(e){let t=my(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.removeChild(e);else if(e.isAttachedTo(t)){let o=e.behaviors;e.removeStylesFrom(t),o!==null&&this.removeBehaviors(o)}}addBehaviors(e){let t=this.behaviors||(this.behaviors=new Map),o=e.length,i=[];for(let n=0;n<o;++n){let s=e[n];t.has(s)?t.set(s,t.get(s)+1):(t.set(s,1),i.push(s))}if(this._isConnected){let n=this.element;for(let s=0;s<i.length;++s)i[s].bind(n,ma)}}removeBehaviors(e,t=!1){let o=this.behaviors;if(o===null)return;let i=e.length,n=[];for(let s=0;s<i;++s){let a=e[s];if(o.has(a)){let u=o.get(a)-1;u===0||t?o.delete(a)&&n.push(a):o.set(a,u)}}if(this._isConnected){let s=this.element;for(let a=0;a<n.length;++a)n[a].unbind(s)}}onConnectedCallback(){if(this._isConnected)return;let e=this.element;this.needsInitialization?this.finishInitialization():this.view!==null&&this.view.bind(e,ma);let t=this.behaviors;if(t!==null)for(let[o]of t)o.bind(e,ma);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);let e=this.view;e!==null&&e.unbind();let t=this.behaviors;if(t!==null){let o=this.element;for(let[i]of t)i.unbind(o)}}onAttributeChangedCallback(e,t,o){let i=this.definition.attributeLookup[e];i!==void 0&&i.onAttributeChangedCallback(this.element,o)}emit(e,t,o){return this._isConnected?this.element.dispatchEvent(new CustomEvent(e,Object.assign(Object.assign({detail:t},i9),o))):!1}finishInitialization(){let e=this.element,t=this.boundObservables;if(t!==null){let i=Object.keys(t);for(let n=0,s=i.length;n<s;++n){let a=i[n];e[a]=t[a]}this.boundObservables=null}let o=this.definition;this._template===null&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():o.template&&(this._template=o.template||null)),this._template!==null&&this.renderTemplate(this._template),this._styles===null&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():o.styles&&(this._styles=o.styles||null)),this._styles!==null&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(e){let t=this.element,o=my(t)||t;this.view!==null?(this.view.dispose(),this.view=null):this.needsInitialization||Z.removeChildNodes(o),e&&(this.view=e.render(t,o,t))}static forCustomElement(e){let t=e.$fastController;if(t!==void 0)return t;let o=zn.forType(e.constructor);if(o===void 0)throw new Error("Missing FASTElement definition.");return e.$fastController=new r(e,o)}}});function Y_(r){return class extends r{constructor(){super(),zf.forCustomElement(this)}$emit(e,t,o){return this.$fastController.emit(e,t,o)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(e,t,o){this.$fastController.onAttributeChangedCallback(e,t,o)}}}var ya,Z_=y(()=>{l();c();d();gy();Bf();ya=Object.assign(Y_(HTMLElement),{from(r){return Y_(r)},define(r,e){return new zn(r,e).define().type}})});var ba,vy=y(()=>{l();c();d();ba=class{createCSS(){return""}createBehavior(){}}});function J_(r,e){let t=[],o="",i=[];for(let n=0,s=r.length-1;n<s;++n){o+=r[n];let a=e[n];if(a instanceof ba){let u=a.createBehavior();a=a.createCSS(),u&&i.push(u)}a instanceof cr||a instanceof CSSStyleSheet?(o.trim()!==""&&(t.push(o),o=""),t.push(a)):o+=a}return o+=r[r.length-1],o.trim()!==""&&t.push(o),{styles:t,behaviors:i}}function M(r,...e){let{styles:t,behaviors:o}=J_(r,e),i=cr.create(t);return o.length&&i.withBehaviors(...o),i}function qr(r,...e){let{styles:t,behaviors:o}=J_(r,e);return new yy(t,o)}var yy,X_=y(()=>{l();c();d();vy();Hf();yy=class extends ba{constructor(e,t){super(),this.behaviors=t,this.css="";let o=e.reduce((i,n)=>(typeof n=="string"?this.css+=n:i.push(n),i),[]);o.length&&(this.styles=cr.create(o))}createBehavior(){return this}createCSS(){return this.css}bind(e){this.styles&&e.$fastController.addStyles(this.styles),this.behaviors.length&&e.$fastController.addBehaviors(this.behaviors)}unbind(e){this.styles&&e.$fastController.removeStyles(this.styles),this.behaviors.length&&e.$fastController.removeBehaviors(this.behaviors)}}});function Mi(r,e,t){return{index:r,removed:e,addedCount:t}}function n9(r,e,t,o,i,n){let s=n-i+1,a=t-e+1,u=new Array(s),h,p;for(let f=0;f<s;++f)u[f]=new Array(a),u[f][0]=f;for(let f=0;f<a;++f)u[0][f]=f;for(let f=1;f<s;++f)for(let b=1;b<a;++b)r[e+b-1]===o[i+f-1]?u[f][b]=u[f-1][b-1]:(h=u[f-1][b]+1,p=u[f][b-1]+1,u[f][b]=h<p?h:p);return u}function s9(r){let e=r.length-1,t=r[0].length-1,o=r[e][t],i=[];for(;e>0||t>0;){if(e===0){i.push(by),t--;continue}if(t===0){i.push(wy),e--;continue}let n=r[e-1][t-1],s=r[e-1][t],a=r[e][t-1],u;s<a?u=s<n?s:n:u=a<n?a:n,u===n?(n===o?i.push(tT):(i.push(rT),o=n),e--,t--):u===s?(i.push(wy),e--,o=s):(i.push(by),t--,o=a)}return i.reverse(),i}function a9(r,e,t){for(let o=0;o<t;++o)if(r[o]!==e[o])return o;return t}function l9(r,e,t){let o=r.length,i=e.length,n=0;for(;n<t&&r[--o]===e[--i];)n++;return n}function c9(r,e,t,o){return e<t||o<r?-1:e===t||o===r?0:r<t?e<o?e-t:o-t:o<e?o-r:e-r}function Cy(r,e,t,o,i,n){let s=0,a=0,u=Math.min(t-e,n-i);if(e===0&&i===0&&(s=a9(r,o,u)),t===r.length&&n===o.length&&(a=l9(r,o,u-s)),e+=s,i+=s,t-=a,n-=a,t-e===0&&n-i===0)return $i;if(e===t){let S=Mi(e,[],0);for(;i<n;)S.removed.push(o[i++]);return[S]}else if(i===n)return[Mi(e,[],t-e)];let h=s9(n9(r,e,t,o,i,n)),p=[],f,b=e,x=i;for(let S=0;S<h.length;++S)switch(h[S]){case tT:f!==void 0&&(p.push(f),f=void 0),b++,x++;break;case rT:f===void 0&&(f=Mi(b,[],0)),f.addedCount++,b++,f.removed.push(o[x]),x++;break;case by:f===void 0&&(f=Mi(b,[],0)),f.addedCount++,b++;break;case wy:f===void 0&&(f=Mi(b,[],0)),f.removed.push(o[x]),x++;break}return f!==void 0&&p.push(f),p}function d9(r,e,t,o){let i=Mi(e,t,o),n=!1,s=0;for(let a=0;a<r.length;a++){let u=r[a];if(u.index+=s,n)continue;let h=c9(i.index,i.index+i.removed.length,u.index,u.index+u.addedCount);if(h>=0){r.splice(a,1),a--,s-=u.addedCount-u.removed.length,i.addedCount+=u.addedCount-h;let p=i.removed.length+u.removed.length-h;if(!i.addedCount&&!p)n=!0;else{let f=u.removed;if(i.index<u.index){let b=i.removed.slice(0,u.index-i.index);eT.apply(b,f),f=b}if(i.index+i.removed.length>u.index+u.addedCount){let b=i.removed.slice(u.index+u.addedCount-i.index);eT.apply(f,b)}i.removed=f,u.index<i.index&&(i.index=u.index)}}else if(i.index<u.index){n=!0,r.splice(a,0,i),a++;let p=i.addedCount-i.removed.length;u.index+=p,s+=p}}n||r.push(i)}function u9(r){let e=[];for(let t=0,o=r.length;t<o;t++){let i=r[t];d9(e,i.index,i.removed,i.addedCount)}return e}function oT(r,e){let t=[],o=u9(e);for(let i=0,n=o.length;i<n;++i){let s=o[i];if(s.addedCount===1&&s.removed.length===1){s.removed[0]!==r[s.index]&&t.push(s);continue}t=t.concat(Cy(r,s.index,s.index+s.addedCount,s.removed,0,s.removed.length))}return t}var tT,rT,by,wy,eT,xy=y(()=>{l();c();d();Ts();tT=0,rT=1,by=2,wy=3;eT=Array.prototype.push});function ky(r,e){let t=r.index,o=e.length;return t>o?t=o-r.addedCount:t<0&&(t=o+r.removed.length+t-r.addedCount),t<0&&(t=0),r.index=t,r}function _y(){if(iT)return;iT=!0,fe.setArrayObserverFactory(u=>new Sy(u));let r=Array.prototype;if(r.$fastPatch)return;Reflect.defineProperty(r,"$fastPatch",{value:1,enumerable:!1});let e=r.pop,t=r.push,o=r.reverse,i=r.shift,n=r.sort,s=r.splice,a=r.unshift;r.pop=function(){let u=this.length>0,h=e.apply(this,arguments),p=this.$fastController;return p!==void 0&&u&&p.addSplice(Mi(this.length,[h],0)),h},r.push=function(){let u=t.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(ky(Mi(this.length-arguments.length,[],arguments.length),this)),u},r.reverse=function(){let u,h=this.$fastController;h!==void 0&&(h.flush(),u=this.slice());let p=o.apply(this,arguments);return h!==void 0&&h.reset(u),p},r.shift=function(){let u=this.length>0,h=i.apply(this,arguments),p=this.$fastController;return p!==void 0&&u&&p.addSplice(Mi(0,[h],0)),h},r.sort=function(){let u,h=this.$fastController;h!==void 0&&(h.flush(),u=this.slice());let p=n.apply(this,arguments);return h!==void 0&&h.reset(u),p},r.splice=function(){let u=s.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(ky(Mi(+arguments[0],u,arguments.length>2?arguments.length-2:0),this)),u},r.unshift=function(){let u=a.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(ky(Mi(0,[],arguments.length),this)),u}}var iT,Sy,Ty=y(()=>{l();c();d();Oi();xy();Fu();Bn();iT=!1;Sy=class extends Un{constructor(e){super(e),this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this.call=this.flush,Reflect.defineProperty(e,"$fastController",{value:this,enumerable:!1})}subscribe(e){this.flush(),super.subscribe(e)}addSplice(e){this.splices===void 0?this.splices=[e]:this.splices.push(e),this.needsQueue&&(this.needsQueue=!1,Z.queueUpdate(this))}reset(e){this.oldCollection=e,this.needsQueue&&(this.needsQueue=!1,Z.queueUpdate(this))}flush(){let e=this.splices,t=this.oldCollection;if(e===void 0&&t===void 0)return;this.needsQueue=!0,this.splices=void 0,this.oldCollection=void 0;let o=t===void 0?oT(this.source,e):Cy(this.source,0,this.source.length,t,0,t.length);this.notify(o)}}});function Ie(r){return new Es("fast-ref",Ey,r)}var Ey,nT=y(()=>{l();c();d();va();Ey=class{constructor(e,t){this.target=e,this.propertyName=t}bind(e){e[this.propertyName]=this.target}unbind(){}}});var Iy,sT=y(()=>{l();c();d();Iy=r=>typeof r=="function"});function aT(r){return r===void 0?h9:Iy(r)?r:()=>r}function Xe(r,e,t){let o=Iy(r)?r:()=>r,i=aT(e),n=aT(t);return(s,a)=>o(s,a)?i(s,a):n(s,a)}var h9,lT=y(()=>{l();c();d();sT();h9=()=>null});function p9(r,e,t,o){r.bind(e[t],o)}function f9(r,e,t,o){let i=Object.create(o);i.index=t,i.length=e.length,r.bind(e[t],i)}function Ol(r,e,t=cT){let o=typeof e=="function"?e:()=>e;return new Vn(r,o,Object.assign(Object.assign({},cT),t))}var cT,Ay,Vn,dT=y(()=>{l();c();d();Oi();Bn();Ty();Ts();va();Lf();cT=Object.freeze({positioning:!1,recycle:!0});Ay=class{constructor(e,t,o,i,n,s){this.location=e,this.itemsBinding=t,this.templateBinding=i,this.options=s,this.source=null,this.views=[],this.items=null,this.itemsObserver=null,this.originalContext=void 0,this.childContext=void 0,this.bindView=p9,this.itemsBindingObserver=fe.binding(t,this,o),this.templateBindingObserver=fe.binding(i,this,n),s.positioning&&(this.bindView=f9)}bind(e,t){this.source=e,this.originalContext=t,this.childContext=Object.create(t),this.childContext.parent=e,this.childContext.parentContext=this.originalContext,this.items=this.itemsBindingObserver.observe(e,this.originalContext),this.template=this.templateBindingObserver.observe(e,this.originalContext),this.observeItems(!0),this.refreshAllViews()}unbind(){this.source=null,this.items=null,this.itemsObserver!==null&&this.itemsObserver.unsubscribe(this),this.unbindAllViews(),this.itemsBindingObserver.disconnect(),this.templateBindingObserver.disconnect()}handleChange(e,t){e===this.itemsBinding?(this.items=this.itemsBindingObserver.observe(this.source,this.originalContext),this.observeItems(),this.refreshAllViews()):e===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.originalContext),this.refreshAllViews(!0)):this.updateViews(t)}observeItems(e=!1){if(!this.items){this.items=$i;return}let t=this.itemsObserver,o=this.itemsObserver=fe.getNotifier(this.items),i=t!==o;i&&t!==null&&t.unsubscribe(this),(i||e)&&o.subscribe(this)}updateViews(e){let t=this.childContext,o=this.views,i=this.bindView,n=this.items,s=this.template,a=this.options.recycle,u=[],h=0,p=0;for(let f=0,b=e.length;f<b;++f){let x=e[f],S=x.removed,R=0,z=x.index,we=z+x.addedCount,re=o.splice(x.index,S.length),ge=p=u.length+re.length;for(;z<we;++z){let wt=o[z],je=wt?wt.firstChild:this.location,it;a&&p>0?(R<=ge&&re.length>0?(it=re[R],R++):(it=u[h],h++),p--):it=s.create(),o.splice(z,0,it),i(it,n,z,t),it.insertBefore(je)}re[R]&&u.push(...re.slice(R))}for(let f=h,b=u.length;f<b;++f)u[f].dispose();if(this.options.positioning)for(let f=0,b=o.length;f<b;++f){let x=o[f].context;x.length=b,x.index=f}}refreshAllViews(e=!1){let t=this.items,o=this.childContext,i=this.template,n=this.location,s=this.bindView,a=t.length,u=this.views,h=u.length;if((a===0||e||!this.options.recycle)&&(zc.disposeContiguousBatch(u),h=0),h===0){this.views=u=new Array(a);for(let p=0;p<a;++p){let f=i.create();s(f,t,p,o),u[p]=f,f.insertBefore(n)}}else{let p=0;for(;p<a;++p)if(p<h){let b=u[p];s(b,t,p,o)}else{let b=i.create();s(b,t,p,o),u.push(b),b.insertBefore(n)}let f=u.splice(p,h-p);for(p=0,a=f.length;p<a;++p)f[p].dispose()}}unbindAllViews(){let e=this.views;for(let t=0,o=e.length;t<o;++t)e[t].unbind()}},Vn=class extends ga{constructor(e,t,o){super(),this.itemsBinding=e,this.templateBinding=t,this.options=o,this.createPlaceholder=Z.createBlockPlaceholder,_y(),this.isItemsBindingVolatile=fe.isVolatileBinding(e),this.isTemplateBindingVolatile=fe.isVolatileBinding(t)}createBehavior(e){return new Ay(e,this.itemsBinding,this.isItemsBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile,this.options)}}});function Gr(r){return r?function(e,t,o){return e.nodeType===1&&e.matches(r)}:function(e,t,o){return e.nodeType===1}}var Vc,Vf=y(()=>{l();c();d();Bn();Ts();Vc=class{constructor(e,t){this.target=e,this.options=t,this.source=null}bind(e){let t=this.options.property;this.shouldUpdate=fe.getAccessors(e).some(o=>o.name===t),this.source=e,this.updateTarget(this.computeNodes()),this.shouldUpdate&&this.observe()}unbind(){this.updateTarget($i),this.source=null,this.shouldUpdate&&this.disconnect()}handleEvent(){this.updateTarget(this.computeNodes())}computeNodes(){let e=this.getNodes();return this.options.filter!==void 0&&(e=e.filter(this.options.filter)),e}updateTarget(e){this.source[this.options.property]=e}}});function Le(r){return typeof r=="string"&&(r={property:r}),new Es("fast-slotted",Ry,r)}var Ry,uT=y(()=>{l();c();d();va();Vf();Ry=class extends Vc{constructor(e,t){super(e,t)}observe(){this.target.addEventListener("slotchange",this)}disconnect(){this.target.removeEventListener("slotchange",this)}getNodes(){return this.target.assignedNodes(this.options)}}});function wa(r){return typeof r=="string"&&(r={property:r}),new Es("fast-children",Py,r)}var Py,hT=y(()=>{l();c();d();va();Vf();Py=class extends Vc{constructor(e,t){super(e,t),this.observer=null,t.childList=!0}observe(){this.observer===null&&(this.observer=new MutationObserver(this.handleEvent.bind(this))),this.observer.observe(this.target,this.options)}disconnect(){this.observer.disconnect()}getNodes(){return"subtree"in this.options?Array.from(this.target.querySelectorAll(this.options.selector)):Array.from(this.target.childNodes)}}});var A=y(()=>{l();c();d();Ts();V_();Z_();Bf();py();gy();ly();Hf();X_();vy();Lf();Bn();Fu();xy();Ty();Oi();Df();va();nT();lT();dT();uT();hT();Vf()});var _t,xt,kt,pT,fT,Mt=y(()=>{l();c();d();A();_t=class{handleStartContentChange(){this.startContainer.classList.toggle("start",this.start.assignedNodes().length>0)}handleEndContentChange(){this.endContainer.classList.toggle("end",this.end.assignedNodes().length>0)}},xt=(r,e)=>O`
    <span
        part="end"
        ${Ie("endContainer")}
        class=${t=>e.end?"end":void 0}
    >
        <slot name="end" ${Ie("end")} @slotchange="${t=>t.handleEndContentChange()}">
            ${e.end||""}
        </slot>
    </span>
`,kt=(r,e)=>O`
    <span
        part="start"
        ${Ie("startContainer")}
        class="${t=>e.start?"start":void 0}"
    >
        <slot
            name="start"
            ${Ie("start")}
            @slotchange="${t=>t.handleStartContentChange()}"
        >
            ${e.start||""}
        </slot>
    </span>
`,pT=O`
    <span part="end" ${Ie("endContainer")}>
        <slot
            name="end"
            ${Ie("end")}
            @slotchange="${r=>r.handleEndContentChange()}"
        ></slot>
    </span>
`,fT=O`
    <span part="start" ${Ie("startContainer")}>
        <slot
            name="start"
            ${Ie("start")}
            @slotchange="${r=>r.handleStartContentChange()}"
        ></slot>
    </span>
`});var mT,gT=y(()=>{l();c();d();A();Mt();mT=(r,e)=>O`
    <template class="${t=>t.expanded?"expanded":""}">
        <div
            class="heading"
            part="heading"
            role="heading"
            aria-level="${t=>t.headinglevel}"
        >
            <button
                class="button"
                part="button"
                ${Ie("expandbutton")}
                aria-expanded="${t=>t.expanded}"
                aria-controls="${t=>t.id}-panel"
                id="${t=>t.id}"
                @click="${(t,o)=>t.clickHandler(o.event)}"
            >
                <span class="heading-content" part="heading-content">
                    <slot name="heading"></slot>
                </span>
            </button>
            ${kt(r,e)}
            ${xt(r,e)}
            <span class="icon" part="icon" aria-hidden="true">
                <slot name="expanded-icon" part="expanded-icon">
                    ${e.expandedIcon||""}
                </slot>
                <slot name="collapsed-icon" part="collapsed-icon">
                    ${e.collapsedIcon||""}
                </slot>
            <span>
        </div>
        <div
            class="region"
            part="region"
            id="${t=>t.id}-panel"
            role="region"
            aria-labelledby="${t=>t.id}"
        >
            <slot></slot>
        </div>
    </template>
`});function w(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n}var $e=y(()=>{l();c();d();});function Lu(r){let e=r.slice(),t=Object.keys(r),o=t.length,i;for(let n=0;n<o;++n)i=t[n],IT(i)||(e[i]=r[i]);return e}function yT(r){return e=>Reflect.getOwnMetadata(r,e)}function Kf(r){return function(e){let t=function(o,i,n){Pt.inject(t)(o,i,n)};return t.$isResolver=!0,t.resolve=function(o,i){return r(e,o,i)},t}}function y9(r){return function(e,t){t=!!t;let o=function(i,n,s){Pt.inject(o)(i,n,s)};return o.$isResolver=!0,o.resolve=function(i,n){return r(e,i,n,t)},o}}function Ny(r,e,t){Pt.inject(Ny)(r,e,t)}function _T(r,e){return e.getFactory(r).construct(e)}function wT(r){return this.get(r)}function b9(r,e){return e(r)}function jf(r){return typeof r.register=="function"}function C9(r){return jf(r)&&typeof r.registerInRequestor=="boolean"}function CT(r){return C9(r)&&r.registerInRequestor}function x9(r){return r.prototype!==void 0}function ET(r){return function(e,t,o){if(Fy.has(o))return Fy.get(o);let i=r(e,t,o);return Fy.set(o,i),i}}function qf(r){if(r==null)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}function xT(r,e,t){if(r instanceof Mo&&r.strategy===4){let o=r.state,i=o.length,n=new Array(i);for(;i--;)n[i]=o[i].resolve(e,t);return n}return[r.resolve(e,t)]}function ST(r){return typeof r=="object"&&r!==null||typeof r=="function"}function IT(r){switch(typeof r){case"number":return r>=0&&(r|0)===r;case"string":{let e=Gf[r];if(e!==void 0)return e;let t=r.length;if(t===0)return Gf[r]=!1;let o=0;for(let i=0;i<t;++i)if(o=r.charCodeAt(i),i===0&&o===48&&t>1||o<48||o>57)return Gf[r]=!1;return Gf[r]=!0}default:return!1}}var $y,Dy,m9,Oy,vT,bT,Pt,g9,T1e,v9,E1e,I1e,A1e,R1e,P1e,Mo,Ly,w9,k9,TT,My,Nu,Fy,Ml,kT,S9,Gf,Wf=y(()=>{l();c();d();A();$y=new Map;"metadata"in Reflect||(Reflect.metadata=function(r,e){return function(t){Reflect.defineMetadata(r,e,t)}},Reflect.defineMetadata=function(r,e,t){let o=$y.get(t);o===void 0&&$y.set(t,o=new Map),o.set(r,e)},Reflect.getOwnMetadata=function(r,e){let t=$y.get(e);if(t!==void 0)return t.get(r)});Dy=class{constructor(e,t){this.container=e,this.key=t}instance(e){return this.registerResolver(0,e)}singleton(e){return this.registerResolver(1,e)}transient(e){return this.registerResolver(2,e)}callback(e){return this.registerResolver(3,e)}cachedCallback(e){return this.registerResolver(3,ET(e))}aliasTo(e){return this.registerResolver(5,e)}registerResolver(e,t){let{container:o,key:i}=this;return this.container=this.key=void 0,o.registerResolver(i,new Mo(i,e,t))}};m9=Object.freeze({none(r){throw Error(`${r.toString()} not registered, did you forget to add @singleton()?`)},singleton(r){return new Mo(r,1,r)},transient(r){return new Mo(r,2,r)}}),Oy=Object.freeze({default:Object.freeze({parentLocator:()=>null,responsibleForOwnerRequests:!1,defaultResolver:m9.singleton})}),vT=new Map;bT=null,Pt=Object.freeze({createContainer(r){return new Nu(null,Object.assign({},Oy.default,r))},findResponsibleContainer(r){let e=r.$$container$$;return e&&e.responsibleForOwnerRequests?e:Pt.findParentContainer(r)},findParentContainer(r){let e=new CustomEvent(TT,{bubbles:!0,composed:!0,cancelable:!0,detail:{container:void 0}});return r.dispatchEvent(e),e.detail.container||Pt.getOrCreateDOMContainer()},getOrCreateDOMContainer(r,e){return r?r.$$container$$||new Nu(r,Object.assign({},Oy.default,e,{parentLocator:Pt.findParentContainer})):bT||(bT=new Nu(null,Object.assign({},Oy.default,e,{parentLocator:()=>null})))},getDesignParamtypes:yT("design:paramtypes"),getAnnotationParamtypes:yT("di:paramtypes"),getOrCreateAnnotationParamTypes(r){let e=this.getAnnotationParamtypes(r);return e===void 0&&Reflect.defineMetadata("di:paramtypes",e=[],r),e},getDependencies(r){let e=vT.get(r);if(e===void 0){let t=r.inject;if(t===void 0){let o=Pt.getDesignParamtypes(r),i=Pt.getAnnotationParamtypes(r);if(o===void 0)if(i===void 0){let n=Object.getPrototypeOf(r);typeof n=="function"&&n!==Function.prototype?e=Lu(Pt.getDependencies(n)):e=[]}else e=Lu(i);else if(i===void 0)e=Lu(o);else{e=Lu(o);let n=i.length,s;for(let h=0;h<n;++h)s=i[h],s!==void 0&&(e[h]=s);let a=Object.keys(i);n=a.length;let u;for(let h=0;h<n;++h)u=a[h],IT(u)||(e[u]=i[u])}}else e=Lu(t);vT.set(r,e)}return e},defineProperty(r,e,t,o=!1){let i=`$di_${e}`;Reflect.defineProperty(r,e,{get:function(){let n=this[i];if(n===void 0&&(n=(this instanceof HTMLElement?Pt.findResponsibleContainer(this):Pt.getOrCreateDOMContainer()).get(t),this[i]=n,o&&this instanceof ya)){let a=this.$fastController,u=()=>{let p=Pt.findResponsibleContainer(this).get(t),f=this[i];p!==f&&(this[i]=n,a.notify(e))};a.subscribe({handleChange:u},"isConnected")}return n}})},createInterface(r,e){let t=typeof r=="function"?r:e,o=typeof r=="string"?r:r&&"friendlyName"in r&&r.friendlyName||kT,i=typeof r=="string"?!1:r&&"respectConnection"in r&&r.respectConnection||!1,n=function(s,a,u){if(s==null||new.target!==void 0)throw new Error(`No registration for interface: '${n.friendlyName}'`);if(a)Pt.defineProperty(s,a,n,i);else{let h=Pt.getOrCreateAnnotationParamTypes(s);h[u]=n}};return n.$isInterface=!0,n.friendlyName=o??"(anonymous)",t!=null&&(n.register=function(s,a){return t(new Dy(s,a??n))}),n.toString=function(){return`InterfaceSymbol<${n.friendlyName}>`},n},inject(...r){return function(e,t,o){if(typeof o=="number"){let i=Pt.getOrCreateAnnotationParamTypes(e),n=r[0];n!==void 0&&(i[o]=n)}else if(t)Pt.defineProperty(e,t,r[0]);else{let i=o?Pt.getOrCreateAnnotationParamTypes(o.value):Pt.getOrCreateAnnotationParamTypes(e),n;for(let s=0;s<r.length;++s)n=r[s],n!==void 0&&(i[s]=n)}}},transient(r){return r.register=function(t){return Ml.transient(r,r).register(t)},r.registerInRequestor=!1,r},singleton(r,e=v9){return r.register=function(o){return Ml.singleton(r,r).register(o)},r.registerInRequestor=e.scoped,r}}),g9=Pt.createInterface("Container");T1e=Pt.inject,v9={scoped:!1};E1e=y9((r,e,t,o)=>t.getAll(r,o)),I1e=Kf((r,e,t)=>()=>t.get(r)),A1e=Kf((r,e,t)=>{if(t.has(r,!0))return t.get(r)});Ny.$isResolver=!0;Ny.resolve=()=>{};R1e=Kf((r,e,t)=>{let o=_T(r,e),i=new Mo(r,0,o);return t.registerResolver(r,i),o}),P1e=Kf((r,e,t)=>_T(r,e));Mo=class{constructor(e,t,o){this.key=e,this.strategy=t,this.state=o,this.resolving=!1}get $isResolver(){return!0}register(e){return e.registerResolver(this.key,this)}resolve(e,t){switch(this.strategy){case 0:return this.state;case 1:{if(this.resolving)throw new Error(`Cyclic dependency found: ${this.state.name}`);return this.resolving=!0,this.state=e.getFactory(this.state).construct(t),this.strategy=0,this.resolving=!1,this.state}case 2:{let o=e.getFactory(this.state);if(o===null)throw new Error(`Resolver for ${String(this.key)} returned a null factory`);return o.construct(t)}case 3:return this.state(e,t,this);case 4:return this.state[0].resolve(e,t);case 5:return t.get(this.state);default:throw new Error(`Invalid resolver strategy specified: ${this.strategy}.`)}}getFactory(e){var t,o,i;switch(this.strategy){case 1:case 2:return e.getFactory(this.state);case 5:return(i=(o=(t=e.getResolver(this.state))===null||t===void 0?void 0:t.getFactory)===null||o===void 0?void 0:o.call(t,e))!==null&&i!==void 0?i:null;default:return null}}};Ly=class{constructor(e,t){this.Type=e,this.dependencies=t,this.transformers=null}construct(e,t){let o;return t===void 0?o=new this.Type(...this.dependencies.map(wT,e)):o=new this.Type(...this.dependencies.map(wT,e),...t),this.transformers==null?o:this.transformers.reduce(b9,o)}registerTransformer(e){(this.transformers||(this.transformers=[])).push(e)}},w9={$isResolver:!0,resolve(r,e){return e}};k9=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]),TT="__DI_LOCATE_PARENT__",My=new Map,Nu=class r{constructor(e,t){this.owner=e,this.config=t,this._parent=void 0,this.registerDepth=0,this.context=null,e!==null&&(e.$$container$$=this),this.resolvers=new Map,this.resolvers.set(g9,w9),e instanceof Node&&e.addEventListener(TT,o=>{o.composedPath()[0]!==this.owner&&(o.detail.container=this,o.stopImmediatePropagation())})}get parent(){return this._parent===void 0&&(this._parent=this.config.parentLocator(this.owner)),this._parent}get depth(){return this.parent===null?0:this.parent.depth+1}get responsibleForOwnerRequests(){return this.config.responsibleForOwnerRequests}registerWithContext(e,...t){return this.context=e,this.register(...t),this.context=null,this}register(...e){if(++this.registerDepth===100)throw new Error("Unable to autoregister dependency");let t,o,i,n,s,a=this.context;for(let u=0,h=e.length;u<h;++u)if(t=e[u],!!ST(t))if(jf(t))t.register(this,a);else if(x9(t))Ml.singleton(t,t).register(this);else for(o=Object.keys(t),n=0,s=o.length;n<s;++n)i=t[o[n]],ST(i)&&(jf(i)?i.register(this,a):this.register(i));return--this.registerDepth,this}registerResolver(e,t){qf(e);let o=this.resolvers,i=o.get(e);return i==null?o.set(e,t):i instanceof Mo&&i.strategy===4?i.state.push(t):o.set(e,new Mo(e,4,[i,t])),t}registerTransformer(e,t){let o=this.getResolver(e);if(o==null)return!1;if(o.getFactory){let i=o.getFactory(this);return i==null?!1:(i.registerTransformer(t),!0)}return!1}getResolver(e,t=!0){if(qf(e),e.resolve!==void 0)return e;let o=this,i;for(;o!=null;)if(i=o.resolvers.get(e),i==null){if(o.parent==null){let n=CT(e)?this:o;return t?this.jitRegister(e,n):null}o=o.parent}else return i;return null}has(e,t=!1){return this.resolvers.has(e)?!0:t&&this.parent!=null?this.parent.has(e,!0):!1}get(e){if(qf(e),e.$isResolver)return e.resolve(this,this);let t=this,o;for(;t!=null;)if(o=t.resolvers.get(e),o==null){if(t.parent==null){let i=CT(e)?this:t;return o=this.jitRegister(e,i),o.resolve(t,this)}t=t.parent}else return o.resolve(t,this);throw new Error(`Unable to resolve key: ${String(e)}`)}getAll(e,t=!1){qf(e);let o=this,i=o,n;if(t){let s=$i;for(;i!=null;)n=i.resolvers.get(e),n!=null&&(s=s.concat(xT(n,i,o))),i=i.parent;return s}else for(;i!=null;)if(n=i.resolvers.get(e),n==null){if(i=i.parent,i==null)return $i}else return xT(n,i,o);return $i}getFactory(e){let t=My.get(e);if(t===void 0){if(S9(e))throw new Error(`${e.name} is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.`);My.set(e,t=new Ly(e,Pt.getDependencies(e)))}return t}registerFactory(e,t){My.set(e,t)}createChild(e){return new r(null,Object.assign({},this.config,e,{parentLocator:()=>this}))}jitRegister(e,t){if(typeof e!="function")throw new Error(`Attempted to jitRegister something that is not a constructor: '${e}'. Did you forget to register this dependency?`);if(k9.has(e.name))throw new Error(`Attempted to jitRegister an intrinsic type: ${e.name}. Did you forget to add @inject(Key)`);if(jf(e)){let o=e.register(t);if(!(o instanceof Object)||o.resolve==null){let i=t.resolvers.get(e);if(i!=null)return i;throw new Error("A valid resolver was not returned from the static register method")}return o}else{if(e.$isInterface)throw new Error(`Attempted to jitRegister an interface: ${e.friendlyName}`);{let o=this.config.defaultResolver(e,t);return t.resolvers.set(e,o),o}}}},Fy=new WeakMap;Ml=Object.freeze({instance(r,e){return new Mo(r,0,e)},singleton(r,e){return new Mo(r,1,e)},transient(r,e){return new Mo(r,2,e)},callback(r,e){return new Mo(r,3,e)},cachedCallback(r,e){return new Mo(r,3,ET(e))},aliasTo(r,e){return new Mo(e,5,r)}});kT="(anonymous)";S9=function(){let r=new WeakMap,e=!1,t="",o=0;return function(i){return e=r.get(i),e===void 0&&(t=i.toString(),o=t.length,e=o>=29&&o<=100&&t.charCodeAt(o-1)===125&&t.charCodeAt(o-2)<=32&&t.charCodeAt(o-3)===93&&t.charCodeAt(o-4)===101&&t.charCodeAt(o-5)===100&&t.charCodeAt(o-6)===111&&t.charCodeAt(o-7)===99&&t.charCodeAt(o-8)===32&&t.charCodeAt(o-9)===101&&t.charCodeAt(o-10)===118&&t.charCodeAt(o-11)===105&&t.charCodeAt(o-12)===116&&t.charCodeAt(o-13)===97&&t.charCodeAt(o-14)===110&&t.charCodeAt(o-15)===88,r.set(i,e)),e}}(),Gf={}});function AT(r){return`${r.toLowerCase()}:presentation`}var Qf,Zf,Yf,Jf=y(()=>{l();c();d();A();Wf();Qf=new Map,Zf=Object.freeze({define(r,e,t){let o=AT(r);Qf.get(o)===void 0?Qf.set(o,e):Qf.set(o,!1),t.register(Ml.instance(o,e))},forTag(r,e){let t=AT(r),o=Qf.get(t);return o===!1?Pt.findResponsibleContainer(e).get(t):o||null}}),Yf=class{constructor(e,t){this.template=e||null,this.styles=t===void 0?null:Array.isArray(t)?cr.create(t):t instanceof cr?t:cr.create([t])}applyTo(e){let t=e.$fastController;t.template===null&&(t.template=this.template),t.styles===null&&(t.styles=this.styles)}}});function Hu(r,e,t){return typeof r=="function"?r(e,t):r}var q,Hy,Ue=y(()=>{l();c();d();$e();A();Jf();q=class r extends ya{constructor(){super(...arguments),this._presentation=void 0}get $presentation(){return this._presentation===void 0&&(this._presentation=Zf.forTag(this.tagName,this)),this._presentation}templateChanged(){this.template!==void 0&&(this.$fastController.template=this.template)}stylesChanged(){this.styles!==void 0&&(this.$fastController.styles=this.styles)}connectedCallback(){this.$presentation!==null&&this.$presentation.applyTo(this),super.connectedCallback()}static compose(e){return(t={})=>new Hy(this===r?class extends r{}:this,e,t)}};w([I],q.prototype,"template",void 0);w([I],q.prototype,"styles",void 0);Hy=class{constructor(e,t,o){this.type=e,this.elementDefinition=t,this.overrideDefinition=o,this.definition=Object.assign(Object.assign({},this.elementDefinition),this.overrideDefinition)}register(e,t){let o=this.definition,i=this.overrideDefinition,s=`${o.prefix||t.elementPrefix}-${o.baseName}`;t.tryDefineElement({name:s,type:this.type,baseClass:this.elementDefinition.baseClass,callback:a=>{let u=new Yf(Hu(o.template,a,o),Hu(o.styles,a,o));a.definePresentation(u);let h=Hu(o.shadowOptions,a,o);a.shadowRootMode&&(h?i.shadowOptions||(h.mode=a.shadowRootMode):h!==null&&(h={mode:a.shadowRootMode})),a.defineElement({elementOptions:Hu(o.elementOptions,a,o),shadowOptions:h,attributes:Hu(o.attributes,a,o)})}})}}});function Ye(r,...e){let t=Du.locate(r);e.forEach(o=>{Object.getOwnPropertyNames(o.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(o.prototype,n))}),Du.locate(o).forEach(n=>t.push(n))})}var jr=y(()=>{l();c();d();A()});var gn,Uy=y(()=>{l();c();d();$e();A();Ue();Mt();jr();gn=class extends q{constructor(){super(...arguments),this.headinglevel=2,this.expanded=!1,this.clickHandler=e=>{this.expanded=!this.expanded,this.change()},this.change=()=>{this.$emit("change")}}};w([C({attribute:"heading-level",mode:"fromView",converter:ie})],gn.prototype,"headinglevel",void 0);w([C({mode:"boolean"})],gn.prototype,"expanded",void 0);w([C],gn.prototype,"id",void 0);Ye(gn,_t)});var RT=y(()=>{l();c();d();gT();Uy()});var PT,$T=y(()=>{l();c();d();A();PT=(r,e)=>O`
    <template>
        <slot ${Le({property:"accordionItems",filter:Gr()})}></slot>
        <slot name="item" part="item" ${Le("accordionItems")}></slot>
    </template>
`});var Tt,OT=y(()=>{l();c();d();Tt={horizontal:"horizontal",vertical:"vertical"}});function MT(r,e){let t=r.length;for(;t--;)if(e(r[t],t,r))return t;return-1}var FT=y(()=>{l();c();d()});var DT=y(()=>{l();c();d()});function qc(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Xf=y(()=>{l();c();d()});var LT=y(()=>{l();c();d();Xf()});var NT=y(()=>{l();c();d();Xf()});var HT=y(()=>{l();c();d()});var By=y(()=>{l();c();d();Xf();LT();NT();HT()});function qn(...r){return r.every(e=>e instanceof HTMLElement)}function UT(r,e){return!r||!e||!qn(r)?void 0:Array.from(r.querySelectorAll(e)).filter(o=>o.offsetParent!==null)}function _9(){let r=document.querySelector('meta[property="csp-nonce"]');return r?r.getAttribute("content"):null}function BT(){if(typeof Fl=="boolean")return Fl;if(!qc())return Fl=!1,Fl;let r=document.createElement("style"),e=_9();e!==null&&r.setAttribute("nonce",e),document.head.appendChild(r);try{r.sheet.insertRule("foo:focus-visible {color:inherit}",0),Fl=!0}catch{Fl=!1}finally{document.head.removeChild(r)}return Fl}var Fl,zT=y(()=>{l();c();d();By()});var zy,Vy,As,Rs,qy,Gy,VT=y(()=>{l();c();d();zy="focus",Vy="focusin",As="focusout",Rs="keydown",qy="resize",Gy="scroll"});var qT=y(()=>{l();c();d()});var GT,Wt,ko,So,Qt,dr,Yo,Tr,Er,jT,KT,WT,Zo,Ca,QT,YT,xa,ZT=y(()=>{l();c();d();(function(r){r[r.alt=18]="alt",r[r.arrowDown=40]="arrowDown",r[r.arrowLeft=37]="arrowLeft",r[r.arrowRight=39]="arrowRight",r[r.arrowUp=38]="arrowUp",r[r.back=8]="back",r[r.backSlash=220]="backSlash",r[r.break=19]="break",r[r.capsLock=20]="capsLock",r[r.closeBracket=221]="closeBracket",r[r.colon=186]="colon",r[r.colon2=59]="colon2",r[r.comma=188]="comma",r[r.ctrl=17]="ctrl",r[r.delete=46]="delete",r[r.end=35]="end",r[r.enter=13]="enter",r[r.equals=187]="equals",r[r.equals2=61]="equals2",r[r.equals3=107]="equals3",r[r.escape=27]="escape",r[r.forwardSlash=191]="forwardSlash",r[r.function1=112]="function1",r[r.function10=121]="function10",r[r.function11=122]="function11",r[r.function12=123]="function12",r[r.function2=113]="function2",r[r.function3=114]="function3",r[r.function4=115]="function4",r[r.function5=116]="function5",r[r.function6=117]="function6",r[r.function7=118]="function7",r[r.function8=119]="function8",r[r.function9=120]="function9",r[r.home=36]="home",r[r.insert=45]="insert",r[r.menu=93]="menu",r[r.minus=189]="minus",r[r.minus2=109]="minus2",r[r.numLock=144]="numLock",r[r.numPad0=96]="numPad0",r[r.numPad1=97]="numPad1",r[r.numPad2=98]="numPad2",r[r.numPad3=99]="numPad3",r[r.numPad4=100]="numPad4",r[r.numPad5=101]="numPad5",r[r.numPad6=102]="numPad6",r[r.numPad7=103]="numPad7",r[r.numPad8=104]="numPad8",r[r.numPad9=105]="numPad9",r[r.numPadDivide=111]="numPadDivide",r[r.numPadDot=110]="numPadDot",r[r.numPadMinus=109]="numPadMinus",r[r.numPadMultiply=106]="numPadMultiply",r[r.numPadPlus=107]="numPadPlus",r[r.openBracket=219]="openBracket",r[r.pageDown=34]="pageDown",r[r.pageUp=33]="pageUp",r[r.period=190]="period",r[r.print=44]="print",r[r.quote=222]="quote",r[r.scrollLock=145]="scrollLock",r[r.shift=16]="shift",r[r.space=32]="space",r[r.tab=9]="tab",r[r.tilde=192]="tilde",r[r.windowsLeft=91]="windowsLeft",r[r.windowsOpera=219]="windowsOpera",r[r.windowsRight=92]="windowsRight"})(GT||(GT={}));Wt="ArrowDown",ko="ArrowLeft",So="ArrowRight",Qt="ArrowUp",dr="Enter",Yo="Escape",Tr="Home",Er="End",jT="F2",KT="PageDown",WT="PageUp",Zo=" ",Ca="Tab",QT="Backspace",YT="Delete",xa={ArrowDown:Wt,ArrowLeft:ko,ArrowRight:So,ArrowUp:Qt}});var ot,jy=y(()=>{l();c();d();(function(r){r.ltr="ltr",r.rtl="rtl"})(ot||(ot={}))});function JT(r,e,t){return t<r?e:t>e?r:t}function ka(r,e,t){return Math.min(Math.max(t,r),e)}function Uu(r,e,t=0){return[e,t]=[e,t].sort((o,i)=>o-i),e<=r&&r<t}var XT=y(()=>{l();c();d()});function gi(r=""){return`${r}${T9++}`}var T9,e2=y(()=>{l();c();d();T9=0});var t2=y(()=>{l();c();d()});var Gc,r2=y(()=>{l();c();d();By();jy();Gc=class r{static getScrollLeft(e,t){return t===ot.rtl?r.getRtlScrollLeftConverter(e):e.scrollLeft}static setScrollLeft(e,t,o){if(o===ot.rtl){r.setRtlScrollLeftConverter(e,t);return}e.scrollLeft=t}static initialGetRtlScrollConverter(e){return r.initializeRtlScrollConverters(),r.getRtlScrollLeftConverter(e)}static directGetRtlScrollConverter(e){return e.scrollLeft}static invertedGetRtlScrollConverter(e){return-Math.abs(e.scrollLeft)}static reverseGetRtlScrollConverter(e){return e.scrollLeft-(e.scrollWidth-e.clientWidth)}static initialSetRtlScrollConverter(e,t){r.initializeRtlScrollConverters(),r.setRtlScrollLeftConverter(e,t)}static directSetRtlScrollConverter(e,t){e.scrollLeft=t}static invertedSetRtlScrollConverter(e,t){e.scrollLeft=Math.abs(t)}static reverseSetRtlScrollConverter(e,t){let o=e.scrollWidth-e.clientWidth;e.scrollLeft=o+t}static initializeRtlScrollConverters(){if(!qc()){r.applyDirectScrollConverters();return}let e=r.getTestElement();document.body.appendChild(e),r.checkForScrollType(e),document.body.removeChild(e)}static checkForScrollType(e){r.isReverse(e)?r.applyReverseScrollConverters():r.isDirect(e)?r.applyDirectScrollConverters():r.applyInvertedScrollConverters()}static isReverse(e){return e.scrollLeft>0}static isDirect(e){return e.scrollLeft=-1,e.scrollLeft<0}static applyDirectScrollConverters(){r.setRtlScrollLeftConverter=r.directSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.directGetRtlScrollConverter}static applyInvertedScrollConverters(){r.setRtlScrollLeftConverter=r.invertedSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.invertedGetRtlScrollConverter}static applyReverseScrollConverters(){r.setRtlScrollLeftConverter=r.reverseSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.reverseGetRtlScrollConverter}static getTestElement(){let e=document.createElement("div");return e.appendChild(document.createTextNode("ABCD")),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",e}};Gc.getRtlScrollLeftConverter=Gc.initialGetRtlScrollConverter;Gc.setRtlScrollLeftConverter=Gc.initialSetRtlScrollConverter});var T,o2=y(()=>{l();c();d();(function(r){r.Canvas="Canvas",r.CanvasText="CanvasText",r.LinkText="LinkText",r.VisitedText="VisitedText",r.ActiveText="ActiveText",r.ButtonFace="ButtonFace",r.ButtonText="ButtonText",r.Field="Field",r.FieldText="FieldText",r.Highlight="Highlight",r.HighlightText="HighlightText",r.GrayText="GrayText"})(T||(T={}))});var be=y(()=>{l();c();d();OT();FT();DT();zT();VT();qT();ZT();jy();XT();e2();t2();r2();o2()});var i2,jc,n2=y(()=>{l();c();d();$e();A();be();Ue();Uy();i2={single:"single",multi:"multi"},jc=class extends q{constructor(){super(...arguments),this.expandmode=i2.multi,this.activeItemIndex=0,this.change=()=>{this.$emit("change",this.activeid)},this.setItems=()=>{var e;this.accordionItems.length!==0&&(this.accordionIds=this.getItemIds(),this.accordionItems.forEach((t,o)=>{t instanceof gn&&(t.addEventListener("change",this.activeItemChange),this.isSingleExpandMode()&&(this.activeItemIndex!==o?t.expanded=!1:t.expanded=!0));let i=this.accordionIds[o];t.setAttribute("id",typeof i!="string"?`accordion-${o+1}`:i),this.activeid=this.accordionIds[this.activeItemIndex],t.addEventListener("keydown",this.handleItemKeyDown),t.addEventListener("focus",this.handleItemFocus)}),this.isSingleExpandMode()&&((e=this.findExpandedItem())!==null&&e!==void 0?e:this.accordionItems[0]).setAttribute("aria-disabled","true"))},this.removeItemListeners=e=>{e.forEach((t,o)=>{t.removeEventListener("change",this.activeItemChange),t.removeEventListener("keydown",this.handleItemKeyDown),t.removeEventListener("focus",this.handleItemFocus)})},this.activeItemChange=e=>{if(e.defaultPrevented||e.target!==e.currentTarget)return;e.preventDefault();let t=e.target;this.activeid=t.getAttribute("id"),this.isSingleExpandMode()&&(this.resetItems(),t.expanded=!0,t.setAttribute("aria-disabled","true"),this.accordionItems.forEach(o=>{!o.hasAttribute("disabled")&&o.id!==this.activeid&&o.removeAttribute("aria-disabled")})),this.activeItemIndex=Array.from(this.accordionItems).indexOf(t),this.change()},this.handleItemKeyDown=e=>{if(e.target===e.currentTarget)switch(this.accordionIds=this.getItemIds(),e.key){case Qt:e.preventDefault(),this.adjust(-1);break;case Wt:e.preventDefault(),this.adjust(1);break;case Tr:this.activeItemIndex=0,this.focusItem();break;case Er:this.activeItemIndex=this.accordionItems.length-1,this.focusItem();break}},this.handleItemFocus=e=>{if(e.target===e.currentTarget){let t=e.target,o=this.activeItemIndex=Array.from(this.accordionItems).indexOf(t);this.activeItemIndex!==o&&o!==-1&&(this.activeItemIndex=o,this.activeid=this.accordionIds[this.activeItemIndex])}}}accordionItemsChanged(e,t){this.$fastController.isConnected&&(this.removeItemListeners(e),this.setItems())}findExpandedItem(){for(let e=0;e<this.accordionItems.length;e++)if(this.accordionItems[e].getAttribute("expanded")==="true")return this.accordionItems[e];return null}resetItems(){this.accordionItems.forEach((e,t)=>{e.expanded=!1})}getItemIds(){return this.accordionItems.map(e=>e.getAttribute("id"))}isSingleExpandMode(){return this.expandmode===i2.single}adjust(e){this.activeItemIndex=JT(0,this.accordionItems.length-1,this.activeItemIndex+e),this.focusItem()}focusItem(){let e=this.accordionItems[this.activeItemIndex];e instanceof gn&&e.expandbutton.focus()}};w([C({attribute:"expand-mode"})],jc.prototype,"expandmode",void 0);w([I],jc.prototype,"accordionItems",void 0)});var s2=y(()=>{l();c();d();$T();n2()});var em,Ky=y(()=>{l();c();d();A();Mt();em=(r,e)=>O`
    <a
        class="control"
        part="control"
        download="${t=>t.download}"
        href="${t=>t.href}"
        hreflang="${t=>t.hreflang}"
        ping="${t=>t.ping}"
        referrerpolicy="${t=>t.referrerpolicy}"
        rel="${t=>t.rel}"
        target="${t=>t.target}"
        type="${t=>t.type}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${Ie("control")}
    >
        ${kt(r,e)}
        <span class="content" part="content">
            <slot ${Le("defaultSlottedContent")}></slot>
        </span>
        ${xt(r,e)}
    </a>
`});var ut,Bu=y(()=>{l();c();d();$e();A();ut=class{};w([C({attribute:"aria-atomic"})],ut.prototype,"ariaAtomic",void 0);w([C({attribute:"aria-busy"})],ut.prototype,"ariaBusy",void 0);w([C({attribute:"aria-controls"})],ut.prototype,"ariaControls",void 0);w([C({attribute:"aria-current"})],ut.prototype,"ariaCurrent",void 0);w([C({attribute:"aria-describedby"})],ut.prototype,"ariaDescribedby",void 0);w([C({attribute:"aria-details"})],ut.prototype,"ariaDetails",void 0);w([C({attribute:"aria-disabled"})],ut.prototype,"ariaDisabled",void 0);w([C({attribute:"aria-errormessage"})],ut.prototype,"ariaErrormessage",void 0);w([C({attribute:"aria-flowto"})],ut.prototype,"ariaFlowto",void 0);w([C({attribute:"aria-haspopup"})],ut.prototype,"ariaHaspopup",void 0);w([C({attribute:"aria-hidden"})],ut.prototype,"ariaHidden",void 0);w([C({attribute:"aria-invalid"})],ut.prototype,"ariaInvalid",void 0);w([C({attribute:"aria-keyshortcuts"})],ut.prototype,"ariaKeyshortcuts",void 0);w([C({attribute:"aria-label"})],ut.prototype,"ariaLabel",void 0);w([C({attribute:"aria-labelledby"})],ut.prototype,"ariaLabelledby",void 0);w([C({attribute:"aria-live"})],ut.prototype,"ariaLive",void 0);w([C({attribute:"aria-owns"})],ut.prototype,"ariaOwns",void 0);w([C({attribute:"aria-relevant"})],ut.prototype,"ariaRelevant",void 0);w([C({attribute:"aria-roledescription"})],ut.prototype,"ariaRoledescription",void 0)});var Dl=y(()=>{l();c();d();Bu();Mt()});var ho,Ll,Wy=y(()=>{l();c();d();$e();A();Ue();Dl();jr();ho=class extends q{constructor(){super(...arguments),this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(!((e=this.$fastController.definition.shadowOptions)===null||e===void 0)&&e.delegatesFocus)&&(this.focus=()=>{var t;(t=this.control)===null||t===void 0||t.focus()})}}connectedCallback(){super.connectedCallback(),this.handleUnsupportedDelegatesFocus()}};w([C],ho.prototype,"download",void 0);w([C],ho.prototype,"href",void 0);w([C],ho.prototype,"hreflang",void 0);w([C],ho.prototype,"ping",void 0);w([C],ho.prototype,"referrerpolicy",void 0);w([C],ho.prototype,"rel",void 0);w([C],ho.prototype,"target",void 0);w([C],ho.prototype,"type",void 0);w([I],ho.prototype,"defaultSlottedContent",void 0);Ll=class{};w([C({attribute:"aria-expanded"})],Ll.prototype,"ariaExpanded",void 0);Ye(Ll,ut);Ye(ho,_t,Ll)});var a2=y(()=>{l();c();d();Ky();Wy()});var l2,c2=y(()=>{l();c();d();A();l2=(r,e)=>O`
    <template class="${t=>t.initialLayoutComplete?"loaded":""}">
        ${Xe(t=>t.initialLayoutComplete,O`
                <slot></slot>
            `)}
    </template>
`});var vi,Sa=y(()=>{l();c();d();be();vi=r=>{let e=r.closest("[dir]");return e!==null&&e.dir==="rtl"?ot.rtl:ot.ltr}});var tm,d2=y(()=>{l();c();d();A();tm=class{constructor(){this.intersectionDetector=null,this.observedElements=new Map,this.requestPosition=(e,t)=>{var o;if(this.intersectionDetector!==null){if(this.observedElements.has(e)){(o=this.observedElements.get(e))===null||o===void 0||o.push(t);return}this.observedElements.set(e,[t]),this.intersectionDetector.observe(e)}},this.cancelRequestPosition=(e,t)=>{let o=this.observedElements.get(e);if(o!==void 0){let i=o.indexOf(t);i!==-1&&o.splice(i,1)}},this.initializeIntersectionDetector=()=>{mn.IntersectionObserver&&(this.intersectionDetector=new IntersectionObserver(this.handleIntersection,{root:null,rootMargin:"0px",threshold:[0,1]}))},this.handleIntersection=e=>{if(this.intersectionDetector===null)return;let t=[],o=[];e.forEach(i=>{var n;(n=this.intersectionDetector)===null||n===void 0||n.unobserve(i.target);let s=this.observedElements.get(i.target);s!==void 0&&(s.forEach(a=>{let u=t.indexOf(a);u===-1&&(u=t.length,t.push(a),o.push([])),o[u].push(i)}),this.observedElements.delete(i.target))}),t.forEach((i,n)=>{i(o[n])})},this.initializeIntersectionDetector()}}});var Fe,zu=y(()=>{l();c();d();$e();A();be();Ue();Sa();d2();Fe=class r extends q{constructor(){super(...arguments),this.anchor="",this.viewport="",this.horizontalPositioningMode="uncontrolled",this.horizontalDefaultPosition="unset",this.horizontalViewportLock=!1,this.horizontalInset=!1,this.horizontalScaling="content",this.verticalPositioningMode="uncontrolled",this.verticalDefaultPosition="unset",this.verticalViewportLock=!1,this.verticalInset=!1,this.verticalScaling="content",this.fixedPlacement=!1,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.initialLayoutComplete=!1,this.resizeDetector=null,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.pendingPositioningUpdate=!1,this.pendingReset=!1,this.currentDirection=ot.ltr,this.regionVisible=!1,this.forceUpdate=!1,this.updateThreshold=.5,this.update=()=>{this.pendingPositioningUpdate||this.requestPositionUpdates()},this.startObservers=()=>{this.stopObservers(),this.anchorElement!==null&&(this.requestPositionUpdates(),this.resizeDetector!==null&&(this.resizeDetector.observe(this.anchorElement),this.resizeDetector.observe(this)))},this.requestPositionUpdates=()=>{this.anchorElement===null||this.pendingPositioningUpdate||(r.intersectionService.requestPosition(this,this.handleIntersection),r.intersectionService.requestPosition(this.anchorElement,this.handleIntersection),this.viewportElement!==null&&r.intersectionService.requestPosition(this.viewportElement,this.handleIntersection),this.pendingPositioningUpdate=!0)},this.stopObservers=()=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,r.intersectionService.cancelRequestPosition(this,this.handleIntersection),this.anchorElement!==null&&r.intersectionService.cancelRequestPosition(this.anchorElement,this.handleIntersection),this.viewportElement!==null&&r.intersectionService.cancelRequestPosition(this.viewportElement,this.handleIntersection)),this.resizeDetector!==null&&this.resizeDetector.disconnect()},this.getViewport=()=>typeof this.viewport!="string"||this.viewport===""?document.documentElement:document.getElementById(this.viewport),this.getAnchor=()=>document.getElementById(this.anchor),this.handleIntersection=e=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,this.applyIntersectionEntries(e)&&this.updateLayout())},this.applyIntersectionEntries=e=>{let t=e.find(n=>n.target===this),o=e.find(n=>n.target===this.anchorElement),i=e.find(n=>n.target===this.viewportElement);return t===void 0||i===void 0||o===void 0?!1:!this.regionVisible||this.forceUpdate||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0||this.isRectDifferent(this.anchorRect,o.boundingClientRect)||this.isRectDifferent(this.viewportRect,i.boundingClientRect)||this.isRectDifferent(this.regionRect,t.boundingClientRect)?(this.regionRect=t.boundingClientRect,this.anchorRect=o.boundingClientRect,this.viewportElement===document.documentElement?this.viewportRect=new DOMRectReadOnly(i.boundingClientRect.x+document.documentElement.scrollLeft,i.boundingClientRect.y+document.documentElement.scrollTop,i.boundingClientRect.width,i.boundingClientRect.height):this.viewportRect=i.boundingClientRect,this.updateRegionOffset(),this.forceUpdate=!1,!0):!1},this.updateRegionOffset=()=>{this.anchorRect&&this.regionRect&&(this.baseHorizontalOffset=this.baseHorizontalOffset+(this.anchorRect.left-this.regionRect.left)+(this.translateX-this.baseHorizontalOffset),this.baseVerticalOffset=this.baseVerticalOffset+(this.anchorRect.top-this.regionRect.top)+(this.translateY-this.baseVerticalOffset))},this.isRectDifferent=(e,t)=>Math.abs(e.top-t.top)>this.updateThreshold||Math.abs(e.right-t.right)>this.updateThreshold||Math.abs(e.bottom-t.bottom)>this.updateThreshold||Math.abs(e.left-t.left)>this.updateThreshold,this.handleResize=e=>{this.update()},this.reset=()=>{this.pendingReset&&(this.pendingReset=!1,this.anchorElement===null&&(this.anchorElement=this.getAnchor()),this.viewportElement===null&&(this.viewportElement=this.getViewport()),this.currentDirection=vi(this),this.startObservers())},this.updateLayout=()=>{let e,t;if(this.horizontalPositioningMode!=="uncontrolled"){let n=this.getPositioningOptions(this.horizontalInset);if(this.horizontalDefaultPosition==="center")t="center";else if(this.horizontalDefaultPosition!=="unset"){let b=this.horizontalDefaultPosition;if(b==="start"||b==="end"){let x=vi(this);if(x!==this.currentDirection){this.currentDirection=x,this.initialize();return}this.currentDirection===ot.ltr?b=b==="start"?"left":"right":b=b==="start"?"right":"left"}switch(b){case"left":t=this.horizontalInset?"insetStart":"start";break;case"right":t=this.horizontalInset?"insetEnd":"end";break}}let s=this.horizontalThreshold!==void 0?this.horizontalThreshold:this.regionRect!==void 0?this.regionRect.width:0,a=this.anchorRect!==void 0?this.anchorRect.left:0,u=this.anchorRect!==void 0?this.anchorRect.right:0,h=this.anchorRect!==void 0?this.anchorRect.width:0,p=this.viewportRect!==void 0?this.viewportRect.left:0,f=this.viewportRect!==void 0?this.viewportRect.right:0;(t===void 0||this.horizontalPositioningMode!=="locktodefault"&&this.getAvailableSpace(t,a,u,h,p,f)<s)&&(t=this.getAvailableSpace(n[0],a,u,h,p,f)>this.getAvailableSpace(n[1],a,u,h,p,f)?n[0]:n[1])}if(this.verticalPositioningMode!=="uncontrolled"){let n=this.getPositioningOptions(this.verticalInset);if(this.verticalDefaultPosition==="center")e="center";else if(this.verticalDefaultPosition!=="unset")switch(this.verticalDefaultPosition){case"top":e=this.verticalInset?"insetStart":"start";break;case"bottom":e=this.verticalInset?"insetEnd":"end";break}let s=this.verticalThreshold!==void 0?this.verticalThreshold:this.regionRect!==void 0?this.regionRect.height:0,a=this.anchorRect!==void 0?this.anchorRect.top:0,u=this.anchorRect!==void 0?this.anchorRect.bottom:0,h=this.anchorRect!==void 0?this.anchorRect.height:0,p=this.viewportRect!==void 0?this.viewportRect.top:0,f=this.viewportRect!==void 0?this.viewportRect.bottom:0;(e===void 0||this.verticalPositioningMode!=="locktodefault"&&this.getAvailableSpace(e,a,u,h,p,f)<s)&&(e=this.getAvailableSpace(n[0],a,u,h,p,f)>this.getAvailableSpace(n[1],a,u,h,p,f)?n[0]:n[1])}let o=this.getNextRegionDimension(t,e),i=this.horizontalPosition!==t||this.verticalPosition!==e;if(this.setHorizontalPosition(t,o),this.setVerticalPosition(e,o),this.updateRegionStyle(),!this.initialLayoutComplete){this.initialLayoutComplete=!0,this.requestPositionUpdates();return}this.regionVisible||(this.regionVisible=!0,this.style.removeProperty("pointer-events"),this.style.removeProperty("opacity"),this.classList.toggle("loaded",!0),this.$emit("loaded",this,{bubbles:!1})),this.updatePositionClasses(),i&&this.$emit("positionchange",this,{bubbles:!1})},this.updateRegionStyle=()=>{this.style.width=this.regionWidth,this.style.height=this.regionHeight,this.style.transform=`translate(${this.translateX}px, ${this.translateY}px)`},this.updatePositionClasses=()=>{this.classList.toggle("top",this.verticalPosition==="start"),this.classList.toggle("bottom",this.verticalPosition==="end"),this.classList.toggle("inset-top",this.verticalPosition==="insetStart"),this.classList.toggle("inset-bottom",this.verticalPosition==="insetEnd"),this.classList.toggle("vertical-center",this.verticalPosition==="center"),this.classList.toggle("left",this.horizontalPosition==="start"),this.classList.toggle("right",this.horizontalPosition==="end"),this.classList.toggle("inset-left",this.horizontalPosition==="insetStart"),this.classList.toggle("inset-right",this.horizontalPosition==="insetEnd"),this.classList.toggle("horizontal-center",this.horizontalPosition==="center")},this.setHorizontalPosition=(e,t)=>{if(e===void 0||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0)return;let o=0;switch(this.horizontalScaling){case"anchor":case"fill":o=this.horizontalViewportLock?this.viewportRect.width:t.width,this.regionWidth=`${o}px`;break;case"content":o=this.regionRect.width,this.regionWidth="unset";break}let i=0;switch(e){case"start":this.translateX=this.baseHorizontalOffset-o,this.horizontalViewportLock&&this.anchorRect.left>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.right));break;case"insetStart":this.translateX=this.baseHorizontalOffset-o+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.right));break;case"insetEnd":this.translateX=this.baseHorizontalOffset,this.horizontalViewportLock&&this.anchorRect.left<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.left));break;case"end":this.translateX=this.baseHorizontalOffset+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.left));break;case"center":if(i=(this.anchorRect.width-o)/2,this.translateX=this.baseHorizontalOffset+i,this.horizontalViewportLock){let n=this.anchorRect.left+i,s=this.anchorRect.right-i;n<this.viewportRect.left&&!(s>this.viewportRect.right)?this.translateX=this.translateX-(n-this.viewportRect.left):s>this.viewportRect.right&&!(n<this.viewportRect.left)&&(this.translateX=this.translateX-(s-this.viewportRect.right))}break}this.horizontalPosition=e},this.setVerticalPosition=(e,t)=>{if(e===void 0||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0)return;let o=0;switch(this.verticalScaling){case"anchor":case"fill":o=this.verticalViewportLock?this.viewportRect.height:t.height,this.regionHeight=`${o}px`;break;case"content":o=this.regionRect.height,this.regionHeight="unset";break}let i=0;switch(e){case"start":this.translateY=this.baseVerticalOffset-o,this.verticalViewportLock&&this.anchorRect.top>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.bottom));break;case"insetStart":this.translateY=this.baseVerticalOffset-o+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.bottom));break;case"insetEnd":this.translateY=this.baseVerticalOffset,this.verticalViewportLock&&this.anchorRect.top<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.top));break;case"end":this.translateY=this.baseVerticalOffset+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.top));break;case"center":if(i=(this.anchorRect.height-o)/2,this.translateY=this.baseVerticalOffset+i,this.verticalViewportLock){let n=this.anchorRect.top+i,s=this.anchorRect.bottom-i;n<this.viewportRect.top&&!(s>this.viewportRect.bottom)?this.translateY=this.translateY-(n-this.viewportRect.top):s>this.viewportRect.bottom&&!(n<this.viewportRect.top)&&(this.translateY=this.translateY-(s-this.viewportRect.bottom))}}this.verticalPosition=e},this.getPositioningOptions=e=>e?["insetStart","insetEnd"]:["start","end"],this.getAvailableSpace=(e,t,o,i,n,s)=>{let a=t-n,u=s-(t+i);switch(e){case"start":return a;case"insetStart":return a+i;case"insetEnd":return u+i;case"end":return u;case"center":return Math.min(a,u)*2+i}},this.getNextRegionDimension=(e,t)=>{let o={height:this.regionRect!==void 0?this.regionRect.height:0,width:this.regionRect!==void 0?this.regionRect.width:0};return e!==void 0&&this.horizontalScaling==="fill"?o.width=this.getAvailableSpace(e,this.anchorRect!==void 0?this.anchorRect.left:0,this.anchorRect!==void 0?this.anchorRect.right:0,this.anchorRect!==void 0?this.anchorRect.width:0,this.viewportRect!==void 0?this.viewportRect.left:0,this.viewportRect!==void 0?this.viewportRect.right:0):this.horizontalScaling==="anchor"&&(o.width=this.anchorRect!==void 0?this.anchorRect.width:0),t!==void 0&&this.verticalScaling==="fill"?o.height=this.getAvailableSpace(t,this.anchorRect!==void 0?this.anchorRect.top:0,this.anchorRect!==void 0?this.anchorRect.bottom:0,this.anchorRect!==void 0?this.anchorRect.height:0,this.viewportRect!==void 0?this.viewportRect.top:0,this.viewportRect!==void 0?this.viewportRect.bottom:0):this.verticalScaling==="anchor"&&(o.height=this.anchorRect!==void 0?this.anchorRect.height:0),o},this.startAutoUpdateEventListeners=()=>{window.addEventListener(qy,this.update,{passive:!0}),window.addEventListener(Gy,this.update,{passive:!0,capture:!0}),this.resizeDetector!==null&&this.viewportElement!==null&&this.resizeDetector.observe(this.viewportElement)},this.stopAutoUpdateEventListeners=()=>{window.removeEventListener(qy,this.update),window.removeEventListener(Gy,this.update),this.resizeDetector!==null&&this.viewportElement!==null&&this.resizeDetector.unobserve(this.viewportElement)}}anchorChanged(){this.initialLayoutComplete&&(this.anchorElement=this.getAnchor())}viewportChanged(){this.initialLayoutComplete&&(this.viewportElement=this.getViewport())}horizontalPositioningModeChanged(){this.requestReset()}horizontalDefaultPositionChanged(){this.updateForAttributeChange()}horizontalViewportLockChanged(){this.updateForAttributeChange()}horizontalInsetChanged(){this.updateForAttributeChange()}horizontalThresholdChanged(){this.updateForAttributeChange()}horizontalScalingChanged(){this.updateForAttributeChange()}verticalPositioningModeChanged(){this.requestReset()}verticalDefaultPositionChanged(){this.updateForAttributeChange()}verticalViewportLockChanged(){this.updateForAttributeChange()}verticalInsetChanged(){this.updateForAttributeChange()}verticalThresholdChanged(){this.updateForAttributeChange()}verticalScalingChanged(){this.updateForAttributeChange()}fixedPlacementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}autoUpdateModeChanged(e,t){this.$fastController.isConnected&&this.initialLayoutComplete&&(e==="auto"&&this.stopAutoUpdateEventListeners(),t==="auto"&&this.startAutoUpdateEventListeners())}anchorElementChanged(){this.requestReset()}viewportElementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}connectedCallback(){super.connectedCallback(),this.autoUpdateMode==="auto"&&this.startAutoUpdateEventListeners(),this.initialize()}disconnectedCallback(){super.disconnectedCallback(),this.autoUpdateMode==="auto"&&this.stopAutoUpdateEventListeners(),this.stopObservers(),this.disconnectResizeDetector()}adoptedCallback(){this.initialize()}disconnectResizeDetector(){this.resizeDetector!==null&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.handleResize)}updateForAttributeChange(){this.$fastController.isConnected&&this.initialLayoutComplete&&(this.forceUpdate=!0,this.update())}initialize(){this.initializeResizeDetector(),this.anchorElement===null&&(this.anchorElement=this.getAnchor()),this.requestReset()}requestReset(){this.$fastController.isConnected&&this.pendingReset===!1&&(this.setInitialState(),Z.queueUpdate(()=>this.reset()),this.pendingReset=!0)}setInitialState(){this.initialLayoutComplete=!1,this.regionVisible=!1,this.translateX=0,this.translateY=0,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.viewportRect=void 0,this.regionRect=void 0,this.anchorRect=void 0,this.verticalPosition=void 0,this.horizontalPosition=void 0,this.style.opacity="0",this.style.pointerEvents="none",this.forceUpdate=!1,this.style.position=this.fixedPlacement?"fixed":"absolute",this.updatePositionClasses(),this.updateRegionStyle()}};Fe.intersectionService=new tm;w([C],Fe.prototype,"anchor",void 0);w([C],Fe.prototype,"viewport",void 0);w([C({attribute:"horizontal-positioning-mode"})],Fe.prototype,"horizontalPositioningMode",void 0);w([C({attribute:"horizontal-default-position"})],Fe.prototype,"horizontalDefaultPosition",void 0);w([C({attribute:"horizontal-viewport-lock",mode:"boolean"})],Fe.prototype,"horizontalViewportLock",void 0);w([C({attribute:"horizontal-inset",mode:"boolean"})],Fe.prototype,"horizontalInset",void 0);w([C({attribute:"horizontal-threshold"})],Fe.prototype,"horizontalThreshold",void 0);w([C({attribute:"horizontal-scaling"})],Fe.prototype,"horizontalScaling",void 0);w([C({attribute:"vertical-positioning-mode"})],Fe.prototype,"verticalPositioningMode",void 0);w([C({attribute:"vertical-default-position"})],Fe.prototype,"verticalDefaultPosition",void 0);w([C({attribute:"vertical-viewport-lock",mode:"boolean"})],Fe.prototype,"verticalViewportLock",void 0);w([C({attribute:"vertical-inset",mode:"boolean"})],Fe.prototype,"verticalInset",void 0);w([C({attribute:"vertical-threshold"})],Fe.prototype,"verticalThreshold",void 0);w([C({attribute:"vertical-scaling"})],Fe.prototype,"verticalScaling",void 0);w([C({attribute:"fixed-placement",mode:"boolean"})],Fe.prototype,"fixedPlacement",void 0);w([C({attribute:"auto-update-mode"})],Fe.prototype,"autoUpdateMode",void 0);w([I],Fe.prototype,"anchorElement",void 0);w([I],Fe.prototype,"viewportElement",void 0);w([I],Fe.prototype,"initialLayoutComplete",void 0)});var Qy,Yy,Zy,Jy,u2,Xy,h2,p2=y(()=>{l();c();d();Qy={horizontalDefaultPosition:"center",horizontalPositioningMode:"locktodefault",horizontalInset:!1,horizontalScaling:"anchor"},Yy=Object.assign(Object.assign({},Qy),{verticalDefaultPosition:"top",verticalPositioningMode:"locktodefault",verticalInset:!1,verticalScaling:"content"}),Zy=Object.assign(Object.assign({},Qy),{verticalDefaultPosition:"bottom",verticalPositioningMode:"locktodefault",verticalInset:!1,verticalScaling:"content"}),Jy=Object.assign(Object.assign({},Qy),{verticalPositioningMode:"dynamic",verticalInset:!1,verticalScaling:"content"}),u2=Object.assign(Object.assign({},Yy),{verticalScaling:"fill"}),Xy=Object.assign(Object.assign({},Zy),{verticalScaling:"fill"}),h2=Object.assign(Object.assign({},Jy),{verticalScaling:"fill"})});var eb=y(()=>{l();c();d();c2();zu();p2()});var f2=y(()=>{l();c();d();A()});var Kc,m2=y(()=>{l();c();d();$e();A();Ue();Kc=class extends q{connectedCallback(){super.connectedCallback(),this.shape||(this.shape="circle")}};w([C],Kc.prototype,"fill",void 0);w([C],Kc.prototype,"color",void 0);w([C],Kc.prototype,"link",void 0);w([C],Kc.prototype,"shape",void 0)});var g2=y(()=>{l();c();d();f2();m2()});var v2,y2=y(()=>{l();c();d();A();v2=(r,e)=>O`
    <template class="${t=>t.circular?"circular":""}">
        <div class="control" part="control" style="${t=>t.generateBadgeStyle()}">
            <slot></slot>
        </div>
    </template>
`});var _a,b2=y(()=>{l();c();d();$e();A();Ue();_a=class extends q{constructor(){super(...arguments),this.generateBadgeStyle=()=>{if(!this.fill&&!this.color)return;let e=`background-color: var(--badge-fill-${this.fill});`,t=`color: var(--badge-color-${this.color});`;return this.fill&&!this.color?e:this.color&&!this.fill?t:`${t} ${e}`}}};w([C({attribute:"fill"})],_a.prototype,"fill",void 0);w([C({attribute:"color"})],_a.prototype,"color",void 0);w([C({mode:"boolean"})],_a.prototype,"circular",void 0)});var w2=y(()=>{l();c();d();y2();b2()});var C2,x2=y(()=>{l();c();d();A();Ky();Mt();C2=(r,e)=>O`
    <div role="listitem" class="listitem" part="listitem">
        ${Xe(t=>t.href&&t.href.length>0,O`
                ${em(r,e)}
            `)}
        ${Xe(t=>!t.href,O`
                ${kt(r,e)}
                <slot></slot>
                ${xt(r,e)}
            `)}
        ${Xe(t=>t.separator,O`
                <span class="separator" part="separator" aria-hidden="true">
                    <slot name="separator">${e.separator||""}</slot>
                </span>
            `)}
    </div>
`});var Ps,tb=y(()=>{l();c();d();$e();A();Wy();Dl();jr();Ps=class extends ho{constructor(){super(...arguments),this.separator=!0}};w([I],Ps.prototype,"separator",void 0);Ye(Ps,_t,Ll)});var k2=y(()=>{l();c();d();x2();tb()});var S2,_2=y(()=>{l();c();d();A();S2=(r,e)=>O`
    <template role="navigation">
        <div role="list" class="list" part="list">
            <slot
                ${Le({property:"slottedBreadcrumbItems",filter:Gr()})}
            ></slot>
        </div>
    </template>
`});var Vu,T2=y(()=>{l();c();d();$e();A();tb();Ue();Vu=class extends q{slottedBreadcrumbItemsChanged(){if(this.$fastController.isConnected){if(this.slottedBreadcrumbItems===void 0||this.slottedBreadcrumbItems.length===0)return;let e=this.slottedBreadcrumbItems[this.slottedBreadcrumbItems.length-1];this.slottedBreadcrumbItems.forEach(t=>{let o=t===e;this.setItemSeparator(t,o),this.setAriaCurrent(t,o)})}}setItemSeparator(e,t){e instanceof Ps&&(e.separator=!t)}findChildWithHref(e){var t,o;return e.childElementCount>0?e.querySelector("a[href]"):!((t=e.shadowRoot)===null||t===void 0)&&t.childElementCount?(o=e.shadowRoot)===null||o===void 0?void 0:o.querySelector("a[href]"):null}setAriaCurrent(e,t){let o=this.findChildWithHref(e);o===null&&e.hasAttribute("href")&&e instanceof Ps?t?e.setAttribute("aria-current","page"):e.removeAttribute("aria-current"):o!==null&&(t?o.setAttribute("aria-current","page"):o.removeAttribute("aria-current"))}};w([I],Vu.prototype,"slottedBreadcrumbItems",void 0)});var E2=y(()=>{l();c();d();_2();T2()});var I2,A2=y(()=>{l();c();d();A();Mt();I2=(r,e)=>O`
    <button
        class="control"
        part="control"
        ?autofocus="${t=>t.autofocus}"
        ?disabled="${t=>t.disabled}"
        form="${t=>t.formId}"
        formaction="${t=>t.formaction}"
        formenctype="${t=>t.formenctype}"
        formmethod="${t=>t.formmethod}"
        formnovalidate="${t=>t.formnovalidate}"
        formtarget="${t=>t.formtarget}"
        name="${t=>t.name}"
        type="${t=>t.type}"
        value="${t=>t.value}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-pressed="${t=>t.ariaPressed}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${Ie("control")}
    >
        ${kt(r,e)}
        <span class="content" part="content">
            <slot ${Le("defaultSlottedContent")}></slot>
        </span>
        ${xt(r,e)}
    </button>
`});function Or(r){let e=class extends r{constructor(...t){super(...t),this.dirtyValue=!1,this.disabled=!1,this.proxyEventsToBlock=["change","click"],this.proxyInitialized=!1,this.required=!1,this.initialValue=this.initialValue||"",this.elementInternals||(this.formResetCallback=this.formResetCallback.bind(this))}static get formAssociated(){return $2}get validity(){return this.elementInternals?this.elementInternals.validity:this.proxy.validity}get form(){return this.elementInternals?this.elementInternals.form:this.proxy.form}get validationMessage(){return this.elementInternals?this.elementInternals.validationMessage:this.proxy.validationMessage}get willValidate(){return this.elementInternals?this.elementInternals.willValidate:this.proxy.willValidate}get labels(){if(this.elementInternals)return Object.freeze(Array.from(this.elementInternals.labels));if(this.proxy instanceof HTMLElement&&this.proxy.ownerDocument&&this.id){let t=this.proxy.labels,o=Array.from(this.proxy.getRootNode().querySelectorAll(`[for='${this.id}']`)),i=t?o.concat(Array.from(t)):o;return Object.freeze(i)}else return $i}valueChanged(t,o){this.dirtyValue=!0,this.proxy instanceof HTMLElement&&(this.proxy.value=this.value),this.currentValue=this.value,this.setFormValue(this.value),this.validate()}currentValueChanged(){this.value=this.currentValue}initialValueChanged(t,o){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}disabledChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.disabled=this.disabled),Z.queueUpdate(()=>this.classList.toggle("disabled",this.disabled))}nameChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.name=this.name)}requiredChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.required=this.required),Z.queueUpdate(()=>this.classList.toggle("required",this.required)),this.validate()}get elementInternals(){if(!$2)return null;let t=O2.get(this);return t||(t=this.attachInternals(),O2.set(this,t)),t}connectedCallback(){super.connectedCallback(),this.addEventListener("keypress",this._keypressHandler),this.value||(this.value=this.initialValue,this.dirtyValue=!1),this.elementInternals||(this.attachProxy(),this.form&&this.form.addEventListener("reset",this.formResetCallback))}disconnectedCallback(){this.proxyEventsToBlock.forEach(t=>this.proxy.removeEventListener(t,this.stopPropagation)),!this.elementInternals&&this.form&&this.form.removeEventListener("reset",this.formResetCallback)}checkValidity(){return this.elementInternals?this.elementInternals.checkValidity():this.proxy.checkValidity()}reportValidity(){return this.elementInternals?this.elementInternals.reportValidity():this.proxy.reportValidity()}setValidity(t,o,i){this.elementInternals?this.elementInternals.setValidity(t,o,i):typeof o=="string"&&this.proxy.setCustomValidity(o)}formDisabledCallback(t){this.disabled=t}formResetCallback(){this.value=this.initialValue,this.dirtyValue=!1}attachProxy(){var t;this.proxyInitialized||(this.proxyInitialized=!0,this.proxy.style.display="none",this.proxyEventsToBlock.forEach(o=>this.proxy.addEventListener(o,this.stopPropagation)),this.proxy.disabled=this.disabled,this.proxy.required=this.required,typeof this.name=="string"&&(this.proxy.name=this.name),typeof this.value=="string"&&(this.proxy.value=this.value),this.proxy.setAttribute("slot",R2),this.proxySlot=document.createElement("slot"),this.proxySlot.setAttribute("name",R2)),(t=this.shadowRoot)===null||t===void 0||t.appendChild(this.proxySlot),this.appendChild(this.proxy)}detachProxy(){var t;this.removeChild(this.proxy),(t=this.shadowRoot)===null||t===void 0||t.removeChild(this.proxySlot)}validate(t){this.proxy instanceof HTMLElement&&this.setValidity(this.proxy.validity,this.proxy.validationMessage,t)}setFormValue(t,o){this.elementInternals&&this.elementInternals.setFormValue(t,o||t)}_keypressHandler(t){switch(t.key){case dr:if(this.form instanceof HTMLFormElement){let o=this.form.querySelector("[type=submit]");o?.click()}break}}stopPropagation(t){t.stopPropagation()}};return C({mode:"boolean"})(e.prototype,"disabled"),C({mode:"fromView",attribute:"value"})(e.prototype,"initialValue"),C({attribute:"current-value"})(e.prototype,"currentValue"),C(e.prototype,"name"),C({mode:"boolean"})(e.prototype,"required"),I(e.prototype,"value"),e}function Wc(r){class e extends Or(r){}class t extends e{constructor(...i){super(i),this.dirtyChecked=!1,this.checkedAttribute=!1,this.checked=!1,this.dirtyChecked=!1}checkedAttributeChanged(){this.defaultChecked=this.checkedAttribute}defaultCheckedChanged(){this.dirtyChecked||(this.checked=this.defaultChecked,this.dirtyChecked=!1)}checkedChanged(i,n){this.dirtyChecked||(this.dirtyChecked=!0),this.currentChecked=this.checked,this.updateForm(),this.proxy instanceof HTMLInputElement&&(this.proxy.checked=this.checked),i!==void 0&&this.$emit("change"),this.validate()}currentCheckedChanged(i,n){this.checked=this.currentChecked}updateForm(){let i=this.checked?this.value:null;this.setFormValue(i,i)}connectedCallback(){super.connectedCallback(),this.updateForm()}formResetCallback(){super.formResetCallback(),this.checked=!!this.checkedAttribute,this.dirtyChecked=!1}}return C({attribute:"checked",mode:"boolean"})(t.prototype,"checkedAttribute"),C({attribute:"current-checked",converter:Is})(t.prototype,"currentChecked"),I(t.prototype,"defaultChecked"),I(t.prototype,"checked"),t}var R2,P2,$2,O2,Jo=y(()=>{l();c();d();A();be();R2="form-associated-proxy",P2="ElementInternals",$2=P2 in window&&"setFormValue"in window[P2].prototype,O2=new WeakMap});var rb,rm,M2=y(()=>{l();c();d();Jo();Ue();rb=class extends q{},rm=class extends Or(rb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var po,Qc,F2=y(()=>{l();c();d();$e();A();Dl();jr();M2();po=class extends rm{constructor(){super(...arguments),this.handleClick=e=>{var t;this.disabled&&((t=this.defaultSlottedContent)===null||t===void 0?void 0:t.length)<=1&&e.stopPropagation()},this.handleSubmission=()=>{if(!this.form)return;let e=this.proxy.isConnected;e||this.attachProxy(),typeof this.form.requestSubmit=="function"?this.form.requestSubmit(this.proxy):this.proxy.click(),e||this.detachProxy()},this.handleFormReset=()=>{var e;(e=this.form)===null||e===void 0||e.reset()},this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(!((e=this.$fastController.definition.shadowOptions)===null||e===void 0)&&e.delegatesFocus)&&(this.focus=()=>{this.control.focus()})}}formactionChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formAction=this.formaction)}formenctypeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formEnctype=this.formenctype)}formmethodChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formMethod=this.formmethod)}formnovalidateChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formNoValidate=this.formnovalidate)}formtargetChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formTarget=this.formtarget)}typeChanged(e,t){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type),t==="submit"&&this.addEventListener("click",this.handleSubmission),e==="submit"&&this.removeEventListener("click",this.handleSubmission),t==="reset"&&this.addEventListener("click",this.handleFormReset),e==="reset"&&this.removeEventListener("click",this.handleFormReset)}validate(){super.validate(this.control)}connectedCallback(){var e;super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.handleUnsupportedDelegatesFocus();let t=Array.from((e=this.control)===null||e===void 0?void 0:e.children);t&&t.forEach(o=>{o.addEventListener("click",this.handleClick)})}disconnectedCallback(){var e;super.disconnectedCallback();let t=Array.from((e=this.control)===null||e===void 0?void 0:e.children);t&&t.forEach(o=>{o.removeEventListener("click",this.handleClick)})}};w([C({mode:"boolean"})],po.prototype,"autofocus",void 0);w([C({attribute:"form"})],po.prototype,"formId",void 0);w([C],po.prototype,"formaction",void 0);w([C],po.prototype,"formenctype",void 0);w([C],po.prototype,"formmethod",void 0);w([C({mode:"boolean"})],po.prototype,"formnovalidate",void 0);w([C],po.prototype,"formtarget",void 0);w([C],po.prototype,"type",void 0);w([I],po.prototype,"defaultSlottedContent",void 0);Qc=class{};w([C({attribute:"aria-expanded"})],Qc.prototype,"ariaExpanded",void 0);w([C({attribute:"aria-pressed"})],Qc.prototype,"ariaPressed",void 0);Ye(Qc,ut);Ye(po,_t,Qc)});var D2=y(()=>{l();c();d();A2();F2()});var om,ob=y(()=>{l();c();d();om=class{constructor(e){if(this.dayFormat="numeric",this.weekdayFormat="long",this.monthFormat="long",this.yearFormat="numeric",this.date=new Date,e)for(let t in e){let o=e[t];t==="date"?this.date=this.getDateObject(o):this[t]=o}}getDateObject(e){if(typeof e=="string"){let t=e.split(/[/-]/);return t.length<3?new Date:new Date(parseInt(t[2],10),parseInt(t[0],10)-1,parseInt(t[1],10))}else if("day"in e&&"month"in e&&"year"in e){let{day:t,month:o,year:i}=e;return new Date(i,o-1,t)}return e}getDate(e=this.date,t={weekday:this.weekdayFormat,month:this.monthFormat,day:this.dayFormat,year:this.yearFormat},o=this.locale){let i=this.getDateObject(e);if(!i.getTime())return"";let n=Object.assign({timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},t);return new Intl.DateTimeFormat(o,n).format(i)}getDay(e=this.date.getDate(),t=this.dayFormat,o=this.locale){return this.getDate({month:1,day:e,year:2020},{day:t},o)}getMonth(e=this.date.getMonth()+1,t=this.monthFormat,o=this.locale){return this.getDate({month:e,day:2,year:2020},{month:t},o)}getYear(e=this.date.getFullYear(),t=this.yearFormat,o=this.locale){return this.getDate({month:2,day:2,year:e},{year:t},o)}getWeekday(e=0,t=this.weekdayFormat,o=this.locale){let i=`1-${e+1}-2017`;return this.getDate(i,{weekday:t},o)}getWeekdays(e=this.weekdayFormat,t=this.locale){return Array(7).fill(null).map((o,i)=>this.getWeekday(i,e,t))}}});var Fo,L2=y(()=>{l();c();d();$e();A();be();Ue();ob();Fo=class extends q{constructor(){super(...arguments),this.dateFormatter=new om,this.readonly=!1,this.locale="en-US",this.month=new Date().getMonth()+1,this.year=new Date().getFullYear(),this.dayFormat="numeric",this.weekdayFormat="short",this.monthFormat="long",this.yearFormat="numeric",this.minWeeks=0,this.disabledDates="",this.selectedDates="",this.oneDayInMs=864e5}localeChanged(){this.dateFormatter.locale=this.locale}dayFormatChanged(){this.dateFormatter.dayFormat=this.dayFormat}weekdayFormatChanged(){this.dateFormatter.weekdayFormat=this.weekdayFormat}monthFormatChanged(){this.dateFormatter.monthFormat=this.monthFormat}yearFormatChanged(){this.dateFormatter.yearFormat=this.yearFormat}getMonthInfo(e=this.month,t=this.year){let o=u=>new Date(u.getFullYear(),u.getMonth(),1).getDay(),i=u=>{let h=new Date(u.getFullYear(),u.getMonth()+1,1);return new Date(h.getTime()-this.oneDayInMs).getDate()},n=new Date(t,e-1),s=new Date(t,e),a=new Date(t,e-2);return{length:i(n),month:e,start:o(n),year:t,previous:{length:i(a),month:a.getMonth()+1,start:o(a),year:a.getFullYear()},next:{length:i(s),month:s.getMonth()+1,start:o(s),year:s.getFullYear()}}}getDays(e=this.getMonthInfo(),t=this.minWeeks){t=t>10?10:t;let{start:o,length:i,previous:n,next:s}=e,a=[],u=1-o;for(;u<i+1||a.length<t||a[a.length-1].length%7!==0;){let{month:h,year:p}=u<1?n:u>i?s:e,f=u<1?n.length+u:u>i?u-i:u,b=`${h}-${f}-${p}`,x=this.dateInString(b,this.disabledDates),S=this.dateInString(b,this.selectedDates),R={day:f,month:h,year:p,disabled:x,selected:S},z=a[a.length-1];a.length===0||z.length%7===0?a.push([R]):z.push(R),u++}return a}dateInString(e,t){let o=t.split(",").map(i=>i.trim());return e=typeof e=="string"?e:`${e.getMonth()+1}-${e.getDate()}-${e.getFullYear()}`,o.some(i=>i===e)}getDayClassNames(e,t){let{day:o,month:i,year:n,disabled:s,selected:a}=e,u=t===`${i}-${o}-${n}`,h=this.month!==i;return["day",u&&"today",h&&"inactive",s&&"disabled",a&&"selected"].filter(Boolean).join(" ")}getWeekdayText(){let e=this.dateFormatter.getWeekdays().map(t=>({text:t}));if(this.weekdayFormat!=="long"){let t=this.dateFormatter.getWeekdays("long");e.forEach((o,i)=>{o.abbr=t[i]})}return e}handleDateSelect(e,t){e.preventDefault,this.$emit("dateselected",t)}handleKeydown(e,t){return e.key===dr&&this.handleDateSelect(e,t),!0}};w([C({mode:"boolean"})],Fo.prototype,"readonly",void 0);w([C],Fo.prototype,"locale",void 0);w([C({converter:ie})],Fo.prototype,"month",void 0);w([C({converter:ie})],Fo.prototype,"year",void 0);w([C({attribute:"day-format",mode:"fromView"})],Fo.prototype,"dayFormat",void 0);w([C({attribute:"weekday-format",mode:"fromView"})],Fo.prototype,"weekdayFormat",void 0);w([C({attribute:"month-format",mode:"fromView"})],Fo.prototype,"monthFormat",void 0);w([C({attribute:"year-format",mode:"fromView"})],Fo.prototype,"yearFormat",void 0);w([C({attribute:"min-weeks",converter:ie})],Fo.prototype,"minWeeks",void 0);w([C({attribute:"disabled-dates"})],Fo.prototype,"disabledDates",void 0);w([C({attribute:"selected-dates"})],Fo.prototype,"selectedDates",void 0)});var qu,$s,Nl,im=y(()=>{l();c();d();qu={none:"none",default:"default",sticky:"sticky"},$s={default:"default",columnHeader:"columnheader",rowHeader:"rowheader"},Nl={default:"default",header:"header",stickyHeader:"sticky-header"}});var ur,ib=y(()=>{l();c();d();$e();A();be();Ue();im();ur=class extends q{constructor(){super(...arguments),this.rowType=Nl.default,this.rowData=null,this.columnDefinitions=null,this.isActiveRow=!1,this.cellsRepeatBehavior=null,this.cellsPlaceholder=null,this.focusColumnIndex=0,this.refocusOnLoad=!1,this.updateRowStyle=()=>{this.style.gridTemplateColumns=this.gridTemplateColumns}}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowStyle()}rowTypeChanged(){this.$fastController.isConnected&&this.updateItemTemplate()}rowDataChanged(){if(this.rowData!==null&&this.isActiveRow){this.refocusOnLoad=!0;return}}cellItemTemplateChanged(){this.updateItemTemplate()}headerCellItemTemplateChanged(){this.updateItemTemplate()}connectedCallback(){super.connectedCallback(),this.cellsRepeatBehavior===null&&(this.cellsPlaceholder=document.createComment(""),this.appendChild(this.cellsPlaceholder),this.updateItemTemplate(),this.cellsRepeatBehavior=new Vn(e=>e.columnDefinitions,e=>e.activeCellItemTemplate,{positioning:!0}).createBehavior(this.cellsPlaceholder),this.$fastController.addBehaviors([this.cellsRepeatBehavior])),this.addEventListener("cell-focused",this.handleCellFocus),this.addEventListener(As,this.handleFocusout),this.addEventListener(Rs,this.handleKeydown),this.updateRowStyle(),this.refocusOnLoad&&(this.refocusOnLoad=!1,this.cellElements.length>this.focusColumnIndex&&this.cellElements[this.focusColumnIndex].focus())}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("cell-focused",this.handleCellFocus),this.removeEventListener(As,this.handleFocusout),this.removeEventListener(Rs,this.handleKeydown)}handleFocusout(e){this.contains(e.target)||(this.isActiveRow=!1,this.focusColumnIndex=0)}handleCellFocus(e){this.isActiveRow=!0,this.focusColumnIndex=this.cellElements.indexOf(e.target),this.$emit("row-focused",this)}handleKeydown(e){if(e.defaultPrevented)return;let t=0;switch(e.key){case ko:t=Math.max(0,this.focusColumnIndex-1),this.cellElements[t].focus(),e.preventDefault();break;case So:t=Math.min(this.cellElements.length-1,this.focusColumnIndex+1),this.cellElements[t].focus(),e.preventDefault();break;case Tr:e.ctrlKey||(this.cellElements[0].focus(),e.preventDefault());break;case Er:e.ctrlKey||(this.cellElements[this.cellElements.length-1].focus(),e.preventDefault());break}}updateItemTemplate(){this.activeCellItemTemplate=this.rowType===Nl.default&&this.cellItemTemplate!==void 0?this.cellItemTemplate:this.rowType===Nl.default&&this.cellItemTemplate===void 0?this.defaultCellItemTemplate:this.headerCellItemTemplate!==void 0?this.headerCellItemTemplate:this.defaultHeaderCellItemTemplate}};w([C({attribute:"grid-template-columns"})],ur.prototype,"gridTemplateColumns",void 0);w([C({attribute:"row-type"})],ur.prototype,"rowType",void 0);w([I],ur.prototype,"rowData",void 0);w([I],ur.prototype,"columnDefinitions",void 0);w([I],ur.prototype,"cellItemTemplate",void 0);w([I],ur.prototype,"headerCellItemTemplate",void 0);w([I],ur.prototype,"rowIndex",void 0);w([I],ur.prototype,"isActiveRow",void 0);w([I],ur.prototype,"activeCellItemTemplate",void 0);w([I],ur.prototype,"defaultCellItemTemplate",void 0);w([I],ur.prototype,"defaultHeaderCellItemTemplate",void 0);w([I],ur.prototype,"cellElements",void 0)});function E9(r){let e=r.tagFor(ur);return O`
    <${e}
        :rowData="${t=>t}"
        :cellItemTemplate="${(t,o)=>o.parent.cellItemTemplate}"
        :headerCellItemTemplate="${(t,o)=>o.parent.headerCellItemTemplate}"
    ></${e}>
`}var N2,H2=y(()=>{l();c();d();A();ib();N2=(r,e)=>{let t=E9(r),o=r.tagFor(ur);return O`
        <template
            role="grid"
            tabindex="0"
            :rowElementTag="${()=>o}"
            :defaultRowItemTemplate="${t}"
            ${wa({property:"rowElements",filter:Gr("[role=row]")})}
        >
            <slot></slot>
        </template>
    `}});var Ir,U2=y(()=>{l();c();d();$e();A();be();Ue();im();Ir=class r extends q{constructor(){super(),this.noTabbing=!1,this.generateHeader=qu.default,this.rowsData=[],this.columnDefinitions=null,this.focusRowIndex=0,this.focusColumnIndex=0,this.rowsPlaceholder=null,this.generatedHeader=null,this.isUpdatingFocus=!1,this.pendingFocusUpdate=!1,this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!0,this.generatedGridTemplateColumns="",this.focusOnCell=(e,t,o)=>{if(this.rowElements.length===0){this.focusRowIndex=0,this.focusColumnIndex=0;return}let i=Math.max(0,Math.min(this.rowElements.length-1,e)),s=this.rowElements[i].querySelectorAll('[role="cell"], [role="gridcell"], [role="columnheader"], [role="rowheader"]'),a=Math.max(0,Math.min(s.length-1,t)),u=s[a];o&&this.scrollHeight!==this.clientHeight&&(i<this.focusRowIndex&&this.scrollTop>0||i>this.focusRowIndex&&this.scrollTop<this.scrollHeight-this.clientHeight)&&u.scrollIntoView({block:"center",inline:"center"}),u.focus()},this.onChildListChange=(e,t)=>{e&&e.length&&(e.forEach(o=>{o.addedNodes.forEach(i=>{i.nodeType===1&&i.getAttribute("role")==="row"&&(i.columnDefinitions=this.columnDefinitions)})}),this.queueRowIndexUpdate())},this.queueRowIndexUpdate=()=>{this.rowindexUpdateQueued||(this.rowindexUpdateQueued=!0,Z.queueUpdate(this.updateRowIndexes))},this.updateRowIndexes=()=>{let e=this.gridTemplateColumns;if(e===void 0){if(this.generatedGridTemplateColumns===""&&this.rowElements.length>0){let t=this.rowElements[0];this.generatedGridTemplateColumns=new Array(t.cellElements.length).fill("1fr").join(" ")}e=this.generatedGridTemplateColumns}this.rowElements.forEach((t,o)=>{let i=t;i.rowIndex=o,i.gridTemplateColumns=e,this.columnDefinitionsStale&&(i.columnDefinitions=this.columnDefinitions)}),this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!1}}static generateTemplateColumns(e){let t="";return e.forEach(o=>{t=`${t}${t===""?"":" "}1fr`}),t}noTabbingChanged(){this.$fastController.isConnected&&(this.noTabbing?this.setAttribute("tabIndex","-1"):this.setAttribute("tabIndex",this.contains(document.activeElement)||this===document.activeElement?"-1":"0"))}generateHeaderChanged(){this.$fastController.isConnected&&this.toggleGeneratedHeader()}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowIndexes()}rowsDataChanged(){this.columnDefinitions===null&&this.rowsData.length>0&&(this.columnDefinitions=r.generateColumns(this.rowsData[0])),this.$fastController.isConnected&&this.toggleGeneratedHeader()}columnDefinitionsChanged(){if(this.columnDefinitions===null){this.generatedGridTemplateColumns="";return}this.generatedGridTemplateColumns=r.generateTemplateColumns(this.columnDefinitions),this.$fastController.isConnected&&(this.columnDefinitionsStale=!0,this.queueRowIndexUpdate())}headerCellItemTemplateChanged(){this.$fastController.isConnected&&this.generatedHeader!==null&&(this.generatedHeader.headerCellItemTemplate=this.headerCellItemTemplate)}focusRowIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}focusColumnIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}connectedCallback(){super.connectedCallback(),this.rowItemTemplate===void 0&&(this.rowItemTemplate=this.defaultRowItemTemplate),this.rowsPlaceholder=document.createComment(""),this.appendChild(this.rowsPlaceholder),this.toggleGeneratedHeader(),this.rowsRepeatBehavior=new Vn(e=>e.rowsData,e=>e.rowItemTemplate,{positioning:!0}).createBehavior(this.rowsPlaceholder),this.$fastController.addBehaviors([this.rowsRepeatBehavior]),this.addEventListener("row-focused",this.handleRowFocus),this.addEventListener(zy,this.handleFocus),this.addEventListener(Rs,this.handleKeydown),this.addEventListener(As,this.handleFocusOut),this.observer=new MutationObserver(this.onChildListChange),this.observer.observe(this,{childList:!0}),this.noTabbing&&this.setAttribute("tabindex","-1"),Z.queueUpdate(this.queueRowIndexUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("row-focused",this.handleRowFocus),this.removeEventListener(zy,this.handleFocus),this.removeEventListener(Rs,this.handleKeydown),this.removeEventListener(As,this.handleFocusOut),this.observer.disconnect(),this.rowsPlaceholder=null,this.generatedHeader=null}handleRowFocus(e){this.isUpdatingFocus=!0;let t=e.target;this.focusRowIndex=this.rowElements.indexOf(t),this.focusColumnIndex=t.focusColumnIndex,this.setAttribute("tabIndex","-1"),this.isUpdatingFocus=!1}handleFocus(e){this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}handleFocusOut(e){(e.relatedTarget===null||!this.contains(e.relatedTarget))&&this.setAttribute("tabIndex",this.noTabbing?"-1":"0")}handleKeydown(e){if(e.defaultPrevented)return;let t,o=this.rowElements.length-1,i=this.offsetHeight+this.scrollTop,n=this.rowElements[o];switch(e.key){case Qt:e.preventDefault(),this.focusOnCell(this.focusRowIndex-1,this.focusColumnIndex,!0);break;case Wt:e.preventDefault(),this.focusOnCell(this.focusRowIndex+1,this.focusColumnIndex,!0);break;case WT:if(e.preventDefault(),this.rowElements.length===0){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex===0){this.focusOnCell(0,this.focusColumnIndex,!1);return}for(t=this.focusRowIndex-1,t;t>=0;t--){let s=this.rowElements[t];if(s.offsetTop<this.scrollTop){this.scrollTop=s.offsetTop+s.clientHeight-this.clientHeight;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case KT:if(e.preventDefault(),this.rowElements.length===0){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex>=o||n.offsetTop+n.offsetHeight<=i){this.focusOnCell(o,this.focusColumnIndex,!1);return}for(t=this.focusRowIndex+1,t;t<=o;t++){let s=this.rowElements[t];if(s.offsetTop+s.offsetHeight>i){let a=0;this.generateHeader===qu.sticky&&this.generatedHeader!==null&&(a=this.generatedHeader.clientHeight),this.scrollTop=s.offsetTop-a;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case Tr:e.ctrlKey&&(e.preventDefault(),this.focusOnCell(0,0,!0));break;case Er:e.ctrlKey&&this.columnDefinitions!==null&&(e.preventDefault(),this.focusOnCell(this.rowElements.length-1,this.columnDefinitions.length-1,!0));break}}queueFocusUpdate(){this.isUpdatingFocus&&(this.contains(document.activeElement)||this===document.activeElement)||this.pendingFocusUpdate===!1&&(this.pendingFocusUpdate=!0,Z.queueUpdate(()=>this.updateFocus()))}updateFocus(){this.pendingFocusUpdate=!1,this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}toggleGeneratedHeader(){if(this.generatedHeader!==null&&(this.removeChild(this.generatedHeader),this.generatedHeader=null),this.generateHeader!==qu.none&&this.rowsData.length>0){let e=document.createElement(this.rowElementTag);this.generatedHeader=e,this.generatedHeader.columnDefinitions=this.columnDefinitions,this.generatedHeader.gridTemplateColumns=this.gridTemplateColumns,this.generatedHeader.rowType=this.generateHeader===qu.sticky?Nl.stickyHeader:Nl.header,(this.firstChild!==null||this.rowsPlaceholder!==null)&&this.insertBefore(e,this.firstChild!==null?this.firstChild:this.rowsPlaceholder);return}}};Ir.generateColumns=r=>Object.getOwnPropertyNames(r).map((e,t)=>({columnDataKey:e,gridColumn:`${t}`}));w([C({attribute:"no-tabbing",mode:"boolean"})],Ir.prototype,"noTabbing",void 0);w([C({attribute:"generate-header"})],Ir.prototype,"generateHeader",void 0);w([C({attribute:"grid-template-columns"})],Ir.prototype,"gridTemplateColumns",void 0);w([I],Ir.prototype,"rowsData",void 0);w([I],Ir.prototype,"columnDefinitions",void 0);w([I],Ir.prototype,"rowItemTemplate",void 0);w([I],Ir.prototype,"cellItemTemplate",void 0);w([I],Ir.prototype,"headerCellItemTemplate",void 0);w([I],Ir.prototype,"focusRowIndex",void 0);w([I],Ir.prototype,"focusColumnIndex",void 0);w([I],Ir.prototype,"defaultRowItemTemplate",void 0);w([I],Ir.prototype,"rowElementTag",void 0);w([I],Ir.prototype,"rowElements",void 0)});var I9,A9,Xo,nb=y(()=>{l();c();d();$e();A();be();Ue();im();I9=O`
    <template>
        ${r=>r.rowData===null||r.columnDefinition===null||r.columnDefinition.columnDataKey===null?null:r.rowData[r.columnDefinition.columnDataKey]}
    </template>
`,A9=O`
    <template>
        ${r=>r.columnDefinition===null?null:r.columnDefinition.title===void 0?r.columnDefinition.columnDataKey:r.columnDefinition.title}
    </template>
`,Xo=class extends q{constructor(){super(...arguments),this.cellType=$s.default,this.rowData=null,this.columnDefinition=null,this.isActiveCell=!1,this.customCellView=null,this.updateCellStyle=()=>{this.style.gridColumn=this.gridColumn}}cellTypeChanged(){this.$fastController.isConnected&&this.updateCellView()}gridColumnChanged(){this.$fastController.isConnected&&this.updateCellStyle()}columnDefinitionChanged(e,t){this.$fastController.isConnected&&this.updateCellView()}connectedCallback(){var e;super.connectedCallback(),this.addEventListener(Vy,this.handleFocusin),this.addEventListener(As,this.handleFocusout),this.addEventListener(Rs,this.handleKeydown),this.style.gridColumn=`${((e=this.columnDefinition)===null||e===void 0?void 0:e.gridColumn)===void 0?0:this.columnDefinition.gridColumn}`,this.updateCellView(),this.updateCellStyle()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(Vy,this.handleFocusin),this.removeEventListener(As,this.handleFocusout),this.removeEventListener(Rs,this.handleKeydown),this.disconnectCellView()}handleFocusin(e){if(!this.isActiveCell){switch(this.isActiveCell=!0,this.cellType){case $s.columnHeader:if(this.columnDefinition!==null&&this.columnDefinition.headerCellInternalFocusQueue!==!0&&typeof this.columnDefinition.headerCellFocusTargetCallback=="function"){let t=this.columnDefinition.headerCellFocusTargetCallback(this);t!==null&&t.focus()}break;default:if(this.columnDefinition!==null&&this.columnDefinition.cellInternalFocusQueue!==!0&&typeof this.columnDefinition.cellFocusTargetCallback=="function"){let t=this.columnDefinition.cellFocusTargetCallback(this);t!==null&&t.focus()}break}this.$emit("cell-focused",this)}}handleFocusout(e){this!==document.activeElement&&!this.contains(document.activeElement)&&(this.isActiveCell=!1)}handleKeydown(e){if(!(e.defaultPrevented||this.columnDefinition===null||this.cellType===$s.default&&this.columnDefinition.cellInternalFocusQueue!==!0||this.cellType===$s.columnHeader&&this.columnDefinition.headerCellInternalFocusQueue!==!0))switch(e.key){case dr:case jT:if(this.contains(document.activeElement)&&document.activeElement!==this)return;switch(this.cellType){case $s.columnHeader:if(this.columnDefinition.headerCellFocusTargetCallback!==void 0){let t=this.columnDefinition.headerCellFocusTargetCallback(this);t!==null&&t.focus(),e.preventDefault()}break;default:if(this.columnDefinition.cellFocusTargetCallback!==void 0){let t=this.columnDefinition.cellFocusTargetCallback(this);t!==null&&t.focus(),e.preventDefault()}break}break;case Yo:this.contains(document.activeElement)&&document.activeElement!==this&&(this.focus(),e.preventDefault());break}}updateCellView(){if(this.disconnectCellView(),this.columnDefinition!==null)switch(this.cellType){case $s.columnHeader:this.columnDefinition.headerCellTemplate!==void 0?this.customCellView=this.columnDefinition.headerCellTemplate.render(this,this):this.customCellView=A9.render(this,this);break;case void 0:case $s.rowHeader:case $s.default:this.columnDefinition.cellTemplate!==void 0?this.customCellView=this.columnDefinition.cellTemplate.render(this,this):this.customCellView=I9.render(this,this);break}}disconnectCellView(){this.customCellView!==null&&(this.customCellView.dispose(),this.customCellView=null)}};w([C({attribute:"cell-type"})],Xo.prototype,"cellType",void 0);w([C({attribute:"grid-column"})],Xo.prototype,"gridColumn",void 0);w([I],Xo.prototype,"rowData",void 0);w([I],Xo.prototype,"columnDefinition",void 0)});function R9(r){let e=r.tagFor(Xo);return O`
    <${e}
        cell-type="${t=>t.isRowHeader?"rowheader":void 0}"
        grid-column="${(t,o)=>o.index+1}"
        :rowData="${(t,o)=>o.parent.rowData}"
        :columnDefinition="${t=>t}"
    ></${e}>
`}function P9(r){let e=r.tagFor(Xo);return O`
    <${e}
        cell-type="columnheader"
        grid-column="${(t,o)=>o.index+1}"
        :columnDefinition="${t=>t}"
    ></${e}>
`}var B2,z2=y(()=>{l();c();d();A();nb();B2=(r,e)=>{let t=R9(r),o=P9(r);return O`
        <template
            role="row"
            class="${i=>i.rowType!=="default"?i.rowType:""}"
            :defaultCellItemTemplate="${t}"
            :defaultHeaderCellItemTemplate="${o}"
            ${wa({property:"cellElements",filter:Gr('[role="cell"],[role="gridcell"],[role="columnheader"],[role="rowheader"]')})}
        >
            <slot ${Le("slottedCellElements")}></slot>
        </template>
    `}});var V2,q2=y(()=>{l();c();d();A();V2=(r,e)=>O`
        <template
            tabindex="-1"
            role="${t=>!t.cellType||t.cellType==="default"?"gridcell":t.cellType}"
            class="
            ${t=>t.cellType==="columnheader"?"column-header":t.cellType==="rowheader"?"row-header":""}
            "
        >
            <slot></slot>
        </template>
    `});var sb=y(()=>{l();c();d();H2();U2();z2();ib();q2();nb()});var G2,$9,O9,M9,F9,D9,j2,K2=y(()=>{l();c();d();A();Mt();sb();G2=O`
    <div
        class="title"
        part="title"
        aria-label="${r=>r.dateFormatter.getDate(`${r.month}-2-${r.year}`,{month:"long",year:"numeric"})}"
    >
        <span part="month">
            ${r=>r.dateFormatter.getMonth(r.month)}
        </span>
        <span part="year">${r=>r.dateFormatter.getYear(r.year)}</span>
    </div>
`,$9=r=>{let e=r.tagFor(Xo);return O`
        <${e}
            class="week-day"
            part="week-day"
            tabindex="-1"
            grid-column="${(t,o)=>o.index+1}"
            abbr="${t=>t.abbr}"
        >
            ${t=>t.text}
        </${e}>
    `},O9=(r,e)=>{let t=r.tagFor(Xo);return O`
        <${t}
            class="${(o,i)=>i.parentContext.parent.getDayClassNames(o,e)}"
            part="day"
            tabindex="-1"
            role="gridcell"
            grid-column="${(o,i)=>i.index+1}"
            @click="${(o,i)=>i.parentContext.parent.handleDateSelect(i.event,o)}"
            @keydown="${(o,i)=>i.parentContext.parent.handleKeydown(i.event,o)}"
            aria-label="${(o,i)=>i.parentContext.parent.dateFormatter.getDate(`${o.month}-${o.day}-${o.year}`,{month:"long",day:"numeric"})}"
        >
            <div
                class="date"
                part="${o=>e===`${o.month}-${o.day}-${o.year}`?"today":"date"}"
            >
                ${(o,i)=>i.parentContext.parent.dateFormatter.getDay(o.day)}
            </div>
            <slot name="${o=>o.month}-${o=>o.day}-${o=>o.year}"></slot>
        </${t}>
    `},M9=(r,e)=>{let t=r.tagFor(ur);return O`
        <${t}
            class="week"
            part="week"
            role="row"
            role-type="default"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
        ${Ol(o=>o,O9(r,e),{positioning:!0})}
        </${t}>
    `},F9=(r,e)=>{let t=r.tagFor(Ir),o=r.tagFor(ur);return O`
    <${t} class="days interact" part="days" generate-header="none">
        <${o}
            class="week-days"
            part="week-days"
            role="row"
            row-type="header"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
            ${Ol(i=>i.getWeekdayText(),$9(r),{positioning:!0})}
        </${o}>
        ${Ol(i=>i.getDays(),M9(r,e))}
    </${t}>
`},D9=r=>O`
        <div class="days" part="days">
            <div class="week-days" part="week-days">
                ${Ol(e=>e.getWeekdayText(),O`
                        <div class="week-day" part="week-day" abbr="${e=>e.abbr}">
                            ${e=>e.text}
                        </div>
                    `)}
            </div>
            ${Ol(e=>e.getDays(),O`
                    <div class="week">
                        ${Ol(e=>e,O`
                                <div
                                    class="${(e,t)=>t.parentContext.parent.getDayClassNames(e,r)}"
                                    part="day"
                                    aria-label="${(e,t)=>t.parentContext.parent.dateFormatter.getDate(`${e.month}-${e.day}-${e.year}`,{month:"long",day:"numeric"})}"
                                >
                                    <div
                                        class="date"
                                        part="${e=>r===`${e.month}-${e.day}-${e.year}`?"today":"date"}"
                                    >
                                        ${(e,t)=>t.parentContext.parent.dateFormatter.getDay(e.day)}
                                    </div>
                                    <slot
                                        name="${e=>e.month}-${e=>e.day}-${e=>e.year}"
                                    ></slot>
                                </div>
                            `)}
                    </div>
                `)}
        </div>
    `,j2=(r,e)=>{var t;let o=new Date,i=`${o.getMonth()+1}-${o.getDate()}-${o.getFullYear()}`;return O`
        <template>
            ${fT}
            ${e.title instanceof Function?e.title(r,e):(t=e.title)!==null&&t!==void 0?t:""}
            <slot></slot>
            ${Xe(n=>n.readonly,D9(i),F9(r,i))}
            ${pT}
        </template>
    `}});var W2=y(()=>{l();c();d();L2();K2();ob()});var Q2,Y2=y(()=>{l();c();d();A();Q2=(r,e)=>O`
    <slot></slot>
`});var Gu,Z2=y(()=>{l();c();d();Ue();Gu=class extends q{}});var J2=y(()=>{l();c();d();Y2();Z2()});var X2,eE=y(()=>{l();c();d();A();X2=(r,e)=>O`
    <template
        role="checkbox"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.readOnly?"readonly":""} ${t=>t.checked?"checked":""} ${t=>t.indeterminate?"indeterminate":""}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${e.checkedIndicator||""}
            </slot>
            <slot name="indeterminate-indicator">
                ${e.indeterminateIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Le("defaultSlottedNodes")}></slot>
        </label>
    </template>
`});var ab,nm,tE=y(()=>{l();c();d();Jo();Ue();ab=class extends q{},nm=class extends Wc(ab){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Hl,rE=y(()=>{l();c();d();$e();A();be();tE();Hl=class extends nm{constructor(){super(),this.initialValue="on",this.indeterminate=!1,this.keypressHandler=e=>{if(!this.readOnly)switch(e.key){case Zo:this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked;break}},this.clickHandler=e=>{!this.disabled&&!this.readOnly&&(this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}};w([C({attribute:"readonly",mode:"boolean"})],Hl.prototype,"readOnly",void 0);w([I],Hl.prototype,"defaultSlottedNodes",void 0);w([I],Hl.prototype,"indeterminate",void 0)});var oE=y(()=>{l();c();d();eE();rE()});function lb(r){return qn(r)&&(r.getAttribute("role")==="option"||r instanceof HTMLOptionElement)}var ei,Ta,cb=y(()=>{l();c();d();$e();A();be();Ue();Bu();Mt();jr();ei=class extends q{constructor(e,t,o,i){super(),this.defaultSelected=!1,this.dirtySelected=!1,this.selected=this.defaultSelected,this.dirtyValue=!1,e&&(this.textContent=e),t&&(this.initialValue=t),o&&(this.defaultSelected=o),i&&(this.selected=i),this.proxy=new Option(`${this.textContent}`,this.initialValue,this.defaultSelected,this.selected),this.proxy.disabled=this.disabled}checkedChanged(e,t){if(typeof t=="boolean"){this.ariaChecked=t?"true":"false";return}this.ariaChecked=null}contentChanged(e,t){this.proxy instanceof HTMLOptionElement&&(this.proxy.textContent=this.textContent),this.$emit("contentchange",null,{bubbles:!0})}defaultSelectedChanged(){this.dirtySelected||(this.selected=this.defaultSelected,this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.defaultSelected))}disabledChanged(e,t){this.ariaDisabled=this.disabled?"true":"false",this.proxy instanceof HTMLOptionElement&&(this.proxy.disabled=this.disabled)}selectedAttributeChanged(){this.defaultSelected=this.selectedAttribute,this.proxy instanceof HTMLOptionElement&&(this.proxy.defaultSelected=this.defaultSelected)}selectedChanged(){this.ariaSelected=this.selected?"true":"false",this.dirtySelected||(this.dirtySelected=!0),this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.selected)}initialValueChanged(e,t){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}get label(){var e;return(e=this.value)!==null&&e!==void 0?e:this.text}get text(){var e,t;return(t=(e=this.textContent)===null||e===void 0?void 0:e.replace(/\s+/g," ").trim())!==null&&t!==void 0?t:""}set value(e){let t=`${e??""}`;this._value=t,this.dirtyValue=!0,this.proxy instanceof HTMLOptionElement&&(this.proxy.value=t),fe.notify(this,"value")}get value(){var e;return fe.track(this,"value"),(e=this._value)!==null&&e!==void 0?e:this.text}get form(){return this.proxy?this.proxy.form:null}};w([I],ei.prototype,"checked",void 0);w([I],ei.prototype,"content",void 0);w([I],ei.prototype,"defaultSelected",void 0);w([C({mode:"boolean"})],ei.prototype,"disabled",void 0);w([C({attribute:"selected",mode:"boolean"})],ei.prototype,"selectedAttribute",void 0);w([I],ei.prototype,"selected",void 0);w([C({attribute:"value",mode:"fromView"})],ei.prototype,"initialValue",void 0);Ta=class{};w([I],Ta.prototype,"ariaChecked",void 0);w([I],Ta.prototype,"ariaPosInSet",void 0);w([I],Ta.prototype,"ariaSelected",void 0);w([I],Ta.prototype,"ariaSetSize",void 0);Ye(Ta,ut);Ye(ei,_t,Ta)});var hr,Fi,Ea=y(()=>{l();c();d();$e();A();be();Ue();cb();Bu();jr();hr=class r extends q{constructor(){super(...arguments),this._options=[],this.selectedIndex=-1,this.selectedOptions=[],this.shouldSkipFocus=!1,this.typeaheadBuffer="",this.typeaheadExpired=!0,this.typeaheadTimeout=-1}get firstSelectedOption(){var e;return(e=this.selectedOptions[0])!==null&&e!==void 0?e:null}get hasSelectableOptions(){return this.options.length>0&&!this.options.every(e=>e.disabled)}get length(){var e,t;return(t=(e=this.options)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0}get options(){return fe.track(this,"options"),this._options}set options(e){this._options=e,fe.notify(this,"options")}get typeAheadExpired(){return this.typeaheadExpired}set typeAheadExpired(e){this.typeaheadExpired=e}clickHandler(e){let t=e.target.closest("option,[role=option]");if(t&&!t.disabled)return this.selectedIndex=this.options.indexOf(t),!0}focusAndScrollOptionIntoView(e=this.firstSelectedOption){this.contains(document.activeElement)&&e!==null&&(e.focus(),requestAnimationFrame(()=>{e.scrollIntoView({block:"nearest"})}))}focusinHandler(e){!this.shouldSkipFocus&&e.target===e.currentTarget&&(this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}getTypeaheadMatches(){let e=this.typeaheadBuffer.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),t=new RegExp(`^${e}`,"gi");return this.options.filter(o=>o.text.trim().match(t))}getSelectableIndex(e=this.selectedIndex,t){let o=e>t?-1:e<t?1:0,i=e+o,n=null;switch(o){case-1:{n=this.options.reduceRight((s,a,u)=>!s&&!a.disabled&&u<i?a:s,n);break}case 1:{n=this.options.reduce((s,a,u)=>!s&&!a.disabled&&u>i?a:s,n);break}}return this.options.indexOf(n)}handleChange(e,t){switch(t){case"selected":{r.slottedOptionFilter(e)&&(this.selectedIndex=this.options.indexOf(e)),this.setSelectedOptions();break}}}handleTypeAhead(e){this.typeaheadTimeout&&window.clearTimeout(this.typeaheadTimeout),this.typeaheadTimeout=window.setTimeout(()=>this.typeaheadExpired=!0,r.TYPE_AHEAD_TIMEOUT_MS),!(e.length>1)&&(this.typeaheadBuffer=`${this.typeaheadExpired?"":this.typeaheadBuffer}${e}`)}keydownHandler(e){if(this.disabled)return!0;this.shouldSkipFocus=!1;let t=e.key;switch(t){case Tr:{e.shiftKey||(e.preventDefault(),this.selectFirstOption());break}case Wt:{e.shiftKey||(e.preventDefault(),this.selectNextOption());break}case Qt:{e.shiftKey||(e.preventDefault(),this.selectPreviousOption());break}case Er:{e.preventDefault(),this.selectLastOption();break}case Ca:return this.focusAndScrollOptionIntoView(),!0;case dr:case Yo:return!0;case Zo:if(this.typeaheadExpired)return!0;default:return t.length===1&&this.handleTypeAhead(`${t}`),!0}}mousedownHandler(e){return this.shouldSkipFocus=!this.contains(document.activeElement),!0}multipleChanged(e,t){this.ariaMultiSelectable=t?"true":null}selectedIndexChanged(e,t){var o;if(!this.hasSelectableOptions){this.selectedIndex=-1;return}if(!((o=this.options[this.selectedIndex])===null||o===void 0)&&o.disabled&&typeof e=="number"){let i=this.getSelectableIndex(e,t),n=i>-1?i:e;this.selectedIndex=n,t===n&&this.selectedIndexChanged(t,n);return}this.setSelectedOptions()}selectedOptionsChanged(e,t){var o;let i=t.filter(r.slottedOptionFilter);(o=this.options)===null||o===void 0||o.forEach(n=>{let s=fe.getNotifier(n);s.unsubscribe(this,"selected"),n.selected=i.includes(n),s.subscribe(this,"selected")})}selectFirstOption(){var e,t;this.disabled||(this.selectedIndex=(t=(e=this.options)===null||e===void 0?void 0:e.findIndex(o=>!o.disabled))!==null&&t!==void 0?t:-1)}selectLastOption(){this.disabled||(this.selectedIndex=MT(this.options,e=>!e.disabled))}selectNextOption(){!this.disabled&&this.selectedIndex<this.options.length-1&&(this.selectedIndex+=1)}selectPreviousOption(){!this.disabled&&this.selectedIndex>0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){var e,t;this.selectedIndex=(t=(e=this.options)===null||e===void 0?void 0:e.findIndex(o=>o.defaultSelected))!==null&&t!==void 0?t:-1}setSelectedOptions(){var e,t,o;!((e=this.options)===null||e===void 0)&&e.length&&(this.selectedOptions=[this.options[this.selectedIndex]],this.ariaActiveDescendant=(o=(t=this.firstSelectedOption)===null||t===void 0?void 0:t.id)!==null&&o!==void 0?o:"",this.focusAndScrollOptionIntoView())}slottedOptionsChanged(e,t){this.options=t.reduce((i,n)=>(lb(n)&&i.push(n),i),[]);let o=`${this.options.length}`;this.options.forEach((i,n)=>{i.id||(i.id=gi("option-")),i.ariaPosInSet=`${n+1}`,i.ariaSetSize=o}),this.$fastController.isConnected&&(this.setSelectedOptions(),this.setDefaultSelectedOption())}typeaheadBufferChanged(e,t){if(this.$fastController.isConnected){let o=this.getTypeaheadMatches();if(o.length){let i=this.options.indexOf(o[0]);i>-1&&(this.selectedIndex=i)}this.typeaheadExpired=!1}}};hr.slottedOptionFilter=r=>lb(r)&&!r.hidden;hr.TYPE_AHEAD_TIMEOUT_MS=1e3;w([C({mode:"boolean"})],hr.prototype,"disabled",void 0);w([I],hr.prototype,"selectedIndex",void 0);w([I],hr.prototype,"selectedOptions",void 0);w([I],hr.prototype,"slottedOptions",void 0);w([I],hr.prototype,"typeaheadBuffer",void 0);Fi=class{};w([I],Fi.prototype,"ariaActiveDescendant",void 0);w([I],Fi.prototype,"ariaDisabled",void 0);w([I],Fi.prototype,"ariaExpanded",void 0);w([I],Fi.prototype,"ariaMultiSelectable",void 0);Ye(Fi,ut);Ye(hr,Fi)});var Ia,sm=y(()=>{l();c();d();Ia={above:"above",below:"below"}});var db,am,iE=y(()=>{l();c();d();Jo();Ea();db=class extends hr{},am=class extends Or(db){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var ju,ub=y(()=>{l();c();d();ju={inline:"inline",list:"list",both:"both",none:"none"}});var Di,Yc,nE=y(()=>{l();c();d();$e();A();be();Ea();Mt();sm();jr();iE();ub();Di=class extends am{constructor(){super(...arguments),this._value="",this.filteredOptions=[],this.filter="",this.forcedPosition=!1,this.listboxId=gi("listbox-"),this.maxHeight=0,this.open=!1}formResetCallback(){super.formResetCallback(),this.setDefaultSelectedOption(),this.updateValue()}validate(){super.validate(this.control)}get isAutocompleteInline(){return this.autocomplete===ju.inline||this.isAutocompleteBoth}get isAutocompleteList(){return this.autocomplete===ju.list||this.isAutocompleteBoth}get isAutocompleteBoth(){return this.autocomplete===ju.both}openChanged(){if(this.open){this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),Z.queueUpdate(()=>this.focus());return}this.ariaControls="",this.ariaExpanded="false"}get options(){return fe.track(this,"options"),this.filteredOptions.length?this.filteredOptions:this._options}set options(e){this._options=e,fe.notify(this,"options")}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}positionChanged(e,t){this.positionAttribute=t,this.setPositioning()}get value(){return fe.track(this,"value"),this._value}set value(e){var t,o,i;let n=`${this._value}`;if(this.$fastController.isConnected&&this.options){let s=this.options.findIndex(h=>h.text.toLowerCase()===e.toLowerCase()),a=(t=this.options[this.selectedIndex])===null||t===void 0?void 0:t.text,u=(o=this.options[s])===null||o===void 0?void 0:o.text;this.selectedIndex=a!==u?s:this.selectedIndex,e=((i=this.firstSelectedOption)===null||i===void 0?void 0:i.text)||e}n!==e&&(this._value=e,super.valueChanged(n,e),fe.notify(this,"value"))}clickHandler(e){if(!this.disabled){if(this.open){let t=e.target.closest("option,[role=option]");if(!t||t.disabled)return;this.selectedOptions=[t],this.control.value=t.text,this.clearSelectionRange(),this.updateValue(!0)}return this.open=!this.open,this.open&&this.control.focus(),!0}}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.value&&(this.initialValue=this.value)}disabledChanged(e,t){super.disabledChanged&&super.disabledChanged(e,t),this.ariaDisabled=this.disabled?"true":"false"}filterOptions(){(!this.autocomplete||this.autocomplete===ju.none)&&(this.filter="");let e=this.filter.toLowerCase();this.filteredOptions=this._options.filter(t=>t.text.toLowerCase().startsWith(this.filter.toLowerCase())),this.isAutocompleteList&&(!this.filteredOptions.length&&!e&&(this.filteredOptions=this._options),this._options.forEach(t=>{t.hidden=!this.filteredOptions.includes(t)}))}focusAndScrollOptionIntoView(){this.contains(document.activeElement)&&(this.control.focus(),this.firstSelectedOption&&requestAnimationFrame(()=>{var e;(e=this.firstSelectedOption)===null||e===void 0||e.scrollIntoView({block:"nearest"})}))}focusoutHandler(e){if(this.syncValue(),!this.open)return!0;let t=e.relatedTarget;if(this.isSameNode(t)){this.focus();return}(!this.options||!this.options.includes(t))&&(this.open=!1)}inputHandler(e){if(this.filter=this.control.value,this.filterOptions(),this.isAutocompleteInline||(this.selectedIndex=this.options.map(t=>t.text).indexOf(this.control.value)),e.inputType.includes("deleteContent")||!this.filter.length)return!0;this.isAutocompleteList&&!this.open&&(this.open=!0),this.isAutocompleteInline&&(this.filteredOptions.length?(this.selectedOptions=[this.filteredOptions[0]],this.selectedIndex=this.options.indexOf(this.firstSelectedOption),this.setInlineSelection()):this.selectedIndex=-1)}keydownHandler(e){let t=e.key;if(e.ctrlKey||e.shiftKey)return!0;switch(t){case"Enter":{this.syncValue(),this.isAutocompleteInline&&(this.filter=this.value),this.open=!1,this.clearSelectionRange();break}case"Escape":{if(this.isAutocompleteInline||(this.selectedIndex=-1),this.open){this.open=!1;break}this.value="",this.control.value="",this.filter="",this.filterOptions();break}case"Tab":{if(this.setInputToSelection(),!this.open)return!0;e.preventDefault(),this.open=!1;break}case"ArrowUp":case"ArrowDown":{if(this.filterOptions(),!this.open){this.open=!0;break}this.filteredOptions.length>0&&super.keydownHandler(e),this.isAutocompleteInline&&this.setInlineSelection();break}default:return!0}}keyupHandler(e){switch(e.key){case"ArrowLeft":case"ArrowRight":case"Backspace":case"Delete":case"Home":case"End":{this.filter=this.control.value,this.selectedIndex=-1,this.filterOptions();break}}}selectedIndexChanged(e,t){if(this.$fastController.isConnected){if(t=ka(-1,this.options.length-1,t),t!==this.selectedIndex){this.selectedIndex=t;return}super.selectedIndexChanged(e,t)}}selectPreviousOption(){!this.disabled&&this.selectedIndex>=0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){if(this.$fastController.isConnected&&this.options){let e=this.options.findIndex(t=>t.getAttribute("selected")!==null||t.selected);this.selectedIndex=e,!this.dirtyValue&&this.firstSelectedOption&&(this.value=this.firstSelectedOption.text),this.setSelectedOptions()}}setInputToSelection(){this.firstSelectedOption&&(this.control.value=this.firstSelectedOption.text,this.control.focus())}setInlineSelection(){this.firstSelectedOption&&(this.setInputToSelection(),this.control.setSelectionRange(this.filter.length,this.control.value.length,"backward"))}syncValue(){var e;let t=this.selectedIndex>-1?(e=this.firstSelectedOption)===null||e===void 0?void 0:e.text:this.control.value;this.updateValue(this.value!==t)}setPositioning(){let e=this.getBoundingClientRect(),o=window.innerHeight-e.bottom;this.position=this.forcedPosition?this.positionAttribute:e.top>o?Ia.above:Ia.below,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===Ia.above?~~e.top:~~o}selectedOptionsChanged(e,t){this.$fastController.isConnected&&this._options.forEach(o=>{o.selected=t.includes(o)})}slottedOptionsChanged(e,t){super.slottedOptionsChanged(e,t),this.updateValue()}updateValue(e){var t;this.$fastController.isConnected&&(this.value=((t=this.firstSelectedOption)===null||t===void 0?void 0:t.text)||this.control.value,this.control.value=this.value),e&&this.$emit("change")}clearSelectionRange(){let e=this.control.value.length;this.control.setSelectionRange(e,e)}};w([C({attribute:"autocomplete",mode:"fromView"})],Di.prototype,"autocomplete",void 0);w([I],Di.prototype,"maxHeight",void 0);w([C({attribute:"open",mode:"boolean"})],Di.prototype,"open",void 0);w([C],Di.prototype,"placeholder",void 0);w([C({attribute:"position"})],Di.prototype,"positionAttribute",void 0);w([I],Di.prototype,"position",void 0);Yc=class{};w([I],Yc.prototype,"ariaAutoComplete",void 0);w([I],Yc.prototype,"ariaControls",void 0);Ye(Yc,Fi);Ye(Di,_t,Yc)});var sE,aE=y(()=>{l();c();d();A();Ea();Mt();sE=(r,e)=>O`
    <template
        aria-disabled="${t=>t.ariaDisabled}"
        autocomplete="${t=>t.autocomplete}"
        class="${t=>t.open?"open":""} ${t=>t.disabled?"disabled":""} ${t=>t.position}"
        ?open="${t=>t.open}"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
    >
        <div class="control" part="control">
            ${kt(r,e)}
            <slot name="control">
                <input
                    aria-activedescendant="${t=>t.open?t.ariaActiveDescendant:null}"
                    aria-autocomplete="${t=>t.ariaAutoComplete}"
                    aria-controls="${t=>t.ariaControls}"
                    aria-disabled="${t=>t.ariaDisabled}"
                    aria-expanded="${t=>t.ariaExpanded}"
                    aria-haspopup="listbox"
                    class="selected-value"
                    part="selected-value"
                    placeholder="${t=>t.placeholder}"
                    role="combobox"
                    type="text"
                    ?disabled="${t=>t.disabled}"
                    :value="${t=>t.value}"
                    @input="${(t,o)=>t.inputHandler(o.event)}"
                    @keyup="${(t,o)=>t.keyupHandler(o.event)}"
                    ${Ie("control")}
                />
                <div class="indicator" part="indicator" aria-hidden="true">
                    <slot name="indicator">
                        ${e.indicator||""}
                    </slot>
                </div>
            </slot>
            ${xt(r,e)}
        </div>
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>!t.open}"
            ${Ie("listbox")}
        >
            <slot
                ${Le({filter:hr.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`});var lE=y(()=>{l();c();d();nE();ub();aE()});function Ul(r){let e=r.parentElement;if(e)return e;{let t=r.getRootNode();if(t.host instanceof HTMLElement)return t.host}return null}var lm=y(()=>{l();c();d()});function hb(r,e){let t=e;for(;t!==null;){if(t===r)return!0;t=Ul(t)}return!1}var pb=y(()=>{l();c();d();lm()});function L9(r){return r instanceof ya}var Gn,Ku,mb,gb,vb,cm,yb,Aa,fb,N9,Bl,bb=y(()=>{l();c();d();$e();A();Gn=document.createElement("div");Ku=class{setProperty(e,t){Z.queueUpdate(()=>this.target.setProperty(e,t))}removeProperty(e){Z.queueUpdate(()=>this.target.removeProperty(e))}},mb=class extends Ku{constructor(e){super();let t=new CSSStyleSheet;this.target=t.cssRules[t.insertRule(":host{}")].style,e.$fastController.addStyles(cr.create([t]))}},gb=class extends Ku{constructor(){super();let e=new CSSStyleSheet;this.target=e.cssRules[e.insertRule(":root{}")].style,document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}},vb=class extends Ku{constructor(){super(),this.style=document.createElement("style"),document.head.appendChild(this.style);let{sheet:e}=this.style;if(e){let t=e.insertRule(":root{}",e.cssRules.length);this.target=e.cssRules[t].style}}},cm=class{constructor(e){this.store=new Map,this.target=null;let t=e.$fastController;this.style=document.createElement("style"),t.addStyles(this.style),fe.getNotifier(t).subscribe(this,"isConnected"),this.handleChange(t,"isConnected")}targetChanged(){if(this.target!==null)for(let[e,t]of this.store.entries())this.target.setProperty(e,t)}setProperty(e,t){this.store.set(e,t),Z.queueUpdate(()=>{this.target!==null&&this.target.setProperty(e,t)})}removeProperty(e){this.store.delete(e),Z.queueUpdate(()=>{this.target!==null&&this.target.removeProperty(e)})}handleChange(e,t){let{sheet:o}=this.style;if(o){let i=o.insertRule(":host{}",o.cssRules.length);this.target=o.cssRules[i].style}else this.target=null}};w([I],cm.prototype,"target",void 0);yb=class{constructor(e){this.target=e.style}setProperty(e,t){Z.queueUpdate(()=>this.target.setProperty(e,t))}removeProperty(e){Z.queueUpdate(()=>this.target.removeProperty(e))}},Aa=class r{setProperty(e,t){r.properties[e]=t;for(let o of r.roots.values())Bl.getOrCreate(r.normalizeRoot(o)).setProperty(e,t)}removeProperty(e){delete r.properties[e];for(let t of r.roots.values())Bl.getOrCreate(r.normalizeRoot(t)).removeProperty(e)}static registerRoot(e){let{roots:t}=r;if(!t.has(e)){t.add(e);let o=Bl.getOrCreate(this.normalizeRoot(e));for(let i in r.properties)o.setProperty(i,r.properties[i])}}static unregisterRoot(e){let{roots:t}=r;if(t.has(e)){t.delete(e);let o=Bl.getOrCreate(r.normalizeRoot(e));for(let i in r.properties)o.removeProperty(i)}}static normalizeRoot(e){return e===Gn?document:e}};Aa.roots=new Set;Aa.properties={};fb=new WeakMap,N9=Z.supportsAdoptedStyleSheets?mb:cm,Bl=Object.freeze({getOrCreate(r){if(fb.has(r))return fb.get(r);let e;return r===Gn?e=new Aa:r instanceof Document?e=Z.supportsAdoptedStyleSheets?new gb:new vb:L9(r)?e=new N9(r):e=new yb(r),fb.set(r,e),e}})});function H9(r){return vn.from(r)}var vn,wb,Cb,xb,Wu,Qu,Do,et,kb=y(()=>{l();c();d();$e();A();lm();pb();bb();bb();vn=class r extends ba{constructor(e){super(),this.subscribers=new WeakMap,this._appliedTo=new Set,this.name=e.name,e.cssCustomPropertyName!==null&&(this.cssCustomProperty=`--${e.cssCustomPropertyName}`,this.cssVar=`var(${this.cssCustomProperty})`),this.id=r.uniqueId(),r.tokensById.set(this.id,this)}get appliedTo(){return[...this._appliedTo]}static from(e){return new r({name:typeof e=="string"?e:e.name,cssCustomPropertyName:typeof e=="string"?e:e.cssCustomPropertyName===void 0?e.name:e.cssCustomPropertyName})}static isCSSDesignToken(e){return typeof e.cssCustomProperty=="string"}static isDerivedDesignTokenValue(e){return typeof e=="function"}static getTokenById(e){return r.tokensById.get(e)}getOrCreateSubscriberSet(e=this){return this.subscribers.get(e)||this.subscribers.set(e,new Set)&&this.subscribers.get(e)}createCSS(){return this.cssVar||""}getValueFor(e){let t=Do.getOrCreate(e).get(this);if(t!==void 0)return t;throw new Error(`Value could not be retrieved for token named "${this.name}". Ensure the value is set for ${e} or an ancestor of ${e}.`)}setValueFor(e,t){return this._appliedTo.add(e),t instanceof r&&(t=this.alias(t)),Do.getOrCreate(e).set(this,t),this}deleteValueFor(e){return this._appliedTo.delete(e),Do.existsFor(e)&&Do.getOrCreate(e).delete(this),this}withDefault(e){return this.setValueFor(Gn,e),this}subscribe(e,t){let o=this.getOrCreateSubscriberSet(t);t&&!Do.existsFor(t)&&Do.getOrCreate(t),o.has(e)||o.add(e)}unsubscribe(e,t){let o=this.subscribers.get(t||this);o&&o.has(e)&&o.delete(e)}notify(e){let t=Object.freeze({token:this,target:e});this.subscribers.has(this)&&this.subscribers.get(this).forEach(o=>o.handleChange(t)),this.subscribers.has(e)&&this.subscribers.get(e).forEach(o=>o.handleChange(t))}alias(e){return t=>e.getValueFor(t)}};vn.uniqueId=(()=>{let r=0;return()=>(r++,r.toString(16))})();vn.tokensById=new Map;wb=class{startReflection(e,t){e.subscribe(this,t),this.handleChange({token:e,target:t})}stopReflection(e,t){e.unsubscribe(this,t),this.remove(e,t)}handleChange(e){let{token:t,target:o}=e;this.add(t,o)}add(e,t){Bl.getOrCreate(t).setProperty(e.cssCustomProperty,this.resolveCSSValue(Do.getOrCreate(t).get(e)))}remove(e,t){Bl.getOrCreate(t).removeProperty(e.cssCustomProperty)}resolveCSSValue(e){return e&&typeof e.createCSS=="function"?e.createCSS():e}},Cb=class{constructor(e,t,o){this.source=e,this.token=t,this.node=o,this.dependencies=new Set,this.observer=fe.binding(e,this,!1),this.observer.handleChange=this.observer.call,this.handleChange()}disconnect(){this.observer.disconnect()}handleChange(){this.node.store.set(this.token,this.observer.observe(this.node.target,ma))}},xb=class{constructor(){this.values=new Map}set(e,t){this.values.get(e)!==t&&(this.values.set(e,t),fe.getNotifier(this).notify(e.id))}get(e){return fe.track(this,e.id),this.values.get(e)}delete(e){this.values.delete(e)}all(){return this.values.entries()}},Wu=new WeakMap,Qu=new WeakMap,Do=class r{constructor(e){this.target=e,this.store=new xb,this.children=[],this.assignedValues=new Map,this.reflecting=new Set,this.bindingObservers=new Map,this.tokenValueChangeHandler={handleChange:(t,o)=>{let i=vn.getTokenById(o);if(i&&(i.notify(this.target),vn.isCSSDesignToken(i))){let n=this.parent,s=this.isReflecting(i);if(n){let a=n.get(i),u=t.get(i);a!==u&&!s?this.reflectToCSS(i):a===u&&s&&this.stopReflectToCSS(i)}else s||this.reflectToCSS(i)}}},Wu.set(e,this),fe.getNotifier(this.store).subscribe(this.tokenValueChangeHandler),e instanceof ya?e.$fastController.addBehaviors([this]):e.isConnected&&this.bind()}static getOrCreate(e){return Wu.get(e)||new r(e)}static existsFor(e){return Wu.has(e)}static findParent(e){if(Gn!==e.target){let t=Ul(e.target);for(;t!==null;){if(Wu.has(t))return Wu.get(t);t=Ul(t)}return r.getOrCreate(Gn)}return null}static findClosestAssignedNode(e,t){let o=t;do{if(o.has(e))return o;o=o.parent?o.parent:o.target!==Gn?r.getOrCreate(Gn):null}while(o!==null);return null}get parent(){return Qu.get(this)||null}has(e){return this.assignedValues.has(e)}get(e){let t=this.store.get(e);if(t!==void 0)return t;let o=this.getRaw(e);if(o!==void 0)return this.hydrate(e,o),this.get(e)}getRaw(e){var t;return this.assignedValues.has(e)?this.assignedValues.get(e):(t=r.findClosestAssignedNode(e,this))===null||t===void 0?void 0:t.getRaw(e)}set(e,t){vn.isDerivedDesignTokenValue(this.assignedValues.get(e))&&this.tearDownBindingObserver(e),this.assignedValues.set(e,t),vn.isDerivedDesignTokenValue(t)?this.setupBindingObserver(e,t):this.store.set(e,t)}delete(e){this.assignedValues.delete(e),this.tearDownBindingObserver(e);let t=this.getRaw(e);t?this.hydrate(e,t):this.store.delete(e)}bind(){let e=r.findParent(this);e&&e.appendChild(this);for(let t of this.assignedValues.keys())t.notify(this.target)}unbind(){this.parent&&Qu.get(this).removeChild(this)}appendChild(e){e.parent&&Qu.get(e).removeChild(e);let t=this.children.filter(o=>e.contains(o));Qu.set(e,this),this.children.push(e),t.forEach(o=>e.appendChild(o)),fe.getNotifier(this.store).subscribe(e);for(let[o,i]of this.store.all())e.hydrate(o,this.bindingObservers.has(o)?this.getRaw(o):i)}removeChild(e){let t=this.children.indexOf(e);return t!==-1&&this.children.splice(t,1),fe.getNotifier(this.store).unsubscribe(e),e.parent===this?Qu.delete(e):!1}contains(e){return hb(this.target,e.target)}reflectToCSS(e){this.isReflecting(e)||(this.reflecting.add(e),r.cssCustomPropertyReflector.startReflection(e,this.target))}stopReflectToCSS(e){this.isReflecting(e)&&(this.reflecting.delete(e),r.cssCustomPropertyReflector.stopReflection(e,this.target))}isReflecting(e){return this.reflecting.has(e)}handleChange(e,t){let o=vn.getTokenById(t);o&&this.hydrate(o,this.getRaw(o))}hydrate(e,t){if(!this.has(e)){let o=this.bindingObservers.get(e);vn.isDerivedDesignTokenValue(t)?o?o.source!==t&&(this.tearDownBindingObserver(e),this.setupBindingObserver(e,t)):this.setupBindingObserver(e,t):(o&&this.tearDownBindingObserver(e),this.store.set(e,t))}}setupBindingObserver(e,t){let o=new Cb(t,e,this);return this.bindingObservers.set(e,o),o}tearDownBindingObserver(e){return this.bindingObservers.has(e)?(this.bindingObservers.get(e).disconnect(),this.bindingObservers.delete(e),!0):!1}};Do.cssCustomPropertyReflector=new wb;w([I],Do.prototype,"children",void 0);et=Object.freeze({create:H9,notifyConnection(r){return!r.isConnected||!Do.existsFor(r)?!1:(Do.getOrCreate(r).bind(),!0)},notifyDisconnection(r){return r.isConnected||!Do.existsFor(r)?!1:(Do.getOrCreate(r).unbind(),!0)},registerRoot(r=Gn){Aa.registerRoot(r)},unregisterRoot(r=Gn){Aa.unregisterRoot(r)}})});function U9(r,e,t){return typeof r=="string"?{name:r,type:e,callback:t}:r}var Sb,_b,dm,Zc,Yu,Eb,um,Tb,cE=y(()=>{l();c();d();A();Ue();Wf();kb();Jf();Sb=Object.freeze({definitionCallbackOnly:null,ignoreDuplicate:Symbol()}),_b=new Map,dm=new Map,Zc=null,Yu=Pt.createInterface(r=>r.cachedCallback(e=>(Zc===null&&(Zc=new um(null,e)),Zc))),Eb=Object.freeze({tagFor(r){return dm.get(r)},responsibleFor(r){let e=r.$$designSystem$$;return e||Pt.findResponsibleContainer(r).get(Yu)},getOrCreate(r){if(!r)return Zc===null&&(Zc=Pt.getOrCreateDOMContainer().get(Yu)),Zc;let e=r.$$designSystem$$;if(e)return e;let t=Pt.getOrCreateDOMContainer(r);if(t.has(Yu,!1))return t.get(Yu);{let o=new um(r,t);return t.register(Ml.instance(Yu,o)),o}}});um=class{constructor(e,t){this.owner=e,this.container=t,this.designTokensInitialized=!1,this.prefix="fast",this.shadowRootMode=void 0,this.disambiguate=()=>Sb.definitionCallbackOnly,e!==null&&(e.$$designSystem$$=this)}withPrefix(e){return this.prefix=e,this}withShadowRootMode(e){return this.shadowRootMode=e,this}withElementDisambiguation(e){return this.disambiguate=e,this}withDesignTokenRoot(e){return this.designTokenRoot=e,this}register(...e){let t=this.container,o=[],i=this.disambiguate,n=this.shadowRootMode,s={elementPrefix:this.prefix,tryDefineElement(a,u,h){let p=U9(a,u,h),{name:f,callback:b,baseClass:x}=p,{type:S}=p,R=f,z=_b.get(R),we=!0;for(;z;){let re=i(R,S,z);switch(re){case Sb.ignoreDuplicate:return;case Sb.definitionCallbackOnly:we=!1,z=void 0;break;default:R=re,z=_b.get(R);break}}we&&((dm.has(S)||S===q)&&(S=class extends S{}),_b.set(R,S),dm.set(S,R),x&&dm.set(x,R)),o.push(new Tb(t,R,S,n,b,we))}};this.designTokensInitialized||(this.designTokensInitialized=!0,this.designTokenRoot!==null&&et.registerRoot(this.designTokenRoot)),t.registerWithContext(s,...e);for(let a of o)a.callback(a),a.willDefine&&a.definition!==null&&a.definition.define();return this}},Tb=class{constructor(e,t,o,i,n,s){this.container=e,this.name=t,this.type=o,this.shadowRootMode=i,this.callback=n,this.willDefine=s,this.definition=null}definePresentation(e){Zf.define(this.name,e,this.container)}defineElement(e){this.definition=new zn(this.type,Object.assign(Object.assign({},e),{name:this.name}))}tagFor(e){return Eb.tagFor(e)}}});var dE=y(()=>{l();c();d()});var uE=y(()=>{l();c();d();cE();Jf();dE()});var hE=y(()=>{l();c();d()});var pE=y(()=>{l();c();d();Wf()});var fE,mE=y(()=>{l();c();d();A();fE=(r,e)=>O`
    <div class="positioning-region" part="positioning-region">
        ${Xe(t=>t.modal,O`
                <div
                    class="overlay"
                    part="overlay"
                    role="presentation"
                    @click="${t=>t.dismiss()}"
                ></div>
            `)}
        <div
            role="dialog"
            tabindex="-1"
            class="control"
            part="control"
            aria-modal="${t=>t.modal}"
            aria-describedby="${t=>t.ariaDescribedby}"
            aria-labelledby="${t=>t.ariaLabelledby}"
            aria-label="${t=>t.ariaLabel}"
            ${Ie("dialog")}
        >
            <slot></slot>
        </div>
    </div>
`});var vE,B9,yE,Zu,Ib,z9,bE,V9,q9,G9,j9,K9,W9,gE,Q9,Y9,wE,Z9,Ab,J9,Rb,Pb=y(()=>{l();c();d();vE=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],B9=vE.join(","),yE=typeof Element>"u",Zu=yE?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Ib=!yE&&Element.prototype.getRootNode?function(r){return r.getRootNode()}:function(r){return r.ownerDocument},z9=function(e,t){return e.tabIndex<0&&(t||/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||e.isContentEditable)&&isNaN(parseInt(e.getAttribute("tabindex"),10))?0:e.tabIndex},bE=function(e){return e.tagName==="INPUT"},V9=function(e){return bE(e)&&e.type==="hidden"},q9=function(e){var t=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(o){return o.tagName==="SUMMARY"});return t},G9=function(e,t){for(var o=0;o<e.length;o++)if(e[o].checked&&e[o].form===t)return e[o]},j9=function(e){if(!e.name)return!0;var t=e.form||Ib(e),o=function(a){return t.querySelectorAll('input[type="radio"][name="'+a+'"]')},i;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")i=o(window.CSS.escape(e.name));else try{i=o(e.name)}catch(s){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",s.message),!1}var n=G9(i,e.form);return!n||n===e},K9=function(e){return bE(e)&&e.type==="radio"},W9=function(e){return K9(e)&&!j9(e)},gE=function(e){var t=e.getBoundingClientRect(),o=t.width,i=t.height;return o===0&&i===0},Q9=function(e,t){var o=t.displayCheck,i=t.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var n=Zu.call(e,"details>summary:first-of-type"),s=n?e.parentElement:e;if(Zu.call(s,"details:not([open]) *"))return!0;var a=Ib(e).host,u=a?.ownerDocument.contains(a)||e.ownerDocument.contains(e);if(!o||o==="full"){if(typeof i=="function"){for(var h=e;e;){var p=e.parentElement,f=Ib(e);if(p&&!p.shadowRoot&&i(p)===!0)return gE(e);e.assignedSlot?e=e.assignedSlot:!p&&f!==e.ownerDocument?e=f.host:e=p}e=h}if(u)return!e.getClientRects().length}else if(o==="non-zero-area")return gE(e);return!1},Y9=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if(t.tagName==="FIELDSET"&&t.disabled){for(var o=0;o<t.children.length;o++){var i=t.children.item(o);if(i.tagName==="LEGEND")return Zu.call(t,"fieldset[disabled] *")?!0:!i.contains(e)}return!0}t=t.parentElement}return!1},wE=function(e,t){return!(t.disabled||V9(t)||Q9(t,e)||q9(t)||Y9(t))},Z9=function(e,t){return!(W9(t)||z9(t)<0||!wE(e,t))},Ab=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Zu.call(e,B9)===!1?!1:Z9(t,e)},J9=vE.concat("iframe").join(","),Rb=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Zu.call(e,J9)===!1?!1:wE(t,e)}});var jn,CE=y(()=>{l();c();d();$e();A();be();Pb();Ue();jn=class r extends q{constructor(){super(...arguments),this.modal=!0,this.hidden=!1,this.trapFocus=!0,this.trapFocusChanged=()=>{this.$fastController.isConnected&&this.updateTrapFocus()},this.isTrappingFocus=!1,this.handleDocumentKeydown=e=>{if(!e.defaultPrevented&&!this.hidden)switch(e.key){case Yo:this.dismiss(),e.preventDefault();break;case Ca:this.handleTabKeyDown(e);break}},this.handleDocumentFocus=e=>{!e.defaultPrevented&&this.shouldForceFocus(e.target)&&(this.focusFirstElement(),e.preventDefault())},this.handleTabKeyDown=e=>{if(!this.trapFocus||this.hidden)return;let t=this.getTabQueueBounds();if(t.length!==0){if(t.length===1){t[0].focus(),e.preventDefault();return}e.shiftKey&&e.target===t[0]?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&e.target===t[t.length-1]&&(t[0].focus(),e.preventDefault())}},this.getTabQueueBounds=()=>{let e=[];return r.reduceTabbableItems(e,this)},this.focusFirstElement=()=>{let e=this.getTabQueueBounds();e.length>0?e[0].focus():this.dialog instanceof HTMLElement&&this.dialog.focus()},this.shouldForceFocus=e=>this.isTrappingFocus&&!this.contains(e),this.shouldTrapFocus=()=>this.trapFocus&&!this.hidden,this.updateTrapFocus=e=>{let t=e===void 0?this.shouldTrapFocus():e;t&&!this.isTrappingFocus?(this.isTrappingFocus=!0,document.addEventListener("focusin",this.handleDocumentFocus),Z.queueUpdate(()=>{this.shouldForceFocus(document.activeElement)&&this.focusFirstElement()})):!t&&this.isTrappingFocus&&(this.isTrappingFocus=!1,document.removeEventListener("focusin",this.handleDocumentFocus))}}dismiss(){this.$emit("dismiss"),this.$emit("cancel")}show(){this.hidden=!1}hide(){this.hidden=!0,this.$emit("close")}connectedCallback(){super.connectedCallback(),document.addEventListener("keydown",this.handleDocumentKeydown),this.notifier=fe.getNotifier(this),this.notifier.subscribe(this,"hidden"),this.updateTrapFocus()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleDocumentKeydown),this.updateTrapFocus(!1),this.notifier.unsubscribe(this,"hidden")}handleChange(e,t){switch(t){case"hidden":this.updateTrapFocus();break;default:break}}static reduceTabbableItems(e,t){return t.getAttribute("tabindex")==="-1"?e:Ab(t)||r.isFocusableFastElement(t)&&r.hasTabbableShadow(t)?(e.push(t),e):t.childElementCount?e.concat(Array.from(t.children).reduce(r.reduceTabbableItems,[])):e}static isFocusableFastElement(e){var t,o;return!!(!((o=(t=e.$fastController)===null||t===void 0?void 0:t.definition.shadowOptions)===null||o===void 0)&&o.delegatesFocus)}static hasTabbableShadow(e){var t,o;return Array.from((o=(t=e.shadowRoot)===null||t===void 0?void 0:t.querySelectorAll("*"))!==null&&o!==void 0?o:[]).some(i=>Ab(i))}};w([C({mode:"boolean"})],jn.prototype,"modal",void 0);w([C({mode:"boolean"})],jn.prototype,"hidden",void 0);w([C({attribute:"trap-focus",mode:"boolean"})],jn.prototype,"trapFocus",void 0);w([C({attribute:"aria-describedby"})],jn.prototype,"ariaDescribedby",void 0);w([C({attribute:"aria-labelledby"})],jn.prototype,"ariaLabelledby",void 0);w([C({attribute:"aria-label"})],jn.prototype,"ariaLabel",void 0)});var xE=y(()=>{l();c();d();mE();CE()});var X9,hm,kE=y(()=>{l();c();d();A();X9=new MutationObserver(r=>{for(let e of r)hm.getOrCreateFor(e.target).notify(e.attributeName)}),hm=class r extends Un{constructor(e){super(e),this.watchedAttributes=new Set,r.subscriberCache.set(e,this)}subscribe(e){super.subscribe(e),this.watchedAttributes.has(e.attributes)||(this.watchedAttributes.add(e.attributes),this.observe())}unsubscribe(e){super.unsubscribe(e),this.watchedAttributes.has(e.attributes)&&(this.watchedAttributes.delete(e.attributes),this.observe())}static getOrCreateFor(e){return this.subscriberCache.get(e)||new r(e)}observe(){let e=[];for(let t of this.watchedAttributes.values())for(let o=0;o<t.length;o++)e.push(t[o]);X9.observe(this.source,{attributeFilter:e})}};hm.subscriberCache=new WeakMap});var SE=y(()=>{l();c();d();A()});var pm,_E=y(()=>{l();c();d();$e();A();Ue();pm=class extends q{connectedCallback(){super.connectedCallback(),this.setup()}disconnectedCallback(){super.disconnectedCallback(),this.details.removeEventListener("toggle",this.onToggle)}show(){this.details.open=!0}hide(){this.details.open=!1}toggle(){this.details.open=!this.details.open}setup(){this.onToggle=this.onToggle.bind(this),this.details.addEventListener("toggle",this.onToggle),this.expanded&&this.show()}onToggle(){this.expanded=this.details.open,this.$emit("toggle")}};w([C({mode:"boolean"})],pm.prototype,"expanded",void 0);w([C],pm.prototype,"title",void 0)});var TE=y(()=>{l();c();d();SE();_E()});var EE,IE=y(()=>{l();c();d();A();EE=(r,e)=>O`
    <template role="${t=>t.role}" aria-orientation="${t=>t.orientation}"></template>
`});var AE,RE=y(()=>{l();c();d();AE={separator:"separator",presentation:"presentation"}});var Ra,PE=y(()=>{l();c();d();$e();A();be();Ue();RE();Ra=class extends q{constructor(){super(...arguments),this.role=AE.separator,this.orientation=Tt.horizontal}};w([C],Ra.prototype,"role",void 0);w([C],Ra.prototype,"orientation",void 0)});var $E=y(()=>{l();c();d();IE();PE()});var Ju,$b=y(()=>{l();c();d();Ju={next:"next",previous:"previous"}});var OE,ME=y(()=>{l();c();d();A();$b();OE=(r,e)=>O`
    <template
        role="button"
        aria-disabled="${t=>t.disabled?!0:void 0}"
        tabindex="${t=>t.hiddenFromAT?-1:0}"
        class="${t=>t.direction} ${t=>t.disabled?"disabled":""}"
        @keyup="${(t,o)=>t.keyupHandler(o.event)}"
    >
        ${Xe(t=>t.direction===Ju.next,O`
                <span part="next" class="next">
                    <slot name="next">
                        ${e.next||""}
                    </slot>
                </span>
            `)}
        ${Xe(t=>t.direction===Ju.previous,O`
                <span part="previous" class="previous">
                    <slot name="previous">
                        ${e.previous||""}
                    </slot>
                </span>
            `)}
    </template>
`});var zl,FE=y(()=>{l();c();d();$e();A();Ue();$b();zl=class extends q{constructor(){super(...arguments),this.hiddenFromAT=!0,this.direction=Ju.next}keyupHandler(e){if(!this.hiddenFromAT){let t=e.key;(t==="Enter"||t==="Space")&&this.$emit("click",e),t==="Escape"&&this.blur()}}};w([C({mode:"boolean"})],zl.prototype,"disabled",void 0);w([C({attribute:"aria-hidden",converter:Is})],zl.prototype,"hiddenFromAT",void 0);w([C],zl.prototype,"direction",void 0)});var DE=y(()=>{l();c();d();ME();FE()});var LE=y(()=>{l();c();d();Jo()});var NE=y(()=>{l();c();d();Ue()});var HE,UE=y(()=>{l();c();d();A();Mt();HE=(r,e)=>O`
    <template
        aria-checked="${t=>t.ariaChecked}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-posinset="${t=>t.ariaPosInSet}"
        aria-selected="${t=>t.ariaSelected}"
        aria-setsize="${t=>t.ariaSetSize}"
        class="${t=>[t.checked&&"checked",t.selected&&"selected",t.disabled&&"disabled"].filter(Boolean).join(" ")}"
        role="option"
    >
        ${kt(r,e)}
        <span class="content" part="content">
            <slot ${Le("content")}></slot>
        </span>
        ${xt(r,e)}
    </template>
`});var BE=y(()=>{l();c();d();cb();UE()});var Os,fm=y(()=>{l();c();d();$e();A();be();Ea();Os=class extends hr{constructor(){super(...arguments),this.activeIndex=-1,this.rangeStartIndex=-1}get activeOption(){return this.options[this.activeIndex]}get checkedOptions(){var e;return(e=this.options)===null||e===void 0?void 0:e.filter(t=>t.checked)}get firstSelectedOptionIndex(){return this.options.indexOf(this.firstSelectedOption)}activeIndexChanged(e,t){var o,i;this.ariaActiveDescendant=(i=(o=this.options[t])===null||o===void 0?void 0:o.id)!==null&&i!==void 0?i:"",this.focusAndScrollOptionIntoView()}checkActiveIndex(){if(!this.multiple)return;let e=this.activeOption;e&&(e.checked=!0)}checkFirstOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex+1),this.options.forEach((t,o)=>{t.checked=Uu(o,this.rangeStartIndex)})):this.uncheckAllOptions(),this.activeIndex=0,this.checkActiveIndex()}checkLastOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.options.forEach((t,o)=>{t.checked=Uu(o,this.rangeStartIndex,this.options.length)})):this.uncheckAllOptions(),this.activeIndex=this.options.length-1,this.checkActiveIndex()}connectedCallback(){super.connectedCallback(),this.addEventListener("focusout",this.focusoutHandler)}disconnectedCallback(){this.removeEventListener("focusout",this.focusoutHandler),super.disconnectedCallback()}checkNextOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.options.forEach((t,o)=>{t.checked=Uu(o,this.rangeStartIndex,this.activeIndex+1)})):this.uncheckAllOptions(),this.activeIndex+=this.activeIndex<this.options.length-1?1:0,this.checkActiveIndex()}checkPreviousOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.checkedOptions.length===1&&(this.rangeStartIndex+=1),this.options.forEach((t,o)=>{t.checked=Uu(o,this.activeIndex,this.rangeStartIndex)})):this.uncheckAllOptions(),this.activeIndex-=this.activeIndex>0?1:0,this.checkActiveIndex()}clickHandler(e){var t;if(!this.multiple)return super.clickHandler(e);let o=(t=e.target)===null||t===void 0?void 0:t.closest("[role=option]");if(!(!o||o.disabled))return this.uncheckAllOptions(),this.activeIndex=this.options.indexOf(o),this.checkActiveIndex(),this.toggleSelectedForAllCheckedOptions(),!0}focusAndScrollOptionIntoView(){super.focusAndScrollOptionIntoView(this.activeOption)}focusinHandler(e){if(!this.multiple)return super.focusinHandler(e);!this.shouldSkipFocus&&e.target===e.currentTarget&&(this.uncheckAllOptions(),this.activeIndex===-1&&(this.activeIndex=this.firstSelectedOptionIndex!==-1?this.firstSelectedOptionIndex:0),this.checkActiveIndex(),this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}focusoutHandler(e){this.multiple&&this.uncheckAllOptions()}keydownHandler(e){if(!this.multiple)return super.keydownHandler(e);if(this.disabled)return!0;let{key:t,shiftKey:o}=e;switch(this.shouldSkipFocus=!1,t){case Tr:{this.checkFirstOption(o);return}case Wt:{this.checkNextOption(o);return}case Qt:{this.checkPreviousOption(o);return}case Er:{this.checkLastOption(o);return}case Ca:return this.focusAndScrollOptionIntoView(),!0;case Yo:return this.uncheckAllOptions(),this.checkActiveIndex(),!0;case Zo:if(e.preventDefault(),this.typeAheadExpired){this.toggleSelectedForAllCheckedOptions();return}default:return t.length===1&&this.handleTypeAhead(`${t}`),!0}}mousedownHandler(e){if(e.offsetX>=0&&e.offsetX<=this.scrollWidth)return super.mousedownHandler(e)}multipleChanged(e,t){var o;this.ariaMultiSelectable=t?"true":null,(o=this.options)===null||o===void 0||o.forEach(i=>{i.checked=t?!1:void 0}),this.setSelectedOptions()}setSelectedOptions(){if(!this.multiple){super.setSelectedOptions();return}this.$fastController.isConnected&&this.options&&(this.selectedOptions=this.options.filter(e=>e.selected),this.focusAndScrollOptionIntoView())}sizeChanged(e,t){var o;let i=Math.max(0,parseInt((o=t?.toFixed())!==null&&o!==void 0?o:"",10));i!==t&&Z.queueUpdate(()=>{this.size=i})}toggleSelectedForAllCheckedOptions(){let e=this.checkedOptions.filter(o=>!o.disabled),t=!e.every(o=>o.selected);e.forEach(o=>o.selected=t),this.selectedIndex=this.options.indexOf(e[e.length-1]),this.setSelectedOptions()}typeaheadBufferChanged(e,t){if(!this.multiple){super.typeaheadBufferChanged(e,t);return}if(this.$fastController.isConnected){let o=this.getTypeaheadMatches(),i=this.options.indexOf(o[0]);i>-1&&(this.activeIndex=i,this.uncheckAllOptions(),this.checkActiveIndex()),this.typeAheadExpired=!1}}uncheckAllOptions(e=!1){this.options.forEach(t=>t.checked=this.multiple?!1:void 0),e||(this.rangeStartIndex=-1)}};w([I],Os.prototype,"activeIndex",void 0);w([C({mode:"boolean"})],Os.prototype,"multiple",void 0);w([C({converter:ie})],Os.prototype,"size",void 0)});var zE,VE=y(()=>{l();c();d();A();fm();zE=(r,e)=>O`
    <template
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        class="listbox"
        role="listbox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        <slot
            ${Le({filter:Os.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
        ></slot>
    </template>
`});var qE=y(()=>{l();c();d();Ea();fm();VE()});var Vl,Ob=y(()=>{l();c();d();$e();be();A();Ue();Vl=class extends q{constructor(){super(...arguments),this.optionElements=[]}menuElementsChanged(){this.updateOptions()}headerElementsChanged(){this.updateOptions()}footerElementsChanged(){this.updateOptions()}updateOptions(){this.optionElements.splice(0,this.optionElements.length),this.addSlottedListItems(this.headerElements),this.addSlottedListItems(this.menuElements),this.addSlottedListItems(this.footerElements),this.$emit("optionsupdated",{bubbles:!1})}addSlottedListItems(e){e!==void 0&&e.forEach(t=>{t.nodeType===1&&t.getAttribute("role")==="listitem"&&(t.id=t.id||gi("option-"),this.optionElements.push(t))})}};w([I],Vl.prototype,"menuElements",void 0);w([I],Vl.prototype,"headerElements",void 0);w([I],Vl.prototype,"footerElements",void 0);w([I],Vl.prototype,"suggestionsAvailableText",void 0)});var eO,ql,mm=y(()=>{l();c();d();$e();A();Ue();eO=O`
    <template>
        ${r=>r.value}
    </template>
`,ql=class extends q{contentsTemplateChanged(){this.$fastController.isConnected&&this.updateView()}connectedCallback(){super.connectedCallback(),this.updateView()}disconnectedCallback(){super.disconnectedCallback(),this.disconnectView()}handleClick(e){return e.defaultPrevented||this.handleInvoked(),!1}handleInvoked(){this.$emit("pickeroptioninvoked")}updateView(){var e,t;this.disconnectView(),this.customView=(t=(e=this.contentsTemplate)===null||e===void 0?void 0:e.render(this,this))!==null&&t!==void 0?t:eO.render(this,this)}disconnectView(){var e;(e=this.customView)===null||e===void 0||e.dispose(),this.customView=void 0}};w([C({attribute:"value"})],ql.prototype,"value",void 0);w([I],ql.prototype,"contentsTemplate",void 0)});var Mb=y(()=>{l();c();d();Ue()});var tO,Gl,gm=y(()=>{l();c();d();$e();A();be();Ue();tO=O`
    <template>
        ${r=>r.value}
    </template>
`,Gl=class extends q{contentsTemplateChanged(){this.$fastController.isConnected&&this.updateView()}connectedCallback(){super.connectedCallback(),this.updateView()}disconnectedCallback(){this.disconnectView(),super.disconnectedCallback()}handleKeyDown(e){return e.defaultPrevented?!1:e.key===dr?(this.handleInvoke(),!1):!0}handleClick(e){return e.defaultPrevented||this.handleInvoke(),!1}handleInvoke(){this.$emit("pickeriteminvoked")}updateView(){var e,t;this.disconnectView(),this.customView=(t=(e=this.contentsTemplate)===null||e===void 0?void 0:e.render(this,this))!==null&&t!==void 0?t:tO.render(this,this)}disconnectView(){var e;(e=this.customView)===null||e===void 0||e.dispose(),this.customView=void 0}};w([C({attribute:"value"})],Gl.prototype,"value",void 0);w([I],Gl.prototype,"contentsTemplate",void 0)});var GE=y(()=>{l();c();d();A();zu();Ob();mm();Mb();gm()});var Fb,vm,jE=y(()=>{l();c();d();Jo();Ue();Fb=class extends q{},vm=class extends Or(Fb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var rO,ht,KE=y(()=>{l();c();d();$e();A();be();eb();mm();gm();jE();rO=O`
    <input
        slot="input-region"
        role="combobox"
        type="text"
        autocapitalize="off"
        autocomplete="off"
        haspopup="list"
        aria-label="${r=>r.label}"
        aria-labelledby="${r=>r.labelledBy}"
        placeholder="${r=>r.placeholder}"
        ${Ie("inputElement")}
    ></input>
`,ht=class extends vm{constructor(){super(...arguments),this.selection="",this.filterSelected=!0,this.filterQuery=!0,this.noSuggestionsText="No suggestions available",this.suggestionsAvailableText="Suggestions available",this.loadingText="Loading suggestions",this.menuPlacement="bottom-fill",this.showLoading=!1,this.optionsList=[],this.filteredOptionsList=[],this.flyoutOpen=!1,this.menuFocusIndex=-1,this.showNoOptions=!1,this.selectedItems=[],this.inputElementView=null,this.handleTextInput=e=>{this.query=this.inputElement.value},this.handleInputClick=e=>{e.preventDefault(),this.toggleFlyout(!0)},this.setRegionProps=()=>{if(this.flyoutOpen){if(this.region===null||this.region===void 0){Z.queueUpdate(this.setRegionProps);return}this.region.anchorElement=this.inputElement}},this.configLookup={top:Yy,bottom:Zy,tallest:Jy,"top-fill":u2,"bottom-fill":Xy,"tallest-fill":h2}}selectionChanged(){this.$fastController.isConnected&&(this.handleSelectionChange(),this.proxy instanceof HTMLInputElement&&(this.proxy.value=this.selection,this.validate()))}optionsChanged(){this.optionsList=this.options.split(",").map(e=>e.trim()).filter(e=>e!=="")}menuPlacementChanged(){this.$fastController.isConnected&&this.updateMenuConfig()}showLoadingChanged(){this.$fastController.isConnected&&Z.queueUpdate(()=>{this.setFocusedOption(0)})}listItemTemplateChanged(){this.updateListItemTemplate()}defaultListItemTemplateChanged(){this.updateListItemTemplate()}menuOptionTemplateChanged(){this.updateOptionTemplate()}defaultMenuOptionTemplateChanged(){this.updateOptionTemplate()}optionsListChanged(){this.updateFilteredOptions()}queryChanged(){this.$fastController.isConnected&&(this.inputElement.value!==this.query&&(this.inputElement.value=this.query),this.updateFilteredOptions(),this.$emit("querychange",{bubbles:!1}))}filteredOptionsListChanged(){this.$fastController.isConnected&&(this.showNoOptions=this.filteredOptionsList.length===0&&this.menuElement.querySelectorAll('[role="listitem"]').length===0,this.setFocusedOption(this.showNoOptions?-1:0))}flyoutOpenChanged(){this.flyoutOpen?(Z.queueUpdate(this.setRegionProps),this.$emit("menuopening",{bubbles:!1})):this.$emit("menuclosing",{bubbles:!1})}showNoOptionsChanged(){this.$fastController.isConnected&&Z.queueUpdate(()=>{this.setFocusedOption(0)})}connectedCallback(){super.connectedCallback(),this.listElement=document.createElement(this.selectedListTag),this.appendChild(this.listElement),this.itemsPlaceholderElement=document.createComment(""),this.listElement.append(this.itemsPlaceholderElement),this.inputElementView=rO.render(this,this.listElement);let e=this.menuTag.toUpperCase();this.menuElement=Array.from(this.children).find(t=>t.tagName===e),this.menuElement===void 0&&(this.menuElement=document.createElement(this.menuTag),this.appendChild(this.menuElement)),this.menuElement.id===""&&(this.menuElement.id=gi("listbox-")),this.menuId=this.menuElement.id,this.optionsPlaceholder=document.createComment(""),this.menuElement.append(this.optionsPlaceholder),this.updateMenuConfig(),Z.queueUpdate(()=>this.initialize())}disconnectedCallback(){super.disconnectedCallback(),this.toggleFlyout(!1),this.inputElement.removeEventListener("input",this.handleTextInput),this.inputElement.removeEventListener("click",this.handleInputClick),this.inputElementView!==null&&(this.inputElementView.dispose(),this.inputElementView=null)}focus(){this.inputElement.focus()}initialize(){this.updateListItemTemplate(),this.updateOptionTemplate(),this.itemsRepeatBehavior=new Vn(e=>e.selectedItems,e=>e.activeListItemTemplate,{positioning:!0}).createBehavior(this.itemsPlaceholderElement),this.inputElement.addEventListener("input",this.handleTextInput),this.inputElement.addEventListener("click",this.handleInputClick),this.$fastController.addBehaviors([this.itemsRepeatBehavior]),this.menuElement.suggestionsAvailableText=this.suggestionsAvailableText,this.menuElement.addEventListener("optionsupdated",this.handleMenuOptionsUpdated),this.optionsRepeatBehavior=new Vn(e=>e.filteredOptionsList,e=>e.activeMenuOptionTemplate,{positioning:!0}).createBehavior(this.optionsPlaceholder),this.$fastController.addBehaviors([this.optionsRepeatBehavior]),this.handleSelectionChange()}toggleFlyout(e){if(this.flyoutOpen!==e){if(e&&document.activeElement===this.inputElement){this.flyoutOpen=e,Z.queueUpdate(()=>{this.menuElement!==void 0?this.setFocusedOption(0):this.disableMenu()});return}this.flyoutOpen=!1,this.disableMenu()}}handleMenuOptionsUpdated(e){e.preventDefault(),this.flyoutOpen&&this.setFocusedOption(0)}handleKeyDown(e){if(e.defaultPrevented)return!1;switch(e.key){case Wt:{if(!this.flyoutOpen)this.toggleFlyout(!0);else{let t=this.flyoutOpen?Math.min(this.menuFocusIndex+1,this.menuElement.optionElements.length-1):0;this.setFocusedOption(t)}return!1}case Qt:{if(!this.flyoutOpen)this.toggleFlyout(!0);else{let t=this.flyoutOpen?Math.max(this.menuFocusIndex-1,0):0;this.setFocusedOption(t)}return!1}case Yo:return this.toggleFlyout(!1),!1;case dr:return this.menuFocusIndex!==-1&&this.menuElement.optionElements.length>this.menuFocusIndex&&this.menuElement.optionElements[this.menuFocusIndex].click(),!1;case So:return document.activeElement!==this.inputElement?(this.incrementFocusedItem(1),!1):!0;case ko:return this.inputElement.selectionStart===0?(this.incrementFocusedItem(-1),!1):!0;case YT:case QT:{if(document.activeElement===null)return!0;if(document.activeElement===this.inputElement)return this.inputElement.selectionStart===0?(this.selection=this.selectedItems.slice(0,this.selectedItems.length-1).toString(),this.toggleFlyout(!1),!1):!0;let t=Array.from(this.listElement.children),o=t.indexOf(document.activeElement);return o>-1?(this.selection=this.selectedItems.splice(o,1).toString(),Z.queueUpdate(()=>{t[Math.min(t.length,o)].focus()}),!1):!0}}return this.toggleFlyout(!0),!0}handleFocusIn(e){return!1}handleFocusOut(e){return(this.menuElement===void 0||!this.menuElement.contains(e.relatedTarget))&&this.toggleFlyout(!1),!1}handleSelectionChange(){this.selectedItems.toString()!==this.selection&&(this.selectedItems=this.selection===""?[]:this.selection.split(","),this.updateFilteredOptions(),Z.queueUpdate(()=>{this.checkMaxItems()}),this.$emit("selectionchange",{bubbles:!1}))}handleRegionLoaded(e){Z.queueUpdate(()=>{this.setFocusedOption(0),this.$emit("menuloaded",{bubbles:!1})})}checkMaxItems(){if(this.inputElement!==void 0)if(this.maxSelected!==void 0&&this.selectedItems.length>=this.maxSelected){if(document.activeElement===this.inputElement){let e=Array.from(this.listElement.querySelectorAll("[role='listitem']"));e[e.length-1].focus()}this.inputElement.hidden=!0}else this.inputElement.hidden=!1}handleItemInvoke(e){if(e.defaultPrevented)return!1;if(e.target instanceof Gl){let o=Array.from(this.listElement.querySelectorAll("[role='listitem']")).indexOf(e.target);if(o!==-1){let i=this.selectedItems.slice();i.splice(o,1),this.selection=i.toString(),Z.queueUpdate(()=>this.incrementFocusedItem(0))}return!1}return!0}handleOptionInvoke(e){return e.defaultPrevented?!1:e.target instanceof ql?(e.target.value!==void 0&&(this.selection=`${this.selection}${this.selection===""?"":","}${e.target.value}`),this.inputElement.value="",this.query="",this.inputElement.focus(),this.toggleFlyout(!1),!1):!0}incrementFocusedItem(e){if(this.selectedItems.length===0){this.inputElement.focus();return}let t=Array.from(this.listElement.querySelectorAll("[role='listitem']"));if(document.activeElement!==null){let o=t.indexOf(document.activeElement);o===-1&&(o=t.length);let i=Math.min(t.length,Math.max(0,o+e));i===t.length?this.maxSelected!==void 0&&this.selectedItems.length>=this.maxSelected?t[i-1].focus():this.inputElement.focus():t[i].focus()}}disableMenu(){var e,t,o;this.menuFocusIndex=-1,this.menuFocusOptionId=void 0,(e=this.inputElement)===null||e===void 0||e.removeAttribute("aria-activedescendant"),(t=this.inputElement)===null||t===void 0||t.removeAttribute("aria-owns"),(o=this.inputElement)===null||o===void 0||o.removeAttribute("aria-expanded")}setFocusedOption(e){if(!this.flyoutOpen||e===-1||this.showNoOptions||this.showLoading){this.disableMenu();return}if(this.menuElement.optionElements.length===0)return;this.menuElement.optionElements.forEach(o=>{o.setAttribute("aria-selected","false")}),this.menuFocusIndex=e,this.menuFocusIndex>this.menuElement.optionElements.length-1&&(this.menuFocusIndex=this.menuElement.optionElements.length-1),this.menuFocusOptionId=this.menuElement.optionElements[this.menuFocusIndex].id,this.inputElement.setAttribute("aria-owns",this.menuId),this.inputElement.setAttribute("aria-expanded","true"),this.inputElement.setAttribute("aria-activedescendant",this.menuFocusOptionId);let t=this.menuElement.optionElements[this.menuFocusIndex];t.setAttribute("aria-selected","true"),this.menuElement.scrollTo(0,t.offsetTop)}updateListItemTemplate(){var e;this.activeListItemTemplate=(e=this.listItemTemplate)!==null&&e!==void 0?e:this.defaultListItemTemplate}updateOptionTemplate(){var e;this.activeMenuOptionTemplate=(e=this.menuOptionTemplate)!==null&&e!==void 0?e:this.defaultMenuOptionTemplate}updateFilteredOptions(){this.filteredOptionsList=this.optionsList.slice(0),this.filterSelected&&(this.filteredOptionsList=this.filteredOptionsList.filter(e=>this.selectedItems.indexOf(e)===-1)),this.filterQuery&&this.query!==""&&this.query!==void 0&&(this.filteredOptionsList=this.filteredOptionsList.filter(e=>e.indexOf(this.query)!==-1))}updateMenuConfig(){let e=this.configLookup[this.menuPlacement];e===null&&(e=Xy),this.menuConfig=Object.assign(Object.assign({},e),{autoUpdateMode:"auto",fixedPlacement:!0,horizontalViewportLock:!1,verticalViewportLock:!1})}};w([C({attribute:"selection"})],ht.prototype,"selection",void 0);w([C({attribute:"options"})],ht.prototype,"options",void 0);w([C({attribute:"filter-selected",mode:"boolean"})],ht.prototype,"filterSelected",void 0);w([C({attribute:"filter-query",mode:"boolean"})],ht.prototype,"filterQuery",void 0);w([C({attribute:"max-selected"})],ht.prototype,"maxSelected",void 0);w([C({attribute:"no-suggestions-text"})],ht.prototype,"noSuggestionsText",void 0);w([C({attribute:"suggestions-available-text"})],ht.prototype,"suggestionsAvailableText",void 0);w([C({attribute:"loading-text"})],ht.prototype,"loadingText",void 0);w([C({attribute:"label"})],ht.prototype,"label",void 0);w([C({attribute:"labelledby"})],ht.prototype,"labelledBy",void 0);w([C({attribute:"placeholder"})],ht.prototype,"placeholder",void 0);w([C({attribute:"menu-placement"})],ht.prototype,"menuPlacement",void 0);w([I],ht.prototype,"showLoading",void 0);w([I],ht.prototype,"listItemTemplate",void 0);w([I],ht.prototype,"defaultListItemTemplate",void 0);w([I],ht.prototype,"activeListItemTemplate",void 0);w([I],ht.prototype,"menuOptionTemplate",void 0);w([I],ht.prototype,"defaultMenuOptionTemplate",void 0);w([I],ht.prototype,"activeMenuOptionTemplate",void 0);w([I],ht.prototype,"listItemContentsTemplate",void 0);w([I],ht.prototype,"menuOptionContentsTemplate",void 0);w([I],ht.prototype,"optionsList",void 0);w([I],ht.prototype,"query",void 0);w([I],ht.prototype,"filteredOptionsList",void 0);w([I],ht.prototype,"flyoutOpen",void 0);w([I],ht.prototype,"menuId",void 0);w([I],ht.prototype,"selectedListTag",void 0);w([I],ht.prototype,"menuTag",void 0);w([I],ht.prototype,"menuFocusIndex",void 0);w([I],ht.prototype,"menuFocusOptionId",void 0);w([I],ht.prototype,"showNoOptions",void 0);w([I],ht.prototype,"menuConfig",void 0);w([I],ht.prototype,"selectedItems",void 0)});var WE=y(()=>{l();c();d();A()});var QE=y(()=>{l();c();d();A()});var YE=y(()=>{l();c();d();A()});var ZE=y(()=>{l();c();d();A()});var JE=y(()=>{l();c();d();GE();KE();WE();Ob();QE();mm();YE();Mb();ZE();gm()});var Kr,Db,XE=y(()=>{l();c();d();Kr={menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio"},Db={[Kr.menuitem]:"menuitem",[Kr.menuitemcheckbox]:"menuitemcheckbox",[Kr.menuitemradio]:"menuitemradio"}});var Wr,Lb=y(()=>{l();c();d();$e();A();be();Ue();Mt();Sa();jr();XE();Wr=class extends q{constructor(){super(...arguments),this.role=Kr.menuitem,this.hasSubmenu=!1,this.currentDirection=ot.ltr,this.focusSubmenuOnLoad=!1,this.handleMenuItemKeyDown=e=>{if(e.defaultPrevented)return!1;switch(e.key){case dr:case Zo:return this.invoke(),!1;case So:return this.expandAndFocus(),!1;case ko:if(this.expanded)return this.expanded=!1,this.focus(),!1}return!0},this.handleMenuItemClick=e=>(e.defaultPrevented||this.disabled||this.invoke(),!1),this.submenuLoaded=()=>{this.focusSubmenuOnLoad&&(this.focusSubmenuOnLoad=!1,this.hasSubmenu&&(this.submenu.focus(),this.setAttribute("tabindex","-1")))},this.handleMouseOver=e=>(this.disabled||!this.hasSubmenu||this.expanded||(this.expanded=!0),!1),this.handleMouseOut=e=>(!this.expanded||this.contains(document.activeElement)||(this.expanded=!1),!1),this.expandAndFocus=()=>{this.hasSubmenu&&(this.focusSubmenuOnLoad=!0,this.expanded=!0)},this.invoke=()=>{if(!this.disabled)switch(this.role){case Kr.menuitemcheckbox:this.checked=!this.checked;break;case Kr.menuitem:this.updateSubmenu(),this.hasSubmenu?this.expandAndFocus():this.$emit("change");break;case Kr.menuitemradio:this.checked||(this.checked=!0);break}},this.updateSubmenu=()=>{this.submenu=this.domChildren().find(e=>e.getAttribute("role")==="menu"),this.hasSubmenu=this.submenu!==void 0}}expandedChanged(e){if(this.$fastController.isConnected){if(this.submenu===void 0)return;this.expanded===!1?this.submenu.collapseExpandedItem():this.currentDirection=vi(this),this.$emit("expanded-change",this,{bubbles:!1})}}checkedChanged(e,t){this.$fastController.isConnected&&this.$emit("change")}connectedCallback(){super.connectedCallback(),Z.queueUpdate(()=>{this.updateSubmenu()}),this.startColumnCount||(this.startColumnCount=1),this.observer=new MutationObserver(this.updateSubmenu)}disconnectedCallback(){super.disconnectedCallback(),this.submenu=void 0,this.observer!==void 0&&(this.observer.disconnect(),this.observer=void 0)}domChildren(){return Array.from(this.children).filter(e=>!e.hasAttribute("hidden"))}};w([C({mode:"boolean"})],Wr.prototype,"disabled",void 0);w([C({mode:"boolean"})],Wr.prototype,"expanded",void 0);w([I],Wr.prototype,"startColumnCount",void 0);w([C],Wr.prototype,"role",void 0);w([C({mode:"boolean"})],Wr.prototype,"checked",void 0);w([I],Wr.prototype,"submenuRegion",void 0);w([I],Wr.prototype,"hasSubmenu",void 0);w([I],Wr.prototype,"currentDirection",void 0);w([I],Wr.prototype,"submenu",void 0);Ye(Wr,_t)});var e5,t5=y(()=>{l();c();d();A();zu();Mt();Lb();e5=(r,e)=>O`
    <template
        role="${t=>t.role}"
        aria-haspopup="${t=>t.hasSubmenu?"menu":void 0}"
        aria-checked="${t=>t.role!==Kr.menuitem?t.checked:void 0}"
        aria-disabled="${t=>t.disabled}"
        aria-expanded="${t=>t.expanded}"
        @keydown="${(t,o)=>t.handleMenuItemKeyDown(o.event)}"
        @click="${(t,o)=>t.handleMenuItemClick(o.event)}"
        @mouseover="${(t,o)=>t.handleMouseOver(o.event)}"
        @mouseout="${(t,o)=>t.handleMouseOut(o.event)}"
        class="${t=>t.disabled?"disabled":""} ${t=>t.expanded?"expanded":""} ${t=>`indent-${t.startColumnCount}`}"
    >
            ${Xe(t=>t.role===Kr.menuitemcheckbox,O`
                    <div part="input-container" class="input-container">
                        <span part="checkbox" class="checkbox">
                            <slot name="checkbox-indicator">
                                ${e.checkboxIndicator||""}
                            </slot>
                        </span>
                    </div>
                `)}
            ${Xe(t=>t.role===Kr.menuitemradio,O`
                    <div part="input-container" class="input-container">
                        <span part="radio" class="radio">
                            <slot name="radio-indicator">
                                ${e.radioIndicator||""}
                            </slot>
                        </span>
                    </div>
                `)}
        </div>
        ${kt(r,e)}
        <span class="content" part="content">
            <slot></slot>
        </span>
        ${xt(r,e)}
        ${Xe(t=>t.hasSubmenu,O`
                <div
                    part="expand-collapse-glyph-container"
                    class="expand-collapse-glyph-container"
                >
                    <span part="expand-collapse" class="expand-collapse">
                        <slot name="expand-collapse-indicator">
                            ${e.expandCollapseGlyph||""}
                        </slot>
                    </span>
                </div>
            `)}
        ${Xe(t=>t.expanded,O`
                <${r.tagFor(Fe)}
                    :anchorElement="${t=>t}"
                    vertical-positioning-mode="dynamic"
                    vertical-default-position="bottom"
                    vertical-inset="true"
                    horizontal-positioning-mode="dynamic"
                    horizontal-default-position="end"
                    class="submenu-region"
                    dir="${t=>t.currentDirection}"
                    @loaded="${t=>t.submenuLoaded()}"
                    ${Ie("submenuRegion")}
                    part="submenu-region"
                >
                    <slot name="submenu"></slot>
                </${r.tagFor(Fe)}>
            `)}
    </template>
`});var Nb=y(()=>{l();c();d();t5();Lb()});var r5,o5=y(()=>{l();c();d();A();r5=(r,e)=>O`
    <template
        slot="${t=>t.slot?t.slot:t.isNestedMenu()?"submenu":void 0}"
        role="menu"
        @keydown="${(t,o)=>t.handleMenuKeyDown(o.event)}"
        @focusout="${(t,o)=>t.handleFocusOut(o.event)}"
    >
        <slot ${Le("items")}></slot>
    </template>
`});var jl,i5=y(()=>{l();c();d();$e();A();be();Nb();Ue();jl=class r extends q{constructor(){super(...arguments),this.expandedItem=null,this.focusIndex=-1,this.isNestedMenu=()=>this.parentElement!==null&&qn(this.parentElement)&&this.parentElement.getAttribute("role")==="menuitem",this.handleFocusOut=e=>{if(!this.contains(e.relatedTarget)&&this.menuItems!==void 0){this.collapseExpandedItem();let t=this.menuItems.findIndex(this.isFocusableElement);this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.menuItems[t].setAttribute("tabindex","0"),this.focusIndex=t}},this.handleItemFocus=e=>{let t=e.target;this.menuItems!==void 0&&t!==this.menuItems[this.focusIndex]&&(this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=this.menuItems.indexOf(t),t.setAttribute("tabindex","0"))},this.handleExpandedChanged=e=>{if(e.defaultPrevented||e.target===null||this.menuItems===void 0||this.menuItems.indexOf(e.target)<0)return;e.preventDefault();let t=e.target;if(this.expandedItem!==null&&t===this.expandedItem&&t.expanded===!1){this.expandedItem=null;return}t.expanded&&(this.expandedItem!==null&&this.expandedItem!==t&&(this.expandedItem.expanded=!1),this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.expandedItem=t,this.focusIndex=this.menuItems.indexOf(t),t.setAttribute("tabindex","0"))},this.removeItemListeners=()=>{this.menuItems!==void 0&&this.menuItems.forEach(e=>{e.removeEventListener("expanded-change",this.handleExpandedChanged),e.removeEventListener("focus",this.handleItemFocus)})},this.setItems=()=>{let e=this.domChildren();this.removeItemListeners(),this.menuItems=e;let t=this.menuItems.filter(this.isMenuItemElement);t.length&&(this.focusIndex=0);function o(n){let s=n.getAttribute("role"),a=n.querySelector("[slot=start]");return s!==Kr.menuitem&&a===null||s===Kr.menuitem&&a!==null?1:s!==Kr.menuitem&&a!==null?2:0}let i=t.reduce((n,s)=>{let a=o(s);return n>a?n:a},0);t.forEach((n,s)=>{n.setAttribute("tabindex",s===0?"0":"-1"),n.addEventListener("expanded-change",this.handleExpandedChanged),n.addEventListener("focus",this.handleItemFocus),n instanceof Wr&&(n.startColumnCount=i)})},this.changeHandler=e=>{if(this.menuItems===void 0)return;let t=e.target,o=this.menuItems.indexOf(t);if(o!==-1&&t.role==="menuitemradio"&&t.checked===!0){for(let n=o-1;n>=0;--n){let s=this.menuItems[n],a=s.getAttribute("role");if(a===Kr.menuitemradio&&(s.checked=!1),a==="separator")break}let i=this.menuItems.length-1;for(let n=o+1;n<=i;++n){let s=this.menuItems[n],a=s.getAttribute("role");if(a===Kr.menuitemradio&&(s.checked=!1),a==="separator")break}}},this.isMenuItemElement=e=>qn(e)&&r.focusableElementRoles.hasOwnProperty(e.getAttribute("role")),this.isFocusableElement=e=>this.isMenuItemElement(e)}itemsChanged(e,t){this.$fastController.isConnected&&this.menuItems!==void 0&&this.setItems()}connectedCallback(){super.connectedCallback(),Z.queueUpdate(()=>{this.setItems()}),this.addEventListener("change",this.changeHandler)}disconnectedCallback(){super.disconnectedCallback(),this.removeItemListeners(),this.menuItems=void 0,this.removeEventListener("change",this.changeHandler)}focus(){this.setFocus(0,1)}collapseExpandedItem(){this.expandedItem!==null&&(this.expandedItem.expanded=!1,this.expandedItem=null)}handleMenuKeyDown(e){if(!(e.defaultPrevented||this.menuItems===void 0))switch(e.key){case Wt:this.setFocus(this.focusIndex+1,1);return;case Qt:this.setFocus(this.focusIndex-1,-1);return;case Er:this.setFocus(this.menuItems.length-1,-1);return;case Tr:this.setFocus(0,1);return;default:return!0}}domChildren(){return Array.from(this.children).filter(e=>!e.hasAttribute("hidden"))}setFocus(e,t){if(this.menuItems!==void 0)for(;e>=0&&e<this.menuItems.length;){let o=this.menuItems[e];if(this.isFocusableElement(o)){this.focusIndex>-1&&this.menuItems.length>=this.focusIndex-1&&this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=e,o.setAttribute("tabindex","0"),o.focus();break}e+=t}}};jl.focusableElementRoles=Db;w([I],jl.prototype,"items",void 0)});var n5=y(()=>{l();c();d();o5();i5()});var s5,a5=y(()=>{l();c();d();A();Mt();s5=(r,e)=>O`
    <template class="${t=>t.readOnly?"readonly":""}">
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Le("defaultSlottedNodes")}></slot>
        </label>
        <div class="root" part="root">
            ${kt(r,e)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${t=>t.handleTextInput()}"
                @change="${t=>t.handleChange()}"
                @keydown="${(t,o)=>t.handleKeyDown(o.event)}"
                @blur="${(t,o)=>t.handleBlur()}"
                ?autofocus="${t=>t.autofocus}"
                ?disabled="${t=>t.disabled}"
                list="${t=>t.list}"
                maxlength="${t=>t.maxlength}"
                minlength="${t=>t.minlength}"
                placeholder="${t=>t.placeholder}"
                ?readonly="${t=>t.readOnly}"
                ?required="${t=>t.required}"
                size="${t=>t.size}"
                type="text"
                inputmode="numeric"
                min="${t=>t.min}"
                max="${t=>t.max}"
                step="${t=>t.step}"
                aria-atomic="${t=>t.ariaAtomic}"
                aria-busy="${t=>t.ariaBusy}"
                aria-controls="${t=>t.ariaControls}"
                aria-current="${t=>t.ariaCurrent}"
                aria-describedby="${t=>t.ariaDescribedby}"
                aria-details="${t=>t.ariaDetails}"
                aria-disabled="${t=>t.ariaDisabled}"
                aria-errormessage="${t=>t.ariaErrormessage}"
                aria-flowto="${t=>t.ariaFlowto}"
                aria-haspopup="${t=>t.ariaHaspopup}"
                aria-hidden="${t=>t.ariaHidden}"
                aria-invalid="${t=>t.ariaInvalid}"
                aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
                aria-label="${t=>t.ariaLabel}"
                aria-labelledby="${t=>t.ariaLabelledby}"
                aria-live="${t=>t.ariaLive}"
                aria-owns="${t=>t.ariaOwns}"
                aria-relevant="${t=>t.ariaRelevant}"
                aria-roledescription="${t=>t.ariaRoledescription}"
                ${Ie("control")}
            />
            ${Xe(t=>!t.hideStep&&!t.readOnly&&!t.disabled,O`
                    <div class="controls" part="controls">
                        <div class="step-up" part="step-up" @click="${t=>t.stepUp()}">
                            <slot name="step-up-glyph">
                                ${e.stepUpGlyph||""}
                            </slot>
                        </div>
                        <div
                            class="step-down"
                            part="step-down"
                            @click="${t=>t.stepDown()}"
                        >
                            <slot name="step-down-glyph">
                                ${e.stepDownGlyph||""}
                            </slot>
                        </div>
                    </div>
                `)}
            ${xt(r,e)}
        </div>
    </template>
`});var Hb,ym,l5=y(()=>{l();c();d();Jo();Ue();Hb=class extends q{},ym=class extends Or(Hb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var c5,d5=y(()=>{l();c();d();c5={email:"email",password:"password",tel:"tel",text:"text",url:"url"}});var fo,Pa,bm=y(()=>{l();c();d();$e();A();Dl();jr();l5();d5();fo=class extends ym{constructor(){super(...arguments),this.type=c5.text}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}typeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type,this.validate())}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.validate(),this.autofocus&&Z.queueUpdate(()=>{this.focus()})}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.value=this.control.value}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}};w([C({attribute:"readonly",mode:"boolean"})],fo.prototype,"readOnly",void 0);w([C({mode:"boolean"})],fo.prototype,"autofocus",void 0);w([C],fo.prototype,"placeholder",void 0);w([C],fo.prototype,"type",void 0);w([C],fo.prototype,"list",void 0);w([C({converter:ie})],fo.prototype,"maxlength",void 0);w([C({converter:ie})],fo.prototype,"minlength",void 0);w([C],fo.prototype,"pattern",void 0);w([C({converter:ie})],fo.prototype,"size",void 0);w([C({mode:"boolean"})],fo.prototype,"spellcheck",void 0);w([I],fo.prototype,"defaultSlottedNodes",void 0);Pa=class{};Ye(Pa,ut);Ye(fo,_t,Pa)});var Ub,wm,u5=y(()=>{l();c();d();Jo();Ue();Ub=class extends q{},wm=class extends Or(Ub){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Qr,h5=y(()=>{l();c();d();$e();A();be();Mt();jr();bm();u5();Qr=class extends wm{constructor(){super(...arguments),this.hideStep=!1,this.step=1,this.isUserInput=!1}maxChanged(e,t){var o;this.max=Math.max(t,(o=this.min)!==null&&o!==void 0?o:t);let i=Math.min(this.min,this.max);this.min!==void 0&&this.min!==i&&(this.min=i),this.value=this.getValidValue(this.value)}minChanged(e,t){var o;this.min=Math.min(t,(o=this.max)!==null&&o!==void 0?o:t);let i=Math.max(this.min,this.max);this.max!==void 0&&this.max!==i&&(this.max=i),this.value=this.getValidValue(this.value)}get valueAsNumber(){return parseFloat(super.value)}set valueAsNumber(e){this.value=e.toString()}valueChanged(e,t){this.value=this.getValidValue(t),t===this.value&&(this.control&&!this.isUserInput&&(this.control.value=this.value),super.valueChanged(e,this.value),e!==void 0&&!this.isUserInput&&(this.$emit("input"),this.$emit("change")),this.isUserInput=!1)}validate(){super.validate(this.control)}getValidValue(e){var t,o;let i=parseFloat(parseFloat(e).toPrecision(12));return isNaN(i)?i="":(i=Math.min(i,(t=this.max)!==null&&t!==void 0?t:i),i=Math.max(i,(o=this.min)!==null&&o!==void 0?o:i).toString()),i}stepUp(){let e=parseFloat(this.value),t=isNaN(e)?this.min>0?this.min:this.max<0?this.max:this.min?0:this.step:e+this.step;this.value=t.toString()}stepDown(){let e=parseFloat(this.value),t=isNaN(e)?this.min>0?this.min:this.max<0?this.max:this.min?0:0-this.step:e-this.step;this.value=t.toString()}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type","number"),this.validate(),this.control.value=this.value,this.autofocus&&Z.queueUpdate(()=>{this.focus()})}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.control.value=this.control.value.replace(/[^0-9\-+e.]/g,""),this.isUserInput=!0,this.value=this.control.value}handleChange(){this.$emit("change")}handleKeyDown(e){switch(e.key){case Qt:return this.stepUp(),!1;case Wt:return this.stepDown(),!1}return!0}handleBlur(){this.control.value=this.value}};w([C({attribute:"readonly",mode:"boolean"})],Qr.prototype,"readOnly",void 0);w([C({mode:"boolean"})],Qr.prototype,"autofocus",void 0);w([C({attribute:"hide-step",mode:"boolean"})],Qr.prototype,"hideStep",void 0);w([C],Qr.prototype,"placeholder",void 0);w([C],Qr.prototype,"list",void 0);w([C({converter:ie})],Qr.prototype,"maxlength",void 0);w([C({converter:ie})],Qr.prototype,"minlength",void 0);w([C({converter:ie})],Qr.prototype,"size",void 0);w([C({converter:ie})],Qr.prototype,"step",void 0);w([C({converter:ie})],Qr.prototype,"max",void 0);w([C({converter:ie})],Qr.prototype,"min",void 0);w([I],Qr.prototype,"defaultSlottedNodes",void 0);Ye(Qr,_t,Pa)});var p5=y(()=>{l();c();d();a5();h5()});var f5,m5,g5=y(()=>{l();c();d();A();f5=44,m5=(r,e)=>O`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${Xe(t=>typeof t.value=="number",O`
                <svg
                    class="progress"
                    part="progress"
                    viewBox="0 0 16 16"
                    slot="determinate"
                >
                    <circle
                        class="background"
                        part="background"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                    <circle
                        class="determinate"
                        part="determinate"
                        style="stroke-dasharray: ${t=>f5*t.percentComplete/100}px ${f5}px"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                </svg>
            `,O`
                <slot name="indeterminate" slot="indeterminate">
                    ${e.indeterminateIndicator||""}
                </slot>
            `)}
    </template>
`});var v5=y(()=>{l();c();d();g5()});var yn,y5=y(()=>{l();c();d();$e();A();Ue();yn=class extends q{constructor(){super(...arguments),this.percentComplete=0}valueChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}minChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}maxChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}connectedCallback(){super.connectedCallback(),this.updatePercentComplete()}updatePercentComplete(){let e=typeof this.min=="number"?this.min:0,t=typeof this.max=="number"?this.max:100,o=typeof this.value=="number"?this.value:0,i=t-e;this.percentComplete=i===0?0:Math.fround((o-e)/i*100)}};w([C({converter:ie})],yn.prototype,"value",void 0);w([C({converter:ie})],yn.prototype,"min",void 0);w([C({converter:ie})],yn.prototype,"max",void 0);w([C({mode:"boolean"})],yn.prototype,"paused",void 0);w([I],yn.prototype,"percentComplete",void 0)});var b5,w5=y(()=>{l();c();d();A();b5=(r,e)=>O`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${Xe(t=>typeof t.value=="number",O`
                <div class="progress" part="progress" slot="determinate">
                    <div
                        class="determinate"
                        part="determinate"
                        style="width: ${t=>t.percentComplete}%"
                    ></div>
                </div>
            `,O`
                <div class="progress" part="progress" slot="indeterminate">
                    <slot class="indeterminate" name="indeterminate">
                        ${e.indeterminateIndicator1||""}
                        ${e.indeterminateIndicator2||""}
                    </slot>
                </div>
            `)}
    </template>
`});var C5=y(()=>{l();c();d();y5();w5()});var x5,k5=y(()=>{l();c();d();A();be();x5=(r,e)=>O`
    <template
        role="radiogroup"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @focusout="${(t,o)=>t.focusOutHandler(o.event)}"
    >
        <slot name="label"></slot>
        <div
            class="positioning-region ${t=>t.orientation===Tt.horizontal?"horizontal":"vertical"}"
            part="positioning-region"
        >
            <slot
                ${Le({property:"slottedRadioButtons",filter:Gr("[role=radio]")})}
            ></slot>
        </div>
    </template>
`});var bn,S5=y(()=>{l();c();d();$e();A();be();Sa();Ue();bn=class extends q{constructor(){super(...arguments),this.orientation=Tt.horizontal,this.radioChangeHandler=e=>{let t=e.target;t.checked&&(this.slottedRadioButtons.forEach(o=>{o!==t&&(o.checked=!1,this.isInsideFoundationToolbar||o.setAttribute("tabindex","-1"))}),this.selectedRadio=t,this.value=t.value,t.setAttribute("tabindex","0"),this.focusedRadio=t),e.stopPropagation()},this.moveToRadioByIndex=(e,t)=>{let o=e[t];this.isInsideToolbar||(o.setAttribute("tabindex","0"),o.readOnly?this.slottedRadioButtons.forEach(i=>{i!==o&&i.setAttribute("tabindex","-1")}):(o.checked=!0,this.selectedRadio=o)),this.focusedRadio=o,o.focus()},this.moveRightOffGroup=()=>{var e;(e=this.nextElementSibling)===null||e===void 0||e.focus()},this.moveLeftOffGroup=()=>{var e;(e=this.previousElementSibling)===null||e===void 0||e.focus()},this.focusOutHandler=e=>{let t=this.slottedRadioButtons,o=e.target,i=o!==null?t.indexOf(o):0,n=this.focusedRadio?t.indexOf(this.focusedRadio):-1;return(n===0&&i===n||n===t.length-1&&n===i)&&(this.selectedRadio?(this.focusedRadio=this.selectedRadio,this.isInsideFoundationToolbar||(this.selectedRadio.setAttribute("tabindex","0"),t.forEach(s=>{s!==this.selectedRadio&&s.setAttribute("tabindex","-1")}))):(this.focusedRadio=t[0],this.focusedRadio.setAttribute("tabindex","0"),t.forEach(s=>{s!==this.focusedRadio&&s.setAttribute("tabindex","-1")}))),!0},this.clickHandler=e=>{let t=e.target;if(t){let o=this.slottedRadioButtons;t.checked||o.indexOf(t)===0?(t.setAttribute("tabindex","0"),this.selectedRadio=t):(t.setAttribute("tabindex","-1"),this.selectedRadio=null),this.focusedRadio=t}e.preventDefault()},this.shouldMoveOffGroupToTheRight=(e,t,o)=>e===t.length&&this.isInsideToolbar&&o===So,this.shouldMoveOffGroupToTheLeft=(e,t)=>(this.focusedRadio?e.indexOf(this.focusedRadio)-1:0)<0&&this.isInsideToolbar&&t===ko,this.checkFocusedRadio=()=>{this.focusedRadio!==null&&!this.focusedRadio.readOnly&&!this.focusedRadio.checked&&(this.focusedRadio.checked=!0,this.focusedRadio.setAttribute("tabindex","0"),this.focusedRadio.focus(),this.selectedRadio=this.focusedRadio)},this.moveRight=e=>{let t=this.slottedRadioButtons,o=0;if(o=this.focusedRadio?t.indexOf(this.focusedRadio)+1:1,this.shouldMoveOffGroupToTheRight(o,t,e.key)){this.moveRightOffGroup();return}else o===t.length&&(o=0);for(;o<t.length&&t.length>1;)if(t[o].disabled){if(this.focusedRadio&&o===t.indexOf(this.focusedRadio))break;if(o+1>=t.length){if(this.isInsideToolbar)break;o=0}else o+=1}else{this.moveToRadioByIndex(t,o);break}},this.moveLeft=e=>{let t=this.slottedRadioButtons,o=0;if(o=this.focusedRadio?t.indexOf(this.focusedRadio)-1:0,o=o<0?t.length-1:o,this.shouldMoveOffGroupToTheLeft(t,e.key)){this.moveLeftOffGroup();return}for(;o>=0&&t.length>1;)if(t[o].disabled){if(this.focusedRadio&&o===t.indexOf(this.focusedRadio))break;o-1<0?o=t.length-1:o-=1}else{this.moveToRadioByIndex(t,o);break}},this.keydownHandler=e=>{let t=e.key;if(t in xa&&this.isInsideFoundationToolbar)return!0;switch(t){case dr:{this.checkFocusedRadio();break}case So:case Wt:{this.direction===ot.ltr?this.moveRight(e):this.moveLeft(e);break}case ko:case Qt:{this.direction===ot.ltr?this.moveLeft(e):this.moveRight(e);break}default:return!0}}}readOnlyChanged(){this.slottedRadioButtons!==void 0&&this.slottedRadioButtons.forEach(e=>{this.readOnly?e.readOnly=!0:e.readOnly=!1})}disabledChanged(){this.slottedRadioButtons!==void 0&&this.slottedRadioButtons.forEach(e=>{this.disabled?e.disabled=!0:e.disabled=!1})}nameChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach(e=>{e.setAttribute("name",this.name)})}valueChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach(e=>{e.value===this.value&&(e.checked=!0,this.selectedRadio=e)}),this.$emit("change")}slottedRadioButtonsChanged(e,t){this.slottedRadioButtons&&this.slottedRadioButtons.length>0&&this.setupRadioButtons()}get parentToolbar(){return this.closest('[role="toolbar"]')}get isInsideToolbar(){var e;return(e=this.parentToolbar)!==null&&e!==void 0?e:!1}get isInsideFoundationToolbar(){var e;return!!(!((e=this.parentToolbar)===null||e===void 0)&&e.$fastController)}connectedCallback(){super.connectedCallback(),this.direction=vi(this),this.setupRadioButtons()}disconnectedCallback(){this.slottedRadioButtons.forEach(e=>{e.removeEventListener("change",this.radioChangeHandler)})}setupRadioButtons(){let e=this.slottedRadioButtons.filter(i=>i.hasAttribute("checked")),t=e?e.length:0;if(t>1){let i=e[t-1];i.checked=!0}let o=!1;if(this.slottedRadioButtons.forEach(i=>{this.name!==void 0&&i.setAttribute("name",this.name),this.disabled&&(i.disabled=!0),this.readOnly&&(i.readOnly=!0),this.value&&this.value===i.value?(this.selectedRadio=i,this.focusedRadio=i,i.checked=!0,i.setAttribute("tabindex","0"),o=!0):(this.isInsideFoundationToolbar||i.setAttribute("tabindex","-1"),i.checked=!1),i.addEventListener("change",this.radioChangeHandler)}),this.value===void 0&&this.slottedRadioButtons.length>0){let i=this.slottedRadioButtons.filter(s=>s.hasAttribute("checked")),n=i!==null?i.length:0;if(n>0&&!o){let s=i[n-1];s.checked=!0,this.focusedRadio=s,s.setAttribute("tabindex","0")}else this.slottedRadioButtons[0].setAttribute("tabindex","0"),this.focusedRadio=this.slottedRadioButtons[0]}}};w([C({attribute:"readonly",mode:"boolean"})],bn.prototype,"readOnly",void 0);w([C({attribute:"disabled",mode:"boolean"})],bn.prototype,"disabled",void 0);w([C],bn.prototype,"name",void 0);w([C],bn.prototype,"value",void 0);w([C],bn.prototype,"orientation",void 0);w([I],bn.prototype,"childItems",void 0);w([I],bn.prototype,"slottedRadioButtons",void 0)});var _5=y(()=>{l();c();d();k5();S5()});var T5,E5=y(()=>{l();c();d();A();T5=(r,e)=>O`
    <template
        role="radio"
        class="${t=>t.checked?"checked":""} ${t=>t.readOnly?"readonly":""}"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${e.checkedIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Le("defaultSlottedNodes")}></slot>
        </label>
    </template>
`});var Bb,Cm,I5=y(()=>{l();c();d();Jo();Ue();Bb=class extends q{},Cm=class extends Wc(Bb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Kl,A5=y(()=>{l();c();d();$e();A();be();I5();Kl=class extends Cm{constructor(){super(),this.initialValue="on",this.keypressHandler=e=>{switch(e.key){case Zo:!this.checked&&!this.readOnly&&(this.checked=!0);return}return!0},this.proxy.setAttribute("type","radio")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}defaultCheckedChanged(){var e;this.$fastController.isConnected&&!this.dirtyChecked&&(this.isInsideRadioGroup()||(this.checked=(e=this.defaultChecked)!==null&&e!==void 0?e:!1,this.dirtyChecked=!1))}connectedCallback(){var e,t;super.connectedCallback(),this.validate(),((e=this.parentElement)===null||e===void 0?void 0:e.getAttribute("role"))!=="radiogroup"&&this.getAttribute("tabindex")===null&&(this.disabled||this.setAttribute("tabindex","0")),this.checkedAttribute&&(this.dirtyChecked||this.isInsideRadioGroup()||(this.checked=(t=this.defaultChecked)!==null&&t!==void 0?t:!1,this.dirtyChecked=!1))}isInsideRadioGroup(){return this.closest("[role=radiogroup]")!==null}clickHandler(e){!this.disabled&&!this.readOnly&&!this.checked&&(this.checked=!0)}};w([C({attribute:"readonly",mode:"boolean"})],Kl.prototype,"readOnly",void 0);w([I],Kl.prototype,"name",void 0);w([I],Kl.prototype,"defaultSlottedNodes",void 0)});var R5=y(()=>{l();c();d();E5();A5()});var Li,P5=y(()=>{l();c();d();$e();A();Ue();Li=class extends q{constructor(){super(...arguments),this.framesPerSecond=60,this.updatingItems=!1,this.speed=600,this.easing="ease-in-out",this.flippersHiddenFromAT=!1,this.scrolling=!1,this.resizeDetector=null}get frameTime(){return 1e3/this.framesPerSecond}scrollingChanged(e,t){if(this.scrollContainer){let o=this.scrolling==!0?"scrollstart":"scrollend";this.$emit(o,this.scrollContainer.scrollLeft)}}get isRtl(){return this.scrollItems.length>1&&this.scrollItems[0].offsetLeft>this.scrollItems[1].offsetLeft}connectedCallback(){super.connectedCallback(),this.initializeResizeDetector()}disconnectedCallback(){this.disconnectResizeDetector(),super.disconnectedCallback()}scrollItemsChanged(e,t){t&&!this.updatingItems&&Z.queueUpdate(()=>this.setStops())}disconnectResizeDetector(){this.resizeDetector&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.resized.bind(this)),this.resizeDetector.observe(this)}updateScrollStops(){this.updatingItems=!0;let e=this.scrollItems.reduce((t,o)=>o instanceof HTMLSlotElement?t.concat(o.assignedElements()):(t.push(o),t),[]);this.scrollItems=e,this.updatingItems=!1}setStops(){this.updateScrollStops();let{scrollContainer:e}=this,{scrollLeft:t}=e,{width:o,left:i}=e.getBoundingClientRect();this.width=o;let n=0,s=this.scrollItems.map((a,u)=>{let{left:h,width:p}=a.getBoundingClientRect(),f=Math.round(h+t-i),b=Math.round(f+p);return this.isRtl?-b:(n=b,u===0?0:f)}).concat(n);s=this.fixScrollMisalign(s),s.sort((a,u)=>Math.abs(a)-Math.abs(u)),this.scrollStops=s,this.setFlippers()}validateStops(e=!0){let t=()=>!!this.scrollStops.find(o=>o>0);return!t()&&e&&this.setStops(),t()}fixScrollMisalign(e){if(this.isRtl&&e.some(t=>t>0)){e.sort((o,i)=>i-o);let t=e[0];e=e.map(o=>o-t)}return e}setFlippers(){var e,t;let o=this.scrollContainer.scrollLeft;if((e=this.previousFlipperContainer)===null||e===void 0||e.classList.toggle("disabled",o===0),this.scrollStops){let i=Math.abs(this.scrollStops[this.scrollStops.length-1]);(t=this.nextFlipperContainer)===null||t===void 0||t.classList.toggle("disabled",this.validateStops(!1)&&Math.abs(o)+this.width>=i)}}scrollInView(e,t=0,o){var i;if(typeof e!="number"&&e&&(e=this.scrollItems.findIndex(n=>n===e||n.contains(e))),e!==void 0){o=o??t;let{scrollContainer:n,scrollStops:s,scrollItems:a}=this,{scrollLeft:u}=this.scrollContainer,{width:h}=n.getBoundingClientRect(),p=s[e],{width:f}=a[e].getBoundingClientRect(),b=p+f,x=u+t>p;if(x||u+h-o<b){let R=(i=[...s].sort((z,we)=>x?we-z:z-we).find(z=>x?z+t<p:z+h-(o??0)>b))!==null&&i!==void 0?i:0;this.scrollToPosition(R)}}}keyupHandler(e){switch(e.key){case"ArrowLeft":this.scrollToPrevious();break;case"ArrowRight":this.scrollToNext();break}}scrollToPrevious(){this.validateStops();let e=this.scrollContainer.scrollLeft,t=this.scrollStops.findIndex((n,s)=>n>=e&&(this.isRtl||s===this.scrollStops.length-1||this.scrollStops[s+1]>e)),o=Math.abs(this.scrollStops[t+1]),i=this.scrollStops.findIndex(n=>Math.abs(n)+this.width>o);(i>=t||i===-1)&&(i=t>0?t-1:0),this.scrollToPosition(this.scrollStops[i],e)}scrollToNext(){this.validateStops();let e=this.scrollContainer.scrollLeft,t=this.scrollStops.findIndex(n=>Math.abs(n)>=Math.abs(e)),o=this.scrollStops.findIndex(n=>Math.abs(e)+this.width<=Math.abs(n)),i=t;o>t+2?i=o-2:t<this.scrollStops.length-2&&(i=t+1),this.scrollToPosition(this.scrollStops[i],e)}scrollToPosition(e,t=this.scrollContainer.scrollLeft){var o;if(this.scrolling)return;this.scrolling=!0;let i=(o=this.duration)!==null&&o!==void 0?o:`${Math.abs(e-t)/this.speed}s`;this.content.style.setProperty("transition-duration",i);let n=parseFloat(getComputedStyle(this.content).getPropertyValue("transition-duration")),s=h=>{h&&h.target!==h.currentTarget||(this.content.style.setProperty("transition-duration","0s"),this.content.style.removeProperty("transform"),this.scrollContainer.style.setProperty("scroll-behavior","auto"),this.scrollContainer.scrollLeft=e,this.setFlippers(),this.content.removeEventListener("transitionend",s),this.scrolling=!1)};if(n===0){s();return}this.content.addEventListener("transitionend",s);let a=this.scrollContainer.scrollWidth-this.scrollContainer.clientWidth,u=this.scrollContainer.scrollLeft-Math.min(e,a);this.isRtl&&(u=this.scrollContainer.scrollLeft+Math.min(Math.abs(e),a)),this.content.style.setProperty("transition-property","transform"),this.content.style.setProperty("transition-timing-function",this.easing),this.content.style.setProperty("transform",`translateX(${u}px)`)}resized(){this.resizeTimeout&&(this.resizeTimeout=clearTimeout(this.resizeTimeout)),this.resizeTimeout=setTimeout(()=>{this.width=this.scrollContainer.offsetWidth,this.setFlippers()},this.frameTime)}scrolled(){this.scrollTimeout&&(this.scrollTimeout=clearTimeout(this.scrollTimeout)),this.scrollTimeout=setTimeout(()=>{this.setFlippers()},this.frameTime)}};w([C({converter:ie})],Li.prototype,"speed",void 0);w([C],Li.prototype,"duration",void 0);w([C],Li.prototype,"easing",void 0);w([C({attribute:"flippers-hidden-from-at",converter:Is})],Li.prototype,"flippersHiddenFromAT",void 0);w([I],Li.prototype,"scrolling",void 0);w([I],Li.prototype,"scrollItems",void 0);w([C({attribute:"view"})],Li.prototype,"view",void 0)});var $5,O5=y(()=>{l();c();d();A();Mt();$5=(r,e)=>{var t,o;return O`
    <template
        class="horizontal-scroll"
        @keyup="${(i,n)=>i.keyupHandler(n.event)}"
    >
        ${kt(r,e)}
        <div class="scroll-area" part="scroll-area">
            <div
                class="scroll-view"
                part="scroll-view"
                @scroll="${i=>i.scrolled()}"
                ${Ie("scrollContainer")}
            >
                <div class="content-container" part="content-container" ${Ie("content")}>
                    <slot
                        ${Le({property:"scrollItems",filter:Gr()})}
                    ></slot>
                </div>
            </div>
            ${Xe(i=>i.view!=="mobile",O`
                    <div
                        class="scroll scroll-prev"
                        part="scroll-prev"
                        ${Ie("previousFlipperContainer")}
                    >
                        <div class="scroll-action" part="scroll-action-previous">
                            <slot name="previous-flipper">
                                ${e.previousFlipper instanceof Function?e.previousFlipper(r,e):(t=e.previousFlipper)!==null&&t!==void 0?t:""}
                            </slot>
                        </div>
                    </div>
                    <div
                        class="scroll scroll-next"
                        part="scroll-next"
                        ${Ie("nextFlipperContainer")}
                    >
                        <div class="scroll-action" part="scroll-action-next">
                            <slot name="next-flipper">
                                ${e.nextFlipper instanceof Function?e.nextFlipper(r,e):(o=e.nextFlipper)!==null&&o!==void 0?o:""}
                            </slot>
                        </div>
                    </div>
                `)}
        </div>
        ${xt(r,e)}
    </template>
`}});var M5=y(()=>{l();c();d();P5();O5()});function Xu(r,e,t){return r.nodeType!==Node.TEXT_NODE?!0:typeof r.nodeValue=="string"&&!!r.nodeValue.trim().length}var xm=y(()=>{l();c();d()});var F5=y(()=>{l();c();d();A();Mt();xm()});var zb,km,D5=y(()=>{l();c();d();Jo();Ue();zb=class extends q{},km=class extends Or(zb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var _o,Sm,L5=y(()=>{l();c();d();$e();A();Dl();jr();D5();_o=class extends km{readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.validate(),this.autofocus&&Z.queueUpdate(()=>{this.focus()})}validate(){super.validate(this.control)}handleTextInput(){this.value=this.control.value}handleClearInput(){this.value="",this.control.focus(),this.handleChange()}handleChange(){this.$emit("change")}};w([C({attribute:"readonly",mode:"boolean"})],_o.prototype,"readOnly",void 0);w([C({mode:"boolean"})],_o.prototype,"autofocus",void 0);w([C],_o.prototype,"placeholder",void 0);w([C],_o.prototype,"list",void 0);w([C({converter:ie})],_o.prototype,"maxlength",void 0);w([C({converter:ie})],_o.prototype,"minlength",void 0);w([C],_o.prototype,"pattern",void 0);w([C({converter:ie})],_o.prototype,"size",void 0);w([C({mode:"boolean"})],_o.prototype,"spellcheck",void 0);w([I],_o.prototype,"defaultSlottedNodes",void 0);Sm=class{};Ye(Sm,ut);Ye(_o,_t,Sm)});var N5=y(()=>{l();c();d();F5();L5()});var Vb,_m,H5=y(()=>{l();c();d();fm();Jo();Vb=class extends Os{},_m=class extends Or(Vb){constructor(){super(...arguments),this.proxy=document.createElement("select")}}});var Ni,eh,U5=y(()=>{l();c();d();$e();A();be();Ea();Mt();jr();H5();sm();Ni=class extends _m{constructor(){super(...arguments),this.open=!1,this.forcedPosition=!1,this.listboxId=gi("listbox-"),this.maxHeight=0}openChanged(e,t){if(this.collapsible){if(this.open){this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),this.indexWhenOpened=this.selectedIndex,Z.queueUpdate(()=>this.focus());return}this.ariaControls="",this.ariaExpanded="false"}}get collapsible(){return!(this.multiple||typeof this.size=="number")}get value(){return fe.track(this,"value"),this._value}set value(e){var t,o,i,n,s,a,u;let h=`${this._value}`;if(!((t=this._options)===null||t===void 0)&&t.length){let p=this._options.findIndex(x=>x.value===e),f=(i=(o=this._options[this.selectedIndex])===null||o===void 0?void 0:o.value)!==null&&i!==void 0?i:null,b=(s=(n=this._options[p])===null||n===void 0?void 0:n.value)!==null&&s!==void 0?s:null;(p===-1||f!==b)&&(e="",this.selectedIndex=p),e=(u=(a=this.firstSelectedOption)===null||a===void 0?void 0:a.value)!==null&&u!==void 0?u:e}h!==e&&(this._value=e,super.valueChanged(h,e),fe.notify(this,"value"),this.updateDisplayValue())}updateValue(e){var t,o;this.$fastController.isConnected&&(this.value=(o=(t=this.firstSelectedOption)===null||t===void 0?void 0:t.value)!==null&&o!==void 0?o:""),e&&(this.$emit("input"),this.$emit("change",this,{bubbles:!0,composed:void 0}))}selectedIndexChanged(e,t){super.selectedIndexChanged(e,t),this.updateValue()}positionChanged(e,t){this.positionAttribute=t,this.setPositioning()}setPositioning(){let e=this.getBoundingClientRect(),o=window.innerHeight-e.bottom;this.position=this.forcedPosition?this.positionAttribute:e.top>o?Ia.above:Ia.below,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===Ia.above?~~e.top:~~o}get displayValue(){var e,t;return fe.track(this,"displayValue"),(t=(e=this.firstSelectedOption)===null||e===void 0?void 0:e.text)!==null&&t!==void 0?t:""}disabledChanged(e,t){super.disabledChanged&&super.disabledChanged(e,t),this.ariaDisabled=this.disabled?"true":"false"}formResetCallback(){this.setProxyOptions(),super.setDefaultSelectedOption(),this.selectedIndex===-1&&(this.selectedIndex=0)}clickHandler(e){if(!this.disabled){if(this.open){let t=e.target.closest("option,[role=option]");if(t&&t.disabled)return}return super.clickHandler(e),this.open=this.collapsible&&!this.open,!this.open&&this.indexWhenOpened!==this.selectedIndex&&this.updateValue(!0),!0}}focusoutHandler(e){var t;if(super.focusoutHandler(e),!this.open)return!0;let o=e.relatedTarget;if(this.isSameNode(o)){this.focus();return}!((t=this.options)===null||t===void 0)&&t.includes(o)||(this.open=!1,this.indexWhenOpened!==this.selectedIndex&&this.updateValue(!0))}handleChange(e,t){super.handleChange(e,t),t==="value"&&this.updateValue()}slottedOptionsChanged(e,t){this.options.forEach(o=>{fe.getNotifier(o).unsubscribe(this,"value")}),super.slottedOptionsChanged(e,t),this.options.forEach(o=>{fe.getNotifier(o).subscribe(this,"value")}),this.setProxyOptions(),this.updateValue()}mousedownHandler(e){var t;return e.offsetX>=0&&e.offsetX<=((t=this.listbox)===null||t===void 0?void 0:t.scrollWidth)?super.mousedownHandler(e):this.collapsible}multipleChanged(e,t){super.multipleChanged(e,t),this.proxy&&(this.proxy.multiple=t)}selectedOptionsChanged(e,t){var o;super.selectedOptionsChanged(e,t),(o=this.options)===null||o===void 0||o.forEach((i,n)=>{var s;let a=(s=this.proxy)===null||s===void 0?void 0:s.options.item(n);a&&(a.selected=i.selected)})}setDefaultSelectedOption(){var e;let t=(e=this.options)!==null&&e!==void 0?e:Array.from(this.children).filter(hr.slottedOptionFilter),o=t?.findIndex(i=>i.hasAttribute("selected")||i.selected||i.value===this.value);if(o!==-1){this.selectedIndex=o;return}this.selectedIndex=0}setProxyOptions(){this.proxy instanceof HTMLSelectElement&&this.options&&(this.proxy.options.length=0,this.options.forEach(e=>{let t=e.proxy||(e instanceof HTMLOptionElement?e.cloneNode():null);t&&this.proxy.options.add(t)}))}keydownHandler(e){super.keydownHandler(e);let t=e.key||e.key.charCodeAt(0);switch(t){case Zo:{e.preventDefault(),this.collapsible&&this.typeAheadExpired&&(this.open=!this.open);break}case Tr:case Er:{e.preventDefault();break}case dr:{e.preventDefault(),this.open=!this.open;break}case Yo:{this.collapsible&&this.open&&(e.preventDefault(),this.open=!1);break}case Ca:return this.collapsible&&this.open&&(e.preventDefault(),this.open=!1),!0}return!this.open&&this.indexWhenOpened!==this.selectedIndex&&(this.updateValue(!0),this.indexWhenOpened=this.selectedIndex),!(t===Wt||t===Qt)}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.addEventListener("contentchange",this.updateDisplayValue)}disconnectedCallback(){this.removeEventListener("contentchange",this.updateDisplayValue),super.disconnectedCallback()}sizeChanged(e,t){super.sizeChanged(e,t),this.proxy&&(this.proxy.size=t)}updateDisplayValue(){this.collapsible&&fe.notify(this,"displayValue")}};w([C({attribute:"open",mode:"boolean"})],Ni.prototype,"open",void 0);w([H_],Ni.prototype,"collapsible",null);w([I],Ni.prototype,"control",void 0);w([C({attribute:"position"})],Ni.prototype,"positionAttribute",void 0);w([I],Ni.prototype,"position",void 0);w([I],Ni.prototype,"maxHeight",void 0);eh=class{};w([I],eh.prototype,"ariaControls",void 0);Ye(eh,Fi);Ye(Ni,_t,eh)});var B5,z5=y(()=>{l();c();d();A();Ea();Mt();B5=(r,e)=>O`
    <template
        class="${t=>[t.collapsible&&"collapsible",t.collapsible&&t.open&&"open",t.disabled&&"disabled",t.collapsible&&t.position].filter(Boolean).join(" ")}"
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-controls="${t=>t.ariaControls}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-haspopup="${t=>t.collapsible?"listbox":null}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        ?open="${t=>t.open}"
        role="combobox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        ${Xe(t=>t.collapsible,O`
                <div
                    class="control"
                    part="control"
                    ?disabled="${t=>t.disabled}"
                    ${Ie("control")}
                >
                    ${kt(r,e)}
                    <slot name="button-container">
                        <div class="selected-value" part="selected-value">
                            <slot name="selected-value">${t=>t.displayValue}</slot>
                        </div>
                        <div aria-hidden="true" class="indicator" part="indicator">
                            <slot name="indicator">
                                ${e.indicator||""}
                            </slot>
                        </div>
                    </slot>
                    ${xt(r,e)}
                </div>
            `)}
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>t.collapsible?!t.open:!1}"
            ${Ie("listbox")}
        >
            <slot
                ${Le({filter:hr.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`});var V5=y(()=>{l();c();d();U5();sm();z5()});var q5,G5=y(()=>{l();c();d();A();q5=(r,e)=>O`
    <template
        class="${t=>t.shape==="circle"?"circle":"rect"}"
        pattern="${t=>t.pattern}"
        ?shimmer="${t=>t.shimmer}"
    >
        ${Xe(t=>t.shimmer===!0,O`
                <span class="shimmer"></span>
            `)}
        <object type="image/svg+xml" data="${t=>t.pattern}" role="presentation">
            <img class="pattern" src="${t=>t.pattern}" />
        </object>
        <slot></slot>
    </template>
`});var $a,j5=y(()=>{l();c();d();$e();A();Ue();$a=class extends q{constructor(){super(...arguments),this.shape="rect"}};w([C],$a.prototype,"fill",void 0);w([C],$a.prototype,"shape",void 0);w([C],$a.prototype,"pattern",void 0);w([C({mode:"boolean"})],$a.prototype,"shimmer",void 0)});var K5=y(()=>{l();c();d();G5();j5()});var W5,Q5=y(()=>{l();c();d();A();be();W5=(r,e)=>O`
    <template
        aria-disabled="${t=>t.disabled}"
        class="${t=>t.sliderOrientation||Tt.horizontal}
            ${t=>t.disabled?"disabled":""}"
    >
        <div ${Ie("root")} part="root" class="root" style="${t=>t.positionStyle}">
            <div class="container">
                ${Xe(t=>!t.hideMark,O`
                        <div class="mark"></div>
                    `)}
                <div class="label">
                    <slot></slot>
                </div>
            </div>
        </div>
    </template>
`});function th(r,e,t,o){let i=ka(0,1,(r-e)/(t-e));return o===ot.rtl&&(i=1-i),i}var qb=y(()=>{l();c();d();be()});var Tm,Hi,Y5=y(()=>{l();c();d();$e();A();be();qb();Ue();Tm={min:0,max:0,direction:ot.ltr,orientation:Tt.horizontal,disabled:!1},Hi=class extends q{constructor(){super(...arguments),this.hideMark=!1,this.sliderDirection=ot.ltr,this.getSliderConfiguration=()=>{if(!this.isSliderConfig(this.parentNode))this.sliderDirection=Tm.direction||ot.ltr,this.sliderOrientation=Tm.orientation||Tt.horizontal,this.sliderMaxPosition=Tm.max,this.sliderMinPosition=Tm.min;else{let e=this.parentNode,{min:t,max:o,direction:i,orientation:n,disabled:s}=e;s!==void 0&&(this.disabled=s),this.sliderDirection=i||ot.ltr,this.sliderOrientation=n||Tt.horizontal,this.sliderMaxPosition=o,this.sliderMinPosition=t}},this.positionAsStyle=()=>{let e=this.sliderDirection?this.sliderDirection:ot.ltr,t=th(Number(this.position),Number(this.sliderMinPosition),Number(this.sliderMaxPosition)),o=Math.round((1-t)*100),i=Math.round(t*100);return Number.isNaN(i)&&Number.isNaN(o)&&(o=50,i=50),this.sliderOrientation===Tt.horizontal?e===ot.rtl?`right: ${i}%; left: ${o}%;`:`left: ${i}%; right: ${o}%;`:`top: ${i}%; bottom: ${o}%;`}}positionChanged(){this.positionStyle=this.positionAsStyle()}sliderOrientationChanged(){}connectedCallback(){super.connectedCallback(),this.getSliderConfiguration(),this.positionStyle=this.positionAsStyle(),this.notifier=fe.getNotifier(this.parentNode),this.notifier.subscribe(this,"orientation"),this.notifier.subscribe(this,"direction"),this.notifier.subscribe(this,"max"),this.notifier.subscribe(this,"min")}disconnectedCallback(){super.disconnectedCallback(),this.notifier.unsubscribe(this,"orientation"),this.notifier.unsubscribe(this,"direction"),this.notifier.unsubscribe(this,"max"),this.notifier.unsubscribe(this,"min")}handleChange(e,t){switch(t){case"direction":this.sliderDirection=e.direction;break;case"orientation":this.sliderOrientation=e.orientation;break;case"max":this.sliderMaxPosition=e.max;break;case"min":this.sliderMinPosition=e.min;break;default:break}this.positionStyle=this.positionAsStyle()}isSliderConfig(e){return e.max!==void 0&&e.min!==void 0}};w([I],Hi.prototype,"positionStyle",void 0);w([C],Hi.prototype,"position",void 0);w([C({attribute:"hide-mark",mode:"boolean"})],Hi.prototype,"hideMark",void 0);w([C({attribute:"disabled",mode:"boolean"})],Hi.prototype,"disabled",void 0);w([I],Hi.prototype,"sliderOrientation",void 0);w([I],Hi.prototype,"sliderMinPosition",void 0);w([I],Hi.prototype,"sliderMaxPosition",void 0);w([I],Hi.prototype,"sliderDirection",void 0)});var Z5=y(()=>{l();c();d();Q5();Y5()});var J5,X5=y(()=>{l();c();d();A();be();J5=(r,e)=>O`
    <template
        role="slider"
        class="${t=>t.readOnly?"readonly":""}
        ${t=>t.orientation||Tt.horizontal}"
        tabindex="${t=>t.disabled?null:0}"
        aria-valuetext="${t=>t.valueTextFormatter(t.value)}"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        aria-disabled="${t=>t.disabled?!0:void 0}"
        aria-readonly="${t=>t.readOnly?!0:void 0}"
        aria-orientation="${t=>t.orientation}"
        class="${t=>t.orientation}"
    >
        <div part="positioning-region" class="positioning-region">
            <div ${Ie("track")} part="track-container" class="track">
                <slot name="track"></slot>
                <div part="track-start" class="track-start" style="${t=>t.position}">
                    <slot name="track-start"></slot>
                </div>
            </div>
            <slot></slot>
            <div
                ${Ie("thumb")}
                part="thumb-container"
                class="thumb-container"
                style="${t=>t.position}"
            >
                <slot name="thumb">${e.thumb||""}</slot>
            </div>
        </div>
    </template>
`});var Gb,Em,eI=y(()=>{l();c();d();Jo();Ue();Gb=class extends q{},Em=class extends Or(Gb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var oO,Mr,tI=y(()=>{l();c();d();$e();A();be();Sa();qb();eI();oO={singleValue:"single-value"},Mr=class extends Em{constructor(){super(...arguments),this.direction=ot.ltr,this.isDragging=!1,this.trackWidth=0,this.trackMinWidth=0,this.trackHeight=0,this.trackLeft=0,this.trackMinHeight=0,this.valueTextFormatter=()=>null,this.min=0,this.max=10,this.step=1,this.orientation=Tt.horizontal,this.mode=oO.singleValue,this.keypressHandler=e=>{if(!this.readOnly){if(e.key===Tr)e.preventDefault(),this.value=`${this.min}`;else if(e.key===Er)e.preventDefault(),this.value=`${this.max}`;else if(!e.shiftKey)switch(e.key){case So:case Qt:e.preventDefault(),this.increment();break;case ko:case Wt:e.preventDefault(),this.decrement();break}}},this.setupTrackConstraints=()=>{let e=this.track.getBoundingClientRect();this.trackWidth=this.track.clientWidth,this.trackMinWidth=this.track.clientLeft,this.trackHeight=e.bottom,this.trackMinHeight=e.top,this.trackLeft=this.getBoundingClientRect().left,this.trackWidth===0&&(this.trackWidth=1)},this.setupListeners=(e=!1)=>{let t=`${e?"remove":"add"}EventListener`;this[t]("keydown",this.keypressHandler),this[t]("mousedown",this.handleMouseDown),this.thumb[t]("mousedown",this.handleThumbMouseDown,{passive:!0}),this.thumb[t]("touchstart",this.handleThumbMouseDown,{passive:!0}),e&&(this.handleMouseDown(null),this.handleThumbMouseDown(null))},this.initialValue="",this.handleThumbMouseDown=e=>{if(e){if(this.readOnly||this.disabled||e.defaultPrevented)return;e.target.focus()}let t=`${e!==null?"add":"remove"}EventListener`;window[t]("mouseup",this.handleWindowMouseUp),window[t]("mousemove",this.handleMouseMove,{passive:!0}),window[t]("touchmove",this.handleMouseMove,{passive:!0}),window[t]("touchend",this.handleWindowMouseUp),this.isDragging=e!==null},this.handleMouseMove=e=>{if(this.readOnly||this.disabled||e.defaultPrevented)return;let t=window.TouchEvent&&e instanceof TouchEvent?e.touches[0]:e,o=this.orientation===Tt.horizontal?t.pageX-document.documentElement.scrollLeft-this.trackLeft:t.pageY-document.documentElement.scrollTop;this.value=`${this.calculateNewValue(o)}`},this.calculateNewValue=e=>{let t=th(e,this.orientation===Tt.horizontal?this.trackMinWidth:this.trackMinHeight,this.orientation===Tt.horizontal?this.trackWidth:this.trackHeight,this.direction),o=(this.max-this.min)*t+this.min;return this.convertToConstrainedValue(o)},this.handleWindowMouseUp=e=>{this.stopDragging()},this.stopDragging=()=>{this.isDragging=!1,this.handleMouseDown(null),this.handleThumbMouseDown(null)},this.handleMouseDown=e=>{let t=`${e!==null?"add":"remove"}EventListener`;if((e===null||!this.disabled&&!this.readOnly)&&(window[t]("mouseup",this.handleWindowMouseUp),window.document[t]("mouseleave",this.handleWindowMouseUp),window[t]("mousemove",this.handleMouseMove),e)){e.preventDefault(),this.setupTrackConstraints(),e.target.focus();let o=this.orientation===Tt.horizontal?e.pageX-document.documentElement.scrollLeft-this.trackLeft:e.pageY-document.documentElement.scrollTop;this.value=`${this.calculateNewValue(o)}`}},this.convertToConstrainedValue=e=>{isNaN(e)&&(e=this.min);let t=e-this.min,o=Math.round(t/this.step),i=t-o*(this.stepMultiplier*this.step)/this.stepMultiplier;return t=i>=Number(this.step)/2?t-i+Number(this.step):t-i,t+this.min}}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}get valueAsNumber(){return parseFloat(super.value)}set valueAsNumber(e){this.value=e.toString()}valueChanged(e,t){super.valueChanged(e,t),this.$fastController.isConnected&&this.setThumbPositionForOrientation(this.direction),this.$emit("change")}minChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.min=`${this.min}`),this.validate()}maxChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.max=`${this.max}`),this.validate()}stepChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.step=`${this.step}`),this.updateStepMultiplier(),this.validate()}orientationChanged(){this.$fastController.isConnected&&this.setThumbPositionForOrientation(this.direction)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type","range"),this.direction=vi(this),this.updateStepMultiplier(),this.setupTrackConstraints(),this.setupListeners(),this.setupDefaultValue(),this.setThumbPositionForOrientation(this.direction)}disconnectedCallback(){this.setupListeners(!0)}increment(){let e=this.direction!==ot.rtl&&this.orientation!==Tt.vertical?Number(this.value)+Number(this.step):Number(this.value)-Number(this.step),t=this.convertToConstrainedValue(e),o=t<Number(this.max)?`${t}`:`${this.max}`;this.value=o}decrement(){let e=this.direction!==ot.rtl&&this.orientation!==Tt.vertical?Number(this.value)-Number(this.step):Number(this.value)+Number(this.step),t=this.convertToConstrainedValue(e),o=t>Number(this.min)?`${t}`:`${this.min}`;this.value=o}setThumbPositionForOrientation(e){let o=(1-th(Number(this.value),Number(this.min),Number(this.max),e))*100;this.orientation===Tt.horizontal?this.position=this.isDragging?`right: ${o}%; transition: none;`:`right: ${o}%; transition: all 0.2s ease;`:this.position=this.isDragging?`bottom: ${o}%; transition: none;`:`bottom: ${o}%; transition: all 0.2s ease;`}updateStepMultiplier(){let e=this.step+"",t=this.step%1?e.length-e.indexOf(".")-1:0;this.stepMultiplier=Math.pow(10,t)}get midpoint(){return`${this.convertToConstrainedValue((this.max+this.min)/2)}`}setupDefaultValue(){if(typeof this.value=="string")if(this.value.length===0)this.initialValue=this.midpoint;else{let e=parseFloat(this.value);!Number.isNaN(e)&&(e<this.min||e>this.max)&&(this.value=this.midpoint)}}};w([C({attribute:"readonly",mode:"boolean"})],Mr.prototype,"readOnly",void 0);w([I],Mr.prototype,"direction",void 0);w([I],Mr.prototype,"isDragging",void 0);w([I],Mr.prototype,"position",void 0);w([I],Mr.prototype,"trackWidth",void 0);w([I],Mr.prototype,"trackMinWidth",void 0);w([I],Mr.prototype,"trackHeight",void 0);w([I],Mr.prototype,"trackLeft",void 0);w([I],Mr.prototype,"trackMinHeight",void 0);w([I],Mr.prototype,"valueTextFormatter",void 0);w([C({converter:ie})],Mr.prototype,"min",void 0);w([C({converter:ie})],Mr.prototype,"max",void 0);w([C({converter:ie})],Mr.prototype,"step",void 0);w([C],Mr.prototype,"orientation",void 0);w([C],Mr.prototype,"mode",void 0)});var rI=y(()=>{l();c();d();X5();tI()});var oI,iI=y(()=>{l();c();d();A();oI=(r,e)=>O`
    <template
        role="switch"
        aria-checked="${t=>t.checked}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.checked?"checked":""}"
    >
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Le("defaultSlottedNodes")}></slot>
        </label>
        <div part="switch" class="switch">
            <slot name="switch">${e.switch||""}</slot>
        </div>
        <span class="status-message" part="status-message">
            <span class="checked-message" part="checked-message">
                <slot name="checked-message"></slot>
            </span>
            <span class="unchecked-message" part="unchecked-message">
                <slot name="unchecked-message"></slot>
            </span>
        </span>
    </template>
`});var jb,Im,nI=y(()=>{l();c();d();Jo();Ue();jb=class extends q{},Im=class extends Wc(jb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Jc,sI=y(()=>{l();c();d();$e();A();be();nI();Jc=class extends Im{constructor(){super(),this.initialValue="on",this.keypressHandler=e=>{if(!this.readOnly)switch(e.key){case dr:case Zo:this.checked=!this.checked;break}},this.clickHandler=e=>{!this.disabled&&!this.readOnly&&(this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly),this.readOnly?this.classList.add("readonly"):this.classList.remove("readonly")}checkedChanged(e,t){super.checkedChanged(e,t),this.checked?this.classList.add("checked"):this.classList.remove("checked")}};w([C({attribute:"readonly",mode:"boolean"})],Jc.prototype,"readOnly",void 0);w([I],Jc.prototype,"defaultSlottedNodes",void 0)});var aI=y(()=>{l();c();d();iI();sI()});var lI,cI=y(()=>{l();c();d();A();lI=(r,e)=>O`
    <template slot="tabpanel" role="tabpanel">
        <slot></slot>
    </template>
`});var Am,dI=y(()=>{l();c();d();Ue();Am=class extends q{}});var uI=y(()=>{l();c();d();cI();dI()});var hI,pI=y(()=>{l();c();d();A();hI=(r,e)=>O`
    <template slot="tab" role="tab" aria-disabled="${t=>t.disabled}">
        <slot></slot>
    </template>
`});var rh,fI=y(()=>{l();c();d();$e();A();Ue();rh=class extends q{};w([C({mode:"boolean"})],rh.prototype,"disabled",void 0)});var mI=y(()=>{l();c();d();pI();fI()});var gI,vI=y(()=>{l();c();d();A();Mt();gI=(r,e)=>O`
    <template class="${t=>t.orientation}">
        ${kt(r,e)}
        <div class="tablist" part="tablist" role="tablist">
            <slot class="tab" name="tab" part="tab" ${Le("tabs")}></slot>

            ${Xe(t=>t.showActiveIndicator,O`
                    <div
                        ${Ie("activeIndicatorRef")}
                        class="activeIndicator"
                        part="activeIndicator"
                    ></div>
                `)}
        </div>
        ${xt(r,e)}
        <div class="tabpanel" part="tabpanel">
            <slot name="tabpanel" ${Le("tabpanels")}></slot>
        </div>
    </template>
`});var yI,Ui,bI=y(()=>{l();c();d();$e();A();be();Mt();jr();Ue();yI={vertical:"vertical",horizontal:"horizontal"},Ui=class extends q{constructor(){super(...arguments),this.orientation=yI.horizontal,this.activeindicator=!0,this.showActiveIndicator=!0,this.prevActiveTabIndex=0,this.activeTabIndex=0,this.ticking=!1,this.change=()=>{this.$emit("change",this.activetab)},this.isDisabledElement=e=>e.getAttribute("aria-disabled")==="true",this.isHiddenElement=e=>e.hasAttribute("hidden"),this.isFocusableElement=e=>!this.isDisabledElement(e)&&!this.isHiddenElement(e),this.setTabs=()=>{let e="gridColumn",t="gridRow",o=this.isHorizontal()?e:t;this.activeTabIndex=this.getActiveIndex(),this.showActiveIndicator=!1,this.tabs.forEach((i,n)=>{if(i.slot==="tab"){let s=this.activeTabIndex===n&&this.isFocusableElement(i);this.activeindicator&&this.isFocusableElement(i)&&(this.showActiveIndicator=!0);let a=this.tabIds[n],u=this.tabpanelIds[n];i.setAttribute("id",a),i.setAttribute("aria-selected",s?"true":"false"),i.setAttribute("aria-controls",u),i.addEventListener("click",this.handleTabClick),i.addEventListener("keydown",this.handleTabKeyDown),i.setAttribute("tabindex",s?"0":"-1"),s&&(this.activetab=i,this.activeid=a)}i.style[e]="",i.style[t]="",i.style[o]=`${n+1}`,this.isHorizontal()?i.classList.remove("vertical"):i.classList.add("vertical")})},this.setTabPanels=()=>{this.tabpanels.forEach((e,t)=>{let o=this.tabIds[t],i=this.tabpanelIds[t];e.setAttribute("id",i),e.setAttribute("aria-labelledby",o),this.activeTabIndex!==t?e.setAttribute("hidden",""):e.removeAttribute("hidden")})},this.handleTabClick=e=>{let t=e.currentTarget;t.nodeType===1&&this.isFocusableElement(t)&&(this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=this.tabs.indexOf(t),this.setComponent())},this.handleTabKeyDown=e=>{if(this.isHorizontal())switch(e.key){case ko:e.preventDefault(),this.adjustBackward(e);break;case So:e.preventDefault(),this.adjustForward(e);break}else switch(e.key){case Qt:e.preventDefault(),this.adjustBackward(e);break;case Wt:e.preventDefault(),this.adjustForward(e);break}switch(e.key){case Tr:e.preventDefault(),this.adjust(-this.activeTabIndex);break;case Er:e.preventDefault(),this.adjust(this.tabs.length-this.activeTabIndex-1);break}},this.adjustForward=e=>{let t=this.tabs,o=0;for(o=this.activetab?t.indexOf(this.activetab)+1:1,o===t.length&&(o=0);o<t.length&&t.length>1;)if(this.isFocusableElement(t[o])){this.moveToTabByIndex(t,o);break}else{if(this.activetab&&o===t.indexOf(this.activetab))break;o+1>=t.length?o=0:o+=1}},this.adjustBackward=e=>{let t=this.tabs,o=0;for(o=this.activetab?t.indexOf(this.activetab)-1:0,o=o<0?t.length-1:o;o>=0&&t.length>1;)if(this.isFocusableElement(t[o])){this.moveToTabByIndex(t,o);break}else o-1<0?o=t.length-1:o-=1},this.moveToTabByIndex=(e,t)=>{let o=e[t];this.activetab=o,this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=t,o.focus(),this.setComponent()}}orientationChanged(){this.$fastController.isConnected&&(this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}activeidChanged(e,t){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.prevActiveTabIndex=this.tabs.findIndex(o=>o.id===e),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabsChanged(){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabpanelsChanged(){this.$fastController.isConnected&&this.tabpanels.length<=this.tabs.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}getActiveIndex(){return this.activeid!==void 0?this.tabIds.indexOf(this.activeid)===-1?0:this.tabIds.indexOf(this.activeid):0}getTabIds(){return this.tabs.map(e=>{var t;return(t=e.getAttribute("id"))!==null&&t!==void 0?t:`tab-${gi()}`})}getTabPanelIds(){return this.tabpanels.map(e=>{var t;return(t=e.getAttribute("id"))!==null&&t!==void 0?t:`panel-${gi()}`})}setComponent(){this.activeTabIndex!==this.prevActiveTabIndex&&(this.activeid=this.tabIds[this.activeTabIndex],this.focusTab(),this.change())}isHorizontal(){return this.orientation===yI.horizontal}handleActiveIndicatorPosition(){this.showActiveIndicator&&this.activeindicator&&this.activeTabIndex!==this.prevActiveTabIndex&&(this.ticking?this.ticking=!1:(this.ticking=!0,this.animateActiveIndicator()))}animateActiveIndicator(){this.ticking=!0;let e=this.isHorizontal()?"gridColumn":"gridRow",t=this.isHorizontal()?"translateX":"translateY",o=this.isHorizontal()?"offsetLeft":"offsetTop",i=this.activeIndicatorRef[o];this.activeIndicatorRef.style[e]=`${this.activeTabIndex+1}`;let n=this.activeIndicatorRef[o];this.activeIndicatorRef.style[e]=`${this.prevActiveTabIndex+1}`;let s=n-i;this.activeIndicatorRef.style.transform=`${t}(${s}px)`,this.activeIndicatorRef.classList.add("activeIndicatorTransition"),this.activeIndicatorRef.addEventListener("transitionend",()=>{this.ticking=!1,this.activeIndicatorRef.style[e]=`${this.activeTabIndex+1}`,this.activeIndicatorRef.style.transform=`${t}(0px)`,this.activeIndicatorRef.classList.remove("activeIndicatorTransition")})}adjust(e){let t=this.tabs.filter(s=>this.isFocusableElement(s)),o=t.indexOf(this.activetab),i=ka(0,t.length-1,o+e),n=this.tabs.indexOf(t[i]);n>-1&&this.moveToTabByIndex(this.tabs,n)}focusTab(){this.tabs[this.activeTabIndex].focus()}connectedCallback(){super.connectedCallback(),this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.activeTabIndex=this.getActiveIndex()}};w([C],Ui.prototype,"orientation",void 0);w([C],Ui.prototype,"activeid",void 0);w([I],Ui.prototype,"tabs",void 0);w([I],Ui.prototype,"tabpanels",void 0);w([C({mode:"boolean"})],Ui.prototype,"activeindicator",void 0);w([I],Ui.prototype,"activeIndicatorRef",void 0);w([I],Ui.prototype,"showActiveIndicator",void 0);Ye(Ui,_t)});var wI=y(()=>{l();c();d();vI();bI()});var Kb,Rm,CI=y(()=>{l();c();d();Jo();Ue();Kb=class extends q{},Rm=class extends Or(Kb){constructor(){super(...arguments),this.proxy=document.createElement("textarea")}}});var Pm,xI=y(()=>{l();c();d();Pm={none:"none",both:"both",horizontal:"horizontal",vertical:"vertical"}});var Fr,Wb=y(()=>{l();c();d();$e();A();bm();jr();CI();xI();Fr=class extends Rm{constructor(){super(...arguments),this.resize=Pm.none,this.cols=20,this.handleTextInput=()=>{this.value=this.control.value}}readOnlyChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.readOnly=this.readOnly)}autofocusChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.autofocus=this.autofocus)}listChanged(){this.proxy instanceof HTMLTextAreaElement&&this.proxy.setAttribute("list",this.list)}maxlengthChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.maxLength=this.maxlength)}minlengthChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.minLength=this.minlength)}spellcheckChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.spellcheck=this.spellcheck)}select(){this.control.select(),this.$emit("select")}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}};w([C({mode:"boolean"})],Fr.prototype,"readOnly",void 0);w([C],Fr.prototype,"resize",void 0);w([C({mode:"boolean"})],Fr.prototype,"autofocus",void 0);w([C({attribute:"form"})],Fr.prototype,"formId",void 0);w([C],Fr.prototype,"list",void 0);w([C({converter:ie})],Fr.prototype,"maxlength",void 0);w([C({converter:ie})],Fr.prototype,"minlength",void 0);w([C],Fr.prototype,"name",void 0);w([C],Fr.prototype,"placeholder",void 0);w([C({converter:ie,mode:"fromView"})],Fr.prototype,"cols",void 0);w([C({converter:ie,mode:"fromView"})],Fr.prototype,"rows",void 0);w([C({mode:"boolean"})],Fr.prototype,"spellcheck",void 0);w([I],Fr.prototype,"defaultSlottedNodes",void 0);Ye(Fr,Pa)});var kI,SI=y(()=>{l();c();d();A();Wb();kI=(r,e)=>O`
    <template
        class="
            ${t=>t.readOnly?"readonly":""}
            ${t=>t.resize!==Pm.none?`resize-${t.resize}`:""}"
    >
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${Le("defaultSlottedNodes")}></slot>
        </label>
        <textarea
            part="control"
            class="control"
            id="control"
            ?autofocus="${t=>t.autofocus}"
            cols="${t=>t.cols}"
            ?disabled="${t=>t.disabled}"
            form="${t=>t.form}"
            list="${t=>t.list}"
            maxlength="${t=>t.maxlength}"
            minlength="${t=>t.minlength}"
            name="${t=>t.name}"
            placeholder="${t=>t.placeholder}"
            ?readonly="${t=>t.readOnly}"
            ?required="${t=>t.required}"
            rows="${t=>t.rows}"
            ?spellcheck="${t=>t.spellcheck}"
            :value="${t=>t.value}"
            aria-atomic="${t=>t.ariaAtomic}"
            aria-busy="${t=>t.ariaBusy}"
            aria-controls="${t=>t.ariaControls}"
            aria-current="${t=>t.ariaCurrent}"
            aria-describedby="${t=>t.ariaDescribedby}"
            aria-details="${t=>t.ariaDetails}"
            aria-disabled="${t=>t.ariaDisabled}"
            aria-errormessage="${t=>t.ariaErrormessage}"
            aria-flowto="${t=>t.ariaFlowto}"
            aria-haspopup="${t=>t.ariaHaspopup}"
            aria-hidden="${t=>t.ariaHidden}"
            aria-invalid="${t=>t.ariaInvalid}"
            aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
            aria-label="${t=>t.ariaLabel}"
            aria-labelledby="${t=>t.ariaLabelledby}"
            aria-live="${t=>t.ariaLive}"
            aria-owns="${t=>t.ariaOwns}"
            aria-relevant="${t=>t.ariaRelevant}"
            aria-roledescription="${t=>t.ariaRoledescription}"
            @input="${(t,o)=>t.handleTextInput()}"
            @change="${t=>t.handleChange()}"
            ${Ie("control")}
        ></textarea>
    </template>
`});var _I=y(()=>{l();c();d();SI();Wb()});var TI,EI=y(()=>{l();c();d();A();Mt();xm();TI=(r,e)=>O`
    <template
        class="
            ${t=>t.readOnly?"readonly":""}
        "
    >
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot
                ${Le({property:"defaultSlottedNodes",filter:Xu})}
            ></slot>
        </label>
        <div class="root" part="root">
            ${kt(r,e)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${t=>t.handleTextInput()}"
                @change="${t=>t.handleChange()}"
                ?autofocus="${t=>t.autofocus}"
                ?disabled="${t=>t.disabled}"
                list="${t=>t.list}"
                maxlength="${t=>t.maxlength}"
                minlength="${t=>t.minlength}"
                pattern="${t=>t.pattern}"
                placeholder="${t=>t.placeholder}"
                ?readonly="${t=>t.readOnly}"
                ?required="${t=>t.required}"
                size="${t=>t.size}"
                ?spellcheck="${t=>t.spellcheck}"
                :value="${t=>t.value}"
                type="${t=>t.type}"
                aria-atomic="${t=>t.ariaAtomic}"
                aria-busy="${t=>t.ariaBusy}"
                aria-controls="${t=>t.ariaControls}"
                aria-current="${t=>t.ariaCurrent}"
                aria-describedby="${t=>t.ariaDescribedby}"
                aria-details="${t=>t.ariaDetails}"
                aria-disabled="${t=>t.ariaDisabled}"
                aria-errormessage="${t=>t.ariaErrormessage}"
                aria-flowto="${t=>t.ariaFlowto}"
                aria-haspopup="${t=>t.ariaHaspopup}"
                aria-hidden="${t=>t.ariaHidden}"
                aria-invalid="${t=>t.ariaInvalid}"
                aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
                aria-label="${t=>t.ariaLabel}"
                aria-labelledby="${t=>t.ariaLabelledby}"
                aria-live="${t=>t.ariaLive}"
                aria-owns="${t=>t.ariaOwns}"
                aria-relevant="${t=>t.ariaRelevant}"
                aria-roledescription="${t=>t.ariaRoledescription}"
                ${Ie("control")}
            />
            ${xt(r,e)}
        </div>
    </template>
`});var II=y(()=>{l();c();d();EI();bm()});var AI,RI=y(()=>{l();c();d();A();Mt();AI=(r,e)=>O`
    <template
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-orientation="${t=>t.orientation}"
        orientation="${t=>t.orientation}"
        role="toolbar"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        ${wa({property:"childItems",attributeFilter:["disabled","hidden"],filter:Gr(),subtree:!0})}
    >
        <slot name="label"></slot>
        <div class="positioning-region" part="positioning-region">
            ${kt(r,e)}
            <slot
                ${Le({filter:Gr(),property:"slottedItems"})}
            ></slot>
            ${xt(r,e)}
        </div>
    </template>
`});var PI,wn,Xc,$I=y(()=>{l();c();d();$e();A();be();Pb();Ue();Bu();Mt();jr();Sa();PI=Object.freeze({[xa.ArrowUp]:{[Tt.vertical]:-1},[xa.ArrowDown]:{[Tt.vertical]:1},[xa.ArrowLeft]:{[Tt.horizontal]:{[ot.ltr]:-1,[ot.rtl]:1}},[xa.ArrowRight]:{[Tt.horizontal]:{[ot.ltr]:1,[ot.rtl]:-1}}}),wn=class r extends q{constructor(){super(...arguments),this._activeIndex=0,this.direction=ot.ltr,this.orientation=Tt.horizontal}get activeIndex(){return fe.track(this,"activeIndex"),this._activeIndex}set activeIndex(e){this.$fastController.isConnected&&(this._activeIndex=ka(0,this.focusableElements.length-1,e),fe.notify(this,"activeIndex"))}slottedItemsChanged(){this.$fastController.isConnected&&this.reduceFocusableElements()}clickHandler(e){var t;let o=(t=this.focusableElements)===null||t===void 0?void 0:t.indexOf(e.target);return o>-1&&this.activeIndex!==o&&this.setFocusedElement(o),!0}childItemsChanged(e,t){this.$fastController.isConnected&&this.reduceFocusableElements()}connectedCallback(){super.connectedCallback(),this.direction=vi(this)}focusinHandler(e){let t=e.relatedTarget;!t||this.contains(t)||this.setFocusedElement()}getDirectionalIncrementer(e){var t,o,i,n,s;return(s=(i=(o=(t=PI[e])===null||t===void 0?void 0:t[this.orientation])===null||o===void 0?void 0:o[this.direction])!==null&&i!==void 0?i:(n=PI[e])===null||n===void 0?void 0:n[this.orientation])!==null&&s!==void 0?s:0}keydownHandler(e){let t=e.key;if(!(t in xa)||e.defaultPrevented||e.shiftKey)return!0;let o=this.getDirectionalIncrementer(t);if(!o)return!e.target.closest("[role=radiogroup]");let i=this.activeIndex+o;return this.focusableElements[i]&&e.preventDefault(),this.setFocusedElement(i),!0}get allSlottedItems(){return[...this.start.assignedElements(),...this.slottedItems,...this.end.assignedElements()]}reduceFocusableElements(){var e;let t=(e=this.focusableElements)===null||e===void 0?void 0:e[this.activeIndex];this.focusableElements=this.allSlottedItems.reduce(r.reduceFocusableItems,[]);let o=this.focusableElements.indexOf(t);this.activeIndex=Math.max(0,o),this.setFocusableElements()}setFocusedElement(e=this.activeIndex){var t;this.activeIndex=e,this.setFocusableElements(),(t=this.focusableElements[this.activeIndex])===null||t===void 0||t.focus()}static reduceFocusableItems(e,t){var o,i,n,s;let a=t.getAttribute("role")==="radio",u=(i=(o=t.$fastController)===null||o===void 0?void 0:o.definition.shadowOptions)===null||i===void 0?void 0:i.delegatesFocus,h=Array.from((s=(n=t.shadowRoot)===null||n===void 0?void 0:n.querySelectorAll("*"))!==null&&s!==void 0?s:[]).some(p=>Rb(p));return!t.hasAttribute("disabled")&&!t.hasAttribute("hidden")&&(Rb(t)||a||u||h)?(e.push(t),e):t.childElementCount?e.concat(Array.from(t.children).reduce(r.reduceFocusableItems,[])):e}setFocusableElements(){this.$fastController.isConnected&&this.focusableElements.length>0&&this.focusableElements.forEach((e,t)=>{e.tabIndex=this.activeIndex===t?0:-1})}};w([I],wn.prototype,"direction",void 0);w([C],wn.prototype,"orientation",void 0);w([I],wn.prototype,"slottedItems",void 0);w([I],wn.prototype,"slottedLabel",void 0);w([I],wn.prototype,"childItems",void 0);Xc=class{};w([C({attribute:"aria-labelledby"})],Xc.prototype,"ariaLabelledby",void 0);w([C({attribute:"aria-label"})],Xc.prototype,"ariaLabel",void 0);Ye(Xc,ut);Ye(wn,_t,Xc)});var OI=y(()=>{l();c();d();RI();$I()});var MI,FI=y(()=>{l();c();d();A();zu();MI=(r,e)=>O`
        ${Xe(t=>t.tooltipVisible,O`
            <${r.tagFor(Fe)}
                fixed-placement="true"
                auto-update-mode="${t=>t.autoUpdateMode}"
                vertical-positioning-mode="${t=>t.verticalPositioningMode}"
                vertical-default-position="${t=>t.verticalDefaultPosition}"
                vertical-inset="${t=>t.verticalInset}"
                vertical-scaling="${t=>t.verticalScaling}"
                horizontal-positioning-mode="${t=>t.horizontalPositioningMode}"
                horizontal-default-position="${t=>t.horizontalDefaultPosition}"
                horizontal-scaling="${t=>t.horizontalScaling}"
                horizontal-inset="${t=>t.horizontalInset}"
                vertical-viewport-lock="${t=>t.horizontalViewportLock}"
                horizontal-viewport-lock="${t=>t.verticalViewportLock}"
                dir="${t=>t.currentDirection}"
                ${Ie("region")}
            >
                <div class="tooltip" part="tooltip" role="tooltip">
                    <slot></slot>
                </div>
            </${r.tagFor(Fe)}>
        `)}
    `});var Lo,DI=y(()=>{l();c();d();Lo={top:"top",right:"right",bottom:"bottom",left:"left",start:"start",end:"end",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",topStart:"top-start",topEnd:"top-end",bottomStart:"bottom-start",bottomEnd:"bottom-end"}});var Xt,LI=y(()=>{l();c();d();$e();A();be();Sa();Ue();DI();Xt=class extends q{constructor(){super(...arguments),this.anchor="",this.delay=300,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.horizontalInset="false",this.verticalInset="false",this.horizontalScaling="content",this.verticalScaling="content",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition=void 0,this.tooltipVisible=!1,this.currentDirection=ot.ltr,this.showDelayTimer=null,this.hideDelayTimer=null,this.isAnchorHoveredFocused=!1,this.isRegionHovered=!1,this.handlePositionChange=e=>{this.classList.toggle("top",this.region.verticalPosition==="start"),this.classList.toggle("bottom",this.region.verticalPosition==="end"),this.classList.toggle("inset-top",this.region.verticalPosition==="insetStart"),this.classList.toggle("inset-bottom",this.region.verticalPosition==="insetEnd"),this.classList.toggle("center-vertical",this.region.verticalPosition==="center"),this.classList.toggle("left",this.region.horizontalPosition==="start"),this.classList.toggle("right",this.region.horizontalPosition==="end"),this.classList.toggle("inset-left",this.region.horizontalPosition==="insetStart"),this.classList.toggle("inset-right",this.region.horizontalPosition==="insetEnd"),this.classList.toggle("center-horizontal",this.region.horizontalPosition==="center")},this.handleRegionMouseOver=e=>{this.isRegionHovered=!0},this.handleRegionMouseOut=e=>{this.isRegionHovered=!1,this.startHideDelayTimer()},this.handleAnchorMouseOver=e=>{if(this.tooltipVisible){this.isAnchorHoveredFocused=!0;return}this.startShowDelayTimer()},this.handleAnchorMouseOut=e=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.handleAnchorFocusIn=e=>{this.startShowDelayTimer()},this.handleAnchorFocusOut=e=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.startHideDelayTimer=()=>{this.clearHideDelayTimer(),this.tooltipVisible&&(this.hideDelayTimer=window.setTimeout(()=>{this.updateTooltipVisibility()},60))},this.clearHideDelayTimer=()=>{this.hideDelayTimer!==null&&(clearTimeout(this.hideDelayTimer),this.hideDelayTimer=null)},this.startShowDelayTimer=()=>{if(!this.isAnchorHoveredFocused){if(this.delay>1){this.showDelayTimer===null&&(this.showDelayTimer=window.setTimeout(()=>{this.startHover()},this.delay));return}this.startHover()}},this.startHover=()=>{this.isAnchorHoveredFocused=!0,this.updateTooltipVisibility()},this.clearShowDelayTimer=()=>{this.showDelayTimer!==null&&(clearTimeout(this.showDelayTimer),this.showDelayTimer=null)},this.getAnchor=()=>{let e=this.getRootNode();return e instanceof ShadowRoot?e.getElementById(this.anchor):document.getElementById(this.anchor)},this.handleDocumentKeydown=e=>{if(!e.defaultPrevented&&this.tooltipVisible)switch(e.key){case Yo:this.isAnchorHoveredFocused=!1,this.updateTooltipVisibility(),this.$emit("dismiss");break}},this.updateTooltipVisibility=()=>{if(this.visible===!1)this.hideTooltip();else if(this.visible===!0){this.showTooltip();return}else{if(this.isAnchorHoveredFocused||this.isRegionHovered){this.showTooltip();return}this.hideTooltip()}},this.showTooltip=()=>{this.tooltipVisible||(this.currentDirection=vi(this),this.tooltipVisible=!0,document.addEventListener("keydown",this.handleDocumentKeydown),Z.queueUpdate(this.setRegionProps))},this.hideTooltip=()=>{this.tooltipVisible&&(this.clearHideDelayTimer(),this.region!==null&&this.region!==void 0&&(this.region.removeEventListener("positionchange",this.handlePositionChange),this.region.viewportElement=null,this.region.anchorElement=null,this.region.removeEventListener("mouseover",this.handleRegionMouseOver),this.region.removeEventListener("mouseout",this.handleRegionMouseOut)),document.removeEventListener("keydown",this.handleDocumentKeydown),this.tooltipVisible=!1)},this.setRegionProps=()=>{this.tooltipVisible&&(this.region.viewportElement=this.viewportElement,this.region.anchorElement=this.anchorElement,this.region.addEventListener("positionchange",this.handlePositionChange),this.region.addEventListener("mouseover",this.handleRegionMouseOver,{passive:!0}),this.region.addEventListener("mouseout",this.handleRegionMouseOut,{passive:!0}))}}visibleChanged(){this.$fastController.isConnected&&(this.updateTooltipVisibility(),this.updateLayout())}anchorChanged(){this.$fastController.isConnected&&(this.anchorElement=this.getAnchor())}positionChanged(){this.$fastController.isConnected&&this.updateLayout()}anchorElementChanged(e){if(this.$fastController.isConnected){if(e!=null&&(e.removeEventListener("mouseover",this.handleAnchorMouseOver),e.removeEventListener("mouseout",this.handleAnchorMouseOut),e.removeEventListener("focusin",this.handleAnchorFocusIn),e.removeEventListener("focusout",this.handleAnchorFocusOut)),this.anchorElement!==null&&this.anchorElement!==void 0){this.anchorElement.addEventListener("mouseover",this.handleAnchorMouseOver,{passive:!0}),this.anchorElement.addEventListener("mouseout",this.handleAnchorMouseOut,{passive:!0}),this.anchorElement.addEventListener("focusin",this.handleAnchorFocusIn,{passive:!0}),this.anchorElement.addEventListener("focusout",this.handleAnchorFocusOut,{passive:!0});let t=this.anchorElement.id;this.anchorElement.parentElement!==null&&this.anchorElement.parentElement.querySelectorAll(":hover").forEach(o=>{o.id===t&&this.startShowDelayTimer()})}this.region!==null&&this.region!==void 0&&this.tooltipVisible&&(this.region.anchorElement=this.anchorElement),this.updateLayout()}}viewportElementChanged(){this.region!==null&&this.region!==void 0&&(this.region.viewportElement=this.viewportElement),this.updateLayout()}connectedCallback(){super.connectedCallback(),this.anchorElement=this.getAnchor(),this.updateTooltipVisibility()}disconnectedCallback(){this.hideTooltip(),this.clearShowDelayTimer(),this.clearHideDelayTimer(),super.disconnectedCallback()}updateLayout(){switch(this.verticalPositioningMode="locktodefault",this.horizontalPositioningMode="locktodefault",this.position){case Lo.top:case Lo.bottom:this.verticalDefaultPosition=this.position,this.horizontalDefaultPosition="center";break;case Lo.right:case Lo.left:case Lo.start:case Lo.end:this.verticalDefaultPosition="center",this.horizontalDefaultPosition=this.position;break;case Lo.topLeft:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="left";break;case Lo.topRight:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="right";break;case Lo.bottomLeft:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="left";break;case Lo.bottomRight:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="right";break;case Lo.topStart:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="start";break;case Lo.topEnd:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="end";break;case Lo.bottomStart:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="start";break;case Lo.bottomEnd:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="end";break;default:this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition="center";break}}};w([C({mode:"boolean"})],Xt.prototype,"visible",void 0);w([C],Xt.prototype,"anchor",void 0);w([C],Xt.prototype,"delay",void 0);w([C],Xt.prototype,"position",void 0);w([C({attribute:"auto-update-mode"})],Xt.prototype,"autoUpdateMode",void 0);w([C({attribute:"horizontal-viewport-lock"})],Xt.prototype,"horizontalViewportLock",void 0);w([C({attribute:"vertical-viewport-lock"})],Xt.prototype,"verticalViewportLock",void 0);w([I],Xt.prototype,"anchorElement",void 0);w([I],Xt.prototype,"viewportElement",void 0);w([I],Xt.prototype,"verticalPositioningMode",void 0);w([I],Xt.prototype,"horizontalPositioningMode",void 0);w([I],Xt.prototype,"horizontalInset",void 0);w([I],Xt.prototype,"verticalInset",void 0);w([I],Xt.prototype,"horizontalScaling",void 0);w([I],Xt.prototype,"verticalScaling",void 0);w([I],Xt.prototype,"verticalDefaultPosition",void 0);w([I],Xt.prototype,"horizontalDefaultPosition",void 0);w([I],Xt.prototype,"tooltipVisible",void 0);w([I],Xt.prototype,"currentDirection",void 0)});var NI=y(()=>{l();c();d();FI();LI()});var HI,UI=y(()=>{l();c();d();A();Mt();HI=(r,e)=>O`
    <template
        role="treeitem"
        slot="${t=>t.isNestedItem()?"item":void 0}"
        tabindex="-1"
        class="${t=>t.expanded?"expanded":""} ${t=>t.selected?"selected":""} ${t=>t.nested?"nested":""}
            ${t=>t.disabled?"disabled":""}"
        aria-expanded="${t=>t.childItems&&t.childItemLength()>0?t.expanded:void 0}"
        aria-selected="${t=>t.selected}"
        aria-disabled="${t=>t.disabled}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        ${wa({property:"childItems",filter:Gr()})}
    >
        <div class="positioning-region" part="positioning-region">
            <div class="content-region" part="content-region">
                ${Xe(t=>t.childItems&&t.childItemLength()>0,O`
                        <div
                            aria-hidden="true"
                            class="expand-collapse-button"
                            part="expand-collapse-button"
                            @click="${(t,o)=>t.handleExpandCollapseButtonClick(o.event)}"
                            ${Ie("expandCollapseButton")}
                        >
                            <slot name="expand-collapse-glyph">
                                ${e.expandCollapseGlyph||""}
                            </slot>
                        </div>
                    `)}
                ${kt(r,e)}
                <slot></slot>
                ${xt(r,e)}
            </div>
        </div>
        ${Xe(t=>t.childItems&&t.childItemLength()>0&&(t.expanded||t.renderCollapsedChildren),O`
                <div role="group" class="items" part="items">
                    <slot name="item" ${Le("items")}></slot>
                </div>
            `)}
    </template>
`});function Ms(r){return qn(r)&&r.getAttribute("role")==="treeitem"}var er,Qb=y(()=>{l();c();d();$e();A();be();Mt();jr();Ue();er=class extends q{constructor(){super(...arguments),this.expanded=!1,this.focusable=!1,this.isNestedItem=()=>Ms(this.parentElement),this.handleExpandCollapseButtonClick=e=>{!this.disabled&&!e.defaultPrevented&&(this.expanded=!this.expanded)},this.handleFocus=e=>{this.setAttribute("tabindex","0")},this.handleBlur=e=>{this.setAttribute("tabindex","-1")}}expandedChanged(){this.$fastController.isConnected&&this.$emit("expanded-change",this)}selectedChanged(){this.$fastController.isConnected&&this.$emit("selected-change",this)}itemsChanged(e,t){this.$fastController.isConnected&&this.items.forEach(o=>{Ms(o)&&(o.nested=!0)})}static focusItem(e){e.focusable=!0,e.focus()}childItemLength(){let e=this.childItems.filter(t=>Ms(t));return e?e.length:0}};w([C({mode:"boolean"})],er.prototype,"expanded",void 0);w([C({mode:"boolean"})],er.prototype,"selected",void 0);w([C({mode:"boolean"})],er.prototype,"disabled",void 0);w([I],er.prototype,"focusable",void 0);w([I],er.prototype,"childItems",void 0);w([I],er.prototype,"items",void 0);w([I],er.prototype,"nested",void 0);w([I],er.prototype,"renderCollapsedChildren",void 0);Ye(er,_t)});var BI=y(()=>{l();c();d();UI();Qb()});var zI,VI=y(()=>{l();c();d();A();zI=(r,e)=>O`
    <template
        role="tree"
        ${Ie("treeView")}
        @keydown="${(t,o)=>t.handleKeyDown(o.event)}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        @click="${(t,o)=>t.handleClick(o.event)}"
        @selected-change="${(t,o)=>t.handleSelectedChange(o.event)}"
    >
        <slot ${Le("slottedTreeItems")}></slot>
    </template>
`});var Wl,qI=y(()=>{l();c();d();$e();A();be();Qb();Ue();Wl=class extends q{constructor(){super(...arguments),this.currentFocused=null,this.handleFocus=e=>{if(!(this.slottedTreeItems.length<1)){if(e.target===this){this.currentFocused===null&&(this.currentFocused=this.getValidFocusableItem()),this.currentFocused!==null&&er.focusItem(this.currentFocused);return}this.contains(e.target)&&(this.setAttribute("tabindex","-1"),this.currentFocused=e.target)}},this.handleBlur=e=>{e.target instanceof HTMLElement&&(e.relatedTarget===null||!this.contains(e.relatedTarget))&&this.setAttribute("tabindex","0")},this.handleKeyDown=e=>{if(e.defaultPrevented)return;if(this.slottedTreeItems.length<1)return!0;let t=this.getVisibleNodes();switch(e.key){case Tr:t.length&&er.focusItem(t[0]);return;case Er:t.length&&er.focusItem(t[t.length-1]);return;case ko:if(e.target&&this.isFocusableElement(e.target)){let o=e.target;o instanceof er&&o.childItemLength()>0&&o.expanded?o.expanded=!1:o instanceof er&&o.parentElement instanceof er&&er.focusItem(o.parentElement)}return!1;case So:if(e.target&&this.isFocusableElement(e.target)){let o=e.target;o instanceof er&&o.childItemLength()>0&&!o.expanded?o.expanded=!0:o instanceof er&&o.childItemLength()>0&&this.focusNextNode(1,e.target)}return;case Wt:e.target&&this.isFocusableElement(e.target)&&this.focusNextNode(1,e.target);return;case Qt:e.target&&this.isFocusableElement(e.target)&&this.focusNextNode(-1,e.target);return;case dr:this.handleClick(e);return}return!0},this.handleSelectedChange=e=>{if(e.defaultPrevented)return;if(!(e.target instanceof Element)||!Ms(e.target))return!0;let t=e.target;t.selected?(this.currentSelected&&this.currentSelected!==t&&(this.currentSelected.selected=!1),this.currentSelected=t):!t.selected&&this.currentSelected===t&&(this.currentSelected=null)},this.setItems=()=>{let e=this.treeView.querySelector("[aria-selected='true']");this.currentSelected=e,(this.currentFocused===null||!this.contains(this.currentFocused))&&(this.currentFocused=this.getValidFocusableItem()),this.nested=this.checkForNestedItems(),this.getVisibleNodes().forEach(o=>{Ms(o)&&(o.nested=this.nested)})},this.isFocusableElement=e=>Ms(e),this.isSelectedElement=e=>e.selected}slottedTreeItemsChanged(){this.$fastController.isConnected&&this.setItems()}connectedCallback(){super.connectedCallback(),this.setAttribute("tabindex","0"),Z.queueUpdate(()=>{this.setItems()})}handleClick(e){if(e.defaultPrevented)return;if(!(e.target instanceof Element)||!Ms(e.target))return!0;let t=e.target;t.disabled||(t.selected=!t.selected)}focusNextNode(e,t){let o=this.getVisibleNodes();if(!o)return;let i=o[o.indexOf(t)+e];qn(i)&&er.focusItem(i)}getValidFocusableItem(){let e=this.getVisibleNodes(),t=e.findIndex(this.isSelectedElement);return t===-1&&(t=e.findIndex(this.isFocusableElement)),t!==-1?e[t]:null}checkForNestedItems(){return this.slottedTreeItems.some(e=>Ms(e)&&e.querySelector("[role='treeitem']"))}getVisibleNodes(){return UT(this,"[role='treeitem']")||[]}};w([C({attribute:"render-collapsed-nodes"})],Wl.prototype,"renderCollapsedNodes",void 0);w([I],Wl.prototype,"currentSelected",void 0);w([I],Wl.prototype,"slottedTreeItems",void 0)});var GI=y(()=>{l();c();d();VI();qI()});var Yb,oh,me,FDe,DDe,jI=y(()=>{l();c();d();Yb=class{constructor(e){this.listenerCache=new WeakMap,this.query=e}bind(e){let{query:t}=this,o=this.constructListener(e);o.bind(t)(),t.addListener(o),this.listenerCache.set(e,o)}unbind(e){let t=this.listenerCache.get(e);t&&(this.query.removeListener(t),this.listenerCache.delete(e))}},oh=class r extends Yb{constructor(e,t){super(e),this.styles=t}static with(e){return t=>new r(e,t)}constructListener(e){let t=!1,o=this.styles;return function(){let{matches:n}=this;n&&!t?(e.$fastController.addStyles(o),t=n):!n&&t&&(e.$fastController.removeStyles(o),t=n)}}unbind(e){super.unbind(e),e.$fastController.removeStyles(this.styles)}},me=oh.with(window.matchMedia("(forced-colors)")),FDe=oh.with(window.matchMedia("(prefers-color-scheme: dark)")),DDe=oh.with(window.matchMedia("(prefers-color-scheme: light)"))});var $m,KI=y(()=>{l();c();d();A();$m=class{constructor(e,t,o){this.propertyName=e,this.value=t,this.styles=o}bind(e){fe.getNotifier(e).subscribe(this,this.propertyName),this.handleChange(e,this.propertyName)}unbind(e){fe.getNotifier(e).unsubscribe(this,this.propertyName),e.$fastController.removeStyles(this.styles)}handleChange(e,t){e[t]===this.value?e.$fastController.addStyles(this.styles):e.$fastController.removeStyles(this.styles)}}});var tr,WI=y(()=>{l();c();d();tr="not-allowed"});function de(r){return`${iO}:host{display:${r}}`}var iO,QI=y(()=>{l();c();d();iO=":host([hidden]){display:none}"});var ke,YI=y(()=>{l();c();d();be();ke=BT()?"focus-visible":"focus"});var ZI=y(()=>{l();c();d();WI();QI();YI()});var JI=y(()=>{l();c();d();jr();lm();pb();jI();KI();ZI();Sa();xm()});var W=y(()=>{l();c();d();RT();s2();a2();eb();g2();w2();k2();E2();D2();W2();J2();oE();lE();sb();uE();kb();hE();pE();xE();kE();TE();$E();DE();LE();NE();BE();qE();JE();Nb();n5();p5();Dl();v5();C5();_5();R5();M5();N5();V5();K5();Z5();rI();aI();uI();mI();wI();_I();II();OI();NI();BI();GI();JI()});function Bi(r,e,t){return isNaN(r)||r<=e?e:r>=t?t:r}function Om(r,e,t){return isNaN(r)||r<=e?0:r>=t?1:r/(t-e)}function Oa(r,e,t){return isNaN(r)?e:e+r*(t-e)}function Zb(r){return r*(Math.PI/180)}function XI(r){return r*(180/Math.PI)}function eA(r){let e=Math.round(Bi(r,0,255)).toString(16);return e.length===1?"0"+e:e}function mo(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:e+r*(t-e)}function Mm(r,e,t){if(r<=0)return e%360;if(r>=1)return t%360;let o=(e-t+360)%360,i=(t-e+360)%360;return o<=i?(e-o*r+360)%360:(e+o*r+360)%360}function $t(r,e){let t=Math.pow(10,e);return Math.round(r*t)/t}var INe,zi=y(()=>{l();c();d();INe=Math.PI*2});var Vi,ed=y(()=>{l();c();d();zi();Vi=class r{constructor(e,t,o){this.h=e,this.s=t,this.l=o}static fromObject(e){return e&&!isNaN(e.h)&&!isNaN(e.s)&&!isNaN(e.l)?new r(e.h,e.s,e.l):null}equalValue(e){return this.h===e.h&&this.s===e.s&&this.l===e.l}roundToPrecision(e){return new r($t(this.h,e),$t(this.s,e),$t(this.l,e))}toObject(){return{h:this.h,s:this.s,l:this.l}}}});var td,Fm=y(()=>{l();c();d();zi();td=class r{constructor(e,t,o){this.h=e,this.s=t,this.v=o}static fromObject(e){return e&&!isNaN(e.h)&&!isNaN(e.s)&&!isNaN(e.v)?new r(e.h,e.s,e.v):null}equalValue(e){return this.h===e.h&&this.s===e.s&&this.v===e.v}roundToPrecision(e){return new r($t(this.h,e),$t(this.s,e),$t(this.v,e))}toObject(){return{h:this.h,s:this.s,v:this.v}}}});var sr,ih=y(()=>{l();c();d();zi();sr=class r{constructor(e,t,o){this.l=e,this.a=t,this.b=o}static fromObject(e){return e&&!isNaN(e.l)&&!isNaN(e.a)&&!isNaN(e.b)?new r(e.l,e.a,e.b):null}equalValue(e){return this.l===e.l&&this.a===e.a&&this.b===e.b}roundToPrecision(e){return new r($t(this.l,e),$t(this.a,e),$t(this.b,e))}toObject(){return{l:this.l,a:this.a,b:this.b}}};sr.epsilon=216/24389;sr.kappa=24389/27});var Ma,nh=y(()=>{l();c();d();zi();Ma=class r{constructor(e,t,o){this.l=e,this.c=t,this.h=o}static fromObject(e){return e&&!isNaN(e.l)&&!isNaN(e.c)&&!isNaN(e.h)?new r(e.l,e.c,e.h):null}equalValue(e){return this.l===e.l&&this.c===e.c&&this.h===e.h}roundToPrecision(e){return new r($t(this.l,e),$t(this.c,e),$t(this.h,e))}toObject(){return{l:this.l,c:this.c,h:this.h}}}});var Ze,Kn=y(()=>{l();c();d();zi();Ze=class r{constructor(e,t,o,i){this.r=e,this.g=t,this.b=o,this.a=typeof i=="number"&&!isNaN(i)?i:1}static fromObject(e){return e&&!isNaN(e.r)&&!isNaN(e.g)&&!isNaN(e.b)?new r(e.r,e.g,e.b,e.a):null}equalValue(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}toStringHexRGB(){return"#"+[this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringHexRGBA(){return this.toStringHexRGB()+this.formatHexValue(this.a)}toStringHexARGB(){return"#"+[this.a,this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringWebRGB(){return`rgb(${Math.round(Oa(this.r,0,255))},${Math.round(Oa(this.g,0,255))},${Math.round(Oa(this.b,0,255))})`}toStringWebRGBA(){return`rgba(${Math.round(Oa(this.r,0,255))},${Math.round(Oa(this.g,0,255))},${Math.round(Oa(this.b,0,255))},${Bi(this.a,0,1)})`}roundToPrecision(e){return new r($t(this.r,e),$t(this.g,e),$t(this.b,e),$t(this.a,e))}clamp(){return new r(Bi(this.r,0,1),Bi(this.g,0,1),Bi(this.b,0,1),Bi(this.a,0,1))}toObject(){return{r:this.r,g:this.g,b:this.b,a:this.a}}formatHexValue(e){return eA(Oa(e,0,255))}}});var No,Dm=y(()=>{l();c();d();zi();No=class r{constructor(e,t,o){this.x=e,this.y=t,this.z=o}static fromObject(e){return e&&!isNaN(e.x)&&!isNaN(e.y)&&!isNaN(e.z)?new r(e.x,e.y,e.z):null}equalValue(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}roundToPrecision(e){return new r($t(this.x,e),$t(this.y,e),$t(this.z,e))}toObject(){return{x:this.x,y:this.y,z:this.z}}};No.whitePoint=new No(.95047,1,1.08883)});function Lm(r){return r.r*.2126+r.g*.7152+r.b*.0722}function rd(r){function e(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}return Lm(new Ze(e(r.r),e(r.g),e(r.b),1))}function e1(r,e){let t=rd(r),o=rd(e);return t>o?tA(t,o):tA(o,t)}function Jb(r,e,t){return t-e===0?0:(r-e)/(t-e)}function Xb(r,e,t){let o=Jb(r.r,e.r,t.r),i=Jb(r.g,e.g,t.g),n=Jb(r.b,e.b,t.b);return(o+i+n)/3}function rA(r,e,t=null){let o=0,i=t;return i!==null?o=Xb(r,e,i):(i=new Ze(0,0,0,1),o=Xb(r,e,i),o<=0&&(i=new Ze(1,1,1,1),o=Xb(r,e,i))),o=Math.round(o*1e3)/1e3,new Ze(i.r,i.g,i.b,o)}function yi(r){let e=Math.max(r.r,r.g,r.b),t=Math.min(r.r,r.g,r.b),o=e-t,i=0;o!==0&&(e===r.r?i=60*((r.g-r.b)/o%6):e===r.g?i=60*((r.b-r.r)/o+2):i=60*((r.r-r.g)/o+4)),i<0&&(i+=360);let n=(e+t)/2,s=0;return o!==0&&(s=o/(1-Math.abs(2*n-1))),new Vi(i,s,n)}function Fa(r,e=1){let t=(1-Math.abs(2*r.l-1))*r.s,o=t*(1-Math.abs(r.h/60%2-1)),i=r.l-t/2,n=0,s=0,a=0;return r.h<60?(n=t,s=o,a=0):r.h<120?(n=o,s=t,a=0):r.h<180?(n=0,s=t,a=o):r.h<240?(n=0,s=o,a=t):r.h<300?(n=o,s=0,a=t):r.h<360&&(n=t,s=0,a=o),new Ze(n+i,s+i,a+i,e)}function t1(r){let e=Math.max(r.r,r.g,r.b),t=Math.min(r.r,r.g,r.b),o=e-t,i=0;o!==0&&(e===r.r?i=60*((r.g-r.b)/o%6):e===r.g?i=60*((r.b-r.r)/o+2):i=60*((r.r-r.g)/o+4)),i<0&&(i+=360);let n=0;return e!==0&&(n=o/e),new td(i,n,e)}function oA(r,e=1){let t=r.s*r.v,o=t*(1-Math.abs(r.h/60%2-1)),i=r.v-t,n=0,s=0,a=0;return r.h<60?(n=t,s=o,a=0):r.h<120?(n=o,s=t,a=0):r.h<180?(n=0,s=t,a=o):r.h<240?(n=0,s=o,a=t):r.h<300?(n=o,s=0,a=t):r.h<360&&(n=t,s=0,a=o),new Ze(n+i,s+i,a+i,e)}function nO(r){let e=0,t=0;return r.h!==0&&(e=Math.cos(Zb(r.h))*r.c,t=Math.sin(Zb(r.h))*r.c),new sr(r.l,e,t)}function sO(r){let e=0;(Math.abs(r.b)>.001||Math.abs(r.a)>.001)&&(e=XI(Math.atan2(r.b,r.a))),e<0&&(e+=360);let t=Math.sqrt(r.a*r.a+r.b*r.b);return new Ma(r.l,t,e)}function aO(r){let e=(r.l+16)/116,t=e+r.a/500,o=e-r.b/200,i=Math.pow(t,3),n=Math.pow(e,3),s=Math.pow(o,3),a=0;i>sr.epsilon?a=i:a=(116*t-16)/sr.kappa;let u=0;r.l>sr.epsilon*sr.kappa?u=n:u=r.l/sr.kappa;let h=0;return s>sr.epsilon?h=s:h=(116*o-16)/sr.kappa,a=No.whitePoint.x*a,u=No.whitePoint.y*u,h=No.whitePoint.z*h,new No(a,u,h)}function lO(r){function e(u){return u>sr.epsilon?Math.pow(u,1/3):(sr.kappa*u+16)/116}let t=e(r.x/No.whitePoint.x),o=e(r.y/No.whitePoint.y),i=e(r.z/No.whitePoint.z),n=116*o-16,s=500*(t-o),a=200*(o-i);return new sr(n,s,a)}function Nm(r){function e(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}let t=e(r.r),o=e(r.g),i=e(r.b),n=t*.4124564+o*.3575761+i*.1804375,s=t*.2126729+o*.7151522+i*.072175,a=t*.0193339+o*.119192+i*.9503041;return new No(n,s,a)}function r1(r,e=1){function t(s){return s<=.0031308?s*12.92:1.055*Math.pow(s,1/2.4)-.055}let o=t(r.x*3.2404542-r.y*1.5371385-r.z*.4985314),i=t(r.x*-.969266+r.y*1.8760108+r.z*.041556),n=t(r.x*.0556434-r.y*.2040259+r.z*1.0572252);return new Ze(o,i,n,e)}function Ql(r){return lO(Nm(r))}function Da(r,e=1){return r1(aO(r),e)}function sh(r){return sO(Ql(r))}function Hm(r,e=1){return Da(nO(r),e)}var tA,La=y(()=>{l();c();d();ed();Fm();ih();nh();Kn();Dm();zi();tA=(r,e)=>(r+.05)/(e+.05)});function n1(r,e,t=18){let o=sh(r),i=o.c+e*t;return i<0&&(i=0),Hm(new Ma(o.l,i,o.h))}function o1(r,e){return r*e}function s1(r,e){return new Ze(o1(r.r,e.r),o1(r.g,e.g),o1(r.b,e.b),1)}function i1(r,e){return r<.5?Bi(2*e*r,0,1):Bi(1-2*(1-e)*(1-r),0,1)}function a1(r,e){return new Ze(i1(r.r,e.r),i1(r.g,e.g),i1(r.b,e.b),1)}function nA(r,e){if(e.a>=1)return e;if(e.a<=0)return new Ze(r.r,r.g,r.b,1);let t=e.a*e.r+(1-e.a)*r.r,o=e.a*e.g+(1-e.a)*r.g,i=e.a*e.b+(1-e.a)*r.b;return new Ze(t,o,i,1)}var iA,l1=y(()=>{l();c();d();La();ed();ih();nh();Kn();zi();(function(r){r[r.Burn=0]="Burn",r[r.Color=1]="Color",r[r.Darken=2]="Darken",r[r.Dodge=3]="Dodge",r[r.Lighten=4]="Lighten",r[r.Multiply=5]="Multiply",r[r.Overlay=6]="Overlay",r[r.Screen=7]="Screen"})(iA||(iA={}))});function od(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Ze(mo(r,e.r,t.r),mo(r,e.g,t.g),mo(r,e.b,t.b),mo(r,e.a,t.a))}function cO(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Vi(Mm(r,e.h,t.h),mo(r,e.s,t.s),mo(r,e.l,t.l))}function dO(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new td(Mm(r,e.h,t.h),mo(r,e.s,t.s),mo(r,e.v,t.v))}function uO(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new No(mo(r,e.x,t.x),mo(r,e.y,t.y),mo(r,e.z,t.z))}function hO(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new sr(mo(r,e.l,t.l),mo(r,e.a,t.a),mo(r,e.b,t.b))}function pO(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Ma(mo(r,e.l,t.l),mo(r,e.c,t.c),Mm(r,e.h,t.h))}function Yl(r,e,t,o){if(isNaN(r)||r<=0)return t;if(r>=1)return o;switch(e){case To.HSL:return Fa(cO(r,yi(t),yi(o)));case To.HSV:return oA(dO(r,t1(t),t1(o)));case To.XYZ:return r1(uO(r,Nm(t),Nm(o)));case To.LAB:return Da(hO(r,Ql(t),Ql(o)));case To.LCH:return Hm(pO(r,sh(t),sh(o)));default:return od(r,t,o)}}var To,ah=y(()=>{l();c();d();La();ed();Fm();ih();nh();Kn();Dm();zi();(function(r){r[r.RGB=0]="RGB",r[r.HSL=1]="HSL",r[r.HSV=2]="HSV",r[r.XYZ=3]="XYZ",r[r.LAB=4]="LAB",r[r.LCH=5]="LCH"})(To||(To={}))});var Wn,Um=y(()=>{l();c();d();La();ah();Wn=class r{constructor(e){if(e==null||e.length===0)throw new Error("The stops argument must be non-empty");this.stops=this.sortColorScaleStops(e)}static createBalancedColorScale(e){if(e==null||e.length===0)throw new Error("The colors argument must be non-empty");let t=new Array(e.length);for(let o=0;o<e.length;o++)o===0?t[o]={color:e[o],position:0}:o===e.length-1?t[o]={color:e[o],position:1}:t[o]={color:e[o],position:o*(1/(e.length-1))};return new r(t)}getColor(e,t=To.RGB){if(this.stops.length===1)return this.stops[0].color;if(e<=0)return this.stops[0].color;if(e>=1)return this.stops[this.stops.length-1].color;let o=0;for(let s=0;s<this.stops.length;s++)this.stops[s].position<=e&&(o=s);let i=o+1;i>=this.stops.length&&(i=this.stops.length-1);let n=(e-this.stops[o].position)*(1/(this.stops[i].position-this.stops[o].position));return Yl(n,t,this.stops[o].color,this.stops[i].color)}trim(e,t,o=To.RGB){if(e<0||t>1||t<e)throw new Error("Invalid bounds");if(e===t)return new r([{color:this.getColor(e,o),position:0}]);let i=[];for(let a=0;a<this.stops.length;a++)this.stops[a].position>=e&&this.stops[a].position<=t&&i.push(this.stops[a]);if(i.length===0)return new r([{color:this.getColor(e),position:e},{color:this.getColor(t),position:t}]);i[0].position!==e&&i.unshift({color:this.getColor(e),position:e}),i[i.length-1].position!==t&&i.push({color:this.getColor(t),position:t});let n=t-e,s=new Array(i.length);for(let a=0;a<i.length;a++)s[a]={color:i[a].color,position:(i[a].position-e)/n};return new r(s)}findNextColor(e,t,o=!1,i=To.RGB,n=.005,s=32){isNaN(e)||e<=0?e=0:e>=1&&(e=1);let a=this.getColor(e,i),u=o?0:1,h=this.getColor(u,i);if(e1(a,h)<=t)return u;let f=o?0:e,b=o?e:0,x=u,S=0;for(;S<=s;){x=Math.abs(b-f)/2+f;let R=this.getColor(x,i),z=e1(a,R);if(Math.abs(z-t)<=n)return x;z>t?o?f=x:b=x:o?b=x:f=x,S++}return x}clone(){let e=new Array(this.stops.length);for(let t=0;t<e.length;t++)e[t]={color:this.stops[t].color,position:this.stops[t].position};return new r(e)}sortColorScaleStops(e){return e.sort((t,o)=>{let i=t.position,n=o.position;return i<n?-1:i>n?1:0})}}});var sA=y(()=>{l();c();d()});function pt(r){let e=fO.exec(r);if(e===null)return null;let t=e[1];if(t.length===3){let i=t.charAt(0),n=t.charAt(1),s=t.charAt(2);t=i.concat(i,n,n,s,s)}let o=parseInt(t,16);return isNaN(o)?null:new Ze(Om((o&16711680)>>>16,0,255),Om((o&65280)>>>8,0,255),Om(o&255,0,255),1)}var fO,Bm=y(()=>{l();c();d();Kn();zi();sA();fO=/^#((?:[0-9a-f]{6}|[0-9a-f]{3}))$/i});var Fs,hUe,c1=y(()=>{l();c();d();l1();La();ah();Kn();Um();Bm();Fs=class r{constructor(e){this.config=Object.assign({},r.defaultPaletteConfig,e),this.palette=[],this.updatePaletteColors()}updatePaletteGenerationValues(e){let t=!1;for(let o in e)this.config[o]&&(this.config[o].equalValue?this.config[o].equalValue(e[o])||(this.config[o]=e[o],t=!0):e[o]!==this.config[o]&&(this.config[o]=e[o],t=!0));return t&&this.updatePaletteColors(),t}updatePaletteColors(){let e=this.generatePaletteColorScale();for(let t=0;t<this.config.steps;t++)this.palette[t]=e.getColor(t/(this.config.steps-1),this.config.interpolationMode)}generatePaletteColorScale(){let e=yi(this.config.baseColor),o=new Wn([{position:0,color:this.config.scaleColorLight},{position:.5,color:this.config.baseColor},{position:1,color:this.config.scaleColorDark}]).trim(this.config.clipLight,1-this.config.clipDark),i=o.getColor(0),n=o.getColor(1),s=i,a=n;if(e.s>=this.config.saturationAdjustmentCutoff&&(s=n1(s,this.config.saturationLight),a=n1(a,this.config.saturationDark)),this.config.multiplyLight!==0){let u=s1(this.config.baseColor,s);s=Yl(this.config.multiplyLight,this.config.interpolationMode,s,u)}if(this.config.multiplyDark!==0){let u=s1(this.config.baseColor,a);a=Yl(this.config.multiplyDark,this.config.interpolationMode,a,u)}if(this.config.overlayLight!==0){let u=a1(this.config.baseColor,s);s=Yl(this.config.overlayLight,this.config.interpolationMode,s,u)}if(this.config.overlayDark!==0){let u=a1(this.config.baseColor,a);a=Yl(this.config.overlayDark,this.config.interpolationMode,a,u)}return this.config.baseScalePosition?this.config.baseScalePosition<=0?new Wn([{position:0,color:this.config.baseColor},{position:1,color:a.clamp()}]):this.config.baseScalePosition>=1?new Wn([{position:0,color:s.clamp()},{position:1,color:this.config.baseColor}]):new Wn([{position:0,color:s.clamp()},{position:this.config.baseScalePosition,color:this.config.baseColor},{position:1,color:a.clamp()}]):new Wn([{position:0,color:s.clamp()},{position:.5,color:this.config.baseColor},{position:1,color:a.clamp()}])}};Fs.defaultPaletteConfig={baseColor:pt("#808080"),steps:11,interpolationMode:To.RGB,scaleColorLight:new Ze(1,1,1,1),scaleColorDark:new Ze(0,0,0,1),clipLight:.185,clipDark:.16,saturationAdjustmentCutoff:.05,saturationLight:.35,saturationDark:1.25,overlayLight:0,overlayDark:.25,multiplyLight:0,multiplyDark:0,baseScalePosition:.5};Fs.greyscalePaletteConfig={baseColor:pt("#808080"),steps:11,interpolationMode:To.RGB,scaleColorLight:new Ze(1,1,1,1),scaleColorDark:new Ze(0,0,0,1),clipLight:0,clipDark:0,saturationAdjustmentCutoff:0,saturationLight:0,saturationDark:0,overlayLight:0,overlayDark:0,multiplyLight:0,multiplyDark:0,baseScalePosition:.5};hUe={targetSize:63,spacing:4,scaleColorLight:Fs.defaultPaletteConfig.scaleColorLight,scaleColorDark:Fs.defaultPaletteConfig.scaleColorDark}});var d1=y(()=>{l();c();d()});var u1=y(()=>{l();c();d();Kn()});var aA=y(()=>{l();c();d();d1();u1()});var h1,lA=y(()=>{l();c();d();Kn();c1();La();Um();ed();ah();Bm();h1=class r{constructor(e){this.palette=[],this.config=Object.assign({},r.defaultPaletteConfig,e),this.regenPalettes()}regenPalettes(){let e=this.config.steps;(isNaN(e)||e<3)&&(e=3);let t=.14,o=.06,i=new Ze(t,t,t,1),n=94,a=new Fs(Object.assign(Object.assign({},Fs.greyscalePaletteConfig),{baseColor:i,baseScalePosition:(1-t)*100/n,steps:e})).palette,u=Lm(this.config.baseColor),h=yi(this.config.baseColor).l,p=(u+h)/2,b=this.matchRelativeLuminanceIndex(p,a)/(e-1),S=this.matchRelativeLuminanceIndex(t,a)/(e-1),R=yi(this.config.baseColor),z=Fa(Vi.fromObject({h:R.h,s:R.s,l:t})),we=Fa(Vi.fromObject({h:R.h,s:R.s,l:o})),re=new Array(5);re[0]={position:0,color:new Ze(1,1,1,1)},re[1]={position:b,color:this.config.baseColor},re[2]={position:S,color:z},re[3]={position:.99,color:we},re[4]={position:1,color:new Ze(0,0,0,1)};let ge=new Wn(re);this.palette=new Array(e);for(let wt=0;wt<e;wt++){let je=ge.getColor(wt/(e-1),To.RGB);this.palette[wt]=je}}matchRelativeLuminanceIndex(e,t){let o=Number.MAX_VALUE,i=0,n=0,s=t.length;for(;n<s;n++){let a=Math.abs(Lm(t[n])-e);a<o&&(o=a,i=n)}return i}};h1.defaultPaletteConfig={baseColor:pt("#808080"),steps:94}});var cA=y(()=>{l();c();d();La()});var dA=y(()=>{l();c();d();Kn()});var Ds=y(()=>{l();c();d();l1();La();ed();Fm();ah();ih();nh();c1();aA();Kn();Um();Dm();lA();d1();zi();cA();Bm();dA();u1()});function Zl(r,e){let t=r.relativeLuminance>e.relativeLuminance?r:e,o=r.relativeLuminance>e.relativeLuminance?e:r;return(t.relativeLuminance+.05)/(o.relativeLuminance+.05)}var zm=y(()=>{l();c();d()});function uA(r){let e={r:0,g:0,b:0,toColorString:()=>"",contrast:()=>0,relativeLuminance:0};for(let t in e)if(typeof e[t]!=typeof r[t])return!1;return!0}var tt,Vm,Na=y(()=>{l();c();d();Ds();zm();tt=Object.freeze({create(r,e,t){return new Vm(r,e,t)},from(r){return new Vm(r.r,r.g,r.b)}});Vm=class r extends Ze{constructor(e,t,o){super(e,t,o,1),this.toColorString=this.toStringHexRGB,this.contrast=Zl.bind(null,this),this.createCSS=this.toColorString,this.relativeLuminance=rd(this)}static fromObject(e){return new r(e.r,e.g,e.b)}}});function qm(r,e,t=0,o=r.length-1){if(o===t)return r[t];let i=Math.floor((o-t)/2)+t;return e(r[i])?qm(r,e,t,i):qm(r,e,i+1,o)}var hA=y(()=>{l();c();d()});function qi(r){return r.relativeLuminance<=mO}var mO,id=y(()=>{l();c();d();mO=(-.1+Math.sqrt(.21))/2});function ti(r){return qi(r)?-1:1}var Ha=y(()=>{l();c();d();id()});function gO(r,e,t){return typeof r=="number"?Ua.from(tt.create(r,e,t)):Ua.from(r)}function vO(r,e){return uA(r)?Gm.from(r,e):Gm.from(tt.create(r.r,r.g,r.b),e)}var pA,Ua,Gm,jm=y(()=>{l();c();d();Ds();Na();hA();Ha();zm();pA={stepContrast:1.03,stepContrastRamp:.03,preserveSource:!1};Ua=Object.freeze({create:gO,from:vO}),Gm=class r{constructor(e,t){this.closestIndexCache=new Map,this.source=e,this.swatches=t,this.reversedSwatches=Object.freeze([...this.swatches].reverse()),this.lastIndex=this.swatches.length-1}colorContrast(e,t,o,i){o===void 0&&(o=this.closestIndexOf(e));let n=this.swatches,s=this.lastIndex,a=o;i===void 0&&(i=ti(e));let u=h=>Zl(e,h)>=t;return i===-1&&(n=this.reversedSwatches,a=s-a),qm(n,u,a,s)}get(e){return this.swatches[e]||this.swatches[Bi(e,0,this.lastIndex)]}closestIndexOf(e){if(this.closestIndexCache.has(e.relativeLuminance))return this.closestIndexCache.get(e.relativeLuminance);let t=this.swatches.indexOf(e);if(t!==-1)return this.closestIndexCache.set(e.relativeLuminance,t),t;let o=this.swatches.reduce((i,n)=>Math.abs(n.relativeLuminance-e.relativeLuminance)<Math.abs(i.relativeLuminance-e.relativeLuminance)?n:i);return t=this.swatches.indexOf(o),this.closestIndexCache.set(e.relativeLuminance,t),t}static saturationBump(e,t){let i=yi(e).s,n=yi(t);if(n.s<i){let s=new Vi(n.h,i,n.l);return Fa(s)}return t}static ramp(e){let t=e/100;return t>.5?(t-.5)/.5:2*t}static createHighResolutionPalette(e){let t=[],o=Ql(Ze.fromObject(e).roundToPrecision(4)),i=Da(new sr(0,o.a,o.b)).clamp().roundToPrecision(4),n=Da(new sr(50,o.a,o.b)).clamp().roundToPrecision(4),s=Da(new sr(100,o.a,o.b)).clamp().roundToPrecision(4),a=new Ze(0,0,0),u=new Ze(1,1,1),h=s.equalValue(u)?0:14,p=i.equalValue(a)?0:14;for(let f=100+h;f>=0-p;f-=.5){let b;if(f<0){let x=f/p+1;b=od(x,a,i)}else if(f<=50)b=od(r.ramp(f),i,n);else if(f<=100)b=od(r.ramp(f),n,s);else{let x=(f-100)/h;b=od(x,s,u)}b=r.saturationBump(n,b).roundToPrecision(4),t.push(tt.from(b))}return new r(e,t)}static adjustEnd(e,t,o,i){let n=i===-1?t.swatches:t.reversedSwatches,s=h=>{let p=t.closestIndexOf(h);return i===1?t.lastIndex-p:p};i===1&&o.reverse();let a=e(o[o.length-2]);if($t(Zl(o[o.length-1],o[o.length-2]),2)<a){o.pop();let h=t.colorContrast(n[t.lastIndex],a,void 0,i),p=s(h),f=s(o[o.length-2]),b=p-f,x=1;for(let S=o.length-b-1;S<o.length;S++){let R=s(o[S]),z=S===o.length-1?t.lastIndex:R+x;o[S]=n[z],x++}}i===1&&o.reverse()}static createColorPaletteByContrast(e,t){let o=r.createHighResolutionPalette(e),i=a=>{let u=t.stepContrast+t.stepContrast*(1-a.relativeLuminance)*t.stepContrastRamp;return $t(u,2)},n=[],s=t.preserveSource?e:o.swatches[0];n.push(s);do{let a=i(s);s=o.colorContrast(s,a,void 0,1),n.push(s)}while(s.relativeLuminance>0);if(t.preserveSource){s=e;do{let a=i(s);s=o.colorContrast(s,a,void 0,-1),n.unshift(s)}while(s.relativeLuminance<1)}return this.adjustEnd(i,o,n,-1),t.preserveSource&&this.adjustEnd(i,o,n,1),n}static from(e,t){let o=t===void 0?pA:Object.assign(Object.assign({},pA),t);return new r(e,Object.freeze(r.createColorPaletteByContrast(e,o)))}}});var nd,lh,fA,p1,mA,Km=y(()=>{l();c();d();Ds();Na();nd=tt.create(1,1,1),lh=tt.create(0,0,0),fA=tt.create(.5,.5,.5),p1=pt("#0078D4"),mA=tt.create(p1.r,p1.g,p1.b)});function f1(r,e,t,o,i){let n=p=>p.contrast(nd)>=i?nd:lh,s=n(r),a=n(e),u=s.relativeLuminance===a.relativeLuminance?s:n(t),h=n(o);return{rest:s,hover:a,active:u,focus:h}}var gA=y(()=>{l();c();d();Km()});var sd,m1=y(()=>{l();c();d();Ds();zm();sd=class r{constructor(e,t,o,i){this.toColorString=()=>this.cssGradient,this.contrast=Zl.bind(null,this),this.createCSS=this.toColorString,this.color=new Ze(e,t,o),this.cssGradient=i,this.relativeLuminance=rd(this.color),this.r=e,this.g=t,this.b=o}static fromObject(e,t){return new r(e.r,e.g,e.b,t)}}});function g1(r,e,t,o,i,n,s,a,u=10,h=!1){let p=r.closestIndexOf(e);a===void 0&&(a=ti(e));function f(ge){if(h){let wt=r.closestIndexOf(e),je=r.get(wt),it=ge.relativeLuminance<e.relativeLuminance?yO:bO,Po=rA(pt(ge.toColorString()),pt(je.toColorString()),it).roundToPrecision(2),Rr=nA(pt(e.toColorString()),Po);return tt.from(Rr)}else return ge}let b=p+a*t,x=b+a*(o-t),S=b+a*(i-t),R=b+a*(n-t),z=a===-1?0:100-u,we=a===-1?u:100;function re(ge,wt){let je=r.get(ge);if(wt){let it=r.get(ge+a*s),Po=a===-1?it:je,Rr=a===-1?je:it,T6=`linear-gradient(${f(Po).toColorString()} ${z}%, ${f(Rr).toColorString()} ${we}%)`;return sd.fromObject(Po,T6)}else return f(je)}return{rest:re(b,!0),hover:re(x,!0),active:re(S,!1),focus:re(R,!0)}}var yO,bO,vA=y(()=>{l();c();d();Ds();Na();Ha();m1();yO=new Ze(0,0,0),bO=new Ze(1,1,1)});function yA(r,e,t,o,i,n,s,a){let u=r.closestIndexOf(e),h=ti(e),p=u+h*t,f=p+h*(o-t),b=p+h*(i-t),x=p+h*(n-t),S=`calc(100% - ${a})`;function R(z,we){let re=r.get(z);if(we){let ge=r.get(z+h*s),wt=`linear-gradient(${re.toColorString()} ${S}, ${ge.toColorString()} ${S}, ${ge.toColorString()})`;return sd.fromObject(re,wt)}else return re}return{rest:R(p,!0),hover:R(f,!0),active:R(b,!1),focus:R(x,!0)}}var bA=y(()=>{l();c();d();Ha();m1()});function wA(r,e,t){return r.colorContrast(e,t)}var CA=y(()=>{l();c();d()});function Jl(r,e,t,o,i,n,s,a){a==null&&(a=ti(e));let u=r.closestIndexOf(r.colorContrast(e,t));return{rest:r.get(u+a*o),hover:r.get(u+a*i),active:r.get(u+a*n),focus:r.get(u+a*s)}}function xA(r,e,t,o,i,n,s,a=void 0,u,h,p,f,b,x=void 0){return qi(e)?Jl(r,e,u,h,p,f,b,x):Jl(r,e,t,o,i,n,s,a)}var kA=y(()=>{l();c();d();Ha();id()});function SA(r,e,t){return r.get(r.closestIndexOf(e)+ti(e)*t)}var _A=y(()=>{l();c();d();Ha()});function Ls(r,e,t,o,i,n,s){let a=r.closestIndexOf(e);return s==null&&(s=ti(e)),{rest:r.get(a+s*t),hover:r.get(a+s*o),active:r.get(a+s*i),focus:r.get(a+s*n)}}function Wm(r,e,t,o,i,n,s=void 0,a,u,h,p,f=void 0){return qi(e)?Ls(r,e,a,u,h,p,f):Ls(r,e,t,o,i,n,s)}var TA=y(()=>{l();c();d();Ha();id()});function EA(r,e){return qi(e)?nd:lh}function IA(r,e,t){return qi(e)?lh:nd}var AA=y(()=>{l();c();d();Km();id()});function RA(r){return tt.create(r,r,r)}var Qn,Qm=y(()=>{l();c();d();Na();(function(r){r[r.LightMode=.98]="LightMode",r[r.DarkMode=.15]="DarkMode"})(Qn||(Qn={}))});function Ns(r,e){return r.closestIndexOf(RA(e))}function PA(r,e){return r.get(Ns(r,e))}var ad=y(()=>{l();c();d();Qm()});function $A(r,e,t){return r.get(Ns(r,e)+t)}var OA=y(()=>{l();c();d();ad()});function v1(r,e,t){return r.get(Ns(r,e)+t*-1)}var MA=y(()=>{l();c();d();ad()});function FA(r,e,t){return r.get(Ns(r,e)+t*-1*2)}var DA=y(()=>{l();c();d();ad()});function LA(r,e,t){return r.get(Ns(r,e)+t*-1*3)}var NA=y(()=>{l();c();d();ad()});var HA,UA=y(()=>{l();c();d();HA={Thin:100,ExtraLight:200,Light:300,Normal:400,Medium:500,SemiBold:600,Bold:700,ExtraBold:800,Black:900}});function te(r){return et.create({name:r,cssCustomPropertyName:null})}function Us(r){return e=>{let t=r.getValueFor(e),o=wO.getValueFor(e);if(t.endsWith("px")){let i=Number.parseFloat(t.replace("px",""));if(i<=12)return`"wght" ${o}, "opsz" 8`;if(i>24)return`"wght" ${o}, "opsz" 36`}return`"wght" ${o}, "opsz" 10.5`}}function WO(r,e,t,o,i,n){let s=ti(e),a=r.closestIndexOf(r.colorContrast(e,14)),u=a+s*Math.abs(t-o),h=s===1?t<o:s*t>s*o,p,f;return h?(p=a,f=u):(p=u,f=a),{rest:r.get(p),hover:r.get(f),active:r.get(p+s*i),focus:r.get(p+s*n)}}var L,ld,zt,Ba,GA,Eo,G,Oe,Ho,ee,rr,Io,wO,ch,og,jA,dh,cd,KA,uh,ig,WA,hh,ng,QA,ph,sg,YA,fh,ag,ZA,mh,lg,JA,gh,cg,XA,vh,dg,eR,Gi,Jm,Xm,eg,tg,y1,b1,w1,C1,x1,k1,S1,_1,T1,E1,I1,A1,Ym,BA,zA,VA,Hs,CO,xO,Zm,kO,SO,_O,TO,R1,P1,$1,O1,EO,M1,F1,D1,L1,N1,H1,U1,tR,rR,oR,iR,B1,qA,IO,AO,RO,PO,$O,yh,Ft,bh,z1,OO,aqe,MO,Yn,FO,DO,LO,lqe,NO,cqe,HO,dqe,Re,rg,ug,Qe,Yr,Zr,dd,hg,Uo,ud,hd,nR,pg,wh,Ch,xh,sR,fg,mg,gg,vg,aR,yg,Bo,V1,q1,uqe,Zn,kh,G1,hqe,j1,bg,pd,fd,md,gd,Bs,lR,pqe,fqe,UO,cR,zs,ji,vd,dR,uR,ri,Vs,Jn,Xn,hR,wg,Cg,pR,fR,mqe,xg,De,mR,gR,gqe,yd,es,kg,za,vR,yR,vqe,Sg,bd,_g,Tg,yqe,BO,Xl,Eg,K1,bR,bqe,wqe,W1,qs,Cqe,xqe,Ig,Ki,wd,Cd,kqe,zO,xd,VO,wR,Ag,Sqe,_qe,Tqe,Eqe,qO,GO,jO,KO,Rg,Iqe,Aqe,Rqe,Pqe,Ne=y(()=>{l();c();d();W();be();jm();gA();vA();bA();CA();kA();_A();TA();AA();OA();ad();MA();DA();NA();Km();Qm();Ha();UA();({create:L}=et);ld=L("direction").withDefault(ot.ltr),zt=L("disabled-opacity").withDefault(.3),Ba=L("base-height-multiplier").withDefault(8),GA=L("base-horizontal-spacing-multiplier").withDefault(3),Eo=L("density").withDefault(0),G=L("design-unit").withDefault(4),Oe=L("control-corner-radius").withDefault(4),Ho=L("layer-corner-radius").withDefault(8),ee=L("stroke-width").withDefault(1),rr=L("focus-stroke-width").withDefault(2),Io=L("body-font").withDefault('"Segoe UI Variable", "Segoe UI", sans-serif'),wO=L("font-weight").withDefault(HA.Normal);ch=L("type-ramp-base-font-size").withDefault("14px"),og=L("type-ramp-base-line-height").withDefault("20px"),jA=L("type-ramp-base-font-variations").withDefault(Us(ch)),dh=L("type-ramp-minus-1-font-size").withDefault("12px"),cd=L("type-ramp-minus-1-line-height").withDefault("16px"),KA=L("type-ramp-minus-1-font-variations").withDefault(Us(dh)),uh=L("type-ramp-minus-2-font-size").withDefault("10px"),ig=L("type-ramp-minus-2-line-height").withDefault("14px"),WA=L("type-ramp-minus-2-font-variations").withDefault(Us(uh)),hh=L("type-ramp-plus-1-font-size").withDefault("16px"),ng=L("type-ramp-plus-1-line-height").withDefault("22px"),QA=L("type-ramp-plus-1-font-variations").withDefault(Us(hh)),ph=L("type-ramp-plus-2-font-size").withDefault("20px"),sg=L("type-ramp-plus-2-line-height").withDefault("26px"),YA=L("type-ramp-plus-2-font-variations").withDefault(Us(ph)),fh=L("type-ramp-plus-3-font-size").withDefault("24px"),ag=L("type-ramp-plus-3-line-height").withDefault("32px"),ZA=L("type-ramp-plus-3-font-variations").withDefault(Us(fh)),mh=L("type-ramp-plus-4-font-size").withDefault("28px"),lg=L("type-ramp-plus-4-line-height").withDefault("36px"),JA=L("type-ramp-plus-4-font-variations").withDefault(Us(mh)),gh=L("type-ramp-plus-5-font-size").withDefault("32px"),cg=L("type-ramp-plus-5-line-height").withDefault("40px"),XA=L("type-ramp-plus-5-font-variations").withDefault(Us(gh)),vh=L("type-ramp-plus-6-font-size").withDefault("40px"),dg=L("type-ramp-plus-6-line-height").withDefault("52px"),eR=L("type-ramp-plus-6-font-variations").withDefault(Us(vh)),Gi=L("base-layer-luminance").withDefault(Qn.LightMode),Jm=te("accent-fill-rest-delta").withDefault(0),Xm=te("accent-fill-hover-delta").withDefault(-2),eg=te("accent-fill-active-delta").withDefault(-5),tg=te("accent-fill-focus-delta").withDefault(0),y1=te("accent-foreground-rest-delta").withDefault(0),b1=te("accent-foreground-hover-delta").withDefault(3),w1=te("accent-foreground-active-delta").withDefault(-8),C1=te("accent-foreground-focus-delta").withDefault(0),x1=te("neutral-fill-rest-delta").withDefault(-1),k1=te("neutral-fill-hover-delta").withDefault(1),S1=te("neutral-fill-active-delta").withDefault(0),_1=te("neutral-fill-focus-delta").withDefault(0),T1=te("neutral-fill-input-rest-delta").withDefault(-1),E1=te("neutral-fill-input-hover-delta").withDefault(1),I1=te("neutral-fill-input-active-delta").withDefault(0),A1=te("neutral-fill-input-focus-delta").withDefault(-2),Ym=te("neutral-fill-input-alt-rest-delta").withDefault(2),BA=te("neutral-fill-input-alt-hover-delta").withDefault(4),zA=te("neutral-fill-input-alt-active-delta").withDefault(6),VA=te("neutral-fill-input-alt-focus-delta").withDefault(2),Hs=te("neutral-fill-layer-rest-delta").withDefault(-2),CO=te("neutral-fill-layer-hover-delta").withDefault(-3),xO=te("neutral-fill-layer-active-delta").withDefault(-3),Zm=te("neutral-fill-layer-alt-rest-delta").withDefault(-1),kO=te("neutral-fill-secondary-rest-delta").withDefault(3),SO=te("neutral-fill-secondary-hover-delta").withDefault(2),_O=te("neutral-fill-secondary-active-delta").withDefault(1),TO=te("neutral-fill-secondary-focus-delta").withDefault(3),R1=te("neutral-fill-stealth-rest-delta").withDefault(0),P1=te("neutral-fill-stealth-hover-delta").withDefault(3),$1=te("neutral-fill-stealth-active-delta").withDefault(2),O1=te("neutral-fill-stealth-focus-delta").withDefault(0),EO=te("neutral-fill-strong-rest-delta").withDefault(0),M1=te("neutral-fill-strong-hover-delta").withDefault(8),F1=te("neutral-fill-strong-active-delta").withDefault(-5),D1=te("neutral-fill-strong-focus-delta").withDefault(0),L1=te("neutral-stroke-rest-delta").withDefault(8),N1=te("neutral-stroke-hover-delta").withDefault(12),H1=te("neutral-stroke-active-delta").withDefault(6),U1=te("neutral-stroke-focus-delta").withDefault(8),tR=te("neutral-stroke-control-rest-delta").withDefault(3),rR=te("neutral-stroke-control-hover-delta").withDefault(5),oR=te("neutral-stroke-control-active-delta").withDefault(5),iR=te("neutral-stroke-control-focus-delta").withDefault(5),B1=te("neutral-stroke-divider-rest-delta").withDefault(4),qA=te("neutral-stroke-layer-rest-delta").withDefault(3),IO=te("neutral-stroke-layer-hover-delta").withDefault(3),AO=te("neutral-stroke-layer-active-delta").withDefault(3),RO=te("neutral-stroke-strong-hover-delta").withDefault(0),PO=te("neutral-stroke-strong-active-delta").withDefault(0),$O=te("neutral-stroke-strong-focus-delta").withDefault(0),yh=L("neutral-base-color").withDefault(fA),Ft=te("neutral-palette").withDefault(r=>Ua.from(yh.getValueFor(r))),bh=L("accent-base-color").withDefault(mA),z1=te("accent-palette").withDefault(r=>Ua.from(bh.getValueFor(r))),OO=te("neutral-layer-card-container-recipe").withDefault({evaluate:r=>v1(Ft.getValueFor(r),Gi.getValueFor(r),Hs.getValueFor(r))}),aqe=L("neutral-layer-card-container").withDefault(r=>OO.getValueFor(r).evaluate(r)),MO=te("neutral-layer-floating-recipe").withDefault({evaluate:r=>$A(Ft.getValueFor(r),Gi.getValueFor(r),Hs.getValueFor(r))}),Yn=L("neutral-layer-floating").withDefault(r=>MO.getValueFor(r).evaluate(r)),FO=te("neutral-layer-1-recipe").withDefault({evaluate:r=>PA(Ft.getValueFor(r),Gi.getValueFor(r))}),DO=L("neutral-layer-1").withDefault(r=>FO.getValueFor(r).evaluate(r)),LO=te("neutral-layer-2-recipe").withDefault({evaluate:r=>v1(Ft.getValueFor(r),Gi.getValueFor(r),Hs.getValueFor(r))}),lqe=L("neutral-layer-2").withDefault(r=>LO.getValueFor(r).evaluate(r)),NO=te("neutral-layer-3-recipe").withDefault({evaluate:r=>FA(Ft.getValueFor(r),Gi.getValueFor(r),Hs.getValueFor(r))}),cqe=L("neutral-layer-3").withDefault(r=>NO.getValueFor(r).evaluate(r)),HO=te("neutral-layer-4-recipe").withDefault({evaluate:r=>LA(Ft.getValueFor(r),Gi.getValueFor(r),Hs.getValueFor(r))}),dqe=L("neutral-layer-4").withDefault(r=>HO.getValueFor(r).evaluate(r)),Re=L("fill-color").withDefault(r=>DO.getValueFor(r));(function(r){r[r.normal=4.5]="normal",r[r.large=3]="large"})(rg||(rg={}));ug=te("accent-fill-recipe").withDefault({evaluate:(r,e)=>xA(z1.getValueFor(r),e||Re.getValueFor(r),5,Jm.getValueFor(r),Xm.getValueFor(r),eg.getValueFor(r),tg.getValueFor(r),void 0,8,Jm.getValueFor(r),Xm.getValueFor(r),eg.getValueFor(r),tg.getValueFor(r),void 0)}),Qe=L("accent-fill-rest").withDefault(r=>ug.getValueFor(r).evaluate(r).rest),Yr=L("accent-fill-hover").withDefault(r=>ug.getValueFor(r).evaluate(r).hover),Zr=L("accent-fill-active").withDefault(r=>ug.getValueFor(r).evaluate(r).active),dd=L("accent-fill-focus").withDefault(r=>ug.getValueFor(r).evaluate(r).focus),hg=te("foreground-on-accent-recipe").withDefault({evaluate:r=>f1(Qe.getValueFor(r),Yr.getValueFor(r),Zr.getValueFor(r),dd.getValueFor(r),rg.normal)}),Uo=L("foreground-on-accent-rest").withDefault(r=>hg.getValueFor(r).evaluate(r).rest),ud=L("foreground-on-accent-hover").withDefault(r=>hg.getValueFor(r).evaluate(r).hover),hd=L("foreground-on-accent-active").withDefault(r=>hg.getValueFor(r).evaluate(r).active),nR=L("foreground-on-accent-focus").withDefault(r=>hg.getValueFor(r).evaluate(r).focus),pg=te("accent-foreground-recipe").withDefault({evaluate:(r,e)=>Jl(z1.getValueFor(r),e||Re.getValueFor(r),9.5,y1.getValueFor(r),b1.getValueFor(r),w1.getValueFor(r),C1.getValueFor(r))}),wh=L("accent-foreground-rest").withDefault(r=>pg.getValueFor(r).evaluate(r).rest),Ch=L("accent-foreground-hover").withDefault(r=>pg.getValueFor(r).evaluate(r).hover),xh=L("accent-foreground-active").withDefault(r=>pg.getValueFor(r).evaluate(r).active),sR=L("accent-foreground-focus").withDefault(r=>pg.getValueFor(r).evaluate(r).focus),fg=te("accent-stroke-control-recipe").withDefault({evaluate:(r,e)=>g1(Ft.getValueFor(r),e||Re.getValueFor(r),-3,-3,-3,-3,10,1,void 0,!0)}),mg=L("accent-stroke-control-rest").withDefault(r=>fg.getValueFor(r).evaluate(r,Qe.getValueFor(r)).rest),gg=L("accent-stroke-control-hover").withDefault(r=>fg.getValueFor(r).evaluate(r,Yr.getValueFor(r)).hover),vg=L("accent-stroke-control-active").withDefault(r=>fg.getValueFor(r).evaluate(r,Zr.getValueFor(r)).active),aR=L("accent-stroke-control-focus").withDefault(r=>fg.getValueFor(r).evaluate(r,dd.getValueFor(r)).focus),yg=te("neutral-fill-recipe").withDefault({evaluate:(r,e)=>Wm(Ft.getValueFor(r),e||Re.getValueFor(r),x1.getValueFor(r),k1.getValueFor(r),S1.getValueFor(r),_1.getValueFor(r),void 0,2,3,1,2,void 0)}),Bo=L("neutral-fill-rest").withDefault(r=>yg.getValueFor(r).evaluate(r).rest),V1=L("neutral-fill-hover").withDefault(r=>yg.getValueFor(r).evaluate(r).hover),q1=L("neutral-fill-active").withDefault(r=>yg.getValueFor(r).evaluate(r).active),uqe=L("neutral-fill-focus").withDefault(r=>yg.getValueFor(r).evaluate(r).focus),Zn=te("neutral-fill-input-recipe").withDefault({evaluate:(r,e)=>Wm(Ft.getValueFor(r),e||Re.getValueFor(r),T1.getValueFor(r),E1.getValueFor(r),I1.getValueFor(r),A1.getValueFor(r),void 0,2,3,1,0,void 0)}),kh=L("neutral-fill-input-rest").withDefault(r=>Zn.getValueFor(r).evaluate(r).rest),G1=L("neutral-fill-input-hover").withDefault(r=>Zn.getValueFor(r).evaluate(r).hover),hqe=L("neutral-fill-input-active").withDefault(r=>Zn.getValueFor(r).evaluate(r).active),j1=L("neutral-fill-input-focus").withDefault(r=>Zn.getValueFor(r).evaluate(r).focus),bg=te("neutral-fill-input-alt-recipe").withDefault({evaluate:(r,e)=>Wm(Ft.getValueFor(r),e||Re.getValueFor(r),Ym.getValueFor(r),BA.getValueFor(r),zA.getValueFor(r),VA.getValueFor(r),1,Ym.getValueFor(r),Ym.getValueFor(r)-BA.getValueFor(r),Ym.getValueFor(r)-zA.getValueFor(r),VA.getValueFor(r),1)}),pd=L("neutral-fill-input-alt-rest").withDefault(r=>bg.getValueFor(r).evaluate(r).rest),fd=L("neutral-fill-input-alt-hover").withDefault(r=>bg.getValueFor(r).evaluate(r).hover),md=L("neutral-fill-input-alt-active").withDefault(r=>bg.getValueFor(r).evaluate(r).active),gd=L("neutral-fill-input-alt-focus").withDefault(r=>bg.getValueFor(r).evaluate(r).focus),Bs=te("neutral-fill-layer-recipe").withDefault({evaluate:(r,e)=>Ls(Ft.getValueFor(r),e||Re.getValueFor(r),Hs.getValueFor(r),CO.getValueFor(r),xO.getValueFor(r),Hs.getValueFor(r),1)}),lR=L("neutral-fill-layer-rest").withDefault(r=>Bs.getValueFor(r).evaluate(r).rest),pqe=L("neutral-fill-layer-hover").withDefault(r=>Bs.getValueFor(r).evaluate(r).hover),fqe=L("neutral-fill-layer-active").withDefault(r=>Bs.getValueFor(r).evaluate(r).active),UO=te("neutral-fill-layer-alt-recipe").withDefault({evaluate:(r,e)=>Ls(Ft.getValueFor(r),e||Re.getValueFor(r),Zm.getValueFor(r),Zm.getValueFor(r),Zm.getValueFor(r),Zm.getValueFor(r))}),cR=L("neutral-fill-layer-alt-rest").withDefault(r=>UO.getValueFor(r).evaluate(r).rest),zs=te("neutral-fill-secondary-recipe").withDefault({evaluate:(r,e)=>Ls(Ft.getValueFor(r),e||Re.getValueFor(r),kO.getValueFor(r),SO.getValueFor(r),_O.getValueFor(r),TO.getValueFor(r))}),ji=L("neutral-fill-secondary-rest").withDefault(r=>zs.getValueFor(r).evaluate(r).rest),vd=L("neutral-fill-secondary-hover").withDefault(r=>zs.getValueFor(r).evaluate(r).hover),dR=L("neutral-fill-secondary-active").withDefault(r=>zs.getValueFor(r).evaluate(r).active),uR=L("neutral-fill-secondary-focus").withDefault(r=>zs.getValueFor(r).evaluate(r).focus),ri=te("neutral-fill-stealth-recipe").withDefault({evaluate:(r,e)=>Ls(Ft.getValueFor(r),e||Re.getValueFor(r),R1.getValueFor(r),P1.getValueFor(r),$1.getValueFor(r),O1.getValueFor(r))}),Vs=L("neutral-fill-stealth-rest").withDefault(r=>ri.getValueFor(r).evaluate(r).rest),Jn=L("neutral-fill-stealth-hover").withDefault(r=>ri.getValueFor(r).evaluate(r).hover),Xn=L("neutral-fill-stealth-active").withDefault(r=>ri.getValueFor(r).evaluate(r).active),hR=L("neutral-fill-stealth-focus").withDefault(r=>ri.getValueFor(r).evaluate(r).focus),wg=te("neutral-fill-strong-recipe").withDefault({evaluate:(r,e)=>Jl(Ft.getValueFor(r),e||Re.getValueFor(r),4.5,EO.getValueFor(r),M1.getValueFor(r),F1.getValueFor(r),D1.getValueFor(r))}),Cg=L("neutral-fill-strong-rest").withDefault(r=>wg.getValueFor(r).evaluate(r).rest),pR=L("neutral-fill-strong-hover").withDefault(r=>wg.getValueFor(r).evaluate(r).hover),fR=L("neutral-fill-strong-active").withDefault(r=>wg.getValueFor(r).evaluate(r).active),mqe=L("neutral-fill-strong-focus").withDefault(r=>wg.getValueFor(r).evaluate(r).focus),xg=te("neutral-foreground-recipe").withDefault({evaluate:(r,e)=>Jl(Ft.getValueFor(r),e||Re.getValueFor(r),16,0,-19,-30,0)}),De=L("neutral-foreground-rest").withDefault(r=>xg.getValueFor(r).evaluate(r).rest),mR=L("neutral-foreground-hover").withDefault(r=>xg.getValueFor(r).evaluate(r).hover),gR=L("neutral-foreground-active").withDefault(r=>xg.getValueFor(r).evaluate(r).active),gqe=L("neutral-foreground-focus").withDefault(r=>xg.getValueFor(r).evaluate(r).focus),yd=te("neutral-foreground-hint-recipe").withDefault({evaluate:(r,e)=>wA(Ft.getValueFor(r),e||Re.getValueFor(r),4.5)}),es=L("neutral-foreground-hint").withDefault(r=>yd.getValueFor(r).evaluate(r)),kg=te("neutral-stroke-recipe").withDefault({evaluate:(r,e)=>Ls(Ft.getValueFor(r),e||Re.getValueFor(r),L1.getValueFor(r),N1.getValueFor(r),H1.getValueFor(r),U1.getValueFor(r))}),za=L("neutral-stroke-rest").withDefault(r=>kg.getValueFor(r).evaluate(r).rest),vR=L("neutral-stroke-hover").withDefault(r=>kg.getValueFor(r).evaluate(r).hover),yR=L("neutral-stroke-active").withDefault(r=>kg.getValueFor(r).evaluate(r).active),vqe=L("neutral-stroke-focus").withDefault(r=>kg.getValueFor(r).evaluate(r).focus),Sg=te("neutral-stroke-control-recipe").withDefault({evaluate:(r,e)=>g1(Ft.getValueFor(r),e||Re.getValueFor(r),tR.getValueFor(r),rR.getValueFor(r),oR.getValueFor(r),iR.getValueFor(r),5)}),bd=L("neutral-stroke-control-rest").withDefault(r=>Sg.getValueFor(r).evaluate(r).rest),_g=L("neutral-stroke-control-hover").withDefault(r=>Sg.getValueFor(r).evaluate(r).hover),Tg=L("neutral-stroke-control-active").withDefault(r=>Sg.getValueFor(r).evaluate(r).active),yqe=L("neutral-stroke-control-focus").withDefault(r=>Sg.getValueFor(r).evaluate(r).focus),BO=te("neutral-stroke-divider-recipe").withDefault({evaluate:(r,e)=>SA(Ft.getValueFor(r),e||Re.getValueFor(r),B1.getValueFor(r))}),Xl=L("neutral-stroke-divider-rest").withDefault(r=>BO.getValueFor(r).evaluate(r)),Eg=te("neutral-stroke-input-recipe").withDefault({evaluate:(r,e)=>yA(Ft.getValueFor(r),e||Re.getValueFor(r),tR.getValueFor(r),rR.getValueFor(r),oR.getValueFor(r),iR.getValueFor(r),20,ee.getValueFor(r)+"px")}),K1=L("neutral-stroke-input-rest").withDefault(r=>Eg.getValueFor(r).evaluate(r).rest),bR=L("neutral-stroke-input-hover").withDefault(r=>Eg.getValueFor(r).evaluate(r).hover),bqe=L("neutral-stroke-input-active").withDefault(r=>Eg.getValueFor(r).evaluate(r).active),wqe=L("neutral-stroke-input-focus").withDefault(r=>Eg.getValueFor(r).evaluate(r).focus),W1=te("neutral-stroke-layer-recipe").withDefault({evaluate:(r,e)=>Ls(Ft.getValueFor(r),e||Re.getValueFor(r),qA.getValueFor(r),IO.getValueFor(r),AO.getValueFor(r),qA.getValueFor(r))}),qs=L("neutral-stroke-layer-rest").withDefault(r=>W1.getValueFor(r).evaluate(r).rest),Cqe=L("neutral-stroke-layer-hover").withDefault(r=>W1.getValueFor(r).evaluate(r).hover),xqe=L("neutral-stroke-layer-active").withDefault(r=>W1.getValueFor(r).evaluate(r).active),Ig=te("neutral-stroke-strong-recipe").withDefault({evaluate:(r,e)=>Jl(Ft.getValueFor(r),e||Re.getValueFor(r),5.5,0,RO.getValueFor(r),PO.getValueFor(r),$O.getValueFor(r))}),Ki=L("neutral-stroke-strong-rest").withDefault(r=>Ig.getValueFor(r).evaluate(r).rest),wd=L("neutral-stroke-strong-hover").withDefault(r=>Ig.getValueFor(r).evaluate(r).hover),Cd=L("neutral-stroke-strong-active").withDefault(r=>Ig.getValueFor(r).evaluate(r).active),kqe=L("neutral-stroke-strong-focus").withDefault(r=>Ig.getValueFor(r).evaluate(r).focus),zO=te("focus-stroke-outer-recipe").withDefault({evaluate:r=>EA(Ft.getValueFor(r),Re.getValueFor(r))}),xd=L("focus-stroke-outer").withDefault(r=>zO.getValueFor(r).evaluate(r)),VO=te("focus-stroke-inner-recipe").withDefault({evaluate:r=>IA(z1.getValueFor(r),Re.getValueFor(r),xd.getValueFor(r))}),wR=L("focus-stroke-inner").withDefault(r=>VO.getValueFor(r).evaluate(r)),Ag=te("foreground-on-accent-large-recipe").withDefault({evaluate:r=>f1(Qe.getValueFor(r),Yr.getValueFor(r),Zr.getValueFor(r),dd.getValueFor(r),rg.large)}),Sqe=L("foreground-on-accent-rest-large").withDefault(r=>Ag.getValueFor(r).evaluate(r).rest),_qe=L("foreground-on-accent-hover-large").withDefault(r=>Ag.getValueFor(r).evaluate(r,Yr.getValueFor(r)).hover),Tqe=L("foreground-on-accent-active-large").withDefault(r=>Ag.getValueFor(r).evaluate(r,Zr.getValueFor(r)).active),Eqe=L("foreground-on-accent-focus-large").withDefault(r=>Ag.getValueFor(r).evaluate(r,dd.getValueFor(r)).focus),qO=L("neutral-fill-inverse-rest-delta").withDefault(0),GO=L("neutral-fill-inverse-hover-delta").withDefault(-3),jO=L("neutral-fill-inverse-active-delta").withDefault(7),KO=L("neutral-fill-inverse-focus-delta").withDefault(0);Rg=te("neutral-fill-inverse-recipe").withDefault({evaluate:(r,e)=>WO(Ft.getValueFor(r),e||Re.getValueFor(r),qO.getValueFor(r),GO.getValueFor(r),jO.getValueFor(r),KO.getValueFor(r))}),Iqe=L("neutral-fill-inverse-rest").withDefault(r=>Rg.getValueFor(r).evaluate(r).rest),Aqe=L("neutral-fill-inverse-hover").withDefault(r=>Rg.getValueFor(r).evaluate(r).hover),Rqe=L("neutral-fill-inverse-active").withDefault(r=>Rg.getValueFor(r).evaluate(r).active),Pqe=L("neutral-fill-inverse-focus").withDefault(r=>Rg.getValueFor(r).evaluate(r).focus)});var Ge,Pg,Nqe,Hqe,Uqe,Bqe,zqe,Vqe,qqe,Yt=y(()=>{l();c();d();A();Ne();Ge=qr`
  font-family: ${Io};
  font-size: ${ch};
  line-height: ${og};
  font-weight: initial;
  font-variation-settings: ${jA};
`,Pg=qr`
  font-family: ${Io};
  font-size: ${dh};
  line-height: ${cd};
  font-weight: initial;
  font-variation-settings: ${KA};
`,Nqe=qr`
  font-family: ${Io};
  font-size: ${uh};
  line-height: ${ig};
  font-weight: initial;
  font-variation-settings: ${WA};
`,Hqe=qr`
  font-family: ${Io};
  font-size: ${hh};
  line-height: ${ng};
  font-weight: initial;
  font-variation-settings: ${QA};
`,Uqe=qr`
  font-family: ${Io};
  font-size: ${ph};
  line-height: ${sg};
  font-weight: initial;
  font-variation-settings: ${YA};
`,Bqe=qr`
  font-family: ${Io};
  font-size: ${fh};
  line-height: ${ag};
  font-weight: initial;
  font-variation-settings: ${ZA};
`,zqe=qr`
  font-family: ${Io};
  font-size: ${mh};
  line-height: ${lg};
  font-weight: initial;
  font-variation-settings: ${JA};
`,Vqe=qr`
  font-family: ${Io};
  font-size: ${gh};
  line-height: ${cg};
  font-weight: initial;
  font-variation-settings: ${XA};
`,qqe=qr`
  font-family: ${Io};
  font-size: ${vh};
  line-height: ${dg};
  font-weight: initial;
  font-variation-settings: ${eR};
`});var CR,xR=y(()=>{l();c();d();A();W();Ne();Yt();CR=(r,e)=>M`
    ${de("flex")} :host {
      box-sizing: border-box;
      flex-direction: column;
      ${Ge}
      color: ${De};
      gap: calc(${G} * 1px);
    }
  `});var or,ts,Jr=y(()=>{l();c();d();A();Ne();or=qr`
  outline: calc(${rr} * 1px) solid ${xd};
  outline-offset: calc(${rr} * -1px);
`,ts=qr`
  outline: calc(${rr} * 1px) solid ${xd};
  outline-offset: calc(${ee} * 1px);
`});var Ae,ec=y(()=>{l();c();d();A();Ne();Ae=qr`(${Ba} + ${Eo}) * ${G}`});var QO,YO,ZO,kR,SR=y(()=>{l();c();d();A();W();be();Ne();Jr();Yt();ec();QO=et.create("neutral-fill-stealth-rest-on-neutral-fill-layer-rest").withDefault(r=>{let e=Bs.getValueFor(r);return ri.getValueFor(r).evaluate(r,e.evaluate(r).rest).rest}),YO=et.create("neutral-fill-stealth-hover-on-neutral-fill-layer-rest").withDefault(r=>{let e=Bs.getValueFor(r);return ri.getValueFor(r).evaluate(r,e.evaluate(r).rest).hover}),ZO=et.create("neutral-fill-stealth-active-on-neutral-fill-layer-rest").withDefault(r=>{let e=Bs.getValueFor(r);return ri.getValueFor(r).evaluate(r,e.evaluate(r).rest).active}),kR=(r,e)=>M`
    ${de("flex")} :host {
      box-sizing: border-box;
      ${Ge};
      flex-direction: column;
      background: ${lR};
      color: ${De};
      border: calc(${ee} * 1px) solid ${qs};
      border-radius: calc(${Ho} * 1px);
    }

    .region {
      display: none;
      padding: calc(${G} * 2 * 1px);
      background: ${cR};
    }

    .heading {
      display: grid;
      position: relative;
      grid-template-columns: auto 1fr auto auto;
      align-items: center;
    }

    .button {
      appearance: none;
      border: none;
      background: none;
      grid-column: 2;
      grid-row: 1;
      outline: none;
      margin: calc(${G} * 3 * 1px) 0;
      padding: 0 calc(${G} * 2 * 1px);
      text-align: left;
      color: inherit;
      cursor: pointer;
      font: inherit;
    }

    .button::before {
      content: '';
      position: absolute;
      top: calc(${ee} * -1px);
      left: calc(${ee} * -1px);
      right: calc(${ee} * -1px);
      bottom: calc(${ee} * -1px);
      cursor: pointer;
    }

    .button:${ke}::before {
      ${or}
      border-radius: calc(${Ho} * 1px);
    }

    :host(.expanded) .button:${ke}::before {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    :host(.expanded) .region {
      display: block;
      border-top: calc(${ee} * 1px) solid ${qs};
      border-bottom-left-radius: calc((${Ho} - ${ee}) * 1px);
      border-bottom-right-radius: calc((${Ho} - ${ee}) * 1px);
    }

    .icon {
      display: flex;
      align-items: center;
      justify-content: center;
      grid-column: 4;
      pointer-events: none;
      background: ${QO};
      border-radius: calc(${Oe} * 1px);
      fill: currentcolor;
      width: calc(${Ae} * 1px);
      height: calc(${Ae} * 1px);
      margin: calc(${G} * 2 * 1px);
    }

    .heading:hover .icon {
      background: ${YO};
    }

    .heading:active .icon {
      background: ${ZO};
    }

    slot[name='collapsed-icon'] {
      display: flex;
    }

    :host(.expanded) slot[name='collapsed-icon'] {
      display: none;
    }

    slot[name='expanded-icon'] {
      display: none;
    }

    :host(.expanded) slot[name='expanded-icon'] {
      display: flex;
    }

    .start {
      display: flex;
      align-items: center;
      padding-inline-start: calc(${G} * 2 * 1px);
      justify-content: center;
      grid-column: 1;
    }

    .end {
      display: flex;
      align-items: center;
      justify-content: center;
      grid-column: 3;
    }

    .icon,
    .start,
    .end {
      position: relative;
    }
  `.withBehaviors(me(M`
        .button:${ke}::before {
          outline-color: ${T.Highlight};
        }
        .icon {
          fill: ${T.ButtonText};
        }
      `))});var JO,_R=y(()=>{l();c();d();W();SR();JO=gn.compose({baseName:"accordion-item",template:mT,styles:kR,collapsedIcon:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `,expandedIcon:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 7.35c.2.2.5.2.7 0L6 4.21l3.15 3.14a.5.5 0 10.7-.7l-3.5-3.5a.5.5 0 00-.7 0l-3.5 3.5a.5.5 0 000 .7z"/>
    </svg>
  `})});var XO,Q1=y(()=>{l();c();d();W();xR();_R();XO=jc.compose({baseName:"accordion",template:PT,styles:CR})});function J(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n}var bi=y(()=>{l();c();d()});var oi,Y1,Z1=y(()=>{l();c();d();Ne();oi=class{constructor(e,t){this.cache=new WeakMap,this.ltr=e,this.rtl=t}bind(e){this.attach(e)}unbind(e){let t=this.cache.get(e);t&&ld.unsubscribe(t)}attach(e){let t=this.cache.get(e)||new Y1(this.ltr,this.rtl,e),o=ld.getValueFor(e);ld.subscribe(t),t.attach(o),this.cache.set(e,t)}},Y1=class{constructor(e,t,o){this.ltr=e,this.rtl=t,this.source=o,this.attached=null}handleChange({target:e,token:t}){this.attach(t.getValueFor(this.source))}attach(e){this.attached!==this[e]&&(this.attached!==null&&this.source.$fastController.removeStyles(this.attached),this.attached=this[e],this.attached!==null&&this.source.$fastController.addStyles(this.attached))}}});var eM,tM,QGe,tc,rM,oM,iM,nM,TR,YGe,ZGe,JGe,sM,ER,aM,$g,lM,IR,J1=y(()=>{l();c();d();W();eM="0 0 2px rgba(0, 0, 0, 0.14)",tM="0 calc(var(--elevation) * 0.5px) calc((var(--elevation) * 1px)) rgba(0, 0, 0, 0.2)",QGe=`box-shadow: ${eM}, ${tM};`,tc=et.create({name:"elevation-shadow",cssCustomPropertyName:null}).withDefault({evaluate:(r,e,t)=>{let o=.12,i=.14;e>16&&(o=.2,i=.24);let n=`0 0 2px rgba(0, 0, 0, ${o})`,s=`0 calc(${e} * 0.5px) calc((${e} * 1px)) rgba(0, 0, 0, ${i})`;return`${n}, ${s}`}}),rM=et.create("elevation-shadow-card-rest-size").withDefault(4),oM=et.create("elevation-shadow-card-hover-size").withDefault(8),iM=et.create("elevation-shadow-card-active-size").withDefault(0),nM=et.create("elevation-shadow-card-focus-size").withDefault(8),TR=et.create("elevation-shadow-card-rest").withDefault(r=>tc.getValueFor(r).evaluate(r,rM.getValueFor(r))),YGe=et.create("elevation-shadow-card-hover").withDefault(r=>tc.getValueFor(r).evaluate(r,oM.getValueFor(r))),ZGe=et.create("elevation-shadow-card-active").withDefault(r=>tc.getValueFor(r).evaluate(r,iM.getValueFor(r))),JGe=et.create("elevation-shadow-card-focus").withDefault(r=>tc.getValueFor(r).evaluate(r,nM.getValueFor(r))),sM=et.create("elevation-shadow-tooltip-size").withDefault(16),ER=et.create("elevation-shadow-tooltip").withDefault(r=>tc.getValueFor(r).evaluate(r,sM.getValueFor(r))),aM=et.create("elevation-shadow-flyout-size").withDefault(32),$g=et.create("elevation-shadow-flyout").withDefault(r=>tc.getValueFor(r).evaluate(r,aM.getValueFor(r))),lM=et.create("elevation-shadow-dialog-size").withDefault(128),IR=et.create("elevation-shadow-dialog").withDefault(r=>tc.getValueFor(r).evaluate(r,lM.getValueFor(r)))});var Og,kd,Mg,AR,Fg,Dg,Sd,RR=y(()=>{l();c();d();A();be();W();ec();Ne();Yt();Jr();Og=(r,e,t,o="[disabled]")=>M`
    ${de("inline-flex")}
    
    :host {
      position: relative;
      box-sizing: border-box;
      ${Ge}
      height: calc(${Ae} * 1px);
      min-width: calc(${Ae} * 1px);
      color: ${De};
      border-radius: calc(${Oe} * 1px);
      fill: currentcolor;
    }

    .control {
      border: calc(${ee} * 1px) solid transparent;
      flex-grow: 1;
      box-sizing: border-box;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 0 calc((10 + (${G} * 2 * ${Eo})) * 1px);
      white-space: nowrap;
      outline: none;
      text-decoration: none;
      color: inherit;
      border-radius: inherit;
      fill: inherit;
      font-family: inherit;
    }

    .control,
    .end,
    .start {
      font: inherit;
    }

    .control.icon-only {
      padding: 0;
      line-height: 0;
    }

    .control:${ke} {
      ${or}
    }

    .control::-moz-focus-inner {
      border: 0;
    }

    .content {
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
      pointer-events: none;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }
  `,kd=(r,e,t,o="[disabled]")=>M`
    .control {
      background: padding-box linear-gradient(${Bo}, ${Bo}),
        border-box ${bd};
    }

    :host(${t}:hover) .control {
      background: padding-box linear-gradient(${V1}, ${V1}),
        border-box ${_g};
    }

    :host(${t}:active) .control {
      background: padding-box linear-gradient(${q1}, ${q1}),
        border-box ${Tg};
    }

    :host(${o}) .control {
      background: padding-box linear-gradient(${Bo}, ${Bo}),
        border-box ${za};
    }
  `.withBehaviors(me(M`
        .control {
          background: ${T.ButtonFace};
          border-color: ${T.ButtonText};
          color: ${T.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          forced-color-adjust: none;
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
          color: ${T.Highlight};
        }

        :host(${o}) .control {
          background: transparent;
          border-color: ${T.GrayText};
          color: ${T.GrayText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
        }

        :host([href]) .control {
          background: transparent;
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${T.CanvasText};
          color: ${T.CanvasText};
        }
    `)),Mg=(r,e,t,o="[disabled]")=>M`
    .control {
      background: padding-box linear-gradient(${Qe}, ${Qe}),
        border-box ${mg};
      color: ${Uo};
    }

    :host(${t}:hover) .control {
      background: padding-box linear-gradient(${Yr}, ${Yr}),
        border-box ${gg};
      color: ${ud};
    }

    :host(${t}:active) .control {
      background: padding-box linear-gradient(${Zr}, ${Zr}),
        border-box ${vg};
      color: ${hd};
    }

    :host(${o}) .control {
      background: ${Qe};
    }

    .control:${ke} {
      box-shadow: 0 0 0 calc(${rr} * 1px) ${wR} inset !important;
    }
  `.withBehaviors(me(M`
        .control {
          forced-color-adjust: none;
          background: ${T.Highlight};
          color: ${T.HighlightText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
          color: ${T.Highlight};
        }

        :host(${o}) .control {
          background: transparent;
          border-color: ${T.GrayText};
          color: ${T.GrayText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
          box-shadow: 0 0 0 calc(${rr} * 1px) ${T.HighlightText} inset !important;
        }

        :host([href]) .control {
          background: ${T.LinkText};
          color: ${T.HighlightText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: ${T.ButtonFace};
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }
      `)),AR=(r,e,t,o="[disabled]")=>M`
    :host {
      height: auto;
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      min-width: 0;
    }

    .control {
      display: inline;
      padding: 0;
      border: none;
      box-shadow: none;
      line-height: 1;
    }

    :host(${t}) .control {
      color: ${wh};
      text-decoration: underline 1px;
    }

    :host(${t}:hover) .control {
      color: ${Ch};
      text-decoration: none;
    }

    :host(${t}:active) .control {
      color: ${xh};
      text-decoration: none;
    }

    .control:${ke} {
      ${ts}
    }
  `.withBehaviors(me(M`
        :host(${t}) .control {
          color: ${T.LinkText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          color: ${T.CanvasText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
        }
      `)),Fg=(r,e,t,o="[disabled]")=>M`
    :host {
      color: ${wh};
    }

    .control {
      background: ${Vs};
    }

    :host(${t}:hover) .control {
      background: ${Jn};
      color: ${Ch};
    }

    :host(${t}:active) .control {
      background: ${Xn};
      color: ${xh};
    }

    :host(${o}) .control {
      background: ${Vs};
    }
  `.withBehaviors(me(M`
        :host {
          color: ${T.ButtonText};
        }

        .control {
          forced-color-adjust: none;
          background: transparent;
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: transparent;
          border-color: ${T.ButtonText};
          color: ${T.ButtonText};
        }

        :host(${o}) .control {
          background: transparent;
          color: ${T.GrayText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
        }

        :host([href]) .control {
          color: ${T.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }
      `)),Dg=(r,e,t,o="[disabled]")=>M`
    .control {
      background: transparent !important;
      border-color: ${za};
    }

    :host(${t}:hover) .control {
      border-color: ${vR};
    }

    :host(${t}:active) .control {
      border-color: ${yR};
    }

    :host(${o}) .control {
      background: transparent !important;
      border-color: ${za};
    }
  `.withBehaviors(me(M`
        .control {
          border-color: ${T.ButtonText};
          color: ${T.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
          color: ${T.Highlight};
        }

        :host(${o}) .control {
          border-color: ${T.GrayText};
          color: ${T.GrayText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
        }

        :host([href]) .control {
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${T.CanvasText};
          color: ${T.CanvasText};
        }
      `)),Sd=(r,e,t,o="[disabled]")=>M`
    .control {
      background: ${Vs};
    }

    :host(${t}:hover) .control {
      background: ${Jn};
    }

    :host(${t}:active) .control {
      background: ${Xn};
    }

    :host(${o}) .control {
      background: ${Vs};
    }
  `.withBehaviors(me(M`
        .control {
          forced-color-adjust: none;
          background: transparent;
          color: ${T.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: transparent;
          border-color: ${T.ButtonText};
          color: ${T.ButtonText};
        }

        :host(${o}) .control {
          background: transparent;
          color: ${T.GrayText};
        }
        
        .control:${ke} {
          outline-color: ${T.CanvasText};
        }

        :host([href]) .control {
          color: ${T.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }
      `))});var cM,dM,uM,hM,Va,rs,os,Wi,Qi,PR=y(()=>{l();c();d();A();W();be();Ne();Yt();ec();Jr();cM=et.create("input-placeholder-rest").withDefault(r=>{let e=Zn.getValueFor(r);return yd.getValueFor(r).evaluate(r,e.evaluate(r).rest)}),dM=et.create("input-placeholder-hover").withDefault(r=>{let e=Zn.getValueFor(r);return yd.getValueFor(r).evaluate(r,e.evaluate(r).hover)}),uM=et.create("input-filled-placeholder-rest").withDefault(r=>{let e=zs.getValueFor(r);return yd.getValueFor(r).evaluate(r,e.evaluate(r).rest)}),hM=et.create("input-filled-placeholder-hover").withDefault(r=>{let e=zs.getValueFor(r);return yd.getValueFor(r).evaluate(r,e.evaluate(r).hover)}),Va=(r,e,t)=>M`
  :host {
    ${Ge}
    color: ${De};
    fill: currentcolor;
    user-select: none;
    position: relative;
  }

  ${t} {
    box-sizing: border-box;
    position: relative;
    color: inherit;
    border: calc(${ee} * 1px) solid transparent;
    border-radius: calc(${Oe} * 1px);
    height: calc(${Ae} * 1px);
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
  }

  .control {
    width: 100%;
    outline: none;
  }

  .label {
    display: block;
    color: ${De};
    cursor: pointer;
    ${Ge}
    margin-bottom: 4px;
  }

  .label__hidden {
    display: none;
    visibility: hidden;
  }

  :host([disabled]) ${t},
  :host([readonly]) ${t},
  :host([disabled]) .label,
  :host([readonly]) .label,
  :host([disabled]) .control,
  :host([readonly]) .control {
    cursor: ${tr};
  }

  :host([disabled]) {
    opacity: ${zt};
  }
`,rs=(r,e,t)=>M`
  @media (forced-colors: none) {
    :host(:not([disabled]):active)::after {
      left: 50%;
      width: 40%;
      transform: translateX(-50%);
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    :host(:not([disabled]):focus-within)::after {
      left: 0;
      width: 100%;
      transform: none;
    }

    :host(:not([disabled]):active)::after,
    :host(:not([disabled]):focus-within:not(:active))::after {
      content: '';
      position: absolute;
      height: calc(${rr} * 1px);
      bottom: 0;
      border-bottom: calc(${rr} * 1px) solid ${Qe};
      border-bottom-left-radius: calc(${Oe} * 1px);
      border-bottom-right-radius: calc(${Oe} * 1px);
      z-index: 2;
      transition: all 300ms cubic-bezier(0.1, 0.9, 0.2, 1);
    }
  }
`,os=(r,e,t,o=":not([disabled]):not(:focus-within)")=>M`
  ${t} {
    background: padding-box linear-gradient(${kh}, ${kh}),
      border-box ${K1};
  }

  :host(${o}:hover) ${t} {
    background: padding-box linear-gradient(${G1}, ${G1}),
      border-box ${bR};
  }

  :host(:not([disabled]):focus-within) ${t} {
    background: padding-box linear-gradient(${j1}, ${j1}),
      border-box ${K1};
  }
  
  :host([disabled]) ${t} {
    background: padding-box linear-gradient(${kh}, ${kh}),
      border-box ${za};
  }

  .control::placeholder {
    color: ${cM};
  }

  :host(${o}:hover) .control::placeholder {
    color: ${dM};
  }
`,Wi=(r,e,t,o=":not([disabled]):not(:focus-within)")=>M`
  ${t} {
    background: ${ji};
  }

  :host(${o}:hover) ${t} {
    background: ${vd};
  }

  :host(:not([disabled]):focus-within) ${t} {
    background: ${uR};
  }

  :host([disabled]) ${t} {
    background: ${ji};
  }

  .control::placeholder {
    color: ${uM};
  }

  :host(${o}:hover) .control::placeholder {
    color: ${hM};
  }
`,Qi=(r,e,t,o=":not([disabled]):not(:focus-within)")=>M`
  :host {
    color: ${T.ButtonText};
  }

  ${t} {
    background: ${T.ButtonFace};
    border-color: ${T.ButtonText};
  }

  :host(${o}:hover) ${t},
  :host(:not([disabled]):focus-within) ${t} {
    border-color: ${T.Highlight};
  }

  :host([disabled]) ${t} {
    opacity: 1;
    background: ${T.ButtonFace};
    border-color: ${T.GrayText};
  }

  .control::placeholder,
  :host(${o}:hover) .control::placeholder {
    color: ${T.CanvasText};
  }

  :host(:not([disabled]):focus) ${t} {
    ${or}
    outline-color: ${T.Highlight};
  }

  :host([disabled]) {
    opacity: 1;
    color: ${T.GrayText};
  }

  :host([disabled]) ::placeholder,
  :host([disabled]) ::-webkit-input-placeholder {
    color: ${T.GrayText};
  }
`});var $R=y(()=>{l();c();d();RR();PR();Yt()});var Dt=y(()=>{l();c();d();Z1();J1();Jr();$R();ec()});function Ct(r,e){return new $m("appearance",r,e)}var Gs=y(()=>{l();c();d();W()});var rc,OR,MR=y(()=>{l();c();d();Dt();Gs();rc="[href]",OR=(r,e)=>Og(r,e,rc).withBehaviors(Ct("neutral",kd(r,e,rc)),Ct("accent",Mg(r,e,rc)),Ct("hypertext",AR(r,e,rc)),Ct("lightweight",Fg(r,e,rc)),Ct("outline",Dg(r,e,rc)),Ct("stealth",Sd(r,e,rc)))});var Lg,pM,X1=y(()=>{l();c();d();bi();A();W();MR();Lg=class extends ho{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){var e,t;let o=this.defaultSlottedContent.filter(i=>i.nodeType===Node.ELEMENT_NODE);o.length===1&&o[0]instanceof SVGElement?(e=this.control)===null||e===void 0||e.classList.add("icon-only"):(t=this.control)===null||t===void 0||t.classList.remove("icon-only")}};J([C],Lg.prototype,"appearance",void 0);pM=Lg.compose({baseName:"anchor",baseClass:ho,template:em,styles:OR,shadowOptions:{delegatesFocus:!0}})});var FR,DR=y(()=>{l();c();d();A();FR=(r,e)=>M`
  :host {
    contain: layout;
    display: block;
  }
`});var fM,ew=y(()=>{l();c();d();W();DR();fM=Fe.compose({baseName:"anchored-region",template:l2,styles:FR})});var LR,NR=y(()=>{l();c();d();A();W();Ne();Yt();LR=(r,e)=>M`
    ${de("inline-block")} :host {
      box-sizing: border-box;
      ${Pg};
    }

    .control {
      border-radius: calc(${Oe} * 1px);
      padding: calc(((${G} * 0.5) - ${ee}) * 1px) calc((${G} - ${ee}) * 1px);
      border: calc(${ee} * 1px) solid transparent;
    }

    :host(.lightweight) .control {
      background: transparent;
      color: ${De};
      font-weight: 600;
    }

    :host(.accent) .control {
      background: ${Qe};
      color: ${Uo};
    }

    :host(.neutral) .control {
      background: ${ji};
      color: ${De};
    }

    :host([circular]) .control {
      border-radius: 100px;
      min-width: calc(${cd} - calc(${G} * 1px));
      display: flex;
      align-items: center;
      justify-content: center;
    }
  `});var Ng,mM,tw=y(()=>{l();c();d();bi();A();W();NR();Ng=class extends _a{constructor(){super(...arguments),this.appearance="lightweight"}appearanceChanged(e,t){e!==t&&Z.queueUpdate(()=>{this.classList.add(t),this.classList.remove(e)})}};J([C({mode:"fromView"})],Ng.prototype,"appearance",void 0);mM=Ng.compose({baseName:"badge",baseClass:_a,template:v2,styles:LR})});var HR,UR=y(()=>{l();c();d();A();W();Yt();HR=(r,e)=>M`
  ${de("inline-block")} :host {
    box-sizing: border-box;
    ${Ge};
  }

  .list {
    display: flex;
  }
`});var rw,ow=y(()=>{l();c();d();W();UR();rw=Vu.compose({baseName:"breadcrumb",template:S2,styles:HR})});var BR,zR=y(()=>{l();c();d();A();W();be();Ne();Yt();Dt();Jr();BR=(r,e)=>M`
    ${de("inline-flex")} :host {
      background: transparent;
      color: ${De};
      fill: currentcolor;
      box-sizing: border-box;
      ${Ge};
      min-width: calc(${Ae} * 1px);
      border-radius: calc(${Oe} * 1px);
    }

    .listitem {
      display: flex;
      align-items: center;
      border-radius: inherit;
    }

    .control {
      position: relative;
      align-items: center;
      box-sizing: border-box;
      color: inherit;
      fill: inherit;
      cursor: pointer;
      display: flex;
      outline: none;
      text-decoration: none;
      white-space: nowrap;
      border-radius: inherit;
    }

    .control:hover {
      color: ${mR};
    }

    .control:active {
      color: ${gR};
    }

    .control:${ke} {
      ${ts}
    }

    :host(:not([href])),
    :host([aria-current]) .control {
      color: ${De};
      fill: currentcolor;
      cursor: default;
    }

    .start {
      display: flex;
      margin-inline-end: 6px;
    }

    .end {
      display: flex;
      margin-inline-start: 6px;
    }

    .separator {
      display: flex;
    }
  `.withBehaviors(me(M`
        :host(:not([href])),
        .start,
        .end,
        .separator {
          background: ${T.ButtonFace};
          color: ${T.ButtonText};
          fill: currentcolor;
        }
        .separator {
          fill: ${T.ButtonText};
        }
        :host([href]) {
          forced-color-adjust: none;
          background: ${T.ButtonFace};
          color: ${T.LinkText};
        }
        :host([href]) .control:hover {
          background: ${T.LinkText};
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        .control:${ke} {
          outline-color: ${T.LinkText};
        }
      `))});var iw,nw=y(()=>{l();c();d();W();zR();iw=Ps.compose({baseName:"breadcrumb-item",template:C2,styles:BR,shadowOptions:{delegatesFocus:!0},separator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>
    </svg>
  `})});var oc,qa,VR,qR=y(()=>{l();c();d();A();W();Dt();Gs();Ne();oc=":not([disabled])",qa="[disabled]",VR=(r,e)=>M`
    :host(${oc}) .control {
      cursor: pointer;
    }

    :host(${qa}) .control {
      cursor: ${tr};
    }

    @media (forced-colors: none) {
      :host(${qa}) .control {
        opacity: ${zt};
      }
    }

    ${Og(r,e,oc,qa)}
  `.withBehaviors(Ct("neutral",kd(r,e,oc,qa)),Ct("accent",Mg(r,e,oc,qa)),Ct("lightweight",Fg(r,e,oc,qa)),Ct("outline",Dg(r,e,oc,qa)),Ct("stealth",Sd(r,e,oc,qa)))});var Hg,Dr,sw=y(()=>{l();c();d();bi();A();W();qR();Hg=class extends po{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){let e=this.defaultSlottedContent.filter(t=>t.nodeType===Node.ELEMENT_NODE);e.length===1&&e[0]instanceof SVGElement?this.control.classList.add("icon-only"):this.control.classList.remove("icon-only")}};J([C],Hg.prototype,"appearance",void 0);Dr=Hg.compose({baseName:"button",baseClass:po,template:I2,styles:VR,shadowOptions:{delegatesFocus:!0}})});var gM,vM,GR,jR=y(()=>{l();c();d();A();W();be();Ne();Dt();Yt();gM=M`
.day.disabled::before {
  transform: translate(-50%, 0) rotate(45deg);
}
`,vM=M`
.day.disabled::before {
  transform: translate(50%, 0) rotate(-45deg);
}
`,GR=(r,e)=>M`
${de("inline-block")} :host {
  --calendar-cell-size: calc((${Ba} + 2 + ${Eo}) * ${G} * 1px);
  --calendar-gap: 2px;
  ${Ge}
  color: ${De};
}

.title {
  padding: calc(${G} * 2px);
  font-weight: 600;
}

.days {
  text-align: center;
}

.week-days,
.week {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  grid-gap: var(--calendar-gap);
  border: 0;
  padding: 0;
}

.day,
.week-day {
  border: 0;
  width: var(--calendar-cell-size);
  height: var(--calendar-cell-size);
  line-height: var(--calendar-cell-size);
  padding: 0;
  box-sizing: initial;
}

.week-day {
  font-weight: 600;
}

.day {
  border: calc(${ee} * 1px) solid transparent;
  border-radius: calc(${Oe} * 1px);
}

.interact .day {
  cursor: pointer;
}

.date {
  height: 100%;
}

.inactive .date,
.inactive.disabled::before {
  color: ${es};
}

.disabled::before {
  content: '';
  display: inline-block;
  width: calc(var(--calendar-cell-size) * .8);
  height: calc(${ee} * 1px);
  background: currentColor;
  position: absolute;
  margin-top: calc(var(--calendar-cell-size) / 2);
  transform-origin: center;
  z-index: 1;
}

.selected {
  color: ${Qe};
  border: 1px solid ${Qe};
  background: ${Re};
}

.selected + .selected {
  border-start-start-radius: 0;
  border-end-start-radius: 0;
  border-inline-start-width: 0;
  padding-inline-start: calc(var(--calendar-gap) + (${ee} + ${Oe}) * 1px);
  margin-inline-start: calc((${Oe} * -1px) - var(--calendar-gap));
}

.today.disabled::before {
  color: ${Uo};
}

.today .date {
  color: ${Uo};
  background: ${Qe};
  border-radius: 50%;
  position: relative;
}
`.withBehaviors(me(M`
          .day.selected {
              color: ${T.Highlight};
          }

          .today .date {
              background: ${T.Highlight};
              color: ${T.HighlightText};
          }
      `),new oi(gM,vM))});var Ug,aw,KR=y(()=>{l();c();d();bi();A();W();jR();Ug=class extends Fo{constructor(){super(...arguments),this.readonly=!0}};J([C({converter:Is})],Ug.prototype,"readonly",void 0);aw=Ug.compose({baseName:"calendar",template:j2,styles:GR,title:G2})});var WR,QR=y(()=>{l();c();d();A();W();be();Ne();Dt();WR=(r,e)=>M`
    ${de("block")} :host {
      display: block;
      contain: content;
      height: var(--card-height, 100%);
      width: var(--card-width, 100%);
      box-sizing: border-box;
      background: ${Re};
      color: ${De};
      border: calc(${ee} * 1px) solid ${qs};
      border-radius: calc(${Ho} * 1px);
      box-shadow: ${TR};
    }

    :host {
      content-visibility: auto;
    }
  `.withBehaviors(me(M`
        :host {
          background: ${T.Canvas};
          color: ${T.CanvasText};
        }
      `))});var Sh,Cn,lw=y(()=>{l();c();d();bi();W();A();Ds();Ne();Na();jm();QR();Sh=class extends Gu{cardFillColorChanged(e,t){if(t){let o=pt(t);o!==null&&(this.neutralPaletteSource=t,Re.setValueFor(this,tt.create(o.r,o.g,o.b)))}}neutralPaletteSourceChanged(e,t){if(t){let o=pt(t),i=tt.create(o.r,o.g,o.b);Ft.setValueFor(this,Ua.create(i))}}handleChange(e,t){this.cardFillColor||Re.setValueFor(this,o=>Bs.getValueFor(o).evaluate(o,Re.getValueFor(e)).rest)}connectedCallback(){super.connectedCallback();let e=Ul(this);if(e){let t=fe.getNotifier(e);t.subscribe(this,"fillColor"),t.subscribe(this,"neutralPalette"),this.handleChange(e,"fillColor")}}};J([C({attribute:"card-fill-color",mode:"fromView"})],Sh.prototype,"cardFillColor",void 0);J([C({attribute:"neutral-palette-source",mode:"fromView"})],Sh.prototype,"neutralPaletteSource",void 0);Cn=Sh.compose({baseName:"card",baseClass:Gu,template:Q2,styles:WR})});var YR,ZR=y(()=>{l();c();d();A();W();be();Dt();Ne();Yt();Jr();YR=(r,e)=>M`
    ${de("inline-flex")} :host {
      align-items: center;
      outline: none;
      ${""} user-select: none;
    }

    .control {
      position: relative;
      width: calc((${Ae} / 2 + ${G}) * 1px);
      height: calc((${Ae} / 2 + ${G}) * 1px);
      box-sizing: border-box;
      border-radius: calc(${Oe} * 1px);
      border: calc(${ee} * 1px) solid ${Ki};
      background: ${pd};
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      ${Ge}
      color: ${De};
      ${""} padding-inline-start: calc(${G} * 2px + 2px);
      margin-inline-end: calc(${G} * 2px + 2px);
      cursor: pointer;
    }

    slot[name='checked-indicator'],
    slot[name='indeterminate-indicator'] {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      fill: ${De};
      opacity: 0;
      pointer-events: none;
    }

    slot[name='indeterminate-indicator'] {
      position: absolute;
      top: 0;
    }

    :host(.checked) slot[name='checked-indicator'],
    :host(.checked) slot[name='indeterminate-indicator'] {
      fill: ${Uo};
    }

    :host(:not(.disabled):hover) .control {
      background: ${fd};
      border-color: ${wd};
    }

    :host(:not(.disabled):active) .control {
      background: ${md};
      border-color: ${Cd};
    }

    :host(:${ke}) .control {
      background: ${gd};
      ${ts}
    }

    :host(.checked) .control {
      background: ${Qe};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .control {
      background: ${Yr};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .control {
      background: ${Zr};
      border-color: transparent;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${tr};
    }

    :host(.checked:not(.indeterminate)) slot[name='checked-indicator'],
    :host(.indeterminate) slot[name='indeterminate-indicator'] {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${zt};
    }
  `.withBehaviors(me(M`
        .control {
          border-color: ${T.FieldText};
          background: ${T.Field};
        }
        :host(:not(.disabled):hover) .control,
        :host(:not(.disabled):active) .control {
          border-color: ${T.Highlight};
          background: ${T.Field};
        }
        slot[name='checked-indicator'],
        slot[name='indeterminate-indicator'] {
          fill: ${T.FieldText};
        }
        :host(:${ke}) .control {
          forced-color-adjust: none;
          outline-color: ${T.FieldText};
          background: ${T.Field};
          border-color: ${T.Highlight};
        }
        :host(.checked) .control {
          background: ${T.Highlight};
          border-color: ${T.Highlight};
        }
        :host(.checked:not(.disabled):hover) .control,
        :host(.checked:not(.disabled):active) .control {
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
        }
        :host(.checked) slot[name='checked-indicator'],
        :host(.checked) slot[name='indeterminate-indicator'] {
          fill: ${T.HighlightText};
        }
        :host(.checked:hover ) .control slot[name='checked-indicator'],
        :host(.checked:hover ) .control slot[name='indeterminate-indicator'] {
          fill: ${T.Highlight};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .control {
          border-color: ${T.GrayText};
          background: ${T.Field};
        }
        :host(.disabled) slot[name='checked-indicator'],
        :host(.checked.disabled:hover) .control slot[name='checked-indicator'],
        :host(.disabled) slot[name='indeterminate-indicator'],
        :host(.checked.disabled:hover) .control slot[name='indeterminate-indicator'] {
          fill: ${T.GrayText};
        }
      `))});var ic,cw=y(()=>{l();c();d();W();ZR();ic=Hl.compose({baseName:"checkbox",template:X2,styles:YR,checkedIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>
    </svg>
  `,indeterminateIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M3 8c0-.28.22-.5.5-.5h9a.5.5 0 010 1h-9A.5.5 0 013 8z"/>
    </svg>
  `})});var JR,Bg,XR,dw,yM,e4,uw=y(()=>{l();c();d();A();W();be();J1();ec();Gs();Ne();Yt();Jr();Dt();JR=".control",Bg=":not([disabled]):not([open])",XR="[disabled]",dw=(r,e)=>M`
    ${de("inline-flex")}
    
    :host {
      border-radius: calc(${Oe} * 1px);
      box-sizing: border-box;
      color: ${De};
      fill: currentcolor;
      font-family: ${Io};
      position: relative;
      user-select: none;
      min-width: 250px;
      vertical-align: top;
    }

    .listbox {
      box-shadow: ${$g};
      background: ${Re};
      border-radius: calc(${Ho} * 1px);
      box-sizing: border-box;
      display: inline-flex;
      flex-direction: column;
      left: 0;
      max-height: calc(var(--max-height) - (${Ae} * 1px));
      padding: calc((${G} - ${ee} ) * 1px);
      overflow-y: auto;
      position: absolute;
      width: 100%;
      z-index: 1;
      margin: 1px 0;
      border: calc(${ee} * 1px) solid transparent;
    }

    .listbox[hidden] {
      display: none;
    }

    .control {
      border: calc(${ee} * 1px) solid transparent;
      border-radius: calc(${Oe} * 1px);
      height: calc(${Ae} * 1px);
      align-items: center;
      box-sizing: border-box;
      cursor: pointer;
      display: flex;
      ${Ge}
      min-height: 100%;
      padding: 0 calc(${G} * 2.25px);
      width: 100%;
    }

    :host(:${ke}) {
      ${or}
    }

    :host([disabled]) .control {
      cursor: ${tr};
      opacity: ${zt};
      user-select: none;
    }

    :host([open][position='above']) .listbox {
      bottom: calc((${Ae} + ${G} * 2) * 1px);
    }

    :host([open][position='below']) .listbox {
      top: calc((${Ae} + ${G} * 2) * 1px);
    }

    .selected-value {
      font-family: inherit;
      flex: 1 1 auto;
      text-align: start;
    }

    .indicator {
      flex: 0 0 auto;
      margin-inline-start: 1em;
    }

    slot[name='listbox'] {
      display: none;
      width: 100%;
    }

    :host([open]) slot[name='listbox'] {
      display: flex;
      position: absolute;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }

    .start,
    .end,
    .indicator,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([role='option']) {
      flex: 0 0 auto;
    }
  `,yM=(r,e)=>M`
    :host([open]) .listbox {
      background: ${T.ButtonFace};
      border-color: ${T.CanvasText};
    }
  `,e4=(r,e)=>dw(r,e).withBehaviors(Ct("outline",kd(r,e,Bg,XR)),Ct("filled",Wi(r,e,JR,Bg).withBehaviors(me(Qi(r,e,JR,Bg)))),Ct("stealth",Sd(r,e,Bg,XR)),me(yM(r,e)))});var zg,hw,t4,r4=y(()=>{l();c();d();A();W();uw();Gs();Ne();Yt();Dt();zg=".control",hw=":not([disabled]):not([open])",t4=(r,e)=>M`
    ${dw(r,e)}

    ${rs(r,e,zg)}

    :host(:empty) .listbox {
      display: none;
    }

    :host([disabled]) *,
    :host([disabled]) {
      cursor: ${tr};
      user-select: none;
    }

    :host(:active) .selected-value {
      user-select: none;
    }

    .selected-value {
      -webkit-appearance: none;
      background: transparent;
      border: none;
      color: inherit;
      ${Ge}
      height: calc(100% - ${ee} * 1px));
      margin: auto 0;
      width: 100%;
      outline: none;
    }
  `.withBehaviors(Ct("outline",os(r,e,zg,hw)),Ct("filled",Wi(r,e,zg,hw)),me(Qi(r,e,zg,hw)))});var Vg,_h,pw=y(()=>{l();c();d();bi();A();W();Ne();r4();Vg=class extends Di{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&Re.setValueFor(this.listbox,Yn)}};J([C({mode:"fromView"})],Vg.prototype,"appearance",void 0);_h=Vg.compose({baseName:"combobox",baseClass:Di,shadowOptions:{delegatesFocus:!0},template:sE,styles:t4,indicator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `})});var o4,i4=y(()=>{l();c();d();A();o4=(r,e)=>M`
  :host {
    display: flex;
    position: relative;
    flex-direction: column;
  }
`});var n4,s4=y(()=>{l();c();d();A();W();Ne();n4=(r,e)=>M`
    :host {
      display: grid;
      padding: 1px 0;
      box-sizing: border-box;
      width: 100%;
      border-bottom: calc(${ee} * 1px) solid ${Xl};
    }

    :host(.header) {
    }

    :host(.sticky-header) {
      background: ${Re};
      position: sticky;
      top: 0;
    }
  `.withBehaviors(me(M`
        :host {
        }
      `))});var a4,l4=y(()=>{l();c();d();A();be();W();Ne();Yt();Jr();a4=(r,e)=>M`
    :host {
      padding: calc((${G} + ${rr} - ${ee}) * 1px) calc(((${G} * 3) + ${rr} - ${ee}) * 1px);
      color: ${De};
      box-sizing: border-box;
      ${Ge}
      border: transparent calc(${ee} * 1px) solid;
      overflow: hidden;
      white-space: nowrap;
      border-radius: calc(${Oe} * 1px);
    }

    :host(.column-header) {
      font-weight: 600;
    }

    :host(:${ke}) {
      ${or}
    }
  `.withBehaviors(me(M`
        :host {
          forced-color-adjust: none;
          background: ${T.Field};
          color: ${T.FieldText};
        }

        :host(:${ke}) {
          outline-color: ${T.FieldText};
        }
      `))});var bM,wM,CM,fw=y(()=>{l();c();d();W();i4();s4();l4();bM=Xo.compose({baseName:"data-grid-cell",template:V2,styles:a4}),wM=ur.compose({baseName:"data-grid-row",template:B2,styles:n4}),CM=Ir.compose({baseName:"data-grid",template:N2,styles:o4})});function Ce(r){return(e,t)=>{e[t+"Changed"]=function(o,i){i!=null?r.setValueFor(this,i):r.deleteValueFor(this)}}}var mw,c4,ve,xM,gw=y(()=>{l();c();d();bi();Ds();A();W();be();Na();Ne();mw={toView(r){return r==null?null:r?.toColorString()},fromView(r){if(r==null)return null;let e=pt(r);return e?tt.create(e.r,e.g,e.b):null}},c4=M`
  :host {
    background-color: ${Re};
    color: ${De};
  }
`.withBehaviors(me(M`
      :host {
        background-color: ${T.Canvas};
        box-shadow: 0 0 0 1px ${T.CanvasText};
        color: ${T.CanvasText};
      }
    `));ve=class extends q{constructor(){super(),this.noPaint=!1;let e={handleChange:this.noPaintChanged.bind(this)};fe.getNotifier(this).subscribe(e,"fillColor"),fe.getNotifier(this).subscribe(e,"baseLayerLuminance")}connectedCallback(){super.connectedCallback(),this.noPaintChanged()}noPaintChanged(){!this.noPaint&&(this.fillColor!==void 0||this.baseLayerLuminance)?this.$fastController.addStyles(c4):this.$fastController.removeStyles(c4)}};J([C({attribute:"no-paint",mode:"boolean"})],ve.prototype,"noPaint",void 0);J([C({attribute:"fill-color",converter:mw,mode:"fromView"}),Ce(Re)],ve.prototype,"fillColor",void 0);J([C({attribute:"accent-base-color",converter:mw,mode:"fromView"}),Ce(bh)],ve.prototype,"accentBaseColor",void 0);J([C({attribute:"neutral-base-color",converter:mw,mode:"fromView"}),Ce(yh)],ve.prototype,"neutralBaseColor",void 0);J([C({converter:ie}),Ce(Eo)],ve.prototype,"density",void 0);J([C({attribute:"design-unit",converter:ie}),Ce(G)],ve.prototype,"designUnit",void 0);J([C({attribute:"direction"}),Ce(ld)],ve.prototype,"direction",void 0);J([C({attribute:"base-height-multiplier",converter:ie}),Ce(Ba)],ve.prototype,"baseHeightMultiplier",void 0);J([C({attribute:"base-horizontal-spacing-multiplier",converter:ie}),Ce(GA)],ve.prototype,"baseHorizontalSpacingMultiplier",void 0);J([C({attribute:"control-corner-radius",converter:ie}),Ce(Oe)],ve.prototype,"controlCornerRadius",void 0);J([C({attribute:"layer-corner-radius",converter:ie}),Ce(Ho)],ve.prototype,"layerCornerRadius",void 0);J([C({attribute:"stroke-width",converter:ie}),Ce(ee)],ve.prototype,"strokeWidth",void 0);J([C({attribute:"focus-stroke-width",converter:ie}),Ce(rr)],ve.prototype,"focusStrokeWidth",void 0);J([C({attribute:"disabled-opacity",converter:ie}),Ce(zt)],ve.prototype,"disabledOpacity",void 0);J([C({attribute:"type-ramp-minus-2-font-size"}),Ce(uh)],ve.prototype,"typeRampMinus2FontSize",void 0);J([C({attribute:"type-ramp-minus-2-line-height"}),Ce(ig)],ve.prototype,"typeRampMinus2LineHeight",void 0);J([C({attribute:"type-ramp-minus-1-font-size"}),Ce(dh)],ve.prototype,"typeRampMinus1FontSize",void 0);J([C({attribute:"type-ramp-minus-1-line-height"}),Ce(cd)],ve.prototype,"typeRampMinus1LineHeight",void 0);J([C({attribute:"type-ramp-base-font-size"}),Ce(ch)],ve.prototype,"typeRampBaseFontSize",void 0);J([C({attribute:"type-ramp-base-line-height"}),Ce(og)],ve.prototype,"typeRampBaseLineHeight",void 0);J([C({attribute:"type-ramp-plus-1-font-size"}),Ce(hh)],ve.prototype,"typeRampPlus1FontSize",void 0);J([C({attribute:"type-ramp-plus-1-line-height"}),Ce(ng)],ve.prototype,"typeRampPlus1LineHeight",void 0);J([C({attribute:"type-ramp-plus-2-font-size"}),Ce(ph)],ve.prototype,"typeRampPlus2FontSize",void 0);J([C({attribute:"type-ramp-plus-2-line-height"}),Ce(sg)],ve.prototype,"typeRampPlus2LineHeight",void 0);J([C({attribute:"type-ramp-plus-3-font-size"}),Ce(fh)],ve.prototype,"typeRampPlus3FontSize",void 0);J([C({attribute:"type-ramp-plus-3-line-height"}),Ce(ag)],ve.prototype,"typeRampPlus3LineHeight",void 0);J([C({attribute:"type-ramp-plus-4-font-size"}),Ce(mh)],ve.prototype,"typeRampPlus4FontSize",void 0);J([C({attribute:"type-ramp-plus-4-line-height"}),Ce(lg)],ve.prototype,"typeRampPlus4LineHeight",void 0);J([C({attribute:"type-ramp-plus-5-font-size"}),Ce(gh)],ve.prototype,"typeRampPlus5FontSize",void 0);J([C({attribute:"type-ramp-plus-5-line-height"}),Ce(cg)],ve.prototype,"typeRampPlus5LineHeight",void 0);J([C({attribute:"type-ramp-plus-6-font-size"}),Ce(vh)],ve.prototype,"typeRampPlus6FontSize",void 0);J([C({attribute:"type-ramp-plus-6-line-height"}),Ce(dg)],ve.prototype,"typeRampPlus6LineHeight",void 0);J([C({attribute:"accent-fill-rest-delta",converter:ie}),Ce(Jm)],ve.prototype,"accentFillRestDelta",void 0);J([C({attribute:"accent-fill-hover-delta",converter:ie}),Ce(Xm)],ve.prototype,"accentFillHoverDelta",void 0);J([C({attribute:"accent-fill-active-delta",converter:ie}),Ce(eg)],ve.prototype,"accentFillActiveDelta",void 0);J([C({attribute:"accent-fill-focus-delta",converter:ie}),Ce(tg)],ve.prototype,"accentFillFocusDelta",void 0);J([C({attribute:"accent-foreground-rest-delta",converter:ie}),Ce(y1)],ve.prototype,"accentForegroundRestDelta",void 0);J([C({attribute:"accent-foreground-hover-delta",converter:ie}),Ce(b1)],ve.prototype,"accentForegroundHoverDelta",void 0);J([C({attribute:"accent-foreground-active-delta",converter:ie}),Ce(w1)],ve.prototype,"accentForegroundActiveDelta",void 0);J([C({attribute:"accent-foreground-focus-delta",converter:ie}),Ce(C1)],ve.prototype,"accentForegroundFocusDelta",void 0);J([C({attribute:"neutral-fill-rest-delta",converter:ie}),Ce(x1)],ve.prototype,"neutralFillRestDelta",void 0);J([C({attribute:"neutral-fill-hover-delta",converter:ie}),Ce(k1)],ve.prototype,"neutralFillHoverDelta",void 0);J([C({attribute:"neutral-fill-active-delta",converter:ie}),Ce(S1)],ve.prototype,"neutralFillActiveDelta",void 0);J([C({attribute:"neutral-fill-focus-delta",converter:ie}),Ce(_1)],ve.prototype,"neutralFillFocusDelta",void 0);J([C({attribute:"neutral-fill-input-rest-delta",converter:ie}),Ce(T1)],ve.prototype,"neutralFillInputRestDelta",void 0);J([C({attribute:"neutral-fill-input-hover-delta",converter:ie}),Ce(E1)],ve.prototype,"neutralFillInputHoverDelta",void 0);J([C({attribute:"neutral-fill-input-active-delta",converter:ie}),Ce(I1)],ve.prototype,"neutralFillInputActiveDelta",void 0);J([C({attribute:"neutral-fill-input-focus-delta",converter:ie}),Ce(A1)],ve.prototype,"neutralFillInputFocusDelta",void 0);J([C({attribute:"neutral-fill-layer-rest-delta",converter:ie}),Ce(Hs)],ve.prototype,"neutralFillLayerRestDelta",void 0);J([C({attribute:"neutral-fill-stealth-rest-delta",converter:ie}),Ce(R1)],ve.prototype,"neutralFillStealthRestDelta",void 0);J([C({attribute:"neutral-fill-stealth-hover-delta",converter:ie}),Ce(P1)],ve.prototype,"neutralFillStealthHoverDelta",void 0);J([C({attribute:"neutral-fill-stealth-active-delta",converter:ie}),Ce($1)],ve.prototype,"neutralFillStealthActiveDelta",void 0);J([C({attribute:"neutral-fill-stealth-focus-delta",converter:ie}),Ce(O1)],ve.prototype,"neutralFillStealthFocusDelta",void 0);J([C({attribute:"neutral-fill-strong-hover-delta",converter:ie}),Ce(M1)],ve.prototype,"neutralFillStrongHoverDelta",void 0);J([C({attribute:"neutral-fill-strong-active-delta",converter:ie}),Ce(F1)],ve.prototype,"neutralFillStrongActiveDelta",void 0);J([C({attribute:"neutral-fill-strong-focus-delta",converter:ie}),Ce(D1)],ve.prototype,"neutralFillStrongFocusDelta",void 0);J([C({attribute:"base-layer-luminance",converter:ie}),Ce(Gi)],ve.prototype,"baseLayerLuminance",void 0);J([C({attribute:"neutral-stroke-divider-rest-delta",converter:ie}),Ce(B1)],ve.prototype,"neutralStrokeDividerRestDelta",void 0);J([C({attribute:"neutral-stroke-rest-delta",converter:ie}),Ce(L1)],ve.prototype,"neutralStrokeRestDelta",void 0);J([C({attribute:"neutral-stroke-hover-delta",converter:ie}),Ce(N1)],ve.prototype,"neutralStrokeHoverDelta",void 0);J([C({attribute:"neutral-stroke-active-delta",converter:ie}),Ce(H1)],ve.prototype,"neutralStrokeActiveDelta",void 0);J([C({attribute:"neutral-stroke-focus-delta",converter:ie}),Ce(U1)],ve.prototype,"neutralStrokeFocusDelta",void 0);xM=ve.compose({baseName:"design-system-provider",template:O` <slot></slot> `,styles:M`
    ${de("block")}
  `})});var d4,u4=y(()=>{l();c();d();A();Dt();Ne();d4=(r,e)=>M`
  :host([hidden]) {
    display: none;
  }

  :host {
    --dialog-height: 480px;
    --dialog-width: 640px;
    display: block;
  }

  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    touch-action: none;
  }

  .positioning-region {
    display: flex;
    justify-content: center;
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    overflow: auto;
  }

  .control {
    box-shadow: ${IR};
    margin-top: auto;
    margin-bottom: auto;
    border-radius: calc(${Ho} * 1px);
    width: var(--dialog-width);
    height: var(--dialog-height);
    background: ${Re};
    z-index: 1;
    border: calc(${ee} * 1px) solid transparent;
  }
`});var vw,yw=y(()=>{l();c();d();W();u4();vw=jn.compose({baseName:"dialog",template:fE,styles:d4})});var h4,p4=y(()=>{l();c();d();A();W();Ne();h4=(r,e)=>M`
    ${de("block")} :host {
      box-sizing: content-box;
      height: 0;
      border: none;
      border-top: calc(${ee} * 1px) solid ${Xl};
    }

    :host([orientation="vertical"]) {
      border: none;
      height: 100%;
      margin: 0 calc(${G} * 1px);
      border-left: calc(${ee} * 1px) solid ${Xl};
  }
  `});var bw,ww=y(()=>{l();c();d();W();p4();bw=Ra.compose({baseName:"divider",template:EE,styles:h4})});var f4,m4=y(()=>{l();c();d();A();W();be();Dt();Ne();Jr();f4=(r,e)=>M`
    ${de("inline-flex")} :host {
      height: calc((${Ae} + ${G}) * 1px);
      justify-content: center;
      align-items: center;
      fill: currentcolor;
      color: ${Cg};
      background: padding-box linear-gradient(${Bo}, ${Bo}),
        border-box ${bd};
      box-sizing: border-box;
      border: calc(${ee} * 1px) solid transparent;
      border-radius: calc(${Oe} * 1px);
      padding: 0;
    }

    :host(.disabled) {
      opacity: ${zt};
      cursor: ${tr};
      pointer-events: none;
    }

    .next,
    .previous {
      display: flex;
    }

    :host(:not(.disabled):hover) {
      cursor: pointer;
    }

    :host(:not(.disabled):hover) {
      color: ${pR};
    }

    :host(:not(.disabled):active) {
      color: ${fR};
    }

    :host(:${ke}) {
      ${or}
    }

    :host::-moz-focus-inner {
      border: 0;
    }
  `.withBehaviors(me(M`
        :host {
          background: ${T.ButtonFace};
          border-color: ${T.ButtonText};
        }
        :host .next,
        :host .previous {
          color: ${T.ButtonText};
          fill: currentcolor;
        }
        :host(:not(.disabled):hover) {
          background: ${T.Highlight};
        }
        :host(:not(.disabled):hover) .next,
        :host(:not(.disabled):hover) .previous {
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled),
        :host(.disabled) .next,
        :host(.disabled) .previous {
          border-color: ${T.GrayText};
          color: ${T.GrayText};
          fill: currentcolor;
        }
        :host(:${ke}) {
          forced-color-adjust: none;
          outline-color: ${T.Highlight};
        }
      `))});var kM,Cw=y(()=>{l();c();d();W();m4();kM=zl.compose({baseName:"flipper",template:OE,styles:f4,next:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M7.57 11.84A1 1 0 016 11.02V4.98a1 1 0 011.57-.82l3.79 2.62c.85.59.85 1.85 0 2.44l-3.79 2.62z"/>
    </svg>
  `,previous:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M9.43 11.84a1 1 0 001.57-.82V4.98a1 1 0 00-1.57-.82L5.64 6.78c-.85.59-.85 1.85 0 2.44l3.79 2.62z"/>
    </svg>
  `})});var SM,_M,g4,v4,y4=y(()=>{l();c();d();A();W();Dt();SM=M`
  .scroll-prev {
    right: auto;
    left: 0;
  }

  .scroll.scroll-next::before,
  .scroll-next .scroll-action {
    left: auto;
    right: 0;
  }

  .scroll.scroll-next::before {
    background: linear-gradient(to right, transparent, var(--scroll-fade-next));
  }

  .scroll-next .scroll-action {
    transform: translate(50%, -50%);
  }
`,_M=M`
  .scroll.scroll-next {
    right: auto;
    left: 0;
  }

  .scroll.scroll-next::before {
    background: linear-gradient(to right, var(--scroll-fade-next), transparent);
    left: auto;
    right: 0;
  }

  .scroll.scroll-prev::before {
    background: linear-gradient(to right, transparent, var(--scroll-fade-previous));
  }

  .scroll-prev .scroll-action {
    left: auto;
    right: 0;
    transform: translate(50%, -50%);
  }
`,g4=M`
  .scroll-area {
    position: relative;
  }

  div.scroll-view {
    overflow-x: hidden;
  }

  .scroll {
    bottom: 0;
    pointer-events: none;
    position: absolute;
    right: 0;
    top: 0;
    user-select: none;
    width: 100px;
  }

  .scroll.disabled {
    display: none;
  }

  .scroll::before,
  .scroll-action {
    left: 0;
    position: absolute;
  }

  .scroll::before {
    background: linear-gradient(to right, var(--scroll-fade-previous), transparent);
    content: '';
    display: block;
    height: 100%;
    width: 100%;
  }

  .scroll-action {
    pointer-events: auto;
    right: auto;
    top: 50%;
    transform: translate(-50%, -50%);
  }

  ::slotted(fluent-flipper) {
    opacity: 0;
    transition: opacity 0.2s ease-in-out;
  }

  .scroll-area:hover ::slotted(fluent-flipper) {
    opacity: 1;
  }
`.withBehaviors(new oi(SM,_M)),v4=(r,e)=>M`
  ${de("block")} :host {
    --scroll-align: center;
    --scroll-item-spacing: 4px;
    contain: layout;
    position: relative;
  }

  .scroll-view {
    overflow-x: auto;
    scrollbar-width: none;
  }

  ::-webkit-scrollbar {
    display: none;
  }

  .content-container {
    align-items: var(--scroll-align);
    display: inline-flex;
    flex-wrap: nowrap;
    position: relative;
  }

  .content-container ::slotted(*) {
    margin-right: var(--scroll-item-spacing);
  }

  .content-container ::slotted(*:last-child) {
    margin-right: 0;
  }
`});var xw,TM,kw=y(()=>{l();c();d();A();W();y4();xw=class extends Li{connectedCallback(){super.connectedCallback(),this.view!=="mobile"&&this.$fastController.addStyles(g4)}},TM=xw.compose({baseName:"horizontal-scroll",baseClass:Li,template:$5,styles:v4,nextFlipper:O`
    <fluent-flipper @click="${r=>r.scrollToNext()}" aria-hidden="${r=>r.flippersHiddenFromAT}"></fluent-flipper>
  `,previousFlipper:O`
    <fluent-flipper
      @click="${r=>r.scrollToPrevious()}"
      direction="previous"
      aria-hidden="${r=>r.flippersHiddenFromAT}"
    ></fluent-flipper>
  `})});var b4,w4=y(()=>{l();c();d();A();W();Ne();Jr();b4=(r,e)=>M`
    ${de("inline-flex")} :host {
      border: calc(${ee} * 1px) solid ${za};
      border-radius: calc(${Oe} * 1px);
      box-sizing: border-box;
      flex-direction: column;
      padding: calc(${G} * 1px) 0;
    }

    ::slotted(${r.tagFor(ei)}) {
      margin: 0 calc(${G} * 1px);
    }

    :host(:focus-within:not([disabled])) {
      ${or}
    }
  `});var Sw,_w,Tw=y(()=>{l();c();d();W();w4();Sw=class extends hr{},_w=Sw.compose({baseName:"listbox",template:zE,styles:b4})});var C4,x4=y(()=>{l();c();d();A();W();be();ec();Ne();Yt();Jr();Z1();C4=(r,e)=>M`
    ${de("inline-flex")} :host {
      position: relative;
      ${Ge}
      background: ${Vs};
      border-radius: calc(${Oe} * 1px);
      border: calc(${ee} * 1px) solid transparent;
      box-sizing: border-box;
      color: ${De};
      cursor: pointer;
      fill: currentcolor;
      height: calc(${Ae} * 1px);
      overflow: hidden;
      align-items: center;
      padding: 0 calc(((${G} * 3) - ${ee} - 1) * 1px);
      user-select: none;
      white-space: nowrap;
    }

    :host::before {
      content: '';
      display: block;
      position: absolute;
      left: calc((${rr} - ${ee}) * 1px);
      top: calc((${Ae} / 4) - ${rr} * 1px);
      width: 3px;
      height: calc((${Ae} / 2) * 1px);
      background: transparent;
      border-radius: calc(${Oe} * 1px);
    }

    :host(:not([disabled]):hover) {
      background: ${Jn};
    }

    :host(:not([disabled]):active) {
      background: ${Xn};
    }

    :host(:not([disabled]):active)::before {
      background: ${Qe};
      height: calc(((${Ae} / 2) - 6) * 1px);
    }

    :host([aria-selected='true'])::before {
      background: ${Qe};
    }

    :host(:${ke}) {
      ${or}
      background: ${hR};
    }

    :host([aria-selected='true']) {
      background: ${ji};
    }

    :host(:not([disabled])[aria-selected='true']:hover) {
      background: ${vd};
    }

    :host(:not([disabled])[aria-selected='true']:active) {
      background: ${dR};
    }

    :host(:not([disabled]):not([aria-selected='true']):hover) {
      background: ${Jn};
    }

    :host(:not([disabled]):not([aria-selected='true']):active) {
      background: ${Xn};
    }

    :host([disabled]) {
      cursor: ${tr};
      opacity: ${zt};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([slot='end']) {
      margin-inline-start: 1ch;
    }

    ::slotted([slot='start']) {
      margin-inline-end: 1ch;
    }
  `.withBehaviors(new oi(null,M`
      :host::before {
        right: calc((${rr} - ${ee}) * 1px);
      }
    `),me(M`
        :host {
          background: ${T.ButtonFace};
          border-color: ${T.ButtonFace};
          color: ${T.ButtonText};
        }
        :host(:not([disabled]):not([aria-selected="true"]):hover),
        :host(:not([disabled])[aria-selected="true"]:hover),
        :host([aria-selected="true"]) {
          forced-color-adjust: none;
          background: ${T.Highlight};
          color: ${T.HighlightText};
        }
        :host(:not([disabled]):active)::before,
        :host([aria-selected='true'])::before {
          background: ${T.HighlightText};
        }
        :host([disabled]),
        :host([disabled]:not([aria-selected='true']):hover) {
          background: ${T.Canvas};
          color: ${T.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host(:${ke}) {
          outline-color: ${T.CanvasText};
        }
      `))});var nc,Ew=y(()=>{l();c();d();W();x4();nc=ei.compose({baseName:"option",template:HE,styles:C4})});var k4,S4=y(()=>{l();c();d();A();W();be();Dt();Ne();k4=(r,e)=>M`
    ${de("block")} :host {
      background: ${Yn};
      border: calc(${ee} * 1px) solid transparent;
      border-radius: calc(${Ho} * 1px);
      box-shadow: ${$g};
      padding: calc((${G} - ${ee}) * 1px) 0;
      max-width: 368px;
      min-width: 64px;
    }

    :host([slot='submenu']) {
      width: max-content;
      margin: 0 calc(${G} * 2px);
    }

    ::slotted(${r.tagFor(Wr)}) {
      margin: 0 calc(${G} * 1px);
    }

    ::slotted(${r.tagFor(Ra)}) {
      margin: calc(${G} * 1px) 0;
    }

    ::slotted(hr) {
      box-sizing: content-box;
      height: 0;
      margin: calc(${G} * 1px) 0;
      border: none;
      border-top: calc(${ee} * 1px) solid ${Xl};
    }
  `.withBehaviors(me(M`
        :host([slot='submenu']) {
          background: ${T.Canvas};
          border-color: ${T.CanvasText};
        }
      `))});var Iw,Th,Aw=y(()=>{l();c();d();W();Ne();S4();Iw=class extends jl{connectedCallback(){super.connectedCallback(),Re.setValueFor(this,Yn)}},Th=Iw.compose({baseName:"menu",baseClass:jl,template:r5,styles:k4})});var _4,T4=y(()=>{l();c();d();A();W();be();Dt();Ne();Yt();Jr();_4=(r,e)=>M`
    ${de("grid")} :host {
      contain: layout;
      overflow: visible;
      ${Ge}
      box-sizing: border-box;
      height: calc(${Ae} * 1px);
      grid-template-columns: minmax(32px, auto) 1fr minmax(32px, auto);
      grid-template-rows: auto;
      justify-items: center;
      align-items: center;
      padding: 0;
      white-space: nowrap;
      color: ${De};
      fill: currentcolor;
      cursor: pointer;
      border-radius: calc(${Oe} * 1px);
      border: calc(${ee} * 1px) solid transparent;
      position: relative;
    }

    :host(.indent-0) {
      grid-template-columns: auto 1fr minmax(32px, auto);
    }

    :host(.indent-0) .content {
      grid-column: 1;
      grid-row: 1;
      margin-inline-start: 10px;
    }

    :host(.indent-0) .expand-collapse-glyph-container {
      grid-column: 5;
      grid-row: 1;
    }

    :host(.indent-2) {
      grid-template-columns: minmax(32px, auto) minmax(32px, auto) 1fr minmax(32px, auto) minmax(32px, auto);
    }

    :host(.indent-2) .content {
      grid-column: 3;
      grid-row: 1;
      margin-inline-start: 10px;
    }

    :host(.indent-2) .expand-collapse-glyph-container {
      grid-column: 5;
      grid-row: 1;
    }

    :host(.indent-2) .start {
      grid-column: 2;
    }

    :host(.indent-2) .end {
      grid-column: 4;
    }

    :host(:${ke}) {
      ${or}
    }

    :host(:not([disabled]):hover) {
      background: ${Jn};
    }

    :host(:not([disabled]):active),
    :host(.expanded) {
      background: ${Xn};
      color: ${De};
      z-index: 2;
    }

    :host([disabled]) {
      cursor: ${tr};
      opacity: ${zt};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end {
      display: flex;
      justify-content: center;
    }

    :host(.indent-0[aria-haspopup='menu']) {
      display: grid;
      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);
      align-items: center;
      min-height: 32px;
    }

    :host(.indent-1[aria-haspopup='menu']),
    :host(.indent-1[role='menuitemcheckbox']),
    :host(.indent-1[role='menuitemradio']) {
      display: grid;
      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);
      align-items: center;
      min-height: 32px;
    }

    :host(.indent-2:not([aria-haspopup='menu'])) .end {
      grid-column: 5;
    }

    :host .input-container,
    :host .expand-collapse-glyph-container {
      display: none;
    }

    :host([aria-haspopup='menu']) .expand-collapse-glyph-container,
    :host([role='menuitemcheckbox']) .input-container,
    :host([role='menuitemradio']) .input-container {
      display: grid;
    }

    :host([aria-haspopup='menu']) .content,
    :host([role='menuitemcheckbox']) .content,
    :host([role='menuitemradio']) .content {
      grid-column-start: 3;
    }

    :host([aria-haspopup='menu'].indent-0) .content {
      grid-column-start: 1;
    }

    :host([aria-haspopup='menu']) .end,
    :host([role='menuitemcheckbox']) .end,
    :host([role='menuitemradio']) .end {
      grid-column-start: 4;
    }

    :host .expand-collapse,
    :host .checkbox,
    :host .radio {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      box-sizing: border-box;
    }

    :host .checkbox-indicator,
    :host .radio-indicator,
    slot[name='checkbox-indicator'],
    slot[name='radio-indicator'] {
      display: none;
    }

    ::slotted([slot='end']:not(svg)) {
      margin-inline-end: 10px;
      color: ${es};
    }

    :host([aria-checked='true']) .checkbox-indicator,
    :host([aria-checked='true']) slot[name='checkbox-indicator'],
    :host([aria-checked='true']) .radio-indicator,
    :host([aria-checked='true']) slot[name='radio-indicator'] {
      display: flex;
    }
  `.withBehaviors(me(M`
        :host,
        ::slotted([slot='end']:not(svg)) {
          forced-color-adjust: none;
          color: ${T.ButtonText};
          fill: currentcolor;
        }
        :host(:not([disabled]):hover) {
          background: ${T.Highlight};
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        :host(:hover) .start,
        :host(:hover) .end,
        :host(:hover)::slotted(svg),
        :host(:active) .start,
        :host(:active) .end,
        :host(:active)::slotted(svg),
        :host(:hover) ::slotted([slot='end']:not(svg)),
        :host(:${ke}) ::slotted([slot='end']:not(svg)) {
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        :host(.expanded) {
          background: ${T.Highlight};
          color: ${T.HighlightText};
        }
        :host(:${ke}) {
          background: ${T.Highlight};
          outline-color: ${T.ButtonText};
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        :host([disabled]),
        :host([disabled]:hover),
        :host([disabled]:hover) .start,
        :host([disabled]:hover) .end,
        :host([disabled]:hover)::slotted(svg),
        :host([disabled]:${ke}) {
          background: ${T.ButtonFace};
          color: ${T.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host([disabled]:${ke}) {
          outline-color: ${T.GrayText};
        }
        :host .expanded-toggle,
        :host .checkbox,
        :host .radio {
          border-color: ${T.ButtonText};
          background: ${T.HighlightText};
        }
        :host([checked]) .checkbox,
        :host([checked]) .radio {
          background: ${T.HighlightText};
          border-color: ${T.HighlightText};
        }
        :host(:hover) .expanded-toggle,
            :host(:hover) .checkbox,
            :host(:hover) .radio,
            :host(:${ke}) .expanded-toggle,
            :host(:${ke}) .checkbox,
            :host(:${ke}) .radio,
            :host([checked]:hover) .checkbox,
            :host([checked]:hover) .radio,
            :host([checked]:${ke}) .checkbox,
            :host([checked]:${ke}) .radio {
          border-color: ${T.HighlightText};
        }
        :host([aria-checked='true']) {
          background: ${T.Highlight};
          color: ${T.HighlightText};
        }
        :host([aria-checked='true']) .checkbox-indicator,
        :host([aria-checked='true']) ::slotted([slot='checkbox-indicator']),
        :host([aria-checked='true']) ::slotted([slot='radio-indicator']) {
          fill: ${T.Highlight};
        }
        :host([aria-checked='true']) .radio-indicator {
          background: ${T.Highlight};
        }
      `),new oi(M`
        .expand-collapse-glyph-container {
          transform: rotate(0deg);
        }
      `,M`
        .expand-collapse-glyph-container {
          transform: rotate(180deg);
        }
      `))});var Eh,Rw=y(()=>{l();c();d();W();T4();Eh=Wr.compose({baseName:"menu-item",template:e5,styles:_4,checkboxIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>
    </svg>
  `,expandCollapseGlyph:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M5.65 3.15a.5.5 0 000 .7L9.79 8l-4.14 4.15a.5.5 0 00.7.7l4.5-4.5a.5.5 0 000-.7l-4.5-4.5a.5.5 0 00-.7 0z"/>
    </svg>
  `,radioIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <circle cx="8" cy="8" r="2"/>
    </svg>
  `})});var Ih,E4,I4=y(()=>{l();c();d();A();W();Dt();Gs();Ne();Ih=".root",E4=(r,e)=>M`
    ${de("inline-block")}

    ${Va(r,e,Ih)}

    ${rs(r,e,Ih)}

    .root {
      display: flex;
      flex-direction: row;
    }

    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${G} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    .start,
    .end {
      margin: auto;
      fill: currentcolor;
    }

    .start {
      display: flex;
      margin-inline-start: 11px;
    }

    .end {
      display: flex;
      margin-inline-end: 11px;
    }

    .controls {
      opacity: 0;
      position: relative;
      top: -1px;
      z-index: 3;
    }

    :host(:hover:not([disabled])) .controls,
    :host(:focus-within:not([disabled])) .controls {
      opacity: 1;
    }

    .step-up,
    .step-down {
      display: flex;
      padding: 0 8px;
      cursor: pointer;
    }

    .step-up {
      padding-top: 3px;
    }
  `.withBehaviors(Ct("outline",os(r,e,Ih)),Ct("filled",Wi(r,e,Ih)),me(Qi(r,e,Ih)))});var qg,EM,Pw=y(()=>{l();c();d();bi();A();W();I4();qg=class extends Qr{connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};J([C],qg.prototype,"appearance",void 0);EM=qg.compose({baseName:"number-field",baseClass:Qr,styles:E4,template:s5,shadowOptions:{delegatesFocus:!0},stepDownGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `,stepUpGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 7.35c.2.2.5.2.7 0L6 4.21l3.15 3.14a.5.5 0 10.7-.7l-3.5-3.5a.5.5 0 00-.7 0l-3.5 3.5a.5.5 0 000 .7z"/>
    </svg>
`})});var A4,R4=y(()=>{l();c();d();A();be();W();Ne();A4=(r,e)=>M`
    ${de("flex")} :host {
      align-items: center;
      height: calc((${ee} * 3) * 1px);
    }

    .progress {
      background-color: ${Ki};
      border-radius: calc(${G} * 1px);
      width: 100%;
      height: calc(${ee} * 1px);
      display: flex;
      align-items: center;
      position: relative;
    }

    .determinate {
      background-color: ${Qe};
      border-radius: calc(${G} * 1px);
      height: calc((${ee} * 3) * 1px);
      transition: all 0.2s ease-in-out;
      display: flex;
    }

    .indeterminate {
      height: calc((${ee} * 3) * 1px);
      border-radius: calc(${G} * 1px);
      display: flex;
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .indeterminate-indicator-1 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${Qe};
      border-radius: calc(${G} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 40%;
      animation: indeterminate-1 2s infinite;
    }

    .indeterminate-indicator-2 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${Qe};
      border-radius: calc(${G} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 60%;
      animation: indeterminate-2 2s infinite;
    }

    :host(.paused) .indeterminate-indicator-1,
    :host(.paused) .indeterminate-indicator-2 {
      animation: none;
      background-color: ${es};
      width: 100%;
      opacity: 1;
    }

    :host(.paused) .determinate {
      background-color: ${es};
    }

    @keyframes indeterminate-1 {
      0% {
        opacity: 1;
        transform: translateX(-100%);
      }
      70% {
        opacity: 1;
        transform: translateX(300%);
      }
      70.01% {
        opacity: 0;
      }
      100% {
        opacity: 0;
        transform: translateX(300%);
      }
    }

    @keyframes indeterminate-2 {
      0% {
        opacity: 0;
        transform: translateX(-150%);
      }
      29.99% {
        opacity: 0;
      }
      30% {
        opacity: 1;
        transform: translateX(-150%);
      }
      100% {
        transform: translateX(166.66%);
        opacity: 1;
      }
    }
  `.withBehaviors(me(M`
        .indeterminate-indicator-1,
        .indeterminate-indicator-2,
        .determinate,
        .progress {
          background-color: ${T.ButtonText};
        }
        :host(.paused) .indeterminate-indicator-1,
        :host(.paused) .indeterminate-indicator-2,
        :host(.paused) .determinate {
          background-color: ${T.GrayText};
        }
      `))});var $w,Ow,P4=y(()=>{l();c();d();W();R4();$w=class extends yn{},Ow=$w.compose({baseName:"progress",template:b5,styles:A4,indeterminateIndicator1:`
    <span class="indeterminate-indicator-1" part="indeterminate-indicator-1"></span>
  `,indeterminateIndicator2:`
    <span class="indeterminate-indicator-2" part="indeterminate-indicator-2"></span>
  `})});var $4,O4=y(()=>{l();c();d();A();be();W();Dt();Ne();$4=(r,e)=>M`
    ${de("flex")} :host {
      align-items: center;
      height: calc(${Ae} * 1px);
      width: calc(${Ae} * 1px);
    }

    .progress {
      height: 100%;
      width: 100%;
    }

    .background {
      fill: none;
      stroke-width: 2px;
    }

    .determinate {
      stroke: ${Qe};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
    }

    .indeterminate-indicator-1 {
      stroke: ${Qe};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
      animation: spin-infinite 2s linear infinite;
    }

    :host(.paused) .indeterminate-indicator-1 {
      animation: none;
      stroke: ${es};
    }

    :host(.paused) .determinate {
      stroke: ${es};
    }

    @keyframes spin-infinite {
      0% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(0deg);
      }
      50% {
        stroke-dasharray: 21.99px 21.99px;
        transform: rotate(450deg);
      }
      100% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(1080deg);
      }
    }
  `.withBehaviors(me(M`
        .background {
          stroke: ${T.Field};
        }
        .determinate,
        .indeterminate-indicator-1 {
          stroke: ${T.ButtonText};
        }
        :host(.paused) .determinate,
        :host(.paused) .indeterminate-indicator-1 {
          stroke: ${T.GrayText};
        }
      `))});var Mw,Ah,M4=y(()=>{l();c();d();W();O4();Mw=class extends yn{},Ah=Mw.compose({baseName:"progress-ring",template:m5,styles:$4,indeterminateIndicator:`
    <svg class="progress" part="progress" viewBox="0 0 16 16">
        <circle
            class="background"
            part="background"
            cx="8px"
            cy="8px"
            r="7px"
        ></circle>
        <circle
            class="indeterminate-indicator-1"
            part="indeterminate-indicator-1"
            cx="8px"
            cy="8px"
            r="7px"
        ></circle>
    </svg>
  `})});var Fw=y(()=>{l();c();d();P4();M4()});var F4,D4=y(()=>{l();c();d();A();be();W();Dt();Ne();Yt();Jr();F4=(r,e)=>M`
    ${de("inline-flex")} :host {
      --input-size: calc((${Ae} / 2) + ${G});
      align-items: center;
      outline: none;
      ${""} user-select: none;
      position: relative;
      flex-direction: row;
      transition: all 0.2s ease-in-out;
    }

    .control {
      position: relative;
      width: calc(var(--input-size) * 1px);
      height: calc(var(--input-size) * 1px);
      box-sizing: border-box;
      border-radius: 50%;
      border: calc(${ee} * 1px) solid ${Ki};
      background: ${pd};
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      ${Ge}
      color: ${De};
      ${""} padding-inline-start: calc(${G} * 2px + 2px);
      margin-inline-end: calc(${G} * 2px + 2px);
      cursor: pointer;
    }

    .control,
    slot[name='checked-indicator'] {
      flex-shrink: 0;
    }

    slot[name='checked-indicator'] {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      fill: ${Uo};
      opacity: 0;
      pointer-events: none;
    }

    :host(:not(.disabled):hover) .control {
      background: ${fd};
      border-color: ${wd};
    }

    :host(:not(.disabled):active) .control {
      background: ${md};
      border-color: ${Cd};
    }

    :host(:not(.disabled):active) slot[name='checked-indicator'] {
      opacity: 1;
    }

    :host(:${ke}) .control {
      ${ts}
      background: ${gd};
    }

    :host(.checked) .control {
      background: ${Qe};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .control {
      background: ${Yr};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .control {
      background: ${Zr};
      border-color: transparent;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${tr};
    }

    :host(.checked) slot[name='checked-indicator'] {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${zt};
    }
  `.withBehaviors(me(M`
        .control {
          background: ${T.Field};
          border-color: ${T.FieldText};
        }
        :host(:not(.disabled):hover) .control,
        :host(:not(.disabled):active) .control {
          border-color: ${T.Highlight};
        }
        :host(:${ke}) .control {
          forced-color-adjust: none;
          background: ${T.Field};
          outline-color: ${T.FieldText};
        }
        :host(.checked:not(.disabled):hover) .control,
        :host(.checked:not(.disabled):active) .control {
          border-color: ${T.Highlight};
          background: ${T.Highlight};
        }
        :host(.checked) slot[name='checked-indicator'] {
          fill: ${T.Highlight};
        }
        :host(.checked:hover) .control slot[name='checked-indicator'] {
          fill: ${T.HighlightText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .label {
          color: ${T.GrayText};
        }
        :host(.disabled) .control,
        :host(.checked.disabled) .control {
          background: ${T.Field};
          border-color: ${T.GrayText};
        }
        :host(.disabled) slot[name='checked-indicator'],
        :host(.checked.disabled) slot[name='checked-indicator'] {
          fill: ${T.GrayText};
        }
      `))});var IM,Dw=y(()=>{l();c();d();W();D4();IM=Kl.compose({baseName:"radio",template:T5,styles:F4,checkedIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <circle cx="8" cy="8" r="4"/>
    </svg>
  `})});var L4,N4=y(()=>{l();c();d();A();W();L4=(r,e)=>M`
  ${de("flex")} :host {
    align-items: flex-start;
    flex-direction: column;
  }

  .positioning-region {
    display: flex;
    flex-wrap: wrap;
  }

  :host([orientation='vertical']) .positioning-region {
    flex-direction: column;
  }

  :host([orientation='horizontal']) .positioning-region {
    flex-direction: row;
  }
`});var Lw,Nw=y(()=>{l();c();d();W();N4();Lw=bn.compose({baseName:"radio-group",template:x5,styles:L4})});var H4,Hw=y(()=>{l();c();d();A();W();H4=(r,e)=>O`
  <template
    class="
            ${t=>t.readOnly?"readonly":""}
        "
  >
    <label
      part="label"
      for="control"
      class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
    >
      <slot ${Le({property:"defaultSlottedNodes",filter:Xu})}></slot>
    </label>
    <div class="root" part="root" ${Ie("root")}>
      ${kt(r,e)}
      <div class="input-wrapper" part="input-wrapper">
        <input
          class="control"
          part="control"
          id="control"
          @input="${t=>t.handleTextInput()}"
          @change="${t=>t.handleChange()}"
          ?autofocus="${t=>t.autofocus}"
          ?disabled="${t=>t.disabled}"
          list="${t=>t.list}"
          maxlength="${t=>t.maxlength}"
          minlength="${t=>t.minlength}"
          pattern="${t=>t.pattern}"
          placeholder="${t=>t.placeholder}"
          ?readonly="${t=>t.readOnly}"
          ?required="${t=>t.required}"
          size="${t=>t.size}"
          ?spellcheck="${t=>t.spellcheck}"
          :value="${t=>t.value}"
          type="search"
          aria-atomic="${t=>t.ariaAtomic}"
          aria-busy="${t=>t.ariaBusy}"
          aria-controls="${t=>t.ariaControls}"
          aria-current="${t=>t.ariaCurrent}"
          aria-describedby="${t=>t.ariaDescribedby}"
          aria-details="${t=>t.ariaDetails}"
          aria-disabled="${t=>t.ariaDisabled}"
          aria-errormessage="${t=>t.ariaErrormessage}"
          aria-flowto="${t=>t.ariaFlowto}"
          aria-haspopup="${t=>t.ariaHaspopup}"
          aria-hidden="${t=>t.ariaHidden}"
          aria-invalid="${t=>t.ariaInvalid}"
          aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
          aria-label="${t=>t.ariaLabel}"
          aria-labelledby="${t=>t.ariaLabelledby}"
          aria-live="${t=>t.ariaLive}"
          aria-owns="${t=>t.ariaOwns}"
          aria-relevant="${t=>t.ariaRelevant}"
          aria-roledescription="${t=>t.ariaRoledescription}"
          ${Ie("control")}
        />
        <slot name="clear-button">
          <button
            class="clear-button ${t=>t.value?"":"clear-button__hidden"}"
            part="clear-button"
            tabindex="-1"
            @click=${t=>t.handleClearInput()}
          >
            <slot name="clear-glyph">
              <svg width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="m2.09 2.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L6 5.29l3.15-3.14a.5.5 0 1 1 .7.7L6.71 6l3.14 3.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L6 6.71 2.85 9.85a.5.5 0 0 1-.7-.7L5.29 6 2.15 2.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"
                />
              </svg>
            </slot>
          </button>
        </slot>
      </div>
      ${xt(r,e)}
    </div>
  </template>
`});var Rh,AM,RM,U4,B4=y(()=>{l();c();d();A();W();Dt();Gs();Ne();Yt();Rh=".root",AM=et.create("clear-button-hover").withDefault(r=>{let e=ri.getValueFor(r),t=Zn.getValueFor(r);return e.evaluate(r,t.evaluate(r).focus).hover}),RM=et.create("clear-button-active").withDefault(r=>{let e=ri.getValueFor(r),t=Zn.getValueFor(r);return e.evaluate(r,t.evaluate(r).focus).active}),U4=(r,e)=>M`
    ${de("inline-block")}

    ${Va(r,e,Rh)}

    ${rs(r,e,Rh)}

    .root {
      display: flex;
      flex-direction: row;
    }
    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${G} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }
    .clear-button {
      display: inline-flex;
      align-items: center;
      margin: 1px;
      height: calc(100% - 2px);
      opacity: 0;
      background: transparent;
      color: ${De};
      fill: currentcolor;
      border: none;
      border-radius: calc(${Oe} * 1px);
      min-width: calc(${Ae} * 1px);
      ${Ge}
      outline: none;
      padding: 0 calc((10 + (${G} * 2 * ${Eo})) * 1px);
    }
    .clear-button:hover {
      background: ${AM};
    }
    .clear-button:active {
      background: ${RM};
    }
    :host(:hover:not([disabled], [readOnly])) .clear-button,
    :host(:active:not([disabled], [readOnly])) .clear-button,
    :host(:focus-within:not([disabled], [readOnly])) .clear-button {
        opacity: 1;
    }
    :host(:hover:not([disabled], [readOnly])) .clear-button__hidden,
    :host(:active:not([disabled], [readOnly])) .clear-button__hidden,
    :host(:focus-within:not([disabled], [readOnly])) .clear-button__hidden {
        opacity: 0;
    }
    .control::-webkit-search-cancel-button {
      -webkit-appearance: none;
    }
    .input-wrapper {
      display: flex;
      position: relative;
      width: 100%;
    }
    .start,
    .end {
      display: flex;
      margin: 1px;
      align-items: center;
    }
    .start {
      display: flex;
      margin-inline-start: 11px;
    }
    ::slotted([slot="end"]) {
      height: 100%
    }
    .clear-button__hidden {
      opacity: 0;
    }
    .end {
        margin-inline-end: 11px;
    }
    ::slotted(${r.tagFor(po)}) {
      margin-inline-end: 1px;
    }
  `.withBehaviors(Ct("outline",os(r,e,Rh)),Ct("filled",Wi(r,e,Rh)),me(Qi(r,e,Rh)))});var Gg,Uw,Bw=y(()=>{l();c();d();bi();A();W();Hw();B4();Hw();Gg=class extends _o{constructor(){super(...arguments),this.appearance="outline"}};J([C],Gg.prototype,"appearance",void 0);Uw=Gg.compose({baseName:"search",baseClass:_o,template:H4,styles:U4,start:'<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg%22%3E"><path d="M8.5 3a5.5 5.5 0 0 1 4.23 9.02l4.12 4.13a.5.5 0 0 1-.63.76l-.07-.06-4.13-4.12A5.5 5.5 0 1 1 8.5 3Zm0 1a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9Z"/></svg>',shadowOptions:{delegatesFocus:!0}})});var jg,zw,Vw=y(()=>{l();c();d();bi();A();W();Ne();uw();jg=class extends Ni{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&Re.setValueFor(this.listbox,Yn)}};J([C({mode:"fromView"})],jg.prototype,"appearance",void 0);zw=jg.compose({baseName:"select",baseClass:Ni,template:B5,styles:e4,indicator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `})});var z4,V4=y(()=>{l();c();d();A();W();be();Ne();z4=(r,e)=>M`
    ${de("block")} :host {
      --skeleton-fill-default: ${ji};
      overflow: hidden;
      width: 100%;
      position: relative;
      background-color: var(--skeleton-fill, var(--skeleton-fill-default));
      --skeleton-animation-gradient-default: linear-gradient(
        270deg,
        var(--skeleton-fill, var(--skeleton-fill-default)) 0%,
        ${vd} 51%,
        var(--skeleton-fill, var(--skeleton-fill-default)) 100%
      );
      --skeleton-animation-timing-default: ease-in-out;
    }

    :host(.rect) {
      border-radius: calc(${Oe} * 1px);
    }

    :host(.circle) {
      border-radius: 100%;
      overflow: hidden;
    }

    object {
      position: absolute;
      width: 100%;
      height: auto;
      z-index: 2;
    }

    object img {
      width: 100%;
      height: auto;
    }

    ${de("block")} span.shimmer {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: var(--skeleton-animation-gradient, var(--skeleton-animation-gradient-default));
      background-size: 0px 0px / 90% 100%;
      background-repeat: no-repeat;
      background-color: var(--skeleton-animation-fill, ${ji});
      animation: shimmer 2s infinite;
      animation-timing-function: var(--skeleton-animation-timing, var(--skeleton-timing-default));
      animation-direction: normal;
      z-index: 1;
    }

    ::slotted(svg) {
      z-index: 2;
    }

    ::slotted(.pattern) {
      width: 100%;
      height: 100%;
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%);
      }
      100% {
        transform: translateX(100%);
      }
    }
  `.withBehaviors(me(M`
        :host{
          background-color: ${T.CanvasText};
        }
      `))});var Ph,qw=y(()=>{l();c();d();W();V4();Ph=$a.compose({baseName:"skeleton",template:q5,styles:z4})});var q4,G4=y(()=>{l();c();d();A();be();W();Dt();Ne();q4=(r,e)=>M`
    ${de("inline-grid")} :host {
      --thumb-size: calc((${Ae} / 2) + ${G} + (${ee} * 2));
      --thumb-translate: calc(var(--thumb-size) * -0.5 + var(--track-width) / 2);
      --track-overhang: calc((${G} / 2) * -1);
      --track-width: ${G};
      align-items: center;
      width: 100%;
      user-select: none;
      box-sizing: border-box;
      border-radius: calc(${Oe} * 1px);
      outline: none;
      cursor: pointer;
    }
    :host(.horizontal) .positioning-region {
      position: relative;
      margin: 0 8px;
      display: grid;
      grid-template-rows: calc(var(--thumb-size) * 1px) 1fr;
    }
    :host(.vertical) .positioning-region {
      position: relative;
      margin: 0 8px;
      display: grid;
      height: 100%;
      grid-template-columns: calc(var(--thumb-size) * 1px) 1fr;
    }
    :host(:${ke}) .thumb-cursor {
      box-shadow: 0 0 0 2px ${Re}, 0 0 0 4px ${xd};
    }
    .thumb-container {
      position: absolute;
      height: calc(var(--thumb-size) * 1px);
      width: calc(var(--thumb-size) * 1px);
      transition: all 0.2s ease;
    }
    .thumb-cursor {
      display: flex;
      position: relative;
      border: none;
      width: calc(var(--thumb-size) * 1px);
      height: calc(var(--thumb-size) * 1px);
      background: padding-box linear-gradient(${Bo}, ${Bo}),
        border-box ${bd};
      border: calc(${ee} * 1px) solid transparent;
      border-radius: 50%;
      box-sizing: border-box;
    }
    .thumb-cursor::after {
      content: '';
      display: block;
      border-radius: 50%;
      width: 100%;
      margin: 4px;
      background: ${Qe};
    }
    :host(:not(.disabled)) .thumb-cursor:hover::after {
      background: ${Yr};
      margin: 3px;
    }
    :host(:not(.disabled)) .thumb-cursor:active::after {
      background: ${Zr};
      margin: 5px;
    }
    :host(:not(.disabled)) .thumb-cursor:hover {
      background: padding-box linear-gradient(${Bo}, ${Bo}),
        border-box ${_g};
    }
    :host(:not(.disabled)) .thumb-cursor:active {
      background: padding-box linear-gradient(${Bo}, ${Bo}),
        border-box ${Tg};
    }
    .track-start {
      background: ${Qe};
      position: absolute;
      height: 100%;
      left: 0;
      border-radius: calc(${Oe} * 1px);
    }
    :host(.horizontal) .thumb-container {
      transform: translateX(calc(var(--thumb-size) * 0.5px)) translateY(calc(var(--thumb-translate) * 1px));
    }
    :host(.vertical) .thumb-container {
      transform: translateX(calc(var(--thumb-translate) * 1px)) translateY(calc(var(--thumb-size) * 0.5px));
    }
    :host(.horizontal) {
      min-width: calc(var(--thumb-size) * 1px);
    }
    :host(.horizontal) .track {
      right: calc(var(--track-overhang) * 1px);
      left: calc(var(--track-overhang) * 1px);
      align-self: start;
      height: calc(var(--track-width) * 1px);
    }
    :host(.vertical) .track {
      top: calc(var(--track-overhang) * 1px);
      bottom: calc(var(--track-overhang) * 1px);
      width: calc(var(--track-width) * 1px);
      height: 100%;
    }
    .track {
      background: ${Cg};
      border: 1px solid ${Ki};
      border-radius: 2px;
      box-sizing: border-box;
      position: absolute;
    }
    :host(.vertical) {
      height: 100%;
      min-height: calc(${G} * 60px);
      min-width: calc(${G} * 20px);
    }
    :host(.vertical) .track-start {
      height: auto;
      width: 100%;
      top: 0;
    }
    :host(.disabled),
    :host(.readonly) {
      cursor: ${tr};
    }
    :host(.disabled) {
      opacity: ${zt};
    }
  `.withBehaviors(me(M`
        .thumb-cursor {
          forced-color-adjust: none;
          border-color: ${T.FieldText};
          background: ${T.FieldText};
        }
        :host(:not(.disabled)) .thumb-cursor:hover,
        :host(:not(.disabled)) .thumb-cursor:active {
          background: ${T.Highlight};
        }
        .track {
          forced-color-adjust: none;
          background: ${T.FieldText};
        }
        .thumb-cursor::after,
        :host(:not(.disabled)) .thumb-cursor:hover::after,
        :host(:not(.disabled)) .thumb-cursor:active::after {
          background: ${T.Field};
        }
        :host(:${ke}) .thumb-cursor {
          background: ${T.Highlight};
          border-color: ${T.Highlight};
          box-shadow: 0 0 0 1px ${T.Field}, 0 0 0 3px ${T.FieldText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .track,
        :host(.disabled) .thumb-cursor {
          forced-color-adjust: none;
          background: ${T.GrayText};
        }
      `))});var PM,Gw=y(()=>{l();c();d();W();G4();PM=Mr.compose({baseName:"slider",template:J5,styles:q4,thumb:`
    <div class="thumb-cursor"></div>
  `})});var j4,K4=y(()=>{l();c();d();A();be();W();Ne();Yt();j4=(r,e)=>M`
    ${de("block")} :host {
      ${Pg}
    }
    .root {
      position: absolute;
      display: grid;
    }
    :host(.horizontal) {
      align-self: start;
      grid-row: 2;
      margin-top: -4px;
    }
    :host(.vertical) {
      justify-self: start;
      grid-column: 2;
      margin-left: 2px;
    }
    .container {
      display: grid;
      justify-self: center;
    }
    :host(.horizontal) .container {
      grid-template-rows: auto auto;
      grid-template-columns: 0;
    }
    :host(.vertical) .container {
      grid-template-columns: auto auto;
      grid-template-rows: 0;
      min-width: calc(var(--thumb-size) * 1px);
      height: calc(var(--thumb-size) * 1px);
    }
    .label {
      justify-self: center;
      align-self: center;
      white-space: nowrap;
      max-width: 30px;
      margin: 2px 0;
    }
    .mark {
      width: calc(${ee} * 1px);
      height: calc(${G} * 1px);
      background: ${Ki};
      justify-self: center;
    }
    :host(.vertical) .mark {
      transform: rotate(90deg);
      align-self: center;
    }
    :host(.vertical) .label {
      margin-left: calc((${G} / 2) * 2px);
      align-self: center;
    }
    :host(.disabled) {
      opacity: ${zt};
    }
  `.withBehaviors(me(M`
        .mark {
          forced-color-adjust: none;
          background: ${T.FieldText};
        }
        :host(.disabled) {
          forced-color-adjust: none;
          opacity: 1;
        }
        :host(.disabled) .label {
          color: ${T.GrayText};
        }
        :host(.disabled) .mark {
          background: ${T.GrayText};
        }
      `))});var $M,jw=y(()=>{l();c();d();W();K4();$M=Hi.compose({baseName:"slider-label",template:W5,styles:j4})});var W4,Q4=y(()=>{l();c();d();A();be();W();Dt();Ne();Yt();Jr();W4=(r,e)=>M`
    :host([hidden]) {
      display: none;
    }

    ${de("inline-flex")} :host {
      align-items: center;
      outline: none;
      font-family: ${Io};
      ${""} user-select: none;
    }

    :host(.disabled) {
      opacity: ${zt};
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.disabled) .switch,
    :host(.readonly) .switch,
    :host(.disabled) .status-message,
    :host(.readonly) .status-message {
      cursor: ${tr};
    }

    .switch {
      position: relative;
      box-sizing: border-box;
      width: calc(((${Ae} / 2) + ${G}) * 2px);
      height: calc(((${Ae} / 2) + ${G}) * 1px);
      background: ${pd};
      border-radius: calc(${Ae} * 1px);
      border: calc(${ee} * 1px) solid ${Ki};
      cursor: pointer;
    }

    :host(:not(.disabled):hover) .switch {
      background: ${fd};
      border-color: ${wd};
    }

    :host(:not(.disabled):active) .switch {
      background: ${md};
      border-color: ${Cd};
    }

    :host(:${ke}) .switch {
      ${ts}
      background: ${gd};
    }

    :host(.checked) .switch {
      background: ${Qe};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .switch {
      background: ${Yr};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .switch {
      background: ${Zr};
      border-color: transparent;
    }

    slot[name='switch'] {
      position: absolute;
      display: flex;
      border: 1px solid transparent; /* Spacing included in the transform reference box */
      fill: ${De};
      transition: all 0.2s ease-in-out;
    }

    .status-message {
      color: ${De};
      cursor: pointer;
      ${Ge}
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      color: ${De};
      ${Ge}
      margin-inline-end: calc(${G} * 2px + 2px);
      cursor: pointer;
    }

    ::slotted([slot="checked-message"]),
    ::slotted([slot="unchecked-message"]) {
        margin-inline-start: calc(${G} * 2px + 2px);
    }

    :host(.checked) .switch {
      background: ${Qe};
    }

    :host(.checked) .switch slot[name='switch'] {
      fill: ${Uo};
      filter: drop-shadow(0px 1px 1px rgba(0, 0, 0, 0.15));
    }

    :host(.checked:not(.disabled)) .switch:hover {
      background: ${Yr};
    }

    :host(.checked:not(.disabled)) .switch:hover slot[name='switch'] {
      fill: ${ud};
    }

    :host(.checked:not(.disabled)) .switch:active {
      background: ${Zr};
    }

    :host(.checked:not(.disabled)) .switch:active slot[name='switch'] {
      fill: ${hd};
    }

    .unchecked-message {
      display: block;
    }

    .checked-message {
      display: none;
    }

    :host(.checked) .unchecked-message {
      display: none;
    }

    :host(.checked) .checked-message {
      display: block;
    }
  `.withBehaviors(new oi(M`
        slot[name='switch'] {
          left: 0;
        }

        :host(.checked) slot[name='switch'] {
          left: 100%;
          transform: translateX(-100%);
        }
      `,M`
        slot[name='switch'] {
          right: 0;
        }

        :host(.checked) slot[name='switch'] {
          right: 100%;
          transform: translateX(100%);
        }
      `),me(M`
        :host(:not(.disabled)) .switch slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${T.FieldText};
        }
        .switch {
          background: ${T.Field};
          border-color: ${T.FieldText};
        }
        :host(.checked) .switch {
          background: ${T.Highlight};
          border-color: ${T.Highlight};
        }
        :host(:not(.disabled):hover) .switch ,
        :host(:not(.disabled):active) .switch,
        :host(.checked:not(.disabled):hover) .switch {
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
        }
        :host(.checked:not(.disabled)) .switch slot[name="switch"] {
          fill: ${T.HighlightText};
        }
        :host(.checked:not(.disabled):hover) .switch slot[name='switch'] {
          fill: ${T.Highlight};
        }
        :host(:${ke}) .switch {
          forced-color-adjust: none;
          background: ${T.Field}; 
          border-color: ${T.Highlight};
          outline-color: ${T.FieldText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${T.GrayText};
        }
        :host(.disabled) .switch {
          background: ${T.Field};
          border-color: ${T.GrayText};
        }
        .status-message,
        .label {
          color: ${T.FieldText};
        }
      `))});var Kw,Ww=y(()=>{l();c();d();W();Q4();Kw=Jc.compose({baseName:"switch",template:oI,styles:W4,switch:`
    <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="12" height="12" rx="6"/>
    </svg>
  `})});var Y4,Z4=y(()=>{l();c();d();A();be();W();Ne();Dt();Yt();Y4=(r,e)=>M`
      ${de("grid")} :host {
        box-sizing: border-box;
        ${Ge}
        color: ${De};
        grid-template-columns: auto 1fr auto;
        grid-template-rows: auto 1fr;
      }

      .tablist {
        display: grid;
        grid-template-rows: calc(${Ae} * 1px); auto;
        grid-template-columns: auto;
        position: relative;
        width: max-content;
        align-self: end;
      }

      .start,
      .end {
        align-self: center;
      }

      .activeIndicator {
        grid-row: 2;
        grid-column: 1;
        width: 20px;
        height: 3px;
        border-radius: calc(${Oe} * 1px);
        justify-self: center;
        background: ${Qe};
      }

      .activeIndicatorTransition {
        transition: transform 0.2s ease-in-out;
      }

      .tabpanel {
        grid-row: 2;
        grid-column-start: 1;
        grid-column-end: 4;
        position: relative;
      }

      :host(.vertical) {
        grid-template-rows: auto 1fr auto;
        grid-template-columns: auto 1fr;
      }

      :host(.vertical) .tablist {
        grid-row-start: 2;
        grid-row-end: 2;
        display: grid;
        grid-template-rows: auto;
        grid-template-columns: auto 1fr;
        position: relative;
        width: max-content;
        justify-self: end;
        align-self: flex-start;
        width: 100%;
      }

      :host(.vertical) .tabpanel {
        grid-column: 2;
        grid-row-start: 1;
        grid-row-end: 4;
      }

      :host(.vertical) .end {
        grid-row: 3;
      }

      :host(.vertical) .activeIndicator {
        grid-column: 1;
        grid-row: 1;
        width: 3px;
        height: 20px;
        margin-inline-start: calc(${rr} * 1px);
        border-radius: calc(${Oe} * 1px);
        align-self: center;
        background: ${Qe};
      }

      :host(.vertical) .activeIndicatorTransition {
        transition: transform 0.2s linear;
      }
    `.withBehaviors(me(M`
        .activeIndicator,
        :host(.vertical) .activeIndicator {
          background: ${T.Highlight};
        }
      `))});var J4,X4=y(()=>{l();c();d();A();be();W();Dt();Ne();Yt();Jr();J4=(r,e)=>M`
      ${de("inline-flex")} :host {
        box-sizing: border-box;
        ${Ge}
        height: calc((${Ae} + (${G} * 2)) * 1px);
        padding: 0 calc((6 + (${G} * 2 * ${Eo})) * 1px);
        color: ${De};
        border-radius: calc(${Oe} * 1px);
        border: calc(${ee} * 1px) solid transparent;
        align-items: center;
        justify-content: center;
        grid-row: 1 / 3;
        cursor: pointer;
      }

      :host([aria-selected='true']) {
        z-index: 2;
      }

      :host(:hover),
      :host(:active) {
        color: ${De};
      }

      :host(:${ke}) {
        ${or}
      }

      :host(.vertical) {
        justify-content: start;
        grid-column: 1 / 3;
      }

      :host(.vertical[aria-selected='true']) {
        z-index: 2;
      }

      :host(.vertical:hover),
      :host(.vertical:active) {
        color: ${De};
      }

      :host(.vertical:hover[aria-selected='true']) {
      }
    `.withBehaviors(me(M`
          :host {
            forced-color-adjust: none;
            border-color: transparent;
            color: ${T.ButtonText};
            fill: currentcolor;
          }
          :host(:hover),
          :host(.vertical:hover),
          :host([aria-selected='true']:hover) {
            background: transparent;
            color: ${T.Highlight};
            fill: currentcolor;
          }
          :host([aria-selected='true']) {
            background: transparent;
            color: ${T.Highlight};
            fill: currentcolor;
          }
          :host(:${ke}) {
            background: transparent;
            outline-color: ${T.ButtonText};
          }
        `))});var Qw,e3=y(()=>{l();c();d();W();X4();Qw=rh.compose({baseName:"tab",template:hI,styles:J4})});var t3,r3=y(()=>{l();c();d();A();W();Ne();Yt();t3=(r,e)=>M`
  ${de("block")} :host {
    box-sizing: border-box;
    ${Ge}
    padding: 0 calc((6 + (${G} * 2 * ${Eo})) * 1px);
  }
`});var Yw,o3=y(()=>{l();c();d();W();r3();Yw=Am.compose({baseName:"tab-panel",template:lI,styles:t3})});var Zw,Jw=y(()=>{l();c();d();W();Z4();e3();o3();Zw=Ui.compose({baseName:"tabs",template:gI,styles:Y4})});var $h,i3,n3=y(()=>{l();c();d();A();W();Dt();Gs();Ne();$h=".control",i3=(r,e)=>M`
    ${de("inline-flex")}

    ${Va(r,e,$h)}

    ${rs(r,e,$h)}

    :host {
      flex-direction: column;
      vertical-align: bottom;
    }

    .control {
      height: calc((${Ae} * 2) * 1px);
      padding: calc(${G} * 1.5px) calc(${G} * 2px + 1px);
    }

    :host .control {
      resize: none;
    }

    :host(.resize-both) .control {
      resize: both;
    }

    :host(.resize-horizontal) .control {
      resize: horizontal;
    }

    :host(.resize-vertical) .control {
      resize: vertical;
    }

    :host([cols]) {
      width: initial;
    }

    :host([rows]) .control {
      height: initial;
    }
  `.withBehaviors(Ct("outline",os(r,e,$h)),Ct("filled",Wi(r,e,$h)),me(Qi(r,e,$h)))});var Kg,OM,Xw=y(()=>{l();c();d();bi();A();W();n3();Kg=class extends Fr{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};J([C],Kg.prototype,"appearance",void 0);OM=Kg.compose({baseName:"text-area",baseClass:Fr,template:kI,styles:i3,shadowOptions:{delegatesFocus:!0}})});var Oh,s3,a3=y(()=>{l();c();d();A();W();Dt();Gs();Ne();Oh=".root",s3=(r,e)=>M`
    ${de("inline-block")}

    ${Va(r,e,Oh)}

    ${rs(r,e,Oh)}

    .root {
      display: flex;
      flex-direction: row;
    }

    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${G} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    .start,
    .end {
      display: flex;
      margin: auto;
    }

    .start {
      display: flex;
      margin-inline-start: 11px;
    }

    .end {
      display: flex;
      margin-inline-end: 11px;
    }
  `.withBehaviors(Ct("outline",os(r,e,Oh)),Ct("filled",Wi(r,e,Oh)),me(Qi(r,e,Oh)))});var Wg,xn,eC=y(()=>{l();c();d();bi();A();W();a3();Wg=class extends fo{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};J([C],Wg.prototype,"appearance",void 0);xn=Wg.compose({baseName:"text-field",baseClass:fo,template:TI,styles:s3,shadowOptions:{delegatesFocus:!0}})});var l3,c3=y(()=>{l();c();d();A();W();be();Ne();Jr();l3=(r,e)=>M`
    ${de("inline-flex")} :host {
      --toolbar-item-gap: calc(${G} * 1px);
      background: ${Re};
      fill: currentcolor;
      padding: var(--toolbar-item-gap);
      box-sizing: border-box;
      align-items: center;
    }

    :host(${ke}) {
      ${or}
    }

    .positioning-region {
      align-items: center;
      display: inline-flex;
      flex-flow: row wrap;
      justify-content: flex-start;
      flex-grow: 1;
    }

    :host([orientation='vertical']) .positioning-region {
      flex-direction: column;
      align-items: start;
    }

    ::slotted(:not([slot])) {
      flex: 0 0 auto;
      margin: 0 var(--toolbar-item-gap);
    }

    :host([orientation='vertical']) ::slotted(:not([slot])) {
      margin: var(--toolbar-item-gap) 0;
    }

    :host([orientation='vertical']) {
      display: inline-flex;
      flex-direction: column;
    }

    .start,
    .end {
      display: flex;
      align-items: center;
    }

    .end {
      margin-inline-start: auto;
    }

    .start__hidden,
    .end__hidden {
      display: none;
    }

    ::slotted(svg) {
      ${""}
      width: 16px;
      height: 16px;
    }
  `.withBehaviors(me(M`
        :host(:${ke}) {
          outline-color: ${T.Highlight};
          color: ${T.ButtonText};
          forced-color-adjust: none;
        }
      `))});var tC,MM,rC=y(()=>{l();c();d();W();c3();tC=class extends wn{},MM=tC.compose({baseName:"toolbar",baseClass:wn,template:AI,styles:l3})});var d3,u3=y(()=>{l();c();d();A();W();Dt();Ne();Yt();d3=(r,e)=>M`
    :host {
      position: relative;
      contain: layout;
      overflow: visible;
      height: 0;
      width: 0;
      z-index: 10000;
    }

    .tooltip {
      box-sizing: border-box;
      border-radius: calc(${Oe} * 1px);
      border: calc(${ee} * 1px) solid ${qs};
      background: ${Re};
      color: ${De};
      padding: 4px 12px;
      height: fit-content;
      width: fit-content;
      ${Ge}
      white-space: nowrap;
      box-shadow: ${ER};
    }

    ${r.tagFor(Fe)} {
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: visible;
      flex-direction: row;
    }

    ${r.tagFor(Fe)}.right,
    ${r.tagFor(Fe)}.left {
      flex-direction: column;
    }

    ${r.tagFor(Fe)}.top .tooltip::after,
    ${r.tagFor(Fe)}.bottom .tooltip::after,
    ${r.tagFor(Fe)}.left .tooltip::after,
    ${r.tagFor(Fe)}.right .tooltip::after {
      content: '';
      width: 12px;
      height: 12px;
      background: ${Re};
      border-top: calc(${ee} * 1px) solid ${qs};
      border-left: calc(${ee} * 1px) solid ${qs};
      position: absolute;
    }

    ${r.tagFor(Fe)}.top .tooltip::after {
      transform: translateX(-50%) rotate(225deg);
      bottom: 5px;
      left: 50%;
    }

    ${r.tagFor(Fe)}.top .tooltip {
      margin-bottom: 12px;
    }

    ${r.tagFor(Fe)}.bottom .tooltip::after {
      transform: translateX(-50%) rotate(45deg);
      top: 5px;
      left: 50%;
    }

    ${r.tagFor(Fe)}.bottom .tooltip {
      margin-top: 12px;
    }

    ${r.tagFor(Fe)}.left .tooltip::after {
      transform: translateY(-50%) rotate(135deg);
      top: 50%;
      right: 5px;
    }

    ${r.tagFor(Fe)}.left .tooltip {
      margin-right: 12px;
    }

    ${r.tagFor(Fe)}.right .tooltip::after {
      transform: translateY(-50%) rotate(-45deg);
      top: 50%;
      left: 5px;
    }

    ${r.tagFor(Fe)}.right .tooltip {
      margin-left: 12px;
    }
  `.withBehaviors(me(M`
        :host([disabled]) {
          opacity: 1;
        }
        ${r.tagFor(Fe)}.top .tooltip::after,
        ${r.tagFor(Fe)}.bottom .tooltip::after,
        ${r.tagFor(Fe)}.left .tooltip::after,
        ${r.tagFor(Fe)}.right .tooltip::after {
          content: '';
          width: unset;
          height: unset;
        }
      `))});var oC,iC,nC=y(()=>{l();c();d();W();Ne();u3();oC=class extends Xt{connectedCallback(){super.connectedCallback(),Re.setValueFor(this,Yn)}},iC=oC.compose({baseName:"tooltip",baseClass:Xt,template:MI,styles:d3})});var h3,p3=y(()=>{l();c();d();A();W();h3=(r,e)=>M`
  :host([hidden]) {
    display: none;
  }

  ${de("flex")} :host {
    flex-direction: column;
    align-items: stretch;
    min-width: fit-content;
    font-size: 0;
  }
`});var sC,aC=y(()=>{l();c();d();W();p3();sC=Wl.compose({baseName:"tree-view",template:zI,styles:h3})});var FM,DM,f3,LM,NM,m3,g3=y(()=>{l();c();d();A();W();be();Dt();Ne();Yt();Jr();FM=M`
  .expand-collapse-button svg {
    transform: rotate(0deg);
  }
  :host(.nested) .expand-collapse-button {
    left: var(--expand-collapse-button-nested-width, calc(${Ae} * -1px));
  }
  :host([selected])::after {
    left: calc(${rr} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,DM=M`
  .expand-collapse-button svg {
    transform: rotate(180deg);
  }
  :host(.nested) .expand-collapse-button {
    right: var(--expand-collapse-button-nested-width, calc(${Ae} * -1px));
  }
  :host([selected])::after {
    right: calc(${rr} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,f3=qr`((${Ba} / 2) * ${G}) + ((${G} * ${Eo}) / 2)`,LM=et.create("tree-item-expand-collapse-hover").withDefault(r=>{let e=ri.getValueFor(r);return e.evaluate(r,e.evaluate(r).hover).hover}),NM=et.create("tree-item-expand-collapse-selected-hover").withDefault(r=>{let e=zs.getValueFor(r);return ri.getValueFor(r).evaluate(r,e.evaluate(r).rest).hover}),m3=(r,e)=>M`
    ${de("block")} :host {
      contain: content;
      position: relative;
      outline: none;
      color: ${De};
      fill: currentcolor;
      cursor: pointer;
      font-family: ${Io};
      --expand-collapse-button-size: calc(${Ae} * 1px);
      --tree-item-nested-width: 0;
    }

    .positioning-region {
      display: flex;
      position: relative;
      box-sizing: border-box;
      background: ${Vs};
      border: calc(${ee} * 1px) solid transparent;
      border-radius: calc(${Oe} * 1px);
      height: calc((${Ae} + 1) * 1px);
    }

    :host(:${ke}) .positioning-region {
      ${or}
    }

    .positioning-region::before {
      content: '';
      display: block;
      width: var(--tree-item-nested-width);
      flex-shrink: 0;
    }

    :host(:not([disabled])) .positioning-region:hover {
      background: ${Jn};
    }

    :host(:not([disabled])) .positioning-region:active {
      background: ${Xn};
    }

    .content-region {
      display: inline-flex;
      align-items: center;
      white-space: nowrap;
      width: 100%;
      height: calc(${Ae} * 1px);
      margin-inline-start: calc(${G} * 2px + 8px);
      ${Ge}
    }

    .items {
      display: none;
      ${""} font-size: calc(1em + (${G} + 16) * 1px);
    }

    .expand-collapse-button {
      background: none;
      border: none;
      border-radius: calc(${Oe} * 1px);
      ${""} width: calc((${f3} + (${G} * 2)) * 1px);
      height: calc((${f3} + (${G} * 2)) * 1px);
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      margin: 0 6px;
    }

    .expand-collapse-button svg {
      transition: transform 0.1s linear;
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
    }

    .start {
      ${""} margin-inline-end: calc(${G} * 2px + 2px);
    }

    .end {
      ${""} margin-inline-start: calc(${G} * 2px + 2px);
    }

    :host(.expanded) > .items {
      display: block;
    }

    :host([disabled]) {
      opacity: ${zt};
      cursor: ${tr};
    }

    :host(.nested) .content-region {
      position: relative;
      margin-inline-start: var(--expand-collapse-button-size);
    }

    :host(.nested) .expand-collapse-button {
      position: absolute;
    }

    :host(.nested) .expand-collapse-button:hover {
      background: ${LM};
    }

    :host(:not([disabled])[selected]) .positioning-region {
      background: ${ji};
    }

    :host(:not([disabled])[selected]) .expand-collapse-button:hover {
      background: ${NM};
    }

    :host([selected])::after {
      content: '';
      display: block;
      position: absolute;
      top: calc((${Ae} / 4) * 1px);
      width: 3px;
      height: calc((${Ae} / 2) * 1px);
      ${""} background: ${Qe};
      border-radius: calc(${Oe} * 1px);
    }

    ::slotted(fluent-tree-item) {
      --tree-item-nested-width: 1em;
      --expand-collapse-button-nested-width: calc(${Ae} * -1px);
    }
  `.withBehaviors(new oi(FM,DM),me(M`
        :host {
          color: ${T.ButtonText};
        }
        .positioning-region {
          border-color: ${T.ButtonFace};
          background: ${T.ButtonFace};
        }
        :host(:not([disabled])) .positioning-region:hover,
        :host(:not([disabled])) .positioning-region:active,
        :host(:not([disabled])[selected]) .positioning-region {
          background: ${T.Highlight};
        }
        :host .positioning-region:hover .content-region,
        :host([selected]) .positioning-region .content-region {
          forced-color-adjust: none;
          color: ${T.HighlightText};
        }
        :host([disabled][selected]) .positioning-region .content-region {
          color: ${T.GrayText};
        }
        :host([selected])::after {
          background: ${T.HighlightText};
        }
        :host(:${ke}) .positioning-region {
          forced-color-adjust: none;
          outline-color: ${T.ButtonFace};
        }
        :host([disabled]),
        :host([disabled]) .content-region,
        :host([disabled]) .positioning-region:hover .content-region {
          opacity: 1;
          color: ${T.GrayText};
        }
        :host(.nested) .expand-collapse-button:hover,
        :host(:not([disabled])[selected]) .expand-collapse-button:hover {
          background: ${T.ButtonFace};
          fill: ${T.ButtonText};
        }
      `))});var lC,cC=y(()=>{l();c();d();W();g3();lC=er.compose({baseName:"tree-item",template:HI,styles:m3,expandCollapseGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>
    </svg>
  `})});var v3=y(()=>{l();c();d();Q1();X1();ew();tw();ow();nw();sw();KR();lw();cw();pw();fw();gw();yw();ww();Cw();kw();Tw();Ew();Aw();Rw();Pw();Fw();Dw();Nw();Bw();Vw();qw();Gw();jw();Ww();Jw();Xw();eC();rC();nC();aC();cC()});function y3(r){return Eb.getOrCreate(r).withPrefix("fluent")}var b3=y(()=>{l();c();d();W()});var yr=y(()=>{l();c();d();v3();b3();Q1();X1();ew();tw();ow();nw();sw();lw();cw();pw();fw();gw();yw();ww();Cw();kw();Tw();Ew();Aw();Rw();Pw();Fw();Dw();Nw();Bw();Vw();qw();Gw();jw();Ww();Jw();Xw();eC();rC();nC();cC();aC();Ne();Dt();jm();Na();id();Qm()});var HM,vt,Xr=y(()=>{l();c();d();yr();HM=y3(),vt=(...r)=>{if(r?.length)for(let e of r)HM.register(e())}});var w3,C3=y(()=>{l();c();d();Te();w3=[Me`
:host .file-upload-area-button{width:auto;display:flex;align-items:end;justify-content:end;margin-inline-end:36px;margin-top:30px}:host fluent-button .upload-icon path{fill:var(--file-upload-button-text-color,var(--foreground-on-accent-rest))}:host fluent-button.file-upload-button::part(control){border:var(--file-upload-button-border,none);background:var(--file-upload-button-background-color,var(--accent-fill-rest))}:host fluent-button.file-upload-button::part(control):hover{background:var(--file-upload-button-background-color-hover,var(--accent-fill-hover))}:host fluent-button.file-upload-button .upload-text{color:var(--file-upload-button-text-color,var(--foreground-on-accent-rest));font-weight:400;line-height:20px}:host input{display:none}:host fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host fluent-dialog::part(overlay){opacity:.5}:host fluent-dialog::part(control){--dialog-width:$file-upload-dialog-width;--dialog-height:$file-upload-dialog-height;padding:var(--file-upload-dialog-padding,24px);border:var(--file-upload-dialog-border,1px solid var(--neutral-fill-rest))}:host fluent-dialog .file-upload-dialog-ok{background:var(--file-upload-dialog-keep-both-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-keep-both-button-border,none);color:var(--file-upload-dialog-keep-both-button-text-color,var(--foreground-on-accent-rest))}:host fluent-dialog .file-upload-dialog-ok:hover{background:var(--file-upload-dialog-keep-both-button-background-color-hover,var(--accent-fill-hover))}:host fluent-dialog .file-upload-dialog-cancel{background:var(--file-upload-dialog-replace-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-replace-button-border,1px solid var(--neutral-foreground-rest));color:var(--file-upload-dialog-replace-button-text-color,var(--neutral-foreground-rest))}:host fluent-dialog .file-upload-dialog-cancel:hover{background:var(--file-upload-dialog-replace-button-background-color-hover,var(--accent-fill-hover))}:host fluent-checkbox{margin-top:12px}:host fluent-checkbox .file-upload-dialog-check{color:var(--file-upload-dialog-text-color,--foreground-on-accent-rest)}:host .file-upload-table{display:flex}:host .file-upload-table.upload{display:flex}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell.percent-indicator{padding-inline-start:10px}:host .file-upload-table .file-upload-cell .description{opacity:.5;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:28px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-inline-start:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .mgt-file-item{--file-background-color:transparent;--file-padding:0 12px;--file-padding-inline-start:24px}:host .file-upload-template{clear:both}:host .file-upload-template .file-upload-folder-tab{padding-inline-start:20px}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-background-color,var(--accent-fill-rest));color:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{display:flex;align-items:end;justify-content:end;gap:5px}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));padding-right:5px}:host .file-upload-dialog.visible{display:block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{cursor:pointer;opacity:.5}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border-drag,1px dashed #0078d4);background-color:var(--file-upload-background-color-drag,rgba(0,120,212,.1));position:absolute;inset:0;z-index:1;display:inline-block}[dir=rtl] :host .file-upload-status{left:0;right:28px}
`]});var ir,x3=y(()=>{l();c();d();ir={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep both",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep both files?',uploadButtonLabel:"File upload button"}});var k3,S3=y(()=>{l();c();d();Te();k3=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size);font-weight:var(--default-font-weight,400);border:var(--file-border,1px solid transparent);border-radius:var(--file-border-radius,4px);background-color:var(--file-background-color)}:host .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color);padding:var(--file-padding,0);margin:var(--file-margin,0)}:host .item:hover{background-color:var(--file-background-color-hover,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px);cursor:pointer;--secondary-text-color:var(--secondary-text-hover-color)}:host .item:focus,:host .item:focus-visible{background-color:var(--file-background-color-focus,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px)}:host .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1{font-size:var(--default-font-size);font-weight:var(--file-line1-font-weight,var(--default-font-weight,400));text-transform:var(--file-line1-text-transform,initial);line-height:20px;color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .item__details .line2{color:var(--file-line2-color,var(--secondary-text-color));font-size:var(--file-line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--file-line2-font-weight,var(--default-font-weight,400));text-transform:var(--file-line2-text-transform,initial);line-height:16px}:host .item__details .line3{color:var(--file-line3-color,var(--secondary-text-color));font-size:var(--file-line3-font-size,var(--size-font-size,12px));font-weight:var(--file-line3-font-weight,var(--default-font-weight,400));text-transform:var(--file-line3-text-transform,initial);line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}
`]});var _3,T3,E3,I3=y(()=>{l();c();d();_3={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},T3="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types",E3=(r,e,t)=>Object.keys(_3).find(i=>_3[i]===r)?`${T3}/${e.toString()}/${r}.${t}`:r==="jpg"||r==="png"?(r="photo",`${T3}/${e.toString()}/${r}.${t}`):null});var A3,R3=y(()=>{l();c();d();A3={modifiedSubtitle:"Modified",sizeSubtitle:"Size"}});var go,Et,UM,Ga,pr,_d=y(()=>{l();c();d();Te();At();S3();ue();Nc();Ai();_s();I3();Vr();R3();ue();go=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Et=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},UM=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Ga=()=>Pe("file",pr),pr=class extends st{static get styles(){return k3}get strings(){return A3}get fileQuery(){return this._fileQuery}set fileQuery(e){e!==this._fileQuery&&(this._fileQuery=e,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}get listId(){return this._listId}set listId(e){e!==this._listId&&(this._listId=e,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(e){e!==this._insightId&&(this._insightId=e,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(e){e!==this._fileDetails&&(this._fileDetails=e,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(e){e!==this._fileIcon&&(this._fileIcon=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}constructor(){super(),this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view=xe.threelines}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();let e=this.driveItem,t;if(t=this.renderTemplate("default",{file:e}),!t){let o=this.renderDetails(e),i=this.renderFileTypeIcon();t=k`
        <div class="item">
          ${i} ${o}
        </div>`}return t}renderLoading(){return this.renderTemplate("loading",null)||k``}renderNoData(){return this.renderTemplate("no-data",null)||k``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return k``;let e;if(this.fileIcon)e=this.fileIcon;else{let t=/(?:\.([^.]+))?$/,o=this.driveItem.package===void 0&&this.driveItem.folder===void 0?t.exec(this.driveItem.name)[1]?t.exec(this.driveItem.name)[1].toLowerCase():this.driveItem.size?"null":"folder":this.driveItem.package!==void 0&&this.driveItem.package.type==="oneNote"?"onetoc":"folder";e=E3(o,48,"svg")}return k`
      <div class="item__file-type-icon">
        ${e?k`
              <img src=${e} alt="File icon" />
            `:k`
              ${Y(P.File)}
            `}
      </div>
    `}renderDetails(e){if(!e||this.view===xe.image)return k``;let t=[];if(this.view>xe.image){let o=this.getTextFromProperty(e,this.line1Property);o&&t.push(k`
          <div class="line1" aria-label="${o}">${o}</div>
        `)}if(this.view>xe.oneline){let o=this.getTextFromProperty(e,this.line2Property);o&&t.push(k`
          <div class="line2" aria-label="${o}">${o}</div>
        `)}if(this.view>xe.twolines){let o=this.getTextFromProperty(e,this.line3Property);o&&t.push(k`
          <div class="line3" aria-label="${o}">${o}</div>
        `)}return k`
      <div class="item__details">
        ${t}
      </div>
    `}loadState(){return UM(this,void 0,void 0,function*(){if(this.fileDetails){this.driveItem=this.fileDetails;return}let e=K.globalProvider;if(!e||e.state===ce.Loading)return;if(e.state===ce.SignedOut){this.driveItem=null;return}let t=e.graph.forComponent(this),o,i=!this.driveId&&!this.siteId&&!this.groupId&&!this.listId&&!this.userId;this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?o=null:this.fileQuery?o=yield xo(t,this.fileQuery):this.itemId&&i?o=yield HS(t,this.itemId):this.itemPath&&i?o=yield US(t,this.itemPath):this.userId?this.itemId?o=yield qS(t,this.userId,this.itemId):this.itemPath?o=yield GS(t,this.userId,this.itemPath):this.insightType&&this.insightId&&(o=yield KS(t,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?o=yield FS(t,this.driveId,this.itemId):this.itemPath&&(o=yield DS(t,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?o=yield BS(t,this.siteId,this.itemId):this.itemPath&&(o=yield zS(t,this.siteId,this.itemPath)):this.listId?o=yield VS(t,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?o=yield LS(t,this.groupId,this.itemId):this.itemPath&&(o=yield NS(t,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(o=yield jS(t,this.insightType,this.insightId)),this.driveItem=o})}getTextFromProperty(e,t){if(!t||t.length===0)return null;let o=t.trim().split(","),i,n=0;for(;!i&&n<o.length;){let s=o[n].trim();switch(s){case"size":{let a="0";e.size&&(a=wu(e.size)),i=`${this.strings.sizeSubtitle}: ${a}`;break}case"lastModifiedDateTime":{let a,u;if(e.lastModifiedDateTime){let h=new Date(e.lastModifiedDateTime);a=Cl(h),u=`${this.strings.modifiedSubtitle} ${a}`}else u="";i=u;break}default:i=e[s]}n++}return i}};go([E({attribute:"file-query"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"fileQuery",null);go([E({attribute:"site-id"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"siteId",null);go([E({attribute:"drive-id"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"driveId",null);go([E({attribute:"group-id"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"groupId",null);go([E({attribute:"list-id"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"listId",null);go([E({attribute:"user-id"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"userId",null);go([E({attribute:"item-id"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"itemId",null);go([E({attribute:"item-path"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"itemPath",null);go([E({attribute:"insight-type"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"insightType",null);go([E({attribute:"insight-id"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"insightId",null);go([E({type:Object}),Et("design:type",Object),Et("design:paramtypes",[Object])],pr.prototype,"fileDetails",null);go([E({attribute:"file-icon"}),Et("design:type",String),Et("design:paramtypes",[String])],pr.prototype,"fileIcon",null);go([E({type:Object}),Et("design:type",Object)],pr.prototype,"driveItem",void 0);go([E({attribute:"line1-property"}),Et("design:type",String)],pr.prototype,"line1Property",void 0);go([E({attribute:"line2-property"}),Et("design:type",String)],pr.prototype,"line2Property",void 0);go([E({attribute:"line3-property"}),Et("design:type",String)],pr.prototype,"line3Property",void 0);go([E({attribute:"view",converter:r=>!r||r.length===0?xe.threelines:(r=r.toLowerCase(),typeof xe[r]>"u"?xe.threelines:xe[r])}),Et("design:type",Number)],pr.prototype,"view",void 0)});var P3,$3,sc,dC,BM,zM,VM,O3,Mh,uC=y(()=>{l();c();d();yr();ue();Te();At();fi();Nc();_s();Xr();Vr();Ai();C3();x3();ue();_d();P3=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},$3=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},sc=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},dC=r=>r.isDirectory,BM=r=>r.isFile,zM=r=>"getAsEntry"in r&&typeof r.getAsEntry=="function",VM=r=>"getAsFile"in r&&typeof r.getAsFile=="function"||"webkitGetAsEntry"in r&&typeof r.webkitGetAsEntry=="function",O3=()=>{vt(Ow,Dr,ic,vw),Ga(),Pe("file-upload",Mh)},Mh=class extends fr{static get styles(){return w3}get strings(){return ir}static get requiredScopes(){return[...new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"])]}get _dropEffect(){return"copy"}constructor(){super(),this._dragCounter=0,this._maxChunkSize=4*1024*1024,this._dialogTitle="",this._dialogContent="",this._dialogPrimaryButton="",this._dialogSecondaryButton="",this._dialogCheckBox="",this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.onFileUploadChange=e=>{let t=e.target;!e||t.files.length<1||this.readUploadedFiles(t.files,()=>t.value=null)},this.onFileUploadClick=()=>{this.renderRoot.querySelector("#file-upload-input").click()},this.handleonDragOver=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.dropEffect=e.dataTransfer.dropEffect=this._dropEffect)},this.handleonDragEnter=e=>{e.preventDefault(),e.stopPropagation(),this._dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.dropEffect=this._dropEffect,this.renderRoot.querySelector("#file-upload-border").classList.add("visible"))},this.handleonDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this._dragCounter--,this._dragCounter===0&&this.renderRoot.querySelector("#file-upload-border").classList.remove("visible")},this.handleonDrop=e=>{var t;e.preventDefault(),e.stopPropagation();let o=()=>{e.dataTransfer.clearData()};this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),!((t=e.dataTransfer)===null||t===void 0)&&t.items&&this.readUploadedFiles(e.dataTransfer.items,o),this._dragCounter=0},this.filesToUpload=[]}render(){if(this.parentElement!==null){let e=this.parentElement;e.addEventListener("dragenter",this.handleonDragEnter),e.addEventListener("dragleave",this.handleonDragLeave),e.addEventListener("dragover",this.handleonDragOver),e.addEventListener("drop",this.handleonDrop)}return k`
        <div id="file-upload-dialog" class="file-upload-dialog">
          <!-- Modal content -->
          <fluent-dialog modal="true" class="file-upload-dialog-content">
            <span
              class="file-upload-dialog-close"
              id="file-upload-dialog-close">
                ${Y(P.Cancel)}
            </span>
            <div class="file-upload-dialog-content-text">
              <h2 class="file-upload-dialog-title">${this._dialogTitle}</h2>
              <div>${this._dialogContent}</div>
                <fluent-checkbox
                  id="file-upload-dialog-check"
                  class="file-upload-dialog-check">
                    ${this._dialogCheckBox}
                </fluent-checkbox>
            </div>
            <div class="file-upload-dialog-editor">
              <fluent-button
                appearance="accent"
                class="file-upload-dialog-ok">
                ${this._dialogPrimaryButton}
              </fluent-button>
              <fluent-button
                appearance="outline"
                class="file-upload-dialog-cancel">
                ${this._dialogSecondaryButton}
              </fluent-button>
            </div>
          </fluent-dialog>
        </div>
        <div id="file-upload-border"></div>
        <div class="file-upload-area-button">
          <input
            id="file-upload-input"
            title="${this.strings.uploadButtonLabel}"
            tabindex="-1"
            aria-label="file upload input"
            type="file"
            multiple
            @change="${this.onFileUploadChange}"
          />
          <fluent-button
            appearance="accent"
            class="file-upload-button"
            @click=${this.onFileUploadClick}
            label=${this.strings.uploadButtonLabel}>
              <span slot="start">${Y(P.Upload)}</span>
              <span class="upload-text">${this.strings.buttonUploadFile}</span>
          </fluent-button>
        </div>
        <div class="file-upload-template">
          ${this.renderFolderTemplate(this.filesToUpload)}
        </div>
       `}renderFolderTemplate(e){let t=[];if(e.length>0){let o=e.map(i=>t.indexOf(i.fullPath.substring(0,i.fullPath.lastIndexOf("/")))===-1?i.fullPath.endsWith("/")?k`${this.renderFileTemplate(i,"")}`:(t.push(i.fullPath.substring(0,i.fullPath.lastIndexOf("/"))),Ee`
            <div class='file-upload-table'>
              <div class='file-upload-cell'>
                <mgt-file
                  .fileDetails=${{name:i.fullPath.substring(1,i.fullPath.lastIndexOf("/")),folder:"Folder"}}
                  .view=${xe.oneline}
                  class="mgt-file-item">
                </mgt-file>
              </div>
            </div>
            ${this.renderFileTemplate(i,"file-upload-folder-tab")}`):k`${this.renderFileTemplate(i,"file-upload-folder-tab")}`);return k`${o}`}return k``}renderFileTemplate(e,t){let o=Ve({"file-upload-table":!0,upload:e.completed}),i=t+(e.fieldUploadResponse==="lastModifiedDateTime"?" file-upload-dialog-success":""),n=Ve({description:e.fieldUploadResponse==="description"}),s=e.completed?k``:this.renderFileUploadTemplate(e);return Ee`
        <div class="${o}">
          <div class="${i}">
            <div class='file-upload-cell'>
              <div class="${n}">
                <div class="file-upload-status">
                  ${e.iconStatus}
                </div>
                <mgt-file
                  .fileDetails=${e.driveItem}
                  .view=${e.view}
                  .line2Property=${e.fieldUploadResponse}
                  part="upload"
                  class="mgt-file-item">
                </mgt-file>
              </div>
            </div>
              ${s}
            </div>
          </div>
        </div>`}renderFileUploadTemplate(e){let t=Ve({"file-upload-table":!0,upload:e.completed});return k`
    <div class='file-upload-cell'>
      <div class='file-upload-table file-upload-name'>
        <div class='file-upload-cell'>
          <div
            title="${e.file.name}"
            class='file-upload-filename'>
            ${e.file.name}
          </div>
        </div>
      </div>
      <div class='file-upload-table'>
        <div class='file-upload-cell'>
          <div class="${t}">
            <fluent-progress class="file-upload-bar" value="${e.percent}"></fluent-progress>
            <div class='file-upload-cell percent-indicator'>
              <span>${e.percent}%</span>
              <span
                class="file-upload-cancel"
                @click=${()=>this.deleteFileUploadSession(e)}>
                ${Y(P.Cancel)}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
    `}deleteFileUploadSession(e){return sc(this,void 0,void 0,function*(){try{e.uploadUrl!==void 0?(yield m_(this.fileUploadList.graph,e.uploadUrl),e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,ir.cancelUploadFile)):(e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,ir.cancelUploadFile))}catch{e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,ir.cancelUploadFile)}})}readUploadedFiles(e,t){return sc(this,void 0,void 0,function*(){let o=yield this.getFilesFromUploadArea(e);yield this.getSelectedFiles(o),t()})}getSelectedFiles(e){return sc(this,void 0,void 0,function*(){let t=[],o=[];this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach(n=>{n.completed?o.push(n):t.push(n)});for(let n of e){let s=n.fullPath===""?"/"+n.name:n.fullPath;if(t.filter(a=>a.fullPath===s).length===0){let a=!0;if(this.fileUploadList.maxFileSize!==void 0&&a&&n.size>this.fileUploadList.maxFileSize*1024&&(a=!1,this._maximumFileSize===!1)){let u=yield this.getFileUploadStatus(n,s,"MaxFileSize",this.fileUploadList);u!==null&&u[0]===1&&(this._maximumFileSize=!0)}if(this.fileUploadList.excludedFileExtensions!==void 0&&this.fileUploadList.excludedFileExtensions.length>0&&a&&this.fileUploadList.excludedFileExtensions.filter(u=>n.name.toLowerCase().indexOf(u.toLowerCase())>-1).length>0&&(a=!1,this._excludedFileType===!1)){let u=yield this.getFileUploadStatus(n,s,"ExcludedFileType",this.fileUploadList);u!==null&&u[0]===1&&(this._excludedFileType=!0)}if(a){let u=yield this.getFileUploadStatus(n,s,"Upload",this.fileUploadList),h=!1;u!==null&&(u[0]===-1?h=!0:(this._applyAll=!!u[0],this._applyAllConflictBehavior=u[1]?1:0)),t.push({file:n,driveItem:{name:n.name},fullPath:s,conflictBehavior:u!==null?u[1]?1:0:null,iconStatus:null,percent:1,view:xe.image,completed:h,maxSize:this._maxChunkSize,minSize:0})}}}t=t.sort((n,s)=>n.fullPath.substring(0,n.fullPath.lastIndexOf("/")).localeCompare(s.fullPath.substring(0,s.fullPath.lastIndexOf("/")))),t.forEach(n=>{if(o.filter(s=>s.fullPath===n.fullPath).length!==0){let s=o.findIndex(a=>a.fullPath===n.fullPath);o.splice(s,1)}}),t.push(...o),this.filesToUpload=t;let i=this.filesToUpload.map(n=>this.sendFileItemGraph(n));yield Promise.all(i)})}getFileUploadStatus(e,t,o,i){let n=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return sc(this,void 0,void 0,function*(){let s=this.renderRoot.querySelector("#file-upload-dialog");switch(o){case"Upload":return(yield u_(this.fileUploadList.graph,`${this.getGrapQuery(t)}?$select=id`))!==null?this._applyAll===!0?[this._applyAll,this._applyAllConflictBehavior]:(s.classList.add("visible"),this._dialogTitle=ir.fileReplaceTitle,this._dialogContent=ir.fileReplace.replace("{FileName}",e.name),this._dialogCheckBox=ir.checkApplyAll,this._dialogPrimaryButton=ir.buttonReplace,this._dialogSecondaryButton=ir.buttonKeep,yield n.requestStateUpdate.call(this,!0),new Promise(u=>{let h=this.renderRoot.querySelector(".file-upload-dialog-close"),p=this.renderRoot.querySelector(".file-upload-dialog-ok"),f=this.renderRoot.querySelector(".file-upload-dialog-cancel"),b=this.renderRoot.querySelector("#file-upload-dialog-check");b.checked=!1,b.classList.remove("hide");let x=()=>{s.classList.remove("visible"),u([b.checked?1:0,1])},S=()=>{s.classList.remove("visible"),u([b.checked?1:0,0])},R=()=>{s.classList.remove("visible"),u([-1])};p.removeEventListener("click",x),f.removeEventListener("click",S),h.removeEventListener("click",R),p.addEventListener("click",x),f.addEventListener("click",S),h.addEventListener("click",R)})):null;case"ExcludedFileType":return s.classList.add("visible"),this._dialogTitle=ir.fileTypeTitle,this._dialogContent=ir.fileType.replace("{FileName}",e.name)+" ("+i.excludedFileExtensions.join(",")+")",this._dialogCheckBox=ir.checkAgain,this._dialogPrimaryButton=ir.buttonOk,this._dialogSecondaryButton=ir.buttonCancel,yield n.requestStateUpdate.call(this,!0),new Promise(a=>{let u=this.renderRoot.querySelector(".file-upload-dialog-ok"),h=this.renderRoot.querySelector(".file-upload-dialog-cancel"),p=this.renderRoot.querySelector(".file-upload-dialog-close"),f=this.renderRoot.querySelector("#file-upload-dialog-check");f.checked=!1,f.classList.remove("hide");let b=()=>{s.classList.remove("visible"),a([f.checked?1:0])},x=()=>{s.classList.remove("visible"),a([0])};u.removeEventListener("click",b),h.removeEventListener("click",x),p.removeEventListener("click",x),u.addEventListener("click",b),h.addEventListener("click",x),p.addEventListener("click",x)});case"MaxFileSize":return s.classList.add("visible"),this._dialogTitle=ir.maximumFileSizeTitle,this._dialogContent=ir.maximumFileSize.replace("{FileSize}",wu(i.maxFileSize*1024)).replace("{FileName}",e.name)+wu(e.size)+".",this._dialogCheckBox=ir.checkAgain,this._dialogPrimaryButton=ir.buttonOk,this._dialogSecondaryButton=ir.buttonCancel,yield n.requestStateUpdate.call(this,!0),new Promise(a=>{let u=this.renderRoot.querySelector(".file-upload-dialog-ok"),h=this.renderRoot.querySelector(".file-upload-dialog-cancel"),p=this.renderRoot.querySelector(".file-upload-dialog-close"),f=this.renderRoot.querySelector("#file-upload-dialog-check");f.checked=!1,f.classList.remove("hide");let b=()=>{s.classList.remove("visible"),a([f.checked?1:0])},x=()=>{s.classList.remove("visible"),a([0])};u.removeEventListener("click",b),h.removeEventListener("click",x),p.removeEventListener("click",x),u.addEventListener("click",b),h.addEventListener("click",x),p.addEventListener("click",x)});default:break}})}getGrapQuery(e){let t="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(t=this.fileUploadList.itemPath.startsWith("/")?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?`/users/${this.fileUploadList.userId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.userId&&this.fileUploadList.itemPath?`/users/${this.fileUploadList.userId}/drive/root:${t}${e}`:this.fileUploadList.groupId&&this.fileUploadList.itemId?`/groups/${this.fileUploadList.groupId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.groupId&&this.fileUploadList.itemPath?`/groups/${this.fileUploadList.groupId}/drive/root:${t}${e}`:this.fileUploadList.driveId&&this.fileUploadList.itemId?`/drives/${this.fileUploadList.driveId}/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.driveId&&this.fileUploadList.itemPath?`/drives/${this.fileUploadList.driveId}/root:${t}${e}`:this.fileUploadList.siteId&&this.fileUploadList.itemId?`/sites/${this.fileUploadList.siteId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.siteId&&this.fileUploadList.itemPath?`/sites/${this.fileUploadList.siteId}/drive/root:${t}${e}`:this.fileUploadList.itemId?`/me/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.itemPath?`/me/drive/root:${t}${e}`:`/me/drive/root:${e}`}sendFileItemGraph(e){return sc(this,void 0,void 0,function*(){let t=this.fileUploadList.graph,o="";if(e.file.size<this._maxChunkSize)try{e.completed||((e.conflictBehavior===null||e.conflictBehavior===1)&&(o=`${this.getGrapQuery(e.fullPath)}:/content`),e.conflictBehavior===0&&(o=`${this.getGrapQuery(e.fullPath)}:/content?@microsoft.graph.conflictBehavior=rename`),e.driveItem=yield f_(t,o,e.file),e.driveItem!==null?this.setUploadSuccess(e):(e.driveItem={name:e.file.name},this.setUploadFail(e,ir.failUploadFile)))}catch{this.setUploadFail(e,ir.failUploadFile)}else if(!e.completed&&e.uploadUrl===void 0){let i=yield h_(t,`${this.getGrapQuery(e.fullPath)}:/createUploadSession`,e.conflictBehavior);try{if(i!==null){e.uploadUrl=i.uploadUrl;let n=yield this.sendSessionUrlGraph(t,e);n!==null?(e.driveItem=n,this.setUploadSuccess(e)):this.setUploadFail(e,ir.failUploadFile)}else this.setUploadFail(e,ir.failUploadFile)}catch{}}})}sendSessionUrlGraph(e,t){let o=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return sc(this,void 0,void 0,function*(){for(;t.file.size>t.minSize;){t.mimeStreamString===void 0&&(t.mimeStreamString=yield this.readFileContent(t.file));let i=new Blob([t.mimeStreamString.slice(t.minSize,t.maxSize)]);if(t.percent=Math.round(t.maxSize/t.file.size*100),yield o.requestStateUpdate.call(this,!0),t.uploadUrl!==void 0){let n=yield p_(e,t.uploadUrl,`${t.maxSize-t.minSize}`,`bytes ${t.minSize}-${t.maxSize-1}/${t.file.size}`,i);if(n===null)return null;if(OS(n))t.minSize=parseInt(n.nextExpectedRanges[0].split("-")[0],10),t.maxSize=t.minSize+this._maxChunkSize,t.maxSize>t.file.size&&(t.maxSize=t.file.size);else if(n.id!==void 0)return n}else return null}})}setUploadSuccess(e){e.percent=100,super.requestStateUpdate(!0),setTimeout(()=>{e.iconStatus=Y(P.Success),e.view=xe.twolines,e.fieldUploadResponse="lastModifiedDateTime",e.completed=!0,super.requestStateUpdate(!0),Af()},500)}setUploadFail(e,t){setTimeout(()=>{e.iconStatus=Y(P.Fail),e.view=xe.twolines,e.driveItem.description=t,e.fieldUploadResponse="description",e.completed=!0,super.requestStateUpdate(!0)},500)}readFileContent(e){return new Promise((t,o)=>{let i=new FileReader;i.onloadend=()=>{t(i.result)},i.onerror=n=>{o(n)},i.readAsArrayBuffer(e)})}getFilesFromUploadArea(e){return sc(this,void 0,void 0,function*(){let t=[],o,i=[];for(let n of e)if(VM(n))if(zM(n))if(o=n.getAsEntry(),dC(o))t.push(o);else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else if(n.webkitGetAsEntry)if(o=n.webkitGetAsEntry(),dC(o))t.push(o);else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else this.writeFilePath(n,""),i.push(n);if(t.length>0){let n=yield this.getFolderFiles(t);i.push(...n)}return i})}getFolderFiles(e){return new Promise(t=>{let o=0,i=[];e.forEach(a=>{n(a,"")});let n=(a,u)=>{dC(a)?s(a.createReader()):BM(a)&&(o++,a.file(h=>{o--,this.writeFilePath(h,u),i.push(h),o===0&&t(i)}))},s=a=>{o++,a.readEntries(u=>{o--;for(let h of u)n(h,h.fullPath);o===0&&t(i)})}})}writeFilePath(e,t){e.fullPath=t}};P3([E({type:Object}),$3("design:type",Array)],Mh.prototype,"filesToUpload",void 0);P3([E({type:Object}),$3("design:type",Object)],Mh.prototype,"fileUploadList",void 0)});var M3,F3=y(()=>{l();c();d();Te();M3=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}
`]});var D3,L3=y(()=>{l();c();d();D3={showMoreSubtitle:"Show more items",filesSectionTitle:"Files",sharedTextSubtitle:"Shared"}});var br,ft,N3,Qg,Vt,Yg=y(()=>{l();c();d();ue();Te();At();Rl();Nc();uC();Vr();_s();F3();L3();_d();uC();yr();Xr();ue();br=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},ft=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},N3=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Qg=()=>{vt(Ah),Ga(),O3(),Pe("file-list",Vt)},Vt=class extends st{static get styles(){return M3}get strings(){return D3}get fileListQuery(){return this._fileListQuery}set fileListQuery(e){e!==this._fileListQuery&&(this._fileListQuery=e,this.requestStateUpdate(!0))}get displayName(){return this.strings.filesSectionTitle}get cardTitle(){return this.strings.filesSectionTitle}renderIcon(){return Y(P.Files)}get fileQueries(){return this._fileQueries}set fileQueries(e){Go(this._fileQueries,e)||(this._fileQueries=e,this.requestStateUpdate(!0))}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate(!0))}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate(!0))}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate(!0))}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate(!0))}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate(!0))}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate(!0))}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate(!0))}get fileExtensions(){return this._fileExtensions}set fileExtensions(e){Go(this._fileExtensions,e)||(this._fileExtensions=e,this.requestStateUpdate(!0))}get pageSize(){return this._pageSize}set pageSize(e){e!==this._pageSize&&(this._pageSize=e,this.requestStateUpdate(!0))}get maxFileSize(){return this._maxFileSize}set maxFileSize(e){e!==this._maxFileSize&&(this._maxFileSize=e,this.requestStateUpdate(!0))}get maxUploadFile(){return this._maxUploadFile}set maxUploadFile(e){e!==this._maxUploadFile&&(this._maxUploadFile=e,this.requestStateUpdate(!0))}get excludedFileExtensions(){return this._excludedFileExtensions}set excludedFileExtensions(e){Go(this._excludedFileExtensions,e)||(this._excludedFileExtensions=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set([...pr.requiredScopes])]}constructor(){super(),this._isCompact=!1,this.disableOpenOnClick=!1,this._focusedItemIndex=-1,this.onFocusFirstItem=()=>this._focusedItemIndex=0,this.onFileListKeyDown=e=>{let t=this.renderRoot.querySelector(".file-list"),o;if(t?.children.length){if((e.code==="ArrowUp"||e.code==="ArrowDown")&&(e.code==="ArrowUp"&&(this._focusedItemIndex===-1&&(this._focusedItemIndex=t.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+t.children.length)%t.children.length),e.code==="ArrowDown"&&(this._focusedItemIndex=(this._focusedItemIndex+1)%t.children.length),o=t.children[this._focusedItemIndex],this.updateItemBackgroundColor(t,o,"focused")),e.code==="Enter"||e.code==="Space"){o=t.children[this._focusedItemIndex];let i=o.children[0];e.preventDefault(),this.fireCustomEvent("itemClick",i.fileDetails),this.handleFileClick(i.fileDetails),this.updateItemBackgroundColor(t,o,"selected")}e.code==="Tab"&&(o=t.children[this._focusedItemIndex])}},this.pageSize=10,this.itemView=xe.twolines,this.maxUploadFile=10,this.enableFileUpload=!1,this._preloadedFiles=[]}requestStateUpdate(e){return this.clearState(),super.requestStateUpdate(e)}clearState(){super.clearState(),this.files=null}asCompactView(){return this._isCompact=!0,this}asFullView(){return this._isCompact=!1,this}render(){return!this.files&&this.isLoadingState?this.renderLoading():!this.files||this.files.length===0?this.renderNoData():this._isCompact?this.renderCompactView():this.renderFullView()}renderCompactView(){let e=this.files.slice(0,3);return this.renderFiles(e)}renderFullView(){return this.renderTemplate("default",{files:this.files})||this.renderFiles(this.files)}renderLoading(){return this.renderTemplate("loading",null)||k``}renderNoData(){return this.renderTemplate("no-data",null)||(this.enableFileUpload===!0&&K.globalProvider!==void 0?k`
            <div class="file-list-wrapper" dir=${this.direction}>
              ${this.renderFileUpload()}
            </div>`:k``)}renderFiles(e){return k`
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        ${this.enableFileUpload?this.renderFileUpload():null}
        <ul
          id="file-list"
          class="file-list"
        >
          <li
            tabindex="0"
            class="file-item"
            @keydown="${this.onFileListKeyDown}"
            @focus="${this.onFocusFirstItem}"
            @click=${t=>this.handleItemSelect(e[0],t)}>
            ${this.renderFile(e[0])}
          </li>
          ${uo(e.slice(1),t=>t.id,t=>k`
              <li
                class="file-item"
                @keydown="${this.onFileListKeyDown}"
                @click=${o=>this.handleItemSelect(t,o)}>
                ${this.renderFile(t)}
              </li>
            `)}
        </ul>
        ${!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)&&!this._isCompact?this.renderMoreFileButton():null}
      </div>
    `}renderFile(e){let t=this.itemView;return this.renderTemplate("file",{file:e},e.id)||Ee`
        <mgt-file class="mgt-file-item" .fileDetails=${e} .view=${t}></mgt-file>
      `}renderMoreFileButton(){return this._isLoadingMore?k`
        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>
      `:k`
        <fluent-button
          appearance="stealth"
          id="show-more"
          class="show-more"
          @click=${()=>this.renderNextPage()}
        >
          <span class="show-more-text">${this.strings.showMoreSubtitle}</span>
        </fluent-button>`}renderFileUpload(){let e={graph:K.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return Ee`
        <mgt-file-upload .fileUploadList=${e} ></mgt-file-upload>
      `}loadState(){var e;return N3(this,void 0,void 0,function*(){let t=K.globalProvider;if(!t||t.state===ce.Loading)return;if(t.state===ce.SignedOut){this.files=null;return}let o=t.graph.forComponent(this),i,n,s=!this.driveId&&!this.siteId&&!this.groupId&&!this.userId;if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){this.fileListQuery?n=yield n_(o,this.fileListQuery,this.pageSize):this.fileQueries?i=yield l_(o,this.fileQueries):s?this.itemId?n=yield XS(o,this.itemId,this.pageSize):this.itemPath?n=yield e_(o,this.itemPath,this.pageSize):this.insightType?i=yield s_(o,this.insightType):n=yield WS(o,this.pageSize):this.driveId?this.itemId?n=yield QS(o,this.driveId,this.itemId,this.pageSize):this.itemPath&&(n=yield YS(o,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?n=yield ZS(o,this.groupId,this.itemId,this.pageSize):this.itemPath&&(n=yield JS(o,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?n=yield t_(o,this.siteId,this.itemId,this.pageSize):this.itemPath&&(n=yield r_(o,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?n=yield o_(o,this.userId,this.itemId,this.pageSize):this.itemPath?n=yield i_(o,this.userId,this.itemPath,this.pageSize):this.insightType&&(i=yield a_(o,this.userId,this.insightType))),n&&(this.pageIterator=n,this._preloadedFiles=[...this.pageIterator.value],this._preloadedFiles.length>=this.pageSize?i=this._preloadedFiles.splice(0,this.pageSize):i=this._preloadedFiles.splice(0,this._preloadedFiles.length));let a;if(this.fileExtensions&&this.fileExtensions!==null){if(!((e=this.pageIterator)===null||e===void 0)&&e.value){for(;this.pageIterator.hasNext;)yield X0(this.pageIterator);i=this.pageIterator.value,this._preloadedFiles=[]}a=i.filter(u=>{for(let h of this.fileExtensions)if(h===this.getFileExtension(u.name))return u})}a?.length>=0?(this.files=a,this.pageSize&&(i=this.files.splice(0,this.pageSize),this.files=i)):this.files=i}})}handleItemSelect(e,t){if(this.handleFileClick(e),this.fireCustomEvent("itemClick",e),t){let o=this.renderRoot.querySelector(".file-list"),i=Array.from(o.children),n=t.target.closest("li"),s=i.indexOf(n);this._focusedItemIndex=s;let a=o.children[this._focusedItemIndex];this.updateItemBackgroundColor(o,a,"selected")}}renderNextPage(){return N3(this,void 0,void 0,function*(){if(this._preloadedFiles.length>0)this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))];else if(this.pageIterator.hasNext){this._isLoadingMore=!0;let e=this.renderRoot.querySelector("#file-list-wrapper");e?.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),yield X0(this.pageIterator),this._isLoadingMore=!1,this.files=this.pageIterator.value}this.requestUpdate()})}handleFileClick(e){e?.webUrl&&!this.disableOpenOnClick&&window.open(e.webUrl,"_blank","noreferrer")}getFileExtension(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}updateItemBackgroundColor(e,t,o){for(let i of e.children)i.classList.remove(o),i.removeAttribute("tabindex");t&&(t.classList.add(o),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),t.setAttribute("tabindex","0"),t.focus());for(let i of e.children)i.classList.remove("selected")}reload(e=!1){e&&Af(),this.requestStateUpdate(!0)}};br([le(),ft("design:type",Object)],Vt.prototype,"_isCompact",void 0);br([E({attribute:"file-list-query"}),ft("design:type",String),ft("design:paramtypes",[String])],Vt.prototype,"fileListQuery",null);br([E({attribute:"file-queries",converter:(r,e)=>r?r.split(",").map(t=>t.trim()):null}),ft("design:type",Array),ft("design:paramtypes",[Array])],Vt.prototype,"fileQueries",null);br([E({type:Object}),ft("design:type",Array)],Vt.prototype,"files",void 0);br([E({attribute:"site-id"}),ft("design:type",String),ft("design:paramtypes",[String])],Vt.prototype,"siteId",null);br([E({attribute:"drive-id"}),ft("design:type",String),ft("design:paramtypes",[String])],Vt.prototype,"driveId",null);br([E({attribute:"group-id"}),ft("design:type",String),ft("design:paramtypes",[String])],Vt.prototype,"groupId",null);br([E({attribute:"item-id"}),ft("design:type",String),ft("design:paramtypes",[String])],Vt.prototype,"itemId",null);br([E({attribute:"item-path"}),ft("design:type",String),ft("design:paramtypes",[String])],Vt.prototype,"itemPath",null);br([E({attribute:"user-id"}),ft("design:type",String),ft("design:paramtypes",[String])],Vt.prototype,"userId",null);br([E({attribute:"insight-type"}),ft("design:type",String),ft("design:paramtypes",[String])],Vt.prototype,"insightType",null);br([E({attribute:"item-view",converter:r=>!r||r.length===0?xe.threelines:(r=r.toLowerCase(),typeof xe[r]>"u"?xe.threelines:xe[r])}),ft("design:type",Number)],Vt.prototype,"itemView",void 0);br([E({attribute:"file-extensions",converter:(r,e)=>r.split(",").map(t=>t.trim())}),ft("design:type",Array),ft("design:paramtypes",[Array])],Vt.prototype,"fileExtensions",null);br([E({attribute:"page-size",type:Number}),ft("design:type",Number),ft("design:paramtypes",[Number])],Vt.prototype,"pageSize",null);br([E({attribute:"disable-open-on-click",type:Boolean}),ft("design:type",Object)],Vt.prototype,"disableOpenOnClick",void 0);br([E({attribute:"hide-more-files-button",type:Boolean}),ft("design:type",Boolean)],Vt.prototype,"hideMoreFilesButton",void 0);br([E({attribute:"max-file-size",type:Number}),ft("design:type",Number),ft("design:paramtypes",[Number])],Vt.prototype,"maxFileSize",null);br([E({attribute:"enable-file-upload",type:Boolean}),ft("design:type",Boolean)],Vt.prototype,"enableFileUpload",void 0);br([E({attribute:"max-upload-file",type:Number}),ft("design:type",Number),ft("design:paramtypes",[Number])],Vt.prototype,"maxUploadFile",null);br([E({attribute:"excluded-file-extensions",converter:(r,e)=>r.split(",").map(t=>t.trim())}),ft("design:type",Array),ft("design:paramtypes",[Array])],Vt.prototype,"excludedFileExtensions",null);br([le(),ft("design:type",Boolean)],Vt.prototype,"_isLoadingMore",void 0)});var H3,U3=y(()=>{l();c();d();Te();H3=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--message-hover-color,var(--neutral-fill-hover));cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--message-subject-color,var(--neutral-foreground-color));font-size:var(--message-subject-font-size,14px);font-weight:var(--message-subject-font-weight,600);line-height:var(--message-subject-line-height,20px)}:host .root .message .message__detail .message__from{font-size:var(--message-from-font-size,12px);color:var(--message-from-color,var(--neutral-foreground-color));line-height:var(--message-from-line-height,16px);font-weight:var(--message-from-font-weight,400)}:host .root .message .message__detail .message__message{font-size:var(--message-from-font-size,12px);color:var(--message-color,var(--neutral-foreground-hint));line-height:var(--message-from-line-height,16px);font-weight:var(--message-from-font-weight,400)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{margin-top:8px;font-size:12px;color:var(--message-date-color,var(--neutral-foreground-hint));margin-left:10px;white-space:nowrap}
`]});var B3,z3=y(()=>{l();c();d();B3={emailsSectionTitle:"Emails"}});var V3,Fh,Zg=y(()=>{l();c();d();Te();Pu();Vr();Ai();U3();z3();ue();V3=()=>Pe("messages",Fh),Fh=class extends fn{static get styles(){return H3}get strings(){return B3}constructor(e){super(),this._messages=e}get displayName(){return this.strings.emailsSectionTitle}get cardTitle(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return Y(P.Messages)}renderCompactView(){var e;let t;if(this.isLoadingState)t=this.renderLoading();else if(!(!((e=this._messages)===null||e===void 0)&&e.length))t=this.renderNoData();else{let o=this._messages?this._messages.slice(0,3).map(i=>this.renderMessage(i)):[];t=k`
         ${o}
       `}return k`
       <div class="root compact">
         ${t}
       </div>
     `}renderFullView(){var e;let t;return this.isLoadingState?t=this.renderLoading():!((e=this._messages)===null||e===void 0)&&e.length?t=k`
         ${this._messages.slice(0,5).map(o=>this.renderMessage(o))}
       `:t=this.renderNoData(),k`
       <div class="root">
         ${t}
       </div>
     `}renderMessage(e){return k`
       <div class="message" @click=${()=>this.handleMessageClick(e)}>
         <div class="message__detail">
           <div class="message__subject">${e.subject}</div>
           <div class="message__from">${e.from.emailAddress.name}</div>
           <div class="message__message">${e.bodyPreview}</div>
         </div>
         <div class="message__date">${Cl(new Date(e.receivedDateTime))}</div>
       </div>
     `}handleMessageClick(e){window.open(e.webLink,"_blank","noreferrer")}}});var q3,G3=y(()=>{l();c();d();Te();q3=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__person-image{height:40px;width:40px;border-radius:40px;--person-avatar-size:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .subtitle{color:var(--organization-sub-title-color,var(--neutral-foreground-hint));font-size:14px;margin:0 20px 8px}:host .root .divider{display:flex;background:var(--organization-coworker-border-color,var(--neutral-stroke-rest));height:1px;margin:26px 20px 18px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-inline:20px}:host .root .org-member.org-member--target{background-color:var(--organization-active-org-member-target-background-color,var(--neutral-fill-active));border:1px solid var(--organization-active-org-member-border-color,var(--accent-foreground-rest))}:host .root .org-member:not(.org-member--target){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest))}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--organization-hover-color,var(--neutral-fill-hover))}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__person .org-member__person-image{--person-avatar-size:var(--organization-member-person-avatar-size, 40px)}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--organization-title-color,var(--neutral-foreground-rest));font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--organization-sub-title-color,var(--neutral-foreground-hint))}:host .root .org-member__separator:not(:last-child){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest));box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--organization-coworker-hover-color,var(--neutral-fill-hover))}:host .root .coworker .coworker__person{height:46px;border-radius:46px;margin-right:8px}:host .root .coworker .coworker__person .coworker__person-image{--person-avatar-size:var(--organization-coworker-person-avatar-size, 40px)}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{margin-right:4px}:host .root .direct-report-list{border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest));margin-inline:20px}:host .root .direct-report-list .org-member--direct-report{border:none;cursor:pointer;margin-inline:0}:host .root .direct-report-list .org-member--direct-report .direct-report__person-image{--person-avatar-size:var(--organization-direct-report-person-avatar-size, 38px)}[dir=rtl] .org-member .org-member__more{transform:scaleX(-1);filter:fliph;filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var j3,K3=y(()=>{l();c();d();j3={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"}});var W3,Dh,Jg=y(()=>{l();c();d();Te();Pu();Vr();G3();K3();_s();ue();ue();Yi();W3=()=>{ii(),Pe("organization",Dh)},Dh=class extends fn{static get styles(){return q3}get strings(){return j3}constructor(e,t){super(),this._state=e,this._me=t}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){let{person:e,directReports:t}=this._state;return!e.manager&&t?.length?`${this.strings.directReportsSectionTitle} (${t.length})`:this.strings.reportsToSectionTitle}get cardTitle(){return this.strings.organizationSectionTitle}renderIcon(){return Y(P.Organization)}renderCompactView(){var e;let t;if(!(!((e=this._state)===null||e===void 0)&&e.person))return null;let{person:o,directReports:i}=this._state;if(o)o.manager?t=this.renderCoworker(o.manager):i?.length&&(t=this.renderCompactDirectReports());else return null;return k`
        <div class="root compact">
          ${t}
        </div>
      `}renderFullView(){var e;let t;if(!(!((e=this._state)===null||e===void 0)&&e.person))return null;let{person:o,directReports:i,people:n}=this._state;if(!o&&!i&&!n)return null;{let s=this.renderManagers(),a=this.renderCurrentUser(),u=this.renderDirectReports(),h=this.renderCoworkers();t=k`
          ${s} ${a} ${u} ${h}
        `}return k`
       <div class="root" dir=${this.direction}>
         ${t}
       </div>
     `}renderManager(e){return Ee`
      <div
        class="org-member"
        @keydown=${t=>{(t.code==="Enter"||t.code===" ")&&this.navigateCard(e)}}
        @click=${()=>this.navigateCard(e)}
      >
        <div class="org-member__person">
          <mgt-person
            class="org-member__person-image"
            .personDetails=${e}
            .fetchImage=${!0}
            .view=${xe.twolines}
            .showPresence=${!0}
          ></mgt-person>
        </div>
        <div tabindex="0" class="org-member__more">
          ${Y(P.ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
     `}renderManagers(){let{person:e}=this._state;if(!e?.manager)return null;let t=[],o=e;for(;o.manager;)t.push(o.manager),o=o.manager;return t.length?t.reverse().map(i=>this.renderManager(i)):null}renderDirectReports(){let{directReports:e}=this._state;return e?.length?k`
      <div class="org-member__separator"></div>
      <div class="direct-report-list">
        ${e.map(t=>Ee`
            <div
              class="org-member org-member--direct-report"
              @keydown=${o=>{(o.code==="Enter"||o.code===" ")&&this.navigateCard(t)}}
              @click=${()=>this.navigateCard(t)}
            >
              <div class="org-member__person">
                <mgt-person
                  class="org-member__person-image"
                  .personDetails=${t}
                  .fetchImage=${!0}
                  .showPresence=${!0}
                  .view=${xe.twolines}
                ></mgt-person>
              </div>
              <div tabindex="0" class="org-member__more">
                ${Y(P.ExpandRight)}
              </div>
            </div>
          `)}
      </div>
     `:null}renderCompactDirectReports(){let{directReports:e}=this._state;return k`
      <div class="direct-report__compact">
        ${e.slice(0,6).map(t=>Ee`
            <div
              class="direct-report"
              @keydown=${o=>{(o.code==="Enter"||o.code===" ")&&this.navigateCard(t)}}
              @click=${()=>this.navigateCard(t)}
            >
              <mgt-person
                class="direct-report__person-image"
                .personDetails=${t}
                .fetchImage=${!0}
                .showPresence=${!0}
                .view=${xe.twolines}
              ></mgt-person>
            </div>
          `)}
      </div>
    `}renderCurrentUser(){let{person:e}=this._state;return Ee`
       <div class="org-member org-member--target">
         <div class="org-member__person">
           <mgt-person
              class="org-member__person-image"
             .personDetails=${e}
             .fetchImage=${!0}
             .showPresence=${!0}
             .view=${xe.twolines}
           ></mgt-person>
         </div>
       </div>
     `}renderCoworker(e){return Ee`
      <div
        class="coworker"
        @keydown=${t=>{(t.code==="Enter"||t.code===" ")&&this.navigateCard(e)}}
        @click=${()=>this.navigateCard(e)}
      >
        <div class="coworker__person">
          <mgt-person
            class="coworker__person-image"
            .personDetails=${e}
            .fetchImage=${!0}
            .showPresence=${!0}
            .view=${xe.twolines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworkers(){let{people:e}=this._state;if(!e?.length)return null;let t=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return k`
       <div class="divider"></div>
       <div class="subtitle" tabindex="0">${t}</div>
       <div>
         ${e.slice(0,6).map(o=>this.renderCoworker(o))}
       </div>
     `}}});var Q3,Y3=y(()=>{l();c();d();Te();Q3=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none;background-color:var(--profile-background-color,--neutral-layer-1)}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--profile-title-color,var(--neutral-foreground-rest));margin:0 20px 12px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-flow:row wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--profile-token-item-background-color,var(--neutral-fill-secondary-rest));border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--profile-token-item-color,var(--neutral-foreground-rest))}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset;background:0 0;color:var(--profile-token-overflow-color,var(--accent-foreground-rest))}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--profile-title-color,var(--neutral-foreground-rest))}:host .root .data-list__item .data-list__item__date-range{color:var(--profile-section-title-color,var(--neutral-foreground-hint));font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#023b8f}:host .root .work-position .work-position__location{font-size:10px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--profile-title-color,var(--neutral-foreground-rest))}[dir=rtl] .token-list__item{margin-right:0!important}
`]});var Z3,J3=y(()=>{l();c();d();Z3={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current",socialMediaSubSectionTitle:"Social Media"}});var X3,Lh,Xg=y(()=>{l();c();d();Te();Pu();Vr();Y3();J3();ue();X3=()=>Pe("profile",Lh),Lh=class extends fn{static get styles(){return Q3}get strings(){return Z3}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get cardTitle(){return this.strings.AboutCompactSectionTitle}get hasData(){var e,t;if(!this.profile)return!1;let{languages:o,skills:i,positions:n,educationalActivities:s}=this.profile;return[this._birthdayAnniversary,(e=this._personalInterests)===null||e===void 0?void 0:e.length,(t=this._professionalInterests)===null||t===void 0?void 0:t.length,o?.length,i?.length,n?.length,s?.length].filter(a=>!!a).length>0}get profile(){return this._profile}set profile(e){e!==this._profile&&(this._profile=e,this._birthdayAnniversary=e?.anniversaries?e.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=e?.interests?e.interests.filter(this.isPersonalInterest):null,this._professionalInterests=e?.interests?e.interests.filter(this.isProfessionalInterest):null)}constructor(e){super(),this.isPersonalInterest=t=>{var o;return(o=t.categories)===null||o===void 0?void 0:o.includes("personal")},this.isProfessionalInterest=t=>{var o;return(o=t.categories)===null||o===void 0?void 0:o.includes("professional")},this.isBirthdayAnniversary=t=>t.type==="birthday",this.profile=e}renderIcon(){return Y(P.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return k`
       <div class="root compact" dir=${this.direction}>
         ${this.renderSubSections().slice(0,2)}
       </div>
     `}renderFullView(){return this.initPostRenderOperations(),k`
       <div class="root" dir=${this.direction}>
         ${this.renderSubSections()}
       </div>
     `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter(t=>!!t)}renderLanguages(){var e;let{languages:t}=this._profile;if(!t?.length)return null;let o=[];for(let n of t){let s=null;!((e=n.proficiency)===null||e===void 0)&&e.length&&(s=k`
           <span class="language__proficiency" tabindex="0">
             &nbsp;(${n.proficiency})
           </span>
         `),o.push(k`
         <div class="token-list__item language">
           <span class="language__title" tabindex="0">${n.displayName}</span>
           ${s}
         </div>
       `)}let i=o.length?this.strings.LanguagesSubSectionTitle:"";return k`
       <section>
         <div class="section__title" tabindex="0">${i}</div>
         <div class="section__content">
           <div class="token-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderSkills(){let{skills:e}=this._profile;if(!e?.length)return null;let t=[];for(let i of e)t.push(k`
         <div class="token-list__item skill" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.SkillsSubSectionTitle:"";return k`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderWorkExperience(){var e,t,o,i,n;let{positions:s}=this._profile;if(!s?.length)return null;let a=[];for(let h of this._profile.positions)(h.detail.description||h.detail.jobTitle!=="")&&a.push(k`
           <div class="data-list__item work-position">
             <div class="data-list__item__header">
               <div class="data-list__item__title" tabindex="0">${(e=h.detail)===null||e===void 0?void 0:e.jobTitle}</div>
               <div class="data-list__item__date-range" tabindex="0">
                 ${this.getDisplayDateRange(h.detail)}
               </div>
             </div>
             <div class="data-list__item__content">
               <div class="work-position__company" tabindex="0">
                 ${(o=(t=h?.detail)===null||t===void 0?void 0:t.company)===null||o===void 0?void 0:o.displayName}
               </div>
               <div class="work-position__location" tabindex="0">
                 ${this.displayLocation((n=(i=h?.detail)===null||i===void 0?void 0:i.company)===null||n===void 0?void 0:n.address)}
               </div>
             </div>
           </div>
         `);let u=a.length?this.strings.WorkExperienceSubSectionTitle:"";return k`
       <section>
         <div class="section__title" tabindex="0">${u}</div>
         <div class="section__content">
           <div class="data-list">
             ${a}
           </div>
         </div>
       </section>
     `}renderEducation(){let{educationalActivities:e}=this._profile;if(!e?.length)return null;let t=[];for(let i of e)t.push(k`
         <div class="data-list__item educational-activity">
           <div class="data-list__item__header">
             <div class="data-list__item__title" tabindex="0">${i.institution.displayName}</div>
             <div class="data-list__item__date-range" tabindex="0">
               ${this.getDisplayDateRange(i)}
             </div>
           </div>
           ${i.program.displayName?k`<div class="data-list__item__content">
                  <div class="educational-activity__degree" tabindex="0">
                  ${i.program.displayName}
                </div>`:rt}
         </div>
       `);let o=t.length?this.strings.EducationSubSectionTitle:"";return k`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="data-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderProfessionalInterests(){var e;if(!(!((e=this._professionalInterests)===null||e===void 0)&&e.length))return null;let t=[];for(let i of this._professionalInterests)t.push(k`
         <div class="token-list__item interest interest--professional" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.professionalInterestsSubSectionTitle:"";return k`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderPersonalInterests(){var e;if(!(!((e=this._personalInterests)===null||e===void 0)&&e.length))return null;let t=[];for(let i of this._personalInterests)t.push(k`
         <div class="token-list__item interest interest--personal" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.personalInterestsSubSectionTitle:"";return k`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderBirthday(){var e;return!((e=this._birthdayAnniversary)===null||e===void 0)&&e.date?k`
       <section>
         <div class="section__title" tabindex="0">Birthday</div>
         <div class="section__content">
           <div class="birthday">
             <div class="birthday__icon">
               ${Y(P.Birthday)}
             </div>
             <div class="birthday__date" tabindex="0">
               ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
             </div>
           </div>
         </div>
       </section>
     `:null}getDisplayDate(e){return e.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(e){if(!e.startMonthYear)return rt;let t=new Date(e.startMonthYear).getFullYear();if(t===0||t===1)return rt;let o=e.endMonthYear?new Date(e.endMonthYear).getFullYear():this.strings.currentYearSubtitle;return`${t} \u2014 ${o}`}displayLocation(e){return e?.city?e.state?`${e.city}, ${e.state}`:e.city:rt}initPostRenderOperations(){setTimeout(()=>{try{this.shadowRoot.querySelectorAll("section").forEach(t=>{this.handleTokenOverflow(t)})}catch{}},0)}handleTokenOverflow(e){let t=e.querySelectorAll(".token-list");if(t?.length)for(let o of Array.from(t)){let i=o.querySelectorAll(".token-list__item");if(!i?.length)continue;let n=null,s=i[0].getBoundingClientRect(),a=o.getBoundingClientRect(),u=s.height*2+a.top;for(let h=0;h<i.length-1;h++)if(s=i[h].getBoundingClientRect(),s.top>u){n=Array.from(i).slice(h,i.length);break}if(n){n.forEach(f=>f.classList.add("overflow"));let h=document.createElement("div");h.classList.add("token-list__item"),h.classList.add("token-list__item--show-overflow"),h.tabIndex=0,h.innerText=`+ ${n.length} more`;let p=()=>{h.remove(),n.forEach(f=>f.classList.remove("overflow"))};h.addEventListener("click",()=>{p()}),h.addEventListener("keydown",f=>{f.code==="Enter"&&p()}),o.appendChild(h)}}}}});var eP,hC=y(()=>{l();c();d();Iu();eP=()=>{let r=[];return Bt.sections.files&&r.push("Sites.Read.All"),Bt.sections.mailMessages&&(r.push("Mail.Read"),r.push("Mail.ReadBasic")),Bt.sections.organization&&(r.push("User.Read.All"),Bt.sections.organization.showWorksWith&&r.push("People.Read.All")),Bt.sections.profile&&r.push("User.Read.All"),Bt.useContactApis&&r.push("Contacts.Read"),r.indexOf("User.Read.All")<0&&(r.push("User.ReadBasic.All"),r.push("User.Read")),r.indexOf("People.Read.All")<0&&r.push("People.Read"),Bt.isSendMessageVisible&&r.push("Chat.ReadWrite"),[...new Set(r)]}});var tP,rP=y(()=>{l();c();d();tP={showMoreSectionButton:"Show more",endOfCard:"End of the card",quickMessage:"Send a quick message",expandDetailsLabel:"Expand details",sendMessageLabel:"Send message",emailButtonLabel:"Email",callButtonLabel:"Call",chatButtonLabel:"Chat",closeCardLabel:"Close card",videoButtonLabel:"Video",goBackLabel:"Go Back"}});var oP=y(()=>{l();c();d()});var nP={};I6(nP,{MgtPersonCard:()=>vo,registerMgtPersonCardComponent:()=>pC});var wi,zo,iP,pC,vo,ev=y(()=>{l();c();d();Te();At();fi();ue();Ln();_s();$c();Ef();Vr();_f();b_();Yi();C_();Ou();Yg();Zg();Jg();Xg();Iu();hC();rP();Z0();pn();oP();yr();Xr();ue();pn();wi=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},zo=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},iP=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},pC=()=>{vt(Cn,Zw,Qw,Yw,Dr,xn),Pe("person-card",vo),Hn(),A_(),W3(),V3(),Qg(),X3(),customElements.get(au("person"))||ii()},vo=class extends st{static get styles(){return w_}get strings(){return tP}static get requiredScopes(){return eP()}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.personImage=this.getImage(),this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this._cardState=null,this.requestStateUpdate())}get internalPersonDetails(){var e;return((e=this._cardState)===null||e===void 0?void 0:e.person)||this.personDetails}constructor(){super(),this.isSending=!1,this.goBack=()=>{var e;if(!(!((e=this._history)===null||e===void 0)&&e.length))return;let t=this._history.pop();this._currentSection=null;let o=this.renderRoot.querySelector("fluent-tab");o&&o.click(),this._cardState=t.state,this._personDetails=t.state.person,this.personImage=t.personImage,this.loadSections()},this.handleEndOfCard=e=>{if(e&&e.code==="Tab"){let t=this.renderRoot.querySelector("#end-of-container");if(t){t.blur();let o=this.renderRoot.querySelector("mgt-person");o&&o.focus()}}},this.closeCard=()=>{this.updateCurrentSection(null),this.isExpanded=!1},this.sendQuickMessage=()=>iP(this,void 0,void 0,function*(){let e=this._chatInput.trim();if(!e?.length)return;let t=this.personDetails,o=this._me.userPrincipalName;this.isSending=!0;let i=yield v_(this._graph,t.userPrincipalName,o),n={body:{content:e}};yield y_(this._graph,i.id,n),this.isSending=!1,this.clearInputData()}),this.emailUser=()=>{let e=this.internalPersonDetails;if(e){let t=Co(e);t&&window.open("mailto:"+t,"_blank","noreferrer")}},this.callUser=()=>{var e,t;let o=this.personDetails,i=this.personDetails;if(!((e=o?.businessPhones)===null||e===void 0)&&e.length){let n=o.businessPhones[0];n&&window.open("tel:"+n,"_blank","noreferrer")}else if(!((t=i?.phones)===null||t===void 0)&&t.length){let s=this.getPersonBusinessPhones(i)[0];s&&window.open("tel:"+s,"_blank","noreferrer")}},this.chatUser=(e=null)=>{let t=this.personDetails;if(t?.userPrincipalName){let i=`https://teams.microsoft.com/l/chat/0/0?users=${t.userPrincipalName}`;e?.length&&(i+=`&message=${e}`);let n=()=>window.open(i,"_blank","noreferrer");Pn.isAvailable?Pn.executeDeepLink(i,s=>{s||n()}):n()}},this.videoCallUser=()=>{let e=this.personDetails;if(e?.userPrincipalName){let o=`https://teams.microsoft.com/l/call/0/0?users=${e.userPrincipalName}&withVideo=true`,i=()=>window.open(o,"_blank");Pn.isAvailable?Pn.executeDeepLink(o,n=>{n||i()}):i()}},this.showExpandedDetails=()=>{let e=this.renderRoot.querySelector(".root");e?.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)},this.sendQuickMessageOnEnter=e=>{e.code==="Enter"&&this.sendQuickMessage()},this.handleGoBack=e=>{e.code==="Enter"&&this.goBack()},this._chatInput="",this._currentSection=null,this._history=[],this.sections=[],this._graph=null}attributeChangedCallback(e,t,o){if(super.attributeChangedCallback(e,t,o),t!==o)switch(e){case"person-query":this.personDetails=null,this._cardState=null,this.requestStateUpdate();break}}navigate(e){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this._cardState}),this._personDetails=e,this._cardState=null,this.personImage=null,this._currentSection=null,this.sections=[],this._chatInput="",this.requestStateUpdate()}clearHistory(){var e;if(this._currentSection=null,!(!((e=this._history)===null||e===void 0)&&e.length))return;let t=this._history[0];this._history=[],this._cardState=t.state,this._personDetails=t.personDetails,this.personImage=t.personImage,this.loadSections()}render(){var e;if(!this.internalPersonDetails)return this.renderNoData();let t=this.internalPersonDetails,o=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:o});let i;i=this.strings.closeCardLabel;let n=this.isExpanded?k`
           <div class="close-card-container">
             <fluent-button 
              appearance="lightweight" 
              class="close-button" 
              aria-label=${i}
              @click=${this.closeCard} >
               ${Y(P.Close)}
             </fluent-button>
           </div>
         `:null;i=this.strings.goBackLabel;let s=!((e=this._history)===null||e===void 0)&&e.length?k`
            <div class="nav">
              <fluent-button 
                appearance="lightweight"
                class="nav__back" 
                aria-label=${i} 
                @keydown=${this.handleGoBack}
                @click=${this.goBack}>${Y(P.Back)}
               </fluent-button>
            </div>
          `:null,a=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:o});if(!a){let p=this.renderPerson(),f=this.renderContactIcons(t);a=k`
         ${p} ${f}
       `}let u=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0);let h=this.lockTabNavigation?k`<div @keydown=${this.handleEndOfCard} aria-label=${this.strings.endOfCard} tabindex="0" id="end-of-container"></div>`:k``;return k`
      <div class="root" dir=${this.direction}>
        <div class=${Ve({small:this._smallView})}>
          ${s}
          ${n}
          <div class="person-details-container">${a}</div>
          <div class="expanded-details-container">${u}</div>
          ${h}
        </div>
      </div>
     `}renderNoData(){return this.renderTemplate("no-data",null)||k``}renderPerson(){return Ee`
      <mgt-person
        tabindex="0"
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        .view=${xe.threelines}
      ></mgt-person>
    `}renderPersonSubtitle(e){if(e=e||this.internalPersonDetails,!(!Eu(e)||!e.department))return k`
       <div class="department">${e.department}</div>
     `}renderContactIcons(e){e=e||this.internalPersonDetails;let t=e,o,i;Co(e)&&(o=`${this.strings.emailButtonLabel} ${e.displayName}`,i=k`
        <fluent-button class="icon"
          aria-label=${o}
          @click=${this.emailUser}>
          ${Y(P.SmallEmail)}
        </fluent-button>
      `);let n;t?.userPrincipalName&&(o=`${this.strings.chatButtonLabel} ${e.displayName}`,n=k`
        <fluent-button class="icon"
          aria-label=${o}
          @click=${this.chatUser}>
          ${Y(P.SmallChat)}
        </fluent-button>
       `),o=`${this.strings.videoButtonLabel} ${e.displayName}`;let s=k`
      <fluent-button class="icon"
        aria-label=${o}
        @click=${this.videoCallUser}>
        ${Y(P.Video)}
      </fluent-button>
    `,a;return t.userPrincipalName&&(o=`${this.strings.callButtonLabel} ${e.displayName}`,a=k`
         <fluent-button class="icon"
          aria-label=${o}
          @click=${this.callUser}>
          ${Y(P.Call)}
        </fluent-button>
       `),k`
       <div class="base-icons">
         ${i} ${n} ${s} ${a}
       </div>
     `}renderExpandedDetailsButton(){return k`
      <fluent-button
        aria-label=${this.strings.expandDetailsLabel}
        class="expanded-details-button"
        @click=${this.showExpandedDetails}
      >
        ${Y(P.ExpandDown)}
      </fluent-button>
     `}renderExpandedDetails(){if(!this._cardState&&this._isStateLoading)return Ee`
         <div class="loading">
           <mgt-spinner></mgt-spinner>
         </div>
       `;K.globalProvider.state===ce.SignedOut&&this.loadSections();let t=this.renderSectionNavigation();return k`
      <div class="section-nav">
        ${t}
      </div>
      <hr class="divider"/>
      <div
        class="section-host ${this._smallView?"small":""} ${this._smallView?"small":""}"
        @wheel=${o=>this.handleSectionScroll(o)}
        tabindex=0
      ></div>
    `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;let e=this._currentSection?this.sections.indexOf(this._currentSection):-1,t=this.sections.map((n,s)=>{let a=n.tagName.toLowerCase(),u=Ve({active:s===e,"section-nav__icon":!0});return k`
        <fluent-tab
          id="${a}-Tab"
          class=${u}
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(n)}"
          @click=${()=>this.updateCurrentSection(n)}
        >
          ${n.renderIcon()}
        </fluent-tab>
      `}),o=this.sections.map(n=>k`
        <fluent-tab-panel slot="tabpanel">
          <div class="inserted">
            <div class="title">${n.cardTitle}</div>
            ${this._currentSection?n.asFullView():null}
          </div>
        </fluent-tab-panel>
      `),i=Ve({active:e===-1,"section-nav__icon":!0,overviewTab:!0});return k`
      <fluent-tabs
        orientation="horizontal"
        activeindicator
        @wheel=${n=>this.handleSectionScroll(n)}
      >
        <fluent-tab
          class="${i}"
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(null)}"
          @click=${()=>this.updateCurrentSection(null)}
        >
          <div>${Y(P.Overview)}</div>
        </fluent-tab>
        ${t}
        <fluent-tab-panel slot="tabpanel" >
          <div class="overview-panel">${this._currentSection?null:this.renderOverviewSection()}</div>
        </fluent-tab-panel>
        ${o}
      </fluent-tabs>
    `}renderOverviewSection(){let e=this.sections.map(o=>k`
        <div class="section">
          <div class="section__header">
            <div class="section__title" tabindex=0>${o.displayName}</div>
              <fluent-button
                appearance="lightweight"
                class="section__show-more"
                @click=${()=>this.updateCurrentSection(o)}
              >
                ${this.strings.showMoreSectionButton}
              </fluent-button>
          </div>
          <div class="section__content">${o.asCompactView()}</div>
        </div>
      `),t=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this._cardState});return t&&e.splice(1,0,k`
           <div class="section">
             <div class="additional-details">${t}</div>
           </div>
         `),k`
       <div class="sections">
          ${this.renderMessagingSection()}
          ${e}
       </div>
     `}renderCurrentSection(){var e;if(!(!(!((e=this.sections)===null||e===void 0)&&e.length)&&!this.hasTemplate("additional-details")))return this.sections.length===1&&!this.hasTemplate("additional-details")?k`
         ${this.sections[0].asFullView()}
       `:this._currentSection?k`
       ${this._currentSection.asFullView()}
     `:this.renderOverviewSection()}renderMessagingSection(){let e=this.personDetails,t=this._me.userPrincipalName,o=this._chatInput;if(e?.userPrincipalName!==t)return Bt.isSendMessageVisible?k`
      <div class="message-section">
        <fluent-text-field
          autocomplete="off"
          appearance="outline"
          placeholder="${this.strings.quickMessage}"
          .value=${o}
          @input=${i=>{this._chatInput=i.target.value,this.requestUpdate()}}
          @keydown="${i=>this.sendQuickMessageOnEnter(i)}">
        </fluent-text-field>
        <fluent-button class="send-message-icon"
          aria-label=${this.strings.sendMessageLabel}
          @click=${this.sendQuickMessage}
          ?disabled=${this.isSending}>
          ${this.isSending?Y(P.Confirmation):Y(P.Send)}
        </fluent-button>
      </div>
      `:rt}loadState(){var e,t;return iP(this,void 0,void 0,function*(){if(this._cardState)return;if(!this.personDetails&&this.inheritDetails){let s=this.parentElement;for(;s&&s.tagName!==`${oo.prefix}-PERSON`.toUpperCase();)s=s.parentElement;let a=s.personDetails||s.personDetailsInternal;s&&a&&(this.personDetails=a,this.personImage=s.personImage)}let o=K.globalProvider;if(!o||o.state!==ce.SignedIn)return;let i=o.graph.forComponent(this);if(this._graph=i,this._isStateLoading=!0,this._me||(this._me=yield K.me()),this.personDetails){let s=this.personDetails,a;if(Eu(s)&&(a=s.userPrincipalName||s.id),a&&!Co(s)){let u=yield El(i,a);this.personDetails=u,this.personImage=this.getImage()}}else if(this.userId||this.personQuery==="me"){let s=yield El(i,this.userId);this.personDetails=s,this.personImage=this.getImage()}else if(this.personQuery){let s=yield la(i,this.personQuery,1);s?.length&&(this.personDetails=s[0],yield ku(i,this.personDetails,Bt.useContactApis).then(a=>{a&&(this.personDetails.personImage=a,this.personImage=a)}))}let n={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{!((e=this.personDetails)===null||e===void 0)&&e.id?this.personPresence=yield _u(i,this.personDetails.id):this.personPresence=n}catch{this.personPresence=n}!((t=this.personDetails)===null||t===void 0)&&t.id&&(this._cardState=yield g_(i,this.personDetails,this._me===this.personDetails.id)),this.loadSections(),this._isStateLoading=!1})}get hasPhone(){var e,t;let o=this.personDetails,i=this.personDetails;return!!(!((e=o?.businessPhones)===null||e===void 0)&&e.length)||!!(!((t=i?.phones)===null||t===void 0)&&t.length)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;let e=new $u(this.internalPersonDetails);if(e.hasData&&this.sections.push(e),!this._cardState)return;let{person:t,directReports:o,messages:i,files:n,profile:s}=this._cardState;if(Bt.sections.organization&&(t?.manager||o?.length)&&this.sections.push(new Dh(this._cardState,this._me)),Bt.sections.mailMessages&&i?.length&&this.sections.push(new Fh(i)),Bt.sections.files&&n?.length&&this.sections.push(new Vt),Bt.sections.profile&&s){let a=new Lh(s);a.hasData&&this.sections.push(a)}}getImage(){if(this.personImage)return this.personImage;let e=this.personDetails;return e?.personImage?e.personImage:null}clearInputData(){this._chatInput="",this.requestUpdate()}getPersonBusinessPhones(e){let t=e.phones,o=[];for(let i of t)i.type==="business"&&o.push(i.number);return o}updateCurrentSection(e){if(e){let o=e.tagName.toLowerCase();this.renderRoot.querySelector(`#${o}-Tab`).click()}let t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(let o of t)o.scrollTop=0;this._currentSection=e,this.requestUpdate()}handleSectionScroll(e){let t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(let o of t)o&&!(e.deltaY<0&&o.scrollTop===0)&&!(e.deltaY>0&&o.clientHeight+o.scrollTop>=o.scrollHeight-1)&&e.stopPropagation()}};wi([E({attribute:"person-details",type:Object}),zo("design:type",Object),zo("design:paramtypes",[Object])],vo.prototype,"personDetails",null);wi([E({attribute:"person-query"}),zo("design:type",String)],vo.prototype,"personQuery",void 0);wi([E({attribute:"lock-tab-navigation",type:Boolean}),zo("design:type",Boolean)],vo.prototype,"lockTabNavigation",void 0);wi([E({attribute:"user-id"}),zo("design:type",String),zo("design:paramtypes",[String])],vo.prototype,"userId",null);wi([E({attribute:"person-image",type:String}),zo("design:type",String)],vo.prototype,"personImage",void 0);wi([E({attribute:"fetch-image",type:Boolean}),zo("design:type",Boolean)],vo.prototype,"fetchImage",void 0);wi([E({attribute:"is-expanded",type:Boolean}),zo("design:type",Boolean)],vo.prototype,"isExpanded",void 0);wi([E({attribute:"inherit-details",type:Boolean}),zo("design:type",Boolean)],vo.prototype,"inheritDetails",void 0);wi([E({attribute:"show-presence",type:Boolean}),zo("design:type",Boolean)],vo.prototype,"showPresence",void 0);wi([E({attribute:"person-presence",type:Object}),zo("design:type",Object)],vo.prototype,"personPresence",void 0);wi([le(),zo("design:type",Object)],vo.prototype,"isSending",void 0);wi([le(),zo("design:type",Object)],vo.prototype,"_cardState",void 0);wi([le(),zo("design:type",Boolean)],vo.prototype,"_isStateLoading",void 0)});var Zt,yt,sP,fC,ii,mt,Yi=y(()=>{l();c();d();ue();Te();At();fi();Ln();$c();_f();da();Ef();_s();Cs();Vr();Fc();Fc();Il();IS();Tu();RS();Z0();Lc();ue();Il();Zt=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},yt=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},sP=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},fC=["businessPhones","displayName","givenName","jobTitle","department","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id","userType"],ii=()=>{Pe("person",mt),ua()},mt=class r extends st{static get styles(){return ES}get strings(){return AS}get personQuery(){return this._personQuery}set personQuery(e){e!==this._personQuery&&(this._personQuery=e,this._personDetailsInternal=null,this._personDetails=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,!this.personDetailsInternal&&this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this._personDetailsInternal=null,this._personDetails=null,this.requestStateUpdate())}get usage(){return this._usage}set usage(e){e!==this._usage&&(this._usage=e,this.requestStateUpdate())}get personDetailsInternal(){return this._personDetailsInternal}set personDetailsInternal(e){this._personDetailsInternal!==e&&(this._personDetailsInternal=e,this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate())}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate())}get personImage(){return this._personImage||this._fetchedImage}set personImage(e){e!==this._personImage&&(this._isInvalidImageSrc=!e,this._personImage=e)}get avatarType(){return this._avatarType}set avatarType(e){e!==this._avatarType&&(this._avatarType=e,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(e){if(e===this._personPresence)return;let t=this._personPresence;this._personPresence=e,this.requestUpdate("personPresence",t)}static get requiredScopes(){let e=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return r.config.useContactApis&&e.push("contacts.read"),e}get flyout(){return this.renderRoot.querySelector(".flyout")}constructor(){super(),this._hasLoadedPersonCard=!1,this._mouseLeaveTimeout=-1,this._mouseEnterTimeout=-1,this.handleMouseClick=e=>{let t=e.target;this.personCardInteraction===Kt.click&&t.tagName!==`${oo.prefix}-PERSON-CARD`.toUpperCase()&&this.showPersonCard()},this.handleKeyDown=e=>{e&&e.key==="Enter"&&this.showPersonCard()},this.handleMouseEnter=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===Kt.hover&&(this._mouseEnterTimeout=window.setTimeout(this.showPersonCard,500))},this.handleMouseLeave=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=window.setTimeout(this.hidePersonCard,500)},this.hidePersonCard=()=>{let e=this.flyout;e&&e.close();let t=this.querySelector(".mgt-person-card")||this.renderRoot.querySelector(".mgt-person-card");t&&(t.isExpanded=!1,t.clearHistory())},this.loadPersonCardResources=()=>sP(this,void 0,void 0,function*(){if(this.personCardInteraction!==Kt.none&&!this._hasLoadedPersonCard){let{registerMgtPersonCardComponent:e}=yield Promise.resolve().then(()=>(ev(),nP));customElements.get(au("person-card"))||e(),this._hasLoadedPersonCard=!0}}),this.showPersonCard=()=>{this._personCardShouldRender||(this._personCardShouldRender=!0,this.loadPersonCardResources());let e=this.flyout;e&&e.open()},this.personCardInteraction=Kt.none,this.line1Property="displayName",this.line2Property="jobTitle",this.line3Property="department",this.line4Property="email",this.view=xe.image,this.avatarSize="auto",this.disableImageFetch=!1,this._isInvalidImageSrc=!1,this._avatarType=Ri.photo,this.verticalLayout=!1}render(){if(this.isLoadingState&&!this.personDetails&&!this.personDetailsInternal&&!this.fallbackDetails)return this.renderLoading();let e=this.personDetails||this.personDetailsInternal||this.fallbackDetails,t=this.getImage(),o=this.personPresence||this._fetchedPresence;if(!e&&!t)return this.renderNoData();!e?.personImage&&t&&(e.personImage=t);let i=this.renderTemplate("default",{person:e,personImage:t,personPresence:o});if(!i){let a=this.renderDetails(e,o),u=this.renderAvatar(e,t,o);i=k`
        ${u}
        ${a}
      `}this.personCardInteraction!==Kt.none&&(i=this.renderFlyout(i,e,t,o));let s=Ve({"person-root":!0,small:!this.isThreeLines()&&!this.isFourLines()&&!this.isLargeAvatar(),large:this.avatarSize!=="auto"&&this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines(),vertical:this.isVertical()});return k`
      <div
        class="${s}"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
        @keydown=${this.handleKeyDown}
        tabindex="${Qo(this.personCardInteraction!==Kt.none?"0":void 0)}"
      >
        ${i}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||k``}clearState(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){let e=this.renderTemplate("no-data",null);if(e)return e;let t={"avatar-icon":!0,vertical:this.isVertical(),small:!this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threeLines:this.isThreeLines(),fourLines:this.isFourLines()};return k`
       <i class=${Ve(t)}></i>
     `}renderPersonIcon(){return Y(P.Person)}renderImage(e,t){var o;let i=`${this.strings.photoFor} ${e.displayName}`,n=t&&!this._isInvalidImageSrc&&this.avatarType===Ri.photo,s=this.avatarType===Ri.photo&&this.view===xe.image,a=(o=e?.displayName||Co(e))!==null&&o!==void 0?o:void 0,u=k`<img
      title="${Qo(s?a:void 0)}"
      alt=${i}
      src=${t}
      @error=${()=>this._isInvalidImageSrc=!0} />`,h=e?this.getInitials(e):"",p=h?.length,f=Ve({initials:p&&!n,"contact-icon":!p}),b=k`<i>${this.renderPersonIcon()}</i>`,x=k`
      <span 
        title="${Qo(this.view===xe.image?a:void 0)}"
        role="${Qo(this.view===xe.image?void 0:"presentation")}"
        class="${f}"
      >
        ${p?h:b}
      </span>
`;return n&&this.fireCustomEvent("person-image-rendered"),n?u:x}renderPresence(e){var t;if(!this.showPresence||!e)return k``;let o,{activity:i,availability:n}=e;switch(n){case"Available":case"AvailableIdle":switch(i){case"OutOfOffice":o=Y(P.PresenceOofAvailable);break;case"Available":default:o=Y(P.PresenceAvailable);break}break;case"Busy":case"BusyIdle":switch(i){case"OutOfOffice":case"OnACall":o=Y(P.PresenceOofBusy);break;case"Busy":case"InACall":case"InAMeeting":case"InAConferenceCall":default:o=Y(P.PresenceBusy);break}break;case"DoNotDisturb":switch(i){case"OutOfOffice":o=Y(P.PresenceOofDnd);break;case"Presenting":case"Focusing":case"UrgentInterruptionsOnly":default:o=Y(P.PresenceDnd);break}break;case"Away":switch(i){case"OutOfOffice":o=Y(P.PresenceOofAway);break;case"AwayLastSeenTime":default:o=Y(P.PresenceAway);break}break;case"BeRightBack":switch(i){default:o=Y(P.PresenceAway);break}break;case"Offline":switch(i){case"Offline":o=Y(P.PresenceOffline);break;case"OutOfOffice":case"OffWork":o=Y(P.PresenceOofAway);break;default:o=Y(P.PresenceStatusUnknown);break}break;default:o=Y(P.PresenceStatusUnknown);break}let s=Ve({"presence-wrapper":!0,noline:this.isNoLine(),oneline:this.isOneLine()}),a=(t=this.strings[i])!==null&&t!==void 0?t:rt;return k`
      <span
        class="${s}"
        title="${a}"
        aria-label="${a}"
        role="img">
          ${o}
      </span>
    `}renderAvatar(e,t,o){let i=!t||this._isInvalidImageSrc||this._avatarType===Ri.initials,n="";if(i&&e?n=`${this.strings.initials} ${this.getInitials(e)}`:(n=e&&e.displayName||"",n!==""&&(n=`${this.strings.photoFor} ${n}`)),n===""){let u=Co(e);u!==null&&(n=`${this.strings.emailAddress} ${u}`)}let s=this.renderImage(e,t),a=this.renderPresence(o);return k`
      <div class="avatar-wrapper">
        ${s}
        ${a}
      </div>
    `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}handleLine4Clicked(){this.fireCustomEvent("line4clicked",this.personDetailsInternal)}renderDetails(e,t){if(!e||this.view===xe.image||this.view===Dc.avatar)return k``;let o=e;t&&(o.presenceActivity=t?.activity,o.presenceAvailability=t?.availability);let i=[];if(this.view>xe.image){let s=this.getTextFromProperty(o,this.line1Property);if(this.hasTemplate("line1")){let a=this.renderTemplate("line1",{person:o});i.push(k`
           <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${s}">${a}</div>
         `)}else s&&i.push(k`
             <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${s}">${s}</div>
           `)}if(this.view>xe.oneline){let s=this.getTextFromProperty(o,this.line2Property);if(this.hasTemplate("line2")){let a=this.renderTemplate("line2",{person:o});i.push(k`
           <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${s}">${a}</div>
         `)}else s&&i.push(k`
             <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${s}">${s}</div>
           `)}if(this.view>xe.twolines){let s=this.getTextFromProperty(o,this.line3Property);if(this.hasTemplate("line3")){let a=this.renderTemplate("line3",{person:o});i.push(k`
           <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${s}">${a}</div>
         `)}else s&&i.push(k`
             <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${s}">${s}</div>
           `)}if(this.view>xe.threelines){let s=this.getTextFromProperty(o,this.line4Property);if(this.hasTemplate("line4")){let a=this.renderTemplate("line4",{person:o});i.push(k`
          <div class="line4" @click=${()=>this.handleLine4Clicked()} role="presentation" aria-label="${s}">${a}</div>
        `)}else s&&i.push(k`
            <div class="line4" @click=${()=>this.handleLine4Clicked()} role="presentation" aria-label="${s}">${s}</div>
          `)}let n=Ve({"details-wrapper":!0,vertical:this.isVertical()});return k`
      <div class="${n}">
        ${i}
      </div>
    `}renderFlyout(e,t,o,i){let n=this._personCardShouldRender&&this._hasLoadedPersonCard?k`
           <div slot="flyout" data-testid="flyout-slot">
             ${this.renderFlyoutContent(t,o,i)}
           </div>`:k``,s=Ve({small:!this.isThreeLines()&&!this.isFourLines()&&!this.isLargeAvatar(),large:this.avatarSize!=="auto"&&this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines(),vertical:this.isVertical()});return Ee`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        <div slot="anchor" class="${s}">${e}</div>
        ${n}
      </mgt-flyout>`}renderFlyoutContent(e,t,o){return this.fireCustomEvent("flyout-content-rendered"),this.renderTemplate("person-card",{person:e,personImage:t})||Ee`
        <mgt-person-card
          class="mgt-person-card"
          lock-tab-navigation
          .personDetails=${e}
          .personImage=${t}
          .personPresence=${o}
          .showPresence=${this.showPresence}>
        </mgt-person-card>`}loadState(){return sP(this,void 0,void 0,function*(){let e=K.globalProvider;if(!e||e.state===ce.Loading)return;if(e&&e.state===ce.SignedOut){this.personDetailsInternal=null;return}let t=e.graph.forComponent(this);(this.verticalLayout&&this.view<xe.fourlines||this.fallbackDetails)&&(this.line2Property="email");let o=[...fC,this.line1Property,this.line2Property,this.line3Property,this.line4Property];o=o.filter(s=>s!=="email");let i=this.personDetailsInternal||this.personDetails;if(i){if(!i.personImage&&this.fetchImage&&this._avatarType===Ri.photo&&!this.personImage&&!this._fetchedImage){let s;"groupTypes"in i?s=yield yS(t,i):s=yield ku(t,i,r.config.useContactApis),s&&(i.personImage=s,this._fetchedImage=s)}}else if(this.userId||this.personQuery==="me"){let s;this._avatarType===Ri.photo&&!this.disableImageFetch?s=yield El(t,this.userId,o):this.personQuery==="me"?s=yield Cu(t,o):s=yield xu(t,this.userId,o),this.personDetailsInternal=s,this.personDetails=s,this._fetchedImage=this.getImage()}else if(this.personQuery){let s=yield la(t,this.personQuery,1);if((!s||s.length===0)&&(s=(yield kl(t,this.personQuery,1))||[]),s?.length&&(this.personDetailsInternal=s[0],this.personDetails=s[0],this._avatarType===Ri.photo&&!this.disableImageFetch)){let a=yield ku(t,s[0],r.config.useContactApis);a&&(this.personDetailsInternal.personImage=a,this.personDetails.personImage=a,this._fetchedImage=a)}}i=this.personDetailsInternal||this.personDetails||this.fallbackDetails;let n={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(i){let s=this.personQuery!=="me"?i?.id:null;this._fetchedPresence=yield _u(t,s)}else this._fetchedPresence=n}catch{this._fetchedPresence=n}})}getInitials(e){var t,o,i,n,s,a;if(e||(e=this.personDetailsInternal),PS(e))return e.initials;let u="";if(Eu(e)&&(u+=(i=(o=(t=e.givenName)===null||t===void 0?void 0:t[0])===null||o===void 0?void 0:o.toUpperCase())!==null&&i!==void 0?i:"",u+=(a=(s=(n=e.surname)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.toUpperCase())!==null&&a!==void 0?a:""),!u&&e.displayName){let h=e.displayName.split(/\s+/);for(let p=0;p<2&&p<h.length;p++)h[p][0]&&this.isLetter(h[p][0])&&(u+=h[p][0].toUpperCase())}return u}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;let e=this.personDetailsInternal||this.personDetails;return e?.personImage?e.personImage:null}isLetter(e){try{return e.match(new RegExp("\\p{L}","u"))}catch{return e.toLowerCase()!==e.toUpperCase()}}getTextFromProperty(e,t){if(!t||t.length===0)return null;let o=t.trim().split(","),i,n=0;for(;!i&&n<o.length;){let s=o[n].trim();switch(s){case"mail":case"email":i=Co(e);break;default:i=e[s]}n++}return i}isLargeAvatar(){return this.avatarSize==="large"||this.avatarSize==="auto"&&this.view>xe.oneline}isNoLine(){return this.view<xe.oneline}isOneLine(){return this.view===xe.oneline}isTwoLines(){return this.view===xe.twolines}isThreeLines(){return this.view===xe.threelines}isFourLines(){return this.view===xe.fourlines}isVertical(){return this.verticalLayout}};mt.config={useContactApis:!0};Zt([E({attribute:"person-query"}),yt("design:type",String),yt("design:paramtypes",[String])],mt.prototype,"personQuery",null);Zt([E({attribute:"fallback-details",type:Object}),yt("design:type",Object),yt("design:paramtypes",[Object])],mt.prototype,"fallbackDetails",null);Zt([E({attribute:"user-id"}),yt("design:type",String),yt("design:paramtypes",[String])],mt.prototype,"userId",null);Zt([E({attribute:"usage"}),yt("design:type",String),yt("design:paramtypes",[String])],mt.prototype,"usage",null);Zt([E({attribute:"show-presence",type:Boolean}),yt("design:type",Boolean)],mt.prototype,"showPresence",void 0);Zt([E({attribute:"avatar-size",type:String}),yt("design:type",String)],mt.prototype,"avatarSize",void 0);Zt([le(),yt("design:type",Object),yt("design:paramtypes",[Object])],mt.prototype,"personDetailsInternal",null);Zt([E({attribute:"person-details",type:Object}),yt("design:type",Object),yt("design:paramtypes",[Object])],mt.prototype,"personDetails",null);Zt([E({attribute:"person-image",type:String}),yt("design:type",String),yt("design:paramtypes",[String])],mt.prototype,"personImage",null);Zt([E({attribute:"fetch-image",type:Boolean}),yt("design:type",Boolean)],mt.prototype,"fetchImage",void 0);Zt([E({attribute:"disable-image-fetch",type:Boolean}),yt("design:type",Boolean)],mt.prototype,"disableImageFetch",void 0);Zt([E({attribute:"vertical-layout",type:Boolean}),yt("design:type",Boolean)],mt.prototype,"verticalLayout",void 0);Zt([E({attribute:"avatar-type",converter:r=>(r=r.toLowerCase(),r==="initials"?Ri.initials:Ri.photo)}),yt("design:type",String),yt("design:paramtypes",[String])],mt.prototype,"avatarType",null);Zt([E({attribute:"person-presence",type:Object}),yt("design:type",Object),yt("design:paramtypes",[Object])],mt.prototype,"personPresence",null);Zt([E({attribute:"person-card",converter:r=>(r=r.toLowerCase(),typeof Kt[r]>"u"?Kt.none:Kt[r])}),yt("design:type",Number)],mt.prototype,"personCardInteraction",void 0);Zt([E({attribute:"line1-property"}),yt("design:type",String)],mt.prototype,"line1Property",void 0);Zt([E({attribute:"line2-property"}),yt("design:type",String)],mt.prototype,"line2Property",void 0);Zt([E({attribute:"line3-property"}),yt("design:type",String)],mt.prototype,"line3Property",void 0);Zt([E({attribute:"line4-property"}),yt("design:type",String)],mt.prototype,"line4Property",void 0);Zt([E({converter:r=>!r||r.length===0?xe.image:(r=r.toLowerCase(),typeof xe[r]>"u"?xe.image:xe[r])}),yt("design:type",Number)],mt.prototype,"view",void 0);Zt([le(),yt("design:type",String)],mt.prototype,"_fetchedImage",void 0);Zt([le(),yt("design:type",Object)],mt.prototype,"_fetchedPresence",void 0);Zt([le(),yt("design:type",Boolean)],mt.prototype,"_isInvalidImageSrc",void 0);Zt([le(),yt("design:type",Boolean)],mt.prototype,"_personCardShouldRender",void 0);Zt([le(),yt("design:type",Object)],mt.prototype,"_hasLoadedPersonCard",void 0)});l();c();d();l();c();d();l();c();d();var u8=__STORYBOOK_API__,{ActiveTabs:h8,Consumer:p8,ManagerContext:f8,Provider:m8,addons:Yh,combineParameters:g8,controlOrMetaKey:v8,controlOrMetaSymbol:y8,eventMatchesShortcut:b8,eventToShortcut:w8,isMacLike:C8,isShortcutTaken:x8,keyToSymbol:k8,merge:S8,mockChannel:_8,optionOrAltSymbol:T8,shortcutMatchesShortcut:E8,shortcutToHumanString:I8,types:$C,useAddonState:A8,useArgTypes:R8,useArgs:P8,useChannel:$8,useGlobalTypes:O8,useGlobals:M8,useParameter:F8,useSharedState:D8,useStoryPrepared:L8,useStorybookApi:N8,useStorybookState:H8}=__STORYBOOK_API__;l();c();d();l();c();d();l();c();d();l();c();d();var OC=(()=>{let r;return typeof window<"u"?r=window:typeof globalThis<"u"?r=globalThis:typeof window<"u"?r=window:typeof self<"u"?r=self:r={},r})();l();c();d();var W8=__STORYBOOK_CLIENT_LOGGER__,{deprecate:Q8,logger:MC,once:Y8,pretty:Z8}=__STORYBOOK_CLIENT_LOGGER__;function ac(){return ac=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ac.apply(this,arguments)}function A6(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function $d(r,e){return $d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},$d(r,e)}function R6(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,$d(r,e)}function bv(r){return bv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bv(r)}function P6(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function $6(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zh(r,e,t){return $6()?Zh=Reflect.construct.bind():Zh=function(o,i,n){var s=[null];s.push.apply(s,i);var a=Function.bind.apply(o,s),u=new a;return n&&$d(u,n.prototype),u},Zh.apply(null,arguments)}function wv(r){var e=typeof Map=="function"?new Map:void 0;return wv=function(t){if(t===null||!P6(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return Zh(t,arguments,bv(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),$d(o,t)},wv(r)}var O6={1:`Passed invalid arguments to hsl, please pass multiple numbers e.g. hsl(360, 0.75, 0.4) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75 }).

`,2:`Passed invalid arguments to hsla, please pass multiple numbers e.g. hsla(360, 0.75, 0.4, 0.7) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75, alpha: 0.7 }).

`,3:`Passed an incorrect argument to a color function, please pass a string representation of a color.

`,4:`Couldn't generate valid rgb string from %s, it returned %s.

`,5:`Couldn't parse the color string. Please provide the color as a string in hex, rgb, rgba, hsl or hsla notation.

`,6:`Passed invalid arguments to rgb, please pass multiple numbers e.g. rgb(255, 205, 100) or an object e.g. rgb({ red: 255, green: 205, blue: 100 }).

`,7:`Passed invalid arguments to rgba, please pass multiple numbers e.g. rgb(255, 205, 100, 0.75) or an object e.g. rgb({ red: 255, green: 205, blue: 100, alpha: 0.75 }).

`,8:`Passed invalid argument to toColorString, please pass a RgbColor, RgbaColor, HslColor or HslaColor object.

`,9:`Please provide a number of steps to the modularScale helper.

`,10:`Please pass a number or one of the predefined scales to the modularScale helper as the ratio.

`,11:`Invalid value passed as base to modularScale, expected number or em string but got "%s"

`,12:`Expected a string ending in "px" or a number passed as the first argument to %s(), got "%s" instead.

`,13:`Expected a string ending in "px" or a number passed as the second argument to %s(), got "%s" instead.

`,14:`Passed invalid pixel value ("%s") to %s(), please pass a value like "12px" or 12.

`,15:`Passed invalid base value ("%s") to %s(), please pass a value like "12px" or 12.

`,16:`You must provide a template to this method.

`,17:`You passed an unsupported selector state to this method.

`,18:`minScreen and maxScreen must be provided as stringified numbers with the same units.

`,19:`fromSize and toSize must be provided as stringified numbers with the same units.

`,20:`expects either an array of objects or a single object with the properties prop, fromSize, and toSize.

`,21:"expects the objects in the first argument array to have the properties `prop`, `fromSize`, and `toSize`.\n\n",22:"expects the first argument object to have the properties `prop`, `fromSize`, and `toSize`.\n\n",23:`fontFace expects a name of a font-family.

`,24:`fontFace expects either the path to the font file(s) or a name of a local copy.

`,25:`fontFace expects localFonts to be an array.

`,26:`fontFace expects fileFormats to be an array.

`,27:`radialGradient requries at least 2 color-stops to properly render.

`,28:`Please supply a filename to retinaImage() as the first argument.

`,29:`Passed invalid argument to triangle, please pass correct pointingDirection e.g. 'right'.

`,30:"Passed an invalid value to `height` or `width`. Please provide a pixel based unit.\n\n",31:`The animation shorthand only takes 8 arguments. See the specification for more information: http://mdn.io/animation

`,32:`To pass multiple animations please supply them in arrays, e.g. animation(['rotate', '2s'], ['move', '1s'])
To pass a single animation please supply them in simple values, e.g. animation('rotate', '2s')

`,33:`The animation shorthand arrays can only have 8 elements. See the specification for more information: http://mdn.io/animation

`,34:`borderRadius expects a radius value as a string or number as the second argument.

`,35:`borderRadius expects one of "top", "bottom", "left" or "right" as the first argument.

`,36:`Property must be a string value.

`,37:`Syntax Error at %s.

`,38:`Formula contains a function that needs parentheses at %s.

`,39:`Formula is missing closing parenthesis at %s.

`,40:`Formula has too many closing parentheses at %s.

`,41:`All values in a formula must have the same unit or be unitless.

`,42:`Please provide a number of steps to the modularScale helper.

`,43:`Please pass a number or one of the predefined scales to the modularScale helper as the ratio.

`,44:`Invalid value passed as base to modularScale, expected number or em/rem string but got %s.

`,45:`Passed invalid argument to hslToColorString, please pass a HslColor or HslaColor object.

`,46:`Passed invalid argument to rgbToColorString, please pass a RgbColor or RgbaColor object.

`,47:`minScreen and maxScreen must be provided as stringified numbers with the same units.

`,48:`fromSize and toSize must be provided as stringified numbers with the same units.

`,49:`Expects either an array of objects or a single object with the properties prop, fromSize, and toSize.

`,50:`Expects the objects in the first argument array to have the properties prop, fromSize, and toSize.

`,51:`Expects the first argument object to have the properties prop, fromSize, and toSize.

`,52:`fontFace expects either the path to the font file(s) or a name of a local copy.

`,53:`fontFace expects localFonts to be an array.

`,54:`fontFace expects fileFormats to be an array.

`,55:`fontFace expects a name of a font-family.

`,56:`linearGradient requries at least 2 color-stops to properly render.

`,57:`radialGradient requries at least 2 color-stops to properly render.

`,58:`Please supply a filename to retinaImage() as the first argument.

`,59:`Passed invalid argument to triangle, please pass correct pointingDirection e.g. 'right'.

`,60:"Passed an invalid value to `height` or `width`. Please provide a pixel based unit.\n\n",61:`Property must be a string value.

`,62:`borderRadius expects a radius value as a string or number as the second argument.

`,63:`borderRadius expects one of "top", "bottom", "left" or "right" as the first argument.

`,64:`The animation shorthand only takes 8 arguments. See the specification for more information: http://mdn.io/animation.

`,65:`To pass multiple animations please supply them in arrays, e.g. animation(['rotate', '2s'], ['move', '1s'])\\nTo pass a single animation please supply them in simple values, e.g. animation('rotate', '2s').

`,66:`The animation shorthand arrays can only have 8 elements. See the specification for more information: http://mdn.io/animation.

`,67:`You must provide a template to this method.

`,68:`You passed an unsupported selector state to this method.

`,69:`Expected a string ending in "px" or a number passed as the first argument to %s(), got %s instead.

`,70:`Expected a string ending in "px" or a number passed as the second argument to %s(), got %s instead.

`,71:`Passed invalid pixel value %s to %s(), please pass a value like "12px" or 12.

`,72:`Passed invalid base value %s to %s(), please pass a value like "12px" or 12.

`,73:`Please provide a valid CSS variable.

`,74:`CSS variable not found and no default was provided.

`,75:`important requires a valid style object, got a %s instead.

`,76:`fromSize and toSize must be provided as stringified numbers with the same units as minScreen and maxScreen.

`,77:`remToPx expects a value in "rem" but you provided it in "%s".

`,78:`base must be set in "px" or "%" but you set it in "%s".
`};function M6(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var o=e[0],i=[],n;for(n=1;n<e.length;n+=1)i.push(e[n]);return i.forEach(function(s){o=o.replace(/%[a-z]/,s)}),o}var En=function(r){R6(e,r);function e(t){for(var o,i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];return o=r.call(this,M6.apply(void 0,[O6[t]].concat(n)))||this,A6(o)}return e}(wv(Error));function fv(r){return Math.round(r*255)}function F6(r,e,t){return fv(r)+","+fv(e)+","+fv(t)}function Od(r,e,t,o){if(o===void 0&&(o=F6),e===0)return o(t,t,t);var i=(r%360+360)%360/60,n=(1-Math.abs(2*t-1))*e,s=n*(1-Math.abs(i%2-1)),a=0,u=0,h=0;i>=0&&i<1?(a=n,u=s):i>=1&&i<2?(a=s,u=n):i>=2&&i<3?(u=n,h=s):i>=3&&i<4?(u=s,h=n):i>=4&&i<5?(a=s,h=n):i>=5&&i<6&&(a=n,h=s);var p=t-n/2,f=a+p,b=u+p,x=h+p;return o(f,b,x)}var FC={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function D6(r){if(typeof r!="string")return r;var e=r.toLowerCase();return FC[e]?"#"+FC[e]:r}var L6=/^#[a-fA-F0-9]{6}$/,N6=/^#[a-fA-F0-9]{8}$/,H6=/^#[a-fA-F0-9]{3}$/,U6=/^#[a-fA-F0-9]{4}$/,mv=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,B6=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,z6=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,V6=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function tp(r){if(typeof r!="string")throw new En(3);var e=D6(r);if(e.match(L6))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(N6)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(H6))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(U6)){var o=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:o}}var i=mv.exec(e);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var n=B6.exec(e.substring(0,50));if(n)return{red:parseInt(""+n[1],10),green:parseInt(""+n[2],10),blue:parseInt(""+n[3],10),alpha:parseFloat(""+n[4])>1?parseFloat(""+n[4])/100:parseFloat(""+n[4])};var s=z6.exec(e);if(s){var a=parseInt(""+s[1],10),u=parseInt(""+s[2],10)/100,h=parseInt(""+s[3],10)/100,p="rgb("+Od(a,u,h)+")",f=mv.exec(p);if(!f)throw new En(4,e,p);return{red:parseInt(""+f[1],10),green:parseInt(""+f[2],10),blue:parseInt(""+f[3],10)}}var b=V6.exec(e.substring(0,50));if(b){var x=parseInt(""+b[1],10),S=parseInt(""+b[2],10)/100,R=parseInt(""+b[3],10)/100,z="rgb("+Od(x,S,R)+")",we=mv.exec(z);if(!we)throw new En(4,e,z);return{red:parseInt(""+we[1],10),green:parseInt(""+we[2],10),blue:parseInt(""+we[3],10),alpha:parseFloat(""+b[4])>1?parseFloat(""+b[4])/100:parseFloat(""+b[4])}}throw new En(5)}function q6(r){var e=r.red/255,t=r.green/255,o=r.blue/255,i=Math.max(e,t,o),n=Math.min(e,t,o),s=(i+n)/2;if(i===n)return r.alpha!==void 0?{hue:0,saturation:0,lightness:s,alpha:r.alpha}:{hue:0,saturation:0,lightness:s};var a,u=i-n,h=s>.5?u/(2-i-n):u/(i+n);switch(i){case e:a=(t-o)/u+(t<o?6:0);break;case t:a=(o-e)/u+2;break;default:a=(e-t)/u+4;break}return a*=60,r.alpha!==void 0?{hue:a,saturation:h,lightness:s,alpha:r.alpha}:{hue:a,saturation:h,lightness:s}}function NC(r){return q6(tp(r))}var G6=function(r){return r.length===7&&r[1]===r[2]&&r[3]===r[4]&&r[5]===r[6]?"#"+r[1]+r[3]+r[5]:r},Cv=G6;function Wa(r){var e=r.toString(16);return e.length===1?"0"+e:e}function gv(r){return Wa(Math.round(r*255))}function j6(r,e,t){return Cv("#"+gv(r)+gv(e)+gv(t))}function Xh(r,e,t){return Od(r,e,t,j6)}function K6(r,e,t){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number")return Xh(r,e,t);if(typeof r=="object"&&e===void 0&&t===void 0)return Xh(r.hue,r.saturation,r.lightness);throw new En(1)}function W6(r,e,t,o){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number"&&typeof o=="number")return o>=1?Xh(r,e,t):"rgba("+Od(r,e,t)+","+o+")";if(typeof r=="object"&&e===void 0&&t===void 0&&o===void 0)return r.alpha>=1?Xh(r.hue,r.saturation,r.lightness):"rgba("+Od(r.hue,r.saturation,r.lightness)+","+r.alpha+")";throw new En(2)}function xv(r,e,t){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number")return Cv("#"+Wa(r)+Wa(e)+Wa(t));if(typeof r=="object"&&e===void 0&&t===void 0)return Cv("#"+Wa(r.red)+Wa(r.green)+Wa(r.blue));throw new En(6)}function Md(r,e,t,o){if(typeof r=="string"&&typeof e=="number"){var i=tp(r);return"rgba("+i.red+","+i.green+","+i.blue+","+e+")"}else{if(typeof r=="number"&&typeof e=="number"&&typeof t=="number"&&typeof o=="number")return o>=1?xv(r,e,t):"rgba("+r+","+e+","+t+","+o+")";if(typeof r=="object"&&e===void 0&&t===void 0&&o===void 0)return r.alpha>=1?xv(r.red,r.green,r.blue):"rgba("+r.red+","+r.green+","+r.blue+","+r.alpha+")"}throw new En(7)}var Q6=function(r){return typeof r.red=="number"&&typeof r.green=="number"&&typeof r.blue=="number"&&(typeof r.alpha!="number"||typeof r.alpha>"u")},Y6=function(r){return typeof r.red=="number"&&typeof r.green=="number"&&typeof r.blue=="number"&&typeof r.alpha=="number"},Z6=function(r){return typeof r.hue=="number"&&typeof r.saturation=="number"&&typeof r.lightness=="number"&&(typeof r.alpha!="number"||typeof r.alpha>"u")},J6=function(r){return typeof r.hue=="number"&&typeof r.saturation=="number"&&typeof r.lightness=="number"&&typeof r.alpha=="number"};function HC(r){if(typeof r!="object")throw new En(8);if(Y6(r))return Md(r);if(Q6(r))return xv(r);if(J6(r))return W6(r);if(Z6(r))return K6(r);throw new En(8)}function UC(r,e,t){return function(){var o=t.concat(Array.prototype.slice.call(arguments));return o.length>=e?r.apply(this,o):UC(r,e,o)}}function rp(r){return UC(r,r.length,[])}function op(r,e,t){return Math.max(r,Math.min(e,t))}function X6(r,e){if(e==="transparent")return e;var t=NC(e);return HC(ac({},t,{lightness:op(0,1,t.lightness-parseFloat(r))}))}var e$=rp(X6),t$=e$;function r$(r,e){if(e==="transparent")return e;var t=NC(e);return HC(ac({},t,{lightness:op(0,1,t.lightness+parseFloat(r))}))}var o$=rp(r$),i$=o$;function n$(r,e){if(e==="transparent")return e;var t=tp(e),o=typeof t.alpha=="number"?t.alpha:1,i=ac({},t,{alpha:op(0,1,(o*100+parseFloat(r)*100)/100)});return Md(i)}var iF=rp(n$);function s$(r,e){if(e==="transparent")return e;var t=tp(e),o=typeof t.alpha=="number"?t.alpha:1,i=ac({},t,{alpha:op(0,1,+(o*100-parseFloat(r)*100).toFixed(2)/100)});return Md(i)}var a$=rp(s$),l$=a$,Jt={primary:"#FF4785",secondary:"#029CFD",tertiary:"#FAFBFC",ancillary:"#22a699",orange:"#FC521F",gold:"#FFAE00",green:"#66BF3C",seafoam:"#37D5D3",purple:"#6F2CAC",ultraviolet:"#2A0481",lightest:"#FFFFFF",lighter:"#F7FAFC",light:"#EEF3F6",mediumlight:"#ECF4F9",medium:"#D9E8F2",mediumdark:"#73828C",dark:"#5C6870",darker:"#454E54",darkest:"#2E3438",border:"hsla(203, 50%, 30%, 0.15)",positive:"#66BF3C",negative:"#FF4400",warning:"#E69D00",critical:"#FFFFFF",defaultText:"#2E3438",inverseText:"#FFFFFF",positiveText:"#448028",negativeText:"#D43900",warningText:"#A15C20"},DC={app:"#F6F9FC",bar:Jt.lightest,content:Jt.lightest,preview:Jt.lightest,gridCellSize:10,hoverable:l$(.9,Jt.secondary),positive:"#E1FFD4",negative:"#FEDED2",warning:"#FFF5CF",critical:"#FF4400"},ep={fonts:{base:['"Nunito Sans"',"-apple-system",'".SFNSText-Regular"','"San Francisco"',"BlinkMacSystemFont",'"Segoe UI"','"Helvetica Neue"',"Helvetica","Arial","sans-serif"].join(", "),mono:["ui-monospace","Menlo","Monaco",'"Roboto Mono"','"Oxygen Mono"','"Ubuntu Monospace"','"Source Code Pro"','"Droid Sans Mono"','"Courier New"',"monospace"].join(", ")},weight:{regular:400,bold:700},size:{s1:12,s2:14,s3:16,m1:20,m2:24,m3:28,l1:32,l2:40,l3:48,code:90}},c$={base:"light",colorPrimary:"#FF4785",colorSecondary:"#029CFD",appBg:DC.app,appContentBg:Jt.lightest,appPreviewBg:Jt.lightest,appBorderColor:Jt.border,appBorderRadius:4,fontBase:ep.fonts.base,fontCode:ep.fonts.mono,textColor:Jt.darkest,textInverseColor:Jt.lightest,textMutedColor:Jt.dark,barTextColor:Jt.mediumdark,barHoverColor:Jt.secondary,barSelectedColor:Jt.secondary,barBg:Jt.lightest,buttonBg:DC.app,buttonBorder:Jt.medium,booleanBg:Jt.mediumlight,booleanSelectedBg:Jt.lightest,inputBg:Jt.lightest,inputBorder:Jt.border,inputTextColor:Jt.darkest,inputBorderRadius:4},LC=c$,d$={base:"dark",colorPrimary:"#FF4785",colorSecondary:"#029CFD",appBg:"#222425",appContentBg:"#1B1C1D",appPreviewBg:Jt.lightest,appBorderColor:"rgba(255,255,255,.1)",appBorderRadius:4,fontBase:ep.fonts.base,fontCode:ep.fonts.mono,textColor:"#C9CDCF",textInverseColor:"#222425",textMutedColor:"#798186",barTextColor:"#798186",barHoverColor:Jt.secondary,barSelectedColor:Jt.secondary,barBg:"#292C2E",buttonBg:"#222425",buttonBorder:"rgba(255,255,255,.1)",booleanBg:"#222425",booleanSelectedBg:"#2E3438",inputBg:"#1B1C1D",inputBorder:"rgba(255,255,255,.1)",inputTextColor:Jt.lightest,inputBorderRadius:4},u$=d$,{window:vv}=OC;var h$=r=>typeof r!="string"?(MC.warn(`Color passed to theme object should be a string. Instead ${r}(${typeof r}) was passed.`),!1):!0,p$=r=>!/(gradient|var|calc)/.test(r),f$=(r,e)=>r==="darken"?Md(`${t$(1,e)}`,.95):r==="lighten"?Md(`${i$(1,e)}`,.95):e,BC=r=>e=>{if(!h$(e)||!p$(e))return e;try{return f$(r,e)}catch{return e}},nF=BC("lighten"),sF=BC("darken"),m$=()=>!vv||!vv.matchMedia?"light":vv.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",Jh={light:LC,dark:u$,normal:LC},yv=m$(),kv=(r={base:yv},e)=>{let t={...Jh[yv],...Jh[r.base]||{},...r,base:Jh[r.base]?r.base:yv};return{...e,...t,barSelectedColor:r.barSelectedColor||t.colorSecondary}};var zC=kv({base:"light",colorSecondary:"#0360B9",textColor:"#1A1A1A",textInverseColor:"rgba(255,255,255,0.9)",barTextColor:"#717171",brandTitle:"Microsoft Graph Toolkit Playground",brandUrl:"https://aka.ms/mgt"});l();c();d();var Pr=__REACT__,{Children:CF,Component:VC,Fragment:xF,Profiler:kF,PureComponent:SF,StrictMode:_F,Suspense:TF,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:EF,cloneElement:IF,createContext:AF,createElement:RF,createFactory:PF,createRef:$F,forwardRef:OF,isValidElement:MF,lazy:FF,memo:DF,useCallback:LF,useContext:NF,useDebugValue:HF,useEffect:UF,useImperativeHandle:BF,useLayoutEffect:zF,useMemo:VF,useReducer:qF,useRef:GF,useState:qC,version:jF}=__REACT__;l();c();d();var ZF=__STORYBOOK_API__,{ActiveTabs:JF,Consumer:XF,ManagerContext:eD,Provider:tD,addons:rD,combineParameters:oD,controlOrMetaKey:iD,controlOrMetaSymbol:nD,eventMatchesShortcut:sD,eventToShortcut:aD,isMacLike:lD,isShortcutTaken:cD,keyToSymbol:dD,merge:uD,mockChannel:hD,optionOrAltSymbol:pD,shortcutMatchesShortcut:fD,shortcutToHumanString:mD,types:gD,useAddonState:vD,useArgTypes:yD,useArgs:bD,useChannel:GC,useGlobalTypes:wD,useGlobals:CD,useParameter:xD,useSharedState:kD,useStoryPrepared:SD,useStorybookApi:_D,useStorybookState:TD}=__STORYBOOK_API__;Ya();Ws();l();c();d();ue();l();c();d();l();c();d();l();c();d();l();c();d();var p0=function(r,e){return p0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])},p0(r,e)};function gt(r,e){p0(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ne=function(){return ne=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},ne.apply(this,arguments)};function f0(r,e){var t={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(r);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(r,o[i])&&(t[o[i]]=r[o[i]]);return t}function F(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})}function D(r,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(p){return u([h,p])}}function u(h){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,i&&(n=h[0]&2?i.return:h[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,h[1])).done)return n;switch(i=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,i=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(r,t)}catch(p){h=[6,p],i=0}finally{o=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Z$(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var o=t.call(r),i,n=[],s;try{for(;(e===void 0||e-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(s)throw s.error}}return n}function bc(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Z$(arguments[e]));return r}l();c();d();l();c();d();l();c();d();var m0=function(r,e){return m0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])},m0(r,e)};function at(r,e){m0(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var nt=function(){return nt=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},nt.apply(this,arguments)};function se(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})}function ae(r,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(p){return u([h,p])}}function u(h){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,i&&(n=h[0]&2?i.return:h[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,h[1])).done)return n;switch(i=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,i=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(r,t)}catch(p){h=[6,p],i=0}finally{o=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function ea(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var o=Array(r),i=0,e=0;e<t;e++)for(var n=arguments[e],s=0,a=n.length;s<a;s++,i++)o[i]=n[s];return o}l();c();d();l();c();d();l();c();d();l();c();d();l();c();d();var _={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},an=[_.OPENID_SCOPE,_.PROFILE_SCOPE,_.OFFLINE_ACCESS_SCOPE],g0=ea(an,[_.EMAIL_SCOPE]),Lt;(function(r){r.CONTENT_TYPE="Content-Type",r.RETRY_AFTER="Retry-After",r.CCS_HEADER="X-AnchorMailbox",r.WWWAuthenticate="WWW-Authenticate",r.AuthenticationInfo="Authentication-Info",r.X_MS_REQUEST_ID="x-ms-request-id",r.X_MS_HTTP_VERSION="x-ms-httpver"})(Lt||(Lt={}));var mr;(function(r){r.ID_TOKEN="idtoken",r.CLIENT_INFO="client.info",r.ADAL_ID_TOKEN="adal.idtoken",r.ERROR="error",r.ERROR_DESC="error.description",r.ACTIVE_ACCOUNT="active-account",r.ACTIVE_ACCOUNT_FILTERS="active-account-filters"})(mr||(mr={}));var hs;(function(r){r.COMMON="common",r.ORGANIZATIONS="organizations",r.CONSUMERS="consumers"})(hs||(hs={}));var He;(function(r){r.CLIENT_ID="client_id",r.REDIRECT_URI="redirect_uri",r.RESPONSE_TYPE="response_type",r.RESPONSE_MODE="response_mode",r.GRANT_TYPE="grant_type",r.CLAIMS="claims",r.SCOPE="scope",r.ERROR="error",r.ERROR_DESCRIPTION="error_description",r.ACCESS_TOKEN="access_token",r.ID_TOKEN="id_token",r.REFRESH_TOKEN="refresh_token",r.EXPIRES_IN="expires_in",r.STATE="state",r.NONCE="nonce",r.PROMPT="prompt",r.SESSION_STATE="session_state",r.CLIENT_INFO="client_info",r.CODE="code",r.CODE_CHALLENGE="code_challenge",r.CODE_CHALLENGE_METHOD="code_challenge_method",r.CODE_VERIFIER="code_verifier",r.CLIENT_REQUEST_ID="client-request-id",r.X_CLIENT_SKU="x-client-SKU",r.X_CLIENT_VER="x-client-VER",r.X_CLIENT_OS="x-client-OS",r.X_CLIENT_CPU="x-client-CPU",r.X_CLIENT_CURR_TELEM="x-client-current-telemetry",r.X_CLIENT_LAST_TELEM="x-client-last-telemetry",r.X_MS_LIB_CAPABILITY="x-ms-lib-capability",r.X_APP_NAME="x-app-name",r.X_APP_VER="x-app-ver",r.POST_LOGOUT_URI="post_logout_redirect_uri",r.ID_TOKEN_HINT="id_token_hint",r.DEVICE_CODE="device_code",r.CLIENT_SECRET="client_secret",r.CLIENT_ASSERTION="client_assertion",r.CLIENT_ASSERTION_TYPE="client_assertion_type",r.TOKEN_TYPE="token_type",r.REQ_CNF="req_cnf",r.OBO_ASSERTION="assertion",r.REQUESTED_TOKEN_USE="requested_token_use",r.ON_BEHALF_OF="on_behalf_of",r.FOCI="foci",r.CCS_HEADER="X-AnchorMailbox",r.RETURN_SPA_CODE="return_spa_code",r.NATIVE_BROKER="nativebroker",r.LOGOUT_HINT="logout_hint"})(He||(He={}));var ta;(function(r){r.ACCESS_TOKEN="access_token",r.XMS_CC="xms_cc"})(ta||(ta={}));var ar={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},hl;(function(r){r.ACCOUNT="account",r.SID="sid",r.LOGIN_HINT="login_hint",r.ID_TOKEN="id_token",r.DOMAIN_HINT="domain_hint",r.ORGANIZATIONS="organizations",r.CONSUMERS="consumers",r.ACCOUNT_ID="accountIdentifier",r.HOMEACCOUNT_ID="homeAccountIdentifier"})(hl||(hl={}));var Yp={PLAIN:"plain",S256:"S256"},pl;(function(r){r.QUERY="query",r.FRAGMENT="fragment",r.FORM_POST="form_post"})(pl||(pl={}));var jo;(function(r){r.IMPLICIT_GRANT="implicit",r.AUTHORIZATION_CODE_GRANT="authorization_code",r.CLIENT_CREDENTIALS_GRANT="client_credentials",r.RESOURCE_OWNER_PASSWORD_GRANT="password",r.REFRESH_TOKEN_GRANT="refresh_token",r.DEVICE_CODE_GRANT="device_code",r.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"})(jo||(jo={}));var sn;(function(r){r.MSSTS_ACCOUNT_TYPE="MSSTS",r.ADFS_ACCOUNT_TYPE="ADFS",r.MSAV1_ACCOUNT_TYPE="MSA",r.GENERIC_ACCOUNT_TYPE="Generic"})(sn||(sn={}));var Nt;(function(r){r.CACHE_KEY_SEPARATOR="-",r.CLIENT_INFO_SEPARATOR="."})(Nt||(Nt={}));var he;(function(r){r.ID_TOKEN="IdToken",r.ACCESS_TOKEN="AccessToken",r.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",r.REFRESH_TOKEN="RefreshToken"})(he||(he={}));var _i;(function(r){r[r.ADFS=1001]="ADFS",r[r.MSA=1002]="MSA",r[r.MSSTS=1003]="MSSTS",r[r.GENERIC=1004]="GENERIC",r[r.ACCESS_TOKEN=2001]="ACCESS_TOKEN",r[r.REFRESH_TOKEN=2002]="REFRESH_TOKEN",r[r.ID_TOKEN=2003]="ID_TOKEN",r[r.APP_METADATA=3001]="APP_METADATA",r[r.UNDEFINED=9999]="UNDEFINED"})(_i||(_i={}));var cu="appmetadata",Ak="client_info",ra="1",ml={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},di;(function(r){r.CONFIG="config",r.CACHE="cache",r.NETWORK="network",r.HARDCODED_VALUES="hardcoded_values"})(di||(di={}));var $r={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ze;(function(r){r.BEARER="Bearer",r.POP="pop",r.SSH="ssh-cert"})(ze||(ze={}));var fs={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Zp={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},wc;(function(r){r.username="username",r.password="password"})(wc||(wc={}));var fl;(function(r){r[r.httpSuccess=200]="httpSuccess",r[r.httpBadRequest=400]="httpBadRequest"})(fl||(fl={}));var ps;(function(r){r.FAILED_AUTO_DETECTION="1",r.INTERNAL_CACHE="2",r.ENVIRONMENT_VARIABLE="3",r.IMDS="4"})(ps||(ps={}));var Cc;(function(r){r.CONFIGURED_MATCHES_DETECTED="1",r.CONFIGURED_NO_AUTO_DETECTION="2",r.CONFIGURED_NOT_DETECTED="3",r.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",r.AUTO_DETECTION_REQUESTED_FAILED="5"})(Cc||(Cc={}));var wo;(function(r){r.NO_CACHE_HIT="0",r.FORCE_REFRESH="1",r.NO_CACHED_ACCESS_TOKEN="2",r.CACHED_ACCESS_TOKEN_EXPIRED="3",r.REFRESH_CACHED_ACCESS_TOKEN="4",r.CLAIMS_REQUESTED_CACHE_SKIPPED="5"})(wo||(wo={}));var Qp;(function(r){r.Jwt="JWT",r.Jwk="JWK",r.Pop="pop"})(Qp||(Qp={}));var xc={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}},X=function(r){at(e,r);function e(t,o,i){var n=this,s=o?t+": "+o:t;return n=r.call(this,s)||this,Object.setPrototypeOf(n,e.prototype),n.errorCode=t||_.EMPTY_STRING,n.errorMessage=o||_.EMPTY_STRING,n.subError=i||_.EMPTY_STRING,n.name="AuthError",n}return e.prototype.setCorrelationId=function(t){this.correlationId=t},e.createUnexpectedError=function(t){return new e(xc.unexpectedError.code,xc.unexpectedError.desc+": "+t)},e.createPostRequestFailed=function(t){return new e(xc.postRequestFailed.code,xc.postRequestFailed.desc+": "+t)},e}(Error);var oa={createNewGuid:function(){var r="Crypto interface - createNewGuid() has not been implemented";throw X.createUnexpectedError(r)},base64Decode:function(){var r="Crypto interface - base64Decode() has not been implemented";throw X.createUnexpectedError(r)},base64Encode:function(){var r="Crypto interface - base64Encode() has not been implemented";throw X.createUnexpectedError(r)},generatePkceCodes:function(){return se(this,void 0,void 0,function(){var r;return ae(this,function(e){throw r="Crypto interface - generatePkceCodes() has not been implemented",X.createUnexpectedError(r)})})},getPublicKeyThumbprint:function(){return se(this,void 0,void 0,function(){var r;return ae(this,function(e){throw r="Crypto interface - getPublicKeyThumbprint() has not been implemented",X.createUnexpectedError(r)})})},removeTokenBindingKey:function(){return se(this,void 0,void 0,function(){var r;return ae(this,function(e){throw r="Crypto interface - removeTokenBindingKey() has not been implemented",X.createUnexpectedError(r)})})},clearKeystore:function(){return se(this,void 0,void 0,function(){var r;return ae(this,function(e){throw r="Crypto interface - clearKeystore() has not been implemented",X.createUnexpectedError(r)})})},signJwt:function(){return se(this,void 0,void 0,function(){var r;return ae(this,function(e){throw r="Crypto interface - signJwt() has not been implemented",X.createUnexpectedError(r)})})},hashString:function(){return se(this,void 0,void 0,function(){var r;return ae(this,function(e){throw r="Crypto interface - hashString() has not been implemented",X.createUnexpectedError(r)})})}};l();c();d();l();c();d();l();c();d();var j={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},authTimeNotFoundError:{code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},maxAgeTranspiredError:{code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},userCanceledError:{code:"user_canceled",desc:"User canceled the flow."}},H=function(r){at(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,e.prototype),i}return e.createClientInfoDecodingError=function(t){return new e(j.clientInfoDecodingError.code,j.clientInfoDecodingError.desc+" Failed with error: "+t)},e.createClientInfoEmptyError=function(){return new e(j.clientInfoEmptyError.code,""+j.clientInfoEmptyError.desc)},e.createTokenParsingError=function(t){return new e(j.tokenParsingError.code,j.tokenParsingError.desc+" Failed with error: "+t)},e.createTokenNullOrEmptyError=function(t){return new e(j.nullOrEmptyToken.code,j.nullOrEmptyToken.desc+" Raw Token Value: "+t)},e.createEndpointDiscoveryIncompleteError=function(t){return new e(j.endpointResolutionError.code,j.endpointResolutionError.desc+" Detail: "+t)},e.createNetworkError=function(t,o){return new e(j.networkError.code,j.networkError.desc+" | Fetch client threw: "+o+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToGetOpenidConfigError=function(t){return new e(j.unableToGetOpenidConfigError.code,j.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+t)},e.createHashNotDeserializedError=function(t){return new e(j.hashNotDeserialized.code,j.hashNotDeserialized.desc+" Given Object: "+t)},e.createInvalidStateError=function(t,o){return new e(j.invalidStateError.code,j.invalidStateError.desc+" Invalid State: "+t+", Root Err: "+o)},e.createStateMismatchError=function(){return new e(j.stateMismatchError.code,j.stateMismatchError.desc)},e.createStateNotFoundError=function(t){return new e(j.stateNotFoundError.code,j.stateNotFoundError.desc+":  "+t)},e.createNonceMismatchError=function(){return new e(j.nonceMismatchError.code,j.nonceMismatchError.desc)},e.createAuthTimeNotFoundError=function(){return new e(j.authTimeNotFoundError.code,j.authTimeNotFoundError.desc)},e.createMaxAgeTranspiredError=function(){return new e(j.maxAgeTranspiredError.code,j.maxAgeTranspiredError.desc)},e.createNonceNotFoundError=function(t){return new e(j.nonceNotFoundError.code,j.nonceNotFoundError.desc+":  "+t)},e.createMultipleMatchingTokensInCacheError=function(){return new e(j.multipleMatchingTokens.code,j.multipleMatchingTokens.desc+".")},e.createMultipleMatchingAccountsInCacheError=function(){return new e(j.multipleMatchingAccounts.code,j.multipleMatchingAccounts.desc)},e.createMultipleMatchingAppMetadataInCacheError=function(){return new e(j.multipleMatchingAppMetadata.code,j.multipleMatchingAppMetadata.desc)},e.createTokenRequestCannotBeMadeError=function(){return new e(j.tokenRequestCannotBeMade.code,j.tokenRequestCannotBeMade.desc)},e.createAppendEmptyScopeToSetError=function(t){return new e(j.appendEmptyScopeError.code,j.appendEmptyScopeError.desc+" Given Scope: "+t)},e.createRemoveEmptyScopeFromSetError=function(t){return new e(j.removeEmptyScopeError.code,j.removeEmptyScopeError.desc+" Given Scope: "+t)},e.createAppendScopeSetError=function(t){return new e(j.appendScopeSetError.code,j.appendScopeSetError.desc+" Detail Error: "+t)},e.createEmptyInputScopeSetError=function(){return new e(j.emptyInputScopeSetError.code,""+j.emptyInputScopeSetError.desc)},e.createDeviceCodeCancelledError=function(){return new e(j.DeviceCodePollingCancelled.code,""+j.DeviceCodePollingCancelled.desc)},e.createDeviceCodeExpiredError=function(){return new e(j.DeviceCodeExpired.code,""+j.DeviceCodeExpired.desc)},e.createDeviceCodeUnknownError=function(){return new e(j.DeviceCodeUnknownError.code,""+j.DeviceCodeUnknownError.desc)},e.createNoAccountInSilentRequestError=function(){return new e(j.NoAccountInSilentRequest.code,""+j.NoAccountInSilentRequest.desc)},e.createNullOrUndefinedCacheRecord=function(){return new e(j.invalidCacheRecord.code,j.invalidCacheRecord.desc)},e.createInvalidCacheEnvironmentError=function(){return new e(j.invalidCacheEnvironment.code,j.invalidCacheEnvironment.desc)},e.createNoAccountFoundError=function(){return new e(j.noAccountFound.code,j.noAccountFound.desc)},e.createCachePluginError=function(){return new e(j.CachePluginError.code,""+j.CachePluginError.desc)},e.createNoCryptoObjectError=function(t){return new e(j.noCryptoObj.code,""+j.noCryptoObj.desc+t)},e.createInvalidCacheTypeError=function(){return new e(j.invalidCacheType.code,""+j.invalidCacheType.desc)},e.createUnexpectedAccountTypeError=function(){return new e(j.unexpectedAccountType.code,""+j.unexpectedAccountType.desc)},e.createUnexpectedCredentialTypeError=function(){return new e(j.unexpectedCredentialType.code,""+j.unexpectedCredentialType.desc)},e.createInvalidAssertionError=function(){return new e(j.invalidAssertion.code,""+j.invalidAssertion.desc)},e.createInvalidCredentialError=function(){return new e(j.invalidClientCredential.code,""+j.invalidClientCredential.desc)},e.createRefreshRequiredError=function(){return new e(j.tokenRefreshRequired.code,j.tokenRefreshRequired.desc)},e.createUserTimeoutReachedError=function(){return new e(j.userTimeoutReached.code,j.userTimeoutReached.desc)},e.createTokenClaimsRequiredError=function(){return new e(j.tokenClaimsRequired.code,j.tokenClaimsRequired.desc)},e.createNoAuthCodeInServerResponseError=function(){return new e(j.noAuthorizationCodeFromServer.code,j.noAuthorizationCodeFromServer.desc)},e.createBindingKeyNotRemovedError=function(){return new e(j.bindingKeyNotRemovedError.code,j.bindingKeyNotRemovedError.desc)},e.createLogoutNotSupportedError=function(){return new e(j.logoutNotSupported.code,j.logoutNotSupported.desc)},e.createKeyIdMissingError=function(){return new e(j.keyIdMissing.code,j.keyIdMissing.desc)},e.createNoNetworkConnectivityError=function(){return new e(j.noNetworkConnectivity.code,j.noNetworkConnectivity.desc)},e.createUserCanceledError=function(){return new e(j.userCanceledError.code,j.userCanceledError.desc)},e}(X);var U=function(){function r(){}return r.decodeAuthToken=function(e){if(r.isEmpty(e))throw H.createTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,o=t.exec(e);if(!o||o.length<4)throw H.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));var i={header:o[1],JWSPayload:o[2],JWSSig:o[3]};return i},r.isEmpty=function(e){return typeof e>"u"||!e||e.length===0},r.isEmptyObj=function(e){if(e&&!r.isEmpty(e))try{var t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0},r.startsWith=function(e,t){return e.indexOf(t)===0},r.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},r.queryStringToObject=function(e){var t={},o=e.split("&"),i=function(n){return decodeURIComponent(n.replace(/\+/g," "))};return o.forEach(function(n){if(n.trim()){var s=n.split(/=(.+)/g,2),a=s[0],u=s[1];a&&u&&(t[i(a)]=i(u))}}),t},r.trimArrayEntries=function(e){return e.map(function(t){return t.trim()})},r.removeEmptyStringsFromArray=function(e){return e.filter(function(t){return!r.isEmpty(t)})},r.jsonParseHelper=function(e){try{return JSON.parse(e)}catch{return null}},r.matchPattern=function(e,t){var o=new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?"));return o.test(t)},r}();var lr;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace"})(lr||(lr={}));var $n=function(){function r(e,t,o){this.level=lr.Info;var i=function(){},n=e||r.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||i,this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level=typeof n.logLevel=="number"?n.logLevel:lr.Info,this.correlationId=n.correlationId||_.EMPTY_STRING,this.packageName=t||_.EMPTY_STRING,this.packageVersion=o||_.EMPTY_STRING}return r.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:lr.Info}},r.prototype.clone=function(e,t,o){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:o||this.correlationId},e,t)},r.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var o=new Date().toUTCString(),i;U.isEmpty(t.correlationId)?U.isEmpty(this.correlationId)?i="["+o+"]":i="["+o+"] : ["+this.correlationId+"]":i="["+o+"] : ["+t.correlationId+"]";var n=i+" : "+this.packageName+"@"+this.packageVersion+" : "+lr[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},r.prototype.executeCallback=function(e,t,o){this.localCallback&&this.localCallback(e,t,o)},r.prototype.error=function(e,t){this.logMessage(e,{logLevel:lr.Error,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:lr.Error,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.warning=function(e,t){this.logMessage(e,{logLevel:lr.Warning,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:lr.Warning,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.info=function(e,t){this.logMessage(e,{logLevel:lr.Info,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:lr.Info,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:lr.Verbose,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:lr.Verbose,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.trace=function(e,t){this.logMessage(e,{logLevel:lr.Trace,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:lr.Trace,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},r}();l();c();d();var Jp="@azure/msal-common",gl="13.3.1";l();c();d();var On;(function(r){r[r.None=0]="None",r.AzurePublic="https://login.microsoftonline.com",r.AzurePpe="https://login.windows-ppe.net",r.AzureChina="https://login.chinacloudapi.cn",r.AzureGermany="https://login.microsoftonline.de",r.AzureUsGovernment="https://login.microsoftonline.us"})(On||(On={}));l();c();d();l();c();d();l();c();d();var Be={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"},authorityMismatch:{code:"authority_mismatch",desc:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."}},We=function(r){at(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,e.prototype),i}return e.createRedirectUriEmptyError=function(){return new e(Be.redirectUriNotSet.code,Be.redirectUriNotSet.desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(Be.postLogoutUriNotSet.code,Be.postLogoutUriNotSet.desc)},e.createClaimsRequestParsingError=function(t){return new e(Be.claimsRequestParsingError.code,Be.claimsRequestParsingError.desc+" Given value: "+t)},e.createInsecureAuthorityUriError=function(t){return new e(Be.authorityUriInsecure.code,Be.authorityUriInsecure.desc+" Given URI: "+t)},e.createUrlParseError=function(t){return new e(Be.urlParseError.code,Be.urlParseError.desc+" Given Error: "+t)},e.createUrlEmptyError=function(){return new e(Be.urlEmptyError.code,Be.urlEmptyError.desc)},e.createEmptyScopesArrayError=function(){return new e(Be.emptyScopesError.code,""+Be.emptyScopesError.desc)},e.createClientIdSingleScopeError=function(t){return new e(Be.clientIdSingleScopeError.code,Be.clientIdSingleScopeError.desc+" Given Scopes: "+t)},e.createInvalidPromptError=function(t){return new e(Be.invalidPrompt.code,Be.invalidPrompt.desc+" Given value: "+t)},e.createInvalidClaimsRequestError=function(){return new e(Be.invalidClaimsRequest.code,Be.invalidClaimsRequest.desc)},e.createEmptyLogoutRequestError=function(){return new e(Be.logoutRequestEmptyError.code,Be.logoutRequestEmptyError.desc)},e.createEmptyTokenRequestError=function(){return new e(Be.tokenRequestEmptyError.code,Be.tokenRequestEmptyError.desc)},e.createInvalidCodeChallengeMethodError=function(){return new e(Be.invalidCodeChallengeMethod.code,Be.invalidCodeChallengeMethod.desc)},e.createInvalidCodeChallengeParamsError=function(){return new e(Be.invalidCodeChallengeParams.code,Be.invalidCodeChallengeParams.desc)},e.createInvalidCloudDiscoveryMetadataError=function(){return new e(Be.invalidCloudDiscoveryMetadata.code,Be.invalidCloudDiscoveryMetadata.desc)},e.createInvalidAuthorityMetadataError=function(){return new e(Be.invalidAuthorityMetadata.code,Be.invalidAuthorityMetadata.desc)},e.createUntrustedAuthorityError=function(){return new e(Be.untrustedAuthority.code,Be.untrustedAuthority.desc)},e.createInvalidAzureCloudInstanceError=function(){return new e(Be.invalidAzureCloudInstance.code,Be.invalidAzureCloudInstance.desc)},e.createMissingSshJwkError=function(){return new e(Be.missingSshJwk.code,Be.missingSshJwk.desc)},e.createMissingSshKidError=function(){return new e(Be.missingSshKid.code,Be.missingSshKid.desc)},e.createMissingNonceAuthenticationHeadersError=function(){return new e(Be.missingNonceAuthenticationHeader.code,Be.missingNonceAuthenticationHeader.desc)},e.createInvalidAuthenticationHeaderError=function(t,o){return new e(Be.invalidAuthenticationHeader.code,Be.invalidAuthenticationHeader.desc+". Invalid header: "+t+". Details: "+o)},e.createAuthorityMismatchError=function(){return new e(Be.authorityMismatch.code,Be.authorityMismatch.desc)},e}(H);var Rt=function(){function r(e){var t=this,o=e?U.trimArrayEntries(ea(e)):[],i=o?U.removeEmptyStringsFromArray(o):[];this.validateInputScopes(i),this.scopes=new Set,i.forEach(function(n){return t.scopes.add(n)})}return r.fromString=function(e){var t=e||_.EMPTY_STRING,o=t.split(" ");return new r(o)},r.createSearchScopes=function(e){var t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(_.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t},r.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw We.createEmptyScopesArrayError()},r.prototype.containsScope=function(e){var t=this.printScopesLowerCase().split(" "),o=new r(t);return U.isEmpty(e)?!1:o.scopes.has(e.toLowerCase())},r.prototype.containsScopeSet=function(e){var t=this;return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(function(o){return t.containsScope(o)})},r.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return g0.forEach(function(o){e.containsScope(o)&&(t+=1)}),this.scopes.size===t},r.prototype.appendScope=function(e){U.isEmpty(e)||this.scopes.add(e.trim())},r.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(o){return t.appendScope(o)})}catch(o){throw H.createAppendScopeSetError(o)}},r.prototype.removeScope=function(e){if(U.isEmpty(e))throw H.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},r.prototype.removeOIDCScopes=function(){var e=this;g0.forEach(function(t){e.scopes.delete(t)})},r.prototype.unionScopeSets=function(e){if(!e)throw H.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach(function(o){return t.add(o.toLowerCase())}),this.scopes.forEach(function(o){return t.add(o.toLowerCase())}),t},r.prototype.intersectingScopeSets=function(e){if(!e)throw H.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),o=e.getScopeCount(),i=this.getScopeCount(),n=t.size;return n<i+o},r.prototype.getScopeCount=function(){return this.scopes.size},r.prototype.asArray=function(){var e=[];return this.scopes.forEach(function(t){return e.push(t)}),e},r.prototype.printScopes=function(){if(this.scopes){var e=this.asArray();return e.join(" ")}return _.EMPTY_STRING},r.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},r}();l();c();d();l();c();d();function ia(r,e){if(U.isEmpty(r))throw H.createClientInfoEmptyError();try{var t=e.base64Decode(r);return JSON.parse(t)}catch(o){throw H.createClientInfoDecodingError(o.message)}}function Mn(r){if(U.isEmpty(r))throw H.createClientInfoDecodingError("Home account ID was empty.");var e=r.split(Nt.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?_.EMPTY_STRING:e[1]}}l();c();d();var kr;(function(r){r[r.Default=0]="Default",r[r.Adfs=1]="Adfs",r[r.Dsts=2]="Dsts",r[r.Ciam=3]="Ciam"})(kr||(kr={}));var Ht=function(){function r(){}return r.prototype.generateAccountId=function(){var e=[this.homeAccountId,this.environment];return e.join(Nt.CACHE_KEY_SEPARATOR).toLowerCase()},r.prototype.generateAccountKey=function(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},r.prototype.generateType=function(){switch(this.authorityType){case sn.ADFS_ACCOUNT_TYPE:return _i.ADFS;case sn.MSAV1_ACCOUNT_TYPE:return _i.MSA;case sn.MSSTS_ACCOUNT_TYPE:return _i.MSSTS;case sn.GENERIC_ACCOUNT_TYPE:return _i.GENERIC;default:throw H.createUnexpectedAccountTypeError()}},r.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},r.generateAccountCacheKey=function(e){var t=[e.homeAccountId,e.environment||_.EMPTY_STRING,e.tenantId||_.EMPTY_STRING];return t.join(Nt.CACHE_KEY_SEPARATOR).toLowerCase()},r.createAccount=function(e,t,o,i,n,s,a,u){var h,p,f,b,x,S,R=new r;R.authorityType=sn.MSSTS_ACCOUNT_TYPE,R.clientInfo=e,R.homeAccountId=t,R.nativeAccountId=u;var z=a||i&&i.getPreferredCache();if(!z)throw H.createInvalidCacheEnvironmentError();if(R.environment=z,R.realm=((h=o?.claims)===null||h===void 0?void 0:h.tid)||_.EMPTY_STRING,o){R.idTokenClaims=o.claims,R.localAccountId=((p=o?.claims)===null||p===void 0?void 0:p.oid)||((f=o?.claims)===null||f===void 0?void 0:f.sub)||_.EMPTY_STRING;var we=(b=o?.claims)===null||b===void 0?void 0:b.preferred_username,re=!((x=o?.claims)===null||x===void 0)&&x.emails?o.claims.emails[0]:null;R.username=we||re||_.EMPTY_STRING,R.name=(S=o?.claims)===null||S===void 0?void 0:S.name}return R.cloudGraphHostName=n,R.msGraphHost=s,R},r.createGenericAccount=function(e,t,o,i,n,s){var a,u,h,p,f=new r;f.authorityType=o&&o.authorityType===kr.Adfs?sn.ADFS_ACCOUNT_TYPE:sn.GENERIC_ACCOUNT_TYPE,f.homeAccountId=e,f.realm=_.EMPTY_STRING;var b=s||o&&o.getPreferredCache();if(!b)throw H.createInvalidCacheEnvironmentError();return t&&(f.localAccountId=((a=t?.claims)===null||a===void 0?void 0:a.oid)||((u=t?.claims)===null||u===void 0?void 0:u.sub)||_.EMPTY_STRING,f.username=((h=t?.claims)===null||h===void 0?void 0:h.upn)||_.EMPTY_STRING,f.name=((p=t?.claims)===null||p===void 0?void 0:p.name)||_.EMPTY_STRING,f.idTokenClaims=t?.claims),f.environment=b,f.cloudGraphHostName=i,f.msGraphHost=n,f},r.generateHomeAccountId=function(e,t,o,i,n){var s,a=!((s=n?.claims)===null||s===void 0)&&s.sub?n.claims.sub:_.EMPTY_STRING;if(t===kr.Adfs||t===kr.Dsts)return a;if(e)try{var u=ia(e,i);if(!U.isEmpty(u.uid)&&!U.isEmpty(u.utid))return""+u.uid+Nt.CLIENT_INFO_SEPARATOR+u.utid}catch{}return o.verbose("No client info in response"),a},r.isAccountEntity=function(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1},r.accountInfoIsEqual=function(e,t,o){if(!e||!t)return!1;var i=!0;if(o){var n=e.idTokenClaims||{},s=t.idTokenClaims||{};i=n.iat===s.iat&&n.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i},r}();l();c();d();var gr=function(){function r(e,t){if(U.isEmpty(e))throw H.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=r.extractTokenClaims(e,t)}return r.extractTokenClaims=function(e,t){var o=U.decodeAuthToken(e);try{var i=o.JWSPayload,n=t.base64Decode(i);return JSON.parse(n)}catch(s){throw H.createTokenParsingError(s)}},r.checkMaxAge=function(e,t){var o=3e5;if(t===0||Date.now()-o>e+t)throw H.createMaxAgeTranspiredError()},r}();var io=function(){function r(e,t,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=o.clone(Jp,gl)}return r.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var o=t.reduce(function(n,s){var a=e.getAccount(s);return a&&n.push(a),n},[]);if(o.length<1)return[];var i=o.map(function(n){return e.getAccountInfoFromEntity(n)});return i},r.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},r.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),o=this.getIdToken(t);return o&&(t.idToken=o.secret,t.idTokenClaims=new gr(o.secret,this.cryptoImpl).claims),t},r.prototype.saveCacheRecord=function(e){return se(this,void 0,void 0,function(){return ae(this,function(t){switch(t.label){case 0:if(!e)throw H.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}})})},r.prototype.saveAccessToken=function(e){return se(this,void 0,void 0,function(){var t,o,i,n,s=this;return ae(this,function(a){switch(a.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),i=Rt.fromString(e.target),n=[],o.accessToken.forEach(function(u){if(s.accessTokenKeyMatchesFilter(u,t,!1)){var h=s.getAccessTokenCredential(u);if(h&&s.credentialMatchesFilter(h,t)){var p=Rt.fromString(h.target);p.intersectingScopeSets(i)&&n.push(s.removeAccessToken(u))}}}),[4,Promise.all(n)];case 1:return a.sent(),this.setAccessTokenCredential(e),[2]}})})},r.prototype.getAccountsFilteredBy=function(e){var t=this,o=this.getAccountKeys(),i=[];return o.forEach(function(n){if(t.isAccountKey(n,e.homeAccountId,e.realm)){var s=t.getAccount(n);s&&(e.homeAccountId&&!t.matchHomeAccountId(s,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(s,e.localAccountId)||e.username&&!t.matchUsername(s,e.username)||e.environment&&!t.matchEnvironment(s,e.environment)||e.realm&&!t.matchRealm(s,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(s,e.nativeAccountId)||i.push(s))}}),i},r.prototype.isAccountKey=function(e,t,o){return!(e.split(Nt.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||o&&!e.toLowerCase().includes(o.toLowerCase()))},r.prototype.isCredentialKey=function(e){if(e.split(Nt.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(t.indexOf(he.ID_TOKEN.toLowerCase())===-1&&t.indexOf(he.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(he.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(he.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(he.REFRESH_TOKEN.toLowerCase())>-1){var o=""+he.REFRESH_TOKEN+Nt.CACHE_KEY_SEPARATOR+this.clientId+Nt.CACHE_KEY_SEPARATOR,i=""+he.REFRESH_TOKEN+Nt.CACHE_KEY_SEPARATOR+ra+Nt.CACHE_KEY_SEPARATOR;if(t.indexOf(o.toLowerCase())===-1&&t.indexOf(i.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0},r.prototype.credentialMatchesFilter=function(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===he.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===ze.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))},r.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},r.prototype.getAppMetadataFilteredByInternal=function(e,t){var o=this,i=this.getKeys(),n={};return i.forEach(function(s){if(o.isAppMetadata(s)){var a=o.getAppMetadata(s);a&&(e&&!o.matchEnvironment(a,e)||t&&!o.matchClientId(a,t)||(n[s]=a))}}),n},r.prototype.getAuthorityMetadataByAlias=function(e){var t=this,o=this.getAuthorityMetadataKeys(),i=null;return o.forEach(function(n){if(!(!t.isAuthorityMetadata(n)||n.indexOf(t.clientId)===-1)){var s=t.getAuthorityMetadata(n);s&&s.aliases.indexOf(e)!==-1&&(i=s)}}),i},r.prototype.removeAllAccounts=function(){return se(this,void 0,void 0,function(){var e,t,o=this;return ae(this,function(i){switch(i.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach(function(n){t.push(o.removeAccount(n))}),[4,Promise.all(t)];case 1:return i.sent(),[2]}})})},r.prototype.removeAccount=function(e){return se(this,void 0,void 0,function(){var t;return ae(this,function(o){switch(o.label){case 0:if(t=this.getAccount(e),!t)throw H.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return o.sent(),this.removeItem(e),[2]}})})},r.prototype.removeAccountContext=function(e){return se(this,void 0,void 0,function(){var t,o,i,n=this;return ae(this,function(s){switch(s.label){case 0:return t=this.getTokenKeys(),o=e.generateAccountId(),i=[],t.idToken.forEach(function(a){a.indexOf(o)===0&&n.removeIdToken(a)}),t.accessToken.forEach(function(a){a.indexOf(o)===0&&i.push(n.removeAccessToken(a))}),t.refreshToken.forEach(function(a){a.indexOf(o)===0&&n.removeRefreshToken(a)}),[4,Promise.all(i)];case 1:return s.sent(),[2]}})})},r.prototype.removeAccessToken=function(e){return se(this,void 0,void 0,function(){var t,o,i;return ae(this,function(n){switch(n.label){case 0:if(t=this.getAccessTokenCredential(e),!t)return[2];if(t.credentialType.toLowerCase()!==he.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==ze.POP)return[3,4];if(o=t,i=o.keyId,!i)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(i)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),H.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}})})},r.prototype.removeAppMetadata=function(){var e=this,t=this.getKeys();return t.forEach(function(o){e.isAppMetadata(o)&&e.removeItem(o)}),!0},r.prototype.readCacheRecord=function(e,t,o){var i=this.getTokenKeys(),n=this.readAccountFromCache(e),s=this.getIdToken(e,i),a=this.getAccessToken(e,t,i),u=this.getRefreshToken(e,!1,i),h=this.readAppMetadataFromCache(o);return n&&s&&(n.idTokenClaims=new gr(s.secret,this.cryptoImpl).claims),{account:n,idToken:s,accessToken:a,refreshToken:u,appMetadata:h}},r.prototype.readAccountFromCache=function(e){var t=Ht.generateAccountCacheKey(e);return this.getAccount(t)},r.prototype.getIdToken=function(e,t){var o=this;this.commonLogger.trace("CacheManager - getIdToken called");var i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:he.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},n=this.getIdTokensByFilter(i,t),s=n.length;return s<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):s>1?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),n.forEach(function(a){o.removeIdToken(a.generateCredentialKey())}),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),n[0])},r.prototype.getIdTokensByFilter=function(e,t){var o=this,i=t&&t.idToken||this.getTokenKeys().idToken,n=[];return i.forEach(function(s){if(o.idTokenKeyMatchesFilter(s,nt({clientId:o.clientId},e))){var a=o.getIdTokenCredential(s);a&&o.credentialMatchesFilter(a,e)&&n.push(a)}}),n},r.prototype.idTokenKeyMatchesFilter=function(e,t){var o=e.toLowerCase();return!(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1)},r.prototype.removeIdToken=function(e){this.removeItem(e)},r.prototype.removeRefreshToken=function(e){this.removeItem(e)},r.prototype.getAccessToken=function(e,t,o){var i=this;this.commonLogger.trace("CacheManager - getAccessToken called");var n=Rt.createSearchScopes(t.scopes),s=t.authenticationScheme||ze.BEARER,a=s&&s.toLowerCase()!==ze.BEARER.toLowerCase()?he.ACCESS_TOKEN_WITH_AUTH_SCHEME:he.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:a,clientId:this.clientId,realm:e.tenantId,target:n,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},h=o&&o.accessToken||this.getTokenKeys().accessToken,p=[];h.forEach(function(b){if(i.accessTokenKeyMatchesFilter(b,u,!0)){var x=i.getAccessTokenCredential(b);x&&i.credentialMatchesFilter(x,u)&&p.push(x)}});var f=p.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),p.forEach(function(b){i.removeAccessToken(b.generateCredentialKey())}),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),p[0])},r.prototype.accessTokenKeyMatchesFilter=function(e,t,o){var i=e.toLowerCase();if(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&i.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&i.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target)for(var n=t.target.asArray(),s=0;s<n.length;s++){if(o&&!i.includes(n[s].toLowerCase()))return!1;if(!o&&i.includes(n[s].toLowerCase()))return!0}return!0},r.prototype.getAccessTokensByFilter=function(e){var t=this,o=this.getTokenKeys(),i=[];return o.accessToken.forEach(function(n){if(t.accessTokenKeyMatchesFilter(n,e,!0)){var s=t.getAccessTokenCredential(n);s&&t.credentialMatchesFilter(s,e)&&i.push(s)}}),i},r.prototype.getRefreshToken=function(e,t,o){var i=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var n=t?ra:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:he.REFRESH_TOKEN,clientId:this.clientId,familyId:n},a=o&&o.refreshToken||this.getTokenKeys().refreshToken,u=[];a.forEach(function(p){if(i.refreshTokenKeyMatchesFilter(p,s)){var f=i.getRefreshTokenCredential(p);f&&i.credentialMatchesFilter(f,s)&&u.push(f)}});var h=u.length;return h<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),u[0])},r.prototype.refreshTokenKeyMatchesFilter=function(e,t){var o=e.toLowerCase();return!(t.familyId&&o.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1)},r.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},o=this.getAppMetadataFilteredBy(t),i=Object.keys(o).map(function(s){return o[s]}),n=i.length;if(n<1)return null;if(n>1)throw H.createMultipleMatchingAppMetadataInCacheError();return i[0]},r.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===ra)},r.prototype.matchHomeAccountId=function(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId},r.prototype.matchLocalAccountId=function(e,t){return typeof e.localAccountId=="string"&&t===e.localAccountId},r.prototype.matchUsername=function(e,t){return typeof e.username=="string"&&t.toLowerCase()===e.username.toLowerCase()},r.prototype.matchUserAssertionHash=function(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)},r.prototype.matchEnvironment=function(e,t){var o=this.getAuthorityMetadataByAlias(t);return!!(o&&o.aliases.indexOf(e.environment)>-1)},r.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},r.prototype.matchClientId=function(e,t){return!!(e.clientId&&t===e.clientId)},r.prototype.matchFamilyId=function(e,t){return!!(e.familyId&&t===e.familyId)},r.prototype.matchRealm=function(e,t){return!!(e.realm&&t===e.realm)},r.prototype.matchNativeAccountId=function(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)},r.prototype.matchTarget=function(e,t){var o=e.credentialType!==he.ACCESS_TOKEN&&e.credentialType!==he.ACCESS_TOKEN_WITH_AUTH_SCHEME;if(o||!e.target)return!1;var i=Rt.fromString(e.target);return i.containsScopeSet(t)},r.prototype.matchTokenType=function(e,t){return!!(e.tokenType&&e.tokenType===t)},r.prototype.matchKeyId=function(e,t){return!!(e.keyId&&e.keyId===t)},r.prototype.isAppMetadata=function(e){return e.indexOf(cu)!==-1},r.prototype.isAuthorityMetadata=function(e){return e.indexOf(ml.CACHE_KEY)!==-1},r.prototype.generateAuthorityMetadataCacheKey=function(e){return ml.CACHE_KEY+"-"+this.clientId+"-"+e},r.toObject=function(e,t){for(var o in t)e[o]=t[o];return e},r}(),v0=function(r){at(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setAccount=function(){var t="Storage interface - setAccount() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getAccount=function(){var t="Storage interface - getAccount() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.setIdTokenCredential=function(){var t="Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getIdTokenCredential=function(){var t="Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.setAccessTokenCredential=function(){var t="Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getAccessTokenCredential=function(){var t="Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.setRefreshTokenCredential=function(){var t="Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getRefreshTokenCredential=function(){var t="Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.setAppMetadata=function(){var t="Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getAppMetadata=function(){var t="Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.setServerTelemetry=function(){var t="Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getServerTelemetry=function(){var t="Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.setAuthorityMetadata=function(){var t="Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getAuthorityMetadata=function(){var t="Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getAuthorityMetadataKeys=function(){var t="Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.setThrottlingCache=function(){var t="Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getThrottlingCache=function(){var t="Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.removeItem=function(){var t="Storage interface - removeItem() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.containsKey=function(){var t="Storage interface - containsKey() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getKeys=function(){var t="Storage interface - getKeys() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getAccountKeys=function(){var t="Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.getTokenKeys=function(){var t="Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e.prototype.clear=function(){return se(this,void 0,void 0,function(){var t;return ae(this,function(o){throw t="Storage interface - clear() has not been implemented for the cacheStorage interface.",X.createUnexpectedError(t)})})},e.prototype.updateCredentialCacheKey=function(){var t="Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.";throw X.createUnexpectedError(t)},e}(io);var J$=300,Xp={tokenRenewalOffsetSeconds:J$,preventCorsPreflight:!1},X$={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:lr.Info,correlationId:_.EMPTY_STRING},e7={claimsBasedCachingEnabled:!0},t7={sendGetRequestAsync:function(){return se(this,void 0,void 0,function(){var r;return ae(this,function(e){throw r="Network interface - sendGetRequestAsync() has not been implemented",X.createUnexpectedError(r)})})},sendPostRequestAsync:function(){return se(this,void 0,void 0,function(){var r;return ae(this,function(e){throw r="Network interface - sendPostRequestAsync() has not been implemented",X.createUnexpectedError(r)})})}},r7={sku:_.SKU,version:gl,cpu:_.EMPTY_STRING,os:_.EMPTY_STRING},o7={clientSecret:_.EMPTY_STRING,clientAssertion:void 0},i7={azureCloudInstance:On.None,tenant:""+_.DEFAULT_COMMON_TENANT},n7={application:{appName:"",appVersion:""}};function Rk(r){var e=r.authOptions,t=r.systemOptions,o=r.loggerOptions,i=r.cacheOptions,n=r.storageInterface,s=r.networkInterface,a=r.cryptoInterface,u=r.clientCredentials,h=r.libraryInfo,p=r.telemetry,f=r.serverTelemetryManager,b=r.persistencePlugin,x=r.serializableCache,S=nt(nt({},X$),o);return{authOptions:s7(e),systemOptions:nt(nt({},Xp),t),loggerOptions:S,cacheOptions:nt(nt({},e7),i),storageInterface:n||new v0(e.clientId,oa,new $n(S)),networkInterface:s||t7,cryptoInterface:a||oa,clientCredentials:u||o7,libraryInfo:nt(nt({},r7),h),telemetry:nt(nt({},n7),p),serverTelemetryManager:f||null,persistencePlugin:b||null,serializableCache:x||null}}function s7(r){return nt({clientCapabilities:[],azureCloudOptions:i7,skipAuthorityMetadataCache:!1},r)}l();c();d();l();c();d();l();c();d();var no=function(r){at(e,r);function e(t,o,i){var n=r.call(this,t,o,i)||this;return n.name="ServerError",Object.setPrototypeOf(n,e.prototype),n}return e}(X);var na=function(){function r(){}return r.generateThrottlingStorageKey=function(e){return fs.THROTTLING_PREFIX+"."+JSON.stringify(e)},r.preProcess=function(e,t){var o,i=r.generateThrottlingStorageKey(t),n=e.getThrottlingCache(i);if(n){if(n.throttleTime<Date.now()){e.removeItem(i);return}throw new no(((o=n.errorCodes)===null||o===void 0?void 0:o.join(" "))||_.EMPTY_STRING,n.errorMessage,n.subError)}},r.postProcess=function(e,t,o){if(r.checkResponseStatus(o)||r.checkResponseForRetryAfter(o)){var i={throttleTime:r.calculateThrottleTime(parseInt(o.headers[Lt.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),i)}},r.checkResponseStatus=function(e){return e.status===429||e.status>=500&&e.status<600},r.checkResponseForRetryAfter=function(e){return e.headers?e.headers.hasOwnProperty(Lt.RETRY_AFTER)&&(e.status<200||e.status>=300):!1},r.calculateThrottleTime=function(e){var t=e<=0?0:e,o=Date.now()/1e3;return Math.floor(Math.min(o+(t||fs.DEFAULT_THROTTLE_TIME_SECONDS),o+fs.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)},r.removeThrottle=function(e,t,o,i){var n={clientId:t,authority:o.authority,scopes:o.scopes,homeAccountIdentifier:i,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},s=this.generateThrottlingStorageKey(n);e.removeItem(s)},r}();var y0=function(){function r(e,t){this.networkClient=e,this.cacheManager=t}return r.prototype.sendPostRequest=function(e,t,o){return se(this,void 0,void 0,function(){var i,n;return ae(this,function(s){switch(s.label){case 0:na.preProcess(this.cacheManager,e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,o)];case 2:return i=s.sent(),[3,4];case 3:throw n=s.sent(),n instanceof X?n:H.createNetworkError(t,n);case 4:return na.postProcess(this.cacheManager,e,i),[2,i]}})})},r}();l();c();d();var Sr;(function(r){r.HOME_ACCOUNT_ID="home_account_id",r.UPN="UPN"})(Sr||(Sr={}));l();c();d();l();c();d();var ms=function(){function r(){}return r.validateRedirectUri=function(e){if(U.isEmpty(e))throw We.createRedirectUriEmptyError()},r.validatePrompt=function(e){var t=[];for(var o in ar)t.push(ar[o]);if(t.indexOf(e)<0)throw We.createInvalidPromptError(e)},r.validateClaims=function(e){try{JSON.parse(e)}catch{throw We.createInvalidClaimsRequestError()}},r.validateCodeChallengeParams=function(e,t){if(U.isEmpty(e)||U.isEmpty(t))throw We.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},r.validateCodeChallengeMethod=function(e){if([Yp.PLAIN,Yp.S256].indexOf(e)<0)throw We.createInvalidCodeChallengeMethodError()},r.sanitizeEQParams=function(e,t){return e?(t.forEach(function(o,i){e[i]&&delete e[i]}),Object.fromEntries(Object.entries(e).filter(function(o){var i=o[1];return i!==""}))):{}},r}();var Ur=function(){function r(){this.parameters=new Map}return r.prototype.addResponseTypeCode=function(){this.parameters.set(He.RESPONSE_TYPE,encodeURIComponent(_.CODE_RESPONSE_TYPE))},r.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(He.RESPONSE_TYPE,encodeURIComponent(_.TOKEN_RESPONSE_TYPE+" "+_.ID_TOKEN_RESPONSE_TYPE))},r.prototype.addResponseMode=function(e){this.parameters.set(He.RESPONSE_MODE,encodeURIComponent(e||pl.QUERY))},r.prototype.addNativeBroker=function(){this.parameters.set(He.NATIVE_BROKER,encodeURIComponent("1"))},r.prototype.addScopes=function(e,t){t===void 0&&(t=!0);var o=t?ea(e||[],an):e||[],i=new Rt(o);this.parameters.set(He.SCOPE,encodeURIComponent(i.printScopes()))},r.prototype.addClientId=function(e){this.parameters.set(He.CLIENT_ID,encodeURIComponent(e))},r.prototype.addRedirectUri=function(e){ms.validateRedirectUri(e),this.parameters.set(He.REDIRECT_URI,encodeURIComponent(e))},r.prototype.addPostLogoutRedirectUri=function(e){ms.validateRedirectUri(e),this.parameters.set(He.POST_LOGOUT_URI,encodeURIComponent(e))},r.prototype.addIdTokenHint=function(e){this.parameters.set(He.ID_TOKEN_HINT,encodeURIComponent(e))},r.prototype.addDomainHint=function(e){this.parameters.set(hl.DOMAIN_HINT,encodeURIComponent(e))},r.prototype.addLoginHint=function(e){this.parameters.set(hl.LOGIN_HINT,encodeURIComponent(e))},r.prototype.addCcsUpn=function(e){this.parameters.set(Lt.CCS_HEADER,encodeURIComponent("UPN:"+e))},r.prototype.addCcsOid=function(e){this.parameters.set(Lt.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},r.prototype.addSid=function(e){this.parameters.set(hl.SID,encodeURIComponent(e))},r.prototype.addClaims=function(e,t){var o=this.addClientCapabilitiesToClaims(e,t);ms.validateClaims(o),this.parameters.set(He.CLAIMS,encodeURIComponent(o))},r.prototype.addCorrelationId=function(e){this.parameters.set(He.CLIENT_REQUEST_ID,encodeURIComponent(e))},r.prototype.addLibraryInfo=function(e){this.parameters.set(He.X_CLIENT_SKU,e.sku),this.parameters.set(He.X_CLIENT_VER,e.version),e.os&&this.parameters.set(He.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(He.X_CLIENT_CPU,e.cpu)},r.prototype.addApplicationTelemetry=function(e){e?.appName&&this.parameters.set(He.X_APP_NAME,e.appName),e?.appVersion&&this.parameters.set(He.X_APP_VER,e.appVersion)},r.prototype.addPrompt=function(e){ms.validatePrompt(e),this.parameters.set(""+He.PROMPT,encodeURIComponent(e))},r.prototype.addState=function(e){U.isEmpty(e)||this.parameters.set(He.STATE,encodeURIComponent(e))},r.prototype.addNonce=function(e){this.parameters.set(He.NONCE,encodeURIComponent(e))},r.prototype.addCodeChallengeParams=function(e,t){if(ms.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(He.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(He.CODE_CHALLENGE_METHOD,encodeURIComponent(t));else throw We.createInvalidCodeChallengeParamsError()},r.prototype.addAuthorizationCode=function(e){this.parameters.set(He.CODE,encodeURIComponent(e))},r.prototype.addDeviceCode=function(e){this.parameters.set(He.DEVICE_CODE,encodeURIComponent(e))},r.prototype.addRefreshToken=function(e){this.parameters.set(He.REFRESH_TOKEN,encodeURIComponent(e))},r.prototype.addCodeVerifier=function(e){this.parameters.set(He.CODE_VERIFIER,encodeURIComponent(e))},r.prototype.addClientSecret=function(e){this.parameters.set(He.CLIENT_SECRET,encodeURIComponent(e))},r.prototype.addClientAssertion=function(e){U.isEmpty(e)||this.parameters.set(He.CLIENT_ASSERTION,encodeURIComponent(e))},r.prototype.addClientAssertionType=function(e){U.isEmpty(e)||this.parameters.set(He.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},r.prototype.addOboAssertion=function(e){this.parameters.set(He.OBO_ASSERTION,encodeURIComponent(e))},r.prototype.addRequestTokenUse=function(e){this.parameters.set(He.REQUESTED_TOKEN_USE,encodeURIComponent(e))},r.prototype.addGrantType=function(e){this.parameters.set(He.GRANT_TYPE,encodeURIComponent(e))},r.prototype.addClientInfo=function(){this.parameters.set(Ak,"1")},r.prototype.addExtraQueryParameters=function(e){var t=this,o=ms.sanitizeEQParams(e,this.parameters);Object.keys(o).forEach(function(i){t.parameters.set(i,e[i])})},r.prototype.addClientCapabilitiesToClaims=function(e,t){var o;if(!e)o={};else try{o=JSON.parse(e)}catch{throw We.createInvalidClaimsRequestError()}return t&&t.length>0&&(o.hasOwnProperty(ta.ACCESS_TOKEN)||(o[ta.ACCESS_TOKEN]={}),o[ta.ACCESS_TOKEN][ta.XMS_CC]={values:t}),JSON.stringify(o)},r.prototype.addUsername=function(e){this.parameters.set(wc.username,encodeURIComponent(e))},r.prototype.addPassword=function(e){this.parameters.set(wc.password,encodeURIComponent(e))},r.prototype.addPopToken=function(e){U.isEmpty(e)||(this.parameters.set(He.TOKEN_TYPE,ze.POP),this.parameters.set(He.REQ_CNF,encodeURIComponent(e)))},r.prototype.addSshJwk=function(e){U.isEmpty(e)||(this.parameters.set(He.TOKEN_TYPE,ze.SSH),this.parameters.set(He.REQ_CNF,encodeURIComponent(e)))},r.prototype.addServerTelemetry=function(e){this.parameters.set(He.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(He.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},r.prototype.addThrottling=function(){this.parameters.set(He.X_MS_LIB_CAPABILITY,fs.X_MS_LIB_CAPABILITY_VALUE)},r.prototype.addLogoutHint=function(e){this.parameters.set(He.LOGOUT_HINT,encodeURIComponent(e))},r.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach(function(t,o){e.push(o+"="+t)}),e.join("&")},r}();var Ko=function(){function r(e,t){this.config=Rk(e),this.logger=new $n(this.config.loggerOptions,Jp,gl),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new y0(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return r.prototype.createTokenRequestHeaders=function(e){var t={};if(t[Lt.CONTENT_TYPE]=_.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Sr.HOME_ACCOUNT_ID:try{var o=Mn(e.credential);t[Lt.CCS_HEADER]="Oid:"+o.uid+"@"+o.utid}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Sr.UPN:t[Lt.CCS_HEADER]="UPN: "+e.credential;break}return t},r.prototype.executePostToTokenEndpoint=function(e,t,o,i){return se(this,void 0,void 0,function(){var n;return ae(this,function(s){switch(s.label){case 0:return[4,this.networkManager.sendPostRequest(i,e,{body:t,headers:o})];case 1:return n=s.sent(),this.config.serverTelemetryManager&&n.status<500&&n.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,n]}})})},r.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw H.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},r.prototype.createTokenQueryParameters=function(e){var t=new Ur;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},r}();l();c();d();l();c();d();l();c();d();var vl=function(){function r(){}return r.prototype.generateAccountId=function(){return r.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},r.prototype.generateCredentialId=function(){return r.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},r.prototype.generateTarget=function(){return r.generateTargetForCacheKey(this.target)},r.prototype.generateCredentialKey=function(){return r.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},r.prototype.generateType=function(){switch(this.credentialType){case he.ID_TOKEN:return _i.ID_TOKEN;case he.ACCESS_TOKEN:case he.ACCESS_TOKEN_WITH_AUTH_SCHEME:return _i.ACCESS_TOKEN;case he.REFRESH_TOKEN:return _i.REFRESH_TOKEN;default:throw H.createUnexpectedCredentialTypeError()}},r.generateCredentialCacheKey=function(e,t,o,i,n,s,a,u,h){var p=[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(o,i,n,a),this.generateTargetForCacheKey(s),this.generateClaimsHashForCacheKey(h),this.generateSchemeForCacheKey(u)];return p.join(Nt.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateAccountIdForCacheKey=function(e,t){var o=[e,t];return o.join(Nt.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateCredentialIdForCacheKey=function(e,t,o,i){var n=e===he.REFRESH_TOKEN&&i||t,s=[e,n,o||_.EMPTY_STRING];return s.join(Nt.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateTargetForCacheKey=function(e){return(e||_.EMPTY_STRING).toLowerCase()},r.generateClaimsHashForCacheKey=function(e){return(e||_.EMPTY_STRING).toLowerCase()},r.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==ze.BEARER.toLowerCase()?e.toLowerCase():_.EMPTY_STRING},r}();var Ti=function(r){at(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createIdTokenEntity=function(t,o,i,n,s){var a=new e;return a.credentialType=he.ID_TOKEN,a.homeAccountId=t,a.environment=o,a.clientId=n,a.secret=i,a.realm=s,a},e.isIdTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===he.ID_TOKEN:!1},e}(vl);l();c();d();l();c();d();var lt=function(){function r(){}return r.nowSeconds=function(){return Math.round(new Date().getTime()/1e3)},r.isTokenExpired=function(e,t){var o=Number(e)||0,i=r.nowSeconds()+t;return i>o},r.wasClockTurnedBack=function(e){var t=Number(e);return t>r.nowSeconds()},r.delay=function(e,t){return new Promise(function(o){return setTimeout(function(){return o(t)},e)})},r}();var Ei=function(r){at(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createAccessTokenEntity=function(t,o,i,n,s,a,u,h,p,f,b,x,S,R,z){var we,re,ge=new e;ge.homeAccountId=t,ge.credentialType=he.ACCESS_TOKEN,ge.secret=i;var wt=lt.nowSeconds();if(ge.cachedAt=wt.toString(),ge.expiresOn=u.toString(),ge.extendedExpiresOn=h.toString(),f&&(ge.refreshOn=f.toString()),ge.environment=o,ge.clientId=n,ge.realm=s,ge.target=a,ge.userAssertionHash=x,ge.tokenType=U.isEmpty(b)?ze.BEARER:b,R&&(ge.requestedClaims=R,ge.requestedClaimsHash=z),((we=ge.tokenType)===null||we===void 0?void 0:we.toLowerCase())!==ze.BEARER.toLowerCase())switch(ge.credentialType=he.ACCESS_TOKEN_WITH_AUTH_SCHEME,ge.tokenType){case ze.POP:var je=gr.extractTokenClaims(i,p);if(!(!((re=je?.cnf)===null||re===void 0)&&re.kid))throw H.createTokenClaimsRequiredError();ge.keyId=je.cnf.kid;break;case ze.SSH:ge.keyId=S}return ge},e.isAccessTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===he.ACCESS_TOKEN||t.credentialType===he.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1},e}(vl);l();c();d();var Fn=function(r){at(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createRefreshTokenEntity=function(t,o,i,n,s,a){var u=new e;return u.clientId=n,u.credentialType=he.REFRESH_TOKEN,u.environment=o,u.homeAccountId=t,u.secret=i,u.userAssertionHash=a,s&&(u.familyId=s),u},e.isRefreshTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===he.REFRESH_TOKEN:!1},e}(vl);l();c();d();var Pk=["interaction_required","consent_required","login_required"],a7=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Dn={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}},_r=function(r){at(e,r);function e(t,o,i,n,s,a,u){var h=r.call(this,t,o,i)||this;return Object.setPrototypeOf(h,e.prototype),h.timestamp=n||_.EMPTY_STRING,h.traceId=s||_.EMPTY_STRING,h.correlationId=a||_.EMPTY_STRING,h.claims=u||_.EMPTY_STRING,h.name="InteractionRequiredAuthError",h}return e.isInteractionRequiredError=function(t,o,i){var n=!!t&&Pk.indexOf(t)>-1,s=!!i&&a7.indexOf(i)>-1,a=!!o&&Pk.some(function(u){return o.indexOf(u)>-1});return n||a||s},e.createNoTokensFoundError=function(){return new e(Dn.noTokensFoundError.code,Dn.noTokensFoundError.desc)},e.createNativeAccountUnavailableError=function(){return new e(Dn.native_account_unavailable.code,Dn.native_account_unavailable.desc)},e}(X);l();c();d();var gs=function(){function r(e,t,o,i,n){this.account=e||null,this.idToken=t||null,this.accessToken=o||null,this.refreshToken=i||null,this.appMetadata=n||null}return r}();l();c();d();var so=function(){function r(){}return r.setRequestState=function(e,t,o){var i=r.generateLibraryState(e,o);return U.isEmpty(t)?i:""+i+_.RESOURCE_DELIM+t},r.generateLibraryState=function(e,t){if(!e)throw H.createNoCryptoObjectError("generateLibraryState");var o={id:e.createNewGuid()};t&&(o.meta=t);var i=JSON.stringify(o);return e.base64Encode(i)},r.parseRequestState=function(e,t){if(!e)throw H.createNoCryptoObjectError("parseRequestState");if(U.isEmpty(t))throw H.createInvalidStateError(t,"Null, undefined or empty state");try{var o=t.split(_.RESOURCE_DELIM),i=o[0],n=o.length>1?o.slice(1).join(_.RESOURCE_DELIM):_.EMPTY_STRING,s=e.base64Decode(i),a=JSON.parse(s);return{userRequestState:U.isEmpty(n)?_.EMPTY_STRING:n,libraryState:a}}catch(u){throw H.createInvalidStateError(t,u)}},r}();l();c();d();l();c();d();var Se=function(){function r(e){if(this._urlString=e,U.isEmpty(this._urlString))throw We.createUrlEmptyError();U.isEmpty(this.getHash())&&(this._urlString=r.canonicalizeUri(e))}return Object.defineProperty(r.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),r.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return U.endsWith(t,"?")?t=t.slice(0,-1):U.endsWith(t,"?/")&&(t=t.slice(0,-2)),U.endsWith(t,"/")||(t+="/"),t}return e},r.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw We.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw We.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw We.createInsecureAuthorityUriError(this.urlString)},r.appendQueryString=function(e,t){return U.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},r.removeHashFromUrl=function(e){return r.canonicalizeUri(e.split("#")[0])},r.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),o=t.PathSegments;return e&&o.length!==0&&(o[0]===hs.COMMON||o[0]===hs.ORGANIZATIONS)&&(o[0]=e),r.constructAuthorityUriFromObject(t)},r.prototype.getHash=function(){return r.parseHash(this.urlString)},r.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw We.createUrlParseError("Given url string: "+this.urlString);var o={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},i=o.AbsolutePath.split("/");return i=i.filter(function(n){return n&&n.length>0}),o.PathSegments=i,!U.isEmpty(o.QueryString)&&o.QueryString.endsWith("/")&&(o.QueryString=o.QueryString.substring(0,o.QueryString.length-1)),o},r.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),o=e.match(t);if(!o)throw We.createUrlParseError("Given url string: "+e);return o[2]},r.getAbsoluteUrl=function(e,t){if(e[0]===_.FORWARD_SLASH){var o=new r(t),i=o.getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e},r.parseHash=function(e){var t=e.indexOf("#"),o=e.indexOf("#/");return o>-1?e.substring(o+2):t>-1?e.substring(t+1):_.EMPTY_STRING},r.parseQueryString=function(e){var t=e.indexOf("?"),o=e.indexOf("/?");return o>-1?e.substring(o+2):t>-1?e.substring(t+1):_.EMPTY_STRING},r.constructAuthorityUriFromObject=function(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},r.getDeserializedHash=function(e){if(U.isEmpty(e))return{};var t=r.parseHash(e),o=U.queryStringToObject(U.isEmpty(t)?e:t);if(!o)throw H.createHashNotDeserializedError(JSON.stringify(o));return o},r.getDeserializedQueryString=function(e){if(U.isEmpty(e))return{};var t=r.parseQueryString(e),o=U.queryStringToObject(U.isEmpty(t)?e:t);if(!o)throw H.createHashNotDeserializedError(JSON.stringify(o));return o},r.hashContainsKnownProperties=function(e){if(U.isEmpty(e)||e.indexOf("=")<0)return!1;var t=r.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},r}();l();c();d();var $;(function(r){r.AcquireTokenByCode="acquireTokenByCode",r.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",r.AcquireTokenSilent="acquireTokenSilent",r.AcquireTokenSilentAsync="acquireTokenSilentAsync",r.AcquireTokenPopup="acquireTokenPopup",r.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",r.CryptoOptsSignJwt="cryptoOptsSignJwt",r.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",r.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",r.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",r.SsoSilent="ssoSilent",r.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",r.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",r.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",r.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",r.BrokerHandhshake="brokerHandshake",r.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",r.AcquireTokenByBroker="acquireTokenByBroker",r.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",r.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",r.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",r.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",r.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",r.AcquireTokenFromCache="acquireTokenFromCache",r.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",r.InitializeBaseRequest="initializeBaseRequest",r.InitializeSilentRequest="initializeSilentRequest",r.InitializeClientApplication="initializeClientApplication",r.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",r.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",r.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",r.SilentHandlerLoadFrame="silentHandlerLoadFrame",r.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",r.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",r.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",r.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",r.GetAuthCodeUrl="getAuthCodeUrl",r.HandleCodeResponseFromServer="handleCodeResponseFromServer",r.HandleCodeResponseFromHash="handleCodeResponseFromHash",r.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",r.AuthClientAcquireToken="authClientAcquireToken",r.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",r.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",r.AuthClientCreateQueryString="authClientCreateQueryString",r.PopTokenGenerateCnf="popTokenGenerateCnf",r.PopTokenGenerateKid="popTokenGenerateKid",r.HandleServerTokenResponse="handleServerTokenResponse",r.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",r.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",r.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",r.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",r.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",r.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",r.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",r.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",r.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",r.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",r.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",r.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",r.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",r.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",r.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",r.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",r.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake",r.ClearTokensAndKeysWithClaims="clearTokensAndKeysWithClaims"})($||($={}));var kc;(function(r){r[r.NotStarted=0]="NotStarted",r[r.InProgress=1]="InProgress",r[r.Completed=2]="Completed"})(kc||(kc={}));var b0=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);var w0;(function(r){r.SW="sw",r.UHW="uhw"})(w0||(w0={}));var ui=function(){function r(e,t){this.cryptoUtils=e,this.performanceClient=t}return r.prototype.generateCnf=function(e){var t,o;return se(this,void 0,void 0,function(){var i,n,s;return ae(this,function(a){switch(a.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.PopTokenGenerateCnf,e.correlationId),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime($.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return i=a.sent(),n=this.cryptoUtils.base64Encode(JSON.stringify(i)),s={kid:i.kid,reqCnfString:n},[4,this.cryptoUtils.hashString(n)];case 2:return[2,(s.reqCnfHash=a.sent(),s)]}})})},r.prototype.generateKid=function(e){var t;return se(this,void 0,void 0,function(){var o;return ae(this,function(i){switch(i.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return o=i.sent(),[2,{kid:o,xms_ksl:w0.SW}]}})})},r.prototype.signPopToken=function(e,t,o){return se(this,void 0,void 0,function(){return ae(this,function(i){return[2,this.signPayload(e,t,o)]})})},r.prototype.signPayload=function(e,t,o,i){return se(this,void 0,void 0,function(){var n,s,a,u,h,p;return ae(this,function(f){switch(f.label){case 0:return n=o.resourceRequestMethod,s=o.resourceRequestUri,a=o.shrClaims,u=o.shrNonce,h=s?new Se(s):void 0,p=h?.getUrlComponents(),[4,this.cryptoUtils.signJwt(nt({at:e,ts:lt.nowSeconds(),m:n?.toUpperCase(),u:p?.HostNameAndPort,nonce:u||this.cryptoUtils.createNewGuid(),p:p?.AbsolutePath,q:p?.QueryString?[[],p.QueryString]:void 0,client_claims:a||void 0},i),t,o.correlationId)];case 1:return[2,f.sent()]}})})},r}();l();c();d();var Sc=function(){function r(){}return r.prototype.generateAppMetadataKey=function(){return r.generateAppMetadataCacheKey(this.environment,this.clientId)},r.generateAppMetadataCacheKey=function(e,t){var o=[cu,e,t];return o.join(Nt.CACHE_KEY_SEPARATOR).toLowerCase()},r.createAppMetadataEntity=function(e,t,o){var i=new r;return i.clientId=e,i.environment=t,o&&(i.familyId=o),i},r.isAppMetadataEntity=function(e,t){return t?e.indexOf(cu)===0&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"):!1},r}();l();c();d();var C0=function(){function r(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(r.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),r}();var ao=function(){function r(e,t,o,i,n,s,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=o,this.logger=i,this.serializableCache=n,this.persistencePlugin=s,this.performanceClient=a}return r.prototype.validateServerAuthorizationCodeResponse=function(e,t,o){if(!e.state||!t)throw e.state?H.createStateNotFoundError("Cached State"):H.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw H.createStateMismatchError();if(e.error||e.error_description||e.suberror)throw _r.isInteractionRequiredError(e.error,e.error_description,e.suberror)?new _r(e.error||_.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||_.EMPTY_STRING,e.trace_id||_.EMPTY_STRING,e.correlation_id||_.EMPTY_STRING,e.claims||_.EMPTY_STRING):new no(e.error||_.EMPTY_STRING,e.error_description,e.suberror);e.client_info&&ia(e.client_info,o)},r.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(_r.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new _r(e.error,e.error_description,e.suberror,e.timestamp||_.EMPTY_STRING,e.trace_id||_.EMPTY_STRING,e.correlation_id||_.EMPTY_STRING,e.claims||_.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new no(e.error,t,e.suberror)}},r.prototype.handleServerTokenResponse=function(e,t,o,i,n,s,a,u,h){var p;return se(this,void 0,void 0,function(){var f,b,x,S,R,z,we;return ae(this,function(re){switch(re.label){case 0:if((p=this.performanceClient)===null||p===void 0||p.addQueueMeasurement($.HandleServerTokenResponse,e.correlation_id),e.id_token){if(f=new gr(e.id_token||_.EMPTY_STRING,this.cryptoObj),n&&!U.isEmpty(n.nonce)&&f.claims.nonce!==n.nonce)throw H.createNonceMismatchError();if(i.maxAge||i.maxAge===0){if(b=f.claims.auth_time,!b)throw H.createAuthTimeNotFoundError();gr.checkMaxAge(b,i.maxAge)}}this.homeAccountIdentifier=Ht.generateHomeAccountId(e.client_info||_.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,f),n&&n.state&&(x=so.parseRequestState(this.cryptoObj,n.state)),e.key_id=e.key_id||i.sshKid||void 0,S=this.generateCacheRecord(e,t,o,i,f,s,n),re.label=1;case 1:return re.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),R=new C0(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(R)]):[3,3];case 2:re.sent(),re.label=3;case 3:return a&&!u&&S.account&&(z=S.account.generateAccountKey(),we=this.cacheStorage.getAccount(z),!we)?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,r.generateAuthenticationResult(this.cryptoObj,t,S,!1,i,f,x,void 0,h)]):[4,this.cacheStorage.saveCacheRecord(S)];case 4:return re.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&R?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(R)]):[3,7];case 6:re.sent(),re.label=7;case 7:return[7];case 8:return[2,r.generateAuthenticationResult(this.cryptoObj,t,S,!1,i,f,x,e,h)]}})})},r.prototype.generateCacheRecord=function(e,t,o,i,n,s,a){var u=t.getPreferredCache();if(U.isEmpty(u))throw H.createInvalidCacheEnvironmentError();var h,p;!U.isEmpty(e.id_token)&&n&&(h=Ti.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||_.EMPTY_STRING,this.clientId,n.claims.tid||_.EMPTY_STRING),p=this.generateAccountEntity(e,n,t,a));var f=null;if(!U.isEmpty(e.access_token)){var b=e.scope?Rt.fromString(e.scope):new Rt(i.scopes||[]),x=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,S=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,R=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,z=o+x,we=z+S,re=R&&R>0?o+R:void 0;f=Ei.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||_.EMPTY_STRING,this.clientId,n?n.claims.tid||_.EMPTY_STRING:t.tenant,b.printScopes(),z,we,this.cryptoObj,re,e.token_type,s,e.key_id,i.claims,i.requestedClaimsHash)}var ge=null;U.isEmpty(e.refresh_token)||(ge=Fn.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||_.EMPTY_STRING,this.clientId,e.foci,s));var wt=null;return U.isEmpty(e.foci)||(wt=Sc.createAppMetadataEntity(this.clientId,u,e.foci)),new gs(p,h,f,ge,wt)},r.prototype.generateAccountEntity=function(e,t,o,i){var n=o.authorityType,s=i?i.cloud_graph_host_name:_.EMPTY_STRING,a=i?i.msgraph_host:_.EMPTY_STRING;if(n===kr.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Ht.createGenericAccount(this.homeAccountIdentifier,t,o,s,a);if(U.isEmpty(e.client_info)&&o.protocolMode==="AAD")throw H.createClientInfoEmptyError();return e.client_info?Ht.createAccount(e.client_info,this.homeAccountIdentifier,t,o,s,a):Ht.createGenericAccount(this.homeAccountIdentifier,t,o,s,a)},r.generateAuthenticationResult=function(e,t,o,i,n,s,a,u,h){var p,f,b;return se(this,void 0,void 0,function(){var x,S,R,z,we,re,ge,wt,je,it,Po;return ae(this,function(Rr){switch(Rr.label){case 0:if(x=_.EMPTY_STRING,S=[],R=null,we=_.EMPTY_STRING,!o.accessToken)return[3,4];if(o.accessToken.tokenType!==ze.POP)return[3,2];if(re=new ui(e),ge=o.accessToken,wt=ge.secret,je=ge.keyId,!je)throw H.createKeyIdMissingError();return[4,re.signPopToken(wt,je,n)];case 1:return x=Rr.sent(),[3,3];case 2:x=o.accessToken.secret,Rr.label=3;case 3:S=Rt.fromString(o.accessToken.target).asArray(),R=new Date(Number(o.accessToken.expiresOn)*1e3),z=new Date(Number(o.accessToken.extendedExpiresOn)*1e3),Rr.label=4;case 4:return o.appMetadata&&(we=o.appMetadata.familyId===ra?ra:_.EMPTY_STRING),it=s?.claims.oid||s?.claims.sub||_.EMPTY_STRING,Po=s?.claims.tid||_.EMPTY_STRING,u?.spa_accountid&&o.account&&(o.account.nativeAccountId=u?.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:it,tenantId:Po,scopes:S,account:o.account?o.account.getAccountInfo():null,idToken:s?s.rawToken:_.EMPTY_STRING,idTokenClaims:s?s.claims:{},accessToken:x,fromCache:i,expiresOn:R,correlationId:n.correlationId,requestId:h||_.EMPTY_STRING,extExpiresOn:z,familyId:we,tokenType:((p=o.accessToken)===null||p===void 0?void 0:p.tokenType)||_.EMPTY_STRING,state:a?a.userRequestState:_.EMPTY_STRING,cloudGraphHostName:((f=o.account)===null||f===void 0?void 0:f.cloudGraphHostName)||_.EMPTY_STRING,msGraphHost:((b=o.account)===null||b===void 0?void 0:b.msGraphHost)||_.EMPTY_STRING,code:u?.spa_code,fromNativeBroker:!1}]}})})},r}();var du=function(r){at(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.includeRedirectUri=!0,i}return e.prototype.getAuthCodeUrl=function(t){var o,i;return se(this,void 0,void 0,function(){var n;return ae(this,function(s){switch(s.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.GetAuthCodeUrl,t.correlationId),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.AuthClientCreateQueryString,t.correlationId),[4,this.createAuthCodeUrlQueryString(t)];case 1:return n=s.sent(),[2,Se.appendQueryString(this.authority.authorizationEndpoint,n)]}})})},e.prototype.acquireToken=function(t,o){var i,n,s,a,u,h;return se(this,void 0,void 0,function(){var p,f,b,x,S,R,z=this;return ae(this,function(we){switch(we.label){case 0:if(!t||!t.code)throw H.createTokenRequestCannotBeMadeError();return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement($.AuthClientAcquireToken,t.correlationId),p=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement("AuthCodeClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in auth-code client"),f=lt.nowSeconds(),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.AuthClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(this.authority,t)];case 1:return b=we.sent(),x=(a=b.headers)===null||a===void 0?void 0:a[Lt.X_MS_REQUEST_ID],S=(u=b.headers)===null||u===void 0?void 0:u[Lt.X_MS_HTTP_VERSION],S&&p?.addStaticFields({httpVerAuthority:S}),R=new ao(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient),R.validateTokenResponse(b.body),(h=this.performanceClient)===null||h===void 0||h.setPreQueueTime($.HandleServerTokenResponse,t.correlationId),[2,R.handleServerTokenResponse(b.body,this.authority,f,t,o,void 0,void 0,void 0,x).then(function(re){return p?.endMeasurement({success:!0}),re}).catch(function(re){throw z.logger.verbose("Error in fetching token in ACC",t.correlationId),p?.endMeasurement({errorCode:re.errorCode,subErrorCode:re.subError,success:!1}),re})]}})})},e.prototype.handleFragmentResponse=function(t,o){var i=new ao(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new Se(t),s=Se.getDeserializedHash(n.getHash());if(i.validateServerAuthorizationCodeResponse(s,o,this.cryptoUtils),!s.code)throw H.createNoAuthCodeInServerResponseError();return nt(nt({},s),{code:s.code})},e.prototype.getLogoutUri=function(t){if(!t)throw We.createEmptyLogoutRequestError();var o=this.createLogoutUrlQueryString(t);return Se.appendQueryString(this.authority.endSessionEndpoint,o)},e.prototype.executeTokenRequest=function(t,o){var i,n;return se(this,void 0,void 0,function(){var s,a,u,h,p,f,b;return ae(this,function(x){switch(x.label){case 0:return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement($.AuthClientExecuteTokenRequest,o.correlationId),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.AuthClientCreateTokenRequestBody,o.correlationId),s=this.createTokenQueryParameters(o),a=Se.appendQueryString(t.tokenEndpoint,s),[4,this.createTokenRequestBody(o)];case 1:if(u=x.sent(),h=void 0,o.clientInfo)try{p=ia(o.clientInfo,this.cryptoUtils),h={credential:""+p.uid+Nt.CLIENT_INFO_SEPARATOR+p.utid,type:Sr.HOME_ACCOUNT_ID}}catch(S){this.logger.verbose("Could not parse client info for CCS Header: "+S)}return f=this.createTokenRequestHeaders(h||o.ccsCredential),b={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},[2,this.executePostToTokenEndpoint(a,u,f,b)]}})})},e.prototype.createTokenRequestBody=function(t){var o,i;return se(this,void 0,void 0,function(){var n,s,a,u,h,p,f,f,b;return ae(this,function(x){switch(x.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.AuthClientCreateTokenRequestBody,t.correlationId),n=new Ur,n.addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(t.redirectUri):ms.validateRedirectUri(t.redirectUri),n.addScopes(t.scopes),n.addAuthorizationCode(t.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&n.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(s=this.config.clientCredentials.clientAssertion,n.addClientAssertion(s.assertion),n.addClientAssertionType(s.assertionType)),n.addGrantType(jo.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),t.authenticationScheme!==ze.POP?[3,2]:(a=new ui(this.cryptoUtils,this.performanceClient),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.PopTokenGenerateCnf,t.correlationId),[4,a.generateCnf(t)]);case 1:return u=x.sent(),n.addPopToken(u.reqCnfString),[3,3];case 2:if(t.authenticationScheme===ze.SSH)if(t.sshJwk)n.addSshJwk(t.sshJwk);else throw We.createMissingSshJwkError();x.label=3;case 3:if(h=t.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(h),(!U.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(t.claims,this.config.authOptions.clientCapabilities),p=void 0,t.clientInfo)try{f=ia(t.clientInfo,this.cryptoUtils),p={credential:""+f.uid+Nt.CLIENT_INFO_SEPARATOR+f.utid,type:Sr.HOME_ACCOUNT_ID}}catch(S){this.logger.verbose("Could not parse client info for CCS Header: "+S)}else p=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&p)switch(p.type){case Sr.HOME_ACCOUNT_ID:try{f=Mn(p.credential),n.addCcsOid(f)}catch(S){this.logger.verbose("Could not parse home account ID for CCS Header: "+S)}break;case Sr.UPN:n.addCcsUpn(p.credential);break}return t.tokenBodyParameters&&n.addExtraQueryParameters(t.tokenBodyParameters),t.enableSpaAuthorizationCode&&(!t.tokenBodyParameters||!t.tokenBodyParameters[He.RETURN_SPA_CODE])&&n.addExtraQueryParameters((b={},b[He.RETURN_SPA_CODE]="1",b)),[2,n.createQueryString()]}})})},e.prototype.createAuthCodeUrlQueryString=function(t){var o;return se(this,void 0,void 0,function(){var i,n,s,a,u,h,h,h,p,f;return ae(this,function(b){switch(b.label){case 0:if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.AuthClientCreateQueryString,t.correlationId),i=new Ur,i.addClientId(this.config.authOptions.clientId),n=ea(t.scopes||[],t.extraScopesToConsent||[]),i.addScopes(n),i.addRedirectUri(t.redirectUri),s=t.correlationId||this.config.cryptoInterface.createNewGuid(),i.addCorrelationId(s),i.addResponseMode(t.responseMode),i.addResponseTypeCode(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&i.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&i.addPrompt(t.prompt),t.domainHint&&i.addDomainHint(t.domainHint),t.prompt!==ar.SELECT_ACCOUNT)if(t.sid&&t.prompt===ar.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),i.addSid(t.sid);else if(t.account){if(a=this.extractAccountSid(t.account),u=this.extractLoginHint(t.account),u){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),i.addLoginHint(u);try{h=Mn(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&t.prompt===ar.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),i.addSid(a);try{h=Mn(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),i.addLoginHint(t.loginHint),i.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),i.addLoginHint(t.account.username);try{h=Mn(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),i.addLoginHint(t.loginHint),i.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&i.addNonce(t.nonce),t.state&&i.addState(t.state),(!U.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&i.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(i.addNativeBroker(),t.authenticationScheme!==ze.POP?[3,2]:(p=new ui(this.cryptoUtils),[4,p.generateCnf(t)])):[3,2];case 1:f=b.sent(),i.addPopToken(f.reqCnfString),b.label=2;case 2:return[2,i.createQueryString()]}})})},e.prototype.createLogoutUrlQueryString=function(t){var o=new Ur;return t.postLogoutRedirectUri&&o.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&o.addCorrelationId(t.correlationId),t.idTokenHint&&o.addIdTokenHint(t.idTokenHint),t.state&&o.addState(t.state),t.logoutHint&&o.addLogoutHint(t.logoutHint),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),o.createQueryString()},e.prototype.extractAccountSid=function(t){var o;return((o=t.idTokenClaims)===null||o===void 0?void 0:o.sid)||null},e.prototype.extractLoginHint=function(t){var o;return((o=t.idTokenClaims)===null||o===void 0?void 0:o.login_hint)||null},e}(Ko);l();c();d();var l7=function(r){at(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){return se(this,void 0,void 0,function(){var o,i,n,s;return ae(this,function(a){switch(a.label){case 0:return[4,this.getDeviceCode(t)];case 1:return o=a.sent(),t.deviceCodeCallback(o),i=lt.nowSeconds(),[4,this.acquireTokenWithDeviceCode(t,o)];case 2:return n=a.sent(),s=new ao(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),s.validateTokenResponse(n),[4,s.handleServerTokenResponse(n,this.authority,i,t)];case 3:return[2,a.sent()]}})})},e.prototype.getDeviceCode=function(t){return se(this,void 0,void 0,function(){var o,i,n,s,a;return ae(this,function(u){return o=this.createExtraQueryParameters(t),i=Se.appendQueryString(this.authority.deviceCodeEndpoint,o),n=this.createQueryString(t),s=this.createTokenRequestHeaders(),a={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostRequestToDeviceCodeEndpoint(i,n,s,a)]})})},e.prototype.createExtraQueryParameters=function(t){var o=new Ur;return t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),o.createQueryString()},e.prototype.executePostRequestToDeviceCodeEndpoint=function(t,o,i,n){return se(this,void 0,void 0,function(){var s,a,u,h,p,f,b;return ae(this,function(x){switch(x.label){case 0:return[4,this.networkManager.sendPostRequest(n,t,{body:o,headers:i})];case 1:return s=x.sent().body,a=s.user_code,u=s.device_code,h=s.verification_uri,p=s.expires_in,f=s.interval,b=s.message,[2,{userCode:a,deviceCode:u,verificationUri:h,expiresIn:p,interval:f,message:b}]}})})},e.prototype.createQueryString=function(t){var o=new Ur;return o.addScopes(t.scopes),o.addClientId(this.config.authOptions.clientId),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),(!U.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e.prototype.continuePolling=function(t,o,i){if(i)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),H.createDeviceCodeCancelledError();if(o&&o<t&&lt.nowSeconds()>o)throw this.logger.error("User defined timeout for device code polling reached. The timeout was set for "+o),H.createUserTimeoutReachedError();if(lt.nowSeconds()>t)throw o&&this.logger.verbose("User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for "+o),this.logger.error("Device code expired. Expiration time of device code was "+t),H.createDeviceCodeExpiredError();return!0},e.prototype.acquireTokenWithDeviceCode=function(t,o){return se(this,void 0,void 0,function(){var i,n,s,a,u,h,p,f,b;return ae(this,function(x){switch(x.label){case 0:i=this.createTokenQueryParameters(t),n=Se.appendQueryString(this.authority.tokenEndpoint,i),s=this.createTokenRequestBody(t,o),a=this.createTokenRequestHeaders(),u=t.timeout?lt.nowSeconds()+t.timeout:void 0,h=lt.nowSeconds()+o.expiresIn,p=o.interval*1e3,x.label=1;case 1:return this.continuePolling(h,u,t.cancel)?(f={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[4,this.executePostToTokenEndpoint(n,s,a,f)]):[3,8];case 2:return b=x.sent(),b.body&&b.body.error?b.body.error!==_.AUTHORIZATION_PENDING?[3,4]:(this.logger.info("Authorization pending. Continue polling."),[4,lt.delay(p)]):[3,6];case 3:return x.sent(),[3,5];case 4:throw this.logger.info("Unexpected error in polling from the server"),no.createPostRequestFailed(b.body.error);case 5:return[3,7];case 6:return this.logger.verbose("Authorization completed successfully. Polling stopped."),[2,b.body];case 7:return[3,1];case 8:throw this.logger.error("Polling stopped for unknown reasons."),H.createDeviceCodeUnknownError()}})})},e.prototype.createTokenRequestBody=function(t,o){var i=new Ur;i.addScopes(t.scopes),i.addClientId(this.config.authOptions.clientId),i.addGrantType(jo.DEVICE_CODE_GRANT),i.addDeviceCode(o.deviceCode);var n=t.correlationId||this.config.cryptoInterface.createNewGuid();return i.addCorrelationId(n),i.addClientInfo(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addThrottling(),this.serverTelemetryManager&&i.addServerTelemetry(this.serverTelemetryManager),(!U.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(t.claims,this.config.authOptions.clientCapabilities),i.createQueryString()},e}(Ko);l();c();d();var uu=function(r){at(e,r);function e(t,o){return r.call(this,t,o)||this}return e.prototype.acquireToken=function(t){var o,i,n,s,a,u,h;return se(this,void 0,void 0,function(){var p,f,b,x,S,R,z=this;return ae(this,function(we){switch(we.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RefreshTokenClientAcquireToken,t.correlationId),p=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement($.RefreshTokenClientAcquireToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",t.correlationId),f=lt.nowSeconds(),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.RefreshTokenClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(t,this.authority)];case 1:return b=we.sent(),x=(s=b.headers)===null||s===void 0?void 0:s[Lt.X_MS_HTTP_VERSION],p?.addStaticFields({refreshTokenSize:((a=b.body.refresh_token)===null||a===void 0?void 0:a.length)||0}),x&&p?.addStaticFields({httpVerToken:x}),S=(u=b.headers)===null||u===void 0?void 0:u[Lt.X_MS_REQUEST_ID],R=new ao(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),R.validateTokenResponse(b.body),(h=this.performanceClient)===null||h===void 0||h.setPreQueueTime($.HandleServerTokenResponse,t.correlationId),[2,R.handleServerTokenResponse(b.body,this.authority,f,t,void 0,void 0,!0,t.forceCache,S).then(function(re){return p?.endMeasurement({success:!0}),re}).catch(function(re){throw z.logger.verbose("Error in fetching refresh token",t.correlationId),p?.endMeasurement({errorCode:re.errorCode,subErrorCode:re.subError,success:!1}),re})]}})})},e.prototype.acquireTokenByRefreshToken=function(t){var o,i,n,s;return se(this,void 0,void 0,function(){var a,u,h;return ae(this,function(p){if(!t)throw We.createEmptyTokenRequestError();if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),!t.account)throw H.createNoAccountInSilentRequestError();if(a=this.cacheManager.isAppMetadataFOCI(t.account.environment),a)try{return(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(f){if(u=f instanceof _r&&f.errorCode===Dn.noTokensFoundError.code,h=f instanceof no&&f.errorCode===Zp.INVALID_GRANT_ERROR&&f.subError===Zp.CLIENT_MISMATCH_ERROR,u||h)return(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw f}return(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)]})})},e.prototype.acquireTokenWithCachedRefreshToken=function(t,o){var i,n,s;return se(this,void 0,void 0,function(){var a,u,h;return ae(this,function(p){if((i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),a=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",t.correlationId),u=this.cacheManager.getRefreshToken(t.account,o),!u)throw a?.discardMeasurement(),_r.createNoTokensFoundError();return a?.endMeasurement({success:!0}),h=nt(nt({},t),{refreshToken:u.secret,authenticationScheme:t.authenticationScheme||ze.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:Sr.HOME_ACCOUNT_ID}}),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.RefreshTokenClientAcquireToken,t.correlationId),[2,this.acquireToken(h)]})})},e.prototype.executeTokenRequest=function(t,o){var i,n,s;return se(this,void 0,void 0,function(){var a,u,h,p,f,b;return ae(this,function(x){switch(x.label){case 0:return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement($.RefreshTokenClientExecuteTokenRequest,t.correlationId),a=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement($.RefreshTokenClientExecuteTokenRequest,t.correlationId),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.RefreshTokenClientCreateTokenRequestBody,t.correlationId),u=this.createTokenQueryParameters(t),h=Se.appendQueryString(o.tokenEndpoint,u),[4,this.createTokenRequestBody(t)];case 1:return p=x.sent(),f=this.createTokenRequestHeaders(t.ccsCredential),b={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(h,p,f,b).then(function(S){return a?.endMeasurement({success:!0}),S}).catch(function(S){throw a?.endMeasurement({success:!1}),S})]}})})},e.prototype.createTokenRequestBody=function(t){var o,i,n;return se(this,void 0,void 0,function(){var s,a,u,h,p,f,b;return ae(this,function(x){switch(x.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RefreshTokenClientCreateTokenRequestBody,t.correlationId),s=t.correlationId,a=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement($.BaseClientCreateTokenRequestHeaders,s),u=new Ur,u.addClientId(this.config.authOptions.clientId),u.addScopes(t.scopes),u.addGrantType(jo.REFRESH_TOKEN_GRANT),u.addClientInfo(),u.addLibraryInfo(this.config.libraryInfo),u.addApplicationTelemetry(this.config.telemetry.application),u.addThrottling(),this.serverTelemetryManager&&u.addServerTelemetry(this.serverTelemetryManager),u.addCorrelationId(s),u.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&u.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(h=this.config.clientCredentials.clientAssertion,u.addClientAssertion(h.assertion),u.addClientAssertionType(h.assertionType)),t.authenticationScheme!==ze.POP?[3,2]:(p=new ui(this.cryptoUtils,this.performanceClient),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.PopTokenGenerateCnf,t.correlationId),[4,p.generateCnf(t)]);case 1:return f=x.sent(),u.addPopToken(f.reqCnfString),[3,3];case 2:if(t.authenticationScheme===ze.SSH)if(t.sshJwk)u.addSshJwk(t.sshJwk);else throw a?.endMeasurement({success:!1}),We.createMissingSshJwkError();x.label=3;case 3:if((!U.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&u.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case Sr.HOME_ACCOUNT_ID:try{b=Mn(t.ccsCredential.credential),u.addCcsOid(b)}catch(S){this.logger.verbose("Could not parse home account ID for CCS Header: "+S)}break;case Sr.UPN:u.addCcsUpn(t.ccsCredential.credential);break}return a?.endMeasurement({success:!0}),[2,u.createQueryString()]}})})},e}(Ko);l();c();d();var c7=function(r){at(e,r);function e(t,o){var i=r.call(this,t)||this;return i.appTokenProvider=o,i}return e.prototype.acquireToken=function(t){return se(this,void 0,void 0,function(){var o;return ae(this,function(i){switch(i.label){case 0:return this.scopeSet=new Rt(t.scopes||[]),t.skipCache?[4,this.executeTokenRequest(t,this.authority)]:[3,2];case 1:return[2,i.sent()];case 2:return[4,this.getCachedAuthenticationResult(t)];case 3:return o=i.sent(),o?[2,o]:[3,4];case 4:return[4,this.executeTokenRequest(t,this.authority)];case 5:return[2,i.sent()]}})})},e.prototype.getCachedAuthenticationResult=function(t){var o,i;return se(this,void 0,void 0,function(){var n;return ae(this,function(s){switch(s.label){case 0:return n=this.readAccessTokenFromCache(),n?lt.isTokenExpired(n.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?((i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(wo.CACHED_ACCESS_TOKEN_EXPIRED),[2,null]):[4,ao.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:null,idToken:null,accessToken:n,refreshToken:null,appMetadata:null},!0,t)]:((o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(wo.NO_CACHED_ACCESS_TOKEN),[2,null]);case 1:return[2,s.sent()]}})})},e.prototype.readAccessTokenFromCache=function(){var t={homeAccountId:_.EMPTY_STRING,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:he.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:Rt.createSearchScopes(this.scopeSet.asArray())},o=this.cacheManager.getAccessTokensByFilter(t);if(o.length<1)return null;if(o.length>1)throw H.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.executeTokenRequest=function(t,o){return se(this,void 0,void 0,function(){var i,n,s,a,u,h,p,f,b,x,S,R;return ae(this,function(z){switch(z.label){case 0:return this.appTokenProvider?(this.logger.info("Using appTokenProvider extensibility."),s={correlationId:t.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:t.scopes,claims:t.claims},n=lt.nowSeconds(),[4,this.appTokenProvider(s)]):[3,2];case 1:return a=z.sent(),i={access_token:a.accessToken,expires_in:a.expiresInSeconds,refresh_in:a.refreshInSeconds,token_type:ze.BEARER},[3,4];case 2:return u=this.createTokenQueryParameters(t),h=Se.appendQueryString(o.tokenEndpoint,u),p=this.createTokenRequestBody(t),f=this.createTokenRequestHeaders(),b={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},n=lt.nowSeconds(),[4,this.executePostToTokenEndpoint(h,p,f,b)];case 3:x=z.sent(),i=x.body,z.label=4;case 4:return S=new ao(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),S.validateTokenResponse(i),[4,S.handleServerTokenResponse(i,this.authority,n,t)];case 5:return R=z.sent(),[2,R]}})})},e.prototype.createTokenRequestBody=function(t){var o=new Ur;o.addClientId(this.config.authOptions.clientId),o.addScopes(t.scopes,!1),o.addGrantType(jo.CLIENT_CREDENTIALS_GRANT),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();o.addCorrelationId(i),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret);var n=t.clientAssertion||this.config.clientCredentials.clientAssertion;return n&&(o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)),(!U.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e}(Ko);l();c();d();var d7=function(r){at(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){return se(this,void 0,void 0,function(){var o;return ae(this,function(i){switch(i.label){case 0:return this.scopeSet=new Rt(t.scopes||[]),o=this,[4,this.cryptoUtils.hashString(t.oboAssertion)];case 1:return o.userAssertionHash=i.sent(),t.skipCache?[4,this.executeTokenRequest(t,this.authority,this.userAssertionHash)]:[3,3];case 2:return[2,i.sent()];case 3:return i.trys.push([3,5,,7]),[4,this.getCachedAuthenticationResult(t)];case 4:return[2,i.sent()];case 5:return i.sent(),[4,this.executeTokenRequest(t,this.authority,this.userAssertionHash)];case 6:return[2,i.sent()];case 7:return[2]}})})},e.prototype.getCachedAuthenticationResult=function(t){var o,i;return se(this,void 0,void 0,function(){var n,s,a,u,h,p;return ae(this,function(f){switch(f.label){case 0:if(n=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,t),n){if(lt.isTokenExpired(n.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(wo.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),H.createRefreshRequiredError()}else throw(o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(wo.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),H.createRefreshRequiredError();return s=this.readIdTokenFromCacheForOBO(n.homeAccountId),u=null,s&&(a=new gr(s.secret,this.config.cryptoInterface),h=a.claims.oid?a.claims.oid:a.claims.sub,p={homeAccountId:s.homeAccountId,environment:s.environment,tenantId:s.realm,username:_.EMPTY_STRING,localAccountId:h||_.EMPTY_STRING},u=this.cacheManager.readAccountFromCache(p)),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,ao.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:u,accessToken:n,idToken:s,refreshToken:null,appMetadata:null},!0,t,a)];case 1:return[2,f.sent()]}})})},e.prototype.readIdTokenFromCacheForOBO=function(t){var o={homeAccountId:t,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:he.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},i=this.cacheManager.getIdTokensByFilter(o);return i.length<1?null:i[0]},e.prototype.readAccessTokenFromCacheForOBO=function(t,o){var i=o.authenticationScheme||ze.BEARER,n=i&&i.toLowerCase()!==ze.BEARER.toLowerCase()?he.ACCESS_TOKEN_WITH_AUTH_SCHEME:he.ACCESS_TOKEN,s={credentialType:n,clientId:t,target:Rt.createSearchScopes(this.scopeSet.asArray()),tokenType:i,keyId:o.sshKid,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:this.userAssertionHash},a=this.cacheManager.getAccessTokensByFilter(s),u=a.length;if(u<1)return null;if(u>1)throw H.createMultipleMatchingTokensInCacheError();return a[0]},e.prototype.executeTokenRequest=function(t,o,i){return se(this,void 0,void 0,function(){var n,s,a,u,h,p,f,b,x;return ae(this,function(S){switch(S.label){case 0:return n=this.createTokenQueryParameters(t),s=Se.appendQueryString(o.tokenEndpoint,n),a=this.createTokenRequestBody(t),u=this.createTokenRequestHeaders(),h={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},p=lt.nowSeconds(),[4,this.executePostToTokenEndpoint(s,a,u,h)];case 1:return f=S.sent(),b=new ao(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),b.validateTokenResponse(f.body),[4,b.handleServerTokenResponse(f.body,this.authority,p,t,void 0,i)];case 2:return x=S.sent(),[2,x]}})})},e.prototype.createTokenRequestBody=function(t){var o=new Ur;o.addClientId(this.config.authOptions.clientId),o.addScopes(t.scopes),o.addGrantType(jo.JWT_BEARER),o.addClientInfo(),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();if(o.addCorrelationId(i),o.addRequestTokenUse(He.ON_BEHALF_OF),o.addOboAssertion(t.oboAssertion),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)}return(t.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e}(Ko);l();c();d();var x0=function(r){at(e,r);function e(t,o){return r.call(this,t,o)||this}return e.prototype.acquireToken=function(t){return se(this,void 0,void 0,function(){var o,i;return ae(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,n.sent()];case 2:if(o=n.sent(),o instanceof H&&o.errorCode===j.tokenRefreshRequired.code)return i=new uu(this.config,this.performanceClient),[2,i.acquireTokenByRefreshToken(t)];throw o;case 3:return[2]}})})},e.prototype.acquireCachedToken=function(t){var o,i,n,s,a;return se(this,void 0,void 0,function(){var u,h;return ae(this,function(p){switch(p.label){case 0:if(!t)throw We.createEmptyTokenRequestError();if(t.forceRefresh)throw(o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(wo.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),H.createRefreshRequiredError();if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!U.isEmptyObj(t.claims))throw(i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(wo.CLAIMS_REQUESTED_CACHE_SKIPPED),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),H.createRefreshRequiredError();if(!t.account)throw H.createNoAccountInSilentRequestError();if(u=t.authority||this.authority.getPreferredCache(),h=this.cacheManager.readCacheRecord(t.account,t,u),h.accessToken){if(lt.wasClockTurnedBack(h.accessToken.cachedAt)||lt.isTokenExpired(h.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(s=this.serverTelemetryManager)===null||s===void 0||s.setCacheOutcome(wo.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),H.createRefreshRequiredError();if(h.accessToken.refreshOn&&lt.isTokenExpired(h.accessToken.refreshOn,0))throw(a=this.serverTelemetryManager)===null||a===void 0||a.setCacheOutcome(wo.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),H.createRefreshRequiredError()}else throw(n=this.serverTelemetryManager)===null||n===void 0||n.setCacheOutcome(wo.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),H.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(h,t)];case 1:return[2,p.sent()]}})})},e.prototype.generateResultFromCacheRecord=function(t,o){return se(this,void 0,void 0,function(){var i,n;return ae(this,function(s){switch(s.label){case 0:if(t.idToken&&(i=new gr(t.idToken.secret,this.config.cryptoInterface)),o.maxAge||o.maxAge===0){if(n=i?.claims.auth_time,!n)throw H.createAuthTimeNotFoundError();gr.checkMaxAge(n,o.maxAge)}return[4,ao.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,o,i)];case 1:return[2,s.sent()]}})})},e}(Ko);l();c();d();var u7=function(r){at(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){var o,i;return se(this,void 0,void 0,function(){var n,s,a,u,h,p;return ae(this,function(f){switch(f.label){case 0:return n=(o=this.performanceClient)===null||o===void 0?void 0:o.startMeasurement("UsernamePasswordClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in username-password client"),s=lt.nowSeconds(),[4,this.executeTokenRequest(this.authority,t)];case 1:return a=f.sent(),u=(i=a.headers)===null||i===void 0?void 0:i[Lt.X_MS_HTTP_VERSION],n?.addStaticFields({httpVerToken:u}),h=new ao(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),h.validateTokenResponse(a.body),p=h.handleServerTokenResponse(a.body,this.authority,s,t),[2,p]}})})},e.prototype.executeTokenRequest=function(t,o){return se(this,void 0,void 0,function(){var i,n,s,a,u;return ae(this,function(h){return i=this.createTokenQueryParameters(o),n=Se.appendQueryString(t.tokenEndpoint,i),s=this.createTokenRequestBody(o),a=this.createTokenRequestHeaders({credential:o.username,type:Sr.UPN}),u={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},[2,this.executePostToTokenEndpoint(n,s,a,u)]})})},e.prototype.createTokenRequestBody=function(t){var o=new Ur;o.addClientId(this.config.authOptions.clientId),o.addUsername(t.username),o.addPassword(t.password),o.addScopes(t.scopes),o.addResponseTypeForTokenAndIdToken(),o.addGrantType(jo.RESOURCE_OWNER_PASSWORD_GRANT),o.addClientInfo(),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();if(o.addCorrelationId(i),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)}return(!U.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.username&&o.addCcsUpn(t.username),o.createQueryString()},e}(Ko);l();c();d();l();c();d();function $k(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}l();c();d();var Ok={endpointMetadata:{"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},instanceDiscoveryMetadata:{"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}}},k0=Ok.endpointMetadata,S0=Ok.instanceDiscoveryMetadata;l();c();d();var vs;(function(r){r.AAD="AAD",r.OIDC="OIDC"})(vs||(vs={}));l();c();d();var _c=function(){function r(){this.expiresAt=lt.nowSeconds()+ml.REFRESH_TIME_SECONDS}return r.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},r.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},r.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},r.prototype.resetExpiresAt=function(){this.expiresAt=lt.nowSeconds()+ml.REFRESH_TIME_SECONDS},r.prototype.isExpired=function(){return this.expiresAt<=lt.nowSeconds()},r.isAuthorityMetadataEntity=function(e,t){return t?e.indexOf(ml.CACHE_KEY)===0&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"):!1},r}();l();c();d();function Mk(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}l();c();d();function Fk(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}l();c();d();var Dk=function(){function r(e,t,o){this.networkInterface=e,this.performanceClient=t,this.correlationId=o}return r.prototype.detectRegion=function(e,t){var o,i,n,s;return se(this,void 0,void 0,function(){var a,u,h,p,f;return ae(this,function(b){switch(b.label){case 0:if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RegionDiscoveryDetectRegion,this.correlationId),a=e,a)return[3,8];u=r.IMDS_OPTIONS,b.label=1;case 1:return b.trys.push([1,6,,7]),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(_.IMDS_VERSION,u)];case 2:return h=b.sent(),h.status===fl.httpSuccess&&(a=h.body,t.region_source=ps.IMDS),h.status!==fl.httpBadRequest?[3,5]:((n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(u)]);case 3:return p=b.sent(),p?((s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(p,u)]):(t.region_source=ps.FAILED_AUTO_DETECTION,[2,null]);case 4:f=b.sent(),f.status===fl.httpSuccess&&(a=f.body,t.region_source=ps.IMDS),b.label=5;case 5:return[3,7];case 6:return b.sent(),t.region_source=ps.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=ps.ENVIRONMENT_VARIABLE,b.label=9;case 9:return a||(t.region_source=ps.FAILED_AUTO_DETECTION),[2,a||null]}})})},r.prototype.getRegionFromIMDS=function(e,t){var o;return se(this,void 0,void 0,function(){return ae(this,function(i){return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(_.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,_.IMDS_TIMEOUT)]})})},r.prototype.getCurrentVersion=function(e){var t;return se(this,void 0,void 0,function(){var o;return ae(this,function(i){switch(i.label){case 0:(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.RegionDiscoveryGetCurrentVersion,this.correlationId),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(_.IMDS_ENDPOINT+"?format=json",e)];case 2:return o=i.sent(),o.status===fl.httpBadRequest&&o.body&&o.body["newest-versions"]&&o.body["newest-versions"].length>0?[2,o.body["newest-versions"][0]]:[2,null];case 3:return i.sent(),[2,null];case 4:return[2]}})})},r.IMDS_OPTIONS={headers:{Metadata:"true"}},r}();var ys=function(){function r(e,t,o,i,n,s,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=o,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=n,this.performanceClient=s,this.correlationId=a,this.regionDiscovery=new Dk(t,this.performanceClient,this.correlationId)}return r.prototype.getAuthorityType=function(e){if(e.HostNameAndPort.endsWith(_.CIAM_AUTH_URL))return kr.Ciam;var t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case _.ADFS:return kr.Adfs;case _.DSTS:return kr.Dsts}return kr.Default},Object.defineProperty(r.prototype,"authorityType",{get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Se(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw H.createLogoutNotSupportedError();return this.replacePath(this.metadata.end_session_endpoint)}else throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"jwksUri",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),r.prototype.canReplaceTenant=function(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===kr.Default&&this.protocolMode===vs.AAD},r.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},r.prototype.replacePath=function(e){var t=this,o=e,i=new Se(this.metadata.canonical_authority),n=i.getUrlComponents(),s=n.PathSegments,a=this.canonicalAuthorityUrlComponents.PathSegments;return a.forEach(function(u,h){var p=s[h];if(h===0&&t.canReplaceTenant(n)){var f=new Se(t.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];p!==f&&(t.logger.verbose("Replacing tenant domain name "+p+" with id "+f),p=f)}u!==p&&(o=o.replace("/"+p+"/","/"+u+"/"))}),this.replaceTenant(o)},Object.defineProperty(r.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===kr.Adfs||this.authorityType===kr.Dsts||this.protocolMode===vs.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),r.prototype.discoveryComplete=function(){return!!this.metadata},r.prototype.resolveEndpointsAsync=function(){var e,t,o;return se(this,void 0,void 0,function(){var i,n,s,a;return ae(this,function(u){switch(u.label){case 0:return(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement($.AuthorityResolveEndpointsAsync,this.correlationId),i=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort),i||(i=new _c,i.updateCanonicalAuthority(this.canonicalAuthority)),(t=this.performanceClient)===null||t===void 0||t.setPreQueueTime($.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(i)];case 1:return n=u.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,i.preferred_network),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime($.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(i)];case 2:return s=u.sent(),n!==di.CACHE&&s!==di.CACHE&&(i.resetExpiresAt(),i.updateCanonicalAuthority(this.canonicalAuthority)),a=this.cacheManager.generateAuthorityMetadataCacheKey(i.preferred_cache),this.cacheManager.setAuthorityMetadata(a,i),this.metadata=i,[2]}})})},r.prototype.updateEndpointMetadata=function(e){var t,o,i,n,s,a;return se(this,void 0,void 0,function(){var u,h;return ae(this,function(p){switch(p.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.AuthorityUpdateEndpointMetadata,this.correlationId),u=this.getEndpointMetadataFromConfig(),u?(e.updateEndpointMetadata(u,!1),[2,di.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,di.CACHE]:((o=this.performanceClient)===null||o===void 0||o.setPreQueueTime($.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return u=p.sent(),u?!((i=this.authorityOptions.azureRegionConfiguration)===null||i===void 0)&&i.azureRegion?((n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(u)]):[3,3]:[3,4];case 2:u=p.sent(),p.label=3;case 3:return e.updateEndpointMetadata(u,!0),[2,di.NETWORK];case 4:return h=this.getEndpointMetadataFromHardcodedValues(),h&&!this.authorityOptions.skipAuthorityMetadataCache?!((s=this.authorityOptions.azureRegionConfiguration)===null||s===void 0)&&s.azureRegion?((a=this.performanceClient)===null||a===void 0||a.setPreQueueTime($.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(h)]):[3,6]:[3,7];case 5:h=p.sent(),p.label=6;case 6:return e.updateEndpointMetadata(h,!1),[2,di.HARDCODED_VALUES];case 7:throw H.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},r.prototype.isAuthoritySameType=function(e){var t=new Se(e.canonical_authority),o=t.getUrlComponents().PathSegments;return o.length===this.canonicalAuthorityUrlComponents.PathSegments.length},r.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw We.createInvalidAuthorityMetadataError()}return null},r.prototype.getEndpointMetadataFromNetwork=function(){var e;return se(this,void 0,void 0,function(){var t,o;return ae(this,function(i){switch(i.label){case 0:(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement($.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return o=i.sent(),[2,$k(o.body)?o.body:null];case 3:return i.sent(),[2,null];case 4:return[2]}})})},r.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in k0?k0[this.canonicalAuthority]:null},r.prototype.updateMetadataWithRegionalInformation=function(e){var t,o,i,n;return se(this,void 0,void 0,function(){var s,a;return ae(this,function(u){switch(u.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),s=(o=this.authorityOptions.azureRegionConfiguration)===null||o===void 0?void 0:o.azureRegion,s?s!==_.AZURE_REGION_AUTO_DISCOVER_FLAG?(this.regionDiscoveryMetadata.region_outcome=Cc.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=s,[2,r.replaceWithRegionalInformation(e,s)]):((i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion((n=this.authorityOptions.azureRegionConfiguration)===null||n===void 0?void 0:n.environmentRegion,this.regionDiscoveryMetadata)]):[3,2];case 1:if(a=u.sent(),a)return this.regionDiscoveryMetadata.region_outcome=Cc.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,[2,r.replaceWithRegionalInformation(e,a)];this.regionDiscoveryMetadata.region_outcome=Cc.AUTO_DETECTION_REQUESTED_FAILED,u.label=2;case 2:return[2,e]}})})},r.prototype.updateCloudDiscoveryMetadata=function(e){var t,o;return se(this,void 0,void 0,function(){var i,n,s;return ae(this,function(a){switch(a.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||_.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||_.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||_.NOT_APPLICABLE)),i=this.getCloudDiscoveryMetadataFromConfig(),i?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(i,!1),[2,di.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),n=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found metadata in the cache."),[2,di.CACHE]):(n&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime($.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(i=a.sent(),i)return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(i,!0),[2,di.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),s=this.getCloudDiscoveryMetadataFromHarcodedValues(),s&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(s,!1),[2,di.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),We.createUntrustedAuthorityError()}})})},r.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===kr.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=r.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),We.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},r.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var e;return se(this,void 0,void 0,function(){var t,o,i,n,s,a,u,h;return ae(this,function(p){switch(p.label){case 0:(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement($.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),t=""+_.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",o={},i=null,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t,o)];case 2:if(n=p.sent(),s=void 0,a=void 0,Mk(n.body))s=n.body,a=s.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+s.tenant_discovery_endpoint);else if(Fk(n.body)){if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+n.status),s=n.body,s.error===_.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+s.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+s.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=r.getCloudDiscoveryMetadataFromNetworkResponse(a,this.hostnameAndPort),[3,4];case 3:return u=p.sent(),u instanceof X?this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: `+u.errorCode+`
Error Description: `+u.errorMessage):(h=u,this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: `+h.name+`
Error Description: `+h.message)),[2,null];case 4:return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,i]}})})},r.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in S0?S0[this.canonicalAuthority]:null},r.prototype.isInKnownAuthorities=function(){var e=this,t=this.authorityOptions.knownAuthorities.filter(function(o){return Se.getDomainFromUrl(o).toLowerCase()===e.hostnameAndPort});return t.length>0},r.generateAuthority=function(e,t){var o;if(t&&t.azureCloudInstance!==On.None){var i=t.tenant?t.tenant:_.DEFAULT_COMMON_TENANT;o=t.azureCloudInstance+"/"+i+"/"}return o||e},r.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},r.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var o=0;o<e.length;o++){var i=e[o];if(i.aliases.indexOf(t)>-1)return i}return null},r.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw H.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},r.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},r.isPublicCloudAuthority=function(e){return _.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},r.buildRegionalAuthorityString=function(e,t,o){var i=new Se(e);i.validateAsUri();var n=i.getUrlComponents(),s=t+"."+n.HostNameAndPort;this.isPublicCloudAuthority(n.HostNameAndPort)&&(s=t+"."+_.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var a=Se.constructAuthorityUriFromObject(nt(nt({},i.getUrlComponents()),{HostNameAndPort:s})).urlString;return o?a+"?"+o:a},r.replaceWithRegionalInformation=function(e,t){return e.authorization_endpoint=r.buildRegionalAuthorityString(e.authorization_endpoint,t),e.token_endpoint=r.buildRegionalAuthorityString(e.token_endpoint,t,_.REGIONAL_AUTH_NON_MSI_QUERY_STRING),e.end_session_endpoint&&(e.end_session_endpoint=r.buildRegionalAuthorityString(e.end_session_endpoint,t)),e},r.transformCIAMAuthority=function(e){var t=e.endsWith(_.FORWARD_SLASH)?e:""+e+_.FORWARD_SLASH,o=new Se(e),i=o.getUrlComponents();if(i.PathSegments.length===0&&i.HostNameAndPort.endsWith(_.CIAM_AUTH_URL)){var n=i.HostNameAndPort.split(".")[0];t=""+t+n+_.AAD_TENANT_DOMAIN_SUFFIX}return t},r.reservedTenantDomains=new Set(["{tenant}","{tenantid}",hs.COMMON,hs.CONSUMERS,hs.ORGANIZATIONS]),r}();l();c();d();var sa=function(){function r(){}return r.createDiscoveredInstance=function(e,t,o,i,n,s,a){return se(this,void 0,void 0,function(){var u,h,p;return ae(this,function(f){switch(f.label){case 0:s?.addQueueMeasurement($.AuthorityFactoryCreateDiscoveredInstance,a),u=ys.transformCIAMAuthority(e),h=r.createInstance(u,t,o,i,n,s,a),f.label=1;case 1:return f.trys.push([1,3,,4]),s?.setPreQueueTime($.AuthorityResolveEndpointsAsync,a),[4,h.resolveEndpointsAsync()];case 2:return f.sent(),[2,h];case 3:throw p=f.sent(),H.createEndpointDiscoveryIncompleteError(p);case 4:return[2]}})})},r.createInstance=function(e,t,o,i,n,s,a){if(U.isEmpty(e))throw We.createUrlEmptyError();return new ys(e,t,o,i,n,s,a)},r}();l();c();d();var yl=function(){function r(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return r.isServerTelemetryEntity=function(e,t){var o=e.indexOf($r.CACHE_KEY)===0,i=!0;return t&&(i=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),o&&i},r}();l();c();d();var ef=function(){function r(){}return r.isThrottlingEntity=function(e,t){var o=!1;e&&(o=e.indexOf(fs.THROTTLING_PREFIX)===0);var i=!0;return t&&(i=t.hasOwnProperty("throttleTime")),o&&i},r}();l();c();d();var _0={sendGetRequestAsync:function(){var r="Network interface - sendGetRequestAsync() has not been implemented for the Network interface.";return Promise.reject(X.createUnexpectedError(r))},sendPostRequestAsync:function(){var r="Network interface - sendPostRequestAsync() has not been implemented for the Network interface.";return Promise.reject(X.createUnexpectedError(r))}};l();c();d();l();c();d();var tf={missingKidError:{code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},missingAlgError:{code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."}},T0=function(r){at(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="JoseHeaderError",Object.setPrototypeOf(i,e.prototype),i}return e.createMissingKidError=function(){return new e(tf.missingKidError.code,tf.missingKidError.desc)},e.createMissingAlgError=function(){return new e(tf.missingAlgError.code,tf.missingAlgError.desc)},e}(X);var E0=function(){function r(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return r.getShrHeaderString=function(e){if(!e.kid)throw T0.createMissingKidError();if(!e.alg)throw T0.createMissingAlgError();var t=new r({typ:e.typ||Qp.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)},r}();l();c();d();var Lk=function(){function r(e){this.headers=e}return r.prototype.getShrNonce=function(){var e=this.headers[Lt.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw We.createInvalidAuthenticationHeaderError(Lt.AuthenticationInfo,"nextnonce challenge is missing.")}var o=this.headers[Lt.WWWAuthenticate];if(o){var i=this.parseChallenges(o);if(i.nonce)return i.nonce;throw We.createInvalidAuthenticationHeaderError(Lt.WWWAuthenticate,"nonce challenge is missing.")}throw We.createMissingNonceAuthenticationHeadersError()},r.prototype.parseChallenges=function(e){var t=e.indexOf(" "),o=e.substr(t+1).split(","),i={};return o.forEach(function(n){var s=n.split("="),a=s[0],u=s[1];i[a]=unescape(u.replace(/['"]+/g,_.EMPTY_STRING))}),i},r}();l();c();d();var I0=function(){function r(e,t){this.cacheOutcome=wo.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||_.EMPTY_STRING,this.wrapperVer=e.wrapperVer||_.EMPTY_STRING,this.telemetryCacheKey=$r.CACHE_KEY+Nt.CACHE_KEY_SEPARATOR+e.clientId}return r.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+$r.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join($r.VALUE_SEPARATOR),o=this.getRegionDiscoveryFields(),i=[e,o].join($r.VALUE_SEPARATOR);return[$r.SCHEMA_VERSION,i,t].join($r.CATEGORY_SEPARATOR)},r.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=r.maxErrorsToSend(e),o=e.failedRequests.slice(0,2*t).join($r.VALUE_SEPARATOR),i=e.errors.slice(0,t).join($r.VALUE_SEPARATOR),n=e.errors.length,s=t<n?$r.OVERFLOW_TRUE:$r.OVERFLOW_FALSE,a=[n,s].join($r.VALUE_SEPARATOR);return[$r.SCHEMA_VERSION,e.cacheHits,o,i,a].join($r.CATEGORY_SEPARATOR)},r.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=$r.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),U.isEmpty(e.subError)?U.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push($r.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},r.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},r.prototype.getLastRequests=function(){var e=new yl,t=this.cacheManager.getServerTelemetry(this.telemetryCacheKey);return t||e},r.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=r.maxErrorsToSend(e),o=e.errors.length;if(t===o)this.cacheManager.removeItem(this.telemetryCacheKey);else{var i=new yl;i.failedRequests=e.failedRequests.slice(t*2),i.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i)}},r.maxErrorsToSend=function(e){var t,o=0,i=0,n=e.errors.length;for(t=0;t<n;t++){var s=e.failedRequests[2*t]||_.EMPTY_STRING,a=e.failedRequests[2*t+1]||_.EMPTY_STRING,u=e.errors[t]||_.EMPTY_STRING;if(i+=s.toString().length+a.toString().length+u.length+3,i<$r.MAX_LAST_HEADER_BYTES)o+=1;else break}return o},r.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||_.EMPTY_STRING),e.push(this.regionSource||_.EMPTY_STRING),e.push(this.regionOutcome||_.EMPTY_STRING),e.join(",")},r.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},r.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},r}();l();c();d();var hu=function(){function r(e,t,o,i,n,s){this.authority=t,this.libraryName=i,this.libraryVersion=n,this.applicationTelemetry=s,this.clientId=e,this.logger=o,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return r.prototype.startPerformanceMeasurement=function(e,t){return{}},r.prototype.startPerformanceMeasuremeant=function(e,t){return{}},r.prototype.getIntFields=function(){return b0},r.prototype.getPreQueueTime=function(e,t){var o=this.preQueueTimeByCorrelationId.get(t);if(o){if(o.name!==e){this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement");return}}else{this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement");return}return o.time},r.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},r.prototype.addQueueMeasurement=function(e,t,o,i){if(!t){this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement");return}if(o===0)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+o);else if(!o){this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);return}var n={eventName:e,queueTime:o,manuallyCompleted:i},s=this.queueMeasurements.get(t);if(s)s.push(n),this.queueMeasurements.set(t,s);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var a=[n];this.queueMeasurements.set(t,a)}this.preQueueTimeByCorrelationId.delete(t)},r.prototype.startMeasurement=function(e,t){var o=this,i,n,s=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",s),this.logger.trace("PerformanceClient: Performance measurement started for "+e,s);var a=this.startPerformanceMeasuremeant(e,s);a.startMeasurement();var u={eventId:this.generateId(),status:kc.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:s,appName:(i=this.applicationTelemetry)===null||i===void 0?void 0:i.appName,appVersion:(n=this.applicationTelemetry)===null||n===void 0?void 0:n.appVersion};return this.cacheEventByCorrelationId(u),{endMeasurement:function(h){return o.endMeasurement(nt(nt({},u),h),a)},discardMeasurement:function(){return o.discardMeasurements(u.correlationId)},addStaticFields:function(h){return o.addStaticFields(h,u.correlationId)},increment:function(h){return o.increment(h,u.correlationId)},measurement:a,event:u}},r.prototype.endMeasurement=function(e,t){var o=this,i,n,s=this.eventsByCorrelationId.get(e.correlationId);if(!s)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var a=e.eventId===s.eventId,u={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};a?(u=this.getQueueInfo(e.correlationId),this.discardCache(s.correlationId)):(i=s.incompleteSubMeasurements)===null||i===void 0||i.delete(e.eventId),t?.endMeasurement();var h=t?.flushMeasurement();if(!h)return this.logger.trace("PerformanceClient: Performance measurement not taken",s.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+h+" ms",e.correlationId),!a)return s[e.name+"DurationMs"]=Math.floor(h),nt({},s);var p=nt(nt({},s),e),f=0;return(n=p.incompleteSubMeasurements)===null||n===void 0||n.forEach(function(b){o.logger.trace("PerformanceClient: Incomplete submeasurement "+b.name+" found for "+e.name,p.correlationId),f++}),p.incompleteSubMeasurements=void 0,p=nt(nt({},p),{durationMs:Math.round(h),queuedTimeMs:u.totalQueueTime,queuedCount:u.totalQueueCount,queuedManuallyCompletedCount:u.manuallyCompletedCount,status:kc.Completed,incompleteSubsCount:f}),this.truncateIntegralFields(p,this.getIntFields()),this.emitEvents([p],e.correlationId),p},r.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var o=this.eventsByCorrelationId.get(t);o?this.eventsByCorrelationId.set(t,nt(nt({},o),e)):this.logger.trace("PerformanceClient: Event not found for",t)},r.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var o=this.eventsByCorrelationId.get(t);if(o)for(var i in e)o.hasOwnProperty(i)||(o[i]=0),o[i]+=e[i];else this.logger.trace("PerformanceClient: Event not found for",t)},r.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,nt({},e)))},r.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var o=0,i=0,n=0;return t?.forEach(function(s){o+=s.queueTime,i++,n+=s.manuallyCompleted?1:0}),{totalQueueTime:o,totalQueueCount:i,manuallyCompletedCount:n}},r.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},r.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},r.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},r.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},r.prototype.emitEvents=function(e,t){var o=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach(function(i,n){o.logger.trace("PerformanceClient: Emitting event to callback "+n,t),i.apply(null,[e])})},r.prototype.truncateIntegralFields=function(e,t){t.forEach(function(o){o in e&&typeof e[o]=="number"&&(e[o]=Math.floor(e[o]))})},r}();l();c();d();var Nk=function(){function r(){}return r.prototype.startMeasurement=function(){},r.prototype.endMeasurement=function(){},r.prototype.flushMeasurement=function(){return null},r}(),A0=function(r){at(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.generateId=function(){return"callback-id"},e.prototype.startPerformanceMeasuremeant=function(){return new Nk},e.prototype.startPerformanceMeasurement=function(){return new Nk},e.prototype.calculateQueuedTime=function(t,o){return 0},e.prototype.addQueueMeasurement=function(t,o,i){},e.prototype.setPreQueueTime=function(t,o){},e}(hu);l();c();d();var V={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},authCodeOrNativeAccountRequired:{code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},spaCodeAndNativeAccountPresent:{code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},unableToAcquireTokenFromNativePlatform:{code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},nativeHandshakeTimeout:{code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},nativeExtensionNotInstalled:{code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},nativeConnectionNotEstablished:{code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},nativeBrokerCalledBeforeInitialize:{code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},nativePromptNotSupported:{code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."}},B=function(r){gt(e,r);function e(t,o){var i=r.call(this,t,o)||this;return Object.setPrototypeOf(i,e.prototype),i.name="BrowserAuthError",i}return e.createPkceNotGeneratedError=function(t){return new e(V.pkceNotGenerated.code,V.pkceNotGenerated.desc+" Detail:"+t)},e.createCryptoNotAvailableError=function(t){return new e(V.cryptoDoesNotExist.code,V.cryptoDoesNotExist.desc+" Detail:"+t)},e.createHttpMethodNotImplementedError=function(t){return new e(V.httpMethodNotImplementedError.code,V.httpMethodNotImplementedError.desc+" Given Method: "+t)},e.createEmptyNavigationUriError=function(){return new e(V.emptyNavigateUriError.code,V.emptyNavigateUriError.desc)},e.createEmptyHashError=function(t){return new e(V.hashEmptyError.code,V.hashEmptyError.desc+" Given Url: "+t)},e.createHashDoesNotContainStateError=function(){return new e(V.hashDoesNotContainStateError.code,V.hashDoesNotContainStateError.desc)},e.createHashDoesNotContainKnownPropertiesError=function(){return new e(V.hashDoesNotContainKnownPropertiesError.code,V.hashDoesNotContainKnownPropertiesError.desc)},e.createUnableToParseStateError=function(){return new e(V.unableToParseStateError.code,V.unableToParseStateError.desc)},e.createStateInteractionTypeMismatchError=function(){return new e(V.stateInteractionTypeMismatchError.code,V.stateInteractionTypeMismatchError.desc)},e.createInteractionInProgressError=function(){return new e(V.interactionInProgress.code,V.interactionInProgress.desc)},e.createPopupWindowError=function(t){var o=V.popupWindowError.desc;return o=U.isEmpty(t)?o:o+" Details: "+t,new e(V.popupWindowError.code,o)},e.createEmptyWindowCreatedError=function(){return new e(V.emptyWindowError.code,V.emptyWindowError.desc)},e.createUserCancelledError=function(){return new e(V.userCancelledError.code,V.userCancelledError.desc)},e.createMonitorPopupTimeoutError=function(){return new e(V.monitorPopupTimeoutError.code,V.monitorPopupTimeoutError.desc)},e.createMonitorIframeTimeoutError=function(){return new e(V.monitorIframeTimeoutError.code,V.monitorIframeTimeoutError.desc)},e.createRedirectInIframeError=function(t){return new e(V.redirectInIframeError.code,V.redirectInIframeError.desc+" (window.parent !== window) => "+t)},e.createBlockReloadInHiddenIframeError=function(){return new e(V.blockTokenRequestsInHiddenIframeError.code,V.blockTokenRequestsInHiddenIframeError.desc)},e.createBlockAcquireTokenInPopupsError=function(){return new e(V.blockAcquireTokenInPopupsError.code,V.blockAcquireTokenInPopupsError.desc)},e.createIframeClosedPrematurelyError=function(){return new e(V.iframeClosedPrematurelyError.code,V.iframeClosedPrematurelyError.desc)},e.createSilentLogoutUnsupportedError=function(){return new e(V.silentLogoutUnsupportedError.code,V.silentLogoutUnsupportedError.desc)},e.createNoAccountError=function(){return new e(V.noAccountError.code,V.noAccountError.desc)},e.createSilentPromptValueError=function(t){return new e(V.silentPromptValueError.code,V.silentPromptValueError.desc+" Given value: "+t)},e.createUnableToParseTokenRequestCacheError=function(){return new e(V.unableToParseTokenRequestCacheError.code,V.unableToParseTokenRequestCacheError.desc)},e.createNoTokenRequestCacheError=function(){return new e(V.noTokenRequestCacheError.code,V.noTokenRequestCacheError.desc)},e.createAuthRequestNotSetError=function(){return new e(V.authRequestNotSet.code,V.authRequestNotSet.desc)},e.createNoCachedAuthorityError=function(){return new e(V.noCachedAuthorityError.code,V.noCachedAuthorityError.desc)},e.createInvalidCacheTypeError=function(){return new e(V.invalidCacheType.code,""+V.invalidCacheType.desc)},e.createNonBrowserEnvironmentError=function(){return new e(V.notInBrowserEnvironment.code,V.notInBrowserEnvironment.desc)},e.createDatabaseNotOpenError=function(){return new e(V.databaseNotOpen.code,V.databaseNotOpen.desc)},e.createNoNetworkConnectivityError=function(){return new e(V.noNetworkConnectivity.code,V.noNetworkConnectivity.desc)},e.createPostRequestFailedError=function(t,o){return new e(V.postRequestFailed.code,V.postRequestFailed.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},e.createGetRequestFailedError=function(t,o){return new e(V.getRequestFailed.code,V.getRequestFailed.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},e.createFailedToParseNetworkResponseError=function(t){return new e(V.failedToParseNetworkResponse.code,V.failedToParseNetworkResponse.desc+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToLoadTokenError=function(t){return new e(V.unableToLoadTokenError.code,V.unableToLoadTokenError.desc+" | "+t)},e.createSigningKeyNotFoundInStorageError=function(t){return new e(V.signingKeyNotFoundInStorage.code,V.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+t)},e.createAuthCodeRequiredError=function(){return new e(V.authCodeRequired.code,V.authCodeRequired.desc)},e.createAuthCodeOrNativeAccountIdRequiredError=function(){return new e(V.authCodeOrNativeAccountRequired.code,V.authCodeOrNativeAccountRequired.desc)},e.createSpaCodeAndNativeAccountIdPresentError=function(){return new e(V.spaCodeAndNativeAccountPresent.code,V.spaCodeAndNativeAccountPresent.desc)},e.createDatabaseUnavailableError=function(){return new e(V.databaseUnavailable.code,V.databaseUnavailable.desc)},e.createUnableToAcquireTokenFromNativePlatformError=function(){return new e(V.unableToAcquireTokenFromNativePlatform.code,V.unableToAcquireTokenFromNativePlatform.desc)},e.createNativeHandshakeTimeoutError=function(){return new e(V.nativeHandshakeTimeout.code,V.nativeHandshakeTimeout.desc)},e.createNativeExtensionNotInstalledError=function(){return new e(V.nativeExtensionNotInstalled.code,V.nativeExtensionNotInstalled.desc)},e.createNativeConnectionNotEstablishedError=function(){return new e(V.nativeConnectionNotEstablished.code,V.nativeConnectionNotEstablished.desc)},e.createNativeBrokerCalledBeforeInitialize=function(){return new e(V.nativeBrokerCalledBeforeInitialize.code,V.nativeBrokerCalledBeforeInitialize.desc)},e.createNativePromptParameterNotSupportedError=function(){return new e(V.nativePromptNotSupported.code,V.nativePromptNotSupported.desc)},e}(X);l();c();d();var zr={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},wl={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},ln;(function(r){r.HandshakeRequest="Handshake",r.HandshakeResponse="HandshakeResponse",r.GetToken="GetToken",r.Response="Response"})(ln||(ln={}));var jt;(function(r){r.LocalStorage="localStorage",r.SessionStorage="sessionStorage",r.MemoryStorage="memoryStorage"})(jt||(jt={}));var Ii;(function(r){r.GET="GET",r.POST="POST"})(Ii||(Ii={}));var Je;(function(r){r.AUTHORITY="authority",r.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",r.SESSION_STATE="session.state",r.REQUEST_STATE="request.state",r.NONCE_IDTOKEN="nonce.id_token",r.ORIGIN_URI="request.origin",r.RENEW_STATUS="token.renew.status",r.URL_HASH="urlHash",r.REQUEST_PARAMS="request.params",r.SCOPES="scopes",r.INTERACTION_STATUS_KEY="interaction.status",r.CCS_CREDENTIAL="ccs.credential",r.CORRELATION_ID="request.correlationId",r.NATIVE_REQUEST="request.native",r.REDIRECT_CONTEXT="request.redirect.context"})(Je||(Je={}));var cn;(function(r){r.ACCOUNT_KEYS="msal.account.keys",r.TOKEN_KEYS="msal.token.keys"})(cn||(cn={}));var bl;(function(r){r.WRAPPER_SKU="wrapper.sku",r.WRAPPER_VER="wrapper.version"})(bl||(bl={}));var dt;(function(r){r[r.acquireTokenRedirect=861]="acquireTokenRedirect",r[r.acquireTokenPopup=862]="acquireTokenPopup",r[r.ssoSilent=863]="ssoSilent",r[r.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",r[r.handleRedirectPromise=865]="handleRedirectPromise",r[r.acquireTokenByCode=866]="acquireTokenByCode",r[r.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",r[r.logout=961]="logout",r[r.logoutPopup=962]="logoutPopup"})(dt||(dt={}));var oe;(function(r){r.Redirect="redirect",r.Popup="popup",r.Silent="silent",r.None="none"})(oe||(oe={}));var Br;(function(r){r.Startup="startup",r.Login="login",r.Logout="logout",r.AcquireToken="acquireToken",r.SsoSilent="ssoSilent",r.HandleRedirect="handleRedirect",r.None="none"})(Br||(Br={}));var P0={scopes:an},bs="jwk",R0;(function(r){r.React="@azure/msal-react",r.Angular="@azure/msal-angular"})(R0||(R0={}));var rf="msal.db",Hk=1,Uk=rf+".keys",lo;(function(r){r[r.Default=0]="Default",r[r.AccessToken=1]="AccessToken",r[r.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",r[r.RefreshToken=3]="RefreshToken",r[r.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",r[r.Skip=5]="Skip"})(lo||(lo={}));l();c();d();l();c();d();var $o={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}},ws=function(r){gt(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="BrowserConfigurationAuthError",Object.setPrototypeOf(i,e.prototype),i}return e.createRedirectUriEmptyError=function(){return new e($o.redirectUriNotSet.code,$o.redirectUriNotSet.desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e($o.postLogoutUriNotSet.code,$o.postLogoutUriNotSet.desc)},e.createStorageNotSupportedError=function(t){return new e($o.storageNotSupportedError.code,$o.storageNotSupportedError.desc+" Given Location: "+t)},e.createRedirectCallbacksNotSetError=function(){return new e($o.noRedirectCallbacksSet.code,$o.noRedirectCallbacksSet.desc)},e.createStubPcaInstanceCalledError=function(){return new e($o.stubPcaInstanceCalled.code,$o.stubPcaInstanceCalled.desc)},e.createInMemoryRedirectUnavailableError=function(){return new e($o.inMemRedirectUnavailable.code,$o.inMemRedirectUnavailable.desc)},e.createEntropyNotProvided=function(){return new e($o.entropyNotProvided.code,$o.entropyNotProvided.desc)},e}(X);var $0=function(){function r(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return r.prototype.validateWindowStorage=function(e){if(e!==jt.LocalStorage&&e!==jt.SessionStorage)throw ws.createStorageNotSupportedError(e);var t=!!window[e];if(!t)throw ws.createStorageNotSupportedError(e)},r.prototype.getItem=function(e){return this.windowStorage.getItem(e)},r.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},r.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},r.prototype.getKeys=function(){return Object.keys(this.windowStorage)},r.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},r}();l();c();d();var pu=function(){function r(){this.cache=new Map}return r.prototype.getItem=function(e){return this.cache.get(e)||null},r.prototype.setItem=function(e,t){this.cache.set(e,t)},r.prototype.removeItem=function(e){this.cache.delete(e)},r.prototype.getKeys=function(){var e=[];return this.cache.forEach(function(t,o){e.push(o)}),e},r.prototype.containsKey=function(e){return this.cache.has(e)},r.prototype.clear=function(){this.cache.clear()},r}();l();c();d();var of=function(){function r(){}return r.extractBrowserRequestState=function(e,t){if(U.isEmpty(t))return null;try{var o=so.parseRequestState(e,t);return o.libraryState.meta}catch(i){throw H.createInvalidStateError(t,i)}},r.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Se(e);return Se.getDeserializedHash(t.getHash())},r}();var fu=function(r){gt(e,r);function e(t,o,i,n){var s=r.call(this,t,i,n)||this;return s.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,s.cacheConfig=o,s.logger=n,s.internalStorage=new pu,s.browserStorage=s.setupBrowserStorage(s.cacheConfig.cacheLocation),s.temporaryCacheStorage=s.setupTemporaryCacheStorage(s.cacheConfig.temporaryCacheLocation,s.cacheConfig.cacheLocation),o.cacheMigrationEnabled&&(s.migrateCacheEntries(),s.createKeyMaps()),s}return e.prototype.setupBrowserStorage=function(t){switch(t){case jt.LocalStorage:case jt.SessionStorage:try{return new $0(t)}catch(o){this.logger.verbose(o);break}}return this.cacheConfig.cacheLocation=jt.MemoryStorage,new pu},e.prototype.setupTemporaryCacheStorage=function(t,o){switch(o){case jt.LocalStorage:case jt.SessionStorage:try{return new $0(t||jt.SessionStorage)}catch(i){return this.logger.verbose(i),this.internalStorage}case jt.MemoryStorage:default:return this.internalStorage}},e.prototype.migrateCacheEntries=function(){var t=this,o=_.CACHE_PREFIX+"."+mr.ID_TOKEN,i=_.CACHE_PREFIX+"."+mr.CLIENT_INFO,n=_.CACHE_PREFIX+"."+mr.ERROR,s=_.CACHE_PREFIX+"."+mr.ERROR_DESC,a=this.browserStorage.getItem(o),u=this.browserStorage.getItem(i),h=this.browserStorage.getItem(n),p=this.browserStorage.getItem(s),f=[a,u,h,p],b=[mr.ID_TOKEN,mr.CLIENT_INFO,mr.ERROR,mr.ERROR_DESC];b.forEach(function(x,S){return t.migrateCacheEntry(x,f[S])})},e.prototype.migrateCacheEntry=function(t,o){o&&this.setTemporaryCache(t,o,!0)},e.prototype.createKeyMaps=function(){var t=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var o=this.getItem(cn.ACCOUNT_KEYS),i=this.getItem(cn.TOKEN_KEYS+"."+this.clientId);if(o&&i){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}var n=this.browserStorage.getKeys();n.forEach(function(s){if(t.isCredentialKey(s)){var a=t.getItem(s);if(a){var u=t.validateAndParseJson(a);if(u&&u.hasOwnProperty("credentialType"))switch(u.credentialType){case he.ID_TOKEN:if(Ti.isIdTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+s+" found, saving key to token key map");var h=io.toObject(new Ti,u),p=t.updateCredentialCacheKey(s,h);t.addTokenKey(p,he.ID_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+s);break;case he.ACCESS_TOKEN:case he.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Ei.isAccessTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+s+" found, saving key to token key map");var f=io.toObject(new Ei,u),p=t.updateCredentialCacheKey(s,f);t.addTokenKey(p,he.ACCESS_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+s);break;case he.REFRESH_TOKEN:if(Fn.isRefreshTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+s+" found, saving key to token key map");var b=io.toObject(new Fn,u),p=t.updateCredentialCacheKey(s,b);t.addTokenKey(p,he.REFRESH_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+s);break}}}if(t.isAccountKey(s)){var a=t.getItem(s);if(a){var x=t.validateAndParseJson(a);x&&Ht.isAccountEntity(x)&&(t.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+s+" found, saving key to account key map"),t.addAccountKeyToMap(s))}}})},e.prototype.validateAndParseJson=function(t){try{var o=JSON.parse(t);return o&&typeof o=="object"?o:null}catch{return null}},e.prototype.getItem=function(t){return this.browserStorage.getItem(t)},e.prototype.setItem=function(t,o){this.browserStorage.setItem(t,o)},e.prototype.getAccount=function(t){this.logger.trace("BrowserCacheManager.getAccount called");var o=this.getItem(t);if(!o)return this.removeAccountKeyFromMap(t),null;var i=this.validateAndParseJson(o);return!i||!Ht.isAccountEntity(i)?(this.removeAccountKeyFromMap(t),null):io.toObject(new Ht,i)},e.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var o=t.generateAccountKey();this.setItem(o,JSON.stringify(t)),this.addAccountKeyToMap(o)},e.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var t=this.getItem(cn.ACCOUNT_KEYS);return t?JSON.parse(t):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},e.prototype.addAccountKeyToMap=function(t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+t);var o=this.getAccountKeys();o.indexOf(t)===-1?(o.push(t),this.setItem(cn.ACCOUNT_KEYS,JSON.stringify(o)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},e.prototype.removeAccountKeyFromMap=function(t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+t);var o=this.getAccountKeys(),i=o.indexOf(t);i>-1?(o.splice(i,1),this.setItem(cn.ACCOUNT_KEYS,JSON.stringify(o)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},e.prototype.removeAccount=function(t){return F(this,void 0,void 0,function(){return D(this,function(o){return r.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]})})},e.prototype.removeIdToken=function(t){r.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,he.ID_TOKEN)},e.prototype.removeAccessToken=function(t){return F(this,void 0,void 0,function(){return D(this,function(o){return r.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,he.ACCESS_TOKEN),[2]})})},e.prototype.removeRefreshToken=function(t){r.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,he.REFRESH_TOKEN)},e.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var t=this.getItem(cn.TOKEN_KEYS+"."+this.clientId);if(t){var o=this.validateAndParseJson(t);if(o&&o.hasOwnProperty("idToken")&&o.hasOwnProperty("accessToken")&&o.hasOwnProperty("refreshToken"))return o;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},e.prototype.addTokenKey=function(t,o){this.logger.trace("BrowserCacheManager addTokenKey called");var i=this.getTokenKeys();switch(o){case he.ID_TOKEN:i.idToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),i.idToken.push(t));break;case he.ACCESS_TOKEN:i.accessToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),i.accessToken.push(t));break;case he.REFRESH_TOKEN:i.refreshToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),i.refreshToken.push(t));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+o),H.createUnexpectedCredentialTypeError()}this.setItem(cn.TOKEN_KEYS+"."+this.clientId,JSON.stringify(i))},e.prototype.removeTokenKey=function(t,o){this.logger.trace("BrowserCacheManager removeTokenKey called");var i=this.getTokenKeys();switch(o){case he.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+t+" from map");var n=i.idToken.indexOf(t);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),i.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case he.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+t+" from map");var s=i.accessToken.indexOf(t);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),i.accessToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case he.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+t+" from map");var a=i.refreshToken.indexOf(t);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),i.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+o),H.createUnexpectedCredentialTypeError()}this.setItem(cn.TOKEN_KEYS+"."+this.clientId,JSON.stringify(i))},e.prototype.getIdTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,he.ID_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!Ti.isIdTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,he.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),io.toObject(new Ti,i))},e.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,he.ID_TOKEN)},e.prototype.getAccessTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,he.ACCESS_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!Ei.isAccessTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,he.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),io.toObject(new Ei,i))},e.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,he.ACCESS_TOKEN)},e.prototype.getRefreshTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,he.REFRESH_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!Fn.isRefreshTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,he.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),io.toObject(new Fn,i))},e.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,he.REFRESH_TOKEN)},e.prototype.getAppMetadata=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!Sc.isAppMetadataEntity(t,i)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),io.toObject(new Sc,i))},e.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var o=t.generateAppMetadataKey();this.setItem(o,JSON.stringify(t))},e.prototype.getServerTelemetry=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!yl.isServerTelemetryEntity(t,i)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),io.toObject(new yl,i))},e.prototype.setServerTelemetry=function(t,o){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(o))},e.prototype.getAuthorityMetadata=function(t){var o=this.internalStorage.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var i=this.validateAndParseJson(o);return i&&_c.isAuthorityMetadataEntity(t,i)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),io.toObject(new _c,i)):null},e.prototype.getAuthorityMetadataKeys=function(){var t=this,o=this.internalStorage.getKeys();return o.filter(function(i){return t.isAuthorityMetadata(i)})},e.prototype.setWrapperMetadata=function(t,o){this.internalStorage.setItem(bl.WRAPPER_SKU,t),this.internalStorage.setItem(bl.WRAPPER_VER,o)},e.prototype.getWrapperMetadata=function(){var t=this.internalStorage.getItem(bl.WRAPPER_SKU)||_.EMPTY_STRING,o=this.internalStorage.getItem(bl.WRAPPER_VER)||_.EMPTY_STRING;return[t,o]},e.prototype.setAuthorityMetadata=function(t,o){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(o))},e.prototype.getActiveAccount=function(){var t=this.generateCacheKey(mr.ACTIVE_ACCOUNT_FILTERS),o=this.getItem(t);if(!o){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var i=this.generateCacheKey(mr.ACTIVE_ACCOUNT),n=this.getItem(i);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var s=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}var a=this.validateAndParseJson(o);return a?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:a.homeAccountId,localAccountId:a.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},e.prototype.setActiveAccount=function(t){var o=this.generateCacheKey(mr.ACTIVE_ACCOUNT_FILTERS),i=this.generateCacheKey(mr.ACTIVE_ACCOUNT);if(t){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:t.homeAccountId,localAccountId:t.localAccountId};this.browserStorage.setItem(o,JSON.stringify(n)),this.browserStorage.setItem(i,t.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(o),this.browserStorage.removeItem(i)},e.prototype.getAccountInfoByFilter=function(t){var o=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+o.length+" accounts found"),o.filter(function(i){return!(t.username&&t.username.toLowerCase()!==i.username.toLowerCase()||t.homeAccountId&&t.homeAccountId!==i.homeAccountId||t.localAccountId&&t.localAccountId!==i.localAccountId||t.tenantId&&t.tenantId!==i.tenantId||t.environment&&t.environment!==i.environment)})},e.prototype.getAccountInfoByHints=function(t,o){var i=this.getAllAccounts().filter(function(n){if(o){var s=n.idTokenClaims&&n.idTokenClaims.sid;return o===s}return t?t===n.username:!1});if(i.length===1)return i[0];if(i.length>1)throw H.createMultipleMatchingAccountsInCacheError();return null},e.prototype.getThrottlingCache=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!ef.isThrottlingEntity(t,i)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),io.toObject(new ef,i))},e.prototype.setThrottlingCache=function(t,o){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(o))},e.prototype.getTemporaryCache=function(t,o){var i=o?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(i);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var s=this.temporaryCacheStorage.getItem(i);if(!s){if(this.cacheConfig.cacheLocation===jt.LocalStorage){var a=this.browserStorage.getItem(i);if(a)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),a}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s},e.prototype.setTemporaryCache=function(t,o,i){var n=i?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(n,o),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,o))},e.prototype.removeItem=function(t){this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t))},e.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},e.prototype.getKeys=function(){return bc(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},e.prototype.clear=function(){return F(this,void 0,void 0,function(){var t=this;return D(this,function(o){switch(o.label){case 0:return[4,this.removeAllAccounts()];case 1:return o.sent(),this.removeAppMetadata(),this.getKeys().forEach(function(i){(t.browserStorage.containsKey(i)||t.temporaryCacheStorage.containsKey(i))&&(i.indexOf(_.CACHE_PREFIX)!==-1||i.indexOf(t.clientId)!==-1)&&t.removeItem(i)}),this.internalStorage.clear(),[2]}})})},e.prototype.clearTokensAndKeysWithClaims=function(){return F(this,void 0,void 0,function(){var t,o,i=this;return D(this,function(n){switch(n.label){case 0:return this.logger.trace("BrowserCacheManager.clearTokensAndKeysWithClaims called"),t=this.getTokenKeys(),o=[],t.accessToken.forEach(function(s){var a=i.getAccessTokenCredential(s);a?.requestedClaimsHash&&s.includes(a.requestedClaimsHash.toLowerCase())&&o.push(i.removeAccessToken(s))}),[4,Promise.all(o)];case 1:return n.sent(),o.length>0&&this.logger.warning(o.length+" access tokens with claims in the cache keys have been removed from the cache."),[2]}})})},e.prototype.setItemCookie=function(t,o,i){var n=encodeURIComponent(t)+"="+encodeURIComponent(o)+";path=/;SameSite=Lax;";if(i){var s=this.getCookieExpirationTime(i);n+="expires="+s+";"}this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},e.prototype.getItemCookie=function(t){for(var o=encodeURIComponent(t)+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var s=i[n];s.charAt(0)===" ";)s=s.substring(1);if(s.indexOf(o)===0)return decodeURIComponent(s.substring(o.length,s.length))}return _.EMPTY_STRING},e.prototype.clearMsalCookies=function(){var t=this,o=_.CACHE_PREFIX+"."+this.clientId,i=document.cookie.split(";");i.forEach(function(n){for(;n.charAt(0)===" ";)n=n.substring(1);if(n.indexOf(o)===0){var s=n.split("=")[0];t.clearItemCookie(s)}})},e.prototype.clearItemCookie=function(t){this.setItemCookie(t,_.EMPTY_STRING,-1)},e.prototype.getCookieExpirationTime=function(t){var o=new Date,i=new Date(o.getTime()+t*this.COOKIE_LIFE_MULTIPLIER);return i.toUTCString()},e.prototype.getCache=function(){return this.browserStorage},e.prototype.setCache=function(){},e.prototype.generateCacheKey=function(t){var o=this.validateAndParseJson(t);return o?JSON.stringify(t):U.startsWith(t,_.CACHE_PREFIX)||U.startsWith(t,mr.ADAL_ID_TOKEN)?t:_.CACHE_PREFIX+"."+this.clientId+"."+t},e.prototype.generateAuthorityKey=function(t){var o=so.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Je.AUTHORITY+"."+o)},e.prototype.generateNonceKey=function(t){var o=so.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Je.NONCE_IDTOKEN+"."+o)},e.prototype.generateStateKey=function(t){var o=so.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Je.REQUEST_STATE+"."+o)},e.prototype.getCachedAuthority=function(t){var o=this.generateStateKey(t),i=this.getTemporaryCache(o);if(!i)return null;var n=this.generateAuthorityKey(i);return this.getTemporaryCache(n)},e.prototype.updateCacheEntries=function(t,o,i,n,s){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var a=this.generateStateKey(t);this.setTemporaryCache(a,t,!1);var u=this.generateNonceKey(t);this.setTemporaryCache(u,o,!1);var h=this.generateAuthorityKey(t);if(this.setTemporaryCache(h,i,!1),s){var p={credential:s.homeAccountId,type:Sr.HOME_ACCOUNT_ID};this.setTemporaryCache(Je.CCS_CREDENTIAL,JSON.stringify(p),!0)}else if(!U.isEmpty(n)){var p={credential:n,type:Sr.UPN};this.setTemporaryCache(Je.CCS_CREDENTIAL,JSON.stringify(p),!0)}},e.prototype.resetRequestCache=function(t){var o=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),U.isEmpty(t)||this.getKeys().forEach(function(i){i.indexOf(t)!==-1&&o.removeItem(i)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(Je.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Je.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Je.URL_HASH)),this.removeItem(this.generateCacheKey(Je.CORRELATION_ID)),this.removeItem(this.generateCacheKey(Je.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(Je.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},e.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var o=this.generateStateKey(t),i=this.temporaryCacheStorage.getItem(o);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+i),this.resetRequestCache(i||_.EMPTY_STRING)}this.clearMsalCookies()},e.prototype.cleanRequestByInteractionType=function(t){var o=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(i){if(i.indexOf(Je.REQUEST_STATE)!==-1){var n=o.temporaryCacheStorage.getItem(i);if(n){var s=of.extractBrowserRequestState(o.cryptoImpl,n);s&&s.interactionType===t&&(o.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),o.resetRequestCache(n))}}}),this.clearMsalCookies(),this.setInteractionInProgress(!1)},e.prototype.cacheCodeRequest=function(t,o){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var i=o.base64Encode(JSON.stringify(t));this.setTemporaryCache(Je.REQUEST_PARAMS,i,!0)},e.prototype.getCachedRequest=function(t,o){this.logger.trace("BrowserCacheManager.getCachedRequest called");var i=this.getTemporaryCache(Je.REQUEST_PARAMS,!0);if(!i)throw B.createNoTokenRequestCacheError();var n=this.validateAndParseJson(o.base64Decode(i));if(!n)throw B.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Je.REQUEST_PARAMS)),U.isEmpty(n.authority)){var s=this.generateAuthorityKey(t),a=this.getTemporaryCache(s);if(!a)throw B.createNoCachedAuthorityError();n.authority=a}return n},e.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var t=this.getTemporaryCache(Je.NATIVE_REQUEST,!0);if(!t)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var o=this.validateAndParseJson(t);return o||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},e.prototype.isInteractionInProgress=function(t){var o=this.getInteractionInProgress();return t?o===this.clientId:!!o},e.prototype.getInteractionInProgress=function(){var t=_.CACHE_PREFIX+"."+Je.INTERACTION_STATUS_KEY;return this.getTemporaryCache(t,!1)},e.prototype.setInteractionInProgress=function(t){var o=_.CACHE_PREFIX+"."+Je.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw B.createInteractionInProgressError();this.setTemporaryCache(o,this.clientId,!1)}else!t&&this.getInteractionInProgress()===this.clientId&&this.removeItem(o)},e.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(mr.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(mr.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var o=this.getTemporaryCache(mr.ID_TOKEN,!0);o&&(this.removeItem(this.generateCacheKey(mr.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var i=o||t;if(i){var n=new gr(i,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},e.prototype.updateCredentialCacheKey=function(t,o){var i=o.generateCredentialKey();if(t!==i){var n=this.getItem(t);if(n)return this.removeItem(t),this.setItem(i,n),this.logger.verbose("Updated an outdated "+o.credentialType+" cache key"),i;this.logger.error("Attempted to update an outdated "+o.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},e.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(Je.REDIRECT_CONTEXT,!0)},e.prototype.setRedirectRequestContext=function(t){this.setTemporaryCache(Je.REDIRECT_CONTEXT,t,!0)},e}(io),Bk=function(r,e){var t={cacheLocation:jt.MemoryStorage,temporaryCacheLocation:jt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};return new fu(r,t,oa,e)};l();c();d();l();c();d();l();c();d();var Tc="@azure/msal-browser",dn="2.38.3";l();c();d();l();c();d();var zk=function(){function r(){}return r.prototype.sendGetRequestAsync=function(e,t){return F(this,void 0,void 0,function(){var o,i,n;return D(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,fetch(e,{method:Ii.GET,headers:this.getFetchHeaders(t)})];case 1:return o=s.sent(),[3,3];case 2:throw i=s.sent(),window.navigator.onLine?B.createGetRequestFailedError(i,e):B.createNoNetworkConnectivityError();case 3:return s.trys.push([3,5,,6]),n={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 4:return[2,(n.body=s.sent(),n.status=o.status,n)];case 5:throw s.sent(),B.createFailedToParseNetworkResponseError(e);case 6:return[2]}})})},r.prototype.sendPostRequestAsync=function(e,t){return F(this,void 0,void 0,function(){var o,i,n,s;return D(this,function(a){switch(a.label){case 0:o=t&&t.body||_.EMPTY_STRING,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:Ii.POST,headers:this.getFetchHeaders(t),body:o})];case 2:return i=a.sent(),[3,4];case 3:throw n=a.sent(),window.navigator.onLine?B.createPostRequestFailedError(n,e):B.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),s={headers:this.getHeaderDict(i.headers)},[4,i.json()];case 5:return[2,(s.body=a.sent(),s.status=i.status,s)];case 6:throw a.sent(),B.createFailedToParseNetworkResponseError(e);case 7:return[2]}})})},r.prototype.getFetchHeaders=function(e){var t=new Headers;if(!(e&&e.headers))return t;var o=e.headers;return Object.keys(o).forEach(function(i){t.append(i,o[i])}),t},r.prototype.getHeaderDict=function(e){var t={};return e.forEach(function(o,i){t[i]=o}),t},r}();l();c();d();var Vk=function(){function r(){}return r.prototype.sendGetRequestAsync=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,this.sendRequestAsync(e,Ii.GET,t)]})})},r.prototype.sendPostRequestAsync=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,this.sendRequestAsync(e,Ii.POST,t)]})})},r.prototype.sendRequestAsync=function(e,t,o){var i=this;return new Promise(function(n,s){var a=new XMLHttpRequest;if(a.open(t,e,!0),i.setXhrHeaders(a,o),a.onload=function(){(a.status<200||a.status>=300)&&(t===Ii.POST?s(B.createPostRequestFailedError("Failed with status "+a.status,e)):s(B.createGetRequestFailedError("Failed with status "+a.status,e)));try{var u=JSON.parse(a.responseText),h={headers:i.getHeaderDict(a),body:u,status:a.status};n(h)}catch{s(B.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===Ii.POST?s(B.createPostRequestFailedError("Failed with status "+a.status,e)):s(B.createGetRequestFailedError("Failed with status "+a.status,e)):s(B.createNoNetworkConnectivityError())},t===Ii.POST&&o&&o.body)a.send(o.body);else if(t===Ii.GET)a.send();else throw B.createHttpMethodNotImplementedError(t)})},r.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var o=t.headers;Object.keys(o).forEach(function(i){e.setRequestHeader(i,o[i])})}},r.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders(),o=t.trim().split(/[\r\n]+/),i={};return o.forEach(function(n){var s=n.split(": "),a=s.shift(),u=s.join(": ");a&&u&&(i[a]=u)}),i},r}();var St=function(){function r(){}return r.clearHash=function(e){e.location.hash=_.EMPTY_STRING,typeof e.history.replaceState=="function"&&e.history.replaceState(null,_.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},r.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):_.EMPTY_STRING},r.isInIframe=function(){return window.parent!==window},r.isInPopup=function(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(zr.POPUP_NAME_PREFIX+".")===0},r.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},r.getHomepage=function(){var e=new Se(window.location.href),t=e.getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},r.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new zk:new Vk},r.blockReloadInHiddenIframes=function(){var e=Se.hashContainsKnownProperties(window.location.hash);if(e&&r.isInIframe())throw B.createBlockReloadInHiddenIframeError()},r.blockRedirectInIframe=function(e,t){var o=r.isInIframe();if(e===oe.Redirect&&o&&!t)throw B.createRedirectInIframeError(o)},r.blockAcquireTokenInPopups=function(){if(r.isInPopup())throw B.createBlockAcquireTokenInPopupsError()},r.blockNonBrowserEnvironment=function(e){if(!e)throw B.createNonBrowserEnvironmentError()},r.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw B.createNativeBrokerCalledBeforeInitialize()},r.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),o=e.indexOf("Trident/"),i=e.indexOf("Edge/"),n=t>0||o>0,s=i>0;return n||s},r}();var nf=function(){function r(e,t,o,i,n,s,a,u,h){this.config=e,this.browserStorage=t,this.browserCrypto=o,this.networkClient=this.config.system.networkClient,this.eventHandler=n,this.navigationClient=s,this.nativeMessageHandler=u,this.correlationId=h||this.browserCrypto.createNewGuid(),this.logger=i.clone(zr.MSAL_SKU,dn,this.correlationId),this.performanceClient=a}return r.prototype.clearCacheOnLogout=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){switch(t.label){case 0:if(!e)return[3,5];Ht.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Ht.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}})})},r.prototype.initializeBaseRequest=function(e,t){return F(this,void 0,void 0,function(){var o,i,n,s;return D(this,function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement($.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),o=e.authority||this.config.auth.authority,t?[4,this.validateRequestAuthority(o,t)]:[3,2];case 1:a.sent(),a.label=2;case 2:if(i=bc(e&&e.scopes||[]),n=ne(ne({},e),{correlationId:this.correlationId,authority:o,scopes:i}),!n.authenticationScheme)n.authenticationScheme=ze.BEARER,this.logger.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(n.authenticationScheme===ze.SSH){if(!e.sshJwk)throw We.createMissingSshJwkError();if(!e.sshKid)throw We.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+n.authenticationScheme+'" as configured in Auth request')}return this.config.cache.claimsBasedCachingEnabled&&e.claims&&!U.isEmptyObj(e.claims)?(s=n,[4,this.browserCrypto.hashString(e.claims)]):[3,4];case 3:s.requestedClaimsHash=a.sent(),a.label=4;case 4:return[2,n]}})})},r.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||St.getCurrentUri();return Se.getAbsoluteUrl(t,St.getCurrentUri())},r.prototype.validateRequestAuthority=function(e,t){return F(this,void 0,void 0,function(){var o;return D(this,function(i){switch(i.label){case 0:return[4,this.getDiscoveredAuthority(e)];case 1:if(o=i.sent(),!o.isAlias(t.environment))throw We.createAuthorityMismatchError();return[2]}})})},r.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var o={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new I0(o,this.browserStorage)},r.prototype.getDiscoveredAuthority=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){switch(o.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,sa.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:return[2,o.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,sa.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)];case 3:return[2,o.sent()]}})})},r}();var hi=function(r){gt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.initializeAuthorizationCodeRequest=function(t){return F(this,void 0,void 0,function(){var o,i;return D(this,function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return o=n.sent(),i=ne(ne({},t),{redirectUri:t.redirectUri,code:_.EMPTY_STRING,codeVerifier:o.verifier}),t.codeChallenge=o.challenge,t.codeChallengeMethod=_.S256_CODE_CHALLENGE_METHOD,[2,i]}})})},e.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",t?.correlationId);var o=ne({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var i=this.getLogoutHintFromIdTokenClaims(t.account);i&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),o.logoutHint=i)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!t||t.postLogoutRedirectUri!==null?t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",o.correlationId),o.postLogoutRedirectUri=Se.getAbsoluteUrl(t.postLogoutRedirectUri,St.getCurrentUri())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",o.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",o.correlationId),o.postLogoutRedirectUri=Se.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,St.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",o.correlationId),o.postLogoutRedirectUri=Se.getAbsoluteUrl(St.getCurrentUri(),St.getCurrentUri())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",o.correlationId),o},e.prototype.getLogoutHintFromIdTokenClaims=function(t){var o=t.idTokenClaims;if(o){if(o.login_hint)return o.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},e.prototype.createAuthCodeClient=function(t,o,i){return F(this,void 0,void 0,function(){var n;return D(this,function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime($.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new du(n,this.performanceClient)]}})})},e.prototype.getClientConfiguration=function(t,o,i){return F(this,void 0,void 0,function(){var n,s;return D(this,function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime($.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(o,i)];case 1:return n=a.sent(),s=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:zr.MSAL_SKU,version:dn,cpu:_.EMPTY_STRING,os:_.EMPTY_STRING},telemetry:this.config.telemetry}]}})})},e.prototype.validateAndExtractStateFromHash=function(t,o,i){if(this.logger.verbose("validateAndExtractStateFromHash called",i),!t.state)throw B.createHashDoesNotContainStateError();var n=of.extractBrowserRequestState(this.browserCrypto,t.state);if(!n)throw B.createUnableToParseStateError();if(n.interactionType!==o)throw B.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",i),t.state},e.prototype.getDiscoveredAuthority=function(t,o){var i;return F(this,void 0,void 0,function(){var n,s,a,u;return D(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement($.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=t||this.config.auth.authority,u=ys.generateAuthority(a,o||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime($.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,sa.createDiscoveredInstance(u,this.config.system.networkClient,this.browserStorage,s,this.logger,this.performanceClient,this.correlationId).then(function(p){return n.endMeasurement({success:!0}),p}).catch(function(p){throw n.endMeasurement({errorCode:p.errorCode,subErrorCode:p.subError,success:!1}),p})];case 1:return[2,h.sent()]}})})},e.prototype.initializeAuthorizationRequest=function(t,o){return F(this,void 0,void 0,function(){var i,n,s,a,u,h,p;return D(this,function(f){switch(f.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),i=this.getRedirectUri(t.redirectUri),n={interactionType:o},s=so.setRequestState(this.browserCrypto,t&&t.state||_.EMPTY_STRING,n),this.performanceClient.setPreQueueTime($.InitializeBaseRequest,this.correlationId),u=[{}],[4,this.initializeBaseRequest(t)];case 1:return a=ne.apply(void 0,[ne.apply(void 0,u.concat([f.sent()])),{redirectUri:i,state:s,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:pl.FRAGMENT}]),h=t.account||this.browserStorage.getActiveAccount(),h&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+h.homeAccountId,this.correlationId),a.account=h),U.isEmpty(a.loginHint)&&!h&&(p=this.browserStorage.getLegacyLoginHint(),p&&(a.loginHint=p)),[2,a]}})})},e}(nf);l();c();d();l();c();d();l();c();d();var Ec=function(){function r(e,t,o,i,n){this.authModule=e,this.browserStorage=t,this.authCodeRequest=o,this.logger=i,this.performanceClient=n}return r.prototype.handleCodeResponseFromHash=function(e,t,o,i){return F(this,void 0,void 0,function(){var n,s,a;return D(this,function(u){if(this.performanceClient.addQueueMeasurement($.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),U.isEmpty(e))throw B.createEmptyHashError(e);if(n=this.browserStorage.generateStateKey(t),s=this.browserStorage.getTemporaryCache(n),!s)throw H.createStateNotFoundError("Cached State");try{a=this.authModule.handleFragmentResponse(e,s)}catch(h){throw h instanceof no&&h.subError===V.userCancelledError.code?B.createUserCancelledError():h}return this.performanceClient.setPreQueueTime($.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(a,t,o,i)]})})},r.prototype.handleCodeResponseFromServer=function(e,t,o,i,n){return n===void 0&&(n=!0),F(this,void 0,void 0,function(){var s,a,u,h,p,f;return D(this,function(b){switch(b.label){case 0:if(this.performanceClient.addQueueMeasurement($.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),s=this.browserStorage.generateStateKey(t),a=this.browserStorage.getTemporaryCache(s),!a)throw H.createStateNotFoundError("Cached State");return u=this.browserStorage.generateNonceKey(a),h=this.browserStorage.getTemporaryCache(u),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime($.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,o,i)]):[3,2];case 1:b.sent(),b.label=2;case 2:return n&&(e.nonce=h||void 0),e.state=a,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(p=this.checkCcsCredentials(),p&&(this.authCodeRequest.ccsCredential=p)),this.performanceClient.setPreQueueTime($.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return f=b.sent(),this.browserStorage.cleanRequestByState(t),[2,f]}})})},r.prototype.updateTokenEndpointAuthority=function(e,t,o){return F(this,void 0,void 0,function(){var i,n;return D(this,function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement($.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),i="https://"+e+"/"+t.tenant+"/",[4,sa.createDiscoveredInstance(i,o,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return n=s.sent(),this.authModule.updateAuthority(n),[2]}})})},r.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(Je.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},r}();var sf=function(r){gt(e,r);function e(t,o,i,n,s,a){var u=r.call(this,t,o,i,n,a)||this;return u.browserCrypto=s,u}return e.prototype.initiateAuthRequest=function(t,o){return F(this,void 0,void 0,function(){var i,n;return D(this,function(s){switch(s.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),U.isEmpty(t)?[3,7]:(o.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Je.ORIGIN_URI,o.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Je.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),i={apiId:dt.acquireTokenRedirect,timeout:o.redirectTimeout,noHistory:!1},typeof o.onRedirectNavigate!="function"?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),n=o.onRedirectNavigate(t),n===!1?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,o.navigationClient.navigateExternal(t,i)])));case 1:return s.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,o.navigationClient.navigateExternal(t,i)];case 5:return s.sent(),[2];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),B.createEmptyNavigationUriError();case 8:return[2]}})})},e.prototype.handleCodeResponseFromHash=function(t,o,i,n){return F(this,void 0,void 0,function(){var s,a,u,h,p,f,b;return D(this,function(x){switch(x.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),U.isEmpty(t))throw B.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),s=this.browserStorage.generateStateKey(o),a=this.browserStorage.getTemporaryCache(s),!a)throw H.createStateNotFoundError("Cached State");try{u=this.authModule.handleFragmentResponse(t,a)}catch(S){throw S instanceof no&&S.subError===V.userCancelledError.code?B.createUserCancelledError():S}return h=this.browserStorage.generateNonceKey(a),p=this.browserStorage.getTemporaryCache(h),this.authCodeRequest.code=u.code,u.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(u.cloud_instance_host_name,i,n)]:[3,2];case 1:x.sent(),x.label=2;case 2:return u.nonce=p||void 0,u.state=a,u.client_info?this.authCodeRequest.clientInfo=u.client_info:(f=this.checkCcsCredentials(),f&&(this.authCodeRequest.ccsCredential=f)),[4,this.authModule.acquireToken(this.authCodeRequest,u)];case 3:return b=x.sent(),this.browserStorage.cleanRequestByState(o),[2,b]}})})},e}(Ec);l();c();d();var pe;(function(r){r.INITIALIZE_START="msal:initializeStart",r.INITIALIZE_END="msal:initializeEnd",r.ACCOUNT_ADDED="msal:accountAdded",r.ACCOUNT_REMOVED="msal:accountRemoved",r.LOGIN_START="msal:loginStart",r.LOGIN_SUCCESS="msal:loginSuccess",r.LOGIN_FAILURE="msal:loginFailure",r.ACQUIRE_TOKEN_START="msal:acquireTokenStart",r.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",r.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",r.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",r.SSO_SILENT_START="msal:ssoSilentStart",r.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",r.SSO_SILENT_FAILURE="msal:ssoSilentFailure",r.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",r.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",r.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",r.HANDLE_REDIRECT_START="msal:handleRedirectStart",r.HANDLE_REDIRECT_END="msal:handleRedirectEnd",r.POPUP_OPENED="msal:popupOpened",r.LOGOUT_START="msal:logoutStart",r.LOGOUT_SUCCESS="msal:logoutSuccess",r.LOGOUT_FAILURE="msal:logoutFailure",r.LOGOUT_END="msal:logoutEnd",r.RESTORE_FROM_BFCACHE="msal:restoreFromBFCache"})(pe||(pe={}));l();c();d();l();c();d();var aa;(function(r){r.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",r.USER_CANCEL="USER_CANCEL",r.NO_NETWORK="NO_NETWORK",r.TRANSIENT_ERROR="TRANSIENT_ERROR",r.PERSISTENT_ERROR="PERSISTENT_ERROR",r.DISABLED="DISABLED",r.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"})(aa||(aa={}));var mu={extensionError:{code:"ContentError"},userSwitch:{code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},tokensNotFoundInCache:{code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"}},Oo=function(r){gt(e,r);function e(t,o,i){var n=r.call(this,t,o)||this;return Object.setPrototypeOf(n,e.prototype),n.name="NativeAuthError",n.ext=i,n}return e.prototype.isFatal=function(){if(this.ext&&this.ext.status&&(this.ext.status===aa.PERSISTENT_ERROR||this.ext.status===aa.DISABLED))return!0;switch(this.errorCode){case mu.extensionError.code:return!0;default:return!1}},e.createError=function(t,o,i){if(i&&i.status)switch(i.status){case aa.ACCOUNT_UNAVAILABLE:return _r.createNativeAccountUnavailableError();case aa.USER_INTERACTION_REQUIRED:return new _r(t,o);case aa.USER_CANCEL:return B.createUserCancelledError();case aa.NO_NETWORK:return B.createNoNetworkConnectivityError()}return new e(t,o,i)},e.createUserSwitchError=function(){return new e(mu.userSwitch.code,mu.userSwitch.desc)},e.createTokensNotFoundInCacheError=function(){return new e(mu.tokensNotFoundInCache.code,mu.tokensNotFoundInCache.desc)},e}(X);l();c();d();var gu=function(r){gt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a;return D(this,function(u){switch(u.label){case 0:return o=this.performanceClient.startMeasurement($.SilentCacheClientAcquireToken,t.correlationId),i=this.initializeServerTelemetryManager(dt.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(i,t.authority,t.azureCloudOptions)];case 1:n=u.sent(),this.logger.verbose("Silent auth client created"),u.label=2;case 2:return u.trys.push([2,4,,5]),[4,n.acquireCachedToken(t)];case 3:return s=u.sent(),o.endMeasurement({success:!0,fromCache:!0}),[2,s];case 4:throw a=u.sent(),a instanceof B&&a.errorCode===V.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o.endMeasurement({errorCode:a instanceof X&&a.errorCode||void 0,subErrorCode:a instanceof X&&a.subError||void 0,success:!1}),a;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(B.createSilentLogoutUnsupportedError())},e.prototype.createSilentFlowClient=function(t,o,i){return F(this,void 0,void 0,function(){var n;return D(this,function(s){switch(s.label){case 0:return this.performanceClient.setPreQueueTime($.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new x0(n,this.performanceClient)]}})})},e.prototype.initializeSilentRequest=function(t,o){return F(this,void 0,void 0,function(){var i;return D(this,function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement($.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime($.InitializeBaseRequest,this.correlationId),i=[ne({},t)],[4,this.initializeBaseRequest(t,o)];case 1:return[2,ne.apply(void 0,[ne.apply(void 0,i.concat([n.sent()])),{account:o,forceRefresh:t.forceRefresh||!1}])]}})})},e}(hi);var un=function(r){gt(e,r);function e(t,o,i,n,s,a,u,h,p,f,b,x){var S=r.call(this,t,o,i,n,s,a,h,p,x)||this;return S.apiId=u,S.accountId=f,S.nativeMessageHandler=p,S.nativeStorageManager=b,S.silentCacheClient=new gu(t,S.nativeStorageManager,i,n,s,a,h,p,x),S}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h;return D(this,function(p){switch(p.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),o=this.performanceClient.startMeasurement($.NativeInteractionClientAcquireToken,t.correlationId),i=lt.nowSeconds(),[4,this.initializeNativeRequest(t)];case 1:n=p.sent(),p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return s=p.sent(),o.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,s];case 4:return p.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return a={method:ln.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(a)];case 6:return u=p.sent(),h=this.validateNativeResponse(u),[2,this.handleNativeResponse(h,n,i).then(function(f){return o.endMeasurement({success:!0,isNativeBroker:!0,requestId:f.requestId}),f}).catch(function(f){throw o.endMeasurement({success:!1,errorCode:f.errorCode,subErrorCode:f.subError,isNativeBroker:!0}),f})]}})})},e.prototype.createSilentCacheRequest=function(t,o){return{authority:t.authority,correlationId:this.correlationId,scopes:Rt.fromString(t.scope).asArray(),account:o,forceRefresh:!1}},e.prototype.acquireTokensFromCache=function(t,o){return F(this,void 0,void 0,function(){var i,n,s,a;return D(this,function(u){switch(u.label){case 0:if(!t)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),H.createNoAccountFoundError();if(i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t}),!i)throw H.createNoAccountFoundError();u.label=1;case 1:return u.trys.push([1,3,,4]),n=this.createSilentCacheRequest(o,i),[4,this.silentCacheClient.acquireToken(n)];case 2:return s=u.sent(),[2,s];case 3:throw a=u.sent(),a;case 4:return[2]}})})},e.prototype.acquireTokenRedirect=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u;return D(this,function(h){switch(h.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:o=h.sent(),i={method:ln.GetToken,request:o},h.label=2;case 2:return h.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(i)];case 3:return n=h.sent(),this.validateNativeResponse(n),[3,5];case 4:if(s=h.sent(),s instanceof Oo&&s.isFatal())throw s;return[3,5];case 5:return this.browserStorage.setTemporaryCache(Je.NATIVE_REQUEST,JSON.stringify(o),!0),a={apiId:dt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(u,a)];case 6:return h.sent(),[2]}})})},e.prototype.handleRedirectPromise=function(){return F(this,void 0,void 0,function(){var t,o,i,n,s,a,u,h;return D(this,function(p){switch(p.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(t=this.browserStorage.getCachedNativeRequest(),!t)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];o=t.prompt,i=f0(t,["prompt"]),o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Je.NATIVE_REQUEST)),n={method:ln.GetToken,request:i},s=lt.nowSeconds(),p.label=1;case 1:return p.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return a=p.sent(),this.validateNativeResponse(a),u=this.handleNativeResponse(a,i,s),this.browserStorage.setInteractionInProgress(!1),[2,u];case 3:throw h=p.sent(),this.browserStorage.setInteractionInProgress(!1),h;case 4:return[2]}})})},e.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},e.prototype.handleNativeResponse=function(t,o,i){return F(this,void 0,void 0,function(){var n,s,a,u,h,p;return D(this,function(f){switch(f.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),t.account.id!==o.accountId)throw Oo.createUserSwitchError();return[4,this.getDiscoveredAuthority(o.authority)];case 1:return n=f.sent(),s=n.getPreferredCache(),a=this.createIdTokenObj(t),u=this.createHomeAccountIdentifier(t,a),h=this.createAccountEntity(t,u,a,s),[4,this.generateAuthenticationResult(t,o,a,h,n.canonicalAuthority,i)];case 2:return p=f.sent(),this.cacheAccount(h),this.cacheNativeTokens(t,o,u,h,a,p.accessToken,p.tenantId,i),[2,p]}})})},e.prototype.createIdTokenObj=function(t){return new gr(t.id_token||_.EMPTY_STRING,this.browserCrypto)},e.prototype.createHomeAccountIdentifier=function(t,o){var i=Ht.generateHomeAccountId(t.client_info||_.EMPTY_STRING,kr.Default,this.logger,this.browserCrypto,o);return i},e.prototype.createAccountEntity=function(t,o,i,n){return Ht.createAccount(t.client_info,o,i,void 0,void 0,void 0,n,t.account.id)},e.prototype.generateScopes=function(t,o){return t.scope?Rt.fromString(t.scope):Rt.fromString(o.scope)},e.prototype.generatePopAccessToken=function(t,o){return F(this,void 0,void 0,function(){var i,n;return D(this,function(s){switch(s.label){case 0:if(o.tokenType!==ze.POP)return[3,2];if(t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,t.shr];if(i=new ui(this.browserCrypto),n={resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,shrNonce:o.shrNonce},!o.keyId)throw H.createKeyIdMissingError();return[4,i.signPopToken(t.access_token,o.keyId,n)];case 1:return[2,s.sent()];case 2:return[2,t.access_token]}})})},e.prototype.generateAuthenticationResult=function(t,o,i,n,s,a){return F(this,void 0,void 0,function(){var u,h,p,f,b,x,S,R;return D(this,function(z){switch(z.label){case 0:return u=this.addTelemetryFromNativeResponse(t),h=t.scope?Rt.fromString(t.scope):Rt.fromString(o.scope),p=t.account.properties||{},f=p.UID||i.claims.oid||i.claims.sub||_.EMPTY_STRING,b=p.TenantId||i.claims.tid||_.EMPTY_STRING,[4,this.generatePopAccessToken(t,o)];case 1:return x=z.sent(),S=o.tokenType===ze.POP?ze.POP:ze.BEARER,R={authority:s,uniqueId:f,tenantId:b,scopes:h.asArray(),account:n.getAccountInfo(),idToken:t.id_token,idTokenClaims:i.claims,accessToken:x,fromCache:u?this.isResponseFromCache(u):!1,expiresOn:new Date(Number(a+t.expires_in)*1e3),tokenType:S,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0},[2,R]}})})},e.prototype.cacheAccount=function(t){var o=this;this.browserStorage.setAccount(t),this.browserStorage.removeAccountContext(t).catch(function(i){o.logger.error("Error occurred while removing account context from browser storage. "+i)})},e.prototype.cacheNativeTokens=function(t,o,i,n,s,a,u,h){var p=Ti.createIdTokenEntity(i,o.authority,t.id_token||_.EMPTY_STRING,o.clientId,s.claims.tid||_.EMPTY_STRING),f=o.tokenType===ze.POP?_.SHR_NONCE_VALIDITY:(typeof t.expires_in=="string"?parseInt(t.expires_in,10):t.expires_in)||0,b=h+f,x=this.generateScopes(t,o),S=Ei.createAccessTokenEntity(i,o.authority,a,o.clientId,s?s.claims.tid||_.EMPTY_STRING:u,x.printScopes(),b,0,this.browserCrypto),R=new gs(n,p,S);this.nativeStorageManager.saveCacheRecord(R)},e.prototype.addTelemetryFromNativeResponse=function(t){var o=this.getMATSFromResponse(t);return o?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:o.broker_version,matsAccountJoinOnStart:o.account_join_on_start,matsAccountJoinOnEnd:o.account_join_on_end,matsDeviceJoin:o.device_join,matsPromptBehavior:o.prompt_behavior,matsApiErrorCode:o.api_error_code,matsUiVisible:o.ui_visible,matsSilentCode:o.silent_code,matsSilentBiSubCode:o.silent_bi_sub_code,matsSilentMessage:o.silent_message,matsSilentStatus:o.silent_status,matsHttpStatus:o.http_status,matsHttpEventCount:o.http_event_count},this.correlationId),o):null},e.prototype.validateNativeResponse=function(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw Oo.createUnexpectedError("Response missing expected properties.")},e.prototype.getMATSFromResponse=function(t){if(t.properties.MATS)try{return JSON.parse(t.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},e.prototype.isResponseFromCache=function(t){return typeof t.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached},e.prototype.initializeNativeRequest=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p,f,b,x=this;return D(this,function(S){switch(S.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),o=t.authority||this.config.auth.authority,t.account?[4,this.validateRequestAuthority(o,t.account)]:[3,2];case 1:S.sent(),S.label=2;case 2:return i=new Se(o),i.validateAsUri(),n=t.scopes,s=f0(t,["scopes"]),a=new Rt(n||[]),a.appendScopes(an),u=function(){switch(x.apiId){case dt.ssoSilent:case dt.acquireTokenSilent_silentFlow:return x.logger.trace("initializeNativeRequest: silent request sets prompt to none"),ar.NONE}if(!t.prompt){x.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(t.prompt){case ar.NONE:case ar.CONSENT:case ar.LOGIN:return x.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw x.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),B.createNativePromptParameterNotSupportedError()}},h=ne(ne({},s),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:i.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:u(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:ne(ne(ne({},t.extraQueryParameters),t.tokenQueryParameters),{telemetry:wl.MATS_TELEMETRY}),extendedExpiryToken:!1}),t.authenticationScheme!==ze.POP?[3,4]:(p={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},f=new ui(this.browserCrypto),[4,f.generateCnf(p)]);case 3:b=S.sent(),h.reqCnf=b.reqCnfString,h.keyId=b.kid,S.label=4;case 4:return[2,h]}})})},e}(nf);l();c();d();var pi=function(){function r(e,t,o,i){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=i,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=o,this.handshakeEvent=o.startMeasurement($.NativeMessageHandlerHandshake)}return r.prototype.sendMessage=function(e){return F(this,void 0,void 0,function(){var t,o=this;return D(this,function(i){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:wl.CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise(function(n,s){o.resolvers.set(t.responseId,{resolve:n,reject:s})})]})})},r.createProvider=function(e,t,o){return F(this,void 0,void 0,function(){var i,n;return D(this,function(s){switch(s.label){case 0:e.trace("NativeMessageHandler - createProvider called."),s.label=1;case 1:return s.trys.push([1,3,,5]),i=new r(e,t,o,wl.PREFERRED_EXTENSION_ID),[4,i.sendHandshakeRequest()];case 2:return s.sent(),[2,i];case 3:return s.sent(),n=new r(e,t,o),[4,n.sendHandshakeRequest()];case 4:return s.sent(),[2,n];case 5:return[2]}})})},r.prototype.sendHandshakeRequest=function(){return F(this,void 0,void 0,function(){var e,t=this;return D(this,function(o){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:wl.CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:{method:ln.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(i){t.onChannelMessage(i)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise(function(i,n){t.handshakeResolvers.set(e.responseId,{resolve:i,reject:n}),t.timeoutId=window.setTimeout(function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(B.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)},t.handshakeTimeoutMs)})]})})},r.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(!(!t.channel||t.channel!==wl.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===ln.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var o=this.handshakeResolvers.get(t.responseId);o&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),o.reject(B.createNativeExtensionNotInstalledError()))}}},r.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,o=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{var n=t.body.method;if(n===ln.Response){if(!o)return;var s=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(s)),s.status!=="Success")o.reject(Oo.createError(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?o.reject(Oo.createError(s.result.code,s.result.description,s.result.ext)):o.resolve(s.result);else throw X.createUnexpectedError("Event does not contain result.");this.resolvers.delete(t.responseId)}else if(n===ln.HandshakeResponse){if(!i)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(a){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+a.toString()),this.logger.errorPii("Unable to parse "+e),o?o.reject(a):i&&i.reject(a)}},r.prototype.getExtensionId=function(){return this.extensionId},r.prototype.getExtensionVersion=function(){return this.extensionVersion},r.isNativeAvailable=function(e,t,o,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!o)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case ze.BEARER:case ze.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},r}();var O0=function(r){gt(e,r);function e(t,o,i,n,s,a,u,h,p,f){var b=r.call(this,t,o,i,n,s,a,u,p,f)||this;return b.nativeStorage=h,b}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p,f,b=this;return D(this,function(x){switch(x.label){case 0:return this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,oe.Redirect)];case 1:o=x.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||_.EMPTY_STRING,o.account||null),i=this.initializeServerTelemetryManager(dt.acquireTokenRedirect),n=function(S){S.persisted&&(b.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),b.browserStorage.cleanRequestByState(o.state),b.eventHandler.emitEvent(pe.RESTORE_FROM_BFCACHE,oe.Redirect))},x.label=2;case 2:return x.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 3:return s=x.sent(),this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(i,o.authority,o.azureCloudOptions)];case 4:return a=x.sent(),this.logger.verbose("Auth code client created"),u=new sf(a,this.browserStorage,s,this.logger,this.browserCrypto,this.performanceClient),[4,a.getAuthCodeUrl(ne(ne({},o),{nativeBroker:pi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return h=x.sent(),p=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+p),window.addEventListener("pageshow",n),[4,u.initiateAuthRequest(h,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:p,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,x.sent()];case 7:throw f=x.sent(),f instanceof X&&f.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),i.cacheFailedRequest(f),this.browserStorage.cleanRequestByState(o.state),f;case 8:return[2]}})})},e.prototype.handleRedirectPromise=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p,f,b,x,S;return D(this,function(R){switch(R.label){case 0:o=this.initializeServerTelemetryManager(dt.handleRedirectPromise),R.label=1;case 1:if(R.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(i=this.getRedirectResponseHash(t||window.location.hash),!i)return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(oe.Redirect),[2,null];n=void 0;try{s=Se.getDeserializedHash(i),n=this.validateAndExtractStateFromHash(s,oe.Redirect),this.logger.verbose("State extracted from hash")}catch(z){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+z),this.browserStorage.cleanRequestByInteractionType(oe.Redirect),[2,null]}return a=this.browserStorage.getTemporaryCache(Je.ORIGIN_URI,!0)||_.EMPTY_STRING,u=Se.removeHashFromUrl(a),h=Se.removeHashFromUrl(window.location.href),u===h&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(i,n,o)]):[3,3];case 2:return p=R.sent(),a.indexOf("#")>-1&&St.replaceHash(a),[2,p];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(i,n,o)]);case 4:return!St.isInIframe()||this.config.system.allowRedirectInIframe?(this.browserStorage.setTemporaryCache(Je.URL_HASH,i,!0),f={apiId:dt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},b=!0,!a||a==="null"?(x=St.getHomepage(),this.browserStorage.setTemporaryCache(Je.ORIGIN_URI,x,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(x,f)]):[3,6]):[3,9];case 5:return b=R.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+a),[4,this.navigationClient.navigateInternal(a,f)];case 7:b=R.sent(),R.label=8;case 8:if(!b)return[2,this.handleHash(i,n,o)];R.label=9;case 9:return[2,null];case 10:throw S=R.sent(),S instanceof X&&S.setCorrelationId(this.correlationId),o.cacheFailedRequest(S),this.browserStorage.cleanRequestByInteractionType(oe.Redirect),S;case 11:return[2]}})})},e.prototype.getRedirectResponseHash=function(t){this.logger.verbose("getRedirectResponseHash called");var o=Se.hashContainsKnownProperties(t);if(o)return St.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var i=this.browserStorage.getTemporaryCache(Je.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Je.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),i},e.prototype.handleHash=function(t,o,i){return F(this,void 0,void 0,function(){var n,s,a,u,h,p,f,b=this;return D(this,function(x){switch(x.label){case 0:if(n=this.browserStorage.getCachedRequest(o,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),s=Se.getDeserializedHash(t),s.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw B.createNativeConnectionNotEstablishedError();return a=new un(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,s.accountId,this.nativeStorage,n.correlationId),u=so.parseRequestState(this.browserCrypto,o).userRequestState,[2,a.acquireToken(ne(ne({},n),{state:u,prompt:void 0})).finally(function(){b.browserStorage.cleanRequestByState(o)})]}if(h=this.browserStorage.getCachedAuthority(o),!h)throw B.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(i,h)];case 1:return p=x.sent(),this.logger.verbose("Auth code client created"),na.removeThrottle(this.browserStorage,this.config.auth.clientId,n),f=new sf(p,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient),[4,f.handleCodeResponseFromHash(t,o,p.authority,this.networkClient)];case 2:return[2,x.sent()]}})})},e.prototype.logout=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h;return D(this,function(p){switch(p.label){case 0:this.logger.verbose("logoutRedirect called"),o=this.initializeLogoutRequest(t),i=this.initializeServerTelemetryManager(dt.logout),p.label=1;case 1:return p.trys.push([1,10,,11]),this.eventHandler.emitEvent(pe.LOGOUT_START,oe.Redirect,t),[4,this.clearCacheOnLogout(o.account)];case 2:return p.sent(),n={apiId:dt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,o.correlationId),[4,this.createAuthCodeClient(i,t&&t.authority)];case 3:return s=p.sent(),this.logger.verbose("Auth code client created"),a=s.getLogoutUri(o),this.eventHandler.emitEvent(pe.LOGOUT_SUCCESS,oe.Redirect,o),t&&typeof t.onRedirectNavigate=="function"?(u=t.onRedirectNavigate(a),u===!1?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(a,n)])):[3,7];case 4:return p.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),p.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(a,n)];case 8:return p.sent(),[2];case 9:return[3,11];case 10:throw h=p.sent(),h instanceof X&&h.setCorrelationId(this.correlationId),i.cacheFailedRequest(h),this.eventHandler.emitEvent(pe.LOGOUT_FAILURE,oe.Redirect,null,h),this.eventHandler.emitEvent(pe.LOGOUT_END,oe.Redirect),h;case 11:return this.eventHandler.emitEvent(pe.LOGOUT_END,oe.Redirect),[2]}})})},e.prototype.getRedirectStartPage=function(t){var o=t||window.location.href;return Se.getAbsoluteUrl(o,St.getCurrentUri())},e}(hi);l();c();d();var M0=function(r){gt(e,r);function e(t,o,i,n,s,a,u,h,p,f){var b=r.call(this,t,o,i,n,s,a,u,p,f)||this;return b.unloadWindow=b.unloadWindow.bind(b),b.nativeStorage=h,b}return e.prototype.acquireToken=function(t){try{var o=this.generatePopupName(t.scopes||an,t.authority||this.config.auth.authority),i=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,o,i);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",o,i);return this.acquireTokenPopupAsync(t,o,i,n)}catch(s){return Promise.reject(s)}},e.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var o=this.initializeLogoutRequest(t),i=this.generateLogoutPopupName(o),n=t&&t.authority,s=t&&t.mainWindowRedirectUri,a=t?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(o,i,a,n,void 0,s);this.logger.verbose("asyncPopup set to false, opening popup");var u=this.openSizedPopup("about:blank",i,a);return this.logoutPopupAsync(o,i,a,n,u,s)}catch(h){return Promise.reject(h)}},e.prototype.acquireTokenPopupAsync=function(t,o,i,n){return F(this,void 0,void 0,function(){var s,a,u,h,p,f,b,x,S,R,z,we,re,ge,wt,je,it,Po=this;return D(this,function(Rr){switch(Rr.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),s=this.initializeServerTelemetryManager(dt.acquireTokenPopup),this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,oe.Popup)];case 1:a=Rr.sent(),this.browserStorage.updateCacheEntries(a.state,a.nonce,a.authority,a.loginHint||_.EMPTY_STRING,a.account||null),Rr.label=2;case 2:return Rr.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(a)];case 3:return u=Rr.sent(),this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(s,a.authority,a.azureCloudOptions)];case 4:return h=Rr.sent(),this.logger.verbose("Auth code client created"),p=pi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),f=void 0,p&&(f=this.performanceClient.startMeasurement($.FetchAccountIdWithNativeBroker,t.correlationId)),[4,h.getAuthCodeUrl(ne(ne({},a),{nativeBroker:p}))];case 5:return b=Rr.sent(),x=new Ec(h,this.browserStorage,u,this.logger,this.performanceClient),S={popup:n,popupName:o,popupWindowAttributes:i},R=this.initiateAuthRequest(b,S),this.eventHandler.emitEvent(pe.POPUP_OPENED,oe.Popup,{popupWindow:R},null),[4,this.monitorPopupForHash(R)];case 6:if(z=Rr.sent(),we=Se.getDeserializedHash(z),re=this.validateAndExtractStateFromHash(we,oe.Popup,a.correlationId),na.removeThrottle(this.browserStorage,this.config.auth.clientId,u),we.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),f&&f.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw B.createNativeConnectionNotEstablishedError();return ge=new un(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,we.accountId,this.nativeStorage,a.correlationId),wt=so.parseRequestState(this.browserCrypto,re).userRequestState,[2,ge.acquireToken(ne(ne({},a),{state:wt,prompt:void 0})).finally(function(){Po.browserStorage.cleanRequestByState(re)})]}return[4,x.handleCodeResponseFromHash(z,re,h.authority,this.networkClient)];case 7:return je=Rr.sent(),[2,je];case 8:throw it=Rr.sent(),n&&n.close(),it instanceof X&&it.setCorrelationId(this.correlationId),s.cacheFailedRequest(it),this.browserStorage.cleanRequestByState(a.state),it;case 9:return[2]}})})},e.prototype.logoutPopupAsync=function(t,o,i,n,s,a){return F(this,void 0,void 0,function(){var u,h,p,f,b,x,S;return D(this,function(R){switch(R.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(pe.LOGOUT_START,oe.Popup,t),u=this.initializeServerTelemetryManager(dt.logoutPopup),R.label=1;case 1:return R.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(t.account)];case 2:return R.sent(),this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(u,n)];case 3:return h=R.sent(),this.logger.verbose("Auth code client created"),p=h.getLogoutUri(t),this.eventHandler.emitEvent(pe.LOGOUT_SUCCESS,oe.Popup,t),f=this.openPopup(p,{popupName:o,popupWindowAttributes:i,popup:s}),this.eventHandler.emitEvent(pe.POPUP_OPENED,oe.Popup,{popupWindow:f},null),[4,this.waitForLogoutPopup(f)];case 4:return R.sent(),a?(b={apiId:dt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},x=Se.getAbsoluteUrl(a,St.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+x),this.navigationClient.navigateInternal(x,b)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw S=R.sent(),s&&s.close(),S instanceof X&&S.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(pe.LOGOUT_FAILURE,oe.Popup,null,S),this.eventHandler.emitEvent(pe.LOGOUT_END,oe.Popup),u.cacheFailedRequest(S),S;case 6:return this.eventHandler.emitEvent(pe.LOGOUT_END,oe.Popup),[2]}})})},e.prototype.initiateAuthRequest=function(t,o){if(U.isEmpty(t))throw this.logger.error("Navigate url is empty"),B.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+t),this.openPopup(t,o)},e.prototype.monitorPopupForHash=function(t){var o=this;return new Promise(function(i,n){var s=o.config.system.windowHashTimeout/o.config.system.pollIntervalMilliseconds,a=0;o.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var u=setInterval(function(){if(t.closed){o.logger.error("PopupHandler.monitorPopupForHash - window closed"),o.cleanPopup(),clearInterval(u),n(B.createUserCancelledError());return}var h=_.EMPTY_STRING,p=_.EMPTY_STRING;try{h=t.location.href,p=t.location.hash}catch{}U.isEmpty(h)||h==="about:blank"||(o.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),a++,p?(o.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(u),o.cleanPopup(t),Se.hashContainsKnownProperties(p)?(o.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),i(p)):(o.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),o.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+p),n(B.createHashDoesNotContainKnownPropertiesError()))):a>s&&(o.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(u),n(B.createMonitorPopupTimeoutError())))},o.config.system.pollIntervalMilliseconds)})},e.prototype.waitForLogoutPopup=function(t){var o=this;return new Promise(function(i){o.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval(function(){t.closed&&(o.logger.error("PopupHandler.waitForLogoutPopup - window closed"),o.cleanPopup(),clearInterval(n),i());var s=_.EMPTY_STRING;try{s=t.location.href}catch{}U.isEmpty(s)||s==="about:blank"||(o.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),o.cleanPopup(t),i())},o.config.system.pollIntervalMilliseconds)})},e.prototype.openPopup=function(t,o){try{var i=void 0;if(o.popup?(i=o.popup,this.logger.verbosePii("Navigating popup window to: "+t),i.location.assign(t)):typeof o.popup>"u"&&(this.logger.verbosePii("Opening popup window to: "+t),i=this.openSizedPopup(t,o.popupName,o.popupWindowAttributes)),!i)throw B.createEmptyWindowCreatedError();return i.focus&&i.focus(),this.currentWindow=i,window.addEventListener("beforeunload",this.unloadWindow),i}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),B.createPopupWindowError(n.toString())}},e.prototype.openSizedPopup=function(t,o,i){var n,s,a,u,h=window.screenLeft?window.screenLeft:window.screenX,p=window.screenTop?window.screenTop:window.screenY,f=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,x=(n=i.popupSize)===null||n===void 0?void 0:n.width,S=(s=i.popupSize)===null||s===void 0?void 0:s.height,R=(a=i.popupPosition)===null||a===void 0?void 0:a.top,z=(u=i.popupPosition)===null||u===void 0?void 0:u.left;return(!x||x<0||x>f)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),x=zr.POPUP_WIDTH),(!S||S<0||S>b)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),S=zr.POPUP_HEIGHT),(!R||R<0||R>b)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),R=Math.max(0,b/2-zr.POPUP_HEIGHT/2+p)),(!z||z<0||z>f)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),z=Math.max(0,f/2-zr.POPUP_WIDTH/2+h)),window.open(t,o,"width="+x+", height="+S+", top="+R+", left="+z+", scrollbars=yes")},e.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(oe.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()},e.prototype.cleanPopup=function(t){t&&t.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},e.prototype.generatePopupName=function(t,o){return zr.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+t.join("-")+"."+o+"."+this.correlationId},e.prototype.generateLogoutPopupName=function(t){var o=t.account&&t.account.homeAccountId;return zr.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+o+"."+this.correlationId},e}(hi);l();c();d();l();c();d();l();c();d();l();c();d();var F0=function(){function r(){}return r.prototype.navigateInternal=function(e,t){return r.defaultNavigateWindow(e,t)},r.prototype.navigateExternal=function(e,t){return r.defaultNavigateWindow(e,t)},r.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(function(o){setTimeout(function(){o(!0)},t.timeout)})},r}();var h7=6e4,vu=6e3,p7=3e4,f7=2e3;function qk(r,e){var t=r.auth,o=r.cache,i=r.system,n=r.telemetry,s={clientId:_.EMPTY_STRING,authority:""+_.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:_.EMPTY_STRING,authorityMetadata:_.EMPTY_STRING,redirectUri:_.EMPTY_STRING,postLogoutRedirectUri:_.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:vs.AAD,azureCloudOptions:{azureCloudInstance:On.None,tenant:_.EMPTY_STRING},skipAuthorityMetadataCache:!1},a={cacheLocation:jt.SessionStorage,temporaryCacheLocation:jt.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(o&&o.cacheLocation===jt.LocalStorage),claimsBasedCachingEnabled:!0},u={loggerCallback:function(){},logLevel:lr.Info,piiLoggingEnabled:!1},h=ne(ne({},Xp),{loggerOptions:u,networkClient:e?St.getBrowserNetworkClient():_0,navigationClient:new F0,loadFrameTimeout:0,windowHashTimeout:i?.loadFrameTimeout||h7,iframeHashTimeout:i?.loadFrameTimeout||vu,navigateFrameWait:e&&St.detectIEOrEdge()?500:0,redirectNavigationTimeout:p7,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:i?.nativeBrokerHandshakeTimeout||f7,pollIntervalMilliseconds:zr.DEFAULT_POLL_INTERVAL_MS,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),p=ne(ne({},i),{loggerOptions:i?.loggerOptions||u}),f={application:{appName:_.EMPTY_STRING,appVersion:_.EMPTY_STRING}},b={auth:ne(ne({},s),t),cache:ne(ne({},a),o),system:ne(ne({},h),p),telemetry:ne(ne({},f),n)};return b}var af=function(r){gt(e,r);function e(t,o,i,n,s,a){var u=r.call(this,t,o,i,n,a)||this;return u.navigateFrameWait=s.navigateFrameWait,u.pollIntervalMilliseconds=s.pollIntervalMilliseconds,u}return e.prototype.initiateAuthRequest=function(t){return F(this,void 0,void 0,function(){return D(this,function(o){switch(o.label){case 0:if(this.performanceClient.addQueueMeasurement($.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),U.isEmpty(t))throw this.logger.info("Navigate url is empty"),B.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime($.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(t)]):[3,2];case 1:return[2,o.sent()];case 2:return[2,this.loadFrameSync(t)]}})})},e.prototype.monitorIframeForHash=function(t,o){var i=this;return this.performanceClient.addQueueMeasurement($.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise(function(n,s){o<vu&&i.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+o+"ms) than the default ("+vu+"ms). This may result in timeouts.");var a=window.performance.now(),u=a+o,h=setInterval(function(){if(window.performance.now()>u){i.removeHiddenIframe(t),clearInterval(h),s(B.createMonitorIframeTimeoutError());return}var p=_.EMPTY_STRING,f=t.contentWindow;try{p=f?f.location.href:_.EMPTY_STRING}catch{}if(!U.isEmpty(p)){var b=f?f.location.hash:_.EMPTY_STRING;if(Se.hashContainsKnownProperties(b)){i.removeHiddenIframe(t),clearInterval(h),n(b);return}}},i.pollIntervalMilliseconds)})},e.prototype.loadFrame=function(t){var o=this;return this.performanceClient.addQueueMeasurement($.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise(function(i,n){var s=o.createHiddenIframe();setTimeout(function(){if(!s){n("Unable to load iframe");return}s.src=t,i(s)},o.navigateFrameWait)})},e.prototype.loadFrameSync=function(t){var o=this.createHiddenIframe();return o.src=t,o},e.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},e.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},e}(Ec);var D0=function(r){gt(e,r);function e(t,o,i,n,s,a,u,h,p,f,b){var x=r.call(this,t,o,i,n,s,a,h,f,b)||this;return x.apiId=u,x.nativeStorage=p,x}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a;return D(this,function(u){switch(u.label){case 0:if(this.performanceClient.addQueueMeasurement($.SilentIframeClientAcquireToken,t.correlationId),this.logger.verbose("acquireTokenByIframe called"),o=this.performanceClient.startMeasurement($.SilentIframeClientAcquireToken,t.correlationId),U.isEmpty(t.loginHint)&&U.isEmpty(t.sid)&&(!t.account||U.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==ar.NONE&&t.prompt!==ar.NO_SESSION)throw o.endMeasurement({success:!1}),B.createSilentPromptValueError(t.prompt);return this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(ne(ne({},t),{prompt:t.prompt||ar.NONE}),oe.Silent)];case 1:i=u.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||_.EMPTY_STRING,i.account||null),n=this.initializeServerTelemetryManager(this.apiId),u.label=2;case 2:return u.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(n,i.authority,i.azureCloudOptions)];case 3:return s=u.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime($.SilentIframeClientTokenHelper,t.correlationId),[4,this.silentTokenHelper(s,i).then(function(h){return o.endMeasurement({success:!0,fromCache:!1,requestId:h.requestId}),h})];case 4:return[2,u.sent()];case 5:throw a=u.sent(),a instanceof X&&a.setCorrelationId(this.correlationId),n.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(i.state),o.endMeasurement({errorCode:a instanceof X&&a.errorCode||void 0,subErrorCode:a instanceof X&&a.subError||void 0,success:!1}),a;case 6:return[2]}})})},e.prototype.logout=function(){return Promise.reject(B.createSilentLogoutUnsupportedError())},e.prototype.silentTokenHelper=function(t,o){return F(this,void 0,void 0,function(){var i,n,s,a,u,h,p,f,b,x=this;return D(this,function(S){switch(S.label){case 0:return this.performanceClient.addQueueMeasurement($.SilentIframeClientTokenHelper,o.correlationId),this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationCodeRequest,o.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 1:return i=S.sent(),this.performanceClient.setPreQueueTime($.GetAuthCodeUrl,o.correlationId),[4,t.getAuthCodeUrl(ne(ne({},o),{nativeBroker:pi.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,o.authenticationScheme)}))];case 2:return n=S.sent(),s=new af(t,this.browserStorage,i,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime($.SilentHandlerInitiateAuthRequest,o.correlationId),[4,s.initiateAuthRequest(n)];case 3:return a=S.sent(),this.performanceClient.setPreQueueTime($.SilentHandlerMonitorIframeForHash,o.correlationId),[4,s.monitorIframeForHash(a,this.config.system.iframeHashTimeout)];case 4:if(u=S.sent(),h=Se.getDeserializedHash(u),p=this.validateAndExtractStateFromHash(h,oe.Silent,i.correlationId),h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw B.createNativeConnectionNotEstablishedError();return f=new un(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,this.correlationId),b=so.parseRequestState(this.browserCrypto,p).userRequestState,[2,f.acquireToken(ne(ne({},o),{state:b,prompt:o.prompt||ar.NONE})).finally(function(){x.browserStorage.cleanRequestByState(p)})]}return this.performanceClient.setPreQueueTime($.HandleCodeResponseFromHash,o.correlationId),[2,s.handleCodeResponseFromHash(u,p,t.authority,this.networkClient)]}})})},e}(hi);l();c();d();var L0=function(r){gt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u=this;return D(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement($.SilentRefreshClientAcquireToken,t.correlationId),this.performanceClient.setPreQueueTime($.InitializeBaseRequest,t.correlationId),i=[ne({},t)],[4,this.initializeBaseRequest(t,t.account)];case 1:return o=ne.apply(void 0,i.concat([h.sent()])),n=this.performanceClient.startMeasurement($.SilentRefreshClientAcquireToken,o.correlationId),s=this.initializeServerTelemetryManager(dt.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(s,o.authority,o.azureCloudOptions)];case 2:return a=h.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime($.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),[2,a.acquireTokenByRefreshToken(o).then(function(p){return n.endMeasurement({success:!0,fromCache:p.fromCache,requestId:p.requestId}),p}).catch(function(p){throw p instanceof X&&p.setCorrelationId(u.correlationId),s.cacheFailedRequest(p),n.endMeasurement({errorCode:p.errorCode,subErrorCode:p.subError,success:!1}),p})]}})})},e.prototype.logout=function(){return Promise.reject(B.createSilentLogoutUnsupportedError())},e.prototype.createRefreshTokenClient=function(t,o,i){return F(this,void 0,void 0,function(){var n;return D(this,function(s){switch(s.label){case 0:return this.performanceClient.setPreQueueTime($.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new uu(n,this.performanceClient)]}})})},e}(hi);l();c();d();var N0=function(){function r(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return r.prototype.addEventCallback=function(e){if(typeof window<"u"){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},r.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},r.prototype.enableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},r.prototype.disableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},r.prototype.emitEvent=function(e,t,o,i){var n=this;if(typeof window<"u"){var s={eventType:e,interactionType:t||null,payload:o||null,error:i||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach(function(a,u){n.logger.verbose("Emitting event to callback "+u+": "+e),a.apply(null,[s])})}},r.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var o=JSON.parse(t);if(typeof o!="object"||!Ht.isAccountEntity(o))return;var i=io.toObject(new Ht,o),n=i.getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(pe.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(pe.ACCOUNT_REMOVED,void 0,n))}catch{return}},r}();l();c();d();l();c();d();l();c();d();var co=function(){function r(){}return r.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r}();var lf=function(){function r(e){this.cryptoObj=e}return r.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,co.decimalToHex(e[0])+co.decimalToHex(e[1])+co.decimalToHex(e[2])+co.decimalToHex(e[3])+"-"+co.decimalToHex(e[4])+co.decimalToHex(e[5])+"-"+co.decimalToHex(e[6])+co.decimalToHex(e[7])+"-"+co.decimalToHex(e[8])+co.decimalToHex(e[9])+"-"+co.decimalToHex(e[10])+co.decimalToHex(e[11])+co.decimalToHex(e[12])+co.decimalToHex(e[13])+co.decimalToHex(e[14])+co.decimalToHex(e[15])}catch{for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,n=_.EMPTY_STRING,s=0;s<36;s++)t[s]!=="-"&&t[s]!=="4"&&(i=Math.random()*16|0),t[s]==="x"?n+=o[i]:t[s]==="y"?(i&=3,i|=8,n+=o[i]):n+=t[s];return n}},r.prototype.isGuid=function(e){var t=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return t.test(e)},r}();l();c();d();l();c();d();var Wo=function(){function r(){}return r.stringToUtf8Arr=function(e){for(var t,o=0,i=e.length,n=0;n<i;n++)t=e.charCodeAt(n),o+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var s=new Uint8Array(o),a=0,u=0;a<o;u++)t=e.charCodeAt(u),t<128?s[a++]=t:t<2048?(s[a++]=192+(t>>>6),s[a++]=128+(t&63)):t<65536?(s[a++]=224+(t>>>12),s[a++]=128+(t>>>6&63),s[a++]=128+(t&63)):t<2097152?(s[a++]=240+(t>>>18),s[a++]=128+(t>>>12&63),s[a++]=128+(t>>>6&63),s[a++]=128+(t&63)):t<67108864?(s[a++]=248+(t>>>24),s[a++]=128+(t>>>18&63),s[a++]=128+(t>>>12&63),s[a++]=128+(t>>>6&63),s[a++]=128+(t&63)):(s[a++]=252+(t>>>30),s[a++]=128+(t>>>24&63),s[a++]=128+(t>>>18&63),s[a++]=128+(t>>>12&63),s[a++]=128+(t>>>6&63),s[a++]=128+(t&63));return s},r.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),o=new Uint8Array(t),i=0;i<e.length;i++)o[i]=e.charCodeAt(i);return t},r.utf8ArrToString=function(e){for(var t=_.EMPTY_STRING,o=void 0,i=e.length,n=0;n<i;n++)o=e[n],t+=String.fromCharCode(o>251&&o<254&&n+5<i?(o-252)*1073741824+(e[++n]-128<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>247&&o<252&&n+4<i?(o-248<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>239&&o<248&&n+3<i?(o-240<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>223&&o<240&&n+2<i?(o-224<<12)+(e[++n]-128<<6)+e[++n]-128:o>191&&o<224&&n+1<i?(o-192<<6)+e[++n]-128:o);return t},r.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},r}();var cf=function(){function r(){}return r.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,_.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},r.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,_.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},r.prototype.encode=function(e){var t=Wo.stringToUtf8Arr(e);return this.base64EncArr(t)},r.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,o=_.EMPTY_STRING,i=void 0,n=e.length,s=0,a=0;a<n;a++)i=a%3,s|=e[a]<<(16>>>i&24),(i===2||e.length-a===1)&&(o+=String.fromCharCode(this.uint6ToB64(s>>>18&63),this.uint6ToB64(s>>>12&63),this.uint6ToB64(s>>>6&63),this.uint6ToB64(s&63)),s=0);return t===0?o:o.substring(0,o.length-t)+(t===1?"=":"==")},r.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:e===62?43:e===63?47:65},r}();l();c();d();var Gk=function(){function r(){}return r.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var o=this.base64DecToArr(t);return Wo.utf8ArrToString(o)},r.prototype.base64DecToArr=function(e,t){for(var o=e.replace(/[^A-Za-z0-9\+\/]/g,_.EMPTY_STRING),i=o.length,n=t?Math.ceil((i*3+1>>>2)/t)*t:i*3+1>>>2,s=new Uint8Array(n),a=void 0,u=void 0,h=0,p=0,f=0;f<i;f++)if(u=f&3,h|=this.b64ToUint6(o.charCodeAt(f))<<18-6*u,u===3||i-f===1){for(a=0;a<3&&p<n;a++,p++)s[p]=h>>>(16>>>a&24)&255;h=0}return s},r.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:e===43?62:e===47?63:0},r}();l();c();d();var m7=32,jk=function(){function r(e){this.base64Encode=new cf,this.cryptoObj=e}return r.prototype.generateCodes=function(){return F(this,void 0,void 0,function(){var e,t;return D(this,function(o){switch(o.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=o.sent(),[2,{verifier:e,challenge:t}]}})})},r.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(m7);this.cryptoObj.getRandomValues(e);var t=this.base64Encode.urlEncodeArr(e);return t}catch(o){throw B.createPkceNotGeneratedError(o)}},r.prototype.generateCodeChallengeFromVerifier=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=i.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw o=i.sent(),B.createPkceNotGeneratedError(o);case 3:return[2]}})})},r}();l();c();d();l();c();d();var Kk=function(){function r(){}return r.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,window.crypto.subtle.generateKey(e,t,o)]})})},r.prototype.exportKey=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){return[2,window.crypto.subtle.exportKey(bs,e)]})})},r.prototype.importKey=function(e,t,o,i){return F(this,void 0,void 0,function(){return D(this,function(n){return[2,window.crypto.subtle.importKey(bs,e,t,o,i)]})})},r.prototype.sign=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,window.crypto.subtle.sign(e,t,o)]})})},r.prototype.digest=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,window.crypto.subtle.digest(e,t)]})})},r}();l();c();d();var Wk=function(){function r(){}return r.prototype.initPrng=function(e){return window.msrCrypto.initPrng(bc(e))},r.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,window.msrCrypto.subtle.generateKey(e,t,o)]})})},r.prototype.exportKey=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){return[2,window.msrCrypto.subtle.exportKey(bs,e)]})})},r.prototype.importKey=function(e,t,o,i){return F(this,void 0,void 0,function(){return D(this,function(n){return[2,window.msrCrypto.subtle.importKey(bs,e,t,o,i)]})})},r.prototype.sign=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,window.msrCrypto.subtle.sign(e,t,o)]})})},r.prototype.digest=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,window.msrCrypto.subtle.digest(e,t)]})})},r}();l();c();d();var Qk=function(){function r(){}return r.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,new Promise(function(n,s){var a=window.msCrypto.subtle.generateKey(e,t,o);a.addEventListener("complete",function(u){n(u.target.result)}),a.addEventListener("error",function(u){s(u)})})]})})},r.prototype.exportKey=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){return[2,new Promise(function(o,i){var n=window.msCrypto.subtle.exportKey(bs,e);n.addEventListener("complete",function(s){var a=s.target.result,u=Wo.utf8ArrToString(new Uint8Array(a)).replace(/\r/g,_.EMPTY_STRING).replace(/\n/g,_.EMPTY_STRING).replace(/\t/g,_.EMPTY_STRING).split(" ").join(_.EMPTY_STRING).replace("\0",_.EMPTY_STRING);try{o(JSON.parse(u))}catch(h){i(h)}}),n.addEventListener("error",function(s){i(s)})})]})})},r.prototype.importKey=function(e,t,o,i){return F(this,void 0,void 0,function(){var n,s;return D(this,function(a){return n=Wo.getSortedObjectString(e),s=Wo.stringToArrayBuffer(n),[2,new Promise(function(u,h){var p=window.msCrypto.subtle.importKey(bs,s,t,o,i);p.addEventListener("complete",function(f){u(f.target.result)}),p.addEventListener("error",function(f){h(f)})})]})})},r.prototype.sign=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,new Promise(function(n,s){var a=window.msCrypto.subtle.sign(e,t,o);a.addEventListener("complete",function(u){n(u.target.result)}),a.addEventListener("error",function(u){s(u)})})]})})},r.prototype.digest=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,new Promise(function(i,n){var s=window.msCrypto.subtle.digest(e,t.buffer);s.addEventListener("complete",function(a){i(a.target.result)}),s.addEventListener("error",function(a){n(a)})})]})})},r}();var g7="RSASSA-PKCS1-v1_5",Yk="SHA-256",v7=2048,y7=new Uint8Array([1,0,1]),df=function(){function r(e,t){var o,i;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new Kk;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new Qk;else if(this.hasMsrCrypto()&&(!((o=this.cryptoOptions)===null||o===void 0)&&o.useMsrCrypto))this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new Wk;else throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),B.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(!((i=this.cryptoOptions)===null||i===void 0)&&i.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),ws.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:g7,hash:Yk,modulusLength:v7,publicExponent:y7}}return r.prototype.hasIECrypto=function(){return"msCrypto"in window},r.prototype.hasBrowserCrypto=function(){return"crypto"in window},r.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},r.prototype.sha256Digest=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){return t=Wo.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:Yk},t)]})})},r.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},r.prototype.generateKeyPair=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]})})},r.prototype.exportJwk=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){return[2,this.subtleCrypto.exportKey(e)]})})},r.prototype.importJwk=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,o)]})})},r.prototype.sign=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]})})},r}();l();c();d();l();c();d();l();c();d();var Zk=function(){function r(){this.dbName=rf,this.version=Hk,this.tableName=Uk,this.dbOpen=!1}return r.prototype.open=function(){return F(this,void 0,void 0,function(){var e=this;return D(this,function(t){return[2,new Promise(function(o,i){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",function(s){var a=s;a.target.result.createObjectStore(e.tableName)}),n.addEventListener("success",function(s){var a=s;e.db=a.target.result,e.dbOpen=!0,o()}),n.addEventListener("error",function(){return i(B.createDatabaseUnavailableError())})})]})})},r.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},r.prototype.validateDbIsOpen=function(){return F(this,void 0,void 0,function(){return D(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}})})},r.prototype.getItem=function(e){return F(this,void 0,void 0,function(){var t=this;return D(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(B.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readonly"),a=s.objectStore(t.tableName),u=a.get(e);u.addEventListener("success",function(h){var p=h;t.closeConnection(),i(p.target.result)}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.setItem=function(e,t){return F(this,void 0,void 0,function(){var o=this;return D(this,function(i){switch(i.label){case 0:return[4,this.validateDbIsOpen()];case 1:return i.sent(),[2,new Promise(function(n,s){if(!o.db)return s(B.createDatabaseNotOpenError());var a=o.db.transaction([o.tableName],"readwrite"),u=a.objectStore(o.tableName),h=u.put(t,e);h.addEventListener("success",function(){o.closeConnection(),n()}),h.addEventListener("error",function(p){o.closeConnection(),s(p)})})]}})})},r.prototype.removeItem=function(e){return F(this,void 0,void 0,function(){var t=this;return D(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(B.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readwrite"),a=s.objectStore(t.tableName),u=a.delete(e);u.addEventListener("success",function(){t.closeConnection(),i()}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.getKeys=function(){return F(this,void 0,void 0,function(){var e=this;return D(this,function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise(function(o,i){if(!e.db)return i(B.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly"),s=n.objectStore(e.tableName),a=s.getAllKeys();a.addEventListener("success",function(u){var h=u;e.closeConnection(),o(h.target.result)}),a.addEventListener("error",function(u){e.closeConnection(),i(u)})})]}})})},r.prototype.containsKey=function(e){return F(this,void 0,void 0,function(){var t=this;return D(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(B.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readonly"),a=s.objectStore(t.tableName),u=a.count(e);u.addEventListener("success",function(h){var p=h;t.closeConnection(),i(p.target.result===1)}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.deleteDatabase=function(){return F(this,void 0,void 0,function(){return D(this,function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise(function(t,o){var i=window.indexedDB.deleteDatabase(rf);i.addEventListener("success",function(){return t(!0)}),i.addEventListener("blocked",function(){return t(!0)}),i.addEventListener("error",function(){return o(!1)})})]})})},r}();var H0=function(){function r(e,t){this.inMemoryCache=new pu,this.indexedDBCache=new Zk,this.logger=e,this.storeName=t}return r.prototype.handleDatabaseAccessError=function(e){if(e instanceof B&&e.errorCode===V.databaseUnavailable.code)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e},r.prototype.getItem=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){switch(i.label){case 0:if(t=this.inMemoryCache.getItem(e),t)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,i.sent()];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}})})},r.prototype.setItem=function(e,t){return F(this,void 0,void 0,function(){var o;return D(this,function(i){switch(i.label){case 0:this.inMemoryCache.setItem(e,t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return i.sent(),[3,4];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2]}})})},r.prototype.removeItem=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){switch(o.label){case 0:this.inMemoryCache.removeItem(e),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return o.sent(),[3,4];case 3:return t=o.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}})})},r.prototype.getKeys=function(){return F(this,void 0,void 0,function(){var e,t;return D(this,function(o){switch(o.label){case 0:if(e=this.inMemoryCache.getKeys(),e.length!==0)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,o.sent()];case 3:return t=o.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}})})},r.prototype.containsKey=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){switch(i.label){case 0:if(t=this.inMemoryCache.containsKey(e),t)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,i.sent()];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}})})},r.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},r.prototype.clearPersistent=function(){return F(this,void 0,void 0,function(){var e,t;return D(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return e=o.sent(),e&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=o.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}})})},r}();var uf;(function(r){r.asymmetricKeys="asymmetricKeys",r.symmetricKeys="symmetricKeys"})(uf||(uf={}));var Jk=function(){function r(e){this.logger=e,this.asymmetricKeys=new H0(this.logger,uf.asymmetricKeys),this.symmetricKeys=new H0(this.logger,uf.symmetricKeys)}return r.prototype.clear=function(){return F(this,void 0,void 0,function(){var e;return D(this,function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return e=t.sent(),e instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}})})},r}();var yu=function(){function r(e,t,o){this.logger=e,this.browserCrypto=new df(this.logger,o),this.b64Encode=new cf,this.b64Decode=new Gk,this.guidGenerator=new lf(this.browserCrypto),this.pkceGenerator=new jk(this.browserCrypto),this.cache=new Jk(this.logger),this.performanceClient=t}return r.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},r.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},r.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},r.prototype.generatePkceCodes=function(){return F(this,void 0,void 0,function(){return D(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},r.prototype.getPublicKeyThumbprint=function(e){var t;return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p;return D(this,function(f){switch(f.label){case 0:return o=(t=this.performanceClient)===null||t===void 0?void 0:t.startMeasurement($.CryptoOptsGetPublicKeyThumbprint,e.correlationId),[4,this.browserCrypto.generateKeyPair(r.EXTRACTABLE,r.POP_KEY_USAGES)];case 1:return i=f.sent(),[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return n=f.sent(),s={e:n.e,kty:n.kty,n:n.n},a=Wo.getSortedObjectString(s),[4,this.hashString(a)];case 3:return u=f.sent(),[4,this.browserCrypto.exportJwk(i.privateKey)];case 4:return h=f.sent(),[4,this.browserCrypto.importJwk(h,!1,["sign"])];case 5:return p=f.sent(),[4,this.cache.asymmetricKeys.setItem(u,{privateKey:p,publicKey:i.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri})];case 6:return f.sent(),o&&o.endMeasurement({success:!0}),[2,u]}})})},r.prototype.removeTokenBindingKey=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){switch(o.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return o.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return t=o.sent(),[2,!t]}})})},r.prototype.clearKeystore=function(){return F(this,void 0,void 0,function(){return D(this,function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}})})},r.prototype.signJwt=function(e,t,o){var i;return F(this,void 0,void 0,function(){var n,s,a,u,h,p,f,b,x,S,R,z,we;return D(this,function(re){switch(re.label){case 0:return n=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement($.CryptoOptsSignJwt,o),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(s=re.sent(),!s)throw B.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(s.publicKey)];case 2:return a=re.sent(),u=Wo.getSortedObjectString(a),h=this.b64Encode.urlEncode(JSON.stringify({kid:t})),p=E0.getShrHeaderString({kid:h,alg:a.alg}),f=this.b64Encode.urlEncode(p),e.cnf={jwk:JSON.parse(u)},b=this.b64Encode.urlEncode(JSON.stringify(e)),x=f+"."+b,S=Wo.stringToArrayBuffer(x),[4,this.browserCrypto.sign(s.privateKey,S)];case 3:return R=re.sent(),z=this.b64Encode.urlEncodeArr(new Uint8Array(R)),we=x+"."+z,n&&n.endMeasurement({success:!0}),[2,we]}})})},r.prototype.hashString=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){switch(i.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=i.sent(),o=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(o)]}})})},r.POP_KEY_USAGES=["sign","verify"],r.EXTRACTABLE=!0,r}();l();c();d();l();c();d();var hf=function(){function r(e,t){this.correlationId=t,this.measureName=r.makeMeasureName(e,t),this.startMark=r.makeStartMark(e,t),this.endMark=r.makeEndMark(e,t)}return r.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},r.makeStartMark=function(e,t){return"msal.start."+e+"."+t},r.makeEndMark=function(e,t){return"msal.end."+e+"."+t},r.supportsBrowserPerformance=function(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.mark=="function"&&typeof window.performance.measure=="function"&&typeof window.performance.clearMarks=="function"&&typeof window.performance.clearMeasures=="function"&&typeof window.performance.getEntriesByName=="function"},r.flushMeasurements=function(e,t){if(r.supportsBrowserPerformance())try{t.forEach(function(o){var i=r.makeMeasureName(o.name,e),n=window.performance.getEntriesByName(i,"measure");n.length>0&&(window.performance.clearMeasures(i),window.performance.clearMarks(r.makeStartMark(i,e)),window.performance.clearMarks(r.makeEndMark(i,e)))})}catch{}},r.prototype.startMeasurement=function(){if(r.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch{}},r.prototype.endMeasurement=function(){if(r.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch{}},r.prototype.flushMeasurement=function(){if(r.supportsBrowserPerformance())try{var e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){var t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch{}return null},r}();var U0=function(r){gt(e,r);function e(t,o,i,n,s,a,u){var h=r.call(this,t,o,i,n,s,a)||this;return h.browserCrypto=new df(h.logger,u),h.guidGenerator=new lf(h.browserCrypto),h}return e.prototype.startPerformanceMeasuremeant=function(t,o){return new hf(t,o)},e.prototype.generateId=function(){return this.guidGenerator.generateGuid()},e.prototype.getPageVisibility=function(){var t;return((t=document.visibilityState)===null||t===void 0?void 0:t.toString())||null},e.prototype.deleteIncompleteSubMeasurements=function(t){var o=this.eventsByCorrelationId.get(t.event.correlationId),i=o&&o.eventId===t.event.eventId,n=[];i&&o?.incompleteSubMeasurements&&o.incompleteSubMeasurements.forEach(function(s){n.push(ne({},s))}),n.length>0&&hf.flushMeasurements(t.event.correlationId,n)},e.prototype.supportsBrowserPerformanceNow=function(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.now=="function"},e.prototype.startMeasurement=function(t,o){var i=this,n=this.getPageVisibility(),s=r.prototype.startMeasurement.call(this,t,o);return ne(ne({},s),{endMeasurement:function(a){var u=s.endMeasurement(ne({startPageVisibility:n,endPageVisibility:i.getPageVisibility()},a));return i.deleteIncompleteSubMeasurements(s),u},discardMeasurement:function(){s.discardMeasurement(),i.deleteIncompleteSubMeasurements(s),s.measurement.flushMeasurement()}})},e.prototype.setPreQueueTime=function(t,o){if(!this.supportsBrowserPerformanceNow()){this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+t);return}if(!o){this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to set telemetry queue time");return}var i=this.preQueueTimeByCorrelationId.get(o);i&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+i.name+" found",o),this.addQueueMeasurement(i.name,o,void 0,!0)),this.preQueueTimeByCorrelationId.set(o,{name:t,time:window.performance.now()})},e.prototype.addQueueMeasurement=function(t,o,i,n){if(!this.supportsBrowserPerformanceNow()){this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t);return}if(!o){this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");return}var s=r.prototype.getPreQueueTime.call(this,t,o);if(s){var a=window.performance.now(),u=i||r.prototype.calculateQueuedTime.call(this,s,a);return r.prototype.addQueueMeasurement.call(this,t,o,u,n)}},e}(hu);l();c();d();l();c();d();l();c();d();var Xk=function(){function r(e,t,o,i){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=o,this.cryptoObj=i}return r.prototype.loadExternalTokens=function(e,t,o){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw B.createUnableToLoadTokenError("Please ensure server response includes id token.");var i=new gr(t.id_token,this.cryptoObj),n,s;if(e.account){var a=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new gs(a,this.loadIdToken(i,a.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,a.homeAccountId,e.account.environment,e.account.tenantId,o),this.loadRefreshToken(e,t,a.homeAccountId,e.account.environment))}else if(e.authority){var u=ys.generateAuthority(e.authority,e.azureCloudOptions),h={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(s=new ys(u,this.config.system.networkClient,this.storage,h,this.logger),o.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");var a=this.loadAccount(i,s.hostnameAndPort,o.clientInfo,s.authorityType);n=new gs(a,this.loadIdToken(i,a.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,t,a.homeAccountId,s.hostnameAndPort,s.tenant,o),this.loadRefreshToken(e,t,a.homeAccountId,s.hostnameAndPort))}else if(t.client_info){this.logger.trace("TokenCache - homeAccountId from response");var a=this.loadAccount(i,s.hostnameAndPort,t.client_info,s.authorityType);n=new gs(a,this.loadIdToken(i,a.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,t,a.homeAccountId,s.hostnameAndPort,s.tenant,o),this.loadRefreshToken(e,t,a.homeAccountId,s.hostnameAndPort))}else throw B.createUnableToLoadTokenError("Please provide clientInfo in the response or options.")}else throw B.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");return this.generateAuthenticationResult(e,i,n,s)},r.prototype.loadAccount=function(e,t,o,i,n){var s;if(n?s=n:i!==void 0&&o&&(s=Ht.generateHomeAccountId(o,i,this.logger,this.cryptoObj,e)),!s)throw B.createUnableToLoadTokenError("Unexpected missing homeAccountId");var a=o?Ht.createAccount(o,s,e,void 0,void 0,void 0,t):Ht.createGenericAccount(s,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(a),a;throw B.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadIdToken=function(e,t,o,i){var n=Ti.createIdTokenEntity(t,o,e.rawToken,this.config.auth.clientId,i);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(n),n;throw B.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadAccessToken=function(e,t,o,i,n,s){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw B.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!s.extendedExpiresOn)throw B.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var a=new Rt(e.scopes).printScopes(),u=s.expiresOn||t.expires_in+new Date().getTime()/1e3,h=s.extendedExpiresOn,p=Ei.createAccessTokenEntity(o,i,t.access_token,this.config.auth.clientId,n,a,u,h,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(p),p;throw B.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadRefreshToken=function(e,t,o,i){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var n=Fn.createRefreshTokenEntity(o,i,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(n),n;throw B.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.generateAuthenticationResult=function(e,t,o,i){var n,s,a,u=_.EMPTY_STRING,h=[],p=null,f;o?.accessToken&&(u=o.accessToken.secret,h=Rt.fromString(o.accessToken.target).asArray(),p=new Date(Number(o.accessToken.expiresOn)*1e3),f=new Date(Number(o.accessToken.extendedExpiresOn)*1e3));var b=t?.claims.oid||t?.claims.sub||_.EMPTY_STRING,x=t?.claims.tid||_.EMPTY_STRING;return{authority:i?i.canonicalAuthority:_.EMPTY_STRING,uniqueId:b,tenantId:x,scopes:h,account:o?.account?o.account.getAccountInfo():null,idToken:t?t.rawToken:_.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:u,fromCache:!0,expiresOn:p,correlationId:e.correlationId||_.EMPTY_STRING,requestId:_.EMPTY_STRING,extExpiresOn:f,familyId:_.EMPTY_STRING,tokenType:((n=o?.accessToken)===null||n===void 0?void 0:n.tokenType)||_.EMPTY_STRING,state:_.EMPTY_STRING,cloudGraphHostName:((s=o?.account)===null||s===void 0?void 0:s.cloudGraphHostName)||_.EMPTY_STRING,msGraphHost:((a=o?.account)===null||a===void 0?void 0:a.msGraphHost)||_.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},r}();l();c();d();l();c();d();var eS=function(r){gt(e,r);function e(t){var o=r.call(this,t)||this;return o.includeRedirectUri=!1,o}return e}(du);var tS=function(r){gt(e,r);function e(t,o,i,n,s,a,u,h,p,f){var b=r.call(this,t,o,i,n,s,a,h,p,f)||this;return b.apiId=u,b}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h;return D(this,function(p){switch(p.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw B.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,oe.Silent)];case 1:o=p.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||_.EMPTY_STRING,o.account||null),i=this.initializeServerTelemetryManager(this.apiId),p.label=2;case 2:return p.trys.push([2,4,,5]),n=ne(ne({},o),{code:t.code}),this.performanceClient.setPreQueueTime($.StandardInteractionClientGetClientConfiguration,t.correlationId),[4,this.getClientConfiguration(i,o.authority)];case 3:return s=p.sent(),a=new eS(s),this.logger.verbose("Auth code client created"),u=new af(a,this.browserStorage,n,this.logger,this.config.system,this.performanceClient),[2,u.handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},o.state,a.authority,this.networkClient,!1)];case 4:throw h=p.sent(),h instanceof X&&h.setCorrelationId(this.correlationId),i.cacheFailedRequest(h),this.browserStorage.cleanRequestByState(o.state),h;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(B.createSilentLogoutUnsupportedError())},e}(hi);var rS=function(){function r(e){this.isBrowserEnvironment=typeof window<"u",this.config=qk(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new $n(this.config.system.loggerOptions,Tc,dn),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new U0(this.config.auth.clientId,this.config.auth.authority,this.logger,Tc,dn,this.config.telemetry.application,this.config.system.cryptoOptions):new A0(this.config.auth.clientId,this.config.auth.authority,this.logger,Tc,dn,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new yu(this.logger,this.performanceClient,this.config.system.cryptoOptions):oa,this.eventHandler=new N0(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new fu(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):Bk(this.config.auth.clientId,this.logger);var t={cacheLocation:jt.MemoryStorage,temporaryCacheLocation:jt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};this.nativeInternalStorage=new fu(this.config.auth.clientId,t,this.browserCrypto,this.logger),this.tokenCache=new Xk(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return r.prototype.initialize=function(){return F(this,void 0,void 0,function(){var e,t,o,i,n;return D(this,function(s){switch(s.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement($.InitializeClientApplication),this.eventHandler.emitEvent(pe.INITIALIZE_START),!e)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),o=this,[4,pi.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return o.nativeExtensionProvider=s.sent(),[3,4];case 3:return i=s.sent(),this.logger.verbose(i),[3,4];case 4:return this.config.cache.claimsBasedCachingEnabled?[3,6]:(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),n=this.performanceClient.startMeasurement($.ClearTokensAndKeysWithClaims),[4,this.browserStorage.clearTokensAndKeysWithClaims()]);case 5:s.sent(),n.endMeasurement({success:!0}),s.label=6;case 6:return this.initialized=!0,this.eventHandler.emitEvent(pe.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}})})},r.prototype.handleRedirectPromise=function(e){return F(this,void 0,void 0,function(){var t,o,i,n,s,a,u,h,p=this;return D(this,function(f){return this.logger.verbose("handleRedirectPromise called"),St.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(o=e||_.EMPTY_STRING,i=this.redirectResponse.get(o),typeof i>"u"?(this.eventHandler.emitEvent(pe.HANDLE_REDIRECT_START,oe.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),n=this.browserStorage.getCachedNativeRequest(),s=void 0,n&&pi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),a=new un(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dt.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId),s=a.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),u=this.browserStorage.getTemporaryCache(Je.CORRELATION_ID,!0)||_.EMPTY_STRING,h=this.createRedirectClient(u),s=h.handleRedirectPromise(e)),i=s.then(function(b){if(b){var x=t.length<p.getAllAccounts().length;x?(p.eventHandler.emitEvent(pe.LOGIN_SUCCESS,oe.Redirect,b),p.logger.verbose("handleRedirectResponse returned result, login success")):(p.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_SUCCESS,oe.Redirect,b),p.logger.verbose("handleRedirectResponse returned result, acquire token success"))}return p.eventHandler.emitEvent(pe.HANDLE_REDIRECT_END,oe.Redirect),b}).catch(function(b){throw t.length>0?p.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_FAILURE,oe.Redirect,null,b):p.eventHandler.emitEvent(pe.LOGIN_FAILURE,oe.Redirect,null,b),p.eventHandler.emitEvent(pe.HANDLE_REDIRECT_END,oe.Redirect),b}),this.redirectResponse.set(o,i)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,i]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},r.prototype.acquireTokenRedirect=function(e){return F(this,void 0,void 0,function(){var t,o,i,n,s,a=this;return D(this,function(u){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(oe.Redirect),o=this.getAllAccounts().length>0,o?this.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_START,oe.Redirect,e):this.eventHandler.emitEvent(pe.LOGIN_START,oe.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(n=new un(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dt.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),i=n.acquireTokenRedirect(e).catch(function(h){if(h instanceof Oo&&h.isFatal()){a.nativeExtensionProvider=void 0;var p=a.createRedirectClient(e.correlationId);return p.acquireToken(e)}else if(h instanceof _r){a.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");var p=a.createRedirectClient(e.correlationId);return p.acquireToken(e)}throw a.browserStorage.setInteractionInProgress(!1),h})):(s=this.createRedirectClient(e.correlationId),i=s.acquireToken(e)),[2,i.catch(function(h){throw o?a.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_FAILURE,oe.Redirect,null,h):a.eventHandler.emitEvent(pe.LOGIN_FAILURE,oe.Redirect,null,h),h})]})})},r.prototype.acquireTokenPopup=function(e){var t=this,o=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement($.AcquireTokenPopup,o);try{this.logger.verbose("acquireTokenPopup called",o),this.preflightBrowserEnvironmentCheck(oe.Popup)}catch(u){return Promise.reject(u)}var n=this.getAllAccounts();n.length>0?this.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_START,oe.Popup,e):this.eventHandler.emitEvent(pe.LOGIN_START,oe.Popup,e);var s;if(this.canUseNative(e))s=this.acquireTokenNative(e,dt.acquireTokenPopup).then(function(u){return t.browserStorage.setInteractionInProgress(!1),i.endMeasurement({success:!0,isNativeBroker:!0,requestId:u.requestId}),u}).catch(function(u){if(u instanceof Oo&&u.isFatal()){t.nativeExtensionProvider=void 0;var h=t.createPopupClient(e.correlationId);return h.acquireToken(e)}else if(u instanceof _r){t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");var h=t.createPopupClient(e.correlationId);return h.acquireToken(e)}throw t.browserStorage.setInteractionInProgress(!1),u});else{var a=this.createPopupClient(e.correlationId);s=a.acquireToken(e)}return s.then(function(u){var h=n.length<t.getAllAccounts().length;return h?t.eventHandler.emitEvent(pe.LOGIN_SUCCESS,oe.Popup,u):t.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_SUCCESS,oe.Popup,u),i.addStaticFields({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),i.endMeasurement({success:!0,requestId:u.requestId}),u}).catch(function(u){return n.length>0?t.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_FAILURE,oe.Popup,null,u):t.eventHandler.emitEvent(pe.LOGIN_FAILURE,oe.Popup,null,u),i.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),Promise.reject(u)})},r.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},r.prototype.ssoSilent=function(e){var t;return F(this,void 0,void 0,function(){var o,i,n,s,a=this;return D(this,function(u){return o=this.getRequestCorrelationId(e),i=ne(ne({},e),{prompt:e.prompt,correlationId:o}),this.preflightBrowserEnvironmentCheck(oe.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement($.SsoSilent,o),(t=this.ssoSilentMeasurement)===null||t===void 0||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",o),this.eventHandler.emitEvent(pe.SSO_SILENT_START,oe.Silent,i),this.canUseNative(i)?n=this.acquireTokenNative(i,dt.ssoSilent).catch(function(h){if(h instanceof Oo&&h.isFatal()){a.nativeExtensionProvider=void 0;var p=a.createSilentIframeClient(i.correlationId);return p.acquireToken(i)}throw h}):(s=this.createSilentIframeClient(i.correlationId),n=s.acquireToken(i)),[2,n.then(function(h){var p,f;return a.eventHandler.emitEvent(pe.SSO_SILENT_SUCCESS,oe.Silent,h),(p=a.ssoSilentMeasurement)===null||p===void 0||p.addStaticFields({accessTokenSize:h.accessToken.length,idTokenSize:h.idToken.length}),(f=a.ssoSilentMeasurement)===null||f===void 0||f.endMeasurement({success:!0,isNativeBroker:h.fromNativeBroker,requestId:h.requestId}),h}).catch(function(h){var p;throw a.eventHandler.emitEvent(pe.SSO_SILENT_FAILURE,oe.Silent,null,h),(p=a.ssoSilentMeasurement)===null||p===void 0||p.endMeasurement({errorCode:h.errorCode,subErrorCode:h.subError,success:!1}),h}).finally(function(){document.removeEventListener("visibilitychange",a.trackPageVisibilityWithMeasurement)})]})})},r.prototype.acquireTokenByCode=function(e){return F(this,void 0,void 0,function(){var t,o,i,n,s=this;return D(this,function(a){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(oe.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_BY_CODE_START,oe.Silent,e),o=this.performanceClient.startMeasurement($.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw B.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return i=e.code,n=this.hybridAuthCodeResponses.get(i),n?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),o.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),n=this.acquireTokenByCodeAsync(ne(ne({},e),{correlationId:t})).then(function(u){return s.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_BY_CODE_SUCCESS,oe.Silent,u),s.hybridAuthCodeResponses.delete(i),o.addStaticFields({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),o.endMeasurement({success:!0,isNativeBroker:u.fromNativeBroker,requestId:u.requestId}),u}).catch(function(u){throw s.hybridAuthCodeResponses.delete(i),s.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_BY_CODE_FAILURE,oe.Silent,null,u),o.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),u}),this.hybridAuthCodeResponses.set(i,n)),[2,n];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,dt.acquireTokenByCode,e.nativeAccountId).catch(function(u){throw u instanceof Oo&&u.isFatal()&&(s.nativeExtensionProvider=void 0),u})];throw B.createUnableToAcquireTokenFromNativePlatformError()}else throw B.createAuthCodeOrNativeAccountIdRequiredError()}catch(u){throw this.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_BY_CODE_FAILURE,oe.Silent,null,u),o.endMeasurement({errorCode:u instanceof X&&u.errorCode||void 0,subErrorCode:u instanceof X&&u.subError||void 0,success:!1}),u}return[2]})})},r.prototype.acquireTokenByCodeAsync=function(e){var t;return F(this,void 0,void 0,function(){var o,i,n=this;return D(this,function(s){switch(s.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement($.AcquireTokenByCodeAsync,e.correlationId),(t=this.acquireTokenByCodeAsyncMeasurement)===null||t===void 0||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),o=this.createSilentAuthCodeClient(e.correlationId),[4,o.acquireToken(e).then(function(a){var u;return(u=n.acquireTokenByCodeAsyncMeasurement)===null||u===void 0||u.endMeasurement({success:!0,fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker,requestId:a.requestId}),a}).catch(function(a){var u;throw(u=n.acquireTokenByCodeAsyncMeasurement)===null||u===void 0||u.endMeasurement({errorCode:a.errorCode,subErrorCode:a.subError,success:!1}),a}).finally(function(){document.removeEventListener("visibilitychange",n.trackPageVisibilityWithMeasurement)})];case 1:return i=s.sent(),[2,i]}})})},r.prototype.acquireTokenFromCache=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){switch(this.performanceClient.addQueueMeasurement($.AcquireTokenFromCache,t.correlationId),o.cacheLookupPolicy){case lo.Default:case lo.AccessToken:case lo.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw H.createRefreshRequiredError()}return[2]})})},r.prototype.acquireTokenByRefreshToken=function(e,t){return F(this,void 0,void 0,function(){var o;return D(this,function(i){switch(this.performanceClient.addQueueMeasurement($.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case lo.Default:case lo.AccessTokenAndRefreshToken:case lo.RefreshToken:case lo.RefreshTokenAndNetwork:return o=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime($.SilentRefreshClientAcquireToken,e.correlationId),[2,o.acquireToken(e)];default:throw H.createRefreshRequiredError()}return[2]})})},r.prototype.acquireTokenBySilentIframe=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){return this.performanceClient.addQueueMeasurement($.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime($.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]})})},r.prototype.logout=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(ne({correlationId:t},e))]})})},r.prototype.logoutRedirect=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(oe.Redirect),o=this.createRedirectClient(t),[2,o.logout(e)]})})},r.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);this.preflightBrowserEnvironmentCheck(oe.Popup);var o=this.createPopupClient(t);return o.logout(e)}catch(i){return Promise.reject(i)}},r.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},r.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},r.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},r.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},r.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},r.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},r.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(t===void 0&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),St.blockNonBrowserEnvironment(this.isBrowserEnvironment),St.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),St.blockReloadInHiddenIframes(),St.blockAcquireTokenInPopups(),St.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===oe.Redirect&&this.config.cache.cacheLocation===jt.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw ws.createInMemoryRedirectUnavailableError();(e===oe.Redirect||e===oe.Popup)&&this.preflightInteractiveRequest(t)},r.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),St.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},r.prototype.acquireTokenNative=function(e,t,o){return F(this,void 0,void 0,function(){var i;return D(this,function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw B.createNativeConnectionNotEstablishedError();return i=new un(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,o||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),[2,i.acquireToken(e)]})})},r.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!pi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case ar.NONE:case ar.CONSENT:case ar.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0},r.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},r.prototype.createPopupClient=function(e){return new M0(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createRedirectClient=function(e){return new O0(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createSilentIframeClient=function(e){return new D0(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dt.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createSilentCacheClient=function(e){return new gu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.createSilentRefreshClient=function(e){return new L0(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.createSilentAuthCodeClient=function(e){return new tS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,dt.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},r.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},r.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},r.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},r.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},r.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},r.prototype.getTokenCache=function(){return this.tokenCache},r.prototype.getLogger=function(){return this.logger},r.prototype.setLogger=function(e){this.logger=e},r.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},r.prototype.setNavigationClient=function(e){this.navigationClient=e},r.prototype.getConfiguration=function(){return this.config},r.prototype.getRequestCorrelationId=function(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():_.EMPTY_STRING},r}();var B0=function(r){gt(e,r);function e(t){var o=r.call(this,t)||this;return o.astsAsyncMeasurement=void 0,o.activeSilentTokenRequests=new Map,o.trackPageVisibility=o.trackPageVisibility.bind(o),o}return e.prototype.loginRedirect=function(t){return F(this,void 0,void 0,function(){var o;return D(this,function(i){return o=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",o),[2,this.acquireTokenRedirect(ne({correlationId:o},t||P0))]})})},e.prototype.loginPopup=function(t){var o=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",o),this.acquireTokenPopup(ne({correlationId:o},t||P0))},e.prototype.acquireTokenSilent=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p=this;return D(this,function(f){if(o=this.getRequestCorrelationId(t),i=this.performanceClient.startMeasurement($.AcquireTokenSilent,o),i.addStaticFields({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(oe.Silent),this.logger.verbose("acquireTokenSilent called",o),n=t.account||this.getActiveAccount(),!n)throw B.createNoAccountError();return s={clientId:this.config.auth.clientId,authority:t.authority||_.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:n.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},a=JSON.stringify(s),u=this.activeSilentTokenRequests.get(a),typeof u>"u"?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",o),this.performanceClient.setPreQueueTime($.AcquireTokenSilentAsync,o),h=this.acquireTokenSilentAsync(ne(ne({},t),{correlationId:o}),n).then(function(b){return p.activeSilentTokenRequests.delete(a),i.addStaticFields({accessTokenSize:b.accessToken.length,idTokenSize:b.idToken.length}),i.endMeasurement({success:!0,fromCache:b.fromCache,isNativeBroker:b.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:b.requestId}),b}).catch(function(b){throw p.activeSilentTokenRequests.delete(a),i.endMeasurement({errorCode:b.errorCode,subErrorCode:b.subError,success:!1}),b}),this.activeSilentTokenRequests.set(a,h),[2,h]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",o),i.discardMeasurement(),[2,u])})})},e.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},e.prototype.acquireTokenSilentAsync=function(t,o){var i;return F(this,void 0,void 0,function(){var n,s,a,u,h,p=this;return D(this,function(f){switch(f.label){case 0:return this.performanceClient.addQueueMeasurement($.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_START,oe.Silent,t),this.astsAsyncMeasurement=this.performanceClient.startMeasurement($.AcquireTokenSilentAsync,t.correlationId),(i=this.astsAsyncMeasurement)===null||i===void 0||i.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),pi.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&o.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),s=ne(ne({},t),{account:o}),n=this.acquireTokenNative(s,dt.acquireTokenSilent_silentFlow).catch(function(b){return F(p,void 0,void 0,function(){var x;return D(this,function(S){if(b instanceof Oo&&b.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,x=this.createSilentIframeClient(t.correlationId),[2,x.acquireToken(t)];throw b})})}),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),a=this.createSilentCacheClient(t.correlationId),this.performanceClient.setPreQueueTime($.InitializeSilentRequest,t.correlationId),[4,a.initializeSilentRequest(t,o)];case 2:u=f.sent(),h=ne(ne({},t),{cacheLookupPolicy:t.cacheLookupPolicy||lo.Default}),this.performanceClient.setPreQueueTime($.AcquireTokenFromCache,u.correlationId),n=this.acquireTokenFromCache(a,u,h).catch(function(b){if(h.cacheLookupPolicy===lo.AccessToken)throw b;return St.blockReloadInHiddenIframes(),p.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_NETWORK_START,oe.Silent,u),p.performanceClient.setPreQueueTime($.AcquireTokenByRefreshToken,u.correlationId),p.acquireTokenByRefreshToken(u,h).catch(function(x){var S=x instanceof no,R=x instanceof _r,z=x.errorCode===Dn.noTokensFoundError.code,we=x.errorCode===zr.INVALID_GRANT_ERROR;if((!S||!we||R||h.cacheLookupPolicy===lo.AccessTokenAndRefreshToken||h.cacheLookupPolicy===lo.RefreshToken)&&h.cacheLookupPolicy!==lo.Skip&&!z)throw x;return p.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),p.performanceClient.setPreQueueTime($.AcquireTokenBySilentIframe,u.correlationId),p.acquireTokenBySilentIframe(u)})}),f.label=3;case 3:return[2,n.then(function(b){var x;return p.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_SUCCESS,oe.Silent,b),(x=p.astsAsyncMeasurement)===null||x===void 0||x.endMeasurement({success:!0,fromCache:b.fromCache,isNativeBroker:b.fromNativeBroker,requestId:b.requestId}),b}).catch(function(b){var x;throw p.eventHandler.emitEvent(pe.ACQUIRE_TOKEN_FAILURE,oe.Silent,null,b),(x=p.astsAsyncMeasurement)===null||x===void 0||x.endMeasurement({errorCode:b.errorCode,subErrorCode:b.subError,success:!1}),b}).finally(function(){document.removeEventListener("visibilitychange",p.trackPageVisibility)})]}})})},e}(rS);l();c();d();l();c();d();var w7=function(){function r(){}return r.getInteractionStatusFromEvent=function(e,t){switch(e.eventType){case pe.LOGIN_START:return Br.Login;case pe.SSO_SILENT_START:return Br.SsoSilent;case pe.ACQUIRE_TOKEN_START:if(e.interactionType===oe.Redirect||e.interactionType===oe.Popup)return Br.AcquireToken;break;case pe.HANDLE_REDIRECT_START:return Br.HandleRedirect;case pe.LOGOUT_START:return Br.Logout;case pe.SSO_SILENT_SUCCESS:case pe.SSO_SILENT_FAILURE:if(t&&t!==Br.SsoSilent)break;return Br.None;case pe.LOGOUT_END:if(t&&t!==Br.Logout)break;return Br.None;case pe.HANDLE_REDIRECT_END:if(t&&t!==Br.HandleRedirect)break;return Br.None;case pe.LOGIN_SUCCESS:case pe.LOGIN_FAILURE:case pe.ACQUIRE_TOKEN_SUCCESS:case pe.ACQUIRE_TOKEN_FAILURE:case pe.RESTORE_FROM_BFCACHE:if(e.interactionType===oe.Redirect||e.interactionType===oe.Popup){if(t&&t!==Br.Login&&t!==Br.AcquireToken)break;return Br.None}break}return null},r}();l();c();d();var C7=function(){function r(e,t){var o=t&&t.loggerOptions||{};this.logger=new $n(o,Tc,dn),this.cryptoOps=new yu(this.logger),this.popTokenGenerator=new ui(this.cryptoOps),this.shrParameters=e}return r.prototype.generatePublicKeyThumbprint=function(){return F(this,void 0,void 0,function(){var e;return D(this,function(t){switch(t.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:return e=t.sent().kid,[2,e]}})})},r.prototype.signRequest=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,o)]})})},r.prototype.removeKeys=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}})})},r}();var bu=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},z0;(function(r){r.SELECT_ACCOUNT="select_account",r.LOGIN="login",r.CONSENT="consent"})(z0||(z0={}));var pf=class extends Qa{get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}get isMultiAccountDisabled(){return!this.isMultipleAccountEnabled}set isMultiAccountDisabled(e){this.isMultipleAccountEnabled=!e}get isMultiAccountSupportedAndEnabled(){return this.isMultipleAccountEnabled}get sessionStorageRequestedScopesKey(){return"mgt-requested-scopes"}get sessionStorageDeniedScopesKey(){return"mgt-denied-scopes"}get homeAccountKey(){return"275f3731-e4a4-468a-bf9c-baca24b31e26"}constructor(e){super(),this.isMultipleAccountEnabled=!0,this.handleMsalEvent=t=>{t.eventType==="msal:acquireTokenSuccess"&&"scopes"in t.payload&&(this.approvedScopes=t.payload.scopes)},this.initProvider(e)}initProvider(e){return bu(this,void 0,void 0,function*(){let t=e.options||{auth:{clientId:""}};if(this.ms_config=t,this.ms_config.cache=t.cache||{},this.ms_config.cache.cacheLocation=t.cache.cacheLocation||"localStorage",(typeof this.ms_config.cache.storeAuthStateInCookie>"u"||this.ms_config.cache.storeAuthStateInCookie===null)&&(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,e.authority&&(this.ms_config.auth.authority=e.authority),e.redirectUri&&(this.ms_config.auth.redirectUri=e.redirectUri),"clientId"in e)if(e.clientId)this.ms_config.auth.clientId=e.clientId,this._publicClientApplication=new B0(this.ms_config);else throw new Error("clientId must be provided");else if("publicClientApplication"in e)if(e.publicClientApplication)this._publicClientApplication=e.publicClientApplication;else throw new Error("publicClientApplication must be provided");else throw new Error("either clientId or publicClientApplication must be provided");this._publicClientApplication.addEventCallback(this.handleMsalEvent),yield this._publicClientApplication.initialize(),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,this._loginType=typeof e.loginType<"u"?e.loginType:ls.Redirect,this._loginHint=typeof e.loginHint<"u"?e.loginHint:null,this._sid=typeof e.sid<"u"?e.sid:null,this.isIncrementalConsentDisabled=typeof e.isIncrementalConsentDisabled<"u"?e.isIncrementalConsentDisabled:!1,this._domainHint=typeof e.domainHint<"u"?e.domainHint:null,this.scopes=typeof e.scopes<"u"?e.scopes:["user.read"],this._prompt=typeof e.prompt<"u"?e.prompt:z0.SELECT_ACCOUNT;let o=e;this.isMultipleAccountEnabled=typeof o.isMultiAccountEnabled<"u"?o.isMultiAccountEnabled:!0,this.baseURL=typeof o.baseURL<"u"?o.baseURL:this.baseURL,this.customHosts=o.customHosts,this.graph=qv(this);try{let i=yield this._publicClientApplication.handleRedirectPromise();i!==null?this.handleResponse(i?.account):yield this.trySilentSignIn()}catch(i){throw console.error("\u{1F992}: Problem attempting to sign in",i),i}})}trySilentSignIn(){return bu(this,void 0,void 0,function*(){let e={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){e.sid=this._sid,e.loginHint=this._loginHint;try{this.setState(ce.Loading);let t=yield this._publicClientApplication.ssoSilent(e);t&&this.handleResponse(t?.account)}catch{this.setState(ce.SignedOut)}}else{let t=this.getAccount();if(t&&(yield this.getAccessToken(null))){this.handleResponse(t);return}this.setState(ce.SignedOut)}})}login(){return bu(this,void 0,void 0,function*(){let e={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType===ls.Popup){let t=yield this._publicClientApplication.loginPopup(e);this.handleResponse(t?.account)}else{let t=Object.assign({},e);yield this._publicClientApplication.loginRedirect(t)}})}getAllAccounts(){let e=[];return this._publicClientApplication.getAllAccounts().forEach(t=>{e.push({name:t.name,mail:t.username,id:t.homeAccountId})}),e}setActiveAccount(e){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(e.id)),this.setStoredAccount(),super.setActiveAccount(e)}getActiveAccount(){let e=this._publicClientApplication.getActiveAccount();return{name:e.name,mail:e.username,id:e.homeAccountId,tenantId:e.tenantId}}handleResponse(e){e!==null?(this.setActiveAccount({name:e.name,id:e.homeAccountId,mail:e.username}),this.setState(ce.SignedIn)):this.setState(ce.SignedOut),this.clearRequestedScopes()}storage(){switch(this.ms_config.cache.cacheLocation){case"localStorage":return window.localStorage;case"sessionStorage":default:return window.sessionStorage}}setStoredAccount(){this.clearStoredAccount(),this.storage().setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){let e=this.storage().getItem(this.homeAccountKey);return this._publicClientApplication.getAccountByHomeId(e)}clearStoredAccount(){this.storage().removeItem(this.homeAccountKey)}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let o=t.indexOf("openid");o!==-1&&t.splice(o,1),o=t.indexOf("profile"),o!==-1&&t.splice(o,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){let e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){let t=this.getDeniedScopes();if(t&&t.filter(o=>e.indexOf(o)!==-1).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){let e=this.getStoredAccount();return e||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return bu(this,void 0,void 0,function*(){let t={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType===ls.Redirect?(this.setState(ce.SignedOut),yield this._publicClientApplication.logoutRedirect(t)):(yield this._publicClientApplication.logoutPopup(Object.assign({},t)),this._publicClientApplication.getAllAccounts.length===1||!this.isMultipleAccountEnabled?this.setState(ce.SignedOut):yield this.trySilentSignIn())})}getAccessToken(e){return bu(this,void 0,void 0,function*(){let t=e?e.scopes||this.scopes:this.scopes,o={scopes:t,account:this.getAccount()};try{let i=o;return(yield this._publicClientApplication.acquireTokenSilent(i)).accessToken}catch(i){if(i instanceof _r){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===ls.Redirect)if(!this.areScopesDenied(t))this.setRequestedScopes(t),yield this._publicClientApplication.acquireTokenRedirect(o);else throw i;else try{return(yield this._publicClientApplication.acquireTokenPopup(o)).accessToken}catch(n){throw console.error("\u{1F992}: problem with pop-up sign in",n),n}}else this.setState(ce.SignedOut)}throw null})}};l();c();d();var oS="9aeac104-a6b6-45ca-bb7c-bf7c3083eeb2";var V0="mgt/setProvider",iS="blank.html";ue();Wd();l();c();d();l();c();d();l();c();d();l();c();d();Te();At();ue();Cs();Yi();l();c();d();Te();var aP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--person-avatar-size:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}
`];l();c();d();ue();var lP=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},mC=(r,e,t)=>lP(void 0,void 0,void 0,function*(){let o=r.api(e).middlewareOptions(ye(t)).orderby("start/dateTime");return ul.create(r,o)}),cP=(r,e,t,o)=>lP(void 0,void 0,void 0,function*(){let i=`startdatetime=${e.toISOString()}`,n=`enddatetime=${t.toISOString()}`,s=o?`groups/${o}/calendar/calendarview?${i}&${n}`:`me/calendarview?${i}&${n}`;return mC(r,s,o?["Group.Read.All","Group.ReadWrite.All"]:["Calendars.ReadBasic","Calendars.Read","Calendars.ReadWrite"])});Vr();l();c();d();Te();At();Rl();Ln();_f();da();ue();Cs();Il();l();c();d();Te();var dP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .people-list .people-person{--person-avatar-size:var(--people-person-avatar-size, 24px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}
`];Yi();ue();Il();var Zi=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},eo=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},qM=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Td=()=>{ii(),Pe("people",Lr)},Lr=class extends st{static get styles(){return dP}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(e){Go(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}get peopleQueries(){return this._peopleQueries}set peopleQueries(e){Go(this._peopleQueries,e)||(this._peopleQueries=e,this.requestStateUpdate(!0))}get resource(){return this._resource}set resource(e){this._resource!==e&&(this._resource=e,this.requestStateUpdate(!0))}get version(){return this._version}set version(e){this._version!==e&&(this._version=e,this.requestStateUpdate(!0))}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...mt.requiredScopes])]}constructor(){super(),this.personCardInteraction=Kt.hover,this.scopes=[],this._peoplePresence={},this._version="v1.0",this._arrowKeyLocation=-1,this.handleKeyDown=e=>{let t=this.shadowRoot.querySelector(".people-list"),o,i=t?.children;for(let a of i){let u=a;u.setAttribute("tabindex","-1"),u.blur()}let n=t.childElementCount,s=e.key;if(s==="ArrowRight")this._arrowKeyLocation=(this._arrowKeyLocation+1+n)%n;else if(s==="ArrowLeft")this._arrowKeyLocation=(this._arrowKeyLocation-1+n)%n;else if(s==="Tab"||s==="Escape")this._arrowKeyLocation=-1,t.blur();else if(["Enter","space"," "].includes(s)&&this.personCardInteraction!==Kt.none){let u=i[this._arrowKeyLocation].querySelector("mgt-person");u&&u.showPersonCard()}this._arrowKeyLocation>-1&&(o=i[this._arrowKeyLocation],o.setAttribute("tabindex","1"),o.focus())},this.showMax=3}clearState(){this.people=null}requestStateUpdate(e){return e&&(this.people=null),super.requestStateUpdate(e)}render(){return this.isLoadingState?this.renderLoading():!this.people||this.people.length===0?this.renderNoData():this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople()}renderLoading(){return this.renderTemplate("loading",null)||k``}renderPeople(){let e=this.people.slice(0,this.showMax).filter(t=>t);return k`
      <ul
        tabindex="0"
        class="people-list"
        aria-label="people"
        @keydown=${this.handleKeyDown}>
        ${uo(e,t=>t.id?t.id:t.displayName,t=>k`
            <li tabindex="-1" class="people-person">
              ${this.renderPerson(t)}
            </li>
          `)}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){let e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||k`
        <li tabindex="-1" aria-label="and ${e} more attendees" class="overflow"><span>+${e}</span></li>
      `}renderPerson(e){let t={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]);let o="small";return this.renderTemplate("person",{person:e},e.id)||Ee`
        <mgt-person
          class="people-person"
          .personDetails=${e}
          .fetchImage=${!0}
          .avatarSize=${o}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${t}
          .usage=${"people"}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||k``}loadState(){return qM(this,void 0,void 0,function*(){if(!this.people){let e=K.globalProvider;if(e&&e.state===ce.SignedIn){let t=e.graph.forComponent(this);this.groupId?this.people=yield Sl(t,null,this.groupId,this.showMax,Ut.person):this.userIds||this.peopleQueries?this.people=this.userIds?yield xl(t,this.userIds,"","",this._fallbackDetails):yield mS(t,this.peopleQueries,this._fallbackDetails):this.resource?this.people=yield pS(t,this.version,this.resource,this.scopes):this.people=yield kf(t),this.showPresence?this._peoplePresence=yield xS(t,this.people):this._peoplePresence=null}}})}};Zi([E({attribute:"group-id",type:String}),eo("design:type",String),eo("design:paramtypes",[Object])],Lr.prototype,"groupId",null);Zi([E({attribute:"user-ids",converter:(r,e)=>r.split(",").map(t=>t.trim())}),eo("design:type",Array),eo("design:paramtypes",[Array])],Lr.prototype,"userIds",null);Zi([E({attribute:"people",type:Object}),eo("design:type",Array)],Lr.prototype,"people",void 0);Zi([E({attribute:"people-queries",converter:(r,e)=>r.split(",").map(t=>t.trim())}),eo("design:type",Array),eo("design:paramtypes",[Array])],Lr.prototype,"peopleQueries",null);Zi([E({attribute:"show-max",type:Number}),eo("design:type",Number)],Lr.prototype,"showMax",void 0);Zi([E({attribute:"show-presence",type:Boolean}),eo("design:type",Boolean)],Lr.prototype,"showPresence",void 0);Zi([E({attribute:"person-card",converter:(r,e)=>(r=r.toLowerCase(),typeof Kt[r]>"u"?Kt.hover:Kt[r])}),eo("design:type",Number)],Lr.prototype,"personCardInteraction",void 0);Zi([E({attribute:"resource",type:String}),eo("design:type",String),eo("design:paramtypes",[Object])],Lr.prototype,"resource",null);Zi([E({attribute:"version",type:String}),eo("design:type",String),eo("design:paramtypes",[Object])],Lr.prototype,"version",null);Zi([E({attribute:"scopes",converter:r=>r?r.toLowerCase().split(","):null,reflect:!0}),eo("design:type",Array)],Lr.prototype,"scopes",void 0);Zi([E({attribute:"fallback-details",type:Array}),eo("design:type",Array),eo("design:paramtypes",[Array])],Lr.prototype,"fallbackDetails",null);Zi([le(),eo("design:type",Object)],Lr.prototype,"_arrowKeyLocation",void 0);Xr();yr();fi();ue();var js=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},ni=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},tv=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},uP=()=>{vt(Cn),Td(),Pe("agenda",Ji)},Ji=class extends st{constructor(){super(...arguments),this._days=3,this.onResize=()=>{this._isNarrow=this.offsetWidth<600}}static get styles(){return aP}get date(){return this._date}set date(e){this._date!==e&&(this._date=e,this.reloadState())}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.reloadState())}get days(){return this._days}set days(e){this._days!==e&&(this._days=e,this.reloadState())}get eventQuery(){return this._eventQuery}set eventQuery(e){this._eventQuery!==e&&(this._eventQuery=e,this.reloadState())}get preferredTimezone(){return this._preferredTimezone}set preferredTimezone(e){this._preferredTimezone!==e&&(this._preferredTimezone=e,this.reloadState())}static get requiredScopes(){return[...new Set(["calendars.read",...Lr.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||this.events.length===0)return this.renderNoData();let e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});if(t)return t;let o={agenda:!0,grouped:this.groupByDay};return k`
      <div dir=${this.direction} class="${Ve(o)}">
        ${this.groupByDay?this.renderGroups(e):this.renderEvents(e)}
        ${this.isLoadingState?this.renderLoading():k``}
      </div>
    `}reload(){return tv(this,void 0,void 0,function*(){this.events=yield this.loadEvents()})}renderLoading(){return this.renderTemplate("loading",null)||k`
        <fluent-card class="event event-loading">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </fluent-card>`}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||k``}renderEvent(e){this._isNarrow=this.offsetWidth<600;let t={narrow:this._isNarrow};return k`
      <fluent-card class="${Ve(Object.assign({event:!0},t))}">
        <div class="${Ve(Object.assign({"event-time-container":!0},t))}">
          <div class="event-time" aria-label="${this.getEventTimeString(e)}">${this.getEventTimeString(e)}</div>
        </div>
        <div class="${Ve(Object.assign({"event-details-container":!0},t))}">
          ${this.renderTitle(e)} ${this.renderLocation(e)} ${this.renderAttendees(e)}
        </div>
        <div class="event-other-container">${this.renderOther(e)}</div>
      </fluent-card>
    `}renderHeader(e){return this.renderTemplate("header",{header:e},"header-"+e)||k`
        <div class="header" aria-label="${e}">${e}</div>
      `}renderTitle(e){return k`
      <div
        aria-label=${e.subject}
        class="${Ve({"event-subject":!0,narrow:this._isNarrow})}"
      >
        ${e.subject}
      </div>`}renderLocation(e){return e.location.displayName?k`
      <div class="event-location-container">
        <div class="event-location-icon">${Y(P.OfficeLocation)}</div>
        <div class="event-location" aria-label="${e.location.displayName}">${e.location.displayName}</div>
      </div>
    `:null}renderAttendees(e){return e.attendees.length?Ee`
      <mgt-people
        show-max="5"
        show-presence
        class="event-attendees"
        .peopleQueries=${e.attendees.map(t=>t.emailAddress.address)}
      ></mgt-people>
    `:null}renderOther(e){return this.hasTemplate("event-other")?k`
          ${this.renderTemplate("event-other",{event:e},e.id+"-other")}
        `:null}renderGroups(e){let t={};return e.forEach(o=>{var i;let n=(i=o?.start)===null||i===void 0?void 0:i.dateTime;o.end.timeZone==="UTC"&&(n+="Z");let s=this.getDateHeaderFromDateTimeString(n);t[s]=t[s]||[],t[s].push(o)}),k`
      ${Object.keys(t).map(o=>k`
            <div class="group">${this.renderHeader(o)} ${this.renderEvents(t[o])}</div>
          `)}
    `}renderEvents(e){return k`
        ${e.map(t=>k`
              <div
                class="event-container"
                tabindex="0"
                @focus=${()=>this.eventClicked(t)}>
                ${this.renderTemplate("event",{event:t},t.id)||this.renderEvent(t)}
              </div>`)}`}loadState(){return tv(this,void 0,void 0,function*(){if(this.events)return;let e=yield this.loadEvents();e?.length>0&&(this.events=e)})}reloadState(){return tv(this,void 0,void 0,function*(){this.events=null,yield this.requestStateUpdate(!0)})}eventClicked(e){this.fireCustomEvent("eventClick",e)}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";let t=e.start.dateTime;e.start.timeZone==="UTC"&&(t+="Z");let o=e.end.dateTime;e.end.timeZone==="UTC"&&(o+="Z");let i=this.prettyPrintTimeFromDateTime(new Date(t)),n=this.prettyPrintTimeFromDateTime(new Date(o));return`${i} - ${n}`}loadEvents(){return tv(this,void 0,void 0,function*(){let e=K.globalProvider,t=[];if(e?.state===ce.SignedIn){let o=e.graph.forComponent(this);if(this.eventQuery)try{let i=this.eventQuery.split("|"),n,s;i.length>1?(s=i[0].trim(),n=i[1].trim()):s=this.eventQuery;let a=yield mC(o,s,n?[n]:[]);if(a?.value)for(t=a.value;a.hasNext;)yield a.next(),t=a.value}catch{}else{let i=this.date?new Date(this.date):new Date,n=new Date(i.getTime());n.setDate(i.getDate()+this.days);try{let s=yield cP(o,i,n,this.groupId);if(s?.value)for(t=s.value;s.hasNext;)yield s.next(),t=s.value}catch{}}}return t})}prettyPrintTimeFromDateTime(e){return e.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}getDateHeaderFromDateTimeString(e){return new Date(e).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}};js([E({attribute:"date",type:String}),ni("design:type",String),ni("design:paramtypes",[Object])],Ji.prototype,"date",null);js([E({attribute:"group-id",type:String}),ni("design:type",String),ni("design:paramtypes",[Object])],Ji.prototype,"groupId",null);js([E({attribute:"days",type:Number}),ni("design:type",Number),ni("design:paramtypes",[Object])],Ji.prototype,"days",null);js([E({attribute:"event-query",type:String}),ni("design:type",String),ni("design:paramtypes",[Object])],Ji.prototype,"eventQuery",null);js([E({attribute:"events",type:Array}),ni("design:type",Array)],Ji.prototype,"events",void 0);js([E({attribute:"show-max",type:Number}),ni("design:type",Number)],Ji.prototype,"showMax",void 0);js([E({attribute:"group-by-day",type:Boolean}),ni("design:type",Boolean)],Ji.prototype,"groupByDay",void 0);js([E({attribute:"preferred-timezone",type:String}),ni("design:type",String),ni("design:paramtypes",[Object])],Ji.prototype,"preferredTimezone",null);js([E({attribute:!1}),ni("design:type",Boolean)],Ji.prototype,"_isNarrow",void 0);_d();Yg();l();c();d();Te();At();Lc();ue();l();c();d();var hP={comboboxPlaceholder:"Select an item"};yr();Xr();Cs();l();c();d();Te();At();ue();$c();Nc();hn();ue();var is=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},ns=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},GM=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Nh=r=>Array.isArray(r?.value),Hh;(function(r){r.json="json",r.image="image"})(Hh||(Hh={}));var jM=r=>r||Q.config.response.invalidationPeriod||Q.config.defaultInvalidationPeriod,gC=()=>Q.config.response.isEnabled&&Q.config.isEnabled,Ed=()=>Pe("get",Ci),Ci=class extends st{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type=Hh.json,this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1}attributeChangedCallback(e,t,o){super.attributeChangedCallback(e,t,o),this.requestStateUpdate()}refresh(e=!1){this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.response=null}render(){if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&Nh(this.response)){let e;if(Nh(this.response)){let t=null;this.isLoadingState&&!this.isPolling&&(t=this.renderTemplate("loading",null)),e=k`
          ${this.response.value.map(o=>this.renderTemplate("value",o,o.id))} ${t}
        `}else e=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){let t=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?k`
            ${t}${e}
          `:k`
            ${e}${t}
          `}else return e}else return this.response?this.renderTemplate("default",this.response)||k``:this.hasTemplate("no-data")?this.renderTemplate("no-data",null):k``}loadState(){var e,t,o;return GM(this,void 0,void 0,function*(){let i=K.globalProvider;if(this.error=null,!(!i||i.state!==ce.SignedIn)){if(this.resource){try{let n,s=`${this.version}${this.resource}`,a=null;if(this.shouldRetrieveCache()){n=Q.getCache(N.get,N.get.stores.responses);let u=gC()?yield n.getValue(s):null;u&&jM(this.cacheInvalidationPeriod)>Date.now()-u.timeCached&&(a=JSON.parse(u.response))}if(!a){let u=this.resource,h=!1;!((e=this.response)===null||e===void 0)&&e["@odata.deltaLink"]?(u=this.response["@odata.deltaLink"],h=!0):h=new URL(u,"https://graph.microsoft.com").pathname.endsWith("delta");let p=i.graph.forComponent(this),f=p.api(u).version(this.version);if(!((t=this.scopes)===null||t===void 0)&&t.length&&(f=f.middlewareOptions(ye(this.scopes))),this.type===Hh.json){if(a=yield f.get(),h&&Nh(this.response)&&Nh(a)){let b=a.value;a.value=this.response.value.concat(b)}if(!this.isPolling&&!cl(this.response,a)&&(this.response=a),Nh(a)&&a["@odata.nextLink"]){let b=1,x=a;for(;(b<this.maxPages||this.maxPages<=0||h&&this.pollingRate)&&x?.["@odata.nextLink"];){b++;let S=x["@odata.nextLink"].split(this.version)[1];x=yield p.api(S).version(this.version).get(),!((o=x?.value)===null||o===void 0)&&o.length&&(x.value=a.value.concat(x.value),a=x,this.isPolling||(this.response=a))}}}else{if(this.resource.indexOf("/photo/$value")===-1&&this.resource.indexOf("/thumbnails/")===-1)throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");let b;if(this.resource.indexOf("/photo/$value")>-1){let x=this.resource.replace("/photo/$value",""),S=yield Ss(p,x,this.scopes);S&&(b=S.photo)}else if(this.resource.indexOf("/thumbnails/")>-1){let x=yield d_(p,this.resource,this.scopes);x&&(b=x.thumbnail)}b&&(a={image:b})}this.shouldUpdateCache()&&a&&(n=Q.getCache(N.get,N.get.stores.responses),yield n.putValue(s,{response:JSON.stringify(a)}))}cl(this.response,a)||(this.response=a)}catch(n){this.error=n}this.response&&(this.error=null,this.pollingRate&&setTimeout(()=>{this.isPolling=!0,this.loadState().finally(()=>{this.isPolling=!1})},this.pollingRate))}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}})}shouldRetrieveCache(){return gC()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return gC()&&this.cacheEnabled}};is([E({attribute:"resource",reflect:!0,type:String}),ns("design:type",String)],Ci.prototype,"resource",void 0);is([E({attribute:"scopes",converter:(r,e)=>r?r.toLowerCase().split(","):null,reflect:!0}),ns("design:type",Array)],Ci.prototype,"scopes",void 0);is([E({attribute:"version",reflect:!0,type:String}),ns("design:type",Object)],Ci.prototype,"version",void 0);is([E({attribute:"type",reflect:!0,type:Hh}),ns("design:type",String)],Ci.prototype,"type",void 0);is([E({attribute:"max-pages",reflect:!0,type:Number}),ns("design:type",Object)],Ci.prototype,"maxPages",void 0);is([E({attribute:"polling-rate",reflect:!0,type:Number}),ns("design:type",Object)],Ci.prototype,"pollingRate",void 0);is([E({attribute:"cache-enabled",reflect:!0,type:Boolean}),ns("design:type",Object)],Ci.prototype,"cacheEnabled",void 0);is([E({attribute:"cache-invalidation-period",type:Number}),ns("design:type",Object)],Ci.prototype,"cacheInvalidationPeriod",void 0);is([E({attribute:!1}),ns("design:type",Object)],Ci.prototype,"response",void 0);is([E({attribute:!1}),ns("design:type",Object)],Ci.prototype,"error",void 0);l();c();d();Te();var pP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}
`];ue();var kn=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Sn=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},KM=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},rv=()=>{vt(_h,nc),Ed(),Pe("picker",si)},si=class extends st{get strings(){return hP}static get styles(){return pP}constructor(){super(),this.version="v1.0",this.maxPages=3,this.scopes=[],this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.handleComboboxKeydown=e=>{let t,o,i=e.key,s=e.target.querySelector(".selected");s&&(t=s.getAttribute("value")),i==="Enter"&&t&&(o=this.response.filter(a=>a.id===t).pop(),this.fireCustomEvent("selectionChanged",o,!0,!1,!0))},this.placeholder=this.strings.comboboxPlaceholder,this.entityType=null,this.keyName=null,this.isRefreshing=!1}refresh(e=!1){this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.response=null,this.error=null}render(){var e;if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.hasTemplate("error")){let t=this.error?this.error:null;return this.renderTemplate("error",{error:t},"error")}else if(this.hasTemplate("no-data"))return this.renderTemplate("no-data",null);return((e=this.response)===null||e===void 0?void 0:e.length)>0?this.renderPicker():this.renderGet()}renderPicker(){return Ee`
      <fluent-combobox
        @keydown=${this.handleComboboxKeydown}
        current-value=${Qo(this.selectedValue)}
        part="picker"
        class="picker"
        id="combobox"
        autocomplete="list"
        placeholder=${this.placeholder}>
          ${this.response.map(e=>k`
            <fluent-option value=${e.id} @click=${t=>this.handleClick(t,e)}> ${e[this.keyName]} </fluent-option>`)}
      </fluent-combobox>
     `}renderGet(){return Ee`
      <mgt-get
        class="mgt-get"
        resource=${this.resource}
        version=${this.version}
        .scopes=${this.scopes}
        max-pages=${this.maxPages}
        ?cache-enabled=${this.cacheEnabled}
        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>
      </mgt-get>`}loadState(){return KM(this,void 0,void 0,function*(){if(!this.response){let e=this.renderRoot.querySelector(".mgt-get");e?e.addEventListener("dataChange",t=>this.handleDataChange(t)):console.error("\u{1F992}: mgt-picker component requires a child mgt-get component. Something has gone horribly wrong.")}this.isRefreshing=!1,yield Promise.resolve()})}handleDataChange(e){let t=e.detail.response.value,o=e.detail.error?e.detail.error:null;this.response=t,this.error=o}handleClick(e,t){this.fireCustomEvent("selectionChanged",t,!0,!1,!0)}};kn([E({attribute:"resource",type:String}),Sn("design:type",String)],si.prototype,"resource",void 0);kn([E({attribute:"version",type:String}),Sn("design:type",Object)],si.prototype,"version",void 0);kn([E({attribute:"max-pages",type:Number}),Sn("design:type",Object)],si.prototype,"maxPages",void 0);kn([E({attribute:"placeholder",type:String}),Sn("design:type",String)],si.prototype,"placeholder",void 0);kn([E({attribute:"key-name",type:String}),Sn("design:type",String)],si.prototype,"keyName",void 0);kn([E({attribute:"entity-type",type:String}),Sn("design:type",String)],si.prototype,"entityType",void 0);kn([E({attribute:"scopes",converter:r=>r?r.toLowerCase().split(","):null}),Sn("design:type",Array)],si.prototype,"scopes",void 0);kn([E({attribute:"cache-enabled",type:Boolean}),Sn("design:type",Object)],si.prototype,"cacheEnabled",void 0);kn([E({attribute:"cache-invalidation-period",type:Number}),Sn("design:type",Object)],si.prototype,"cacheInvalidationPeriod",void 0);kn([E({attribute:"selected-value",type:String}),Sn("design:type",String)],si.prototype,"selectedValue",void 0);kn([le(),Sn("design:type",Array)],si.prototype,"response",void 0);l();c();d();Te();At();ue();l();c();d();var fP={termsetIdRequired:"The termsetId property or termset-id attribute is required",noTermsFound:"No terms found",comboboxPlaceholder:"Select a term",loadingMessage:"Loading..."};yr();Xr();Cs();l();c();d();Te();var mP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--max-height:var(--taxonomy-picker-list-max-height, 380px)}:host .picker{background-color:var(--taxonomy-picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--taxonomy-picker-placeholder-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--taxonomy-picker-placeholder-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}
`];ue();pn();var ai=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Ao=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},WM=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},gP=()=>{vt(_h,nc),Hn(),Ed(),Pe("taxonomy-picker",yo)},yo=class extends st{get strings(){return fP}static get styles(){return mP}get defaultSelectedTermId(){return this._defaultSelectedTermId}set defaultSelectedTermId(e){e!==this._defaultSelectedTermId&&(this._defaultSelectedTermId=e,this.requestStateUpdate(!0))}get selectedTerm(){return this._selectedTerm}set selectedTerm(e){this._selectedTerm=e}constructor(){super(),this.version="beta",this.position="below",this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.placeholder=this.strings.comboboxPlaceholder,this.isRefreshing=!1,this.noTerms=!1}refresh(e=!1){this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.terms=null,this.error=null,this.noTerms=!1}render(){var e;return this.isLoadingState&&!this.terms?this.renderLoading():this.error?this.renderError():this.noTerms?this.renderNoData():((e=this.terms)===null||e===void 0?void 0:e.length)>0?this.renderTaxonomyPicker():this.renderGet()}renderLoading(){return this.renderTemplate("loading",null,"loading")||Ee`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}renderError(){return this.renderTemplate("error",null,"error")||k`
              <span>
                ${this.error}
            </span>
          `}renderNoData(){return this.renderTemplate("no-data",null)||k`
            <span>
              ${this.strings.noTermsFound}
            </span>
          `}renderTaxonomyPicker(){return Ee`
      <fluent-combobox class="taxonomy-picker" autocomplete="both" placeholder=${this.placeholder} position=${this.position} ?disabled=${this.disabled}>
        ${this.terms.map(e=>this.renderTaxonomyPickerItem(e))}
      </fluent-combobox>
     `}renderTaxonomyPickerItem(e){let t=this.defaultSelectedTermId&&this.defaultSelectedTermId===e.id;return k`
        <fluent-option value=${e.id} ?selected=${t} @click=${o=>this.handleClick(o,e)}> ${this.renderTemplate("term",{term:e},e.id)||e.labels[0].name} </fluent-option>
        `}renderGet(){if(!this.termsetId)return k`
            <span>
                ${this.strings.termsetIdRequired}
            </span>
            `;let e=`/termStore/sets/${this.termsetId}/children`;return this.termId&&(e=`/termStore/sets/${this.termsetId}/terms/${this.termId}/children`),this.siteId&&(e=`/sites/${this.siteId}${e}`),e+="?$select=id,labels,descriptions,properties",Ee`
      <mgt-get
        class="mgt-get"
        resource=${e}
        version=${this.version}
        scopes=${["TermStore.Read.All"]}
        ?cache-enabled=${this.cacheEnabled}
        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>
      </mgt-get>`}loadState(){return WM(this,void 0,void 0,function*(){this.terms||this.renderRoot.querySelector(".mgt-get").addEventListener("dataChange",t=>this.handleDataChange(t)),this.isRefreshing=!1,yield Promise.resolve()})}handleDataChange(e){let t=e.detail.error?e.detail.error:null;if(t){this.error=t;return}this.locale&&(this.locale=this.locale.toLowerCase());let i=e.detail.response.value.map(n=>{let s=n.labels;if(s&&s.length>0&&this.locale){let a=s.find(u=>u.languageTag.toLowerCase()===this.locale);a&&(n.labels=[a,...s.filter(u=>u.languageTag.toLowerCase()!==this.locale)])}return n});this.terms=i,i.length===0&&(this.noTerms=!0)}handleClick(e,t){this.selectedTerm=t,this.fireCustomEvent("selectionChanged",t)}};ai([E({attribute:"term-set-id",type:String}),Ao("design:type",String)],yo.prototype,"termsetId",void 0);ai([E({attribute:"term-id",type:String}),Ao("design:type",String)],yo.prototype,"termId",void 0);ai([E({attribute:"site-id",type:String}),Ao("design:type",String)],yo.prototype,"siteId",void 0);ai([E({attribute:"locale",type:String}),Ao("design:type",String)],yo.prototype,"locale",void 0);ai([E({attribute:"version",type:String}),Ao("design:type",Object)],yo.prototype,"version",void 0);ai([E({attribute:"placeholder",type:String}),Ao("design:type",String)],yo.prototype,"placeholder",void 0);ai([E({attribute:"position",type:String,converter:r=>r==="above"?"above":"below"}),Ao("design:type",String)],yo.prototype,"position",void 0);ai([E({attribute:"default-selected-term-id",type:String}),Ao("design:type",String),Ao("design:paramtypes",[String])],yo.prototype,"defaultSelectedTermId",null);ai([E({attribute:"selected-term",type:Object}),Ao("design:type",Object),Ao("design:paramtypes",[Object])],yo.prototype,"selectedTerm",null);ai([E({attribute:"disabled",type:Boolean}),Ao("design:type",Boolean)],yo.prototype,"disabled",void 0);ai([E({attribute:"cache-enabled",type:Boolean}),Ao("design:type",Object)],yo.prototype,"cacheEnabled",void 0);ai([E({attribute:"cache-invalidation-period",type:Number}),Ao("design:type",Object)],yo.prototype,"cacheInvalidationPeriod",void 0);ai([le(),Ao("design:type",Array)],yo.prototype,"terms",void 0);ai([le(),Ao("design:type",Boolean)],yo.prototype,"noTerms",void 0);l();c();d();Te();At();fi();Lc();ue();_s();Fc();Ef();Yi();Tu();Vr();l();c();d();Te();var vP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .signed-in-person{--person-background-color:$signed-in-background-color;padding:var(--login-button-padding,10px 16px)}:host .account{padding:0;margin:7px 0}:host .account,:host .person,:host .signed-in-person{--person-avatar-size:var(--login-person-avatar-size, 40px)}:host fluent-button.signed-in{height:auto;min-width:auto}:host fluent-button.signed-in::part(control){width:100%;height:100%;padding:var(--login-button-padding,0);background:var(--login-signed-in-background,transparent);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-button.signed-in::part(control):focus-within,:host fluent-button.signed-in::part(control):hover{background:var(--login-signed-in-hover-background,var(--neutral-fill-stealth-hover));--secondary-text-color:var(--secondary-text-hover-color)}:host fluent-button.signed-out::part(control){color:var(--login-signed-out-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-signed-out-button-background,padding-box linear-gradient(var(--neutral-fill-rest),var(--neutral-fill-rest)),border-box var(--neutral-stroke-control-rest))}:host fluent-button.signed-out::part(control):focus-within,:host fluent-button.signed-out::part(control):hover{background:var(--login-signed-out-button-hover-background,var(--neutral-fill-stealth-hover))}:host fluent-button.small::part(control):hover{background:0 0}:host fluent-button:focus-visible{outline-style:var(--focus-ring-style,auto)}:host fluent-card{--fill-color:var(--login-popup-background-color, var(--neutral-layer-1));padding:var(--login-popup-padding,16px)}:host .login-root .small .signed-in-person{padding:0;background:0 0}:host .login-root .small .signed-in-person:focus-within,:host .login-root .small .signed-in-person:hover{background:0 0}:host .login-root .account-list{padding:calc(var(--design-unit) * 1px) 0;margin:0}:host .login-root .account-item{height:auto;min-width:auto;margin-top:4px;background:var(--login-popup-background-color,var(--neutral-layer-1));list-style-type:none;cursor:pointer}:host .login-root .account-item:hover{background:var(--login-account-item-hover-bg-color,var(--neutral-fill-stealth-hover));--person-background-color:$login-account-item-hover-bg-color}:host .login-root .flyout .flyout-command{color:var(--login-flyout-command-text-color,var(--accent-foreground-rest))}:host .login-root .flyout .popup-content .commands{display:flex;align-items:flex-end;justify-content:flex-end}:host .login-root .flyout .popup-content .commands fluent-button::part(control){color:var(--login-command-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-command-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .commands fluent-button::part(control):hover{background:var(--login-command-button-hover-background-color,var(--neutral-fill-stealth-hover))}:host .login-root .flyout .popup-content .content .main-profile{margin-bottom:56px;margin-top:27px}:host .login-root .flyout .popup-content .add-account{padding-top:16px}:host .login-root .flyout .popup-content .add-account fluent-button::part(control){color:var(--login-add-account-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-add-account-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .add-account fluent-button::part(control):hover{background:var(--login-add-account-button-hover-background-color,var(--neutral-fill-stealth-hover))}
`];l();c();d();var yP={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out",signInWithADifferentAccount:"Sign in with a different account"};Cs();yr();Xr();ue();var Uh=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Bh=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},vC=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},bP=()=>{vt(_w,Ah,Dr,Cn),ua(),ii(),Pe("login",ja)},ja=class extends st{static get styles(){return vP}get strings(){return yP}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...mt.requiredScopes])]}get _userDetailsKey(){return"-userDetails"}constructor(){super(),this.showPresence=!1,this.loginView="full",this._arrowKeyLocation=-1,this.logout=()=>vC(this,void 0,void 0,function*(){if(!this.fireCustomEvent("logoutInitiated"))return;let e=K.globalProvider;e?.isMultiAccountSupportedAndEnabled&&localStorage.removeItem(e.getActiveAccount().id+this._userDetailsKey),e?.logout&&(yield e.logout(),this.userDetails=null,e.isMultiAccountSupportedAndEnabled&&localStorage.removeItem(e.getActiveAccount().id+this._userDetailsKey),this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))}),this.flyoutOpened=()=>{this._isFlyoutOpen=!0},this.flyoutClosed=()=>{this._isFlyoutOpen=!1},this.onUserKeyDown=e=>{if(!this.flyout.isOpen)return;let t=this.renderRoot.querySelector(".popup-content"),o=t.querySelectorAll("ul, fluent-button"),i=t.querySelector("#signout-button")||o[0],n=t.querySelector("#signin-different-account-button")||o[o.length-1];if(e.key==="Tab"&&e.shiftKey&&i===e.target&&(e.preventDefault(),n?.focus()),e.key==="Tab"&&!e.shiftKey&&n===e.target&&(e.preventDefault(),i?.focus()),e.key==="Escape"){let a=this.renderRoot.querySelector("#login-button");a?.focus()}let s=this.renderRoot.querySelector("fluent-card");e.shiftKey&&e.key==="Tab"&&e.target===s&&this.hideFlyout()},this.handleAccountListKeyDown=e=>{let t=this.renderRoot.querySelector("ul.account-list"),o,i=t?.children;for(let a of i){let u=a;u.setAttribute("tabindex","-1"),u.blur()}let n=t.childElementCount,s=e.key;if(s==="ArrowDown")this._arrowKeyLocation=(this._arrowKeyLocation+1+n)%n;else if(s==="ArrowUp")this._arrowKeyLocation=(this._arrowKeyLocation-1+n)%n;else if(s==="Tab"||s==="Escape"){this._arrowKeyLocation=-1,t.blur(),s==="Escape"&&(e.preventDefault(),e.stopPropagation());return}this._arrowKeyLocation>-1&&(o=i[this._arrowKeyLocation],o.setAttribute("tabindex","1"),o.focus())},this.onClick=()=>{this.userDetails&&this._isFlyoutOpen?this.hideFlyout():this.userDetails?this.showFlyout():this.login()},this._isFlyoutOpen=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("click",e=>e.stopPropagation())}login(){return vC(this,void 0,void 0,function*(){let e=K.globalProvider;(this.userDetails||!this.fireCustomEvent("loginInitiated"))&&!e.isMultiAccountSupportedAndEnabled||e?.login&&(yield e.login(),e.state===ce.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))})}render(){return k`
      <div class="login-root">
        ${this.renderButton()}
        ${this.renderFlyout()}
      </div>
    `}loadState(){return vC(this,void 0,void 0,function*(){let e=K.globalProvider;e&&!this.userDetails&&(e.state===ce.SignedIn?(this.userDetails=yield El(e.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),e.isMultiAccountSupportedAndEnabled&&localStorage.setItem(K.globalProvider.getActiveAccount().id+this._userDetailsKey,JSON.stringify(this.userDetails)),this.fireCustomEvent("loginCompleted")):this.userDetails=null)})}renderButton(){var e;let t=((e=K.globalProvider)===null||e===void 0?void 0:e.state)===ce.SignedIn,o=Ve({"signed-in":t&&!!this.userDetails,"signed-out":!t,small:this.loginView==="avatar"}),i=t?"stealth":"neutral",n=t&&this.userDetails,s=n?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent(),a=n?this._isFlyoutOpen:void 0;return k`
      <fluent-button
        id="login-button"
        aria-expanded="${Qo(a)}"
        appearance=${i}
        aria-label="${Qo(t?void 0:this.strings.signInLinkSubtitle)}"
        ?disabled=${this.isLoadingState}
        @click=${this.onClick}
        class=${o}>
          ${s}
      </fluent-button>`}renderFlyout(){return Ee`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${this.flyoutOpened}
        @closed=${this.flyoutClosed}>
        <fluent-card
          slot="flyout"
          tabindex="0"
          class="flyout-card"
          @keydown=${this.onUserKeyDown}
          >
          ${this.renderFlyoutContent()}
        </fluent-card>
      </mgt-flyout>`}renderFlyoutContent(){if(this.userDetails)return k`
       <div class="popup">
         <div class="popup-content">
           <div class="commands">
             ${this.renderFlyoutCommands()}
           </div>
           <div class="content">
             <div class="main-profile">
               ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
             </div>
             ${this.renderAccounts()}
           </div>
           ${this.renderAddAccountContent()}
         </div>
       </div>
     `}get hasMultipleAccounts(){var e,t,o,i;return((e=K.globalProvider)===null||e===void 0?void 0:e.isMultiAccountSupportedAndEnabled)&&((i=(o=(t=K.globalProvider)===null||t===void 0?void 0:t.getAllAccounts)===null||o===void 0?void 0:o.call(t))===null||i===void 0?void 0:i.length)>1}get usesVerticalPersonCard(){return this.loginView==="full"||this.hasMultipleAccounts}renderFlyoutPersonDetails(e,t){return this.renderTemplate("flyout-person-details",{personDetails:e,personImage:t})||Ee`
        <mgt-person
          .personDetails=${e}
          .personImage=${t}
          .view=${xe.twolines}
          .line2Property=${"email"}
          ?vertical-layout=${this.usesVerticalPersonCard}
          class="person">
        </mgt-person>`}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||k`
        <fluent-button
          id="signout-button"
          appearance="stealth"
          size="medium"
          class="flyout-command"
          @click=${this.logout}
          aria-label=${this.strings.signOutLinkSubtitle}>
            ${this.strings.signOutLinkSubtitle}
        </fluent-button>`}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderAddAccountContent(){if(K.globalProvider.isMultiAccountSupportedAndEnabled)return k`
        <div class="add-account">
          <fluent-button
            id="signin-different-account-button"
            appearance="stealth"
            aria-label="${this.strings.signInWithADifferentAccount}"
            @click=${()=>void this.login()}>
            <span slot="start"><i>${Y(P.SelectAccount,"currentColor")}</i></span>
            ${this.strings.signInWithADifferentAccount}
          </fluent-button>
        </div>`}parsePersonDisplayConfiguration(){let e={view:xe.twolines,avatarSize:"small"};switch(this.loginView){case"avatar":e.view=xe.image,e.avatarSize="small";break;case"compact":e.view=xe.oneline,e.avatarSize="small";break;case"full":default:e.view=xe.twolines,e.avatarSize="auto";break}return e}renderSignedInButtonContent(e,t){let o=this.renderTemplate("signed-in-button-content",{personDetails:e,personImage:t}),i=this.parsePersonDisplayConfiguration();return o||Ee`
        <mgt-person
          .personDetails=${this.userDetails}
          .personImage=${this._image}
          .view=${i.view}
          .showPresence=${this.showPresence}
          .avatarSize=${i.avatarSize}
          line2-property="email"
          class="signed-in-person"
        ></mgt-person>`}renderAccounts(){if(K.globalProvider.state===ce.SignedIn&&K.globalProvider.isMultiAccountSupportedAndEnabled){let e=K.globalProvider,t=e.getAllAccounts();if(t?.length>1)return k`
          <div id="accounts">
            <ul
              tabindex="0"
              class="account-list"
              part="account-list"
              aria-label="${this.ariaLabel}"
              @keydown=${this.handleAccountListKeyDown}
            >
              ${t.filter(o=>o.id!==e.getActiveAccount().id).map(o=>{let i=localStorage.getItem(o.id+this._userDetailsKey);return Ee`
                    <li
                      tabindex="-1"
                      part="account-item"
                      class="account-item"
                      @click=${()=>this.setActiveAccount(o)}
                      @keyup=${n=>{n.key==="Enter"&&this.setActiveAccount(o)}}
                    >
                      <mgt-person
                        .personDetails=${i?JSON.parse(i):null}
                        .fallbackDetails=${{displayName:o.name,mail:o.mail}}
                        .view=${Dc.twolines}
                        class="account"
                      ></mgt-person>
                    </li>`})}
            </ul>
          </div>
       `}}setActiveAccount(e){K.globalProvider.setActiveAccount(e)}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||k`
        <span>${this.strings.signInLinkSubtitle}</span>`}showFlyout(){let e=this.flyout;e&&e.open()}hideFlyout(){let e=this.flyout;e&&e.close()}};Uh([E({attribute:"user-details",type:Object}),Bh("design:type",Object)],ja.prototype,"userDetails",void 0);Uh([E({attribute:"show-presence",type:Boolean}),Bh("design:type",Object)],ja.prototype,"showPresence",void 0);Uh([E({attribute:"login-view",type:String}),Bh("design:type",String)],ja.prototype,"loginView",void 0);Uh([le(),Bh("design:type",Boolean)],ja.prototype,"_isFlyoutOpen",void 0);Uh([le(),Bh("design:type",Object)],ja.prototype,"_arrowKeyLocation",void 0);l();c();d();Te();At();Rl();l();c();d();ue();hn();var Vh=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Ar;(function(r){r[r.any=0]="any",r[r.unified=1]="unified",r[r.security=2]="security",r[r.mailenabledsecurity=4]="mailenabledsecurity",r[r.distribution=8]="distribution"})(Ar||(Ar={}));var yC=()=>Q.config.groups.invalidationPeriod||Q.config.defaultInvalidationPeriod,Ka=()=>Q.config.groups.isEnabled&&Q.config.isEnabled,zh=["GroupMember.Read.All","Group.Read.All","Group.ReadWrite.All","Directory.Read.All","Directory.ReadWrite.All"];var ov=(r,e,t=10,o=Ar.any,i="")=>Vh(void 0,void 0,void 0,function*(){let n,s=`${e||"*"}*${o}*${i}:${t}`;if(Ka()){n=Q.getCache(N.groups,N.groups.stores.groupsQuery);let p=yield n.getValue(s);if(p&&yC()>Date.now()-p.timeCached&&p.top>=t)return p.groups.map(f=>JSON.parse(f)).slice(0,t+1)}let a="",u,h=[];if(e!==""&&(a=`(startswith(displayName,'${e}') or startswith(mailNickname,'${e}') or startswith(mail,'${e}'))`),i&&(a+=`${e?" and ":""}${i}`),o!==Ar.any){let p=r.createBatch(),f=[];Ar.unified===(o&Ar.unified)&&f.push("groupTypes/any(c:c+eq+'Unified')"),Ar.security===(o&Ar.security)&&f.push("(mailEnabled eq false and securityEnabled eq true)"),Ar.mailenabledsecurity===(o&Ar.mailenabledsecurity)&&f.push("(mailEnabled eq true and securityEnabled eq true)"),Ar.distribution===(o&Ar.distribution)&&f.push("(mailEnabled eq true and securityEnabled eq false)"),a=a?`${a} and `:"";for(let b of f)p.get(b,`/groups?$filter=${a+b}`,zh);try{u=yield p.executeAll();for(let b of f)if(u.get(b).content.value)for(let x of u.get(b).content.value)h.find(R=>R.id===x.id)||h.push(x)}catch{try{let x=[];for(let S of f)x.push(r.api("groups").filter(`${a} and ${S}`).top(t).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(ye(zh)).get());return(yield Promise.all(x)).map(S=>S.value).reduce((S,R)=>S.concat(R),[])}catch{return[]}}}else if(h.length===0){let p=yield r.api("groups").filter(a).top(t).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(ye(zh)).get();return Ka()&&p&&(yield n.putValue(s,{groups:p.value.map(f=>JSON.stringify(f)),top:t})),p?p.value:null}return h});var bC=(r,e,t)=>Vh(void 0,void 0,void 0,function*(){let o;if(Ka()){o=Q.getCache(N.groups,N.groups.stores.groups);let s=yield o.getValue(e);if(s&&yC()>Date.now()-s.timeCached){let a=s.group?JSON.parse(s.group):null,u=t&&a?t.filter(h=>!Object.keys(a).includes(h)):null;if(!u||u.length<=1)return a}}let i=`/groups/${e}`;t&&(i=i+"?$select="+t.toString());let n=yield r.api(i).middlewareOptions(ye(zh)).get();return Ka()&&(yield o.putValue(e,{group:JSON.stringify(n)})),n}),iv=(r,e,t="")=>Vh(void 0,void 0,void 0,function*(){if(!e||e.length===0)return[];let o=r.createBatch(),i={},n=[],s;Ka()&&(s=Q.getCache(N.groups,N.groups.stores.groups));for(let a of e){i[a]=null;let u;if(Ka()&&(u=yield s.getValue(a)),u&&yC()>Date.now()-u.timeCached)i[a]=u.group?JSON.parse(u.group):null;else if(a!==""){let h=`/groups/${a}`;t&&(h=`${h}?$filters=${t}`),o.get(a,h,zh),n.push(a)}}try{let a=yield o.executeAll();for(let u of e){let h=a.get(u);h?.content&&(i[u]=h.content,Ka()&&(yield s.putValue(u,{group:JSON.stringify(h.content)})))}return Promise.all(Object.values(i))}catch{try{return e.filter(u=>n.includes(u)).forEach(u=>{i[u]=bC(r,u)}),Ka()&&(yield Promise.all(e.filter(u=>n.includes(u)).map(u=>Vh(void 0,void 0,void 0,function*(){return yield s.putValue(u,{group:JSON.stringify(yield i[u])})})))),Promise.all(Object.values(i))}catch{return[]}}}),wP=(r,e,t,o=10,i=Ar.any,n="")=>Vh(void 0,void 0,void 0,function*(){let s=[],a=yield ov(r,e,o,i,n);if(a)for(let u of a)u.id&&t.includes(u.id)&&s.push(u);return s});Ln();da();_s();ue();Cs();pn();Ai();Yi();Il();Fc();l();c();d();Te();var CP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--person-details-wrapper-width:0;width:auto}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){display:flex;flex-wrap:wrap;height:auto;background:padding-box linear-gradient(var(--people-picker-input-background,var(--neutral-fill-input-rest)),var(--people-picker-input-background,var(--neutral-fill-input-rest))),border-box var(--people-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--people-picker-input-hover-background,var(--neutral-fill-input-hover)),var(--people-picker-input-hover-background,var(--neutral-fill-input-hover))),border-box var(--people-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--people-picker-input-focus-background,var(--neutral-fill-input-focus)),var(--people-picker-input-focus-background,var(--neutral-fill-input-focus))),border-box var(--people-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(start){margin:unset}:host fluent-text-field::part(control){width:auto;flex-grow:1;min-width:25%;height:calc((var(--base-height-multiplier) + var(--density)) * var(--design-unit) * 1px);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--people-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--people-picker-input-placeholder-hover-text-color,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--people-picker-input-placeholder-focus-text-color,var(--input-placeholder-filled))}:host fluent-text-field .search-icon{display:flex;padding-top:10px;padding-inline-start:10px}:host fluent-text-field .search-icon svg path{fill:var(--people-picker-search-icon-color,currentColor)}:host .selected-list{display:flex;flex-wrap:wrap;column-gap:5px;padding:unset;margin:0 5px}:host .selected-list-item{display:flex;column-gap:5px;border-radius:100px;margin-top:3px;background-color:var(--people-picker-selected-option-background-color,var(--person-background-color,var(--neutral-layer-3)))}:host .selected-list-item.highlighted{background-color:var(--people-picker-selected-option-highlight-background-color,var(--accent-fill-rest))}:host .selected-list-item-close-icon{display:flex;justify-content:center;align-items:center;padding-inline-end:8px;cursor:pointer}:host .selected-list-item-close-icon svg path{fill:var(--people-picker-remove-selected-close-icon-color,currentColor)}:host .selected-list-item .person-image-selected{width:max-content;--person-avatar-size:var(--people-picker-selected-person-avatar-size, 24px)}:host fluent-card{margin-top:4px;background-color:var(--people-picker-dropdown-background-color,var(--neutral-layer-card-container))}:host .searched-people-list{list-style:none;padding:4px;margin:auto}:host .searched-people-list-result{padding:4px;border-radius:4px;background:var(--people-picker-dropdown-result-background-color,var(--person-background-color,transparent))}:host .searched-people-list-result:hover{background:var(--people-picker-dropdown-result-hover-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .searched-people-list-result:focus,:host .searched-people-list-result:focus-within{background:var(--people-picker-dropdown-result-focus-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .searched-people-list-result .person-image-result{--person-avatar-size:var(--people-picker-result-person-avatar-size, 40px)}:host .message-parent{display:flex;place-content:center;flex-direction:row;padding:10px 15px;column-gap:5px}:host .message-parent .loading-text,:host .message-parent .search-error-text{font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:var(--people-picker-no-results-text-color,var(--neutral-foreground-hint))}
`];Vr();yr();Xr();l();c();d();var xP={inputPlaceholderText:"Search for a name",maxSelectionsPlaceHolder:"Max contacts added",maxSelectionsAriaLabel:"Maximum contact selections reached",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",selected:"selected",removeSelectedUser:"Remove ",selectContact:"select a contact",suggestionsTitle:"Suggested contacts"};ue();pn();W0();Ln();var Ot=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Ke=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Id=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},nv=()=>{vt(xn,Cn),ua(),ii(),Hn(),Pe("people-picker",bt)},bt=class extends st{static get styles(){return CP}get strings(){return xP}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector("fluent-text-field")}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get groupIds(){return this._groupIds}set groupIds(e){Go(this._groupIds,e)||(this._groupIds=e,this.requestStateUpdate(!0))}get type(){return this._type}set type(e){this._type!==e&&(this._type=e,this.requestStateUpdate(!0))}get groupType(){return this._groupType}set groupType(e){this._groupType!==e&&(this._groupType=e,this.requestStateUpdate(!0))}get userType(){return this._userType}set userType(e){this._userType!==e&&(this._userType=e,this.requestStateUpdate(!0))}get transitiveSearch(){return this._transitiveSearch}set transitiveSearch(e){this.transitiveSearch!==e&&(this._transitiveSearch=e,this.requestStateUpdate(!0))}get people(){return this._people}set people(e){Go(this._people,e)||(this._people=e,this.requestStateUpdate(!0))}get showMax(){return this._showMax}set showMax(e){e!==this._showMax&&(this._showMax=e,this.requestStateUpdate(!0))}get selectedPeople(){return this._selectedPeople}set selectedPeople(e){e||(e=[]),Go(this._selectedPeople,e)||(this._selectedPeople=e,this.fireCustomEvent("selectionChanged",this._selectedPeople),this.requestUpdate())}get defaultSelectedUserIds(){return this._defaultSelectedUserIds}set defaultSelectedUserIds(e){Go(this._defaultSelectedUserIds,e)||(this._defaultSelectedUserIds=e,this.requestStateUpdate(!0))}get defaultSelectedGroupIds(){return this._defaultSelectedGroupIds}set defaultSelectedGroupIds(e){Go(this._defaultSelectedGroupIds,e)||(this._defaultSelectedGroupIds=e,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(e){Go(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}get userFilters(){return this._userFilters}set userFilters(e){this._userFilters=e,this.requestStateUpdate(!0)}get peopleFilters(){return this._peopleFilters}set peopleFilters(e){this._peopleFilters=e,this.requestStateUpdate(!0)}get groupFilters(){return this._groupFilters}set groupFilters(e){this._groupFilters=e,this.requestStateUpdate(!0)}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all",...mt.requiredScopes])]}constructor(){super(),this._type=Ut.person,this._groupType=Ar.any,this._userType=vr.any,this._selectedPeople=[],this._arrowSelectionCount=-1,this.defaultSelectedUsers=[],this.defaultSelectedGroups=[],this._highlightedUsers=[],this._currentHighlightedUserPos=0,this._isFocused=!1,this._setAnyEmail=!1,this.handleSelectionChanged=()=>{this.selectedPeople.length===0&&!this.disabled&&this.enableTextInput()},this.handleInputClick=()=>{this.flyout.isOpen||this.handleUserSearch()},this.gainedFocus=()=>{this.clearHighlighted(),this._isFocused=!0,this.loadState(),this.showFlyout()},this.lostFocus=()=>{this._isFocused=!1,this.input&&this.input.setAttribute("aria-activedescendant","");let e=this.renderRoot.querySelector(".people-list");if(e)for(let t of e.children)t.classList.remove("focused"),t.setAttribute("aria-selected","false");this.requestUpdate()},this.onUserKeyUp=e=>{let t=e.key,o=e.getModifierState("Control")||e.getModifierState("Meta"),i=o&&t==="v",n=["ArrowDown","ArrowRight","ArrowUp","ArrowLeft"].includes(t);if(!i&&o||n){(o||["ArrowLeft","ArrowRight"].includes(t))&&this.hideFlyout(),t==="ArrowDown"&&!this.flyout.isOpen&&this._isFocused&&this.handleUserSearch();return}if(!["Tab","Enter","Shift"].includes(t)){if(t==="Escape"){this.clearInput(),this._foundPeople=[],this._arrowSelectionCount=-1;return}if(t==="Backspace"&&this.userInput.length===0&&this.selectedPeople.length>0){this.clearHighlighted(),this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout();return}if([";",","].includes(t)){this.allowAnyEmail&&(this._setAnyEmail=!0,e.preventDefault(),e.stopPropagation());return}}},this.onUserInput=e=>{let t=e.target;this.userInput=t.value,this.userInput&&(yf(this.userInput)&&this.allowAnyEmail?this._setAnyEmail&&this.handleAnyEmail():this.handleUserSearch(),this._setAnyEmail=!1)},this.onUserKeyDown=e=>{e.stopPropagation();let t=e.key,o=this.renderRoot.querySelector(".selected-list"),i=e.getModifierState("Control")||e.getModifierState("Meta");if(i&&o){let n=o.querySelectorAll("mgt-person.selected-list-item-person");if(this.hideFlyout(),i&&t==="ArrowLeft")this._currentHighlightedUserPos=(this._currentHighlightedUserPos-1+n.length)%n.length,this._currentHighlightedUserPos>=0&&!Number.isNaN(this._currentHighlightedUserPos)?this._highlightedUsers.push(n[this._currentHighlightedUserPos]):this._currentHighlightedUserPos=0;else if(i&&t==="ArrowRight"){let s=this._highlightedUsers.pop();if(s){let a=s.parentElement;a&&(this.clearHighlighted(a),this._currentHighlightedUserPos++)}}else i&&t==="a"&&(this._highlightedUsers=[],n.forEach(s=>this._highlightedUsers.push(s)));this._highlightedUsers&&this.highlightSelectedPeople(this._highlightedUsers);return}if(this.clearHighlighted(),!!this.flyout.isOpen){if((t==="ArrowUp"||t==="ArrowDown")&&(this.handleArrowSelection(e),e.preventDefault()),t==="Enter")if(!e.shiftKey&&this._foundPeople){e.preventDefault();let n=this._foundPeople[this._arrowSelectionCount];n&&(this.addPerson(n),this.hideFlyout(),this.input.value="",this.hasMaxSelections&&this.disableTextInput())}else this.allowAnyEmail?this.handleAnyEmail():this.showFlyout();t==="Tab"&&this.hideFlyout(),[";",","].includes(t)&&this.allowAnyEmail&&(e.preventDefault(),this.userInput=this.input.value,this.handleAnyEmail())}},this.handleCut=()=>{this.writeHighlightedText().then(()=>{this.removeHighlightedOnCut()},()=>{})},this.handleCopy=()=>{this.writeHighlightedText()},this.handlePaste=()=>{navigator.clipboard.readText().then(e=>{if(e)try{let t=JSON.parse(e);if(t&&t.length>0)for(let o of t)this.addPerson(o)}catch(t){if(t instanceof SyntaxError){let o=[",",";"],i;try{for(let n of o)if(i=e.split(n),i.length>1){this.hideFlyout(),this.selectUsersById(i);break}}catch{}}}},e=>{})},this.clearState(),this._showLoading=!0,this.showMax=6,this.disableImages=!1,this.disabled=!1,this.allowAnyEmail=!1,this.addEventListener("copy",this.handleCopy),this.addEventListener("cut",this.handleCut),this.addEventListener("paste",this.handlePaste),this.addEventListener("selectionChanged",this.handleSelectionChanged)}disableTextInput(){let e=this.input.shadowRoot.querySelector("input");e&&(e.setAttribute("disabled","true"),e.value="")}enableTextInput(){let e=this.input.shadowRoot.querySelector("input");e&&(e.removeAttribute("disabled"),e.focus())}get hasMaxSelections(){return this.selectionMode==="single"&&this.selectedPeople.length>=1}focus(e){this.input&&(this.input.focus(e),this.input.select())}selectUsersById(e){var t;return Id(this,void 0,void 0,function*(){let o=K.globalProvider,i=K.globalProvider.graph;if(o&&o.state===ce.SignedIn)for(let n in e){let s=e[n];try{let a=yield xu(i,s,fC);this.addPerson(a)}catch(a){if(Tf(a)&&(!((t=a.message)===null||t===void 0)&&t.includes("does not exist"))&&this.allowAnyEmail&&yf(s)){let u={mail:s,displayName:s};this.addPerson(u)}}}})}selectGroupsById(e){return Id(this,void 0,void 0,function*(){let t=K.globalProvider,o=K.globalProvider.graph;if(t&&t.state===ce.SignedIn)for(let i in e)try{let n=yield bC(o,e[i]);this.addPerson(n)}catch{}})}render(){let e=this.renderTemplate("default",{people:this._foundPeople});if(e)return e;let t=this.renderSelectedPeople(this.selectedPeople),o=this.renderInput(t),i=this.renderFlyout(o);return k`
      <div>
        ${i}
      </div>
    `}clearState(){this.selectedPeople=[],this.userInput="",this._highlightedUsers=[],this._currentHighlightedUserPos=0}requestStateUpdate(e){return e&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[],this.defaultPeople=null),super.requestStateUpdate(e)}renderInput(e){var t,o,i;let n=this.disabled?"":this.placeholder||this.strings.inputPlaceholderText,s=this.hasMaxSelections?this.strings.maxSelectionsAriaLabel:"",a=k`<span class="search-icon">${Y(P.Search)}</span>`,u=((t=this.selectedPeople)===null||t===void 0?void 0:t.length)>0?e:a;return k`
      <fluent-text-field
        autocomplete="off"
        appearance="outline"
        slot="anchor"
        id="people-picker-input"
        role="combobox"
        placeholder=${this.hasMaxSelections?this.strings.maxSelectionsPlaceHolder:n}
        aria-label=${this.ariaLabel||s||n||this.strings.selectContact}
        aria-expanded=${(i=(o=this.flyout)===null||o===void 0?void 0:o.isOpen)!==null&&i!==void 0?i:!1}
        @click="${this.hasMaxSelections?void 0:this.handleInputClick}"
        @focus="${this.hasMaxSelections?void 0:this.gainedFocus}"
        @keydown="${this.hasMaxSelections?void 0:this.onUserKeyDown}"
        @input="${this.hasMaxSelections?void 0:this.onUserInput}"
        @blur="${this.lostFocus}"
        ?disabled=${this.disabled}
      >
        <span slot="start">${u}</span>
      </fluent-text-field>
    `}renderSelectedPeople(e){return e?.length?k`
       <ul
        id="selected-list"
        aria-label="${this.strings.selected}"
        class="selected-list">
          ${uo(e,t=>t?.id,t=>{var o;return k`
            <li class="selected-list-item">
              ${this.renderTemplate("selected-person",{person:t},`selected-${t?.id?t.id:t.displayName}`)||this.renderSelectedPerson(t)}

              <div
                role="button"
                tabindex="0"
                class="selected-list-item-close-icon"
                aria-label="${this.strings.removeSelectedUser}${(o=t?.displayName)!==null&&o!==void 0?o:""}"
                @click="${i=>this.removePerson(t,i)}"
                @keydown="${i=>this.handleRemovePersonKeyDown(t,i)}">
                  ${Y(P.Close)}
              </div>
          </li>`})}
      </ul>`:k``}renderFlyout(e){return Ee`
       <mgt-flyout light-dismiss class="flyout">
         ${e}
         <fluent-card
          tabindex="0"
          slot="flyout"
          class="flyout-root"
          @wheel=${t=>this.handleSectionScroll(t)}
          @keydown=${t=>this.onUserKeyDown(t)}
          class="custom">
           ${this.renderFlyoutContent()}
         </fluent-card>
       </mgt-flyout>
     `}renderFlyoutContent(){if(this.isLoadingState||this._showLoading)return this.renderLoading();let e=this._foundPeople;return!e||e.length===0||this.showMax===0?this.renderNoData():this.renderSearchResults(e)}renderLoading(){return this.renderTemplate("loading",null)||Ee`
         <div class="message-parent">
           <mgt-spinner></mgt-spinner>
           <div aria-label="${this.strings.loadingMessage}" class="loading-text">
             ${this.strings.loadingMessage}
           </div>
         </div>
       `}renderNoData(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||k`
         <div class="message-parent">
           <div aria-label=${this.strings.noResultsFound} class="search-error-text">
             ${this.strings.noResultsFound}
           </div>
         </div>
       `}renderSearchResults(e){let t=e.filter(o=>o.id);return k`
      <ul
        id="suggestions-list"
        class="searched-people-list"
        role="listbox"
        aria-live="polite"
        title=${this.strings.suggestionsTitle}
      >
         ${uo(t,o=>o.id,o=>k`
            <li
              id="${o.id}"
              class="searched-people-list-result"
              role="option"
              @click="${()=>this.handleSuggestionClick(o)}">
                ${this.renderPersonResult(o)}
            </li>
          `)}
       </ul>
     `}renderPersonResult(e){return this.renderTemplate("person",{person:e},e.id)||Ee`
         <mgt-person
          class="person-image-result"
          ?show-presence=${this.showPresence}
          view="twoLines"
          line2-property="jobTitle,mail"
          .personDetails=${e}
          .fetchImage=${!this.disableImages}>
          .personCardInteraction=${Kt.none}
        </mgt-person>`}renderSelectedPerson(e){return Ee`
       <mgt-person
         tabindex="-1"
         class="person-image-selected"
         .personDetails=${e}
         .fetchImage=${!this.disableImages}
         .view=${xe.oneline}
         .personCardInteraction=${Kt.none}>
        </mgt-person>
     `}loadState(){var e,t,o,i;return Id(this,void 0,void 0,function*(){let n=this.people,s=this.userInput.toLowerCase(),a=K.globalProvider;if(n)s&&(n=n.filter(h=>h?.displayName.toLowerCase().includes(s))),this._showLoading=!1;else if(!n&&a&&a.state===ce.SignedIn){let u=a.graph.forComponent(this);if(!s.length){if(this.defaultPeople)n=this.defaultPeople;else{if(this.groupId||this.groupIds){if(this._groupPeople===null){if(this.groupId)try{this.type===Ut.group?this._groupPeople=yield Sl(u,null,this.groupId,this.showMax,this.type,this.transitiveSearch):this._groupPeople=yield Sl(u,null,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters)}catch{this._groupPeople=[]}else if(this.groupIds)if(this.type===Ut.group)try{this._groupPeople=yield iv(u,this.groupIds,this.groupFilters)}catch{this._groupPeople=[]}else try{let h=yield j0(u,"",this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters);this._groupPeople=h}catch{this._groupPeople=[]}}n=this._groupPeople||[]}else if(this.type===Ut.person||this.type===Ut.any)if(this.userIds)n=yield xl(u,this.userIds,"",this.userFilters);else{let h=this.userType===vr.user||this.userType===vr.contact;this._userFilters&&h?n=yield fS(u,this._userFilters,this.showMax):n=yield kf(u,this.userType,this._peopleFilters,this.showMax)}else if(this.type===Ut.group)if(this.groupIds)try{n=yield this.getGroupsForGroupIds(u,n)}catch{}else{let h=(yield ov(u,"",this.showMax,this.groupType,this._groupFilters))||[];h.length>0&&h[0].value&&(h=h[0].value),n=h}this.defaultPeople=n}this._isFocused&&(this._showLoading=!1)}if((((e=this.defaultSelectedUserIds)===null||e===void 0?void 0:e.length)>0||((t=this.defaultSelectedGroupIds)===null||t===void 0?void 0:t.length)>0)&&!this.selectedPeople.length&&!this.defaultSelectedUsers.length&&!this.defaultSelectedGroups.length&&(this.defaultSelectedUsers=yield xl(u,this.defaultSelectedUserIds,"",this.userFilters),this.defaultSelectedGroups=yield iv(u,this.defaultSelectedGroupIds,this.peopleFilters),this.defaultSelectedGroups=this.defaultSelectedGroups.filter(h=>h!==null),this.defaultSelectedUsers=this.defaultSelectedUsers.filter(h=>h!==null),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.requestUpdate()),s)if(n=[],this.groupId)n=(yield Sl(u,s,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters))||[];else{if(this.type===Ut.person||this.type===Ut.any){try{if(this.userType===vr.contact||this.userType===vr.user)!((o=this.userIds)===null||o===void 0)&&o.length?n=yield xl(u,this.userIds,s,this._userFilters):n=yield kl(u,s,this.showMax,this._userFilters);else if(!this.groupIds)!((i=this.userIds)===null||i===void 0)&&i.length?n=yield xl(u,this.userIds,s,this._userFilters):n=(yield la(u,s,this.showMax,this.userType,this._peopleFilters))||[];else try{n=yield j0(u,s,this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters)}catch{}}catch{}if(n&&n.length<this.showMax&&this.userType!==vr.contact&&this.type!==Ut.person)try{let h=(yield kl(u,s,this.showMax,this._userFilters))||[],p=new Set(n.map(f=>f.id));for(let f of h)p.has(f.id)||n.push(f)}catch{}}if((this.type===Ut.group||this.type===Ut.any)&&n.length<this.showMax)if(this.groupIds)try{n=yield wP(u,s,this.groupIds,this.showMax,this.groupType,this.userFilters)}catch{}else{let h=[];try{h=(yield ov(u,s,this.showMax,this.groupType,this._groupFilters))||[],n=n.concat(h)}catch{}}}}this._foundPeople=this.filterPeople(n)})}getGroupsForGroupIds(e,t){return Id(this,void 0,void 0,function*(){let o=yield iv(e,this.groupIds,this.groupFilters);for(let i of o)t=t.concat(i);return t=t.filter(i=>i),t})}hideFlyout(){let e=this.flyout;e&&e.close(),this.input&&this.input.setAttribute("aria-activedescendant",""),this._arrowSelectionCount=-1}showFlyout(){let e=this.flyout;e&&e.open(),this._arrowSelectionCount=-1}removePerson(e,t){t.stopPropagation();let o=this.selectedPeople.filter(i=>!e.id&&i.displayName?i.displayName!==e.displayName:i.id!==e.id);this.hasMaxSelections&&this.enableTextInput(),this.selectedPeople=o,this.loadState()}handleRemovePersonKeyDown(e,t){t.key==="Enter"&&this.removePerson(e,t)}addPerson(e){e&&(setTimeout(()=>{this.clearInput()},50),this.selectedPeople.filter(o=>!e.id&&o.displayName?o.displayName===e.displayName:o.id===e.id).length===0&&(this.selectedPeople=[...this.selectedPeople,e],this.loadState(),this._foundPeople=[],this._arrowSelectionCount=-1))}clearInput(){this.clearHighlighted(),this.selectionMode!=="single"&&(this.input.value=""),this.userInput=""}handleAnyEmail(){if(this._showLoading=!1,this._arrowSelectionCount=-1,yf(this.userInput)){let e={mail:this.userInput,displayName:this.userInput};this.addPerson(e)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}handleSuggestionClick(e){this.addPerson(e),this.hasMaxSelections&&(this.disableTextInput(),this.input.value=""),this.hideFlyout()}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=Ac(()=>Id(this,void 0,void 0,function*(){let e=setTimeout(()=>{this._showLoading=!0},50);yield this.loadState(),clearTimeout(e),this._showLoading=!1,this._arrowSelectionCount=-1,this.showFlyout()}),400)),this._debouncedSearch()}writeHighlightedText(){return Id(this,void 0,void 0,function*(){let e=[];for(let o of this._highlightedUsers){let{id:i,displayName:n,mail:s,userPrincipalName:a,scoredEmailAddresses:u}=o._personDetails,h;u&&u.length>0?h=u.pop().address:h=a||s,e.push({id:i,displayName:n,email:h})}let t="";e.length>0&&(t=JSON.stringify(e)),yield navigator.clipboard.writeText(t)})}removeHighlightedOnCut(){this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-this._highlightedUsers.length),this._highlightedUsers=[],this._currentHighlightedUserPos=0,this.loadState(),this.hideFlyout()}highlightSelectedPeople(e){for(let t of e)(t?.parentElement).classList.add("highlighted")}clearHighlighted(e){if(e)e.classList.remove("highlighted");else{for(let t of this._highlightedUsers){let o=t.parentElement;o&&o.classList.remove("highlighted")}this._highlightedUsers=[],this._currentHighlightedUserPos=0}}handleArrowSelection(e){var t,o;let i=this.renderRoot.querySelector(".searched-people-list");if(!((t=i?.children)===null||t===void 0)&&t.length){e&&(e.key==="ArrowUp"&&(this._arrowSelectionCount===-1?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount-1+i.children.length)%i.children.length),e.key==="ArrowDown"&&(this._arrowSelectionCount===-1?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount+1+i.children.length)%i.children.length));for(let s of(o=i?.children)!==null&&o!==void 0?o:[]){let a=s;a.setAttribute("aria-selected","false"),a.blur(),a.removeAttribute("tabindex")}let n=i.children[this._arrowSelectionCount];n&&(n.setAttribute("tabindex","0"),n.focus(),n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),n.setAttribute("aria-selected","true"),this.input.setAttribute("aria-activedescendant",n?.id))}}filterPeople(e){let t=[];if(e&&e.length>0){e=e.filter(s=>s);let o=this.selectedPeople.map(s=>s.id?s.id:s.displayName),i=e.filter(s=>s?.id?o.indexOf(s.id)===-1:o.indexOf(s?.displayName)===-1),n=new Set;for(let s of i){let a=JSON.stringify(s);n.add(a)}n.forEach(s=>{let a=JSON.parse(s);t.push(a)})}return t}handleSectionScroll(e){let t=this.renderRoot.querySelector(".flyout-root");t&&!(e.deltaY<0&&t.scrollTop===0)&&!(e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1)&&e.stopPropagation()}};Ot([E({attribute:"group-id",converter:r=>r.trim()}),Ke("design:type",String),Ke("design:paramtypes",[Object])],bt.prototype,"groupId",null);Ot([E({attribute:"group-ids",converter:r=>r.split(",").map(e=>e.trim())}),Ke("design:type",Array),Ke("design:paramtypes",[Object])],bt.prototype,"groupIds",null);Ot([E({attribute:"type",converter:r=>(r=r.toLowerCase(),!r||r.length===0?Ut.any:typeof Ut[r]>"u"?Ut.any:Ut[r])}),Ke("design:type",Object),Ke("design:paramtypes",[Object])],bt.prototype,"type",null);Ot([E({attribute:"group-type",converter:r=>{if(!r||r.length===0)return Ar.any;let e=r.split(","),t=[];for(let i of e)i=i.trim(),typeof Ar[i]<"u"&&t.push(Ar[i]);return t.length===0?Ar.any:t.reduce((i,n)=>i|n)}}),Ke("design:type",Number),Ke("design:paramtypes",[Object])],bt.prototype,"groupType",null);Ot([E({attribute:"user-type",converter:r=>(r=r.toLowerCase(),!r||typeof vr[r]>"u"?vr.any:vr[r])}),Ke("design:type",String),Ke("design:paramtypes",[Object])],bt.prototype,"userType",null);Ot([E({attribute:"transitive-search",type:Boolean}),Ke("design:type",Boolean),Ke("design:paramtypes",[Boolean])],bt.prototype,"transitiveSearch",null);Ot([E({attribute:"people",type:Object}),Ke("design:type",Array),Ke("design:paramtypes",[Array])],bt.prototype,"people",null);Ot([E({attribute:"show-max",type:Number}),Ke("design:type",Number),Ke("design:paramtypes",[Number])],bt.prototype,"showMax",null);Ot([E({attribute:"disable-images",type:Boolean}),Ke("design:type",Boolean)],bt.prototype,"disableImages",void 0);Ot([E({attribute:"show-presence",type:Boolean}),Ke("design:type",Boolean)],bt.prototype,"showPresence",void 0);Ot([E({attribute:"selected-people",type:Array}),Ke("design:type",Array),Ke("design:paramtypes",[Array])],bt.prototype,"selectedPeople",null);Ot([E({attribute:"default-selected-user-ids",converter:r=>r.split(",").map(e=>e.trim()),type:String}),Ke("design:type",Array),Ke("design:paramtypes",[Object])],bt.prototype,"defaultSelectedUserIds",null);Ot([E({attribute:"default-selected-group-ids",converter:r=>r.split(",").map(e=>e.trim()),type:String}),Ke("design:type",Array),Ke("design:paramtypes",[Object])],bt.prototype,"defaultSelectedGroupIds",null);Ot([E({attribute:"placeholder",type:String}),Ke("design:type",String)],bt.prototype,"placeholder",void 0);Ot([E({attribute:"disabled",type:Boolean}),Ke("design:type",Boolean)],bt.prototype,"disabled",void 0);Ot([E({attribute:"allow-any-email",type:Boolean}),Ke("design:type",Boolean)],bt.prototype,"allowAnyEmail",void 0);Ot([E({attribute:"selection-mode",type:String}),Ke("design:type",String)],bt.prototype,"selectionMode",void 0);Ot([E({attribute:"user-ids",converter:r=>r.split(",").map(e=>e.trim()),type:String}),Ke("design:type",Array),Ke("design:paramtypes",[Array])],bt.prototype,"userIds",null);Ot([E({attribute:"user-filters"}),Ke("design:type",String),Ke("design:paramtypes",[String])],bt.prototype,"userFilters",null);Ot([E({attribute:"people-filters"}),Ke("design:type",String),Ke("design:paramtypes",[String])],bt.prototype,"peopleFilters",null);Ot([E({attribute:"group-filters"}),Ke("design:type",String),Ke("design:paramtypes",[String])],bt.prototype,"groupFilters",null);Ot([E({attribute:"aria-label",type:String}),Ke("design:type",String)],bt.prototype,"ariaLabel",void 0);Ot([le(),Ke("design:type",Boolean)],bt.prototype,"_showLoading",void 0);Ot([le(),Ke("design:type",Object)],bt.prototype,"_arrowSelectionCount",void 0);Ot([le(),Ke("design:type",Array)],bt.prototype,"_highlightedUsers",void 0);Ot([le(),Ke("design:type",Object)],bt.prototype,"_isFocused",void 0);Ot([le(),Ke("design:type",Object)],bt.prototype,"_setAnyEmail",void 0);Ot([le(),Ke("design:type",Array)],bt.prototype,"_foundPeople",void 0);ev();Yi();Tu();l();c();d();ue();Te();At();fi();Rl();Lc();da();Ai();Yi();l();c();d();Te();At();fi();ue();l();c();d();Te();var kP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative}:host .header::part(control){font-size:var(--arrow-options-button-font-size,large);font-weight:var(--arrow-options-button-font-weight,600);color:var(--arrow-options-button-font-color,var(--accent-base-color));background:var(--arrow-options-button-background-color,transparent)}:host .header::part(control):hover{background:var(--neutral-fill-stealth-hover)}:host .header::part(control):active,:host .header::part(control):focus{background:var(--neutral-fill-stealth-active)}:host .menu{position:absolute;left:var(--arrow-options-left,0);z-index:1;display:none}:host .menu.open{display:block;width:max-content}
`];Xr();yr();ue();var wC=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},CC=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},SP=()=>{vt(Th,Eh,Dr),Pe("arrow-options",Ad)},Ad=class extends fr{static get styles(){return kP}constructor(){super(),this.onHeaderClick=e=>{Object.keys(this.options).length>1&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)},this.onHeaderKeyDown=e=>{if(e.key==="Enter"){e.preventDefault(),e.stopPropagation(),this.open=!this.open;let t=this.renderRoot.querySelector("fluent-menu");t&&(t.classList.remove("closed"),t.classList.add("open"));let o=e.target;if(o){let i=this.renderRoot.querySelector("fluent-menu-item[tabindex='0']");i&&(o.blur(),i.focus())}}},this.value="",this.options={},this._clickHandler=()=>this.open=!1,window.addEventListener("onblur",()=>this.open=!1)}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){return k`
      <fluent-button
        class="header"
        @click=${this.onHeaderClick}
        @keydown=${this.onHeaderKeyDown}
        appearance="lightweight">
          ${this.value}
      </fluent-button>
      <fluent-menu
        class=${Ve({menu:!0,open:this.open,closed:!this.open})}>
          ${this.getMenuOptions()}
      </fluent-menu>`}getMenuOptions(){return Object.keys(this.options).map(t=>k`
          <fluent-menu-item
            @click=${n=>{this.open=!1,this.options[t](n)}}
            @keydown=${n=>{let s=this.renderRoot.querySelector(".header");n.key==="Enter"?(this.open=!1,this.options[t](n),s.focus()):n.key==="Tab"?this.open=!1:n.key==="Escape"&&(this.open=!1,s&&s.focus())}}>
              ${t}
          </fluent-menu-item>`)}};wC([E({type:Boolean}),CC("design:type",Boolean)],Ad.prototype,"open",void 0);wC([E({type:String}),CC("design:type",String)],Ad.prototype,"value",void 0);wC([E({type:Object}),CC("design:type",Object)],Ad.prototype,"options",void 0);l();c();d();yr();ue();Te();At();fi();l();c();d();var _P={dotOptionsTitle:"More options"};Xr();l();c();d();Te();var TP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{display:flex;flex-direction:column;align-items:flex-end}:host .dot-icon{font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .menu{position:absolute;box-shadow:var(--neutral-fill-rest) 0 0 40px 5px;background:var(--neutral-fill-rest);z-index:1;display:none;white-space:nowrap;transform:var(--dot-options-translatey,translateY(32px))}:host .menu.open{display:block}:host fluent-button::part(control){background:inherit}
`];ue();Vr();var EP=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},IP=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},AP=()=>{vt(Th,Eh,Dr),Pe("dot-options",qh)},qh=class extends fr{constructor(){super(...arguments),this._clickHandler=()=>this.open=!1,this.handleItemClick=(e,t)=>{e.preventDefault(),e.stopPropagation(),t(e),this.open=!1},this.handleItemKeydown=(e,t)=>{this.handleKeydownMenuOption(e),t(e),this.open=!1},this.onDotClick=e=>{e.preventDefault(),e.stopPropagation(),this.open=!this.open},this.onDotKeydown=e=>{e.key==="Enter"&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}}static get styles(){return TP}get strings(){return _P}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){let e=Object.keys(this.options);return k`
      <fluent-button
        appearance="stealth"
        aria-label=${this.strings.dotOptionsTitle}
        @click=${this.onDotClick}
        @keydown=${this.onDotKeydown}
        class="dot-icon">${Y(P.Dot)}</fluent-button>
      <fluent-menu class=${Ve({menu:!0,open:this.open})}>
        ${e.map(t=>this.getMenuOption(t,this.options[t]))}
      </fluent-menu>`}getMenuOption(e,t){return k`
      <fluent-menu-item
        @click=${o=>this.handleItemClick(o,t)}
        @keydown=${o=>this.handleItemKeydown(o,t)}>
          ${e}
      </fluent-menu-item>`}handleKeydownMenuOption(e){e.key==="Enter"&&(e.preventDefault(),e.stopPropagation())}};EP([E({type:Boolean}),IP("design:type",Boolean)],qh.prototype,"open",void 0);EP([E({type:Object}),IP("design:type",Object)],qh.prototype,"options",void 0);Fc();Il();l();c();d();Te();var RP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{background-color:var(--tasks-background-color,transparent);padding:var(--tasks-padding,12px);border:var(--tasks-border,0);border-radius:var(--tasks-border-radius,0);--skeleton-fill:var(--neutral-foreground-active)}:host .header{display:flex;align-items:center;justify-content:space-between;padding:var(--tasks-header-padding,0 0 14px 0);margin:var(--tasks-header-padding,0 0 14px 0);font-size:var(--tasks-header-font-size,16px);font-weight:var(--tasks-header-font-weight,600);color:var(--tasks-header-text-color,var(--neutral-foreground-hint))}:host .header:hover{color:var(--tasks-header-text-hover-color,var(--neutral-foreground-hover))}:host .header .title{justify-content:left;display:flex;align-items:center}:host .header .title .shimmer{width:80px;height:20px}:host .header .title svg{margin-top:3px;padding:0 4px;width:16px;height:16px}:host .header .new-task-button{justify-content:right}:host .header .new-task-button .shimmer{width:40px;height:24px}:host .header .new-task-button::part(control){font-weight:var(--tasks-new-button-text-font-weight,700);color:var(--tasks-new-button-text-color,var(--foreground-on-accent-rest));width:var(--tasks-new-button-width,none);height:var(--tasks-new-button-height,none);background:var(--tasks-new-button-background,padding-box linear-gradient(var(--accent-fill-rest),var(--accent-fill-rest)),border-box var(--accent-stroke-control-rest))}:host .header .new-task-button::part(control):hover{background:var(--tasks-new-button-background-hover,var(--accent-fill-hover))}:host .header .new-task-button::part(control):active{background:var(--tasks-new-button-background-active,var(--accent-fill-active))}:host .tasks{display:flex;flex-direction:column;row-gap:var(--tasks-gap,20px)}:host .tasks .task{display:flex;column-gap:4px;align-items:flex-start;justify-content:space-between}:host .tasks .task.updating{background:var(--neutral-stroke-rest)!important;pointer-events:none;opacity:.4}:host .tasks .task.complete{border:var(--task-complete-border,2px dotted var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-complete-background-color,transparent);padding:var(--task-complete-padding,10px)}:host .tasks .task.incomplete{border:var(--task-incomplete-border,1px solid var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-incomplete-background-color,var(--neutral-layer-1));padding:var(--task-incomplete-padding,10px)}:host .tasks .task .task-details-container{display:flex;flex-direction:column;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top{display:flex;justify-content:space-between;column-gap:4px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:row}:host .tasks .task .task-details-container .top .check-and-title{display:flex;align-items:flex-start;flex-direction:column;width:100%;row-gap:12px}:host .tasks .task .task-details-container .top .check-and-title.shimmer{display:flex;flex-direction:inherit;gap:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .checkbox{height:10px;width:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .title{height:10px;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content{display:grid;grid-template-columns:repeat(auto-fit,250px);gap:12px;justify-content:start;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content .picker{max-width:250px}:host .tasks .task .task-details-container .top .check-and-title .task-content .task-due fluent-text-field.dark::part(control){color-scheme:dark}:host .tasks .task .task-details-container .top .task-options .options{height:10px;width:20px}:host .tasks .task .task-details-container .top .task-options.new-task-action-buttons{display:flex;flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:column;grid-auto-columns:1fr;grid-column-gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket,:host .tasks .task .task-details-container .bottom .task-due,:host .tasks .task .task-details-container .bottom .task-group{display:flex;align-items:center;gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon{display:flex;place-content:center;width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon .shimmer.icon{width:20px;height:20px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg{width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg path{fill:var(--task-icons-background-color,var(--neutral-foreground-hint))}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text{color:var(--task-icons-text-font-color,var(--neutral-foreground-hint));font-size:var(--task-icons-text-font-size,12px);font-weight:var(--task-icons-text-font-weight,600);white-space:normal;width:100%}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details{display:flex;flex-direction:column;row-gap:8px}:host .tasks .task .task-details-container .task-details.shimmer{flex-direction:row;place-items:center;column-gap:6px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.icon{width:24px;height:24px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details .task-title{color:var(--foreground-on-neutral-rest)}:host .tasks .task .task-details-container .task-details .task-body{display:flex}:host fluent-button.add-task::part(control){font-weight:var(--task-add-new-button-text-font-weight,initial);color:var(--task-add-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-add-new-button-width,none);height:var(--task-add-new-button-height,none);background:var(--task-add-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-add-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.add-task::part(control):hover{background:var(--task-add-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.add-task::part(control):active{background:var(--task-add-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-button.cancel-task::part(control){font-weight:var(--task-cancel-new-button-text-font-weight,initial);color:var(--task-cancel-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-cancel-new-button-width,none);height:var(--task-cancel-new-button-height,none);background:var(--task-cancel-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-cancel-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.cancel-task::part(control):hover{background:var(--task-cancel-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.cancel-task::part(control):active{background:var(--task-cancel-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-option{background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-option:hover{background:var(--task-new-dropdown-option-hover-background-color,var(--neutral-fill-stealth-hover))}:host fluent-option::part(content){color:var(--task-new-dropdown-option-text-color,var(--neutral-foreground-rest))}:host fluent-select::part(listbox){background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-select::part(control){border:var(--task-new-dropdown-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-dropdown-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-dropdown-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-select::part(control):hover{background:var(--task-new-dropdown-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-select::part(control)::placeholder{color:var(--task-new-dropdown-placeholder-color,var(--input-placeholder-rest))}:host fluent-checkbox{padding-top:1px}:host fluent-checkbox::part(control){border-radius:50%;background:var(--task-incomplete-checkbox-background-color,var(--neutral-fill-input-alt-rest))}:host fluent-checkbox::part(control):hover{background:var(--task-incomplete-checkbox-background-hover-color,var(--neutral-fill-input-alt-hover))}:host fluent-checkbox::part(label){font-size:var(--task-title-text-font-size,medium);font-weight:var(--task-title-text-font-weight,600);color:var(--task-incomplete-title-text-color,var(var(--neutral-foreground-rest)))}:host fluent-checkbox.checked::part(control){background:var(--task-complete-checkbox-background-color,var(--accent-fill-rest));color:var(--task-complete-checkbox-text-color,currentColor)}:host fluent-checkbox.checked::part(label){text-decoration:line-through;color:var(--task-complete-title-text-color,var(--neutral-foreground-hint))}:host fluent-text-field.new-task{width:100%}:host fluent-text-field.new-task::part(root){border:var(--task-new-input-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-input-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-input-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-text-field.new-task::part(root):hover{background:var(--task-new-input-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-text-field.new-task::part(root)::placeholder{color:var(--task-new-input-placeholder-color,var(--input-placeholder-rest))}:host .people [slot=no-data] fluent-button::part(control){color:var(--task-new-person-icon-text-color,var(--neutral-foreground-hint))}:host .people [slot=no-data] svg{fill:var(--task-new-person-icon-color,var(--neutral-foreground-hint))}@media only screen and (width <= 600px){:host fluent-select{width:100%}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:row;grid-auto-columns:unset;row-gap:4px}:host .tasks .task .task-details-container .bottom .ask-bucket,:host .tasks .task .task-details-container .bottom .ask-due,:host .tasks .task .task-details-container .bottom .ask-group{margin-inline-start:8px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .top.add-new-task .check-and-title .task-content{display:grid;grid-auto-flow:row;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top.add-new-task .task-options.new-task-action-buttons{flex-direction:row;column-gap:4px}}
`];l();c();d();var PP={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding a task...",addTaskButtonSubtitle:"Add",due:"Due ",addTaskDate:"Add the task date",assign:"Assign",planNotFound:"Plan not found",plansSelfAssigned:"All Plans",bucketNotFound:"Bucket not found",bucketsSelfAssigned:"All Tasks",baseSelfAssigned:"Assigned to Me"};l();c();d();ue();l();c();d();ue();var _n=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},xC=["Tasks.ReadWrite","Group.ReadWrite.All"],Gh=["Tasks.Read","Group.Read.All","Tasks.ReadWrite","Group.ReadWrite.All"],$P=(r,e)=>_n(void 0,void 0,void 0,function*(){return yield r.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(ye(xC)).post(e)}),OP=(r,e,t)=>_n(void 0,void 0,void 0,function*(){yield kC(r,e,{assignments:t,appliedCategories:{category4:!0}})}),MP=(r,e)=>_n(void 0,void 0,void 0,function*(){yield r.api(`/planner/tasks/${e.id}`).header("Cache-Control","no-store").header("If-Match",e.eTag).middlewareOptions(ye(xC)).delete()}),FP=(r,e)=>_n(void 0,void 0,void 0,function*(){yield kC(r,e,{percentComplete:100})}),DP=(r,e)=>_n(void 0,void 0,void 0,function*(){yield kC(r,e,{percentComplete:0})}),kC=(r,e,t)=>_n(void 0,void 0,void 0,function*(){let o;try{o=yield r.api(`/planner/tasks/${e.id}`).header("Cache-Control","no-store").middlewareOptions(ye(xC)).header("Prefer","return=representation").header("If-Match",e.eTag).update(t)}catch{}return o}),LP=(r,e)=>_n(void 0,void 0,void 0,function*(){let t=`/groups/${e}/planner/plans`,o=yield r.api(t).header("Cache-Control","no-store").middlewareOptions(ye(Gh)).get();return o?.value}),NP=(r,e)=>_n(void 0,void 0,void 0,function*(){return yield r.api(`/planner/plans/${e}`).header("Cache-Control","no-store").middlewareOptions(ye(Gh)).get()}),HP=(r,e)=>_n(void 0,void 0,void 0,function*(){let t=yield r.api(`/planner/plans/${e}/buckets`).header("Cache-Control","no-store").middlewareOptions(ye(Gh)).get();return t?.value}),UP=r=>_n(void 0,void 0,void 0,function*(){let e=yield r.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(ye(Gh)).get();return e?.value}),BP=(r,e)=>_n(void 0,void 0,void 0,function*(){let t=yield r.api(`/planner/buckets/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(ye(Gh)).get();return t?.value});var ss=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},SC=class{constructor(e){this.graph=Zs.fromGraph(e)}},sv=class extends SC{getTaskGroups(){return ss(this,void 0,void 0,function*(){return(yield UP(this.graph)).map(t=>{var o;return{id:t.id,title:t.title,containerId:(o=t?.container)===null||o===void 0?void 0:o.containerId}})})}getTaskGroupsForGroup(e){return ss(this,void 0,void 0,function*(){return(yield LP(this.graph,e)).map(o=>({id:o.id,title:o.title}))})}getTaskGroup(e){return ss(this,void 0,void 0,function*(){let t=yield NP(this.graph,e);return{id:t.id,title:t.title,_raw:t}})}getTaskFoldersForTaskGroup(e){return ss(this,void 0,void 0,function*(){return(yield HP(this.graph,e)).map(o=>({_raw:o,id:o.id,name:o.name,parentId:o.planId}))})}getTasksForTaskFolder(e){return ss(this,void 0,void 0,function*(){return(yield BP(this.graph,e)).map(o=>({_raw:o,assignments:o.assignments,completed:o.percentComplete===100,dueDate:o.dueDateTime&&new Date(o.dueDateTime),eTag:o["@odata.etag"],id:o.id,immediateParentId:o.bucketId,name:o.title,topParentId:o.planId}))})}setTaskComplete(e){return ss(this,void 0,void 0,function*(){return yield FP(this.graph,e)})}setTaskIncomplete(e){return ss(this,void 0,void 0,function*(){return DP(this.graph,e)})}addTask(e){var t;return ss(this,void 0,void 0,function*(){return yield $P(this.graph,{assignments:e.assignments,bucketId:e.immediateParentId,dueDateTime:(t=e.dueDate)===null||t===void 0?void 0:t.toISOString(),planId:e.topParentId,title:e.name})})}assignPeopleToTask(e,t){return ss(this,void 0,void 0,function*(){return OP(this.graph,e,t)})}removeTask(e){return ss(this,void 0,void 0,function*(){return yield MP(this.graph,e)})}isAssignedToMe(e,t){return Object.keys(e.assignments).includes(t)}};Vr();l();c();d();yr();var av=r=>{let e=Gi.getValueFor(r);return qi(tt.create(e,e,e))};Xr();yr();ue();var qt=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Gt=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Xi=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},_C={"@odata.type":"#microsoft.graph.plannerAssignment",orderHint:" !"},zP=()=>{vt(zw,nc,xn,Dr,ic,Ph),SP(),AP(),ua(),Td(),nv(),Pe("planner",It)},It=class extends st{static get styles(){return RP}get strings(){return PP}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(e){this._isNewTaskVisible=e,e||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="",this._newTaskContainerId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...Lr.requiredScopes,...bt.requiredScopes])]}get filteredTasks(){let e=this._tasks.filter(t=>this.isTaskInSelectedGroupFilter(t)).filter(t=>this.isTaskInSelectedFolderFilter(t)).filter(t=>!this._hiddenTasks.includes(t.id));return this.taskFilter?e.filter(t=>this.taskFilter(t._raw)):e}constructor(){super(),this._isDarkMode=!1,this._me=null,this.onResize=()=>{this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())},this.onThemeChanged=()=>{this._isDarkMode=av(this)},this.onAddTaskClick=()=>{var e;let t=this.getPeoplePicker(null),o={};if(t)for(let i of(e=t?.selectedPeople)!==null&&e!==void 0?e:[])o[i.id]=_C;!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,o)},this.onAddTaskKeyDown=e=>{(e.key==="Enter"||e.key===" ")&&this.onAddTaskClick()},this.addNewTaskButtonClick=()=>{this.isNewTaskVisible=!this.isNewTaskVisible},this.newTaskVisible=e=>{e.key==="Enter"&&(this.isNewTaskVisible=!1)},this.handleDateChange=e=>{let t=e.target.value;t?this._newTaskDueDate=new Date(t+"T17:00"):this._newTaskDueDate=null},this.renderPlannerIcon=e=>Y(P.Planner,e),this.renderBucketIcon=e=>Y(P.Milestone,e),this.handlePeopleClick=(e,t)=>{this.togglePeoplePicker(t),e.stopPropagation()},this.handlePeopleKeydown=(e,t)=>{(e.key==="Enter"||e.key===" ")&&(this.togglePeoplePicker(t),e.stopPropagation(),e.preventDefault())},this.handlePeoplePickerKeydown=e=>{e.key==="Enter"&&e.stopPropagation()},this.clearState(),this.previousMediaQuery=this.mediaQuery}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("resize",this.onResize),window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1}firstUpdated(e){super.firstUpdated(e),this.initialId&&!this._currentGroup&&(this._currentGroup=this.initialId),this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}render(){let e=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null,t;return this.hideHeader||(t=k`
        <div class="header">
          ${this.renderPlanOptions()}
        </div>
      `),k`
      ${t}
      <div class="tasks">
        ${this._isNewTaskVisible?this.renderNewTask():null} ${e}
        ${uo(this.filteredTasks,o=>o.id,o=>this.renderTask(o))}
      </div>
    `}loadState(){return Xi(this,void 0,void 0,function*(){let e=this.getTaskSource();if(!e)return;let t=K.globalProvider;if(!(!t||t.state!==ce.SignedIn)){if(this._inTaskLoad=!0,!this._me){let o=t.graph.forComponent(this);this._me=yield Cu(o)}this.groupId?yield this._loadTasksForGroup(e):this.targetId?yield this._loadTargetPlannerTasks(e):yield this._loadAllTasks(e),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0}})}_loadTargetPlannerTasks(e){return Xi(this,void 0,void 0,function*(){let t=yield e.getTaskGroup(this.targetId),o=yield e.getTaskFoldersForTaskGroup(t.id);this.targetBucketId&&(o=o.filter(n=>n.id===this.targetBucketId));let i=(yield Promise.all(o.map(n=>e.getTasksForTaskFolder(n.id,n.parentId)))).reduce((n,s)=>[...n,...s],[]);this._tasks=i,this._folders=o,this._groups=[t]})}_loadAllTasks(e){return Xi(this,void 0,void 0,function*(){let t=yield e.getTaskGroups(),o=(yield Promise.all(t.map(n=>e.getTaskFoldersForTaskGroup(n.id)))).reduce((n,s)=>[...n,...s],[]),i=(yield Promise.all(o.map(n=>e.getTasksForTaskFolder(n.id,n.parentId)))).reduce((n,s)=>[...n,...s],[]);this._tasks=i,this._folders=o,this._groups=t})}_loadTasksForGroup(e){return Xi(this,void 0,void 0,function*(){let t=yield e.getTaskGroupsForGroup(this.groupId),o=(yield Promise.all(t.map(n=>e.getTaskFoldersForTaskGroup(n.id)))).reduce((n,s)=>[...n,...s],[]),i=(yield Promise.all(o.map(n=>e.getTasksForTaskFolder(n.id,n.parentId)))).reduce((n,s)=>[...n,...s],[]);this._tasks=i,this._folders=o,this._groups=t})}addTask(e,t,o,i,n={}){return Xi(this,void 0,void 0,function*(){let s=this.getTaskSource();if(!s)return;let a={assignments:n,dueDate:t,immediateParentId:i,name:e,topParentId:o};this._newTaskBeingAdded=!0,a._raw=yield s.addTask(a),this.fireCustomEvent("taskAdded",a),yield this.requestStateUpdate(),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1})}completeTask(e){return Xi(this,void 0,void 0,function*(){let t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskComplete(e),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter(o=>o!==e.id))})}uncompleteTask(e){return Xi(this,void 0,void 0,function*(){let t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskIncomplete(e),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter(o=>o!==e.id))})}removeTask(e){return Xi(this,void 0,void 0,function*(){let t=this.getTaskSource();t&&(this._hiddenTasks=[...this._hiddenTasks,e.id],yield t.removeTask(e),this.fireCustomEvent("taskRemoved",e),yield this.requestStateUpdate(),this._hiddenTasks=this._hiddenTasks.filter(o=>o!==e.id))})}assignPeople(e,t=[]){return Xi(this,void 0,void 0,function*(){let o=this.getTaskSource();if(!o)return;let i=[];e&&e.assignments&&(i=Object.keys(e.assignments).sort());let n=t.map(u=>u.id);if(n.length===i.length&&n.sort().every((u,h)=>u===i[h]))return;let a={};for(let u of i)n.includes(u)?a[u]=_C:a[u]=null;n.forEach(u=>{i.includes(u)||(a[u]=_C)}),e&&(yield o.assignPeopleToTask(e,a),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter(u=>u!==e.id))})}renderPlanOptions(){var e;let t=K.globalProvider;if(!t||t.state!==ce.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return k`<span class="loading-header"></span>`;let o=this.readOnly||this._isNewTaskVisible?null:k`
          <fluent-button
            appearance="accent"
            class="new-task-button"
            @click=${this.addNewTaskButtonClick}>
              <span slot="start">${Y(P.Add,"currentColor")}</span>
              ${this.strings.addTaskButtonSubtitle}
          </fluent-button>
        `,i=this._groups.find(f=>f.id===this._currentGroup)||{title:this.strings.baseSelfAssigned},n={[this.strings.baseSelfAssigned]:()=>{this._currentGroup=null,this._currentFolder=null}};for(let f of this._groups)n[f.title]=()=>{this._currentGroup=f.id,this._currentFolder=null};let s=Ee`
        <mgt-arrow-options
          class="arrow-options"
          .options="${n}"
          .value="${i.title}"
        ></mgt-arrow-options>`,a=this._currentGroup?Y(P.ChevronRight):null,u=this._folders.find(f=>f.id===this._currentFolder)||{name:this.strings.bucketsSelfAssigned},h={[this.strings.bucketsSelfAssigned]:()=>{this._currentFolder=null}};for(let f of this._folders.filter(b=>b.parentId===this._currentGroup))h[f.name]=()=>{this._currentFolder=f.id};let p=this.targetBucketId?k`
            <span class="plan-title">
              ${((e=this._folders[0])===null||e===void 0?void 0:e.name)||""}
            </span>`:Ee`
            <mgt-arrow-options class="arrow-options" .options="${h}" .value="${u.name}"></mgt-arrow-options>
          `;return k`
        <div class="Title">
          ${s} ${a} ${this._currentGroup?p:null}
        </div>
        ${o}
      `}renderNewTask(){let e="var(--neutral-foreground-hint)",t=k`
      <fluent-text-field
        autocomplete="off"
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        class="new-task"
        aria-label=${this.strings.newTaskPlaceholder}
        @input=${b=>this._newTaskName=b.target.value}>
      </fluent-text-field>`;this._groups.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=this._groups[0].id);let o=k`
      ${uo(this._groups,b=>b.id,b=>k`<fluent-option value="${b.id}">${b.title}</fluent-option>`)}`,i=this._currentGroup?k`
          <span class="new-task-group">
            ${this.renderPlannerIcon(e)}
            <span>${this.getPlanTitle(this._currentGroup)}</span>
          </span>`:k`
            <fluent-select>
              <span slot="start">${this.renderPlannerIcon(e)}</span>
              ${this._groups.length>0?o:k`<fluent-option selected>No groups found</fluent-option>`}
            </fluent-select>`,n=this._folders.filter(b=>this._currentGroup&&b.parentId===this._currentGroup||!this._currentGroup&&b.parentId===this._newTaskGroupId);n.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=n[0].id);let s=k`
      ${uo(n,b=>b.id,b=>k`<fluent-option value="${b.id}">${b.name}</fluent-option>`)}`,a=this._currentFolder?k`
          <span class="new-task-bucket">
            ${this.renderBucketIcon(e)}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `:k`
         <fluent-select>
          <span slot="start">${this.renderBucketIcon(e)}</span>
          ${n.length>0?s:k`<fluent-option selected>No folders found</fluent-option>`}
        </fluent-select>`,u={dark:this._isDarkMode,"new-task":!0},h=k`
      <fluent-text-field
        autocomplete="off"
        type="date"
        class=${Ve(u)}
        aria-label="${this.strings.addTaskDate}"
        .value="${this.dateToInputValue(this._newTaskDueDate)}"
        @change=${this.handleDateChange}>
      </fluent-text-field>`,p=this.renderAssignedPeople(null),f=this._newTaskBeingAdded?k`<div class="task-add-button-container"></div>`:k`
          <fluent-button
            class="add-task"
            @click=${this.onAddTaskClick}
            @keydown=${this.onAddTaskKeyDown}
            appearance="neutral">
              ${this.strings.addTaskButtonSubtitle}
          </fluent-button>
          <fluent-button
            class="cancel-task"
            @click=${()=>this.isNewTaskVisible=!1}
            @keydown=${this.newTaskVisible}
            appearance="neutral">
              ${this.strings.cancelNewTaskSubtitle}
          </fluent-button>`;return k`
    <div
      class=${Ve({task:!0,"new-task":!0})}>
      <div class="task-details-container">
        <div class="top add-new-task">
          <div class="check-and-title">
            ${t}
            <div class="task-content">
              <div class="task-group">${i}</div>
              <div class="task-bucket">${a}</div>
              ${p}
              <div class="task-due">${h}</div>
            </div>
          </div>
          <div class="task-options new-task-action-buttons">${f}</div>
        </div>
      </div>
    </div>
  `}togglePeoplePicker(e){let t=this.getPeoplePicker(e),o=this.getMgtPeople(e),i=this.getFlyout(e);t&&o&&i&&(i.isOpen?i.close():(t.selectedPeople=o.people,i.open(),setTimeout(()=>t.focus(),100)))}updateAssignedPeople(e){let t=this.getPeoplePicker(e),o=this.getMgtPeople(e);t&&t.selectedPeople!==o.people&&(o.people=t.selectedPeople,this.assignPeople(e,t.selectedPeople))}getPeoplePicker(e){let t=e?e.id:"new-task";return this.renderRoot.querySelector(`.picker-${t}`)}getMgtPeople(e){let t=e?e.id:"new-task";return this.renderRoot.querySelector(`.people-${t}`)}getFlyout(e){let t=e?e.id:"new-task";return this.renderRoot.querySelector(`.flyout-${t}`)}renderTask(e){let{name:t="Task",completed:o=!1,dueDate:i}=e,n=this._currentGroup?null:this.getPlanTitle(e.topParentId),s=this._currentFolder?null:this.getFolderName(e.immediateParentId),a={task:Object.assign(Object.assign({},e._raw),{groupTitle:n,folderTitle:s})},u=this.renderTemplate("task",a,e.id);if(u)return u;let h=this.renderTemplate("task-details",a,`task-details-${e.id}`);if(!h){let b="var(--neutral-foreground-hint)",x=this._currentGroup?null:k`
              <div class="task-group">
                <span class="task-icon">${this.renderPlannerIcon(b)}</span>
                <span class="task-icon-text">${this.getPlanTitle(e.topParentId)}</span>
              </div>
            `,S=this._currentFolder?null:k`
            <div class="task-bucket">
              <span class="task-icon">${this.renderBucketIcon(b)}</span>
              <span class="task-icon-text">${this.getFolderName(e.immediateParentId)}</span>
            </div>
          `,R=i?k`
            <div class="task-due">
              <span class="task-icon-text">${this.strings.due}${dS(i)}</span>
            </div>
          `:null,z=this.renderAssignedPeople(e);h=k`${x} ${S} ${z} ${R}`}let p=this.readOnly||this.hideOptions?null:Ee`
            <mgt-dot-options
              class="dot-options"
              .options="${{[this.strings.removeTaskSubtitle]:()=>this.removeTask(e)}}"
            ></mgt-dot-options>`,f=Ve({task:!0,complete:o,incomplete:!o,"read-only":this.readOnly});return k`
      <div
        data-id="task-${e.id}"
        class=${f}
        @click=${()=>this.handleTaskClick(e)}>
        <div class="task-details-container">
          <div class="top">
            <div class="check-and-title">
              <fluent-checkbox
                @click=${b=>this.handleTaskCheckClick(b,e)}
                @keydown=${b=>this.handleTaskCheckKeyDown(b,e)}
                ?checked=${o}>
                  ${t}
              </fluent-checkbox>
            </div>
            <div class="task-options">${p}</div>
          </div>
          <div class="bottom">${h}</div>
        </div>
      </div>
    `}handleTaskCheckKeyDown(e,t){return Xi(this,void 0,void 0,function*(){e.key==="Enter"&&(e.stopPropagation(),e.preventDefault(),yield this.checkTask(t))})}handleTaskCheckClick(e,t){return Xi(this,void 0,void 0,function*(){e.stopPropagation(),e.preventDefault(),yield this.checkTask(t)})}checkTask(e){return Xi(this,void 0,void 0,function*(){if(!this.readOnly){let t=this.shadowRoot.querySelector(`[data-id='task-${e.id}'`);t&&t.classList.add("updating"),e.completed?yield this.uncompleteTask(e):yield this.completeTask(e),t&&t.classList.remove("updating")}})}renderAssignedPeople(e){var t;let o,i={"new-task-assignee":e===null,"task-assignee":e!==null,"task-detail":e!==null},n=e?e.id:"new-task";i[`flyout-${n}`]=!0;let s=e?Object.keys(e.assignments).map(p=>p):[];if(!this.newTaskVisible){let p=e?._raw,f=p?.planId;f&&(o=(t=this._groups.filter(x=>x.id===f).pop())===null||t===void 0?void 0:t.containerId)}let a=this.isNewTaskVisible?this._newTaskContainerId:o,u=Ee`
      <mgt-people
        class="people people-${n}"
        .userIds=${s}
        .personCardInteraction=${Kt.none}
        @click=${p=>this.handlePeopleClick(p,e)}
        @keydown=${p=>this.handlePeopleKeydown(p,e)}
      >
        <template data-type="no-data">
          <fluent-button>
            <span style="display:flex;place-content:start;gap:4px;padding-inline-start:4px">
              <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">
                <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>
                <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>
                <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>
              </svg> Assign</span>
            </fluent-button>
        </template>
      </mgt-people>`,h=Ee`
      <mgt-people-picker
        class="people-picker picker-${n}"
        .groupId=${Qo(a)}
        @keydown=${this.handlePeoplePickerKeydown}>
      ></mgt-people-picker>`;return Ee`
      <mgt-flyout
        light-dismiss
        class=${Ve(i)}
        @closed=${()=>this.updateAssignedPeople(e)}
      >
        <div slot="anchor">${u}</div>
        <div slot="flyout" part="picker" class="picker">${h}</div>
      </mgt-flyout>
    `}handleTaskClick(e){e&&this.fireCustomEvent("taskClick",e)}renderLoadingTask(){return k`
      <div class="header">
        <div class="title">
          <fluent-skeleton shimmer class="shimmer" shape="rect"></fluent-skeleton>
        </div>
        <div class="new-task-button">
          <fluent-skeleton shimmer class="shimmer" shape="rect"></fluent-skeleton>
        </div>
      </div>
      <div class="tasks">
        <div class="task incomplete">
          <div class="task-details-container">
            <div class="top">
              <div class="check-and-title shimmer">
                <fluent-skeleton shimmer class="checkbox" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="title" shape="rect"></fluent-skeleton>
              </div>
              <div class="task-options">
                <fluent-skeleton shimmer class="options" shape="rect"></fluent-skeleton>
              </div>
            </div>
            <div class="bottom">
              <div class="task-group">
                <div class="task-icon">
                  <fluent-skeleton shimmer class="shimmer icon" shape="rect"></fluent-skeleton>
                </div>
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              <div class="task-bucket">
                <div class="task-icon">
                  <fluent-skeleton shimmer class="shimmer icon" shape="rect"></fluent-skeleton>
                </div>
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              <div class="task-details shimmer">
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
              </div>
              <div class="task-due">
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              </div>
          </div>
        </div>
      </div>
    `}getTaskSource(){let e=K.globalProvider;if(!e||e.state!==ce.SignedIn)return null;let t=e.graph.forComponent(this);return new sv(t)}getPlanTitle(e){return e?e===this.strings.plansSelfAssigned?this.strings.plansSelfAssigned:(this._groups.find(t=>t.id===e)||{title:this.strings.planNotFound}).title:this.strings.baseSelfAssigned}getFolderName(e){return e?(this._folders.find(t=>t.id===e)||{name:this.strings.bucketNotFound}).name:this.strings.bucketsSelfAssigned}isTaskInSelectedGroupFilter(e){var t;return!this._currentGroup||e.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(e,(t=this._me)===null||t===void 0?void 0:t.id)}isTaskInSelectedFolderFilter(e){return e.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(e){return e?new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().split("T")[0]:null}};qt([E({attribute:"read-only",type:Boolean}),Gt("design:type",Boolean)],It.prototype,"readOnly",void 0);qt([E({attribute:"target-id",type:String}),Gt("design:type",String)],It.prototype,"targetId",void 0);qt([E({attribute:"target-bucket-id",type:String}),Gt("design:type",String)],It.prototype,"targetBucketId",void 0);qt([E({attribute:"initial-id",type:String}),Gt("design:type",String)],It.prototype,"initialId",void 0);qt([E({attribute:"initial-bucket-id",type:String}),Gt("design:type",String)],It.prototype,"initialBucketId",void 0);qt([E({attribute:"hide-header",type:Boolean}),Gt("design:type",Boolean)],It.prototype,"hideHeader",void 0);qt([E({attribute:"hide-options",type:Boolean}),Gt("design:type",Boolean)],It.prototype,"hideOptions",void 0);qt([E({attribute:"group-id",type:String}),Gt("design:type",String)],It.prototype,"groupId",void 0);qt([le(),Gt("design:type",Boolean)],It.prototype,"_isNewTaskVisible",void 0);qt([le(),Gt("design:type",Boolean)],It.prototype,"_newTaskBeingAdded",void 0);qt([le(),Gt("design:type",String)],It.prototype,"_newTaskName",void 0);qt([le(),Gt("design:type",Date)],It.prototype,"_newTaskDueDate",void 0);qt([le(),Gt("design:type",String)],It.prototype,"_newTaskGroupId",void 0);qt([le(),Gt("design:type",String)],It.prototype,"_newTaskFolderId",void 0);qt([le(),Gt("design:type",String)],It.prototype,"_newTaskContainerId",void 0);qt([le(),Gt("design:type",Array)],It.prototype,"_groups",void 0);qt([le(),Gt("design:type",Array)],It.prototype,"_folders",void 0);qt([le(),Gt("design:type",Array)],It.prototype,"_tasks",void 0);qt([le(),Gt("design:type",Array)],It.prototype,"_hiddenTasks",void 0);qt([le(),Gt("design:type",Array)],It.prototype,"_loadingTasks",void 0);qt([le(),Gt("design:type",Boolean)],It.prototype,"_inTaskLoad",void 0);qt([le(),Gt("design:type",Boolean)],It.prototype,"_hasDoneInitialLoad",void 0);qt([le(),Gt("design:type",String)],It.prototype,"_currentGroup",void 0);qt([le(),Gt("design:type",String)],It.prototype,"_currentFolder",void 0);qt([le(),Gt("design:type",Object)],It.prototype,"_isDarkMode",void 0);qt([le(),Gt("design:type",Object)],It.prototype,"_me",void 0);l();c();d();Te();At();fi();ue();Cs();pn();Vr();Ai();l();c();d();Te();var VP=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .container{display:flex;flex-direction:column;position:relative}:host .dropdown{display:none;position:absolute;z-index:1000;top:34px}:host .dropdown.visible{display:flex}:host .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text{font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text{margin:auto}:host fluent-card{background:var(--channel-picker-dropdown-background-color,var(--fill-color));padding:2px;--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){background:padding-box linear-gradient(var(--channel-picker-input-background-color,var(--neutral-fill-input-rest)),var(--channel-picker-input-background-color,var(--neutral-fill-input-rest))),border-box var(--channel-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover)),var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover))),border-box var(--channel-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus)),var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus))),border-box var(--channel-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(control){word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--channel-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--channel-picker-input-placeholder-text-color-hover,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--channel-picker-input-placeholder-text-color-focus,var(--input-placeholder-filled))}:host fluent-text-field .search-icon svg path{fill:var(--channel-picker-search-icon-color,currentColor)}:host fluent-text-field .down-chevron{height:auto;min-width:auto}:host fluent-text-field .down-chevron svg path{fill:var(--channel-picker-down-chevron-color,currentColor)}:host fluent-text-field .up-chevron{height:auto;min-width:auto}:host fluent-text-field .up-chevron svg path{fill:var(--channel-picker-up-chevron-color,currentColor)}:host fluent-text-field .close-icon{height:auto;min-width:auto}:host fluent-text-field .close-icon svg path{fill:var(--channel-picker-close-icon-color,currentColor)}:host fluent-tree-view{min-width:100%;--tree-item-nested-width:2em}:host fluent-tree-item{width:100%;--tree-item-nested-width:2em}:host fluent-tree-item:focus-visible{outline:0}:host fluent-tree-item::part(expand-collapse-button){background:0 0}:host fluent-tree-item::part(content-region),:host fluent-tree-item::part(positioning-region){color:var(--channel-picker-dropdown-item-text-color,currentColor);background:var(--channel-picker-dropdown-background-color,transparent);border:calc(var(--stroke-width) * 2px) solid transparent;height:auto}:host fluent-tree-item::part(content-region):hover,:host fluent-tree-item::part(positioning-region):hover{background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item::part(content-region):hover::part(expand-collapse-button),:host fluent-tree-item::part(positioning-region):hover::part(expand-collapse-button){background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item fluent-tree-item::part(content-region){height:auto}:host fluent-breadcrumb-item{color:var(--channel-picker-dropdown-item-text-color-selected,var(--neutral-foreground-rest))}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--channel-picker-arrow-fill,var(--neutral-foreground-rest))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{transform:scaleX(-1);filter:fliph;filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:#000!important}}
`];l();c();d();ue();$c();hn();var qP=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},GP=(r,e)=>qP(void 0,void 0,void 0,function*(){let t=yield r.api("/me/joinedTeams").select(["displayName","id","isArchived"]).middlewareOptions(ye(e)).get();return t?.value}),jP=(r,e)=>qP(void 0,void 0,void 0,function*(){let t,o={};if(mi()){t=Q.getCache(N.photos,N.photos.stores.teams);for(let n of e)try{let s=yield t.getValue(n);s&&Tl()>Date.now()-s.timeCached&&(o[n]=s)}catch{}if(Object.keys(o).length)return o}let i=["team.readbasic.all"];o={};for(let n of e)try{let s=yield Ss(r,`/teams/${n}`,i);mi()&&s&&(yield t.putValue(n,s)),o[n]=s}catch{}return o});l();c();d();var KP={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",photoFor:"Teams photo for",teamsChannels:"Teams and channels results",closeButtonAriaLabel:"remove the selected channel"};Rl();Xr();yr();ue();pn();var QP=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},YP=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},WP=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},ZP=()=>{vt(rw,iw,Cn,sC,lC,xn),Hn(),Pe("teams-channel-picker",jh)},jh=class r extends st{static get styles(){return VP}get strings(){return KP}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return["team.readbasic.all","channel.readbasic.all"]}set items(e){this._items!==e&&(this._items=e,this._treeViewState=e?this.generateTreeViewState(e):[],this.resetFocusState())}get items(){return this._items}get _inputWrapper(){return this.renderRoot.querySelector("fluent-text-field")}get _input(){return this._inputWrapper.shadowRoot.querySelector("input")}constructor(){super(),this.teamsPhotos={},this._inputValue="",this._treeViewState=[],this._focusList=[],this.handleInputClick=e=>{e.stopPropagation(),this.gainedFocus()},this.handleInputKeydown=e=>{let t=e.key;["ArrowDown","Enter"].includes(t)?this._isDropdownVisible?this.renderRoot.querySelector("fluent-tree-item").focus():this.gainedFocus():t==="Escape"&&this.lostFocus()},this.onClickCloseButton=()=>{this.removeSelectedChannel(null)},this.onKeydownCloseButton=e=>{e.key==="Enter"&&this.removeSelectedChannel(null)},this.onKeydownTreeView=e=>{e.key==="Escape"&&this.lostFocus()},this.handleTeamTreeItemClick=e=>{e.preventDefault(),e.stopImmediatePropagation();let t=e.target;t&&(t.getAttribute("expanded")?t.removeAttribute("expanded"):t.setAttribute("expanded","true"),t.removeAttribute("selected"),t.getAttribute("id")&&t.setAttribute("selected","true"))},this.handleInputChanged=e=>{let t=e.target;if(this._inputValue!==t?.value)this._inputValue=t?.value;else return;this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=Ac(()=>{this.filterList()},400)),this.debouncedSearch()},this.handleWindowClick=e=>{e.target!==this&&this.lostFocus()},this.gainedFocus=()=>{let e=this._input;e&&e.focus(),this._isDropdownVisible=!0,this.toggleChevron(),this.resetFocusState(),this.requestUpdate()},this.lostFocus=()=>{this._input.value=this._inputValue="",this._input.textContent="";let e=this._inputWrapper;e.value="",this._isDropdownVisible=!1,this.filterList(),this.toggleChevron(),this.requestUpdate(),this._selectedItemState!==void 0&&this.showCloseIcon()},this.handleFocus=()=>{this.lostFocus(),this.gainedFocus()},this.handleUpChevronClick=e=>{e.stopPropagation(),this.lostFocus()},this.addEventListener("focus",()=>this.loadTeamsIfNotLoaded()),this.addEventListener("mouseover",()=>this.loadTeamsIfNotLoaded()),this.addEventListener("blur",()=>this.lostFocus()),this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick);let e=this.renderRoot.ownerDocument;e&&e.documentElement.setAttribute("dir",this.direction)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),super.disconnectedCallback()}selectChannelById(e){return WP(this,void 0,void 0,function*(){let t=K.globalProvider;if(t&&t.state===ce.SignedIn){this.items||(yield this.requestStateUpdate());for(let o of this._treeViewState)for(let i of o.channels)if(i.item.id===e)return o.isExpanded=!0,this.selectChannel(i),this.markSelectedChannelInDropdown(e),!0}return!1})}markSelectedChannelInDropdown(e){let t=this.renderRoot.querySelector(`[id='${e}']`);t&&(t.setAttribute("selected","true"),t.parentElement&&t.parentElement.setAttribute("expanded","true"))}render(){var e;let t={dropdown:!0,visible:this._isDropdownVisible};return this.renderTemplate("default",{teams:(e=this.items)!==null&&e!==void 0?e:[]})||k`
        <div class="container" @blur=${this.lostFocus}>
          <fluent-text-field
            autocomplete="off"
            appearance="outline"
            id="teams-channel-picker-input"
            role="combobox"
            placeholder="${this._selectedItemState?"":this.strings.inputPlaceholderText} "
            aria-label=${this.strings.inputPlaceholderText}
            aria-expanded="${this._isDropdownVisible}"
            label="teams-channel-picker-input"
            @focus=${this.handleFocus}
            @keyup=${this.handleInputChanged}
            @click=${this.handleInputClick}
            @keydown=${this.handleInputKeydown}
          >
            <div tabindex="0" slot="start" style="width: max-content;">${this.renderSelected()}</div>
            <div tabindex="0" slot="end">${this.renderChevrons()}${this.renderCloseButton()}</div>
          </fluent-text-field>
          <fluent-card
            class=${Ve(t)}
          >
            ${this.renderDropdown()}
          </fluent-card>
        </div>`}renderSelected(){var e,t,o,i,n,s;if(!this._selectedItemState)return this.renderSearchIcon();let a;if(this._selectedItemState.parent.channels){let p=(e=this.teamsPhotos[this._selectedItemState.parent.item.id])===null||e===void 0?void 0:e.photo;a=k`<img
        class="team-photo"
        alt="${this._selectedItemState.parent.item.displayName}"
        role="img"
        src=${p} />`}let u=(i=(o=(t=this._selectedItemState)===null||t===void 0?void 0:t.parent)===null||o===void 0?void 0:o.item)===null||i===void 0?void 0:i.displayName.trim(),h=(s=(n=this._selectedItemState)===null||n===void 0?void 0:n.item)===null||s===void 0?void 0:s.displayName.trim();return k`
      <fluent-breadcrumb title=${this._selectedItemState.item.displayName}>
        <fluent-breadcrumb-item>
          <span slot="start">${a}</span>
          <span class="team-parent-name">${u}</span>
          <span slot="separator" class="arrow">${Y(P.TeamSeparator,"#000000")}</span>
        </fluent-breadcrumb-item>
        <fluent-breadcrumb-item>${h}</fluent-breadcrumb-item>
      </fluent-breadcrumb>`}clearState(){this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}renderSearchIcon(){return k`
      <div class="search-icon">
        ${Y(P.Search,"#252424")}
      </div>
    `}renderCloseButton(){return k`
      <fluent-button
        appearance="stealth"
        class="close-icon"
        style="display:none"
        aria-label=${this.strings.closeButtonAriaLabel}
        @click=${this.onClickCloseButton}
        @keydown=${this.onKeydownCloseButton}>
        <svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L4 3.293L7.14645 0.146447C7.34171 -0.0488154 7.65829 -0.0488154 7.85355 0.146447C8.04882 0.341709 8.04882 0.658291 7.85355 0.853553L4.707 4L7.85355 7.14645C8.02712 7.32001 8.0464 7.58944 7.91141 7.78431L7.85355 7.85355C7.67999 8.02712 7.41056 8.0464 7.21569 7.91141L7.14645 7.85355L4 4.707L0.853553 7.85355C0.658291 8.04882 0.341709 8.04882 0.146447 7.85355C-0.0488154 7.65829 -0.0488154 7.34171 0.146447 7.14645L3.293 4L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z" fill="#212121"/>
        </svg>
      </fluent-button>
    `}showCloseIcon(){let e=this.renderRoot.querySelector(".down-chevron"),t=this.renderRoot.querySelector(".up-chevron"),o=this.renderRoot.querySelector(".close-icon");e&&(e.style.display="none"),t&&(t.style.display="none"),o&&(o.style.display=null)}renderDownChevron(){return k`
      <fluent-button appearance="stealth" class="down-chevron" @click=${this.gainedFocus}>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.21967 4.46967C2.51256 4.17678 2.98744 4.17678 3.28033 4.46967L6 7.18934L8.71967 4.46967C9.01256 4.17678 9.48744 4.17678 9.78033 4.46967C10.0732 4.76256 10.0732 5.23744 9.78033 5.53033L6.53033 8.78033C6.23744 9.07322 5.76256 9.07322 5.46967 8.78033L2.21967 5.53033C1.92678 5.23744 1.92678 4.76256 2.21967 4.46967Z" fill="#212121" />
        </svg>
      </fluent-button>`}renderUpChevron(){return k`
      <fluent-button appearance="stealth" style="display:none" class="up-chevron" @click=${this.handleUpChevronClick}>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.21967 7.53033C2.51256 7.82322 2.98744 7.82322 3.28033 7.53033L6 4.81066L8.71967 7.53033C9.01256 7.82322 9.48744 7.82322 9.78033 7.53033C10.0732 7.23744 10.0732 6.76256 9.78033 6.46967L6.53033 3.21967C6.23744 2.92678 5.76256 2.92678 5.46967 3.21967L2.21967 6.46967C1.92678 6.76256 1.92678 7.23744 2.21967 7.53033Z" fill="#212121" />
        </svg>
      </fluent-button>`}renderChevrons(){return k`${this.renderUpChevron()}${this.renderDownChevron()}`}renderDropdown(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&this._treeViewState.length===0&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):k``}renderDropdownList(e){if(e&&e.length>0){let t=null;return k`
        <fluent-tree-view
          class="tree-view"
          dir=${this.direction}
          aria-live="polite"
          aria-relevant="all"
          aria-atomic="true"
          aria-label=${this.strings.teamsChannels}
          aria-orientation="horizontal"
          @keydown=${this.onKeydownTreeView}>
          ${uo(e,o=>o?.item,o=>{var i;return o.channels&&(t=k`<img
                  class="team-photo"
                  alt="${this.strings.photoFor} ${o.item.displayName}"
                  src=${(i=this.teamsPhotos[o.item.id])===null||i===void 0?void 0:i.photo} />`),k`
                <fluent-tree-item
                  ?expanded=${o?.isExpanded}
                  @click=${this.handleTeamTreeItemClick}>
                    <span slot="start">${t}</span>${o.item.displayName}
                    ${uo(o?.channels,n=>n.item,n=>this.renderItem(n))}
                </fluent-tree-item>`})}
        </fluent-tree-view>`}return null}renderItem(e){var t;return k`
      <fluent-tree-item
        id=${(t=e?.item)===null||t===void 0?void 0:t.id}
        @keydown=${o=>this.onUserKeyDown(o,e)}
        @click=${()=>this.handleItemClick(e)}>
          ${e?.item.displayName}
      </fluent-tree-item>`}renderError(){return this.renderTemplate("error",null,"error")||k`
        <div class="message-parent">
          <div
            label="search-error-text"
            aria-live="polite"
            aria-relevant="all"
            aria-atomic="true"
            class="search-error-text"
          >
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderLoading(){return this.renderTemplate("loading",null,"loading")||Ee`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}loadState(){var e,t;return WP(this,void 0,void 0,function*(){let o=K.globalProvider,i;if(o&&o.state===ce.SignedIn){let n=o.graph.forComponent(this);i=yield GP(n,r.requiredScopes),i=i.filter(p=>!p.isArchived);let s=Zs.fromGraph(n),a=i.map(p=>p.id);this.teamsPhotos=yield jP(s,a);let u=n.createBatch();for(let p of i)u.get(p.id,`teams/${p.id}/channels`,r.requiredScopes);let h=yield u.executeAll();this._items=[];for(let p of i){let f=h.get(p.id);!((t=(e=f?.content)===null||e===void 0?void 0:e.value)===null||t===void 0)&&t.length&&this.items.push({item:p,channels:f.content.value.map(b=>({item:b}))})}}this.filterList(),this.resetFocusState()})}clearSelectedItem(){this.removeSelectedChannel()}removeSelectedChannel(e){this.selectChannel(e);let t=this.renderRoot.querySelectorAll("fluent-tree-item");t&&t.forEach(o=>{o.removeAttribute("expanded"),o.removeAttribute("selected")})}handleItemClick(e){e.channels?e.isExpanded=!e.isExpanded:(this.selectChannel(e),this.lostFocus())}onUserKeyDown(e,t){switch(e.code){case"Enter":this.selectChannel(t),this.resetFocusState(),this.lostFocus(),e.preventDefault();break;case"Backspace":this._inputValue.length===0&&this._selectedItemState&&(this.selectChannel(null),this.resetFocusState(),e.preventDefault());break}}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this.resetFocusState())}generateTreeViewState(e,t="",o=null){let i=[];if(t=t.toLowerCase(),e)for(let n of e){let s;if(t.length===0||n.item.displayName.toLowerCase().includes(t))s={item:n.item,parent:o},n.channels&&(s.channels=this.generateTreeViewState(n.channels,"",s),s.isExpanded=t.length>0);else if(n.channels){let a={item:n.item,parent:o},u=this.generateTreeViewState(n.channels,t,a);u.length>0&&(s=a,s.channels=u,s.isExpanded=!0)}s&&i.push(s)}return i}generateFocusList(e){if(!e||e.length===0)return[];let t=[];for(let o of e)t.push(o),o.channels&&o.isExpanded&&(t=[...t,...this.generateFocusList(o.channels)]);return t}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}loadTeamsIfNotLoaded(){!this.items&&!this.isLoadingState&&this.requestStateUpdate()}selectChannel(e){e&&this._selectedItemState!==e?this._input.setAttribute("disabled","true"):this._input.removeAttribute("disabled"),this._selectedItemState=e,this.lostFocus(),this.fireCustomEvent("selectionChanged",this.selectedItem)}hideCloseIcon(){let e=this.renderRoot.querySelector(".close-icon");e&&(e.style.display="none")}toggleChevron(){let e=this.renderRoot.querySelector(".down-chevron"),t=this.renderRoot.querySelector(".up-chevron");this._isDropdownVisible?(e&&(e.style.display="none"),t&&(t.style.display=null)):(e&&(e.style.display=null,this.hideCloseIcon()),t&&(t.style.display="none")),this.hideCloseIcon()}};QP([le(),YP("design:type",Object)],jh.prototype,"_selectedItemState",void 0);QP([le(),YP("design:type",Boolean)],jh.prototype,"_isDropdownVisible",void 0);l();c();d();Te();At();fi();Rl();ue();ue();Vr();Yi();l();c();d();Te();At();ue();l();c();d();var JP={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};Xr();yr();var Kh=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Wh=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Ks=class extends st{get strings(){return JP}constructor(){super(),this.handleTaskClick=e=>{this.fireCustomEvent("taskClick",{task:e})},this.onResize=()=>{this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())},vt(xn,Dr,aw),this.clearState(),this._previousMediaQuery=this.mediaQuery}attributeChangedCallback(e,t,o){switch(super.attributeChangedCallback(e,t,o),e){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate();break}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){let e=K.globalProvider;if(!e||e.state!==ce.SignedIn)return k``;if(this.isLoadingState)return this.renderLoadingTask();let t=this.renderPicker(),o=this.renderNewTask(),i=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return k`
      ${t}
      ${o}
      <div class="tasks" dir=${this.direction}>
        ${i}
      </div>
    `}renderLoadingTask(){return k`
      <div class="task loading-task">
        <div class="task-details">
          <div class="title"></div>
          <div class="task-due"></div>
          <div class="task-delete"></div>
        </div>
      </div>
    `}clearState(){this.requestUpdate()}dateToInputValue(e){return e?new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().split("T")[0]:null}};Kh([E({attribute:"read-only",type:Boolean}),Wh("design:type",Boolean)],Ks.prototype,"readOnly",void 0);Kh([E({attribute:"hide-header",type:Boolean}),Wh("design:type",Boolean)],Ks.prototype,"hideHeader",void 0);Kh([E({attribute:"hide-options",type:Boolean}),Wh("design:type",Boolean)],Ks.prototype,"hideOptions",void 0);Kh([E({attribute:"target-id",type:String}),Wh("design:type",String)],Ks.prototype,"targetId",void 0);Kh([E({attribute:"initial-id",type:String}),Wh("design:type",String)],Ks.prototype,"initialId",void 0);l();c();d();ue();var Rd=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},TC=["Tasks.ReadWrite"],EC=["Tasks.Read","Tasks.ReadWrite"],lv=(r,e)=>Rd(void 0,void 0,void 0,function*(){let t=yield r.api(`/me/todo/lists/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(ye(EC)).get();return t?.value});var XP=r=>Rd(void 0,void 0,void 0,function*(){let e=yield r.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(ye(EC)).get();return e?.value}),IC=(r,e)=>Rd(void 0,void 0,void 0,function*(){return yield r.api(`/me/todo/lists/${e}`).header("Cache-Control","no-store").middlewareOptions(ye(EC)).get()}),e6=(r,e,t)=>Rd(void 0,void 0,void 0,function*(){return yield r.api(`/me/todo/lists/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(ye(TC)).post(t)});var t6=(r,e,t)=>Rd(void 0,void 0,void 0,function*(){yield r.api(`/me/todo/lists/${e}/tasks/${t}`).header("Cache-Control","no-store").middlewareOptions(ye(TC)).delete()});var AC=(r,e,t,o)=>Rd(void 0,void 0,void 0,function*(){return yield r.api(`/me/todo/lists/${e}/tasks/${t}`).header("Cache-Control","no-store").middlewareOptions(ye(TC)).patch(o)});l();c();d();Te();var r6=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{display:flex;flex-direction:column;color:var(--color,var(--neutral-foreground-rest))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;appearance:none}:host .task-icon{font-family:FabricMDL2Icons;user-select:none}:host .task-icon.divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .header{margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .header select{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;appearance:none;cursor:pointer}:host .header select::-ms-expand{display:none}:host .header .plan-title{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .header .add-bar{display:flex}:host .header .add-bar .add-bar-item{flex:1 1 auto}:host .header .new-task-due{display:flex}:host .header .new-task-due input{flex:1 1 auto;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .header .title-cont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .header .new-task-button{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;cursor:pointer}:host .header .new-task-button span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .header .new-task-button .task-icon{margin-right:8px}:host .header .new-task-button.hidden{visibility:hidden}:host .header .new-task-button:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .header .new-task-button:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .task{position:relative;margin:var(--task-margin,0 0 0 0);padding:var(--task-padding,0 0 0 0);background-color:var(--task-background-color,var(--neutral-layer-floating));border:var(--task-border,var(--neutral-stroke-input-active));border-radius:8px}:host .task .task-content{display:flex}:host .task .task-content .divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-content .task-details-container{flex:1;display:grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .task .task-content .task-details-container .task-detail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .task .task-content .task-details-container .task-title{color:var(--task-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;grid-row:1;grid-column:1/3;grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .task .task-content .task-details-container .task-group{min-height:24px;grid-row:2;grid-column:1}:host .task .task-content .task-details-container .task-bucket{min-height:24px;grid-row:2;grid-column:2}:host .task .task-content .task-details-container .task-due{justify-content:flex-end;align-items:flex-start;grid-row:4;grid-column:1/3;grid-column:1;-ms-grid-column-span:2}:host .task .task-content .task-details-container.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .task .task-content .task-details-container.tablet.no-plan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .task .task-content .task-details-container.tablet .task-detail{margin:4px 24px 6px 0}:host .task .task-content .task-details-container.tablet .task-title{grid-row:1;grid-column:1/5;grid-column:1;-ms-grid-column-span:4}:host .task .task-content .task-details-container.tablet .task-group{grid-row:2;grid-column:1}:host .task .task-content .task-details-container.tablet .task-bucket{grid-row:2;grid-column:2}:host .task .task-content .task-details-container.tablet .task-assignee{grid-row:2;grid-column:3}:host .task .task-content .task-details-container.tablet .task-due{justify-content:flex-start;align-items:center;grid-row:2;grid-column:4}:host .task .task-content .task-details-container.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .task .task-content .task-details-container.desktop.no-plan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .task .task-content .task-details-container.desktop .task-detail{margin:0 24px 0 0}:host .task .task-content .task-details-container.desktop .task-title{padding:0;grid-row:1;grid-column:1}:host .task .task-content .task-details-container.desktop .task-group{min-height:61px;grid-row:1;grid-column:2}:host .task .task-content .task-details-container.desktop .task-bucket{grid-row:1;grid-column:3}:host .task .task-content .task-details-container.desktop .task-assignee{grid-row:1;grid-column:4}:host .task .task-content .task-details-container.desktop .task-due{justify-content:flex-start;align-items:center;grid-row:1;grid-column:5}:host .task .task-content .task-details-container svg{vertical-align:middle;margin-right:4px}:host .task .task-content .task-details-container svg path{fill:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container select,:host .task .task-content .task-details-container span{vertical-align:middle;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .task-icon{color:#797775;margin-right:8px}:host .task .task-content .task-details-container .people{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:16px}:host .task .task-content .task-details-container .person{display:inline-block}:host .task .task-content .task-details-container .picker{background-color:var(--task-background-color,var(--neutral-layer-floating));background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .task .task-content .task-details-container input,:host .task .task-content .task-details-container select{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:.9em;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-check-container{font-family:FabricMDL2Icons;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none}:host .task .task-check-container.complete .task-check{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .task .task-check-container.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-check-container .task-check{font-family:FabricMDL2Icons;font-size:12px;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-color,var(--neutral-foreground-rest));display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none}:host .task .task-check-container .task-check.loading .task-check-content{animation:rotate-icon 2s infinite linear}:host .task .task-options{cursor:pointer;user-select:none;margin:16px 8px 0 0}:host .task.read-only .task-check-container{cursor:default}:host .task.complete{background:var(--task-complete-background,var(--neutral-layer-1));border:var(--task-complete-border,2px dotted inherit)}:host .task.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task.new-task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .task.new-task .self-assign{display:none}:host .task.new-task .assign-to{border:0;background:0 0}:host .task.new-task .fake-check-box{width:15px;height:15px;cursor:pointer;margin:0 5px}:host .task.new-task .fake-check-box::after{font-family:FabricMDL2Icons;content:"uE739"}:host .task.new-task .fake-check-box~:checked{font-family:FabricMDL2Icons;content:"uE73A"}:host .task.new-task .task-content{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .task.new-task .task-content .task-details-container{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .task.new-task .task-content .task-details-container .task-title{display:flex;height:32px;padding:2px}:host .task.new-task .task-content .task-details-container .task-title input{flex:1;margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task .task-content .task-details-container .task-title input:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-title input:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-title input:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-content .task-details-container .task-details{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .task.new-task .task-content .task-details-container .task-details .new-task-group{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-bucket{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-due{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-assignee{margin:8px 16px;min-width:80px}:host .task.new-task .task-content .task-details-container .task-details .task-people label{display:flex;align-content:center;align-items:center}:host .task.new-task .task-content .task-details-container .task-details input,:host .task.new-task .task-content .task-details-container .task-details select{font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .task.new-task .task-content .task-details-container .task-details input:hover,:host .task.new-task .task-content .task-details-container .task-details select:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-details input:active,:host .task.new-task .task-content .task-details-container .task-details select:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-details input:focus,:host .task.new-task .task-content .task-details-container .task-details select:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-add-button-container{margin-right:28px}:host .task.new-task .task-add-button-container .task-add,:host .task.new-task .task-add-button-container .task-cancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-size:14px;line-height:20px}:host .task.new-task .task-add-button-container .task-add{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .task.new-task .task-add-button-container .task-cancel{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest))}:host .task.new-task .task-add-button-container.disabled .task-add{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}@keyframes rotate-icon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translatex:translateX(60px)}[dir=rtl] .task-details{margin-right:14px!important}[dir=rtl] .task-icon{margin-left:8px}[dir=rtl] .task-detail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px;width:100%}:host .task,:host.loading-task{margin-block:1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active));width:100%;display:flex;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task,:host.loading-task.new-task{margin:14px 0 1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active))}:host .task.complete,:host.loading-task.complete{border:1px solid var(--task-border-completed,var(--neutral-stroke-input-active));background:var(--task-complete-background,var(--neutral-layer-1))}:host .task.complete .task-details .task-due,:host .task.complete .task-details .title,:host.loading-task.complete .task-details .task-due,:host.loading-task.complete .task-details .title{text-decoration:line-through}:host .task.read-only,:host.loading-task.read-only{opacity:1}:host .task:hover,:host.loading-task:hover{background-color:var(--task-background-color-hover,var(--neutral-fill-hover));border-radius:8px}:host .task .task-details,:host.loading-task .task-details{box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:2px;line-height:24px;border-radius:4px;width:100%}:host .task .task-details .task>div,:host.loading-task .task-details .task>div{display:flex;align-items:center;width:200px}:host .task .task-details .task-delete,:host.loading-task .task-details .task-delete{display:flex}:host .task .task-details .container,:host.loading-task .task-details .container{display:flex;width:100%}:host .task .task-details .task-due,:host.loading-task .task-details .task-due{min-width:120px;margin-inline-end:12px;height:32px;text-decoration:inherit;display:flex}:host fluent-text-field::part(end),:host fluent-text-field::part(start){margin-inline:unset}:host fluent-text-field::part(control){padding:0;cursor:pointer}:host fluent-text-field::part(root){background:0 0}:host fluent-text-field.new-task{width:100%;height:34px}:host fluent-text-field.new-task div.start .add-icon{display:flex;margin-inline:10px}:host fluent-text-field.new-task div:nth-child(2){display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar{display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar .date{margin-inline-start:10px;color:var(--task-color,var(--neutral-foreground-rest));width:auto;cursor:pointer}:host fluent-text-field.new-task div:nth-child(2) .calendar input{flex:1;border:none;border-bottom:1px solid var(--task-color,var(--neutral-foreground-rest));outline:0;border-radius:0}:host fluent-text-field.new-task div:nth-child(2) .calendar input:hover{border-bottom:1px solid var(--task-date-input-hover-color,var(--neutral-layer-1))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:active,:host fluent-text-field.new-task div:nth-child(2) .calendar input:focus{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-text-field.title{flex-grow:1;display:inline}:host fluent-text-field.date{color:var(--task-detail-color,var(--neutral-foreground-hint))}:host fluent-text-field::after{border-bottom:none}:host fluent-text-field.dark::part(control){color-scheme:dark}:host fluent-button.task-add-icon.neutral,:host fluent-button.task-cancel-icon.neutral,:host fluent-button.task-delete.neutral{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-button.task-add-icon.neutral::part(control),:host fluent-button.task-cancel-icon.neutral::part(control),:host fluent-button.task-delete.neutral::part(control){border:none;background:inherit}:host fluent-button.task-add-icon.neutral::part(control) svg,:host fluent-button.task-cancel-icon.neutral::part(control) svg,:host fluent-button.task-delete.neutral::part(control) svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-checkbox.complete div>svg .filled{display:block}:host fluent-checkbox.complete div>svg .regular{display:none}:host fluent-checkbox.complete div>svg path{fill:var(--task-radio-background-color,var(--accent-fill-rest))}:host fluent-checkbox div>svg .filled{display:none}:host fluent-checkbox div>svg .regular{display:block}:host fluent-checkbox div>svg path{fill:var(--task-background-color,var(--neutral-layer-floating))}:host fluent-checkbox::part(control){margin-inline-start:10px;background:0 0;border-radius:50%}:host fluent-checkbox::part(label){margin-inline-end:unset;width:100%}
`];l();c();d();var o6={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",newTaskLabel:"New Task Input",editTaskLabel:"Edit Task Input",addTaskButtonSubtitle:"Add",deleteTaskOption:"Delete",editTaskOption:"Edit",dueDate:"Due date",newTaskDateInputLabel:"New Task Date Input",changeTaskDateInputLabel:"Change Task Date Input",newTaskNameInputLabel:"New Task Name Input",cancelAddingTask:"Cancel adding a new task"};Xr();yr();Lc();ue();var xi=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},ki=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},as=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},i6=()=>{vt(ic,Lw,Dr),rv(),Pe("todo",Ro)},Ro=class extends Ks{static get styles(){return r6}get strings(){return o6}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}constructor(){super(),this._isChangedDueDate=!1,this._isDarkMode=!1,this.onThemeChanged=()=>{this._isDarkMode=av(this)},this.renderNewTask=()=>{let e=this._newTaskName?k`
        <fluent-checkbox
          class="task-add-icon"
          @click="${this.addTask}">
        </fluent-checkbox>
      `:k`
        <span class="add-icon">${Y(P.Add)}</span>
      `,t=k`
      <fluent-button
        aria-label=${this.strings.cancelAddingTask}
        class="task-cancel-icon" 
        @click="${this.clearNewTaskData}"
      >
        ${Y(P.Cancel)}
      </fluent-button>
    `,o={dark:this._isDarkMode,date:!0},i=k`
      <fluent-text-field
        autocomplete="off"
        type="date"
        id="new-taskDate-input"
        class="${Ve(o)}"
        aria-label="${this.strings.newTaskDateInputLabel}"
        .value="${this.dateToInputValue(this._newTaskDueDate)}"
        @change="${this.handleDateChange}"
      >
      </fluent-text-field>
    `,n=this.readOnly?rt:k`
      <fluent-text-field
        autocomplete="off"
        appearance="outline"
        class="new-task"
        id="new-task-name-input"
        aria-label="${this.strings.newTaskLabel}"
        .value=${this._newTaskName}
        placeholder="${this.strings.newTaskPlaceholder}"
        @keydown="${this.handleKeyDown}"
        @input="${this.handleInput}"
      >
        <div slot="start" class="start">${e}</div>
        ${this._newTaskName?k`
              <div slot="end" class="end">
                <span class="calendar">${i}</span>
                ${t}
              </div> `:k``}
      </fluent-text-field>
    `;return k`
      ${this.currentList?k`
            <div dir=${this.direction} class="task new-task incomplete">
              ${n}
            </div>
        `:k``}  
     `},this.handleSelectionChanged=e=>{this.currentList=e.detail,this.loadTasks(this.currentList)},this.renderTaskDetails=e=>{let t={task:e,list:this.currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",t,e.id);let o=null,i=k`
      <fluent-button class="task-delete"
        @click="${()=>this.removeTask(e.id)}"
        aria-label="${this.strings.deleteTaskOption}">
        ${Y(P.Delete)}
      </fluent-button>`;if(this.hasTemplate("task-details"))o=this.renderTemplate("task-details",t,`task-details-${e.id}`);else{let n={dark:this._isDarkMode,date:!0,"task-due":!0},s=k`
        <fluent-text-field
          autocomplete="off"
          type="date"
          id="${e.id}-taskDate-input"
          class="${Ve(n)}"
          aria-label="${this.strings.changeTaskDateInputLabel}"
          .value="${e.dueDateTime?this.dateToInputValue(new Date(e.dueDateTime.dateTime)):this._taskBeingUpdated===e?this.dateToInputValue(this._newTaskDueDate):rt}"
          @change="${this.handleDateUpdate}"
          @focus="${u=>this.updatingTask(u,e)}"
          @blur="${this.handleBlur}"
        >
        </fluent-text-field>
      `,a=k`
          <fluent-text-field 
            autocomplete="off"
            appearance="outline"
            class="title"
            id=${e.id}
            .value="${e.title?e.title:this._taskBeingUpdated===e?this._changedTaskName:""}"
            aria-label="${this.strings.editTaskLabel}"
            @keydown="${u=>this.handleChange(u,e)}"
            @input="${u=>this.handleChange(u,e)}"
            @focus="${u=>this.updatingTask(u,e)}"
          >
          </fluent-text-field>
          ${e.dueDateTime||this._taskBeingUpdated===e?k`${s}`:rt}
          ${i}
      `;o=k`
      <div class="task-details">
        ${a}
      </div>
      `}return k`${o}`},this.renderTask=e=>{let t=e.status==="completed",o=Ve({complete:t,"read-only":this.readOnly,task:!0}),i=Ve({complete:t}),n=t?k`${Y(P.CheckMark)}`:k`${Y(P.Radio)}`;return k`
      <div class=${o} @blur="${this.handleBlur}">
        <fluent-checkbox 
          id=${e.id} 
          class=${i}
          ?checked=${t}
          @click="${()=>this.handleTaskCheckClick(e)}"
          @keydown="${s=>this.handleTaskCheckKeydown(s,e)}"
        >
          <div slot="checked-indicator">
            ${n}
          </div>
        </fluent-checkbox>
        ${this.renderTaskDetails(e)}
      </div>
    `},this.loadState=()=>as(this,void 0,void 0,function*(){let e=K.globalProvider;if(!(!e||e.state!==ce.SignedIn)){if(this._isLoadingTasks=!0,!this._graph){let t=e.graph.forComponent(this);this._graph=t}if(!this.currentList&&!this.initialId){let t=yield XP(this._graph),o=t?.find(i=>i.wellknownListName==="defaultList");o&&(yield this.loadTasks(o))}this.targetId?(this.currentList=yield IC(this._graph,this.targetId),this._tasks=yield lv(this._graph,this.targetId)):this.initialId&&(this.currentList=yield IC(this._graph,this.initialId),this._tasks=yield lv(this._graph,this.initialId)),this._isLoadingTasks=!1}}),this.addTask=()=>as(this,void 0,void 0,function*(){if(!(this._isNewTaskBeingAdded||!this._newTaskName)){this._isNewTaskBeingAdded=!0;try{yield this.createNewTask()}finally{this.clearNewTaskData(),this._isNewTaskBeingAdded=!1}}}),this.updateTask=e=>as(this,void 0,void 0,function*(){try{if(!this._changedTaskName&&!this._isChangedDueDate)return;yield this.updateTaskItem(e)}finally{this.clearNewTaskData()}}),this.clearNewTaskData=()=>{this._newTaskDueDate=null,this._newTaskName="",this._changedTaskName="",this._isChangedDueDate=!1},this.clearState=()=>{super.clearState(),this.currentList=null,this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1,this._taskBeingUpdated=null},this.loadTasks=e=>as(this,void 0,void 0,function*(){this._isLoadingTasks=!0,this.currentList=e,this._tasks=yield lv(this._graph,e.id),this._isLoadingTasks=!1}),this.updateTaskStatus=(e,t)=>as(this,void 0,void 0,function*(){this._loadingTasks=[...this._loadingTasks,e.id],e.status=t;let o=this.currentList.id;e=yield AC(this._graph,o,e.id,e);let i=this._tasks.findIndex(n=>n.id===e.id);this._tasks[i]=e,this._loadingTasks=this._loadingTasks.filter(n=>n!==e.id)}),this.removeTask=e=>as(this,void 0,void 0,function*(){this._tasks=this._tasks.filter(o=>o.id!==e),this.requestUpdate();let t=this.currentList.id;yield t6(this._graph,t,e),this._tasks=this._tasks.filter(o=>o.id!==e)}),this.handleInput=e=>{e.target.id==="new-task-name-input"&&(this._newTaskName=e.target.value)},this.handleChange=(e,t)=>as(this,void 0,void 0,function*(){var o;e.target.id===t.id&&(e.key==="Enter"&&(yield this.updateTask(t),(o=e.target)===null||o===void 0||o.blur()),this._changedTaskName=e.target.value)}),this.handleKeyDown=e=>as(this,void 0,void 0,function*(){e.key==="Enter"&&e.target.id==="new-task-name-input"&&(yield this.addTask())}),this.updatingTask=(e,t)=>{e.target.id===t.id&&(this._taskBeingUpdated=t),e.target.id===`${t.id}-taskDate-input`&&(this._updatingTaskDate=!0,this._taskBeingUpdated=t)},this.handleBlur=()=>{let e=this._taskBeingUpdated,t=this.renderRoot.querySelectorAll("fluent-text-field");for(let o of t)e&&(o.id===e.id||o.id===`${e.id}-taskDate-input`)&&(this.updateTask(e),o?.blur(),this._taskBeingUpdated=null,this._updatingTaskDate=!1)},this.handleDateChange=e=>{let t=e.target.value;t?this._newTaskDueDate=new Date(t+"T17:00"):this._newTaskDueDate=null},this.handleDateUpdate=e=>{let t=this._taskBeingUpdated;if(t){let o=e.target.value;o?this._newTaskDueDate=new Date(o+"T17:00"):this._newTaskDueDate=null,t.dueDateTime&&this._newTaskDueDate?this._isChangedDueDate=new Date(t.dueDateTime.dateTime)!==this._newTaskDueDate:t.dueDateTime||this._newTaskDueDate?this._isChangedDueDate=!0:this._isChangedDueDate=!1}},this._graph=null,this._newTaskDueDate=null,this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1,this.addEventListener("selectionChanged",this.handleSelectionChanged),this.addEventListener("blur",this.handleBlur)}connectedCallback(){super.connectedCallback(),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}renderTasks(){if(this._isLoadingTasks)return this.renderLoadingTask();let e=this._tasks;e&&this.taskFilter&&(e=e.filter(n=>this.taskFilter(n)));let t=e.filter(n=>n.status==="completed"),o=uo(e.filter(n=>n.status!=="completed"),n=>n.id,n=>this.renderTask(n)),i=uo(t.sort((n,s)=>n.lastModifiedDateTime<s.lastModifiedDateTime?-1:1).filter(n=>n.status==="completed"),n=>n.id,n=>this.renderTask(n));return k`
      ${o}
      ${i}
    `}renderPicker(){var e,t;return this.targetId?k`<p>${(e=this.currentList)===null||e===void 0?void 0:e.displayName}</p>`:Ee`
        <mgt-picker
          resource="me/todo/lists"
          scopes="tasks.read, tasks.readwrite"
          key-name="displayName"
          selected-value="${Qo((t=this.currentList)===null||t===void 0?void 0:t.displayName)}"
          placeholder="Select a task list">
        </mgt-picker>`}createNewTask(){return as(this,void 0,void 0,function*(){let e=this.currentList.id,t={title:this._newTaskName};this._newTaskDueDate&&(t.dueDateTime={dateTime:new Date(this._newTaskDueDate).toLocaleDateString(),timeZone:"UTC"});let o=yield e6(this._graph,e,t);this._tasks.unshift(o)})}updateTaskItem(e){return as(this,void 0,void 0,function*(){let t=this.currentList.id,o={};if(this._changedTaskName&&this._changedTaskName!==e.title&&(o={title:this._changedTaskName}),this._updatingTaskDate){if(!this._isChangedDueDate)return;this._newTaskDueDate?o.dueDateTime={dateTime:new Date(this._newTaskDueDate).toLocaleDateString(),timeZone:"UTC"}:(this._isChangedDueDate&&this._newTaskDueDate,o.dueDateTime=null)}if(!Object.keys(o).length)return;let i=yield AC(this._graph,t,e.id,o),n=this._tasks.findIndex(s=>s.id===i.id);this._tasks[n]=i,this._loadingTasks=this._loadingTasks.filter(s=>s!==i.id)})}handleTaskCheckClick(e){this.handleTaskClick(e),this.readOnly||(e.status==="completed"?this.updateTaskStatus(e,"notStarted"):this.updateTaskStatus(e,"completed"))}handleTaskCheckKeydown(e,t){e.key==="Enter"&&!this.readOnly&&(this.handleTaskClick(t),t.status==="completed"?this.updateTaskStatus(t,"notStarted"):this.updateTaskStatus(t,"completed"))}};xi([le(),ki("design:type",Array)],Ro.prototype,"_tasks",void 0);xi([le(),ki("design:type",Object)],Ro.prototype,"_taskBeingUpdated",void 0);xi([le(),ki("design:type",Boolean)],Ro.prototype,"_updatingTaskDate",void 0);xi([le(),ki("design:type",Object)],Ro.prototype,"_isChangedDueDate",void 0);xi([le(),ki("design:type",Boolean)],Ro.prototype,"_isLoadingTasks",void 0);xi([le(),ki("design:type",Array)],Ro.prototype,"_loadingTasks",void 0);xi([le(),ki("design:type",Date)],Ro.prototype,"_newTaskDueDate",void 0);xi([le(),ki("design:type",String)],Ro.prototype,"_newTaskName",void 0);xi([le(),ki("design:type",String)],Ro.prototype,"_changedTaskName",void 0);xi([le(),ki("design:type",Boolean)],Ro.prototype,"_isNewTaskBeingAdded",void 0);xi([le(),ki("design:type",Object)],Ro.prototype,"_graph",void 0);xi([le(),ki("design:type",Object)],Ro.prototype,"currentList",void 0);xi([le(),ki("design:type",Object)],Ro.prototype,"_isDarkMode",void 0);Ou();Zg();Jg();Xg();l();c();d();Te();At();ue();yr();Xr();l();c();d();var cv={placeholder:"Search",title:"Search"};l();c();d();Te();var n6=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host fluent-search{width:100%}
`];Ai();ue();var RC=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},dv=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},s6=()=>{vt(Uw),Pe("search-box",Pd)},Pd=class extends fr{static get styles(){return n6}get strings(){return cv}get searchTerm(){return this._searchTerm}set searchTerm(e){this._searchTerm=e,this.fireSearchTermChanged()}constructor(){super(),this._searchTerm="",this.onInputChanged=e=>{this.searchTerm=e.target.value},this.debounceDelay=300}render(){var e;return k`
      <fluent-search
        autocomplete="off"
        class="search-term-input"
        appearance="outline"
        value=${(e=this.searchTerm)!==null&&e!==void 0?e:""}
        placeholder=${this.placeholder?this.placeholder:cv.placeholder}
        title=${this.title?this.title:cv.title}
        @input=${this.onInputChanged}
        @change=${this.onInputChanged}
      >
      </fluent-search>`}fireSearchTermChanged(){this.debouncedSearchTermChanged||(this.debouncedSearchTermChanged=Ac(()=>{this.fireCustomEvent("searchTermChanged",this.searchTerm)},this.debounceDelay)),this.debouncedSearchTermChanged()}};RC([E({attribute:"placeholder",type:String}),dv("design:type",String)],Pd.prototype,"placeholder",void 0);RC([E({attribute:"search-term",type:String}),dv("design:type",Object),dv("design:paramtypes",[Object])],Pd.prototype,"searchTerm",null);RC([E({attribute:"debounce-delay",type:Number,reflect:!0}),dv("design:type",Number)],Pd.prototype,"debounceDelay",void 0);l();c();d();Te();At();ue();hn();l();c();d();var Tn={modified:"modified on",back:"Back",next:"Next",pages:"pages",page:"Page"};l();c();d();Te();var a6=[Me`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}
`];Ai();Vr();yr();Xr();ue();_d();Yi();var Vo=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},to=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},QM=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},l6=()=>{vt(Ph,Dr,iC,bw),Ga(),ii(),Pe("search-results",ro)},ro=class extends st{static get styles(){return a6}get strings(){return Tn}get queryString(){return this._queryString}set queryString(e){this._queryString!==e&&(this._queryString=e,this._currentPage=1,this.setLoadingState(!0),this.requestStateUpdate(!0))}get from(){return(this.currentPage-1)*this.size}get size(){return this._size}set size(e){e>this.maxPageSize?this._size=this.maxPageSize:this._size=e}get searchEndpoint(){return"/search/query"}get maxPageSize(){return 1e3}get currentPage(){return this._currentPage}set currentPage(e){this._currentPage!==e&&(this._currentPage=e,this.requestStateUpdate(!0))}constructor(){super(),this._size=10,this.entityTypes=["driveItem","listItem","site"],this.scopes=[],this.contentSources=[],this.version="v1.0",this.pagingMax=7,this.enableTopResults=!1,this.cacheEnabled=!1,this.cacheInvalidationPeriod=3e4,this.isRefreshing=!1,this.defaultFields=["webUrl","lastModifiedBy","lastModifiedDateTime","summary","displayName","name"],this._currentPage=1,this.onFirstPageClick=()=>{this.currentPage=1,this.scrollToFirstResult()},this.onPageBackClick=()=>{this.currentPage--,this.scrollToFirstResult()},this.onPageNextClick=()=>{this.currentPage++,this.scrollToFirstResult()}}attributeChangedCallback(e,t,o){super.attributeChangedCallback(e,t,o),this.requestStateUpdate()}refresh(e=!1){this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.response=null}render(){var e,t,o,i,n,s,a,u;let h=null,p=null,f=null;return this.hasTemplate("header")&&(p=this.renderTemplate("header",this.response)),f=this.renderFooter((t=(e=this.response)===null||e===void 0?void 0:e.value[0])===null||t===void 0?void 0:t.hitsContainers[0]),this.isLoadingState?h=this.renderLoading():this.error?h=this.renderError():this.response&&this.hasTemplate("default")?h=this.renderTemplate("default",this.response)||k``:!((i=(o=this.response)===null||o===void 0?void 0:o.value[0])===null||i===void 0)&&i.hitsContainers[0]?h=k`${(u=(a=(s=(n=this.response)===null||n===void 0?void 0:n.value[0])===null||s===void 0?void 0:s.hitsContainers[0])===null||a===void 0?void 0:a.hits)===null||u===void 0?void 0:u.map(b=>this.renderResult(b))}`:this.hasTemplate("no-data")?h=this.renderTemplate("no-data",null):h=k``,k`
      ${p}
      <div class="search-results">
        ${h}
      </div>
      ${f}`}loadState(){var e,t,o,i,n,s;return QM(this,void 0,void 0,function*(){let a=K.globalProvider;if(this.error=null,!(!a||a.state!==ce.SignedIn)){if(this.queryString){try{let u=this.getRequestOptions(),h,p=JSON.stringify({endpoint:`${this.version}${this.searchEndpoint}`,requestOptions:u}),f=null;if(this.shouldRetrieveCache()){h=Q.getCache(N.search,N.search.stores.responses);let b=wf()?yield h.getValue(p):null;b&&uS(this.cacheInvalidationPeriod)>Date.now()-b.timeCached&&(f=JSON.parse(b.response))}if(!f){let b=a.graph.forComponent(this),x=b.api(this.searchEndpoint).version(this.version);if(!((e=this.scopes)===null||e===void 0)&&e.length&&(x=x.middlewareOptions(ye(this.scopes))),f=yield x.post({requests:[u]}),this.fetchThumbnail){let S=b.createBatch(),R=Zs.fromGraph(b).createBatch(),z=!((t=f.value)===null||t===void 0)&&t.length&&(!((o=f.value[0].hitsContainers)===null||o===void 0)&&o.length)?(n=(i=f.value[0].hitsContainers[0])===null||i===void 0?void 0:i.hits)!==null&&n!==void 0?n:[]:[];for(let re of z){let ge=re.resource;(ge.size>0||!((s=ge.webUrl)===null||s===void 0)&&s.endsWith(".aspx"))&&(ge["@odata.type"]==="#microsoft.graph.driveItem"||ge["@odata.type"]==="#microsoft.graph.listItem")&&(ge["@odata.type"]==="#microsoft.graph.listItem"?R.get(re.hitId.toString(),`/sites/${ge.parentReference.siteId}/pages/${ge.id}`):S.get(re.hitId.toString(),`/drives/${ge.parentReference.driveId}/items/${ge.id}/thumbnails/0/medium`))}let we=re=>{if(re&&re.size>0)for(let[ge,wt]of re){let je=f.value[0].hitsContainers[0].hits[ge],it=je.resource["@odata.type"]==="#microsoft.graph.listItem"?{url:wt.content.thumbnailWebUrl}:{url:wt.content.url};je.resource.thumbnail=it}};try{we(yield S.executeAll()),we(yield R.executeAll())}catch{}}this.shouldUpdateCache()&&f&&(h=Q.getCache(N.search,N.search.stores.responses),yield h.putValue(p,{response:JSON.stringify(f)}))}cl(this.response,f)||(this.response=f)}catch(u){this.error=u}this.response&&(this.error=null)}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}})}renderLoading(){return this.renderTemplate("loading",null)||k`
        ${[...Array(this.size)].map(()=>k`
            <div class="search-result">
              <div class="search-result-grid">
                <div class="search-result-icon">
                  <fluent-skeleton class="search-result-icon__shimmer" shape="rect" shimmer></fluent-skeleton>
                </div>
                <div class="searc-result-content">
                  <div class="search-result-name">
                    <fluent-skeleton class="search-result-name__shimmer" shape="rect" shimmer></fluent-skeleton>
                  </div>
                  <div class="search-result-info">
                    <div class="search-result-author">
                      <fluent-skeleton class="search-result-author__shimmer" shape="circle" shimmer></fluent-skeleton>
                    </div>
                    <div class="search-result-date">
                      <fluent-skeleton class="search-result-date__shimmer" shape="rect" shimmer></fluent-skeleton>
                    </div>
                  </div>
                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>
                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>
                </div>
                ${this.fetchThumbnail&&k`
                    <div class="search-result-thumbnail">
                      <fluent-skeleton class="search-result-thumbnail__shimmer" shape="rect" shimmer></fluent-skeleton>
                    </div>
                  `}
              </div>
              <fluent-divider></fluent-divider>
            </div>
          `)}
       `}renderResult(e){let t=this.getResourceType(e.resource);if(this.hasTemplate(`result-${t}`))return this.renderTemplate(`result-${t}`,e,e.hitId);switch(e.resource["@odata.type"]){case"#microsoft.graph.driveItem":return this.renderDriveItem(e);case"#microsoft.graph.site":return this.renderSite(e);case"#microsoft.graph.person":return this.renderPerson(e);case"#microsoft.graph.drive":case"#microsoft.graph.list":return this.renderList(e);case"#microsoft.graph.listItem":return this.renderListItem(e);case"#microsoft.graph.search.bookmark":return this.renderBookmark(e);case"#microsoft.graph.search.acronym":return this.renderAcronym(e);case"#microsoft.graph.search.qna":return this.renderQnA(e);default:return this.renderDefault(e)}}renderFooter(e){if(this.pagingRequired(e)){let t=this.getActivePages(e.total);return k`
        <div class="search-results-pages">
          ${this.renderPreviousPage()}
          ${this.renderFirstPage(t)}
          ${this.renderAllPages(t)}
          ${this.renderNextPage()}
        </div>
      `}}pagingRequired(e){return e?.moreResultsAvailable||this.currentPage*this.size<e?.total}getActivePages(e){let t=()=>{let n=this.currentPage-Math.floor(this.pagingMax/2)-1;return n>=Math.floor(this.pagingMax/2)?n:0},o=[],i=t();if(i+1>this.pagingMax-this.currentPage||this.pagingMax===this.currentPage)for(let n=i+1;n<Math.ceil(e/this.size)&&n<this.pagingMax+(this.currentPage-1)&&o.length<this.pagingMax-2;++n)o.push(n+1);else for(let n=i;n<this.pagingMax;++n)o.push(n+1);return o}renderAllPages(e){return k`
      ${e.map(t=>k`
            <fluent-button
              title="${Tn.page} ${t}"
              appearance="stealth"
              class="${t===this.currentPage?"search-results-page-active":"search-results-page"}"
              @click="${()=>this.onPageClick(t)}">
                ${t}
            </fluent-button>`)}`}renderFirstPage(e){return k`
      ${e.some(t=>t===1)?rt:k`
              <fluent-button
                 title="${Tn.page} 1"
                 appearance="stealth"
                 class="search-results-page"
                 @click="${this.onFirstPageClick}">
                 1
               </fluent-button>`?k`
              <fluent-button
                id="page-back-dot"
                appearance="stealth"
                class="search-results-page"
                title="${this.getDotButtonTitle()}"
                @click="${()=>this.onPageClick(this.currentPage-Math.ceil(this.pagingMax/2))}"
              >
                ...
              </fluent-button>`:rt}`}getDotButtonTitle(){return`${Tn.back} ${Math.ceil(this.pagingMax/2)} ${Tn.pages}`}renderPreviousPage(){return this.currentPage>1?k`
          <fluent-button
            appearance="stealth"
            class="search-results-page"
            title="${Tn.back}"
            @click="${this.onPageBackClick}">
              ${Y(P.ChevronLeft)}
            </fluent-button>`:rt}renderNextPage(){return this.isLastPage()?rt:k`
          <fluent-button
            appearance="stealth"
            class="search-results-page"
            title="${Tn.next}"
            aria-label="${Tn.next}"
            @click="${this.onPageNextClick}">
              ${Y(P.ChevronRight)}
            </fluent-button>`}onPageClick(e){this.currentPage=e,this.scrollToFirstResult()}isLastPage(){return this.currentPage===Math.ceil(this.response.value[0].hitsContainers[0].total/this.size)}scrollToFirstResult(){this.renderRoot.querySelector(".search-results").scrollIntoView({block:"start",behavior:"smooth"})}getResourceType(e){return e["@odata.type"].split(".").pop()}renderDriveItem(e){var t,o;let i=e.resource;return Ee`
      <div class="search-result-grid">
        <div class="search-result-icon">
          <mgt-file
            .fileDetails="${e.resource}"
            view="image"
            class="file-icon">
          </mgt-file>
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${i.webUrl}?Web=1" target="_blank">${Pc(i.name)}</a>
          </div>
          <div class="search-result-info">
            <div class="search-result-author">
              <mgt-person
                person-query=${i.lastModifiedBy.user.email}
                view="oneLine"
                person-card="hover"
                show-presence="true">
              </mgt-person>
            </div>
            <div class="search-result-date">
              &nbsp; ${Tn.modified} ${Cl(new Date(i.lastModifiedDateTime))}
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${Rc(e.summary)}"></div>
        </div>
        ${((t=i.thumbnail)===null||t===void 0?void 0:t.url)&&k`
          <div class="search-result-thumbnail">
            <a href="${i.webUrl}" target="_blank"><img alt="${i.name}" src="${(o=i.thumbnail)===null||o===void 0?void 0:o.url}" /></a>
          </div>`}

      </div>
      <fluent-divider></fluent-divider>
    `}renderSite(e){let t=e.resource;return k`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${this.getResourceIcon(t)}
        </div>
        <div class="searc-result-content">
          <div class="search-result-name">
            <a href="${t.webUrl}" target="_blank">${t.displayName}</a>
          </div>
          <div class="search-result-info">
            <div class="search-result-url">
              <a href="${t.webUrl}" target="_blank">${t.webUrl}</a>
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${Rc(e.summary)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderList(e){let t=e.resource;return Ee`
      <div class="search-result-grid">
        <div class="search-result-icon">
          <mgt-file
            .fileDetails="${e.resource}"
            view="image">
          </mgt-file>
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${t.webUrl}?Web=1" target="_blank">
              ${Pc(t.name||bf(t.webUrl))}
            </a>
          </div>
          <div class="search-result-summary" .innerHTML="${Rc(e.summary)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderListItem(e){var t,o;let i=e.resource;return Ee`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${i.webUrl.endsWith(".aspx")?Y(P.News):Y(P.FileOuter)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${i.webUrl}?Web=1" target="_blank">
              ${Pc(i.name||bf(i.webUrl))}
            </a>
          </div>
          <div class="search-result-info">
            <div class="search-result-author">
              <mgt-person
                person-query=${i.lastModifiedBy.user.email}
                view="oneLine"
                person-card="hover"
                show-presence="true">
              </mgt-person>
            </div>
            <div class="search-result-date">
              &nbsp; ${Tn.modified} ${Cl(new Date(i.lastModifiedDateTime))}
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${Rc(e.summary)}"></div>
        </div>
        ${((t=i.thumbnail)===null||t===void 0?void 0:t.url)&&k`
          <div class="search-result-thumbnail">
            <a href="${i.webUrl}" target="_blank"><img alt="${Pc(i.name||bf(i.webUrl))}" src="${((o=i.thumbnail)===null||o===void 0?void 0:o.url)||rt}" /></a>
          </div>`}
      </div>
      <fluent-divider></fluent-divider>
    `}renderPerson(e){let t=e.resource;return Ee`
      <div class="search-result">
        <mgt-person
          view="fourLines"
          person-query=${t.userPrincipalName}
          person-card="hover"
          show-presence="true">
        </mgt-person>
      </div>
      <fluent-divider></fluent-divider>
    `}renderBookmark(e){return this.renderAnswer(e,P.DoubleBookmark)}renderAcronym(e){return this.renderAnswer(e,P.BookOpen)}renderQnA(e){return this.renderAnswer(e,P.BookQuestion)}renderAnswer(e,t){let o=e.resource;return k`
      <div class="search-result-grid search-result-answer">
        <div class="search-result-icon">
          ${Y(t)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${this.getResourceUrl(o)}?Web=1" target="_blank">${o.displayName}</a>
          </div>
          <div class="search-result-summary">${o.description}</div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderDefault(e){let t=e.resource,o=this.getResourceUrl(t);return k`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${this.getResourceIcon(t)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            ${o?k`
                  <a href="${o}?Web=1" target="_blank">${this.getResourceName(t)}</a>
                `:k`
                  ${this.getResourceName(t)}
                `}
          </div>
          <div class="search-result-summary" .innerHTML="${this.getResultSummary(e)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}getResourceUrl(e){return e.webUrl||e.webLink||null}getResourceName(e){return e.displayName||e.subject||Pc(e.name)}getResultSummary(e){var t;return Rc(e.summary||((t=e.resource)===null||t===void 0?void 0:t.description)||null)}getResourceIcon(e){switch(e["@odata.type"]){case"#microsoft.graph.site":return Y(P.Globe);case"#microsoft.graph.message":return Y(P.Email);case"#microsoft.graph.event":return Y(P.Event);case"microsoft.graph.chatMessage":return Y(P.SmallChat);default:return Y(P.FileOuter)}}shouldRetrieveCache(){return wf()&&this.cacheEnabled&&!this.isRefreshing}shouldUpdateCache(){return wf()&&this.cacheEnabled}getRequestOptions(){let e={entityTypes:this.entityTypes,query:{queryString:this.queryString},from:this.from?this.from:void 0,size:this.size?this.size:void 0,fields:this.getFields(),enableTopResults:this.enableTopResults?this.enableTopResults:void 0};return this.entityTypes.includes("externalItem")&&(e.contentSources=this.contentSources),this.version==="beta"&&(e.query.queryTemplate=this.queryTemplate?this.queryTemplate:void 0),e}getFields(){if(this.fields)return this.defaultFields.concat(this.fields)}};Vo([E({attribute:"query-string",type:String}),to("design:type",String),to("design:paramtypes",[String])],ro.prototype,"queryString",null);Vo([E({attribute:"query-template",type:String}),to("design:type",String)],ro.prototype,"queryTemplate",void 0);Vo([E({attribute:"entity-types",converter:r=>r.split(",").map(e=>e.trim()),type:String}),to("design:type",Array)],ro.prototype,"entityTypes",void 0);Vo([E({attribute:"scopes",converter:(r,e)=>r?r.toLowerCase().split(","):null}),to("design:type",Array)],ro.prototype,"scopes",void 0);Vo([E({attribute:"content-sources",converter:(r,e)=>r?r.toLowerCase().split(","):null}),to("design:type",Array)],ro.prototype,"contentSources",void 0);Vo([E({attribute:"version",reflect:!0,type:String}),to("design:type",Object)],ro.prototype,"version",void 0);Vo([E({attribute:"size",reflect:!0,type:Number}),to("design:type",Number),to("design:paramtypes",[Object])],ro.prototype,"size",null);Vo([E({attribute:"paging-max",reflect:!0,type:Number}),to("design:type",Object)],ro.prototype,"pagingMax",void 0);Vo([E({attribute:"fetch-thumbnail",type:Boolean}),to("design:type",Boolean)],ro.prototype,"fetchThumbnail",void 0);Vo([E({attribute:"fields",converter:r=>r.split(",").map(e=>e.trim()),type:String}),to("design:type",Array)],ro.prototype,"fields",void 0);Vo([E({attribute:"enable-top-results",reflect:!0,type:Boolean}),to("design:type",Object)],ro.prototype,"enableTopResults",void 0);Vo([E({attribute:"cache-enabled",reflect:!0,type:Boolean}),to("design:type",Object)],ro.prototype,"cacheEnabled",void 0);Vo([E({attribute:"cache-invalidation-period",reflect:!0,type:Number}),to("design:type",Object)],ro.prototype,"cacheInvalidationPeriod",void 0);Vo([le(),to("design:type",Object)],ro.prototype,"response",void 0);Vo([le(),to("design:type",Number),to("design:paramtypes",[Number])],ro.prototype,"currentPage",null);l();c();d();Te();At();ue();yr();Xr();l();c();d();yr();W();Ds();var u6="#717171",c6=et.create("secondary-text-color").withDefault(u6),h6="#1a1a1a",d6=et.create("secondary-text-hover-color").withDefault(h6),p6=(r,e=document.body)=>{let t=ZM(r);YM(t,e)},YM=(r,e=document.body)=>{var t;bh.setValueFor(e,tt.from(pt(r.accentBaseColor))),yh.setValueFor(e,tt.from(pt(r.neutralBaseColor))),Gi.setValueFor(e,r.baseLayerLuminance),(t=r.designTokenOverrides)===null||t===void 0||t.call(r,e)},ZM=r=>{switch(r){case"contrast":return{accentBaseColor:"#7f85f5",neutralBaseColor:"#adadad",baseLayerLuminance:Qn.DarkMode};case"default":return{accentBaseColor:"#5b5fc7",neutralBaseColor:"#616161",baseLayerLuminance:Qn.LightMode};case"dark":return{accentBaseColor:"#479ef5",neutralBaseColor:"#adadad",baseLayerLuminance:Qn.DarkMode,designTokenOverrides:e=>{Qe.setValueFor(e,tt.from(pt("#115ea3"))),Yr.setValueFor(e,tt.from(pt("#0f6cbd"))),Zr.setValueFor(e,tt.from(pt("#0c3b5e"))),dd.setValueFor(e,tt.from(pt("#0f548c"))),wh.setValueFor(e,tt.from(pt("#479EF5"))),Ch.setValueFor(e,tt.from(pt("#62abf5"))),xh.setValueFor(e,tt.from(pt("#2886de"))),sR.setValueFor(e,tt.from(pt("#479ef5"))),mg.setValueFor(e,tt.from(pt("#115ea3"))),gg.setValueFor(e,tt.from(pt("#0f6cbd"))),vg.setValueFor(e,tt.from(pt("#0c3b5e"))),aR.setValueFor(e,tt.from(pt("#0f548c"))),hd.setValueFor(e,tt.from(pt("#ffffff"))),Uo.setValueFor(e,tt.from(pt("#ffffff"))),ud.setValueFor(e,tt.from(pt("#ffffff"))),nR.setValueFor(e,tt.from(pt("#ffffff"))),c6.setValueFor(e,"#8e8e8e"),d6.setValueFor(e,"#ffffff")}};case"light":default:return{accentBaseColor:"#0f6cbd",neutralBaseColor:"#616161",baseLayerLuminance:Qn.LightMode,designTokenOverrides:e=>{c6.setValueFor(e,u6),d6.setValueFor(e,h6)}}}};l();c();d();var Qh={label:"Color mode:",on:"Dark",off:"Light"};ue();var JM=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},XM=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},f6=()=>{vt(Kw),Pe("theme-toggle",uv)},uv=class extends fr{constructor(){super(),this.onSwitchChanged=t=>{this.darkModeActive=t.target.checked};let e=window.matchMedia("(prefers-color-scheme:dark)").matches;this.darkModeActive=e,this.applyTheme(this.darkModeActive)}get strings(){return Qh}updated(e){e.has("darkModeActive")&&this.applyTheme(this.darkModeActive)}render(){return k`
      <fluent-switch checked=${this.darkModeActive} @change=${this.onSwitchChanged}>
        <span slot="checked-message">${Qh.on}</span>
        <span slot="unchecked-message">${Qh.off}</span>
        <label for="direction-switch">${Qh.label}</label>
      </fluent-switch>
`}applyTheme(e){let t=e?"dark":"light";p6(t),document.body.classList.remove("mgt-dark-mode","mgt-light-mode"),document.body.classList.add(`mgt-${t}-mode`),this.fireCustomEvent("darkmodechanged",this.darkModeActive,!0,!1,!0)}};JM([E({attribute:"mode",reflect:!0,type:String,converter:{fromAttribute:r=>r==="dark",toAttribute:r=>r?"dark":"light"}}),XM("design:type",Boolean)],uv.prototype,"darkModeActive",void 0);pn();_d();Yg();Iu();hC();ev();Yi();Tu();Ou();Ou();Zg();Jg();Xg();pn();l();c();d();l();c();d();var m6=__REACT_DOM__,{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Yyt,createPortal:Zyt,findDOMNode:Jyt,flushSync:Xyt,hydrate:ebt,render:tbt,unmountComponentAtNode:rbt,unstable_batchedUpdates:obt,unstable_createPortal:ibt,unstable_renderSubtreeIntoContainer:nbt,version:sbt}=__REACT_DOM__;l();c();d();l();c();d();var e8=new Set(["children","wcType"]),hv=class extends VC{get element(){return this._element}getTag(){let e;return typeof this.props.wcType=="function"?e=this.props.wcType.name.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase():typeof this.props.wcType=="string"&&(e=this.props.wcType),e}render(){let e=this.getTag();if(!e)throw'"wcType" must be set!';let t={};for(let o of Object.keys(this.props))o&&this.props[o]===!0&&(t[o]=!0);return Pr.createElement(e,Object.assign(Object.assign({},t),{ref:o=>this.setRef(o)}),this.props.children)}setRef(e){e?(e!==this._element&&this.cleanUp(),this._element=e,this.syncProps(this.props)):this.cleanUp(),this.props.innerRef&&(typeof this.props.innerRef=="function"?this.props.innerRef(e):this.props.innerRef.current=e)}cleanUp(){if(this._element){for(let e in this.props)this.props.hasOwnProperty(e)&&this.isEventProp(e,this.props[e])&&this.removeEventListener(e,this.props[e]);this._element=null}}componentDidUpdate(e){let t={};for(let o in this.props)this.props.hasOwnProperty(o)&&(!e[o]||e[o]!==this.props[o])&&(t[o]=this.props[o],e[o]&&this.isEventProp(o,e[o])&&this.removeEventListener(o,e[o]));for(let o in e)e.hasOwnProperty(o)&&!this.props[o]&&this.isEventProp(o,e[o])&&this.removeEventListener(o,e[o]);this.syncProps(t)}syncProps(e){if(this._element)for(let t in e)e8.has(t)||(this.isEventProp(t,e[t])&&this.addEventListener(t,e[t]),this._element[t]=e[t])}isEventProp(e,t){return e&&typeof t=="function"}addEventListener(e,t){let o=e;o.match(/^on[A-Z]/gm)&&(o=o.substring(2).toLowerCase()),this._element.addEventListener(o,t)}removeEventListener(e,t){let o=e;o.match(/^on[A-Z]/gm)&&(o=o.substring(2).toLowerCase()),this._element.removeEventListener(o,t)}};ue();var PC=class extends hv{_templates;constructor(e){super(e)}getTag(){let e=super.getTag(),t=`${oo.prefix}-`;return e.startsWith(t)||(e=t+e),e}render(){let e=this.getTag();if(!e)throw new Error('"wcType" must be set!');this.processTemplates(this.props.children);let t=[];if(this._templates){for(let o in this._templates)if(Object.prototype.hasOwnProperty.call(this._templates,o)){let i=Pr.createElement("template",{key:o,"data-type":o},null);t.push(i)}}return Pr.createElement(e,{ref:o=>this.setRef(o)},t)}setRef(e){e&&e.addEventListener("templateRendered",this.handleTemplateRendered),super.setRef(e)}cleanUp(){this.element&&(this.element.removeEventListener("templateRendered",this.handleTemplateRendered),super.cleanUp())}handleTemplateRendered=e=>{if(!this._templates)return;let t=e.detail.templateType,o=e.detail.context,i=e.detail.element,n=this._templates[t];n&&(n=Pr.cloneElement(n,{dataContext:o}),m6.render(n,i))};processTemplates(e){if(!e)return;let t={};Pr.Children.forEach(e,o=>{let i=o,n=i?.props?.template;n?t[n]=i:t.default=i}),this._templates=t}},ct=(r,e)=>{e();let t=(i,n)=>Pr.createElement(PC,{wcType:r,innerRef:n,...i});return Pr.forwardRef(t)};var g6=ct("person",ii);l();c();d();var zbt=ct("person-card",pC);l();c();d();var Qbt=ct("agenda",uP);l();c();d();var r1t=ct("get",Ed);l();c();d();var v6=ct("login",bP);l();c();d();var m1t=ct("people-picker",nv);l();c();d();var x1t=ct("people",Td);l();c();d();var A1t=ct("planner",zP);l();c();d();var D1t=ct("teams-channel-picker",ZP);l();c();d();var V1t=ct("todo",i6);l();c();d();var Y1t=ct("file",Ga);l();c();d();var owt=ct("file-list",Qg);l();c();d();var dwt=ct("picker",rv);l();c();d();var vwt=ct("taxonomy-picker",gP);l();c();d();var Swt=ct("theme-toggle",f6);l();c();d();var Pwt=ct("search-box",s6);l();c();d();var Nwt=ct("search-results",l6);l();c();d();var Gwt=ct("spinner",Hn);var t8=()=>{let e=new window.URL(window.location.href).searchParams.get("clientId");return e||oS};document.getElementById("mgt-version").innerText=rl;var y6=new Wp(!0),S6=new pf({clientId:t8(),redirectUri:window.location.origin+"/"+iS,scopes:["user.read","user.read.all","mail.readBasic","people.read","people.read.all","sites.read.all","user.readbasic.all","contacts.read","presence.read","presence.read.all","tasks.readwrite","tasks.read","calendars.read","group.read.all","files.read","files.read.all","files.readwrite","files.readwrite.all"],loginType:ls.Popup}),b6=!1;K.globalProvider=S6;var r8=()=>{let[r,e]=qC(K.globalProvider.state),t=GC({STORY_RENDERED:u=>{console.log("storyRendered",u)}}),o=u=>{K.globalProvider.state===ce.SignedOut&&K.globalProvider!==y6?t(V0,{state:u,provider:y6,name:"MgtMockProvider"}):t(V0,{state:u,provider:S6,name:"MgtMsal2Provider"})};K.onProviderUpdated(()=>{r!==K.globalProvider.state&&(e(K.globalProvider.state),o(K.globalProvider.state))});let i=async()=>{await K.globalProvider.logout(),n()},n=()=>{console.log("reload"),window.location.reload()},s=u=>{b6&&n(),console.log("loginCompleted")},a=u=>{b6=!0,console.log("loginInitiated")};return o(r),Pr.createElement(Pr.Fragment,null,Pr.createElement("div",{style:{marginTop:"3px",display:K.globalProvider.state!==ce.SignedIn?"flex":"none"}},Pr.createElement(v6,{loginView:"compact",loginCompleted:s,loginInitiated:a})),Pr.createElement("div",{style:{display:K.globalProvider.state===ce.SignedIn?"flex":"none"}},Pr.createElement("div",{style:{marginTop:"8px"}},Pr.createElement(g6,{personQuery:"me"})),Pr.createElement("fluent-button",{appearance:"lightweight",style:{marginTop:"3px"},onClick:i},"Sign Out")))};Yh.register("mgt",r=>{Yh.add("mgt/login",{type:$C.TOOLEXTRA,title:"Sign In",render:({active:e})=>Pr.createElement(r8,null)})});Yh.setConfig({enableShortcuts:!1,theme:zC,sidebar:{filters:{patterns:r=>!(r.tags.includes("hidden")&&r.type==="story")}}});var w6="http://www.w3.org/2000/svg";window.onload=()=>{_6()};function _6(){let r="color: black; text-decoration: none; text-align: center; cursor: pointer; padding-right: 0.5rem;",e="margin-left: 0.25rem; font-size: 0.75rem;",t="display: flex;",o=document.getElementsByClassName("sidebar-header");if(o.length===0)return setTimeout(_6,500),!1;o[0].innerHTML='<h1 tabindex="-1" class="css-1su1ft1"><a href="https://aka.ms/mgt" target="_blank" class="css-ixbm00">Microsoft Graph Toolkit Playground</a></h1>';let i=o[0].parentNode,s=C6("M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"),a=document.createElement("span");a.style=e,a.innerText="GitHub";let u=document.createElement("span");u.style=t,u.append(s,a);let h=document.createElement("a");h.href="https://aka.ms/mgt",h.target="_blank",h.style=r,h.appendChild(u);let f=C6("M1.763 0C.786 0 0 .786 0 1.763v20.474C0 23.214.786 24 1.763 24h20.474c.977 0 1.763-.786 1.763-1.763V1.763C24 .786 23.214 0 22.237 0zM5.13 5.323l13.837.019-.009 13.836h-3.464l.01-10.382h-3.456L12.04 19.17H5.113z"),b=document.createElement("span");b.style=e,b.innerText="npm";let x=document.createElement("span");x.style=t,x.append(f,b);let S=document.createElement("a");S.href="https://www.npmjs.com/package/@microsoft/mgt",S.target="_blank",S.style=r+" margin-left: 0.5rem;",S.appendChild(x);let R=document.createElement("div");R.id="useful-links",R.style="display: flex; margin: 1rem 0rem; font-size: 0.875rem;",R.append(h,S),i.insertBefore(R,i.childNodes[1]);let z=document.getElementsByClassName("sidebar-subheading");if(z)for(let je=0;je<z.length;je++)z[je].removeAttribute("aria-expanded");function we(){let je=document.getElementsByClassName("css-ulso1l");if(je)for(let it=0;it<je.length;it++)je[it].addEventListener("click",re,{useCapture:!0})}function re(){let je=document.getElementsByClassName("css-rl1ij0");if(je)for(let it=0;it<je.length;it++){let Po=je[it];wt(Po),Po.addEventListener("click",ge,{useCapture:!0})}}function ge(je){let it=je.target;wt(it)}function wt(je){let Po=je.getAttribute("data-expanded")==="true"?"expand":"collapse";je.setAttribute("aria-label",Po)}we()}function C6(r){let o="height: 0.75rem; margin-top: 0.125rem;",i=document.createElementNS(w6,"svg");i.setAttributeNS(null,"viewBox",`0 0 ${12*2} ${12*2}`),i.setAttributeNS(null,"width",12),i.setAttributeNS(null,"height",12),i.setAttributeNS(null,"role","img"),i.setAttributeNS(null,"aria-label"," to "),i.setAttributeNS(null,"style",o);let n=document.createElementNS(w6,"path");return n.setAttributeNS(null,"d",r),i.appendChild(n),i}var o8=()=>{let r=document.createElement("script");r.src="https://consentdeliveryfd.azurefd.net/mscc/lib/v2/wcp-consent.js",document.head.appendChild(r);let e=document.createElement("script");e.type="module",e.src="https://unpkg.com/@fluentui/web-components@2",document.head.appendChild(e)};o8();var x6=0,k6=setInterval(()=>{if(x6++,x6>100){clearInterval(k6);return}let r=document.querySelector("footer"),e=document.querySelector("nav.sidebar-container");e&&(e.parentElement.appendChild(r),e.style.height=`calc(100% - ${r.clientHeight}px)`,clearInterval(k6))},100);navigator.serviceWorker.register("sw.js");})();
}catch(e){ console.error("[Storybook] One of your manager-entries failed: " + import.meta.url, e); }
