"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[959],{7744:function(e,t,n){n.d(t,{g:function(){return s}});n(969);var o=n(8667),r=n(7780),a=n(7574),i=(0,r.Z)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 300px)"},message:{paddingLeft:"10px"}}),s=function(e){var t=i();return(0,a.jsxs)("div",{className:t.root,children:[(0,a.jsx)(o.$,{}),(0,a.jsx)("div",{className:t.message,children:(0,a.jsx)("span",{children:e.message||"Loading..."})})]})}},6993:function(e,t,n){n.d(t,{V:function(){return v}});var o=n(3028),r=n(2476),a=n(3895),i=n(5607),s=n(7780),l=n(4220),c=n(16),d=n(7574),p=(0,s.Z)({email:(0,o.Z)((0,o.Z)((0,o.Z)({boxShadow:"var(--box-shadow)"},l.q5.padding("10px")),l.q5.margin("8px")),{},{":hover":{borderLeftWidth:"4px",borderLeftColor:"var(--input-border-color--hover)",borderLeftStyle:"solid",paddingLeft:"6px"},"& mgt-person":{"--font-size":"12px","--person-avatar-size":"16px"}}),link:{color:"var(--color-sub1)",textDecorationLine:"none"},header:{display:"flex",justifyContent:"space-between"},subject:(0,o.Z)((0,o.Z)({color:"var(--color-sub1)",fontSize:"14px"},l.q5.gridArea("1 / 1 / auto / 3")),l.q5.margin("0")),title:{display:"flex",justifyContent:"space-between",marginBottom:"4px",color:"var(--color-sub1)"},date:{fontSize:"12px",paddingLeft:"4px",float:"right"},body:(0,o.Z)((0,o.Z)({fontSize:"13px",textOverflow:"ellipsis",wordWrap:"break-word"},l.q5.overflow("hidden")),{},{maxHeight:"2.8em",lineHeight:"1.4em",color:"var(--color-sub2)"}),emptyBody:{fontStyle:"italic"}});function v(e){var t,n,o=p(),s=e.dataContext;return(0,d.jsx)("div",{className:o.email,children:(0,d.jsxs)("a",{className:o.link,href:s.webLink,target:"_blank",rel:"noreferrer",children:[(0,d.jsx)("div",{className:o.header,children:(0,d.jsx)("div",{children:(0,d.jsx)(r.F,{personQuery:s.sender.emailAddress.address,view:a.k.oneline,personCardInteraction:i.c.hover})})}),(0,d.jsxs)("div",{className:o.title,children:[(0,d.jsx)("h3",{className:o.subject,children:s.subject}),(0,d.jsx)("span",{className:o.date,children:new Date(s.receivedDateTime).toLocaleDateString()})]}),null!==(t=s.bodyPreview)&&void 0!==t?t:(0,d.jsx)("div",{className:o.body,children:s.bodyPreview}),null!==(n=!s.bodyPreview)&&void 0!==n?n:(0,d.jsx)("div",{className:(0,c.z)(o.body,o.emptyBody),children:"..."})]})})}},4612:function(e,t,n){n.d(t,{Mb:function(){return M},vr:function(){return _}});var o,r,a,i,s,l,c,d=n(8079),p=n(2723),v=n(1361),u=n(1171),h=n(9249),f=n(7371),g=n(5754),y=n(6906),m=n(9242),x=n(5378),b=n(11),w=n(4545),k=n(7244),S=n(7236),Z=n(3022),z=n(2742),C=n(2292),j=n(4673),D=n(5607),I=[(0,m.iv)(o||(o=(0,u.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .people-list .people-person{--person-avatar-size:var(--people-person-avatar-size, 24px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .people-list .people-person{--person-avatar-size:var(--people-person-avatar-size, 24px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}\n'])))],T=n(9768),L=n(8097),N=function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},P=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},O=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))},_=function(){(0,T.yQ)(),(0,L.R)("people",M)},M=function(e){(0,g.Z)(n,e);var t=(0,y.Z)(n);function n(){var e;return(0,h.Z)(this,n),(e=t.call(this)).personCardInteraction=D.c.hover,e.version="v1.0",e.scopes=[],e._peoplePresence={},e._arrowKeyLocation=-1,e.renderContent=function(){return e.people&&0!==e.people.length?e.renderTemplate("default",{people:e.people,max:e.showMax})||e.renderPeople():e.renderNoData()},e.renderLoading=function(){return e.renderTemplate("loading",null)||(0,m.dy)(r||(r=(0,u.Z)([""])))},e.handleKeyDown=function(t){var n,o,r=e.shadowRoot.querySelector(".people-list"),a=null===r||void 0===r?void 0:r.children,i=(0,v.Z)(a);try{for(i.s();!(o=i.n()).done;){var s=o.value;s.setAttribute("tabindex","-1"),s.blur()}}catch(p){i.e(p)}finally{i.f()}var l=r.childElementCount,c=t.key;if("ArrowRight"===c)e._arrowKeyLocation=(e._arrowKeyLocation+1+l)%l;else if("ArrowLeft"===c)e._arrowKeyLocation=(e._arrowKeyLocation-1+l)%l;else if("Tab"===c||"Escape"===c)e._arrowKeyLocation=-1,r.blur();else if(["Enter","space"," "].includes(c)&&e.personCardInteraction!==D.c.none){var d=a[e._arrowKeyLocation].querySelector("mgt-person");d&&d.showPersonCard()}e._arrowKeyLocation>-1&&((n=a[e._arrowKeyLocation]).setAttribute("tabindex","1"),n.focus())},e.showMax=3,e}return(0,f.Z)(n,[{key:"clearState",value:function(){this.people=null}},{key:"args",value:function(){return[this.providerState,this.groupId,this.userIds,this.peopleQueries,this.showMax,this.resource,this.version,this.fallbackDetails]}},{key:"renderPeople",value:function(){var e=this,t=this.people.slice(0,this.showMax).filter((function(e){return e}));return(0,m.dy)(a||(a=(0,u.Z)(['\n      <ul\n        tabindex="0"\n        class="people-list"\n        aria-label="people"\n        @keydown=',">\n        ","\n        ","\n      </ul>\n    "])),this.handleKeyDown,(0,b.r)(t,(function(e){return e.id?e.id:e.displayName}),(function(t){return(0,m.dy)(i||(i=(0,u.Z)(['\n            <li tabindex="-1" class="people-person">\n              ',"\n            </li>\n          "])),e.renderPerson(t))})),this.people.length>this.showMax?this.renderOverflow():null)}},{key:"renderOverflow",value:function(){var e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||(0,m.dy)(s||(s=(0,u.Z)(['\n        <li tabindex="-1" aria-label="and ',' more attendees" class="overflow"><span>+',"</span></li>\n      "])),e,e)}},{key:"renderPerson",value:function(e){var t={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]);return this.renderTemplate("person",{person:e},e.id)||(0,Z.b)(l||(l=(0,u.Z)(['\n        <mgt-person\n          class="people-person"\n          .personDetails=',"\n          .fetchImage=","\n          .avatarSize=","\n          .personCardInteraction=","\n          .showPresence=","\n          .personPresence=","\n          .usage=","\n        ></mgt-person>\n      "])),e,!0,"small",this.personCardInteraction,this.showPresence,t,"people")}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||(0,m.dy)(c||(c=(0,u.Z)([""])))}},{key:"loadState",value:function(){return O(this,void 0,void 0,(0,p.Z)().mark((function e(){var t,n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.people){e.next=39;break}if(!(t=z.C.globalProvider)||t.state!==C.Aw.SignedIn){e.next=39;break}if(n=t.graph.forComponent(this),!this.groupId){e.next=10;break}return e.next=7,(0,S.V0)(n,null,this.groupId,this.showMax,w.bz.person);case 7:this.people=e.sent,e.next=32;break;case 10:if(!this.userIds&&!this.peopleQueries){e.next=23;break}if(!this.userIds){e.next=17;break}return e.next=14,(0,S.Qi)(n,this.userIds,"","",this.fallbackDetails);case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,(0,S.BD)(n,this.peopleQueries,this.fallbackDetails);case 19:e.t0=e.sent;case 20:this.people=e.t0,e.next=32;break;case 23:if(!this.resource){e.next=29;break}return e.next=26,(0,w.s8)(n,this.version,this.resource,this.scopes);case 26:this.people=e.sent,e.next=32;break;case 29:return e.next=31,(0,w.kH)(n);case 31:this.people=e.sent;case 32:if(!this.showPresence){e.next=38;break}return e.next=35,(0,k.G)(n,this.people);case 35:this._peoplePresence=e.sent,e.next=39;break;case 38:this._peoplePresence=null;case 39:case"end":return e.stop()}}),e,this)})))}}],[{key:"styles",get:function(){return I}},{key:"requiredScopes",get:function(){return(0,d.Z)(new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read"].concat((0,d.Z)(T.yI.requiredScopes))))}}]),n}(j.F);N([(0,x.Cb)({attribute:"group-id",type:String}),P("design:type",String)],M.prototype,"groupId",void 0),N([(0,x.Cb)({attribute:"user-ids",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),P("design:type",Array)],M.prototype,"userIds",void 0),N([(0,x.Cb)({attribute:"people",type:Object}),P("design:type",Array)],M.prototype,"people",void 0),N([(0,x.Cb)({attribute:"people-queries",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),P("design:type",Array)],M.prototype,"peopleQueries",void 0),N([(0,x.Cb)({attribute:"show-max",type:Number}),P("design:type",Number)],M.prototype,"showMax",void 0),N([(0,x.Cb)({attribute:"show-presence",type:Boolean}),P("design:type",Boolean)],M.prototype,"showPresence",void 0),N([(0,x.Cb)({attribute:"person-card",converter:function(e,t){return e=e.toLowerCase(),"undefined"===typeof D.c[e]?D.c.hover:D.c[e]}}),P("design:type",Number)],M.prototype,"personCardInteraction",void 0),N([(0,x.Cb)({attribute:"resource",type:String}),P("design:type",String)],M.prototype,"resource",void 0),N([(0,x.Cb)({attribute:"version",type:String}),P("design:type",Object)],M.prototype,"version",void 0),N([(0,x.Cb)({attribute:"scopes",converter:function(e){return e?e.toLowerCase().split(","):null},reflect:!0}),P("design:type",Array)],M.prototype,"scopes",void 0),N([(0,x.Cb)({attribute:"fallback-details",type:Array}),P("design:type",Array)],M.prototype,"fallbackDetails",void 0),N([(0,x.SB)(),P("design:type",Object)],M.prototype,"_arrowKeyLocation",void 0)},5871:function(e,t,n){n.d(t,{B:function(){return $}});var o,r,a,i,s,l,c,d,p,v,u,h,f,g,y=n(8079),m=n(2723),x=n(1171),b=n(9249),w=n(7371),k=n(3069),S=n(5058),Z=n(5754),z=n(6906),C=n(9242),j=n(5378),D=n(3022),I=n(2742),T=n(2292),L=n(4673),N=[(0,C.iv)(o||(o=(0,x.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--person-avatar-size:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--person-avatar-size:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}\n'])))],P=n(8556),O=n(8498),_=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))},M=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"calendars.read";return _(void 0,void 0,void 0,(0,m.Z)().mark((function o(){var r;return(0,m.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=e.api(t).middlewareOptions((0,P.z)(n)).orderby("start/dateTime"),o.abrupt("return",O.H.create(e,r));case 2:case"end":return o.stop()}}),o)})))},R=function(e,t,n,o){return _(void 0,void 0,void 0,(0,m.Z)().mark((function r(){var a,i,s;return(0,m.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a="startdatetime=".concat(t.toISOString()),i="enddatetime=".concat(n.toISOString()),s=o?"groups/".concat(o,"/calendar"):"me",s+="/calendarview?".concat(a,"&").concat(i),r.abrupt("return",M(e,s));case 5:case"end":return r.stop()}}),r)})))},A=n(4223),E=n(4612),B=n(6552),F=n(2572),H=n(457),U=n(8097),q=function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},Q=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},W=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))},K=function(e){(0,Z.Z)(n,e);var t=(0,z.Z)(n);function n(){var e;return(0,b.Z)(this,n),(e=t.apply(this,arguments)).days=3,e.renderContent=function(){if(!e.events||0===e.events.length)return e.renderNoData();var t=e.showMax&&e.showMax>0?e.events.slice(0,e.showMax):e.events,n=e.renderTemplate("default",{events:t});if(n)return n;var o={agenda:!0,grouped:e.groupByDay};return(0,C.dy)(r||(r=(0,x.Z)(["\n      <div dir=",' class="','">\n        ',"\n      </div>\n    "])),e.direction,(0,H.$)(o),e.groupByDay?e.renderGroups(t):e.renderEvents(t))},e.renderLoading=function(){return e.renderTemplate("loading",null)||(0,C.dy)(a||(a=(0,x.Z)(['\n        <fluent-card class="event event-loading">\n          <div class="event-time-container">\n            <div class="event-time-loading loading-element"></div>\n          </div>\n          <div class="event-details-container">\n            <div class="event-subject-loading loading-element"></div>\n            <div class="event-location-container">\n              <div class="event-location-icon-loading loading-element"></div>\n              <div class="event-location-loading loading-element"></div>\n            </div>\n            <div class="event-location-container">\n              <div class="event-attendee-loading loading-element"></div>\n              <div class="event-attendee-loading loading-element"></div>\n              <div class="event-attendee-loading loading-element"></div>\n            </div>\n          </div>\n        </fluent-card>'])))},e.onResize=function(){e._isNarrow=e.offsetWidth<600},e}return(0,w.Z)(n,[{key:"connectedCallback",value:function(){this._isNarrow=this.offsetWidth<600,(0,k.Z)((0,S.Z)(n.prototype),"connectedCallback",this).call(this),window.addEventListener("resize",this.onResize)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("resize",this.onResize),(0,k.Z)((0,S.Z)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"reload",value:function(){return W(this,void 0,void 0,(0,m.Z)().mark((function e(){return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadEvents();case 2:this.events=e.sent;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"clearState",value:function(){this.events=null}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||(0,C.dy)(i||(i=(0,x.Z)([""])))}},{key:"renderEvent",value:function(e){this._isNarrow=this.offsetWidth<600;var t={narrow:this._isNarrow};return(0,C.dy)(s||(s=(0,x.Z)(['\n      <fluent-card class="','">\n        <div class="','">\n          <div class="event-time" aria-label="','">','</div>\n        </div>\n        <div class="','">\n          '," "," ",'\n        </div>\n        <div class="event-other-container">',"</div>\n      </fluent-card>\n    "])),(0,H.$)(Object.assign({event:!0},t)),(0,H.$)(Object.assign({"event-time-container":!0},t)),this.getEventTimeString(e),this.getEventTimeString(e),(0,H.$)(Object.assign({"event-details-container":!0},t)),this.renderTitle(e),this.renderLocation(e),this.renderAttendees(e),this.renderOther(e))}},{key:"renderHeader",value:function(e){return this.renderTemplate("header",{header:e},"header-"+e)||(0,C.dy)(l||(l=(0,x.Z)(['\n        <div class="header" aria-label="','">',"</div>\n      "])),e,e)}},{key:"renderTitle",value:function(e){return(0,C.dy)(c||(c=(0,x.Z)(["\n      <div\n        aria-label=",'\n        class="','"\n      >\n        ',"\n      </div>"])),e.subject,(0,H.$)({"event-subject":!0,narrow:this._isNarrow}),e.subject)}},{key:"renderLocation",value:function(e){return e.location.displayName?(0,C.dy)(d||(d=(0,x.Z)(['\n      <div class="event-location-container">\n        <div class="event-location-icon">','</div>\n        <div class="event-location" aria-label="','">',"</div>\n      </div>\n    "])),(0,A.d)(A.l.OfficeLocation),e.location.displayName,e.location.displayName):null}},{key:"renderAttendees",value:function(e){return e.attendees.length?(0,D.b)(p||(p=(0,x.Z)(['\n      <mgt-people\n        show-max="5"\n        show-presence\n        class="event-attendees"\n        .peopleQueries=',"\n      ></mgt-people>\n    "])),e.attendees.map((function(e){return e.emailAddress.address}))):null}},{key:"renderOther",value:function(e){return this.hasTemplate("event-other")?(0,C.dy)(v||(v=(0,x.Z)(["\n          ","\n        "])),this.renderTemplate("event-other",{event:e},e.id+"-other")):null}},{key:"renderGroups",value:function(e){var t=this,n={};return e.forEach((function(e){var o,r=null===(o=null===e||void 0===e?void 0:e.start)||void 0===o?void 0:o.dateTime;"UTC"===e.end.timeZone&&(r+="Z");var a=t.getDateHeaderFromDateTimeString(r);n[a]=n[a]||[],n[a].push(e)})),(0,C.dy)(u||(u=(0,x.Z)(["\n      ","\n    "])),Object.keys(n).map((function(e){return(0,C.dy)(h||(h=(0,x.Z)(['\n            <div class="group">'," ","</div>\n          "])),t.renderHeader(e),t.renderEvents(n[e]))})))}},{key:"renderEvents",value:function(e){var t=this;return(0,C.dy)(f||(f=(0,x.Z)(["\n        ",""])),e.map((function(e){return(0,C.dy)(g||(g=(0,x.Z)(['\n              <div\n                class="event-container"\n                tabindex="0"\n                @focus=',">\n                ","\n              </div>"])),(function(){return t.eventClicked(e)}),t.renderTemplate("event",{event:e},e.id)||t.renderEvent(e))})))}},{key:"args",value:function(){return[this.providerState,this.preferredTimezone,this.eventQuery,this.date,this.groupId,this.days]}},{key:"loadState",value:function(){return W(this,void 0,void 0,(0,m.Z)().mark((function e(){var t;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.events){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadEvents();case 4:(null===(t=e.sent)||void 0===t?void 0:t.length)>0&&(this.events=t);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"eventClicked",value:function(e){this.fireCustomEvent("eventClick",e)}},{key:"getEventTimeString",value:function(e){if(e.isAllDay)return"ALL DAY";var t=e.start.dateTime;"UTC"===e.start.timeZone&&(t+="Z");var n=e.end.dateTime;"UTC"===e.end.timeZone&&(n+="Z");var o=this.prettyPrintTimeFromDateTime(new Date(t)),r=this.prettyPrintTimeFromDateTime(new Date(n));return"".concat(o," - ").concat(r)}},{key:"loadEvents",value:function(){return W(this,void 0,void 0,(0,m.Z)().mark((function e(){var t,n,o,r,a,i,s,l,c,d;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=I.C.globalProvider,n=[],(null===t||void 0===t?void 0:t.state)!==T.Aw.SignedIn){e.next=44;break}if(o=t.graph.forComponent(this),!this.eventQuery){e.next=25;break}return e.prev=5,(r=this.eventQuery.split("|")).length>1?(i=r[0].trim(),a=r[1].trim()):i=this.eventQuery,e.next=10,M(o,i,a);case 10:if(!(null===(s=e.sent)||void 0===s?void 0:s.value)){e.next=19;break}n=s.value;case 13:if(!s.hasNext){e.next=19;break}return e.next=16,s.next();case 16:n=s.value,e.next=13;break;case 19:e.next=23;break;case 21:e.prev=21,e.t0=e.catch(5);case 23:e.next=44;break;case 25:return l=this.date?new Date(this.date):new Date,(c=new Date(l.getTime())).setDate(l.getDate()+this.days),e.prev=28,e.next=31,R(o,l,c,this.groupId);case 31:if(!(null===(d=e.sent)||void 0===d?void 0:d.value)){e.next=40;break}n=d.value;case 34:if(!d.hasNext){e.next=40;break}return e.next=37,d.next();case 37:n=d.value,e.next=34;break;case 40:e.next=44;break;case 42:e.prev=42,e.t1=e.catch(28);case 44:return e.abrupt("return",n);case 45:case"end":return e.stop()}}),e,this,[[5,21],[28,42]])})))}},{key:"prettyPrintTimeFromDateTime",value:function(e){return e.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}},{key:"getDateHeaderFromDateTimeString",value:function(e){return new Date(e).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}}],[{key:"styles",get:function(){return N}},{key:"requiredScopes",get:function(){return(0,y.Z)(new Set(["calendars.read"].concat((0,y.Z)(E.Mb.requiredScopes))))}}]),n}(L.F);q([(0,j.Cb)({attribute:"date",type:String}),Q("design:type",String)],K.prototype,"date",void 0),q([(0,j.Cb)({attribute:"group-id",type:String}),Q("design:type",String)],K.prototype,"groupId",void 0),q([(0,j.Cb)({attribute:"days",type:Number}),Q("design:type",Object)],K.prototype,"days",void 0),q([(0,j.Cb)({attribute:"event-query",type:String}),Q("design:type",String)],K.prototype,"eventQuery",void 0),q([(0,j.Cb)({attribute:"events",type:Array,hasChanged:function(e,t){return e!==t}}),Q("design:type",Array)],K.prototype,"events",void 0),q([(0,j.Cb)({attribute:"show-max",type:Number}),Q("design:type",Number)],K.prototype,"showMax",void 0),q([(0,j.Cb)({attribute:"group-by-day",type:Boolean}),Q("design:type",Boolean)],K.prototype,"groupByDay",void 0),q([(0,j.Cb)({attribute:"preferred-timezone",type:String}),Q("design:type",String)],K.prototype,"preferredTimezone",void 0),q([(0,j.Cb)({attribute:!1}),Q("design:type",Boolean)],K.prototype,"_isNarrow",void 0);var $=(0,n(7908).$)("agenda",(function(){(0,B.J)(F.ay),(0,E.vr)(),(0,U.R)("agenda",K)}))},1166:function(e,t,n){n.d(t,{d:function(){return r}});var o=n(7724),r=(0,n(7908).$)("get",o.xV)},8667:function(e,t,n){n.d(t,{$:function(){return r}});var o=n(1734),r=(0,n(7908).$)("spinner",o.Y)}}]);
//# sourceMappingURL=959.96fb9d09.chunk.js.map