"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[151],{7151:function(e,t,o){o.d(t,{C:function(){return P}});var r,n,i,a,l=o(2723),s=o(1171),c=o(9249),d=o(7371),p=o(5754),u=o(6906),h=o(9242),f=o(5378),v=o(3152),m=o(3022),y=o(253),g={comboboxPlaceholder:"Select an item"},b=o(9932),k=o(7788),x=o(6552),S=o(7724),C=[(0,h.iv)(r||(r=(0,s.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'])))],R=o(8097),w=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},T=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Z=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function l(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},P=function(){(0,x.J)(b.ee,k.P),(0,S.xV)(),(0,R.R)("picker",j)},j=function(e){(0,p.Z)(o,e);var t=(0,u.Z)(o);function o(){var e;return(0,c.Z)(this,o),(e=t.call(this)).version="v1.0",e.maxPages=3,e.scopes=[],e.cacheEnabled=!1,e.cacheInvalidationPeriod=0,e.handleComboboxKeydown=function(t){var o,r,n=t.key,i=t.target.querySelector(".selected");i&&(o=i.getAttribute("value")),"Enter"===n&&o&&(r=e.response.filter((function(e){return e.id===o})).pop(),e.fireCustomEvent("selectionChanged",r,!0,!1,!0))},e.placeholder=e.strings.comboboxPlaceholder,e.entityType=null,e.keyName=null,e.isRefreshing=!1,e}return(0,d.Z)(o,[{key:"strings",get:function(){return g}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}},{key:"clearState",value:function(){this.response=null,this.error=null}},{key:"render",value:function(){var e;if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.hasTemplate("error")){var t=this.error?this.error:null;return this.renderTemplate("error",{error:t},"error")}return this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(null===(e=this.response)||void 0===e?void 0:e.length)>0?this.renderPicker():this.renderGet()}},{key:"renderPicker",value:function(){var e=this;return(0,m.b)(n||(n=(0,s.Z)(["\n      <fluent-combobox\n        @keydown=","\n        current-value=",'\n        part="picker"\n        class="picker"\n        id="combobox"\n        autocomplete="list"\n        placeholder=',">\n          ","\n      </fluent-combobox>\n     "])),this.handleComboboxKeydown,(0,v.o)(this.selectedValue),this.placeholder,this.response.map((function(t){return(0,h.dy)(i||(i=(0,s.Z)(["\n            <fluent-option value="," @click=","> "," </fluent-option>"])),t.id,(function(o){return e.handleClick(o,t)}),t[e.keyName])})))}},{key:"renderGet",value:function(){return(0,m.b)(a||(a=(0,s.Z)(['\n      <mgt-get\n        class="mgt-get"\n        resource=',"\n        version=","\n        .scopes=","\n        max-pages=","\n        ?cache-enabled=","\n        ?cache-invalidation-period=",">\n      </mgt-get>"])),this.resource,this.version,this.scopes,this.maxPages,this.cacheEnabled,this.cacheInvalidationPeriod)}},{key:"loadState",value:function(){return Z(this,void 0,void 0,(0,l.Z)().mark((function e(){var t,o=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.response||((t=this.renderRoot.querySelector(".mgt-get"))?t.addEventListener("dataChange",(function(e){return o.handleDataChange(e)})):console.error("\ud83e\udd92: mgt-picker component requires a child mgt-get component. Something has gone horribly wrong.")),this.isRefreshing=!1,e.next=4,Promise.resolve();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"handleDataChange",value:function(e){var t=e.detail.response.value,o=e.detail.error?e.detail.error:null;this.response=t,this.error=o}},{key:"handleClick",value:function(e,t){this.fireCustomEvent("selectionChanged",t,!0,!1,!0)}}],[{key:"styles",get:function(){return C}}]),o}(y.h);w([(0,f.Cb)({attribute:"resource",type:String}),T("design:type",String)],j.prototype,"resource",void 0),w([(0,f.Cb)({attribute:"version",type:String}),T("design:type",Object)],j.prototype,"version",void 0),w([(0,f.Cb)({attribute:"max-pages",type:Number}),T("design:type",Object)],j.prototype,"maxPages",void 0),w([(0,f.Cb)({attribute:"placeholder",type:String}),T("design:type",String)],j.prototype,"placeholder",void 0),w([(0,f.Cb)({attribute:"key-name",type:String}),T("design:type",String)],j.prototype,"keyName",void 0),w([(0,f.Cb)({attribute:"entity-type",type:String}),T("design:type",String)],j.prototype,"entityType",void 0),w([(0,f.Cb)({attribute:"scopes",converter:function(e){return e?e.toLowerCase().split(","):null}}),T("design:type",Array)],j.prototype,"scopes",void 0),w([(0,f.Cb)({attribute:"cache-enabled",type:Boolean}),T("design:type",Object)],j.prototype,"cacheEnabled",void 0),w([(0,f.Cb)({attribute:"cache-invalidation-period",type:Number}),T("design:type",Object)],j.prototype,"cacheInvalidationPeriod",void 0),w([(0,f.Cb)({attribute:"selected-value",type:String}),T("design:type",String)],j.prototype,"selectedValue",void 0),w([(0,f.SB)(),T("design:type",Array)],j.prototype,"response",void 0)},253:function(e,t,o){o.d(t,{h:function(){return b}});var r,n,i=o(1171),a=o(9249),l=o(7371),s=o(3069),c=o(5058),d=o(5754),p=o(6906),u=o(5378),h=o(9242),f=o(8402),v=o(8158),m=o(8028),y=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(e){(0,d.Z)(o,e);var t=(0,p.Z)(o);function o(){var e;return(0,a.Z)(this,o),(e=t.call(this)).templates={},e._renderedSlots=!1,e._renderedTemplates={},e._slotNamesAddedDuringRender=[],e.templateContext=e.templateContext||{},e}return(0,l.Z)(o,[{key:"update",value:function(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],(0,s.Z)((0,c.Z)(o.prototype),"update",this).call(this,e)}},{key:"updated",value:function(e){(0,s.Z)((0,c.Z)(o.prototype),"updated",this).call(this,e),this.removeUnusedSlottedElements()}},{key:"renderTemplate",value:function(e,t,o){if(!this.hasTemplate(e))return null;o=o||e,this._slotNamesAddedDuringRender.push(o),this._renderedSlots=!0;var n=(0,h.dy)(r||(r=(0,i.Z)(["\n      <slot name=","></slot>\n    "])),o),a=Object.assign(Object.assign({},t),this.templateContext);if(Object.prototype.hasOwnProperty.call(this._renderedTemplates,o)){var l=this._renderedTemplates[o],s=l.context,c=l.slot;if((0,f.f)(s,a))return n;this.removeChild(c)}var d=document.createElement("div");d.slot=o,d.dataset.generated="template",m.p.renderTemplate(d,this.templates[e],a),this.appendChild(d),this._renderedTemplates[o]={context:a,slot:d};var p={templateType:e,context:a,element:d};return this.fireCustomEvent("templateRendered",p),n}},{key:"hasTemplate",value:function(e){var t;return Boolean(null===(t=this.templates)||void 0===t?void 0:t[e])}},{key:"getTemplates",value:function(){for(var e={},t=0;t<this.children.length;t++){var o=this.children[t];if("TEMPLATE"===o.nodeName){var r=o;r.dataset.type?e[r.dataset.type]=r:e.default=r,r.templateOrder=t}}return e}},{key:"renderError",value:function(){return this.hasTemplate("error")?this.renderTemplate("error",this.error):(0,h.dy)(n||(n=(0,i.Z)(['\n      <div class="error">\n        ',"\n      </div>\n    "])),this.error)}},{key:"removeUnusedSlottedElements",value:function(){var e;if(this._renderedSlots){for(var t=0;t<this.children.length;t++){var o=this.children[t];(null===(e=o.dataset)||void 0===e?void 0:e.generated)&&!this._slotNamesAddedDuringRender.includes(o.slot)&&(this.removeChild(o),delete this._renderedTemplates[o.slot],t--)}this._renderedSlots=!1}}}]),o}(v.b);y([(0,u.Cb)({attribute:!1}),g("design:type",Object)],b.prototype,"templateContext",void 0),y([(0,u.SB)(),g("design:type",Object)],b.prototype,"error",void 0)}}]);
//# sourceMappingURL=151.27391253.chunk.js.map