"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[915],{6823:function(e,t,i){i.d(t,{_:function(){return he},K:function(){return fe}});var o,l,n,r,a,s,d,c,u,p,f,h=i(2723),g=i(1361),v=i(8079),m=i(1171),b=i(9249),x=i(7371),y=i(3069),k=i(5058),w=i(5754),F=i(6906),S=i(2742),I=i(3022),U=i(2292),L=i(4673),z=i(9242),_=i(5378),C=i(11),P=i(7425),Z=i(4223),E=i(9251),T=[(0,z.iv)(o||(o=(0,m.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}\n'])))],R={showMoreSubtitle:"Show more items",filesSectionTitle:"Files",sharedTextSubtitle:"Shared"},B=i(8382),A=i(4622),O=i(9576),D=i(7940),q=i(768),M=i(8158),j=i(457),N=i(6552),Q=i(9698),G=[(0,z.iv)(l||(l=(0,m.Z)(["\n:host .file-upload-area-button{width:auto;display:flex;align-items:end;justify-content:end;margin-inline-end:36px;margin-top:30px}:host fluent-button .upload-icon path{fill:var(--file-upload-button-text-color,var(--foreground-on-accent-rest))}:host fluent-button.file-upload-button::part(control){border:var(--file-upload-button-border,none);background:var(--file-upload-button-background-color,var(--accent-fill-rest))}:host fluent-button.file-upload-button::part(control):hover{background:var(--file-upload-button-background-color-hover,var(--accent-fill-hover))}:host fluent-button.file-upload-button .upload-text{color:var(--file-upload-button-text-color,var(--foreground-on-accent-rest));font-weight:400;line-height:20px}:host input{display:none}:host fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host fluent-dialog::part(overlay){opacity:.5}:host fluent-dialog::part(control){--dialog-width:$file-upload-dialog-width;--dialog-height:$file-upload-dialog-height;padding:var(--file-upload-dialog-padding,24px);border:var(--file-upload-dialog-border,1px solid var(--neutral-fill-rest))}:host fluent-dialog .file-upload-dialog-ok{background:var(--file-upload-dialog-keep-both-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-keep-both-button-border,none);color:var(--file-upload-dialog-keep-both-button-text-color,var(--foreground-on-accent-rest))}:host fluent-dialog .file-upload-dialog-ok:hover{background:var(--file-upload-dialog-keep-both-button-background-color-hover,var(--accent-fill-hover))}:host fluent-dialog .file-upload-dialog-cancel{background:var(--file-upload-dialog-replace-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-replace-button-border,1px solid var(--neutral-foreground-rest));color:var(--file-upload-dialog-replace-button-text-color,var(--neutral-foreground-rest))}:host fluent-dialog .file-upload-dialog-cancel:hover{background:var(--file-upload-dialog-replace-button-background-color-hover,var(--accent-fill-hover))}:host fluent-checkbox{margin-top:12px}:host fluent-checkbox .file-upload-dialog-check{color:var(--file-upload-dialog-text-color,--foreground-on-accent-rest)}:host .file-upload-table{display:flex}:host .file-upload-table.upload{display:flex}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell.percent-indicator{padding-inline-start:10px}:host .file-upload-table .file-upload-cell .description{opacity:.5;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:28px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-inline-start:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .mgt-file-item{--file-background-color:transparent;--file-padding:0 12px;--file-padding-inline-start:24px}:host .file-upload-template{clear:both}:host .file-upload-template .file-upload-folder-tab{padding-inline-start:20px}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-background-color,var(--accent-fill-rest));color:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{display:flex;align-items:end;justify-content:end;gap:5px}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));padding-right:5px}:host .file-upload-dialog.visible{display:block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{cursor:pointer;opacity:.5}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border-drag,1px dashed #0078d4);background-color:var(--file-upload-background-color-drag,rgba(0,120,212,.1));position:absolute;inset:0;z-index:1;display:inline-block}[dir=rtl] :host .file-upload-status{left:0;right:28px}\n"])))],V={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep both",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep both files?',uploadButtonLabel:"File upload button"},W=i(8097),K=function(e,t,i,o){var l,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(l=e[a])&&(r=(n<3?l(r):n>3?l(t,i,r):l(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},H=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},$=function(e,t,i,o){return new(i||(i=Promise))((function(l,n){function r(e){try{s(o.next(e))}catch(t){n(t)}}function a(e){try{s(o.throw(e))}catch(t){n(t)}}function s(e){var t;e.done?l(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}s((o=o.apply(e,t||[])).next())}))},J=function(e){return e.isDirectory},Y=function(e){return"getAsEntry"in e&&"function"===typeof e.getAsEntry},X=function(e){(0,w.Z)(i,e);var t=(0,F.Z)(i);function i(){var e;return(0,b.Z)(this,i),(e=t.call(this))._dragCounter=0,e._maxChunkSize=4194304,e._dialogTitle="",e._dialogContent="",e._dialogPrimaryButton="",e._dialogSecondaryButton="",e._dialogCheckBox="",e._applyAll=!1,e._applyAllConflictBehavior=null,e._maximumFileSize=!1,e._excludedFileType=!1,e.onFileUploadChange=function(t){var i=t.target;!t||i.files.length<1||e.readUploadedFiles(i.files,(function(){return i.value=null}))},e.onFileUploadClick=function(){e.renderRoot.querySelector("#file-upload-input").click()},e.handleonDragOver=function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.items&&t.dataTransfer.items.length>0&&(t.dataTransfer.dropEffect=t.dataTransfer.dropEffect=e._dropEffect)},e.handleonDragEnter=function(t){(t.preventDefault(),t.stopPropagation(),e._dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0)&&(t.dataTransfer.dropEffect=e._dropEffect,e.renderRoot.querySelector("#file-upload-border").classList.add("visible"))},e.handleonDragLeave=function(t){(t.preventDefault(),t.stopPropagation(),e._dragCounter--,0===e._dragCounter)&&e.renderRoot.querySelector("#file-upload-border").classList.remove("visible")},e.handleonDrop=function(t){var i;t.preventDefault(),t.stopPropagation();e.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),(null===(i=t.dataTransfer)||void 0===i?void 0:i.items)&&e.readUploadedFiles(t.dataTransfer.items,(function(){t.dataTransfer.clearData()})),e._dragCounter=0},e.filesToUpload=[],e}return(0,x.Z)(i,[{key:"strings",get:function(){return V}},{key:"_dropEffect",get:function(){return"copy"}},{key:"render",value:function(){if(null!==this.parentElement){var e=this.parentElement;e.addEventListener("dragenter",this.handleonDragEnter),e.addEventListener("dragleave",this.handleonDragLeave),e.addEventListener("dragover",this.handleonDragOver),e.addEventListener("drop",this.handleonDrop)}return(0,z.dy)(n||(n=(0,m.Z)(['\n        <div id="file-upload-dialog" class="file-upload-dialog">\n          \x3c!-- Modal content --\x3e\n          <fluent-dialog modal="true" class="file-upload-dialog-content">\n            <span\n              class="file-upload-dialog-close"\n              id="file-upload-dialog-close">\n                ','\n            </span>\n            <div class="file-upload-dialog-content-text">\n              <h2 class="file-upload-dialog-title">',"</h2>\n              <div>",'</div>\n                <fluent-checkbox\n                  id="file-upload-dialog-check"\n                  class="file-upload-dialog-check">\n                    ','\n                </fluent-checkbox>\n            </div>\n            <div class="file-upload-dialog-editor">\n              <fluent-button\n                appearance="accent"\n                class="file-upload-dialog-ok">\n                ','\n              </fluent-button>\n              <fluent-button\n                appearance="outline"\n                class="file-upload-dialog-cancel">\n                ','\n              </fluent-button>\n            </div>\n          </fluent-dialog>\n        </div>\n        <div id="file-upload-border"></div>\n        <div class="file-upload-area-button">\n          <input\n            id="file-upload-input"\n            title="','"\n            tabindex="-1"\n            aria-label="file upload input"\n            type="file"\n            multiple\n            @change="','"\n          />\n          <fluent-button\n            appearance="accent"\n            class="file-upload-button"\n            @click=',"\n            label=",'>\n              <span slot="start">','</span>\n              <span class="upload-text">','</span>\n          </fluent-button>\n        </div>\n        <div class="file-upload-template">\n          ',"\n        </div>\n       "])),(0,Z.d)(Z.l.Cancel),this._dialogTitle,this._dialogContent,this._dialogCheckBox,this._dialogPrimaryButton,this._dialogSecondaryButton,this.strings.uploadButtonLabel,this.onFileUploadChange,this.onFileUploadClick,this.strings.uploadButtonLabel,(0,Z.d)(Z.l.Upload),this.strings.buttonUploadFile,this.renderFolderTemplate(this.filesToUpload))}},{key:"renderFolderTemplate",value:function(e){var t=this,i=[];if(e.length>0){var o=e.map((function(e){return-1===i.indexOf(e.fullPath.substring(0,e.fullPath.lastIndexOf("/")))?e.fullPath.endsWith("/")?(0,z.dy)(a||(a=(0,m.Z)(["",""])),t.renderFileTemplate(e,"")):(i.push(e.fullPath.substring(0,e.fullPath.lastIndexOf("/"))),(0,I.b)(r||(r=(0,m.Z)(["\n            <div class='file-upload-table'>\n              <div class='file-upload-cell'>\n                <mgt-file\n                  .fileDetails=","\n                  .view=",'\n                  class="mgt-file-item">\n                </mgt-file>\n              </div>\n            </div>\n            ',""])),{name:e.fullPath.substring(1,e.fullPath.lastIndexOf("/")),folder:"Folder"},E.b.oneline,t.renderFileTemplate(e,"file-upload-folder-tab"))):(0,z.dy)(s||(s=(0,m.Z)(["",""])),t.renderFileTemplate(e,"file-upload-folder-tab"))}));return(0,z.dy)(d||(d=(0,m.Z)(["",""])),o)}return(0,z.dy)(c||(c=(0,m.Z)([""])))}},{key:"renderFileTemplate",value:function(e,t){var i=(0,j.$)({"file-upload-table":!0,upload:e.completed}),o=t+("lastModifiedDateTime"===e.fieldUploadResponse?" file-upload-dialog-success":""),l=(0,j.$)({description:"description"===e.fieldUploadResponse}),n=e.completed?(0,z.dy)(u||(u=(0,m.Z)([""]))):this.renderFileUploadTemplate(e);return(0,I.b)(p||(p=(0,m.Z)(['\n        <div class="','">\n          <div class="',"\">\n            <div class='file-upload-cell'>\n              <div class=\"",'">\n                <div class="file-upload-status">\n                  ',"\n                </div>\n                <mgt-file\n                  .fileDetails=","\n                  .view=","\n                  .line2Property=",'\n                  part="upload"\n                  class="mgt-file-item">\n                </mgt-file>\n              </div>\n            </div>\n              ',"\n            </div>\n          </div>\n        </div>"])),i,o,l,e.iconStatus,e.driveItem,e.view,e.fieldUploadResponse,n)}},{key:"renderFileUploadTemplate",value:function(e){var t=this,i=(0,j.$)({"file-upload-table":!0,upload:e.completed});return(0,z.dy)(f||(f=(0,m.Z)(["\n    <div class='file-upload-cell'>\n      <div class='file-upload-table file-upload-name'>\n        <div class='file-upload-cell'>\n          <div\n            title=\"","\"\n            class='file-upload-filename'>\n            ","\n          </div>\n        </div>\n      </div>\n      <div class='file-upload-table'>\n        <div class='file-upload-cell'>\n          <div class=\"",'">\n            <fluent-progress class="file-upload-bar" value="',"\"></fluent-progress>\n            <div class='file-upload-cell percent-indicator'>\n              <span>",'%</span>\n              <span\n                class="file-upload-cancel"\n                @click=',">\n                ","\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    "])),e.file.name,e.file.name,i,e.percent,e.percent,(function(){return t.deleteFileUploadSession(e)}),(0,Z.d)(Z.l.Cancel))}},{key:"deleteFileUploadSession",value:function(e){return $(this,void 0,void 0,(0,h.Z)().mark((function t(){return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,void 0===e.uploadUrl){t.next=9;break}return t.next=4,(0,P.Ew)(this.fileUploadList.graph,e.uploadUrl);case 4:e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,V.cancelUploadFile),t.next=12;break;case 9:e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,V.cancelUploadFile);case 12:t.next=19;break;case 14:t.prev=14,t.t0=t.catch(0),e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,V.cancelUploadFile);case 19:case"end":return t.stop()}}),t,this,[[0,14]])})))}},{key:"readUploadedFiles",value:function(e,t){return $(this,void 0,void 0,(0,h.Z)().mark((function i(){var o;return(0,h.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.getFilesFromUploadArea(e);case 2:return o=i.sent,i.next=5,this.getSelectedFiles(o);case 5:t();case 6:case"end":return i.stop()}}),i,this)})))}},{key:"getSelectedFiles",value:function(e){return $(this,void 0,void 0,(0,h.Z)().mark((function t(){var i,o,l,n,r,a,s,d=this;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=[],l=[],this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach((function(e){e.completed?l.push(e):o.push(e)})),n=(0,g.Z)(e),t.prev=8,a=(0,h.Z)().mark((function e(){var t,i,l,n,a,s,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.value,i=""===t.fullPath?"/"+t.name:t.fullPath,0!==o.filter((function(e){return e.fullPath===i})).length){e.next=28;break}if(l=!0,void 0===d.fileUploadList.maxFileSize||!l){e.next=12;break}if(!(t.size>1024*d.fileUploadList.maxFileSize)){e.next=12;break}if(l=!1,!1!==d._maximumFileSize){e.next=12;break}return e.next=10,d.getFileUploadStatus(t,i,"MaxFileSize",d.fileUploadList);case 10:null!==(n=e.sent)&&1===n[0]&&(d._maximumFileSize=!0);case 12:if(void 0===d.fileUploadList.excludedFileExtensions){e.next=21;break}if(!(d.fileUploadList.excludedFileExtensions.length>0&&l)){e.next=21;break}if(!(d.fileUploadList.excludedFileExtensions.filter((function(e){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1})).length>0)){e.next=21;break}if(l=!1,!1!==d._excludedFileType){e.next=21;break}return e.next=19,d.getFileUploadStatus(t,i,"ExcludedFileType",d.fileUploadList);case 19:null!==(a=e.sent)&&1===a[0]&&(d._excludedFileType=!0);case 21:if(!l){e.next=28;break}return e.next=24,d.getFileUploadStatus(t,i,"Upload",d.fileUploadList);case 24:s=e.sent,c=!1,null!==s&&(-1===s[0]?c=!0:(d._applyAll=Boolean(s[0]),d._applyAllConflictBehavior=s[1]?1:0)),o.push({file:t,driveItem:{name:t.name},fullPath:i,conflictBehavior:null!==s?s[1]?1:0:null,iconStatus:null,percent:1,view:E.b.image,completed:c,maxSize:d._maxChunkSize,minSize:0});case 28:case"end":return e.stop()}}),e)})),n.s();case 11:if((r=n.n()).done){t.next=15;break}return t.delegateYield(a(),"t0",13);case 13:t.next=11;break;case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(8),n.e(t.t1);case 20:return t.prev=20,n.f(),t.finish(20);case 23:return(o=o.sort((function(e,t){return e.fullPath.substring(0,e.fullPath.lastIndexOf("/")).localeCompare(t.fullPath.substring(0,t.fullPath.lastIndexOf("/")))}))).forEach((function(e){if(0!==l.filter((function(t){return t.fullPath===e.fullPath})).length){var t=l.findIndex((function(t){return t.fullPath===e.fullPath}));l.splice(t,1)}})),(i=o).push.apply(i,l),this.filesToUpload=o,s=this.filesToUpload.map((function(e){return d.sendFileItemGraph(e)})),t.next=30,Promise.all(s);case 30:case"end":return t.stop()}}),t,this,[[8,17,20,23]])})))}},{key:"getFileUploadStatus",value:function(e,t,o,l){var n=this,r=Object.create(null,{requestStateUpdate:{get:function(){return(0,y.Z)((0,k.Z)(i.prototype),"requestStateUpdate",n)}}});return $(this,void 0,void 0,(0,h.Z)().mark((function i(){var n,a=this;return(0,h.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=this.renderRoot.querySelector("#file-upload-dialog"),i.t0=o,i.next="Upload"===i.t0?4:"ExcludedFileType"===i.t0?23:"MaxFileSize"===i.t0?32:41;break;case 4:return i.next=6,(0,P.iD)(this.fileUploadList.graph,"".concat(this.getGrapQuery(t),"?$select=id"));case 6:if(null===i.sent){i.next=21;break}if(!0!==this._applyAll){i.next=10;break}return i.abrupt("return",[this._applyAll,this._applyAllConflictBehavior]);case 10:return n.classList.add("visible"),this._dialogTitle=V.fileReplaceTitle,this._dialogContent=V.fileReplace.replace("{FileName}",e.name),this._dialogCheckBox=V.checkApplyAll,this._dialogPrimaryButton=V.buttonReplace,this._dialogSecondaryButton=V.buttonKeep,i.next=18,r.requestStateUpdate.call(this,!0);case 18:return i.abrupt("return",new Promise((function(e){var t=a.renderRoot.querySelector(".file-upload-dialog-close"),i=a.renderRoot.querySelector(".file-upload-dialog-ok"),o=a.renderRoot.querySelector(".file-upload-dialog-cancel"),l=a.renderRoot.querySelector("#file-upload-dialog-check");l.checked=!1,l.classList.remove("hide");var r=function(){n.classList.remove("visible"),e([l.checked?1:0,1])},s=function(){n.classList.remove("visible"),e([l.checked?1:0,0])},d=function(){n.classList.remove("visible"),e([-1])};i.removeEventListener("click",r),o.removeEventListener("click",s),t.removeEventListener("click",d),i.addEventListener("click",r),o.addEventListener("click",s),t.addEventListener("click",d)})));case 21:return i.abrupt("return",null);case 22:case 41:return i.abrupt("break",42);case 23:return n.classList.add("visible"),this._dialogTitle=V.fileTypeTitle,this._dialogContent=V.fileType.replace("{FileName}",e.name)+" ("+l.excludedFileExtensions.join(",")+")",this._dialogCheckBox=V.checkAgain,this._dialogPrimaryButton=V.buttonOk,this._dialogSecondaryButton=V.buttonCancel,i.next=31,r.requestStateUpdate.call(this,!0);case 31:return i.abrupt("return",new Promise((function(e){var t=a.renderRoot.querySelector(".file-upload-dialog-ok"),i=a.renderRoot.querySelector(".file-upload-dialog-cancel"),o=a.renderRoot.querySelector(".file-upload-dialog-close"),l=a.renderRoot.querySelector("#file-upload-dialog-check");l.checked=!1,l.classList.remove("hide");var r=function(){n.classList.remove("visible"),e([l.checked?1:0])},s=function(){n.classList.remove("visible"),e([0])};t.removeEventListener("click",r),i.removeEventListener("click",s),o.removeEventListener("click",s),t.addEventListener("click",r),i.addEventListener("click",s),o.addEventListener("click",s)})));case 32:return n.classList.add("visible"),this._dialogTitle=V.maximumFileSizeTitle,this._dialogContent=V.maximumFileSize.replace("{FileSize}",(0,Q.td)(1024*l.maxFileSize)).replace("{FileName}",e.name)+(0,Q.td)(e.size)+".",this._dialogCheckBox=V.checkAgain,this._dialogPrimaryButton=V.buttonOk,this._dialogSecondaryButton=V.buttonCancel,i.next=40,r.requestStateUpdate.call(this,!0);case 40:return i.abrupt("return",new Promise((function(e){var t=a.renderRoot.querySelector(".file-upload-dialog-ok"),i=a.renderRoot.querySelector(".file-upload-dialog-cancel"),o=a.renderRoot.querySelector(".file-upload-dialog-close"),l=a.renderRoot.querySelector("#file-upload-dialog-check");l.checked=!1,l.classList.remove("hide");var r=function(){n.classList.remove("visible"),e([l.checked?1:0])},s=function(){n.classList.remove("visible"),e([0])};t.removeEventListener("click",r),i.removeEventListener("click",s),o.removeEventListener("click",s),t.addEventListener("click",r),i.addEventListener("click",s),o.addEventListener("click",s)})));case 42:case"end":return i.stop()}}),i,this)})))}},{key:"getGrapQuery",value:function(e){var t="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(t=this.fileUploadList.itemPath.startsWith("/")?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?"/users/".concat(this.fileUploadList.userId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.userId&&this.fileUploadList.itemPath?"/users/".concat(this.fileUploadList.userId,"/drive/root:").concat(t).concat(e):this.fileUploadList.groupId&&this.fileUploadList.itemId?"/groups/".concat(this.fileUploadList.groupId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.groupId&&this.fileUploadList.itemPath?"/groups/".concat(this.fileUploadList.groupId,"/drive/root:").concat(t).concat(e):this.fileUploadList.driveId&&this.fileUploadList.itemId?"/drives/".concat(this.fileUploadList.driveId,"/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.driveId&&this.fileUploadList.itemPath?"/drives/".concat(this.fileUploadList.driveId,"/root:").concat(t).concat(e):this.fileUploadList.siteId&&this.fileUploadList.itemId?"/sites/".concat(this.fileUploadList.siteId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.siteId&&this.fileUploadList.itemPath?"/sites/".concat(this.fileUploadList.siteId,"/drive/root:").concat(t).concat(e):this.fileUploadList.itemId?"/me/drive/items/".concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.itemPath?"/me/drive/root:".concat(t).concat(e):"/me/drive/root:".concat(e)}},{key:"sendFileItemGraph",value:function(e){return $(this,void 0,void 0,(0,h.Z)().mark((function t(){var i,o,l,n;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.fileUploadList.graph,o="",!(e.file.size<this._maxChunkSize)){t.next=18;break}if(t.prev=3,e.completed){t.next=11;break}return null!==e.conflictBehavior&&1!==e.conflictBehavior||(o="".concat(this.getGrapQuery(e.fullPath),":/content")),0===e.conflictBehavior&&(o="".concat(this.getGrapQuery(e.fullPath),":/content?@microsoft.graph.conflictBehavior=rename")),t.next=9,(0,P.UD)(i,o,e.file);case 9:e.driveItem=t.sent,null!==e.driveItem?this.setUploadSuccess(e):(e.driveItem={name:e.file.name},this.setUploadFail(e,V.failUploadFile));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),this.setUploadFail(e,V.failUploadFile);case 16:t.next=37;break;case 18:if(e.completed){t.next=37;break}if(void 0!==e.uploadUrl){t.next=37;break}return t.next=22,(0,P.Bs)(i,"".concat(this.getGrapQuery(e.fullPath),":/createUploadSession"),e.conflictBehavior);case 22:if(l=t.sent,t.prev=23,null===l){t.next=32;break}return e.uploadUrl=l.uploadUrl,t.next=28,this.sendSessionUrlGraph(i,e);case 28:null!==(n=t.sent)?(e.driveItem=n,this.setUploadSuccess(e)):this.setUploadFail(e,V.failUploadFile),t.next=33;break;case 32:this.setUploadFail(e,V.failUploadFile);case 33:t.next=37;break;case 35:t.prev=35,t.t1=t.catch(23);case 37:case"end":return t.stop()}}),t,this,[[3,13],[23,35]])})))}},{key:"sendSessionUrlGraph",value:function(e,t){var o=this,l=Object.create(null,{requestStateUpdate:{get:function(){return(0,y.Z)((0,k.Z)(i.prototype),"requestStateUpdate",o)}}});return $(this,void 0,void 0,(0,h.Z)().mark((function i(){var o,n;return(0,h.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.file.size>t.minSize)){i.next=30;break}if(void 0!==t.mimeStreamString){i.next=5;break}return i.next=4,this.readFileContent(t.file);case 4:t.mimeStreamString=i.sent;case 5:return o=new Blob([t.mimeStreamString.slice(t.minSize,t.maxSize)]),t.percent=Math.round(t.maxSize/t.file.size*100),i.next=9,l.requestStateUpdate.call(this,!0);case 9:if(void 0===t.uploadUrl){i.next=27;break}return i.next=12,(0,P.qU)(e,t.uploadUrl,"".concat(t.maxSize-t.minSize),"bytes ".concat(t.minSize,"-").concat(t.maxSize-1,"/").concat(t.file.size),o);case 12:if(null!==(n=i.sent)){i.next=17;break}return i.abrupt("return",null);case 17:if(!(0,P.X5)(n)){i.next=23;break}t.minSize=parseInt(n.nextExpectedRanges[0].split("-")[0],10),t.maxSize=t.minSize+this._maxChunkSize,t.maxSize>t.file.size&&(t.maxSize=t.file.size),i.next=25;break;case 23:if(void 0===n.id){i.next=25;break}return i.abrupt("return",n);case 25:i.next=28;break;case 27:return i.abrupt("return",null);case 28:i.next=0;break;case 30:case"end":return i.stop()}}),i,this)})))}},{key:"setUploadSuccess",value:function(e){var t=this;e.percent=100,(0,y.Z)((0,k.Z)(i.prototype),"requestStateUpdate",this).call(this,!0),setTimeout((function(){e.iconStatus=(0,Z.d)(Z.l.Success),e.view=E.b.twolines,e.fieldUploadResponse="lastModifiedDateTime",e.completed=!0,(0,y.Z)((0,k.Z)(i.prototype),"requestStateUpdate",t).call(t,!0),(0,P.s7)()}),500)}},{key:"setUploadFail",value:function(e,t){var o=this;setTimeout((function(){e.iconStatus=(0,Z.d)(Z.l.Fail),e.view=E.b.twolines,e.driveItem.description=t,e.fieldUploadResponse="description",e.completed=!0,(0,y.Z)((0,k.Z)(i.prototype),"requestStateUpdate",o).call(o,!0)}),500)}},{key:"readFileContent",value:function(e){return new Promise((function(t,i){var o=new FileReader;o.onloadend=function(){t(o.result)},o.onerror=function(e){i(e)},o.readAsArrayBuffer(e)}))}},{key:"getFilesFromUploadArea",value:function(e){return $(this,void 0,void 0,(0,h.Z)().mark((function t(){var i,o,l,n,r,a,s,d,c,u;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=[],l=[],n=(0,g.Z)(e);try{for(n.s();!(r=n.n()).done;)a=r.value,"getAsFile"in(p=a)&&"function"===typeof p.getAsFile||"webkitGetAsEntry"in p&&"function"===typeof p.webkitGetAsEntry?Y(a)?(o=a.getAsEntry(),J(o)?i.push(o):(s=a.getAsFile())&&(this.writeFilePath(s,""),l.push(s))):a.webkitGetAsEntry?(o=a.webkitGetAsEntry(),J(o)?i.push(o):(d=a.getAsFile())&&(this.writeFilePath(d,""),l.push(d))):(c=a.getAsFile())&&(this.writeFilePath(c,""),l.push(c)):(this.writeFilePath(a,""),l.push(a))}catch(f){n.e(f)}finally{n.f()}if(!(i.length>0)){t.next=9;break}return t.next=7,this.getFolderFiles(i);case 7:u=t.sent,l.push.apply(l,(0,v.Z)(u));case 9:return t.abrupt("return",l);case 10:case"end":return t.stop()}var p}),t,this)})))}},{key:"getFolderFiles",value:function(e){var t=this;return new Promise((function(i){var o=0,l=[];e.forEach((function(e){n(e,"")}));var n=function(e,n){J(e)?r(e.createReader()):function(e){return e.isFile}(e)&&(o++,e.file((function(e){o--,t.writeFilePath(e,n),l.push(e),0===o&&i(l)})))},r=function(e){o++,e.readEntries((function(e){o--;var t,r=(0,g.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n(a,a.fullPath)}}catch(s){r.e(s)}finally{r.f()}0===o&&i(l)}))}}))}},{key:"writeFilePath",value:function(e,t){e.fullPath=t}}],[{key:"styles",get:function(){return G}},{key:"requiredScopes",get:function(){return(0,v.Z)(new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"]))}}]),i}(M.b);K([(0,_.Cb)({type:Object}),H("design:type",Array)],X.prototype,"filesToUpload",void 0),K([(0,_.Cb)({type:Object}),H("design:type",Object)],X.prototype,"fileUploadList",void 0);var ee,te,ie,oe,le,ne,re,ae,se,de=i(1710),ce=function(e,t,i,o){var l,n=arguments.length,r=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(l=e[a])&&(r=(n<3?l(r):n>3?l(t,i,r):l(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},ue=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},pe=function(e,t,i,o){return new(i||(i=Promise))((function(l,n){function r(e){try{s(o.next(e))}catch(t){n(t)}}function a(e){try{s(o.throw(e))}catch(t){n(t)}}function s(e){var t;e.done?l(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}s((o=o.apply(e,t||[])).next())}))},fe=function(){(0,N.J)(de.le),(0,B.R)(),(0,N.J)(A.Jh,O.hb,D.g,q.Ad),(0,B.R)(),(0,W.R)("file-upload",X),(0,W.R)("file-list",he)},he=function(e){(0,w.Z)(i,e);var t=(0,F.Z)(i);function i(){var e;return(0,b.Z)(this,i),(e=t.call(this))._isCompact=!1,e.fileQueries=null,e.files=null,e.itemView=E.b.threelines,e.fileExtensions=[],e.pageSize=10,e.disableOpenOnClick=!1,e.hideMoreFilesButton=!1,e.enableFileUpload=!1,e.maxUploadFile=10,e.excludedFileExtensions=[],e._preloadedFiles=[],e._focusedItemIndex=-1,e.renderLoading=function(){return e.files?e.renderContent():e.renderTemplate("loading",null)||(0,z.dy)(ee||(ee=(0,m.Z)([""])))},e.renderContent=function(){return e.files&&0!==e.files.length?e._isCompact?e.renderCompactView():e.renderFullView():e.renderNoData()},e.onFocusFirstItem=function(){return e._focusedItemIndex=0},e.onFileListKeyDown=function(t){var i,o=e.renderRoot.querySelector(".file-list");if(null===o||void 0===o?void 0:o.children.length){if("ArrowUp"!==t.code&&"ArrowDown"!==t.code||("ArrowUp"===t.code&&(-1===e._focusedItemIndex&&(e._focusedItemIndex=o.children.length),e._focusedItemIndex=(e._focusedItemIndex-1+o.children.length)%o.children.length),"ArrowDown"===t.code&&(e._focusedItemIndex=(e._focusedItemIndex+1)%o.children.length),i=o.children[e._focusedItemIndex],e.updateItemBackgroundColor(o,i,"focused")),"Enter"===t.code||"Space"===t.code){var l=(i=o.children[e._focusedItemIndex]).children[0];t.preventDefault(),e.fireCustomEvent("itemClick",l.fileDetails),e.handleFileClick(l.fileDetails),e.updateItemBackgroundColor(o,i,"selected")}"Tab"===t.code&&(i=o.children[e._focusedItemIndex])}},e}return(0,x.Z)(i,[{key:"strings",get:function(){return R}},{key:"displayName",get:function(){return this.strings.filesSectionTitle}},{key:"cardTitle",get:function(){return this.strings.filesSectionTitle}},{key:"renderIcon",value:function(){return(0,Z.d)(Z.l.Files)}},{key:"clearState",value:function(){(0,y.Z)((0,k.Z)(i.prototype),"clearState",this).call(this),this.files=null}},{key:"asCompactView",value:function(){return this._isCompact=!0,this}},{key:"asFullView",value:function(){return this._isCompact=!1,this}},{key:"args",value:function(){return[this.providerState,this.fileListQuery,this.fileQueries,this.siteId,this.driveId,this.groupId,this.itemId,this.itemPath,this.userId,this.insightType,this.fileExtensions,this.pageSize,this.maxFileSize]}},{key:"renderCompactView",value:function(){var e=this.files.slice(0,3);return this.renderFiles(e)}},{key:"renderFullView",value:function(){return this.renderTemplate("default",{files:this.files})||this.renderFiles(this.files)}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||(!0===this.enableFileUpload&&void 0!==S.C.globalProvider?(0,z.dy)(te||(te=(0,m.Z)(['\n            <div class="file-list-wrapper" dir=',">\n              ","\n            </div>"])),this.direction,this.renderFileUpload()):(0,z.dy)(ie||(ie=(0,m.Z)([""]))))}},{key:"renderFiles",value:function(e){var t=this;return(0,z.dy)(oe||(oe=(0,m.Z)(['\n      <div id="file-list-wrapper" class="file-list-wrapper" dir=',">\n        ",'\n        <ul\n          id="file-list"\n          class="file-list"\n        >\n          <li\n            tabindex="0"\n            class="file-item"\n            @keydown="','"\n            @focus="','"\n            @click=',">\n            ","\n          </li>\n          ","\n        </ul>\n        ","\n      </div>\n    "])),this.direction,this.enableFileUpload?this.renderFileUpload():null,this.onFileListKeyDown,this.onFocusFirstItem,(function(i){return t.handleItemSelect(e[0],i)}),this.renderFile(e[0]),(0,C.r)(e.slice(1),(function(e){return e.id}),(function(e){return(0,z.dy)(le||(le=(0,m.Z)(['\n              <li\n                class="file-item"\n                @keydown="','"\n                @click=',">\n                ","\n              </li>\n            "])),t.onFileListKeyDown,(function(i){return t.handleItemSelect(e,i)}),t.renderFile(e))})),this.hideMoreFilesButton||!this.pageIterator||!this.pageIterator.hasNext&&!this._preloadedFiles.length||this._isCompact?null:this.renderMoreFileButton())}},{key:"renderFile",value:function(e){var t=this.itemView;return this.renderTemplate("file",{file:e},e.id)||(0,I.b)(ne||(ne=(0,m.Z)(['\n        <mgt-file class="mgt-file-item" .fileDetails='," .view=","></mgt-file>\n      "])),e,t)}},{key:"renderMoreFileButton",value:function(){var e=this;return this._isLoadingMore?(0,z.dy)(re||(re=(0,m.Z)(['\n        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>\n      ']))):(0,z.dy)(ae||(ae=(0,m.Z)(['\n        <fluent-button\n          appearance="stealth"\n          id="show-more"\n          class="show-more"\n          @click=','\n        >\n          <span class="show-more-text">',"</span>\n        </fluent-button>"])),(function(){return e.renderNextPage()}),this.strings.showMoreSubtitle)}},{key:"renderFileUpload",value:function(){var e={graph:S.C.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return(0,I.b)(se||(se=(0,m.Z)(["\n        <mgt-file-upload .fileUploadList="," ></mgt-file-upload>\n      "])),e)}},{key:"loadState",value:function(){var e,t;return pe(this,void 0,void 0,(0,h.Z)().mark((function i(){var o,l,n,r,a,s,d=this;return(0,h.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((o=S.C.globalProvider)&&o.state!==U.Aw.Loading){i.next=3;break}return i.abrupt("return");case 3:if(o.state!==U.Aw.SignedOut){i.next=6;break}return this.files=null,i.abrupt("return");case 6:if(l=o.graph.forComponent(this),a=!this.driveId&&!this.siteId&&!this.groupId&&!this.userId,(this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),this.files){i.next=114;break}if(!this.fileListQuery){i.next=16;break}return i.next=13,(0,P.ht)(l,this.fileListQuery,this.pageSize);case 13:r=i.sent,i.next=102;break;case 16:if(!this.fileQueries){i.next=22;break}return i.next=19,(0,P.bf)(l,this.fileQueries);case 19:n=i.sent,i.next=102;break;case 22:if(!a){i.next=46;break}if(!this.itemId){i.next=29;break}return i.next=26,(0,P.k_)(l,this.itemId,this.pageSize);case 26:r=i.sent,i.next=44;break;case 29:if(!this.itemPath){i.next=35;break}return i.next=32,(0,P.V7)(l,this.itemPath,this.pageSize);case 32:r=i.sent,i.next=44;break;case 35:if(!this.insightType){i.next=41;break}return i.next=38,(0,P.Kv)(l,this.insightType);case 38:n=i.sent,i.next=44;break;case 41:return i.next=43,(0,P.UA)(l,this.pageSize);case 43:r=i.sent;case 44:i.next=102;break;case 46:if(!this.driveId){i.next=59;break}if(!this.itemId){i.next=53;break}return i.next=50,(0,P.th)(l,this.driveId,this.itemId,this.pageSize);case 50:r=i.sent,i.next=57;break;case 53:if(!this.itemPath){i.next=57;break}return i.next=56,(0,P.A6)(l,this.driveId,this.itemPath,this.pageSize);case 56:r=i.sent;case 57:i.next=102;break;case 59:if(!this.groupId){i.next=72;break}if(!this.itemId){i.next=66;break}return i.next=63,(0,P.Gi)(l,this.groupId,this.itemId,this.pageSize);case 63:r=i.sent,i.next=70;break;case 66:if(!this.itemPath){i.next=70;break}return i.next=69,(0,P.Lr)(l,this.groupId,this.itemPath,this.pageSize);case 69:r=i.sent;case 70:i.next=102;break;case 72:if(!this.siteId){i.next=85;break}if(!this.itemId){i.next=79;break}return i.next=76,(0,P.Vd)(l,this.siteId,this.itemId,this.pageSize);case 76:r=i.sent,i.next=83;break;case 79:if(!this.itemPath){i.next=83;break}return i.next=82,(0,P.Qk)(l,this.siteId,this.itemPath,this.pageSize);case 82:r=i.sent;case 83:i.next=102;break;case 85:if(!this.userId){i.next=102;break}if(!this.itemId){i.next=92;break}return i.next=89,(0,P.Yl)(l,this.userId,this.itemId,this.pageSize);case 89:r=i.sent,i.next=102;break;case 92:if(!this.itemPath){i.next=98;break}return i.next=95,(0,P.f8)(l,this.userId,this.itemPath,this.pageSize);case 95:r=i.sent,i.next=102;break;case 98:if(!this.insightType){i.next=102;break}return i.next=101,(0,P.LQ)(l,this.userId,this.insightType);case 101:n=i.sent;case 102:if(r&&(this.pageIterator=r,this._preloadedFiles=(0,v.Z)(this.pageIterator.value),n=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),!((null===(e=this.fileExtensions)||void 0===e?void 0:e.length)>0)){i.next=113;break}if(!(null===(t=this.pageIterator)||void 0===t?void 0:t.value)){i.next=112;break}case 105:if(!this.pageIterator.hasNext){i.next=110;break}return i.next=108,(0,P.xf)(this.pageIterator);case 108:i.next=105;break;case 110:n=this.pageIterator.value,this._preloadedFiles=[];case 112:s=n.filter((function(e){var t,i=(0,g.Z)(d.fileExtensions);try{for(i.s();!(t=i.n()).done;){if(t.value===d.getFileExtension(e.name))return e}}catch(o){i.e(o)}finally{i.f()}}));case 113:(null===s||void 0===s?void 0:s.length)>=0?(this.files=s,this.pageSize&&(n=this.files.splice(0,this.pageSize),this.files=n)):this.files=n;case 114:case"end":return i.stop()}}),i,this)})))}},{key:"handleItemSelect",value:function(e,t){if(this.handleFileClick(e),this.fireCustomEvent("itemClick",e),t){var i=this.renderRoot.querySelector(".file-list"),o=Array.from(i.children),l=t.target.closest("li"),n=o.indexOf(l);this._focusedItemIndex=n;var r=i.children[this._focusedItemIndex];this.updateItemBackgroundColor(i,r,"selected")}}},{key:"renderNextPage",value:function(){return pe(this,void 0,void 0,(0,h.Z)().mark((function e(){var t;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._preloadedFiles.length>0)){e.next=4;break}this.files=[].concat((0,v.Z)(this.files),(0,v.Z)(this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length)))),e.next=12;break;case 4:if(!this.pageIterator.hasNext){e.next=12;break}return this._isLoadingMore=!0,(null===(t=this.renderRoot.querySelector("#file-list-wrapper"))||void 0===t?void 0:t.animate)&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),e.next=10,(0,P.xf)(this.pageIterator);case 10:this._isLoadingMore=!1,this.files=this.pageIterator.value;case 12:this.requestUpdate();case 13:case"end":return e.stop()}}),e,this)})))}},{key:"handleFileClick",value:function(e){(null===e||void 0===e?void 0:e.webUrl)&&!this.disableOpenOnClick&&window.open(e.webUrl,"_blank","noreferrer")}},{key:"getFileExtension",value:function(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}},{key:"updateItemBackgroundColor",value:function(e,t,i){var o,l=(0,g.Z)(e.children);try{for(l.s();!(o=l.n()).done;){var n=o.value;n.classList.remove(i),n.removeAttribute("tabindex")}}catch(s){l.e(s)}finally{l.f()}t&&(t.classList.add(i),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),t.setAttribute("tabindex","0"),t.focus());var r,a=(0,g.Z)(e.children);try{for(a.s();!(r=a.n()).done;){r.value.classList.remove("selected")}}catch(s){a.e(s)}finally{a.f()}}},{key:"reload",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(0,P.s7)(),this._task.run()}}],[{key:"styles",get:function(){return T}},{key:"requiredScopes",get:function(){return(0,v.Z)(new Set((0,v.Z)(B.P.requiredScopes)))}}]),i}(L.F);ce([(0,_.SB)(),ue("design:type",Object)],he.prototype,"_isCompact",void 0),ce([(0,_.Cb)({attribute:"file-list-query"}),ue("design:type",String)],he.prototype,"fileListQuery",void 0),ce([(0,_.Cb)({attribute:"file-queries",converter:function(e,t){return e?e.split(",").map((function(e){return e.trim()})):null}}),ue("design:type",Array)],he.prototype,"fileQueries",void 0),ce([(0,_.Cb)({type:Object}),ue("design:type",Array)],he.prototype,"files",void 0),ce([(0,_.Cb)({attribute:"site-id"}),ue("design:type",String)],he.prototype,"siteId",void 0),ce([(0,_.Cb)({attribute:"drive-id"}),ue("design:type",String)],he.prototype,"driveId",void 0),ce([(0,_.Cb)({attribute:"group-id"}),ue("design:type",String)],he.prototype,"groupId",void 0),ce([(0,_.Cb)({attribute:"item-id"}),ue("design:type",String)],he.prototype,"itemId",void 0),ce([(0,_.Cb)({attribute:"item-path"}),ue("design:type",String)],he.prototype,"itemPath",void 0),ce([(0,_.Cb)({attribute:"user-id"}),ue("design:type",String)],he.prototype,"userId",void 0),ce([(0,_.Cb)({attribute:"insight-type"}),ue("design:type",String)],he.prototype,"insightType",void 0),ce([(0,_.Cb)({attribute:"item-view",converter:function(e){return e&&0!==e.length?(e=e.toLowerCase(),"undefined"===typeof E.b[e]?E.b.threelines:E.b[e]):E.b.threelines}}),ue("design:type",Object)],he.prototype,"itemView",void 0),ce([(0,_.Cb)({attribute:"file-extensions",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),ue("design:type",Array)],he.prototype,"fileExtensions",void 0),ce([(0,_.Cb)({attribute:"page-size",type:Number}),ue("design:type",Object)],he.prototype,"pageSize",void 0),ce([(0,_.Cb)({attribute:"disable-open-on-click",type:Boolean}),ue("design:type",Object)],he.prototype,"disableOpenOnClick",void 0),ce([(0,_.Cb)({attribute:"hide-more-files-button",type:Boolean}),ue("design:type",Object)],he.prototype,"hideMoreFilesButton",void 0),ce([(0,_.Cb)({attribute:"max-file-size",type:Number}),ue("design:type",Number)],he.prototype,"maxFileSize",void 0),ce([(0,_.Cb)({attribute:"enable-file-upload",type:Boolean}),ue("design:type",Object)],he.prototype,"enableFileUpload",void 0),ce([(0,_.Cb)({attribute:"max-upload-file",type:Number}),ue("design:type",Object)],he.prototype,"maxUploadFile",void 0),ce([(0,_.Cb)({attribute:"excluded-file-extensions",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),ue("design:type",Array)],he.prototype,"excludedFileExtensions",void 0),ce([(0,_.SB)(),ue("design:type",Boolean)],he.prototype,"_isLoadingMore",void 0)},1734:function(e,t,i){i.d(t,{Y:function(){return h}});var o,l,n=i(1171),r=i(9249),a=i(7371),s=i(5754),d=i(6906),c=i(9242),u=i(1850),p=[(0,c.iv)(o||(o=(0,n.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}\n'])))],f=i(8097),h=function(){return(0,f.R)("spinner",g)},g=function(e){(0,s.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,r.Z)(this,i),t.apply(this,arguments)}return(0,a.Z)(i,[{key:"render",value:function(){return(0,c.dy)(l||(l=(0,n.Z)(['<fluent-progress-ring title="spinner"></fluent-progress-ring>'])))}}],[{key:"styles",get:function(){return p}}]),i}(u.o)}}]);
//# sourceMappingURL=915.d300e994.chunk.js.map