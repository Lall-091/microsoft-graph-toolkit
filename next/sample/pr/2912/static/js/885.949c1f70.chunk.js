"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[885],{505:function(e,t,r){r.d(t,{m:function(){return o}});r(969);var n=r(7780),s=r(3583),i=r(7574),a=(0,n.Z)({divider:{alignItems:"self-start",paddingTop:"20px",marginBottom:"20px"}}),o=function(e){var t=a();return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:e.title}),(0,i.jsx)("div",{children:e.description}),(0,i.jsx)(s.i,{className:t.divider})]})}},7885:function(e,t,r){r.r(t),r.d(t,{default:function(){return Ke}});var n,s,i,a,o,l,c,u,d,h,p,m,v,f,g,y,x,b,k,w,T,j,S,C,R,P,_,I=r(6234),Z=r(3028),z=r(969),D=r(505),M=r(2723),q=r(1361),N=r(8079),L=r(1171),F=r(9249),U=r(7371),O=r(5754),A=r(6906),B=r(9242),W=r(5378),E=r(2742),H=r(2292),$=r(7667),Q=r(8556),K=r(9155),V=r(8402),G=r(3022),J=r(4673),Y=r(2097),X={modified:"modified on",back:"Back",next:"Next",pages:"pages",page:"Page"},ee=[(0,B.iv)(n||(n=(0,L.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n'])))],te=r(9698),re=r(4223),ne=r(3408),se=r(9576),ie=r(8388),ae=r(5827),oe=r(6552),le=r(8097),ce=r(8382),ue=r(9768),de=function(e,t,r,n){var s,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,r,a):s(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},he=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},pe=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function o(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))},me=function(e){(0,O.Z)(r,e);var t=(0,A.Z)(r);function r(){var e;return(0,F.Z)(this,r),(e=t.call(this))._size=10,e.entityTypes=["driveItem","listItem","site"],e.scopes=[],e.contentSources=[],e.version="v1.0",e.pagingMax=7,e.enableTopResults=!1,e.cacheEnabled=!1,e.cacheInvalidationPeriod=3e4,e.isRefreshing=!1,e.defaultFields=["webUrl","lastModifiedBy","lastModifiedDateTime","summary","displayName","name"],e.currentPage=1,e.renderContent=function(){var t,r,n,l,c,u,d,h,p,m=null,v=null;return e.hasTemplate("header")&&(v=e.renderTemplate("header",e.response)),p=e.renderFooter(null===(r=null===(t=e.response)||void 0===t?void 0:t.value[0])||void 0===r?void 0:r.hitsContainers[0]),m=e.response&&e.hasTemplate("default")?e.renderTemplate("default",e.response)||(0,B.dy)(s||(s=(0,L.Z)([""]))):(null===(l=null===(n=e.response)||void 0===n?void 0:n.value[0])||void 0===l?void 0:l.hitsContainers[0])?(0,B.dy)(i||(i=(0,L.Z)(["",""])),null===(h=null===(d=null===(u=null===(c=e.response)||void 0===c?void 0:c.value[0])||void 0===u?void 0:u.hitsContainers[0])||void 0===d?void 0:d.hits)||void 0===h?void 0:h.map((function(t){return e.renderResult(t)}))):e.hasTemplate("no-data")?e.renderTemplate("no-data",null):(0,B.dy)(a||(a=(0,L.Z)([""]))),(0,B.dy)(o||(o=(0,L.Z)(["\n      ",'\n      <div class="search-results">\n        ',"\n      </div>\n      ",""])),v,m,p)},e.renderLoading=function(){return e.renderTemplate("loading",null)||(0,B.dy)(l||(l=(0,L.Z)(["\n        ","\n       "])),(0,N.Z)(Array(e.size)).map((function(){return(0,B.dy)(c||(c=(0,L.Z)(['\n            <div class="search-result">\n              <div class="search-result-grid">\n                <div class="search-result-icon">\n                  <fluent-skeleton class="search-result-icon__shimmer" shape="rect" shimmer></fluent-skeleton>\n                </div>\n                <div class="searc-result-content">\n                  <div class="search-result-name">\n                    <fluent-skeleton class="search-result-name__shimmer" shape="rect" shimmer></fluent-skeleton>\n                  </div>\n                  <div class="search-result-info">\n                    <div class="search-result-author">\n                      <fluent-skeleton class="search-result-author__shimmer" shape="circle" shimmer></fluent-skeleton>\n                    </div>\n                    <div class="search-result-date">\n                      <fluent-skeleton class="search-result-date__shimmer" shape="rect" shimmer></fluent-skeleton>\n                    </div>\n                  </div>\n                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>\n                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>\n                </div>\n                ',"\n              </div>\n              <fluent-divider></fluent-divider>\n            </div>\n          "])),e.fetchThumbnail&&(0,B.dy)(u||(u=(0,L.Z)(['\n                    <div class="search-result-thumbnail">\n                      <fluent-skeleton class="search-result-thumbnail__shimmer" shape="rect" shimmer></fluent-skeleton>\n                    </div>\n                  ']))))})))},e.onFirstPageClick=function(){e.currentPage=1,e.scrollToFirstResult()},e.onPageBackClick=function(){e.currentPage--,e.scrollToFirstResult()},e.onPageNextClick=function(){e.currentPage++,e.scrollToFirstResult()},e}return(0,U.Z)(r,[{key:"strings",get:function(){return X}},{key:"queryString",get:function(){return this._queryString},set:function(e){this._queryString!==e&&(this._queryString=e,this.currentPage=1)}},{key:"from",get:function(){return(this.currentPage-1)*this.size}},{key:"size",get:function(){return this._size},set:function(e){e>this.maxPageSize?this._size=this.maxPageSize:this._size=e}},{key:"searchEndpoint",get:function(){return"/search/query"}},{key:"maxPageSize",get:function(){return 1e3}},{key:"args",value:function(){return[this.providerState,this.queryString,this.queryTemplate,this.entityTypes,this.contentSources,this.scopes,this.version,this.size,this.fetchThumbnail,this.fields,this.enableTopResults,this.currentPage]}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this._task.run()}},{key:"clearState",value:function(){this.response=null}},{key:"loadState",value:function(){var e,t,r,n,s,i;return pe(this,void 0,void 0,(0,M.Z)().mark((function a(){var o,l,c,u,d,h,p,m,v,f,g,y,x,b,k,w;return(0,M.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o=E.C.globalProvider,this.error=null,o&&o.state===H.Aw.SignedIn){a.next=4;break}return a.abrupt("return");case 4:if(!this.queryString){a.next=62;break}if(a.prev=5,l=this.getRequestOptions(),u=JSON.stringify({endpoint:"".concat(this.version).concat(this.searchEndpoint),requestOptions:l}),d=null,!this.shouldRetrieveCache()){a.next=20;break}if(c=$.Q.getCache(Y.O.search,Y.O.search.stores.responses),!(0,te.rK)()){a.next=17;break}return a.next=14,c.getValue(u);case 14:a.t0=a.sent,a.next=18;break;case 17:a.t0=null;case 18:(h=a.t0)&&(0,te.n6)(this.cacheInvalidationPeriod)>Date.now()-h.timeCached&&(d=JSON.parse(h.response));case 20:if(d){a.next=53;break}return p=o.graph.forComponent(this),m=p.api(this.searchEndpoint).version(this.version),(null===(e=this.scopes)||void 0===e?void 0:e.length)&&(m=m.middlewareOptions(Q.z.apply(void 0,(0,N.Z)(this.scopes)))),a.next=26,m.post({requests:[l]});case 26:if(d=a.sent,!this.fetchThumbnail){a.next=49;break}v=p.createBatch(),f=K.g.fromGraph(p).createBatch(),g=(null===(t=d.value)||void 0===t?void 0:t.length)&&(null===(r=d.value[0].hitsContainers)||void 0===r?void 0:r.length)&&null!==(s=null===(n=d.value[0].hitsContainers[0])||void 0===n?void 0:n.hits)&&void 0!==s?s:[],y=(0,q.Z)(g);try{for(y.s();!(x=y.n()).done;)b=x.value,!((k=b.resource).size>0||(null===(i=k.webUrl)||void 0===i?void 0:i.endsWith(".aspx")))||"#microsoft.graph.driveItem"!==k["@odata.type"]&&"#microsoft.graph.listItem"!==k["@odata.type"]||("#microsoft.graph.listItem"===k["@odata.type"]?f.get(b.hitId.toString(),"/sites/".concat(k.parentReference.siteId,"/pages/").concat(k.id)):v.get(b.hitId.toString(),"/drives/".concat(k.parentReference.driveId,"/items/").concat(k.id,"/thumbnails/0/medium")))}catch(T){y.e(T)}finally{y.f()}return w=function(e){if(e&&e.size>0){var t,r=(0,q.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=(0,I.Z)(t.value,2),s=n[0],i=n[1],a=d.value[0].hitsContainers[0].hits[s],o="#microsoft.graph.listItem"===a.resource["@odata.type"]?{url:i.content.thumbnailWebUrl}:{url:i.content.url};a.resource.thumbnail=o}}catch(T){r.e(T)}finally{r.f()}}},a.prev=34,a.t1=w,a.next=38,v.executeAll();case 38:return a.t2=a.sent,(0,a.t1)(a.t2),a.t3=w,a.next=43,f.executeAll();case 43:a.t4=a.sent,(0,a.t3)(a.t4),a.next=49;break;case 47:a.prev=47,a.t5=a.catch(34);case 49:if(!this.shouldUpdateCache()||!d){a.next=53;break}return c=$.Q.getCache(Y.O.search,Y.O.search.stores.responses),a.next=53,c.putValue(u,{response:JSON.stringify(d)});case 53:(0,V.f)(this.response,d)||(this.response=d),a.next=59;break;case 56:a.prev=56,a.t6=a.catch(5),this.error=a.t6;case 59:this.response&&(this.error=null),a.next=63;break;case 62:this.response=null;case 63:this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error});case 65:case"end":return a.stop()}}),a,this,[[5,56],[34,47]])})))}},{key:"renderResult",value:function(e){var t=this.getResourceType(e.resource);if(this.hasTemplate("result-".concat(t)))return this.renderTemplate("result-".concat(t),e,e.hitId);switch(e.resource["@odata.type"]){case"#microsoft.graph.driveItem":return this.renderDriveItem(e);case"#microsoft.graph.site":return this.renderSite(e);case"#microsoft.graph.person":return this.renderPerson(e);case"#microsoft.graph.drive":case"#microsoft.graph.list":return this.renderList(e);case"#microsoft.graph.listItem":return this.renderListItem(e);case"#microsoft.graph.search.bookmark":return this.renderBookmark(e);case"#microsoft.graph.search.acronym":return this.renderAcronym(e);case"#microsoft.graph.search.qna":return this.renderQnA(e);default:return this.renderDefault(e)}}},{key:"renderFooter",value:function(e){if(this.pagingRequired(e)){var t=this.getActivePages(e.total);return(0,B.dy)(d||(d=(0,L.Z)(['\n        <div class="search-results-pages">\n          ',"\n          ","\n          ","\n          ","\n        </div>\n      "])),this.renderPreviousPage(),this.renderFirstPage(t),this.renderAllPages(t),this.renderNextPage())}}},{key:"pagingRequired",value:function(e){return(null===e||void 0===e?void 0:e.moreResultsAvailable)||this.currentPage*this.size<(null===e||void 0===e?void 0:e.total)}},{key:"getActivePages",value:function(e){var t=this,r=[],n=function(){var e=t.currentPage-Math.floor(t.pagingMax/2)-1;return e>=Math.floor(t.pagingMax/2)?e:0}();if(n+1>this.pagingMax-this.currentPage||this.pagingMax===this.currentPage)for(var s=n+1;s<Math.ceil(e/this.size)&&s<this.pagingMax+(this.currentPage-1)&&r.length<this.pagingMax-2;++s)r.push(s+1);else for(var i=n;i<this.pagingMax;++i)r.push(i+1);return r}},{key:"renderAllPages",value:function(e){var t=this;return(0,B.dy)(h||(h=(0,L.Z)(["\n      ",""])),e.map((function(e){return(0,B.dy)(p||(p=(0,L.Z)(['\n            <fluent-button\n              title="'," ",'"\n              appearance="stealth"\n              class="','"\n              @click="','">\n                ',"\n            </fluent-button>"])),X.page,e,e===t.currentPage?"search-results-page-active":"search-results-page",(function(){return t.onPageClick(e)}),e)})))}},{key:"renderFirstPage",value:function(e){var t=this;return(0,B.dy)(m||(m=(0,L.Z)(["\n      ",""])),e.some((function(e){return 1===e}))?B.Ld:(0,B.dy)(v||(v=(0,L.Z)(['\n              <fluent-button\n                 title="',' 1"\n                 appearance="stealth"\n                 class="search-results-page"\n                 @click="','">\n                 1\n               </fluent-button>'])),X.page,this.onFirstPageClick)?(0,B.dy)(f||(f=(0,L.Z)(['\n              <fluent-button\n                id="page-back-dot"\n                appearance="stealth"\n                class="search-results-page"\n                title="','"\n                @click="','"\n              >\n                ...\n              </fluent-button>'])),this.getDotButtonTitle(),(function(){return t.onPageClick(t.currentPage-Math.ceil(t.pagingMax/2))})):B.Ld)}},{key:"getDotButtonTitle",value:function(){return"".concat(X.back," ").concat(Math.ceil(this.pagingMax/2)," ").concat(X.pages)}},{key:"renderPreviousPage",value:function(){return this.currentPage>1?(0,B.dy)(g||(g=(0,L.Z)(['\n          <fluent-button\n            appearance="stealth"\n            class="search-results-page"\n            title="','"\n            @click="','">\n              ',"\n            </fluent-button>"])),X.back,this.onPageBackClick,(0,re.d)(re.l.ChevronLeft)):B.Ld}},{key:"renderNextPage",value:function(){return this.isLastPage()?B.Ld:(0,B.dy)(y||(y=(0,L.Z)(['\n          <fluent-button\n            appearance="stealth"\n            class="search-results-page"\n            title="','"\n            aria-label="','"\n            @click="','">\n              ',"\n            </fluent-button>"])),X.next,X.next,this.onPageNextClick,(0,re.d)(re.l.ChevronRight))}},{key:"onPageClick",value:function(e){this.currentPage=e,this.scrollToFirstResult()}},{key:"isLastPage",value:function(){return this.currentPage===Math.ceil(this.response.value[0].hitsContainers[0].total/this.size)}},{key:"scrollToFirstResult",value:function(){this.renderRoot.querySelector(".search-results").scrollIntoView({block:"start",behavior:"smooth"})}},{key:"getResourceType",value:function(e){return e["@odata.type"].split(".").pop()}},{key:"renderDriveItem",value:function(e){var t,r,n=e.resource;return(0,G.b)(x||(x=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          <mgt-file\n            .fileDetails="','"\n            view="image"\n            class="file-icon">\n          </mgt-file>\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">','</a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-author">\n              <mgt-person\n                person-query=','\n                view="oneLine"\n                person-card="hover"\n                show-presence="true">\n              </mgt-person>\n            </div>\n            <div class="search-result-date">\n              &nbsp; '," ",'\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n        ',"\n\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),e.resource,n.webUrl,(0,te.ju)(n.name),n.lastModifiedBy.user.email,X.modified,(0,te.t9)(new Date(n.lastModifiedDateTime)),(0,te.$8)(e.summary),(null===(t=n.thumbnail)||void 0===t?void 0:t.url)&&(0,B.dy)(b||(b=(0,L.Z)(['\n          <div class="search-result-thumbnail">\n            <a href="','" target="_blank"><img alt="','" src="','" /></a>\n          </div>'])),n.webUrl,n.name,null===(r=n.thumbnail)||void 0===r?void 0:r.url))}},{key:"renderSite",value:function(e){var t=e.resource;return(0,B.dy)(k||(k=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="searc-result-content">\n          <div class="search-result-name">\n            <a href="','" target="_blank">','</a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-url">\n              <a href="','" target="_blank">','</a>\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),this.getResourceIcon(t),t.webUrl,t.displayName,t.webUrl,t.webUrl,(0,te.$8)(e.summary))}},{key:"renderList",value:function(e){var t=e.resource;return(0,G.b)(w||(w=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          <mgt-file\n            .fileDetails="','"\n            view="image">\n          </mgt-file>\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">\n              ','\n            </a>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),e.resource,t.webUrl,(0,te.ju)(t.name||(0,te.nN)(t.webUrl)),(0,te.$8)(e.summary))}},{key:"renderListItem",value:function(e){var t,r,n=e.resource;return(0,G.b)(T||(T=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">\n              ','\n            </a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-author">\n              <mgt-person\n                person-query=','\n                view="oneLine"\n                person-card="hover"\n                show-presence="true">\n              </mgt-person>\n            </div>\n            <div class="search-result-date">\n              &nbsp; '," ",'\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n        ',"\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),n.webUrl.endsWith(".aspx")?(0,re.d)(re.l.News):(0,re.d)(re.l.FileOuter),n.webUrl,(0,te.ju)(n.name||(0,te.nN)(n.webUrl)),n.lastModifiedBy.user.email,X.modified,(0,te.t9)(new Date(n.lastModifiedDateTime)),(0,te.$8)(e.summary),(null===(t=n.thumbnail)||void 0===t?void 0:t.url)&&(0,B.dy)(j||(j=(0,L.Z)(['\n          <div class="search-result-thumbnail">\n            <a href="','" target="_blank"><img alt="','" src="','" /></a>\n          </div>'])),n.webUrl,(0,te.ju)(n.name||(0,te.nN)(n.webUrl)),(null===(r=n.thumbnail)||void 0===r?void 0:r.url)||B.Ld))}},{key:"renderPerson",value:function(e){var t=e.resource;return(0,G.b)(S||(S=(0,L.Z)(['\n      <div class="search-result">\n        <mgt-person\n          view="fourLines"\n          person-query=','\n          person-card="hover"\n          show-presence="true">\n        </mgt-person>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),t.userPrincipalName)}},{key:"renderBookmark",value:function(e){return this.renderAnswer(e,re.l.DoubleBookmark)}},{key:"renderAcronym",value:function(e){return this.renderAnswer(e,re.l.BookOpen)}},{key:"renderQnA",value:function(e){return this.renderAnswer(e,re.l.BookQuestion)}},{key:"renderAnswer",value:function(e,t){var r=e.resource;return(0,B.dy)(C||(C=(0,L.Z)(['\n      <div class="search-result-grid search-result-answer">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">','</a>\n          </div>\n          <div class="search-result-summary">',"</div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),(0,re.d)(t),this.getResourceUrl(r),r.displayName,r.description)}},{key:"renderDefault",value:function(e){var t=e.resource,r=this.getResourceUrl(t);return(0,B.dy)(R||(R=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            ','\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),this.getResourceIcon(t),r?(0,B.dy)(P||(P=(0,L.Z)(['\n                  <a href="','?Web=1" target="_blank">',"</a>\n                "])),r,this.getResourceName(t)):(0,B.dy)(_||(_=(0,L.Z)(["\n                  ","\n                "])),this.getResourceName(t)),this.getResultSummary(e))}},{key:"getResourceUrl",value:function(e){return e.webUrl||e.webLink||null}},{key:"getResourceName",value:function(e){return e.displayName||e.subject||(0,te.ju)(e.name)}},{key:"getResultSummary",value:function(e){var t;return(0,te.$8)(e.summary||(null===(t=e.resource)||void 0===t?void 0:t.description)||null)}},{key:"getResourceIcon",value:function(e){switch(e["@odata.type"]){case"#microsoft.graph.site":return(0,re.d)(re.l.Globe);case"#microsoft.graph.message":return(0,re.d)(re.l.Email);case"#microsoft.graph.event":return(0,re.d)(re.l.Event);case"microsoft.graph.chatMessage":return(0,re.d)(re.l.SmallChat);default:return(0,re.d)(re.l.FileOuter)}}},{key:"shouldRetrieveCache",value:function(){return(0,te.rK)()&&this.cacheEnabled&&!this.isRefreshing}},{key:"shouldUpdateCache",value:function(){return(0,te.rK)()&&this.cacheEnabled}},{key:"getRequestOptions",value:function(){var e={entityTypes:this.entityTypes,query:{queryString:this.queryString},from:this.from?this.from:void 0,size:this.size?this.size:void 0,fields:this.getFields(),enableTopResults:this.enableTopResults?this.enableTopResults:void 0};return this.entityTypes.includes("externalItem")&&(e.contentSources=this.contentSources),"beta"===this.version&&(e.query.queryTemplate=this.queryTemplate?this.queryTemplate:void 0),e}},{key:"getFields",value:function(){if(this.fields)return this.defaultFields.concat(this.fields)}}],[{key:"styles",get:function(){return ee}}]),r}(J.F);de([(0,W.Cb)({attribute:"query-string",type:String}),he("design:type",String),he("design:paramtypes",[String])],me.prototype,"queryString",null),de([(0,W.Cb)({attribute:"query-template",type:String}),he("design:type",String)],me.prototype,"queryTemplate",void 0),de([(0,W.Cb)({attribute:"entity-types",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),he("design:type",Array)],me.prototype,"entityTypes",void 0),de([(0,W.Cb)({attribute:"scopes",converter:function(e,t){return e?e.toLowerCase().split(","):null}}),he("design:type",Array)],me.prototype,"scopes",void 0),de([(0,W.Cb)({attribute:"content-sources",converter:function(e,t){return e?e.toLowerCase().split(","):null}}),he("design:type",Array)],me.prototype,"contentSources",void 0),de([(0,W.Cb)({attribute:"version",reflect:!0,type:String}),he("design:type",Object)],me.prototype,"version",void 0),de([(0,W.Cb)({attribute:"size",reflect:!0,type:Number}),he("design:type",Number),he("design:paramtypes",[Object])],me.prototype,"size",null),de([(0,W.Cb)({attribute:"paging-max",reflect:!0,type:Number}),he("design:type",Object)],me.prototype,"pagingMax",void 0),de([(0,W.Cb)({attribute:"fetch-thumbnail",type:Boolean}),he("design:type",Boolean)],me.prototype,"fetchThumbnail",void 0),de([(0,W.Cb)({attribute:"fields",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),he("design:type",Array)],me.prototype,"fields",void 0),de([(0,W.Cb)({attribute:"enable-top-results",reflect:!0,type:Boolean}),he("design:type",Object)],me.prototype,"enableTopResults",void 0),de([(0,W.Cb)({attribute:"cache-enabled",reflect:!0,type:Boolean}),he("design:type",Object)],me.prototype,"cacheEnabled",void 0),de([(0,W.Cb)({attribute:"cache-invalidation-period",reflect:!0,type:Number}),he("design:type",Object)],me.prototype,"cacheInvalidationPeriod",void 0),de([(0,W.SB)(),he("design:type",Object)],me.prototype,"response",void 0),de([(0,W.Cb)({attribute:!1}),he("design:type",Object)],me.prototype,"currentPage",void 0);var ve=(0,r(7908).$)("search-results",(function(){(0,oe.J)(ne.aV,se.hb,ie.x,ae.ue),(0,ce.R)(),(0,ue.yQ)(),(0,le.R)("search-results",me)})),fe=r(7574),ge=function(e){return(0,fe.jsx)(fe.Fragment,{children:e.searchTerm&&(0,fe.jsxs)(fe.Fragment,{children:["*"!==e.searchTerm&&(0,fe.jsx)(ve,{entityTypes:["bookmark"],queryString:e.searchTerm,version:"beta",size:1,scopes:["Bookmark.Read.All"],children:(0,fe.jsx)(ye,{template:"no-data"})}),(0,fe.jsx)(ve,{entityTypes:["driveItem","listItem","site"],queryString:e.searchTerm,scopes:["Files.Read.All","Sites.Read.All"],fetchThumbnail:!0})]})})},ye=function(e){return(0,fe.jsx)(fe.Fragment,{})},xe=function(e){return(0,fe.jsx)(fe.Fragment,{children:(0,fe.jsx)(ve,{entityTypes:["people"],size:20,queryString:e.searchTerm,version:"beta"})})},be=r(7780),ke=r(4220),we=r(8013),Te=r(9191),je=r(2205),Se=function(e){return(0,fe.jsx)(fe.Fragment,{children:e.searchTerm&&(0,fe.jsx)(ve,{entityTypes:["externalItem"],contentSources:["/external/connections/contosoBlogPosts"],queryString:e.searchTerm,scopes:["ExternalItem.Read.All"],version:"beta"})})},Ce=r(7602),Re=r(9251),Pe=r(2476),_e=r(5607),Ie=r(9591),Ze=r(1654),ze=r(4508),De=r(6816),Me=r(2880),qe=r(1901),Ne=r(7828),Le=r(2277),Fe=r(5908),Ue=r(4636),Oe=r(710),Ae=(0,be.Z)({container:(0,Z.Z)((0,Z.Z)({},ke.q5.gap("16px")),{},{display:"flex",flexDirection:"row",flexWrap:"wrap"}),card:{width:"300px",height:"fit-content",maxWidth:"100%"},caption:{color:Ie.T.colorNeutralForeground3},noDataSearchTerm:{fontWeight:Ie.T.fontWeightSemibold},emptyContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"calc(100vh - 300px)"},fileContainer:{display:"flex"},fileTitle:{paddingLeft:"10px",alignSelf:"center"},noDataMessage:{paddingLeft:"10px"},noDataIcon:{fontSize:"128px"},row:{cursor:"pointer"}}),Be=function(e){return(0,fe.jsx)(fe.Fragment,{children:e.searchTerm&&(0,fe.jsxs)(ve,{entityTypes:["driveItem"],queryString:e.searchTerm,fetchThumbnail:!0,queryTemplate:"({searchTerms}) ContentTypeId:0x0101*",version:"beta",fields:["createdBy","lastModifiedDateTime","Title","DefaultEncodingURL"],size:30,cacheEnabled:!0,children:[(0,fe.jsx)(Ee,{template:"default"}),(0,fe.jsx)(Ee,{template:"loading"}),(0,fe.jsx)(He,{template:"no-data"})]})})},We=function(e,t){return[(0,Ze.p)({columnId:"name",renderHeaderCell:function(){return"Name"},renderCell:function(r){return(0,fe.jsx)(ze.K,{children:e?(0,fe.jsx)(De.j,{shape:"rectangle",style:{width:"120px"}}):(0,fe.jsxs)("div",{className:t.fileContainer,children:[(0,fe.jsx)(Ce.$,{fileDetails:r.resource,view:Re.b.image}),(0,fe.jsx)("span",{className:t.fileTitle,children:r.resource.listItem.fields.title})]})})}}),(0,Ze.p)({columnId:"modified",renderHeaderCell:function(){return"Modified"},renderCell:function(t){return(0,fe.jsx)(ze.K,{children:e?(0,fe.jsx)(De.j,{shape:"rectangle",style:{width:"120px"}}):$e(new Date(t.resource.lastModifiedDateTime))})}}),(0,Ze.p)({columnId:"owner",renderHeaderCell:function(){return"Owner"},renderCell:function(t){return(0,fe.jsx)(ze.K,{children:e?(0,fe.jsxs)("div",{style:{display:"grid",alignItems:"center",position:"relative",gridTemplateColumns:"min-content 80%",gap:"10px"},children:[(0,fe.jsx)(De.j,{shape:"circle",size:32}),(0,fe.jsx)(De.j,{style:{width:"120px"}})]}):(0,fe.jsx)(Pe.F,{personQuery:t.resource.createdBy.user.email,view:Re.b.oneline,personCardInteraction:_e.c.hover})})}})]},Ee=function(e){var t,r,n,s=Ae(),i=z.useState(null===(t=e.dataContext.value)||void 0===t||null===(r=t[0])||void 0===r||null===(n=r.hitsContainers[0])||void 0===n?void 0:n.hits),a=(0,I.Z)(i,1)[0];return(0,fe.jsx)("div",{children:(0,fe.jsxs)(Me._,{columns:We("loading"===e.template,s),items:"loading"===e.template?(0,N.Z)(Array(30)):a,children:[(0,fe.jsx)(qe.S,{children:(0,fe.jsx)(Ne.m,{children:function(e){var t=e.renderHeaderCell;return(0,fe.jsx)(Le.p,{children:t()})}})}),(0,fe.jsx)(Fe.s,{children:function(e){var t=e.item,r=e.rowId;return(0,fe.jsx)(Ne.m,{className:s.row,onClick:function(){return function(e){var t=new URL(e.resource.listItem.fields.defaultEncodingURL);t.searchParams.append("Web","1"),window.open(t.toString(),"_blank")}(t)},children:function(e){var r=e.renderCell;return(0,fe.jsx)(Ue.a,{children:r(t)})}},r)}})]})})},He=function(e){var t,r=Ae(),n=z.useState(null===(t=e.dataContext.value[0])||void 0===t?void 0:t.searchTerms),s=(0,I.Z)(n,1)[0];return(0,fe.jsxs)("div",{className:r.emptyContainer,children:[(0,fe.jsx)("div",{children:(0,fe.jsx)(Oe.vRj,{className:r.noDataIcon})}),(0,fe.jsxs)("div",{className:r.noDataMessage,children:["We couldn't find any results for ",(0,fe.jsx)("span",{className:r.noDataSearchTerm,children:s.join(" ")})]})]})},$e=function(e){var t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=r)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});var n=new Date(r);if(n.setDate(t.getDate()-t.getDay()),e>=n)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});var s=new Date(n);return s.setDate(n.getDate()-7),e>=s?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},Qe=(0,be.Z)({panels:(0,Z.Z)({},ke.q5.padding("10px")),container:{maxWidth:"1028px",width:"100%"}}),Ke=function(){var e=Qe(),t=(0,je.b)(),r=z.useState(new URLSearchParams(window.location.search).get("q")),n=(0,I.Z)(r,1)[0],s=z.useState("allResults"),i=(0,I.Z)(s,2),a=i[0],o=i[1];return(0,fe.jsxs)(fe.Fragment,{children:[(0,fe.jsx)(D.m,{title:"Search",description:"Use this Search Center to test Microsot Graph Toolkit search components capabilities"}),(0,fe.jsxs)("div",{className:e.container,children:[(0,fe.jsxs)(we.t,{selectedValue:a,onTabSelect:function(e,t){o(t.value)},children:[(0,fe.jsx)(Te.O,{value:"allResults",children:"All Results"}),(0,fe.jsx)(Te.O,{value:"driveItems",children:"Files"}),(0,fe.jsx)(Te.O,{value:"externalItems",children:"External Items"}),(0,fe.jsx)(Te.O,{value:"people",children:"People"})]}),(0,fe.jsxs)("div",{className:e.panels,children:["allResults"===a&&(0,fe.jsx)(ge,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"driveItems"===a&&(0,fe.jsx)(Be,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"externalItems"===a&&(0,fe.jsx)(Se,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"people"===a&&(0,fe.jsx)(xe,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm})]})]})]})}},9155:function(e,t,r){r.d(t,{g:function(){return l}});var n=r(9249),s=r(7371),i=r(5754),a=r(6906),o=r(4629),l=function(e){(0,i.Z)(r,e);var t=(0,a.Z)(r);function r(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"beta";return(0,n.Z)(this,r),t.call(this,e,s)}return(0,s.Z)(r,[{key:"forComponent",value:function(e){var t=new r(this.client);return this.setComponent(e),t}}],[{key:"fromGraph",value:function(e){var t=new r(e.client);return t.setComponent(e.componentName),t}}]),r}(o.k)},7602:function(e,t,r){r.d(t,{$:function(){return s}});var n=r(8382),s=(0,r(7908).$)("file",n.R)}}]);
//# sourceMappingURL=885.949c1f70.chunk.js.map