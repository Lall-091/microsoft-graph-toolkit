{"version":3,"file":"static/js/218.3244f5fb.chunk.js","mappings":"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","sources":["components/PageHeader.tsx","../../../packages/mgt-element/dist/es6/components/src/components/templatedComponent.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-results/src/components/mgt-search-results/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-results/src/components/mgt-search-results/mgt-search-results-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-results/src/components/mgt-search-results/mgt-search-results.ts","../../../packages/mgt-react/src/generated/search-results.ts","pages/Search/AllResults.tsx","pages/Search/PeopleResults.tsx","pages/Search/ExternalItemsResults.tsx","pages/Search/FilesResults.tsx","pages/SearchPage.tsx","../../../packages/mgt-element/dist/es6/src/BetaGraph.ts","../../../packages/mgt-react/src/generated/file.ts"],"sourcesContent":["import * as React from 'react';\nimport { Divider, makeStyles } from '@fluentui/react-components';\n\nexport interface IPageHeaderProps {\n  title: string;\n  description: string;\n}\n\nconst useStyles = makeStyles({\n  divider: {\n    alignItems: 'self-start',\n    paddingTop: '20px',\n    marginBottom: '20px'\n  }\n});\n\nexport const PageHeader: React.FunctionComponent<IPageHeaderProps> = props => {\n  const styles = useStyles();\n  return (\n    <div>\n      <h1>{props.title}</h1>\n      <div>{props.description}</div>\n      <Divider className={styles.divider} />\n    </div>\n  );\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { property, state } from 'lit/decorators.js';\nimport { html, PropertyValueMap, PropertyValues, TemplateResult } from 'lit';\n\nimport { equals } from '../utils/equals';\nimport { MgtBaseComponent } from './baseComponent';\nimport { TemplateContext } from '../utils/TemplateContext';\nimport { TemplateHelper } from '../utils/TemplateHelper';\n\n/**\n * Lookup for rendered component templates and contexts by slot name.\n */\nexport type RenderedTemplates = Record<\n  string,\n  {\n    /**\n     * Reference to the data context used to render the slot.\n     */\n    context: Record<string, unknown>;\n    /**\n     * Reference to the rendered DOM element corresponding to the slot.\n     */\n    slot: HTMLElement;\n  }\n>;\n\nexport interface TemplateRenderedData {\n  templateType: string;\n  context: Record<string, unknown>;\n  element: HTMLElement;\n}\n\nexport type OrderedHtmlTemplate = HTMLTemplateElement & { templateOrder: number };\n\n/**\n * An abstract class that defines a templatable web component\n *\n * @export\n * @abstract\n * @class MgtTemplatedComponent\n * @extends {MgtBaseComponent}\n *\n * @fires {CustomEvent<MgtElement.TemplateRenderedData>} templateRendered - fires when a template is rendered\n */\nexport abstract class MgtTemplatedComponent extends MgtBaseComponent {\n  /**\n   * Additional data context to be used in template binding\n   * Use this to add event listeners or value converters\n   *\n   * @type {MgtElement.TemplateContext}\n   * @memberof MgtTemplatedComponent\n   */\n  @property({ attribute: false }) public templateContext: TemplateContext;\n\n  /**\n   *\n   * Gets or sets the error (if any) of the request\n   *\n   * @type object\n   * @memberof MgtSearchResults\n   */\n  @state() protected error: object;\n\n  /**\n   * Holds all templates defined by developer\n   *\n   * @protected\n   * @memberof MgtTemplatedComponent\n   */\n  protected templates: Record<string, OrderedHtmlTemplate> = {};\n\n  private _renderedSlots = false;\n  private _renderedTemplates: RenderedTemplates = {};\n  private _slotNamesAddedDuringRender = [];\n\n  constructor() {\n    super();\n\n    this.templateContext = this.templateContext || {};\n  }\n\n  /**\n   * Updates the element. This method reflects property values to attributes.\n   * It can be overridden to render and keep updated element DOM.\n   * Setting properties inside this method will *not* trigger\n   * another update.\n   *\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected update(changedProperties: PropertyValueMap<unknown> | Map<PropertyKey, unknown>) {\n    this.templates = this.getTemplates();\n    this._slotNamesAddedDuringRender = [];\n    super.update(changedProperties);\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param changedProperties Map of changed properties with old values\n   */\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n    this.removeUnusedSlottedElements();\n  }\n\n  /**\n   * Render a <template> by type and return content to render\n   *\n   * @param templateType type of template (indicated by the data-type attribute)\n   * @param context the data context that should be expanded in template\n   * @param slotName the slot name that will be used to host the new rendered template. set to a unique value if multiple templates of this type will be rendered. default is templateType\n   */\n  protected renderTemplate(templateType: string, context: object, slotName?: string): TemplateResult {\n    if (!this.hasTemplate(templateType)) {\n      return null;\n    }\n\n    slotName = slotName || templateType;\n    this._slotNamesAddedDuringRender.push(slotName);\n    this._renderedSlots = true;\n\n    const template = html`\n      <slot name=${slotName}></slot>\n    `;\n\n    const dataContext = { ...context, ...this.templateContext };\n\n    if (Object.prototype.hasOwnProperty.call(this._renderedTemplates, slotName)) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n      const { context: existingContext, slot } = this._renderedTemplates[slotName];\n      if (equals(existingContext, dataContext)) {\n        return template;\n      }\n      this.removeChild(slot);\n    }\n\n    const div = document.createElement('div');\n    div.slot = slotName;\n    div.dataset.generated = 'template';\n\n    TemplateHelper.renderTemplate(div, this.templates[templateType], dataContext);\n\n    this.appendChild(div);\n\n    this._renderedTemplates[slotName] = { context: dataContext, slot: div };\n\n    const templateRenderedData: TemplateRenderedData = { templateType, context: dataContext, element: div };\n    this.fireCustomEvent('templateRendered', templateRenderedData);\n\n    return template;\n  }\n\n  /**\n   * Check if a specific template has been provided.\n   *\n   * @protected\n   * @param {string} templateName\n   * @returns {boolean}\n   * @memberof MgtTemplatedComponent\n   */\n  protected hasTemplate(templateName: string): boolean {\n    return Boolean(this.templates?.[templateName]);\n  }\n\n  private getTemplates() {\n    const templates: Record<string, OrderedHtmlTemplate> = {};\n\n    for (let i = 0; i < this.children.length; i++) {\n      const child = this.children[i];\n      if (child.nodeName === 'TEMPLATE') {\n        const template = child as OrderedHtmlTemplate;\n        if (template.dataset.type) {\n          templates[template.dataset.type] = template;\n        } else {\n          templates.default = template;\n        }\n\n        template.templateOrder = i;\n      }\n    }\n\n    return templates;\n  }\n\n  /**\n   * Renders an error\n   *\n   * @returns\n   */\n  protected renderError(): TemplateResult {\n    if (this.hasTemplate('error')) {\n      return this.renderTemplate('error', this.error);\n    }\n\n    return html`\n      <div class=\"error\">\n        ${this.error}\n      </div>\n    `;\n  }\n\n  private removeUnusedSlottedElements() {\n    if (this._renderedSlots) {\n      for (let i = 0; i < this.children.length; i++) {\n        const child = this.children[i] as HTMLElement;\n        if (child.dataset?.generated && !this._slotNamesAddedDuringRender.includes(child.slot)) {\n          this.removeChild(child);\n          delete this._renderedTemplates[child.slot];\n          i--;\n        }\n      }\n      this._renderedSlots = false;\n    }\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  modified: 'modified on',\n  back: 'Back',\n  next: 'Next',\n  pages: 'pages',\n  page: 'Page'\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, HTMLTemplateResult, nothing, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport {\n  CacheService,\n  CacheStore,\n  equals,\n  MgtTemplatedComponent,\n  prepScopes,\n  Providers,\n  ProviderState,\n  mgtHtml,\n  BetaGraph,\n  BatchResponse,\n  CollectionResponse\n} from '@microsoft/mgt-element';\n\nimport { schemas } from '../../graph/cacheStores';\nimport { strings } from './strings';\nimport { styles } from './mgt-search-results-css';\nimport {\n  DirectoryObject,\n  Drive,\n  DriveItem,\n  EntityType,\n  List,\n  ListItem,\n  Message,\n  SearchHit,\n  SearchHitsContainer,\n  SearchRequest,\n  SearchResponse,\n  Site\n} from '@microsoft/microsoft-graph-types';\nimport { SearchRequest as BetaSearchRequest } from '@microsoft/microsoft-graph-types-beta';\nimport {\n  getIsResponseCacheEnabled,\n  getNameFromUrl,\n  getRelativeDisplayDate,\n  getResponseInvalidationTime,\n  sanitizeSummary,\n  trimFileExtension\n} from '../../utils/Utils';\nimport { getSvg, SvgIcon } from '../../utils/SvgHelper';\nimport { fluentSkeleton, fluentButton, fluentTooltip, fluentDivider } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { CacheResponse } from '../CacheResponse';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { registerMgtFileComponent } from '../mgt-file/mgt-file';\nimport { registerMgtPersonComponent } from '../mgt-person/mgt-person';\n\n/**\n * Object representing a thumbnail\n */\ninterface Thumbnail {\n  /**\n   * The url of the Thumbnail\n   */\n  url?: string;\n}\n\n/**\n * Object representing a Binary Thumbnail\n */\ninterface BinaryThumbnail {\n  /**\n   * The url of the Thumbnail\n   */\n  url?: string;\n\n  /**\n   * The web Url of the Thumbnail\n   */\n  thumbnailWebUrl?: string;\n}\n\n/**\n * Object representing a Search Answer\n */\ninterface Answer {\n  '@odata.type': string;\n  displayName?: string;\n  description?: string;\n  webUrl?: string;\n}\n\n/**\n * Object representing a search resource supporting thumbnails\n */\ninterface ThumbnailResource {\n  thumbnail: Thumbnail;\n}\n\ninterface UserResource {\n  lastModifiedBy?: {\n    user?: {\n      email?: string;\n    };\n  };\n  userPrincipalName?: string;\n}\n\n/**\n * Object representing a Search Resource\n */\ntype SearchResource = Partial<\n  DriveItem & Site & List & Message & ListItem & Drive & DirectoryObject & Answer & ThumbnailResource & UserResource\n>;\n\n/**\n * Object representing a full Search Response\n */\ntype SearchResponseCollection = CollectionResponse<SearchResponse>;\n\nexport const registerMgtSearchResultsComponent = () => {\n  registerFluentComponents(fluentSkeleton, fluentButton, fluentTooltip, fluentDivider);\n\n  registerMgtFileComponent();\n  registerMgtPersonComponent();\n  registerComponent('search-results', MgtSearchResults);\n};\n\n/**\n * **Preview component** Custom element for making Microsoft Graph get queries.\n * Component may change before general availability release.\n *\n * @fires {CustomEvent<DataChangedDetail>} dataChange - Fired when data changes\n *\n * @cssprop --answer-border-radius - {Length} Border radius of an answer\n * @cssprop --answer-box-shadow - {Length} Box shadow of an answer\n * @cssprop --answer-border - {Length} Border of an answer\n * @cssprop --answer-padding - {Length} Padding of an answer\n *\n * @class mgt-search-results\n * @extends {MgtTemplatedComponent}\n */\nexport class MgtSearchResults extends MgtTemplatedComponent {\n  /**\n   * Default page size is 10\n   */\n  private _size = 10;\n\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * Gets all the localization strings for the component\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  private _queryString: string;\n\n  /**\n   * The query to send to Microsoft Search\n   *\n   * @type {string}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'query-string',\n    type: String\n  })\n  public get queryString(): string {\n    return this._queryString;\n  }\n  public set queryString(value: string) {\n    if (this._queryString !== value) {\n      this._queryString = value;\n      this._currentPage = 1;\n      this.setLoadingState(true);\n      void this.requestStateUpdate(true);\n    }\n  }\n\n  /**\n   * Query template to use in complex search scenarios\n   * Query Templates are currently supported only on the beta endpoint\n   */\n  @property({\n    attribute: 'query-template',\n    type: String\n  })\n  public queryTemplate: string;\n\n  /**\n   * One or more types of resources expected in the response.\n   * Possible values are: list, site, listItem, message, event,\n   * drive, driveItem, externalItem.\n   *\n   * @type {string[]}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'entity-types',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public entityTypes: string[] = ['driveItem', 'listItem', 'site'];\n\n  /**\n   * The scopes to request\n   *\n   * @type {string[]}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'scopes',\n    converter: (value, _type) => {\n      return value ? value.toLowerCase().split(',') : null;\n    }\n  })\n  public scopes: string[] = [];\n\n  /**\n   * Content sources to use with External Items\n   *\n   * @type {string[]}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'content-sources',\n    converter: (value, _type) => {\n      return value ? value.toLowerCase().split(',') : null;\n    }\n  })\n  public contentSources: string[] = [];\n\n  /**\n   * Api version to use for request\n   *\n   * @type {string}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'version',\n    reflect: true,\n    type: String\n  })\n  public version = 'v1.0';\n\n  /**\n   * Specifies the offset for the search results.\n   * Offset 0 returns the very first result.\n   *\n   * @type {number}\n   * @memberof MgtSearchResults\n   */\n  public get from(): number {\n    return (this.currentPage - 1) * this.size;\n  }\n\n  /**\n   * The size of the page to be retrieved.\n   * The maximum value is 1000.\n   *\n   * @type {number}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'size',\n    reflect: true,\n    type: Number\n  })\n  public get size(): number {\n    return this._size;\n  }\n  public set size(value) {\n    if (value > this.maxPageSize) {\n      this._size = this.maxPageSize;\n    } else {\n      this._size = value;\n    }\n  }\n\n  /**\n   * The maximum number of pages to be clickable\n   * in the paging control\n   *\n   * @type {number}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'paging-max',\n    reflect: true,\n    type: Number\n  })\n  public pagingMax = 7;\n\n  /**\n   * Sets whether the result thumbnail should be fetched\n   * from the Microsoft Graph\n   *\n   * @type {boolean}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'fetch-thumbnail',\n    type: Boolean\n  })\n  public fetchThumbnail: boolean;\n\n  /**\n   * Contains the fields to be returned for each resource\n   *\n   * @type {string[]}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'fields',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public fields: string[];\n\n  /**\n   * This triggers hybrid sort for messages : the first 3 messages are the most relevant.\n   * This property is only applicable to entityType=message\n   *\n   * @type {boolean}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'enable-top-results',\n    reflect: true,\n    type: Boolean\n  })\n  public enableTopResults = false;\n\n  /**\n   * Enables cache on the response from the specified resource\n   * default = false\n   *\n   * @type {boolean}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'cache-enabled',\n    reflect: true,\n    type: Boolean\n  })\n  public cacheEnabled = false;\n\n  /**\n   * Invalidation period of the cache for the responses in milliseconds\n   *\n   * @type {number}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'cache-invalidation-period',\n    reflect: true,\n    type: Number\n  })\n  public cacheInvalidationPeriod = 30000;\n\n  /**\n   * Gets or sets the response of the request\n   *\n   * @type any\n   * @memberof MgtSearchResults\n   */\n  @state() private response: SearchResponseCollection;\n\n  private isRefreshing = false;\n  private get searchEndpoint() {\n    return '/search/query';\n  }\n  private get maxPageSize() {\n    return 1000;\n  }\n  private readonly defaultFields: string[] = [\n    'webUrl',\n    'lastModifiedBy',\n    'lastModifiedDateTime',\n    'summary',\n    'displayName',\n    'name'\n  ];\n  private _currentPage = 1;\n  @state()\n  public get currentPage(): number {\n    return this._currentPage;\n  }\n  public set currentPage(value: number) {\n    if (this._currentPage !== value) {\n      this._currentPage = value;\n      void this.requestStateUpdate(true);\n    }\n  }\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Synchronizes property values when attributes change.\n   *\n   * @param {string} name\n   * @param {string} oldValue\n   * @param {string} newValue\n   * @memberof MgtSearchResults\n   */\n  public attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    super.attributeChangedCallback(name, oldValue, newValue);\n    void this.requestStateUpdate();\n  }\n\n  /**\n   * Refresh the data\n   *\n   * @param {boolean} [hardRefresh=false]\n   * if false (default), the component will only update if the data changed\n   * if true, the data will be first cleared and reloaded completely\n   * @memberof MgtSearchResults\n   */\n  public refresh(hardRefresh = false) {\n    this.isRefreshing = true;\n    if (hardRefresh) {\n      this.clearState();\n    }\n    void this.requestStateUpdate(hardRefresh);\n  }\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtSearchResults\n   */\n  protected clearState(): void {\n    this.response = null;\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected render(): TemplateResult {\n    let renderedTemplate: TemplateResult = null;\n    let headerTemplate: TemplateResult = null;\n    let footerTemplate: TemplateResult = null;\n\n    if (this.hasTemplate('header')) {\n      headerTemplate = this.renderTemplate('header', this.response);\n    }\n\n    footerTemplate = this.renderFooter(this.response?.value[0]?.hitsContainers[0]);\n\n    if (this.isLoadingState) {\n      renderedTemplate = this.renderLoading();\n    } else if (this.error) {\n      renderedTemplate = this.renderError();\n    } else if (this.response && this.hasTemplate('default')) {\n      renderedTemplate = this.renderTemplate('default', this.response) || html``;\n    } else if (this.response?.value[0]?.hitsContainers[0]) {\n      renderedTemplate = html`${this.response?.value[0]?.hitsContainers[0]?.hits?.map(result =>\n        this.renderResult(result)\n      )}`;\n    } else if (this.hasTemplate('no-data')) {\n      renderedTemplate = this.renderTemplate('no-data', null);\n    } else {\n      renderedTemplate = html``;\n    }\n\n    return html`\n      ${headerTemplate}\n      <div class=\"search-results\">\n        ${renderedTemplate}\n      </div>\n      ${footerTemplate}`;\n  }\n\n  /**\n   * load state into the component.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtSearchResults\n   */\n  protected async loadState() {\n    const provider = Providers.globalProvider;\n\n    this.error = null;\n\n    if (!provider || provider.state !== ProviderState.SignedIn) {\n      return;\n    }\n\n    if (this.queryString) {\n      try {\n        const requestOptions = this.getRequestOptions();\n\n        let cache: CacheStore<CacheResponse>;\n        const key = JSON.stringify({\n          endpoint: `${this.version}${this.searchEndpoint}`,\n          requestOptions\n        });\n        let response: SearchResponseCollection = null;\n\n        if (this.shouldRetrieveCache()) {\n          cache = CacheService.getCache<CacheResponse>(schemas.search, schemas.search.stores.responses);\n          const result: CacheResponse = getIsResponseCacheEnabled() ? await cache.getValue(key) : null;\n          if (result && getResponseInvalidationTime(this.cacheInvalidationPeriod) > Date.now() - result.timeCached) {\n            response = JSON.parse(result.response) as SearchResponseCollection;\n          }\n        }\n\n        if (!response) {\n          const graph = provider.graph.forComponent(this);\n          let request = graph.api(this.searchEndpoint).version(this.version);\n\n          if (this.scopes?.length) {\n            request = request.middlewareOptions(prepScopes(...this.scopes));\n          }\n\n          response = (await request.post({ requests: [requestOptions] })) as SearchResponseCollection;\n\n          if (this.fetchThumbnail) {\n            const thumbnailBatch = graph.createBatch<BinaryThumbnail>();\n            const thumbnailBatchBeta = BetaGraph.fromGraph(graph).createBatch<BinaryThumbnail>();\n\n            const hits =\n              response.value?.length && response.value[0].hitsContainers?.length\n                ? response.value[0].hitsContainers[0]?.hits ?? []\n                : [];\n            for (const element of hits) {\n              const resource = element.resource as SearchResource;\n              if (\n                (resource.size > 0 || resource.webUrl?.endsWith('.aspx')) &&\n                (resource['@odata.type'] === '#microsoft.graph.driveItem' ||\n                  resource['@odata.type'] === '#microsoft.graph.listItem')\n              ) {\n                if (resource['@odata.type'] === '#microsoft.graph.listItem') {\n                  thumbnailBatchBeta.get(\n                    element.hitId.toString(),\n                    `/sites/${resource.parentReference.siteId}/pages/${resource.id}`\n                  );\n                } else {\n                  thumbnailBatch.get(\n                    element.hitId.toString(),\n                    `/drives/${resource.parentReference.driveId}/items/${resource.id}/thumbnails/0/medium`\n                  );\n                }\n              }\n            }\n\n            /**\n             * Based on the batch response, augment the search result resource with the thumbnail url\n             *\n             * @param thumbnailResponse\n             */\n            const augmentResponse = (thumbnailResponse: Map<string, BatchResponse<BinaryThumbnail>>) => {\n              if (thumbnailResponse && thumbnailResponse.size > 0) {\n                for (const [k, value] of thumbnailResponse) {\n                  const result: SearchHit = response.value[0].hitsContainers[0].hits[k] as SearchHit;\n                  const thumbnail: Thumbnail =\n                    result.resource['@odata.type'] === '#microsoft.graph.listItem'\n                      ? { url: value.content.thumbnailWebUrl }\n                      : { url: value.content.url };\n                  (result.resource as SearchResource).thumbnail = thumbnail;\n                }\n              }\n            };\n\n            try {\n              augmentResponse(await thumbnailBatch.executeAll());\n              augmentResponse(await thumbnailBatchBeta.executeAll());\n            } catch {\n              // no-op\n            }\n          }\n\n          if (this.shouldUpdateCache() && response) {\n            cache = CacheService.getCache<CacheResponse>(schemas.search, schemas.search.stores.responses);\n            await cache.putValue(key, { response: JSON.stringify(response) });\n          }\n        }\n\n        if (!equals(this.response, response)) {\n          this.response = response;\n        }\n      } catch (e: unknown) {\n        this.error = e as Error;\n      }\n\n      if (this.response) {\n        this.error = null;\n      }\n    } else {\n      this.response = null;\n    }\n    this.isRefreshing = false;\n    this.fireCustomEvent('dataChange', { response: this.response, error: this.error as Error });\n  }\n\n  /**\n   * Render the loading state.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtSearchResults\n   */\n  protected renderLoading(): TemplateResult {\n    return (\n      this.renderTemplate('loading', null) ||\n      // creates an array of n items where n is the current max number of results, this builds a shimmer for that many results\n      html`\n        ${[...Array<number>(this.size)].map(() => {\n          return html`\n            <div class=\"search-result\">\n              <div class=\"search-result-grid\">\n                <div class=\"search-result-icon\">\n                  <fluent-skeleton class=\"search-result-icon__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                </div>\n                <div class=\"searc-result-content\">\n                  <div class=\"search-result-name\">\n                    <fluent-skeleton class=\"search-result-name__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                  </div>\n                  <div class=\"search-result-info\">\n                    <div class=\"search-result-author\">\n                      <fluent-skeleton class=\"search-result-author__shimmer\" shape=\"circle\" shimmer></fluent-skeleton>\n                    </div>\n                    <div class=\"search-result-date\">\n                      <fluent-skeleton class=\"search-result-date__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                    </div>\n                  </div>\n                  <fluent-skeleton class=\"search-result-content__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                  <fluent-skeleton class=\"search-result-content__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                </div>\n                ${\n                  this.fetchThumbnail &&\n                  html`\n                    <div class=\"search-result-thumbnail\">\n                      <fluent-skeleton class=\"search-result-thumbnail__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                    </div>\n                  `\n                }\n              </div>\n              <fluent-divider></fluent-divider>\n            </div>\n          `;\n        })}\n       `\n    );\n  }\n\n  /**\n   * Render the result item.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtSearchResults\n   */\n  protected renderResult(result: SearchHit): TemplateResult {\n    const type = this.getResourceType(result.resource);\n    if (this.hasTemplate(`result-${type}`)) {\n      return this.renderTemplate(`result-${type}`, result, result.hitId);\n    } else {\n      switch (result.resource['@odata.type']) {\n        case '#microsoft.graph.driveItem':\n          return this.renderDriveItem(result);\n        case '#microsoft.graph.site':\n          return this.renderSite(result);\n        case '#microsoft.graph.person':\n          return this.renderPerson(result);\n        case '#microsoft.graph.drive':\n        case '#microsoft.graph.list':\n          return this.renderList(result);\n        case '#microsoft.graph.listItem':\n          return this.renderListItem(result);\n        case '#microsoft.graph.search.bookmark':\n          return this.renderBookmark(result);\n        case '#microsoft.graph.search.acronym':\n          return this.renderAcronym(result);\n        case '#microsoft.graph.search.qna':\n          return this.renderQnA(result);\n        default:\n          return this.renderDefault(result);\n      }\n    }\n  }\n\n  /**\n   * Renders the footer with pages if required\n   *\n   * @param hitsContainer Search results\n   */\n  private renderFooter(hitsContainer: SearchHitsContainer) {\n    if (this.pagingRequired(hitsContainer)) {\n      const pages = this.getActivePages(hitsContainer.total);\n\n      return html`\n        <div class=\"search-results-pages\">\n          ${this.renderPreviousPage()}\n          ${this.renderFirstPage(pages)}\n          ${this.renderAllPages(pages)}\n          ${this.renderNextPage()}\n        </div>\n      `;\n    }\n  }\n\n  /**\n   * Validates if paging is required based on the provided results\n   *\n   * @param hitsContainer\n   */\n  private pagingRequired(hitsContainer: SearchHitsContainer) {\n    return hitsContainer?.moreResultsAvailable || this.currentPage * this.size < hitsContainer?.total;\n  }\n\n  /**\n   * Gets a list of active pages to render for paging purposes\n   *\n   * @param totalResults Total number of results of the search query\n   */\n  private getActivePages(totalResults: number) {\n    const getFirstPage = () => {\n      const medianPage = this.currentPage - Math.floor(this.pagingMax / 2) - 1;\n\n      if (medianPage >= Math.floor(this.pagingMax / 2)) {\n        return medianPage;\n      } else {\n        return 0;\n      }\n    };\n\n    const pages: number[] = [];\n    const firstPage = getFirstPage();\n\n    if (firstPage + 1 > this.pagingMax - this.currentPage || this.pagingMax === this.currentPage) {\n      for (\n        let i = firstPage + 1;\n        i < Math.ceil(totalResults / this.size) &&\n        i < this.pagingMax + (this.currentPage - 1) &&\n        pages.length < this.pagingMax - 2;\n        ++i\n      ) {\n        pages.push(i + 1);\n      }\n    } else {\n      for (let i = firstPage; i < this.pagingMax; ++i) {\n        pages.push(i + 1);\n      }\n    }\n\n    return pages;\n  }\n\n  /**\n   * Renders all sequential pages buttons\n   *\n   * @param pages\n   */\n  private renderAllPages(pages: number[]) {\n    return html`\n      ${pages.map(\n        page =>\n          html`\n            <fluent-button\n              title=\"${strings.page} ${page}\"\n              appearance=\"stealth\"\n              class=\"${page === this.currentPage ? 'search-results-page-active' : 'search-results-page'}\"\n              @click=\"${() => this.onPageClick(page)}\">\n                ${page}\n            </fluent-button>`\n      )}`;\n  }\n\n  /**\n   * Renders the \"First page\" button\n   *\n   * @param pages\n   */\n  private renderFirstPage(pages: number[]) {\n    return html`\n      ${\n        pages.some(page => page === 1)\n          ? nothing\n          : html`\n              <fluent-button\n                 title=\"${strings.page} 1\"\n                 appearance=\"stealth\"\n                 class=\"search-results-page\"\n                 @click=\"${this.onFirstPageClick}\">\n                 1\n               </fluent-button>`\n          ? html`\n              <fluent-button\n                id=\"page-back-dot\"\n                appearance=\"stealth\"\n                class=\"search-results-page\"\n                title=\"${this.getDotButtonTitle()}\"\n                @click=\"${() => this.onPageClick(this.currentPage - Math.ceil(this.pagingMax / 2))}\"\n              >\n                ...\n              </fluent-button>`\n          : nothing\n      }`;\n  }\n\n  /**\n   * Constructs the \"dot dot dot\" button title\n   */\n  private getDotButtonTitle() {\n    return `${strings.back} ${Math.ceil(this.pagingMax / 2)} ${strings.pages}`;\n  }\n\n  /**\n   * Renders the \"Previous page\" button\n   */\n  private renderPreviousPage() {\n    return this.currentPage > 1\n      ? html`\n          <fluent-button\n            appearance=\"stealth\"\n            class=\"search-results-page\"\n            title=\"${strings.back}\"\n            @click=\"${this.onPageBackClick}\">\n              ${getSvg(SvgIcon.ChevronLeft)}\n            </fluent-button>`\n      : nothing;\n  }\n\n  /**\n   * Renders the \"Next page\" button\n   */\n  private renderNextPage() {\n    return !this.isLastPage()\n      ? html`\n          <fluent-button\n            appearance=\"stealth\"\n            class=\"search-results-page\"\n            title=\"${strings.next}\"\n            aria-label=\"${strings.next}\"\n            @click=\"${this.onPageNextClick}\">\n              ${getSvg(SvgIcon.ChevronRight)}\n            </fluent-button>`\n      : nothing;\n  }\n\n  /**\n   * Triggers a specific page click\n   *\n   * @param pageNumber\n   */\n  private onPageClick(pageNumber: number) {\n    this.currentPage = pageNumber;\n    this.scrollToFirstResult();\n  }\n\n  /**\n   * Triggers a first page click\n   *\n   */\n  private readonly onFirstPageClick = () => {\n    this.currentPage = 1;\n    this.scrollToFirstResult();\n  };\n\n  /**\n   * Triggers a previous page click\n   */\n  private readonly onPageBackClick = () => {\n    this.currentPage--;\n    this.scrollToFirstResult();\n  };\n\n  /**\n   * Triggers a next page click\n   */\n  private readonly onPageNextClick = () => {\n    this.currentPage++;\n    this.scrollToFirstResult();\n  };\n\n  /**\n   * Validates if the current page is the last page of the collection\n   */\n  private isLastPage() {\n    return this.currentPage === Math.ceil(this.response.value[0].hitsContainers[0].total / this.size);\n  }\n\n  /**\n   * Scroll to the top of the search results\n   */\n  private scrollToFirstResult() {\n    const target = this.renderRoot.querySelector('.search-results');\n    target.scrollIntoView({\n      block: 'start',\n      behavior: 'smooth'\n    });\n  }\n\n  /**\n   * Gets the resource type (entity) of a search result\n   *\n   * @param resource\n   */\n  private getResourceType(resource: SearchResource) {\n    return resource['@odata.type'].split('.').pop();\n  }\n\n  /**\n   * Renders a driveItem entity\n   *\n   * @param result\n   */\n  private renderDriveItem(result: SearchHit) {\n    const resource = result.resource as SearchResource;\n    return mgtHtml`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          <mgt-file\n            .fileDetails=\"${result.resource}\"\n            view=\"image\"\n            class=\"file-icon\">\n          </mgt-file>\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${resource.webUrl}?Web=1\" target=\"_blank\">${trimFileExtension(resource.name)}</a>\n          </div>\n          <div class=\"search-result-info\">\n            <div class=\"search-result-author\">\n              <mgt-person\n                person-query=${resource.lastModifiedBy.user.email}\n                view=\"oneLine\"\n                person-card=\"hover\"\n                show-presence=\"true\">\n              </mgt-person>\n            </div>\n            <div class=\"search-result-date\">\n              &nbsp; ${strings.modified} ${getRelativeDisplayDate(new Date(resource.lastModifiedDateTime))}\n            </div>\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${sanitizeSummary(result.summary)}\"></div>\n        </div>\n        ${\n          resource.thumbnail?.url &&\n          html`\n          <div class=\"search-result-thumbnail\">\n            <a href=\"${resource.webUrl}\" target=\"_blank\"><img alt=\"${resource.name}\" src=\"${resource.thumbnail?.url}\" /></a>\n          </div>`\n        }\n\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a site entity\n   *\n   * @param result\n   * @returns\n   */\n  private renderSite(result: SearchHit): HTMLTemplateResult {\n    const resource = result.resource as SearchResource;\n    return html`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          ${this.getResourceIcon(resource)}\n        </div>\n        <div class=\"searc-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${resource.webUrl}\" target=\"_blank\">${resource.displayName}</a>\n          </div>\n          <div class=\"search-result-info\">\n            <div class=\"search-result-url\">\n              <a href=\"${resource.webUrl}\" target=\"_blank\">${resource.webUrl}</a>\n            </div>\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${sanitizeSummary(result.summary)}\"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a list entity\n   *\n   * @param result\n   * @returns\n   */\n  private renderList(result: SearchHit): HTMLTemplateResult {\n    const resource = result.resource as SearchResource;\n    return mgtHtml`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          <mgt-file\n            .fileDetails=\"${result.resource}\"\n            view=\"image\">\n          </mgt-file>\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${resource.webUrl}?Web=1\" target=\"_blank\">\n              ${trimFileExtension(resource.name || getNameFromUrl(resource.webUrl))}\n            </a>\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${sanitizeSummary(result.summary)}\"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a listItem entity\n   *\n   * @param result\n   * @returns\n   */\n  private renderListItem(result: SearchHit): HTMLTemplateResult {\n    const resource = result.resource as SearchResource;\n    return mgtHtml`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          ${resource.webUrl.endsWith('.aspx') ? getSvg(SvgIcon.News) : getSvg(SvgIcon.FileOuter)}\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${resource.webUrl}?Web=1\" target=\"_blank\">\n              ${trimFileExtension(resource.name || getNameFromUrl(resource.webUrl))}\n            </a>\n          </div>\n          <div class=\"search-result-info\">\n            <div class=\"search-result-author\">\n              <mgt-person\n                person-query=${resource.lastModifiedBy.user.email}\n                view=\"oneLine\"\n                person-card=\"hover\"\n                show-presence=\"true\">\n              </mgt-person>\n            </div>\n            <div class=\"search-result-date\">\n              &nbsp; ${strings.modified} ${getRelativeDisplayDate(new Date(resource.lastModifiedDateTime))}\n            </div>\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${sanitizeSummary(result.summary)}\"></div>\n        </div>\n        ${\n          resource.thumbnail?.url &&\n          html`\n          <div class=\"search-result-thumbnail\">\n            <a href=\"${resource.webUrl}\" target=\"_blank\"><img alt=\"${trimFileExtension(\n              resource.name || getNameFromUrl(resource.webUrl)\n            )}\" src=\"${resource.thumbnail?.url || nothing}\" /></a>\n          </div>`\n        }\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a person entity\n   *\n   * @param result\n   * @returns\n   */\n  private renderPerson(result: SearchHit): HTMLTemplateResult {\n    const resource = result.resource as SearchResource;\n    return mgtHtml`\n      <div class=\"search-result\">\n        <mgt-person\n          view=\"fourLines\"\n          person-query=${resource.userPrincipalName}\n          person-card=\"hover\"\n          show-presence=\"true\">\n        </mgt-person>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a bookmark entity\n   *\n   * @param result\n   */\n  private renderBookmark(result: SearchHit) {\n    return this.renderAnswer(result, SvgIcon.DoubleBookmark);\n  }\n\n  /**\n   * Renders an acronym entity\n   *\n   * @param result\n   */\n  private renderAcronym(result: SearchHit) {\n    return this.renderAnswer(result, SvgIcon.BookOpen);\n  }\n\n  /**\n   * Renders a qna entity\n   *\n   * @param result\n   */\n  private renderQnA(result: SearchHit) {\n    return this.renderAnswer(result, SvgIcon.BookQuestion);\n  }\n\n  /**\n   * Renders an answer entity\n   *\n   * @param result\n   */\n  private renderAnswer(result: SearchHit, icon: SvgIcon) {\n    const resource = result.resource as SearchResource;\n    return html`\n      <div class=\"search-result-grid search-result-answer\">\n        <div class=\"search-result-icon\">\n          ${getSvg(icon)}\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${this.getResourceUrl(resource)}?Web=1\" target=\"_blank\">${resource.displayName}</a>\n          </div>\n          <div class=\"search-result-summary\">${resource.description}</div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders any entity\n   *\n   * @param result\n   */\n  private renderDefault(result: SearchHit) {\n    const resource = result.resource as SearchResource;\n    const resourceUrl = this.getResourceUrl(resource);\n    return html`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          ${this.getResourceIcon(resource)}\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            ${\n              resourceUrl\n                ? html`\n                  <a href=\"${resourceUrl}?Web=1\" target=\"_blank\">${this.getResourceName(resource)}</a>\n                `\n                : html`\n                  ${this.getResourceName(resource)}\n                `\n            }\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${this.getResultSummary(result)}\"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Gets default resource URLs\n   *\n   * @param resource\n   */\n  private getResourceUrl(resource: SearchResource) {\n    return resource.webUrl || /* resource.url ||*/ resource.webLink || null;\n  }\n\n  /**\n   * Gets default resource Names\n   *\n   * @param resource\n   */\n  private getResourceName(resource: SearchResource) {\n    return resource.displayName || resource.subject || trimFileExtension(resource.name);\n  }\n\n  /**\n   * Gets default result summary\n   *\n   * @param resource\n   */\n  private getResultSummary(result: SearchHit) {\n    return sanitizeSummary(result.summary || (result.resource as SearchResource)?.description || null);\n  }\n\n  /**\n   * Gets default resource icon\n   *\n   * @param resource\n   */\n  private getResourceIcon(resource: SearchResource) {\n    switch (resource['@odata.type']) {\n      case '#microsoft.graph.site':\n        return getSvg(SvgIcon.Globe);\n      case '#microsoft.graph.message':\n        return getSvg(SvgIcon.Email);\n      case '#microsoft.graph.event':\n        return getSvg(SvgIcon.Event);\n      case 'microsoft.graph.chatMessage':\n        return getSvg(SvgIcon.SmallChat);\n      default:\n        return getSvg(SvgIcon.FileOuter);\n    }\n  }\n\n  /**\n   * Validates if cache should be retrieved\n   *\n   * @returns\n   */\n  private shouldRetrieveCache(): boolean {\n    return getIsResponseCacheEnabled() && this.cacheEnabled && !this.isRefreshing;\n  }\n\n  /**\n   * Validates if cache should be updated\n   *\n   * @returns\n   */\n  private shouldUpdateCache(): boolean {\n    return getIsResponseCacheEnabled() && this.cacheEnabled;\n  }\n\n  /**\n   * Builds the appropriate RequestOption for the search query\n   *\n   * @returns\n   */\n  private getRequestOptions(): SearchRequest | BetaSearchRequest {\n    const requestOptions: SearchRequest = {\n      entityTypes: this.entityTypes as EntityType[],\n      query: {\n        queryString: this.queryString\n      },\n      from: this.from ? this.from : undefined,\n      size: this.size ? this.size : undefined,\n      fields: this.getFields(),\n      enableTopResults: this.enableTopResults ? this.enableTopResults : undefined\n    };\n\n    if (this.entityTypes.includes('externalItem')) {\n      requestOptions.contentSources = this.contentSources;\n    }\n\n    if (this.version === 'beta') {\n      (requestOptions as BetaSearchRequest).query.queryTemplate = this.queryTemplate ? this.queryTemplate : undefined;\n    }\n\n    return requestOptions;\n  }\n\n  /**\n   * Gets the fields and default fields for default render methods\n   *\n   * @returns\n   */\n  private getFields(): string[] {\n    if (this.fields) {\n      return this.defaultFields.concat(this.fields);\n    }\n\n    return undefined;\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/consistent-type-definitions */\nimport { DataChangedDetail } from '@microsoft/mgt-components/dist/es6/exports';\nimport { registerMgtSearchResultsComponent } from '@microsoft/mgt-components/dist/es6/components/components';\nimport { TemplateContext,ComponentMediaQuery,TemplateRenderedData } from '@microsoft/mgt-element';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraphBeta from '@microsoft/microsoft-graph-types-beta';\nimport {wrapMgt} from '../Mgt';\n\nexport type SearchResultsProps = {\n\tqueryString?: string;\n\tqueryTemplate?: string;\n\tentityTypes?: string[];\n\tscopes?: string[];\n\tcontentSources?: string[];\n\tversion?: string;\n\tfrom?: number;\n\tsize?: number;\n\tpagingMax?: number;\n\tfetchThumbnail?: boolean;\n\tfields?: string[];\n\tenableTopResults?: boolean;\n\tcacheEnabled?: boolean;\n\tcacheInvalidationPeriod?: number;\n\tcurrentPage?: number;\n\ttemplateContext?: TemplateContext;\n\tmediaQuery?: ComponentMediaQuery;\n\tdataChange?: (e: CustomEvent<DataChangedDetail>) => void;\n\ttemplateRendered?: (e: CustomEvent<TemplateRenderedData>) => void;\n}\n\nexport const SearchResults = wrapMgt<SearchResultsProps>('search-results', registerMgtSearchResultsComponent);\n\n","import * as React from 'react';\nimport { IResultsProps } from './IResultsProps';\nimport { MgtTemplateProps, SearchResults } from '@microsoft/mgt-react';\n\nexport const AllResults: React.FunctionComponent<IResultsProps> = (props: IResultsProps) => {\n  return (\n    <>\n      {props.searchTerm && (\n        <>\n          {props.searchTerm !== '*' && (\n            <SearchResults\n              entityTypes={['bookmark']}\n              queryString={props.searchTerm}\n              version=\"beta\"\n              size={1}\n              scopes={['Bookmark.Read.All']}\n            >\n              <NoDataTemplate template=\"no-data\"></NoDataTemplate>\n            </SearchResults>\n          )}\n          <SearchResults\n            entityTypes={['driveItem', 'listItem', 'site']}\n            queryString={props.searchTerm}\n            scopes={['Files.Read.All', 'Sites.Read.All']}\n            fetchThumbnail={true}\n          ></SearchResults>\n        </>\n      )}\n    </>\n  );\n};\n\nconst NoDataTemplate = (props: MgtTemplateProps) => {\n  return <></>;\n};\n","import { SearchResults } from '@microsoft/mgt-react';\nimport * as React from 'react';\nimport { IResultsProps } from './IResultsProps';\n\nexport const PeopleResults: React.FunctionComponent<IResultsProps> = (props: IResultsProps) => {\n  return (\n    <>\n      <SearchResults entityTypes={['people']} size={20} queryString={props.searchTerm} version={'beta'}></SearchResults>\n    </>\n  );\n};\n","import { SearchResults } from '@microsoft/mgt-react';\nimport * as React from 'react';\nimport { IResultsProps } from './IResultsProps';\n\nexport const ExternalItemsResults: React.FunctionComponent<IResultsProps> = (props: IResultsProps) => {\n  return (\n    <>\n      {props.searchTerm && (\n        <SearchResults\n          entityTypes={['externalItem']}\n          contentSources={['/external/connections/contosoBlogPosts']}\n          queryString={props.searchTerm}\n          scopes={['ExternalItem.Read.All']}\n          version=\"beta\"\n        ></SearchResults>\n      )}\n    </>\n  );\n};\n","import { SearchResults } from '@microsoft/mgt-react';\nimport * as React from 'react';\nimport { IResultsProps } from './IResultsProps';\nimport { MgtTemplateProps, Person, File, PersonCardInteraction, ViewType } from '@microsoft/mgt-react';\nimport {\n  DataGrid,\n  DataGridBody,\n  DataGridCell,\n  DataGridHeader,\n  DataGridHeaderCell,\n  DataGridRow,\n  SkeletonItem,\n  TableCellLayout,\n  TableColumnDefinition,\n  createTableColumn,\n  makeStyles,\n  shorthands,\n  tokens\n} from '@fluentui/react-components';\nimport { SlideSearchRegular } from '@fluentui/react-icons';\n\nconst useStyles = makeStyles({\n  container: {\n    ...shorthands.gap('16px'),\n    display: 'flex',\n    flexDirection: 'row',\n    flexWrap: 'wrap'\n  },\n  card: {\n    width: '300px',\n    height: 'fit-content',\n    maxWidth: '100%'\n  },\n  caption: {\n    color: tokens.colorNeutralForeground3\n  },\n  noDataSearchTerm: {\n    fontWeight: tokens.fontWeightSemibold\n  },\n  emptyContainer: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n    height: 'calc(100vh - 300px)'\n  },\n  fileContainer: {\n    display: 'flex'\n  },\n  fileTitle: {\n    paddingLeft: '10px',\n    alignSelf: 'center'\n  },\n  noDataMessage: {\n    paddingLeft: '10px'\n  },\n  noDataIcon: {\n    fontSize: '128px'\n  },\n  row: {\n    cursor: 'pointer'\n  }\n});\n\nconst pageSize = 30;\n\nexport const FilesResults: React.FunctionComponent<IResultsProps> = (props: IResultsProps) => {\n  return (\n    <>\n      {props.searchTerm && (\n        <SearchResults\n          entityTypes={['driveItem']}\n          queryString={props.searchTerm}\n          fetchThumbnail={true}\n          queryTemplate=\"({searchTerms}) ContentTypeId:0x0101*\"\n          version=\"beta\"\n          fields={['createdBy', 'lastModifiedDateTime', 'Title', 'DefaultEncodingURL']}\n          size={pageSize}\n          cacheEnabled={true}\n        >\n          <FileTemplate template=\"default\"></FileTemplate>\n          <FileTemplate template=\"loading\"></FileTemplate>\n          <FileNoDataTemplate template=\"no-data\"></FileNoDataTemplate>\n        </SearchResults>\n      )}\n    </>\n  );\n};\n\nconst getColumns = (shimmered: boolean, styles): TableColumnDefinition<any>[] => {\n  const columns: TableColumnDefinition<any>[] = [\n    createTableColumn<any>({\n      columnId: 'name',\n      renderHeaderCell: () => {\n        return 'Name';\n      },\n      renderCell: item => {\n        return (\n          <TableCellLayout>\n            {shimmered ? (\n              <SkeletonItem shape=\"rectangle\" style={{ width: '120px' }} />\n            ) : (\n              <div className={styles.fileContainer}>\n                <File fileDetails={item.resource} view={ViewType.image} />\n                <span className={styles.fileTitle}>{item.resource.listItem.fields.title}</span>\n              </div>\n            )}\n          </TableCellLayout>\n        );\n      }\n    }),\n    createTableColumn<any>({\n      columnId: 'modified',\n      renderHeaderCell: () => {\n        return 'Modified';\n      },\n      renderCell: item => {\n        return (\n          <TableCellLayout>\n            {shimmered ? (\n              <SkeletonItem shape=\"rectangle\" style={{ width: '120px' }} />\n            ) : (\n              getRelativeDisplayDate(new Date(item.resource.lastModifiedDateTime))\n            )}\n          </TableCellLayout>\n        );\n      }\n    }),\n    createTableColumn<any>({\n      columnId: 'owner',\n      renderHeaderCell: () => {\n        return 'Owner';\n      },\n      renderCell: item => {\n        return (\n          <TableCellLayout>\n            {shimmered ? (\n              <div\n                style={{\n                  display: 'grid',\n                  alignItems: 'center',\n                  position: 'relative',\n                  gridTemplateColumns: 'min-content 80%',\n                  gap: '10px'\n                }}\n              >\n                <SkeletonItem shape=\"circle\" size={32} />\n                <SkeletonItem style={{ width: '120px' }} />\n              </div>\n            ) : (\n              <Person\n                personQuery={item.resource.createdBy.user.email}\n                view={ViewType.oneline}\n                personCardInteraction={PersonCardInteraction.hover}\n              />\n            )}\n          </TableCellLayout>\n        );\n      }\n    })\n  ];\n\n  return columns;\n};\n\nconst FileTemplate = (props: MgtTemplateProps) => {\n  const styles = useStyles();\n  const [driveItems] = React.useState<any>(props.dataContext.value?.[0]?.hitsContainers[0]?.hits);\n\n  const onRowClick = (item: any) => {\n    const url = new URL(item.resource.listItem.fields.defaultEncodingURL);\n    url.searchParams.append('Web', '1');\n    window.open(url.toString(), '_blank');\n  };\n\n  return (\n    <div>\n      <DataGrid\n        columns={getColumns(props.template === 'loading', styles)}\n        items={props.template === 'loading' ? [...Array<number>(pageSize)] : driveItems}\n      >\n        <DataGridHeader>\n          <DataGridRow>\n            {({ renderHeaderCell }) => <DataGridHeaderCell>{renderHeaderCell()}</DataGridHeaderCell>}\n          </DataGridRow>\n        </DataGridHeader>\n        <DataGridBody<any>>\n          {({ item, rowId }) => (\n            <DataGridRow<any> key={rowId} className={styles.row} onClick={() => onRowClick(item)}>\n              {({ renderCell }) => <DataGridCell>{renderCell(item)}</DataGridCell>}\n            </DataGridRow>\n          )}\n        </DataGridBody>\n      </DataGrid>\n    </div>\n  );\n};\n\nconst FileNoDataTemplate = (props: MgtTemplateProps) => {\n  const styles = useStyles();\n  const [searchTerms] = React.useState<string[]>(props.dataContext.value[0]?.searchTerms);\n\n  return (\n    <div className={styles.emptyContainer}>\n      <div>\n        <SlideSearchRegular className={styles.noDataIcon} />\n      </div>\n      <div className={styles.noDataMessage}>\n        We couldn't find any results for <span className={styles.noDataSearchTerm}>{searchTerms.join(' ')}</span>\n      </div>\n    </div>\n  );\n};\n\nconst getRelativeDisplayDate = (date: Date): string => {\n  const now = new Date();\n\n  // Today -> 5:23 PM\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n  if (date >= today) {\n    return date.toLocaleString('default', {\n      hour: 'numeric',\n      minute: 'numeric'\n    });\n  }\n\n  // This week -> Sun 3:04 PM\n  const sunday = new Date(today);\n  sunday.setDate(now.getDate() - now.getDay());\n  if (date >= sunday) {\n    return date.toLocaleString('default', {\n      hour: 'numeric',\n      minute: 'numeric',\n      weekday: 'short'\n    });\n  }\n\n  // Last two week -> Sun 8/2\n  const lastTwoWeeks = new Date(sunday);\n  lastTwoWeeks.setDate(sunday.getDate() - 7);\n  if (date >= lastTwoWeeks) {\n    return date.toLocaleString('default', {\n      day: 'numeric',\n      month: 'numeric',\n      weekday: 'short'\n    });\n  }\n\n  // More than two weeks ago -> 8/1/2020\n  return date.toLocaleString('default', {\n    day: 'numeric',\n    month: 'numeric',\n    year: 'numeric'\n  });\n};\n","import * as React from 'react';\nimport { PageHeader } from '../components/PageHeader';\nimport { AllResults, PeopleResults } from './Search';\nimport {\n  SelectTabData,\n  SelectTabEvent,\n  Tab,\n  TabList,\n  TabValue,\n  makeStyles,\n  shorthands\n} from '@fluentui/react-components';\nimport { useAppContext } from '../AppContext';\nimport { ExternalItemsResults } from './Search/ExternalItemsResults';\nimport { FilesResults } from './Search/FilesResults';\n\nconst useStyles = makeStyles({\n  panels: {\n    ...shorthands.padding('10px')\n  },\n  container: {\n    maxWidth: '1028px',\n    width: '100%'\n  }\n});\n\nconst SearchPage: React.FunctionComponent = () => {\n  const styles = useStyles();\n  const appContext = useAppContext();\n  const [query] = React.useState(new URLSearchParams(window.location.search).get('q'));\n\n  const [selectedTab, setSelectedTab] = React.useState<TabValue>('allResults');\n\n  const onTabSelect = (event: SelectTabEvent, data: SelectTabData) => {\n    setSelectedTab(data.value);\n  };\n\n  return (\n    <>\n      <PageHeader\n        title={'Search'}\n        description={'Use this Search Center to test Microsot Graph Toolkit search components capabilities'}\n      ></PageHeader>\n\n      <div className={styles.container}>\n        <TabList selectedValue={selectedTab} onTabSelect={onTabSelect}>\n          <Tab value=\"allResults\">All Results</Tab>\n          <Tab value=\"driveItems\">Files</Tab>\n          <Tab value=\"externalItems\">External Items</Tab>\n          <Tab value=\"people\">People</Tab>\n        </TabList>\n        <div className={styles.panels}>\n          {selectedTab === 'allResults' && <AllResults searchTerm={query ?? appContext.state.searchTerm}></AllResults>}\n          {selectedTab === 'driveItems' && (\n            <FilesResults searchTerm={query ?? appContext.state.searchTerm}></FilesResults>\n          )}\n          {selectedTab === 'externalItems' && (\n            <ExternalItemsResults searchTerm={query ?? appContext.state.searchTerm}></ExternalItemsResults>\n          )}\n          {selectedTab === 'people' && (\n            <PeopleResults searchTerm={query ?? appContext.state.searchTerm}></PeopleResults>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default SearchPage;\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph } from './IGraph';\nimport { Client } from '@microsoft/microsoft-graph-client';\nimport { Graph } from './Graph';\n\n/**\n * The version of the Graph to use for making requests.\n */\nconst GRAPH_VERSION = 'beta';\n\n/**\n * BetaGraph\n *\n * @export\n * @class BetaGraph\n * @extends {BetaGraph}\n */\nexport class BetaGraph extends Graph {\n  /**\n   * get a BetaGraph instance based on an existing IGraph implementation.\n   *\n   * @static\n   * @param {Graph} graph\n   * @returns {BetaGraph}\n   * @memberof BetaGraph\n   */\n  public static fromGraph(graph: IGraph): BetaGraph {\n    const betaGraph = new BetaGraph(graph.client);\n    betaGraph.setComponent(graph.componentName);\n    return betaGraph;\n  }\n\n  constructor(client: Client, version: string = GRAPH_VERSION) {\n    super(client, version);\n  }\n\n  /**\n   * Returns a new instance of the Graph using the same\n   * client within the context of the provider.\n   *\n   * @param {Element} component\n   * @returns {BetaGraph}\n   * @memberof BetaGraph\n   */\n  public forComponent(component: Element | string): BetaGraph {\n    const graph = new BetaGraph(this.client);\n    this.setComponent(component);\n    return graph;\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/consistent-type-definitions */\nimport { OfficeGraphInsightString,ViewType } from '@microsoft/mgt-components/dist/es6/exports';\nimport { registerMgtFileComponent } from '@microsoft/mgt-components/dist/es6/components/components';\nimport { TemplateContext,ComponentMediaQuery,TemplateRenderedData } from '@microsoft/mgt-element';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraphBeta from '@microsoft/microsoft-graph-types-beta';\nimport {wrapMgt} from '../Mgt';\n\nexport type FileProps = {\n\tfileQuery?: string;\n\tsiteId?: string;\n\tdriveId?: string;\n\tgroupId?: string;\n\tlistId?: string;\n\tuserId?: string;\n\titemId?: string;\n\titemPath?: string;\n\tinsightType?: OfficeGraphInsightString;\n\tinsightId?: string;\n\tfileDetails?: MicrosoftGraph.DriveItem;\n\tfileIcon?: string;\n\tdriveItem?: MicrosoftGraph.DriveItem;\n\tline1Property?: string;\n\tline2Property?: string;\n\tline3Property?: string;\n\tview?: ViewType;\n\ttemplateContext?: TemplateContext;\n\tmediaQuery?: ComponentMediaQuery;\n\ttemplateRendered?: (e: CustomEvent<TemplateRenderedData>) => void;\n}\n\nexport const File = wrapMgt<FileProps>('file', registerMgtFileComponent);\n\n"],"names":["useStyles","makeStyles","divider","alignItems","paddingTop","marginBottom","PageHeader","props","styles","_jsxs","children","_jsx","title","description","Divider","className","MgtTemplatedComponent","_MgtBaseComponent","_inherits","_super","_createSuper","_this","_classCallCheck","call","templates","_renderedSlots","_renderedTemplates","_slotNamesAddedDuringRender","templateContext","_createClass","key","value","changedProperties","this","getTemplates","_get","_getPrototypeOf","prototype","removeUnusedSlottedElements","templateType","context","slotName","hasTemplate","push","template","html","_templateObject","_taggedTemplateLiteral","dataContext","Object","assign","hasOwnProperty","_this$_renderedTempla","existingContext","slot","equals","removeChild","div","document","createElement","dataset","generated","TemplateHelper","renderTemplate","appendChild","templateRenderedData","element","fireCustomEvent","templateName","Boolean","_a","i","length","child","nodeName","type","default","templateOrder","error","_templateObject2","includes","MgtBaseComponent","__decorate","property","attribute","state","strings","modified","back","next","pages","page","css","MgtSearchResults","_MgtTemplatedComponen","_size","entityTypes","scopes","contentSources","version","pagingMax","enableTopResults","cacheEnabled","cacheInvalidationPeriod","isRefreshing","defaultFields","_currentPage","onFirstPageClick","currentPage","scrollToFirstResult","onPageBackClick","onPageNextClick","get","_queryString","set","setLoadingState","requestStateUpdate","size","maxPageSize","name","oldValue","newValue","hardRefresh","arguments","undefined","clearState","response","footerTemplate","_this2","renderedTemplate","headerTemplate","renderFooter","_b","hitsContainers","isLoadingState","renderLoading","renderError","_d","_c","_h","_g","_f","_e","hits","map","result","renderResult","_templateObject3","_templateObject4","provider","Providers","globalProvider","ProviderState","SignedIn","_context","abrupt","queryString","prev","requestOptions","getRequestOptions","JSON","stringify","endpoint","concat","searchEndpoint","shouldRetrieveCache","cache","CacheService","getCache","schemas","search","stores","responses","getIsResponseCacheEnabled","getValue","t0","sent","getResponseInvalidationTime","Date","now","timeCached","parse","graph","forComponent","request","api","middlewareOptions","prepScopes","apply","_toConsumableArray","post","requests","fetchThumbnail","thumbnailBatch","createBatch","thumbnailBatchBeta","BetaGraph","fromGraph","_iterator","_createForOfIteratorHelper","s","_step","n","done","resource","webUrl","endsWith","hitId","toString","parentReference","siteId","id","driveId","err","e","f","augmentResponse","thumbnailResponse","_step2","_iterator2","_step2$value","_slicedToArray","k","thumbnail","url","content","thumbnailWebUrl","t1","executeAll","t2","t3","t4","t5","shouldUpdateCache","putValue","t6","stop","_callee","_this3","_templateObject5","Array","_templateObject6","_templateObject7","getResourceType","renderDriveItem","renderSite","renderPerson","renderList","renderListItem","renderBookmark","renderAcronym","renderQnA","renderDefault","hitsContainer","pagingRequired","getActivePages","total","_templateObject8","renderPreviousPage","renderFirstPage","renderAllPages","renderNextPage","moreResultsAvailable","totalResults","_this4","firstPage","medianPage","Math","floor","getFirstPage","ceil","_this5","_templateObject9","_templateObject10","onPageClick","_this6","_templateObject11","some","nothing","_templateObject12","_templateObject13","getDotButtonTitle","_templateObject14","getSvg","SvgIcon","ChevronLeft","isLastPage","_templateObject15","ChevronRight","pageNumber","renderRoot","querySelector","scrollIntoView","block","behavior","split","pop","mgtHtml","_templateObject16","trimFileExtension","lastModifiedBy","user","email","getRelativeDisplayDate","lastModifiedDateTime","sanitizeSummary","summary","_templateObject17","_templateObject18","getResourceIcon","displayName","_templateObject19","getNameFromUrl","_templateObject20","News","FileOuter","_templateObject21","_templateObject22","userPrincipalName","renderAnswer","DoubleBookmark","BookOpen","BookQuestion","icon","_templateObject23","getResourceUrl","resourceUrl","_templateObject24","_templateObject25","getResourceName","_templateObject26","getResultSummary","webLink","subject","Globe","Email","Event","SmallChat","query","from","fields","getFields","queryTemplate","String","converter","v","trim","_type","toLowerCase","reflect","Number","SearchResults","wrapMgt","registerFluentComponents","fluentSkeleton","fluentButton","fluentTooltip","fluentDivider","registerMgtFileComponent","registerMgtPersonComponent","registerComponent","AllResults","_Fragment","searchTerm","NoDataTemplate","PeopleResults","ExternalItemsResults","container","_objectSpread","shorthands","gap","display","flexDirection","flexWrap","card","width","height","maxWidth","caption","color","tokens","colorNeutralForeground3","noDataSearchTerm","fontWeight","fontWeightSemibold","emptyContainer","justifyContent","fileContainer","fileTitle","paddingLeft","alignSelf","noDataMessage","noDataIcon","fontSize","row","cursor","FilesResults","FileTemplate","FileNoDataTemplate","getColumns","shimmered","createTableColumn","columnId","renderHeaderCell","renderCell","item","TableCellLayout","SkeletonItem","shape","style","File","fileDetails","view","ViewType","image","listItem","position","gridTemplateColumns","Person","personQuery","createdBy","oneline","personCardInteraction","PersonCardInteraction","hover","_props$dataContext$va","_props$dataContext$va2","_props$dataContext$va3","_React$useState","React","driveItems","DataGrid","columns","items","DataGridHeader","DataGridRow","_ref","DataGridHeaderCell","DataGridBody","_ref2","rowId","onClick","URL","defaultEncodingURL","searchParams","append","window","open","onRowClick","_ref3","DataGridCell","_props$dataContext$va4","_React$useState3","searchTerms","SlideSearchRegular","join","date","today","getFullYear","getMonth","getDate","toLocaleString","hour","minute","sunday","setDate","getDay","weekday","lastTwoWeeks","day","month","year","panels","padding","appContext","useAppContext","URLSearchParams","location","_React$useState4","selectedTab","setSelectedTab","TabList","selectedValue","onTabSelect","event","data","Tab","_Graph","client","component","setComponent","betaGraph","componentName","Graph"],"sourceRoot":""}