"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[218],{505:function(e,t,r){r.d(t,{m:function(){return o}});r(969);var n=r(7780),s=r(3583),i=r(7574),a=(0,n.Z)({divider:{alignItems:"self-start",paddingTop:"20px",marginBottom:"20px"}}),o=function(e){var t=a();return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:e.title}),(0,i.jsx)("div",{children:e.description}),(0,i.jsx)(s.i,{className:t.divider})]})}},8218:function(e,t,r){r.r(t),r.d(t,{default:function(){return rt}});var n,s,i=r(6234),a=r(3028),o=r(969),l=r(505),c=r(2723),u=r(1361),d=r(8079),h=r(1171),p=r(9249),m=r(7371),v=r(3069),f=r(5058),g=r(5754),y=r(6906),x=r(9242),b=r(5378),k=r(2742),w=r(2292),T=r(7667),j=r(8556),S=r(9155),C=r(8402),_=r(3022),R=r(8158),P=r(8028),Z=function(e,t,r,n){var s,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,r,a):s(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},I=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},z=function(e){(0,g.Z)(r,e);var t=(0,y.Z)(r);function r(){var e;return(0,p.Z)(this,r),(e=t.call(this)).templates={},e._renderedSlots=!1,e._renderedTemplates={},e._slotNamesAddedDuringRender=[],e.templateContext=e.templateContext||{},e}return(0,m.Z)(r,[{key:"update",value:function(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],(0,v.Z)((0,f.Z)(r.prototype),"update",this).call(this,e)}},{key:"updated",value:function(e){(0,v.Z)((0,f.Z)(r.prototype),"updated",this).call(this,e),this.removeUnusedSlottedElements()}},{key:"renderTemplate",value:function(e,t,r){if(!this.hasTemplate(e))return null;r=r||e,this._slotNamesAddedDuringRender.push(r),this._renderedSlots=!0;var s=(0,x.dy)(n||(n=(0,h.Z)(["\n      <slot name=","></slot>\n    "])),r),i=Object.assign(Object.assign({},t),this.templateContext);if(Object.prototype.hasOwnProperty.call(this._renderedTemplates,r)){var a=this._renderedTemplates[r],o=a.context,l=a.slot;if((0,C.f)(o,i))return s;this.removeChild(l)}var c=document.createElement("div");c.slot=r,c.dataset.generated="template",P.p.renderTemplate(c,this.templates[e],i),this.appendChild(c),this._renderedTemplates[r]={context:i,slot:c};var u={templateType:e,context:i,element:c};return this.fireCustomEvent("templateRendered",u),s}},{key:"hasTemplate",value:function(e){var t;return Boolean(null===(t=this.templates)||void 0===t?void 0:t[e])}},{key:"getTemplates",value:function(){for(var e={},t=0;t<this.children.length;t++){var r=this.children[t];if("TEMPLATE"===r.nodeName){var n=r;n.dataset.type?e[n.dataset.type]=n:e.default=n,n.templateOrder=t}}return e}},{key:"renderError",value:function(){return this.hasTemplate("error")?this.renderTemplate("error",this.error):(0,x.dy)(s||(s=(0,h.Z)(['\n      <div class="error">\n        ',"\n      </div>\n    "])),this.error)}},{key:"removeUnusedSlottedElements",value:function(){var e;if(this._renderedSlots){for(var t=0;t<this.children.length;t++){var r=this.children[t];(null===(e=r.dataset)||void 0===e?void 0:e.generated)&&!this._slotNamesAddedDuringRender.includes(r.slot)&&(this.removeChild(r),delete this._renderedTemplates[r.slot],t--)}this._renderedSlots=!1}}}]),r}(R.b);Z([(0,b.Cb)({attribute:!1}),I("design:type",Object)],z.prototype,"templateContext",void 0),Z([(0,b.SB)(),I("design:type",Object)],z.prototype,"error",void 0);var D,N,q,M,L,O,U,F,A,B,E,W,H,$,Q,K,V,G,J,Y,X,ee,te,re,ne,se,ie,ae=r(2097),oe={modified:"modified on",back:"Back",next:"Next",pages:"pages",page:"Page"},le=[(0,x.iv)(D||(D=(0,h.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n'])))],ce=r(9698),ue=r(4223),de=r(3408),he=r(9576),pe=r(8388),me=r(5827),ve=r(6552),fe=r(8097),ge=r(8382),ye=r(9768),xe=function(e,t,r,n){var s,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,r,a):s(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},be=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ke=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function o(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))},we=function(e){(0,g.Z)(r,e);var t=(0,y.Z)(r);function r(){var e;return(0,p.Z)(this,r),(e=t.call(this))._size=10,e.entityTypes=["driveItem","listItem","site"],e.scopes=[],e.contentSources=[],e.version="v1.0",e.pagingMax=7,e.enableTopResults=!1,e.cacheEnabled=!1,e.cacheInvalidationPeriod=3e4,e.isRefreshing=!1,e.defaultFields=["webUrl","lastModifiedBy","lastModifiedDateTime","summary","displayName","name"],e._currentPage=1,e.onFirstPageClick=function(){e.currentPage=1,e.scrollToFirstResult()},e.onPageBackClick=function(){e.currentPage--,e.scrollToFirstResult()},e.onPageNextClick=function(){e.currentPage++,e.scrollToFirstResult()},e}return(0,m.Z)(r,[{key:"strings",get:function(){return oe}},{key:"queryString",get:function(){return this._queryString},set:function(e){this._queryString!==e&&(this._queryString=e,this._currentPage=1,this.setLoadingState(!0),this.requestStateUpdate(!0))}},{key:"from",get:function(){return(this.currentPage-1)*this.size}},{key:"size",get:function(){return this._size},set:function(e){e>this.maxPageSize?this._size=this.maxPageSize:this._size=e}},{key:"searchEndpoint",get:function(){return"/search/query"}},{key:"maxPageSize",get:function(){return 1e3}},{key:"currentPage",get:function(){return this._currentPage},set:function(e){this._currentPage!==e&&(this._currentPage=e,this.requestStateUpdate(!0))}},{key:"attributeChangedCallback",value:function(e,t,n){(0,v.Z)((0,f.Z)(r.prototype),"attributeChangedCallback",this).call(this,e,t,n),this.requestStateUpdate()}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}},{key:"clearState",value:function(){this.response=null}},{key:"render",value:function(){var e,t,r,n,s,i,a,o,l,c=this,u=null,d=null;return this.hasTemplate("header")&&(d=this.renderTemplate("header",this.response)),l=this.renderFooter(null===(t=null===(e=this.response)||void 0===e?void 0:e.value[0])||void 0===t?void 0:t.hitsContainers[0]),u=this.isLoadingState?this.renderLoading():this.error?this.renderError():this.response&&this.hasTemplate("default")?this.renderTemplate("default",this.response)||(0,x.dy)(N||(N=(0,h.Z)([""]))):(null===(n=null===(r=this.response)||void 0===r?void 0:r.value[0])||void 0===n?void 0:n.hitsContainers[0])?(0,x.dy)(q||(q=(0,h.Z)(["",""])),null===(o=null===(a=null===(i=null===(s=this.response)||void 0===s?void 0:s.value[0])||void 0===i?void 0:i.hitsContainers[0])||void 0===a?void 0:a.hits)||void 0===o?void 0:o.map((function(e){return c.renderResult(e)}))):this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(0,x.dy)(M||(M=(0,h.Z)([""]))),(0,x.dy)(L||(L=(0,h.Z)(["\n      ",'\n      <div class="search-results">\n        ',"\n      </div>\n      ",""])),d,u,l)}},{key:"loadState",value:function(){var e,t,r,n,s,a;return ke(this,void 0,void 0,(0,c.Z)().mark((function o(){var l,h,p,m,v,f,g,y,x,b,_,R,P,Z,I,z;return(0,c.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(l=k.C.globalProvider,this.error=null,l&&l.state===w.Aw.SignedIn){o.next=4;break}return o.abrupt("return");case 4:if(!this.queryString){o.next=62;break}if(o.prev=5,h=this.getRequestOptions(),m=JSON.stringify({endpoint:"".concat(this.version).concat(this.searchEndpoint),requestOptions:h}),v=null,!this.shouldRetrieveCache()){o.next=20;break}if(p=T.Q.getCache(ae.O.search,ae.O.search.stores.responses),!(0,ce.rK)()){o.next=17;break}return o.next=14,p.getValue(m);case 14:o.t0=o.sent,o.next=18;break;case 17:o.t0=null;case 18:(f=o.t0)&&(0,ce.n6)(this.cacheInvalidationPeriod)>Date.now()-f.timeCached&&(v=JSON.parse(f.response));case 20:if(v){o.next=53;break}return g=l.graph.forComponent(this),y=g.api(this.searchEndpoint).version(this.version),(null===(e=this.scopes)||void 0===e?void 0:e.length)&&(y=y.middlewareOptions(j.z.apply(void 0,(0,d.Z)(this.scopes)))),o.next=26,y.post({requests:[h]});case 26:if(v=o.sent,!this.fetchThumbnail){o.next=49;break}x=g.createBatch(),b=S.g.fromGraph(g).createBatch(),_=(null===(t=v.value)||void 0===t?void 0:t.length)&&(null===(r=v.value[0].hitsContainers)||void 0===r?void 0:r.length)&&null!==(s=null===(n=v.value[0].hitsContainers[0])||void 0===n?void 0:n.hits)&&void 0!==s?s:[],R=(0,u.Z)(_);try{for(R.s();!(P=R.n()).done;)Z=P.value,!((I=Z.resource).size>0||(null===(a=I.webUrl)||void 0===a?void 0:a.endsWith(".aspx")))||"#microsoft.graph.driveItem"!==I["@odata.type"]&&"#microsoft.graph.listItem"!==I["@odata.type"]||("#microsoft.graph.listItem"===I["@odata.type"]?b.get(Z.hitId.toString(),"/sites/".concat(I.parentReference.siteId,"/pages/").concat(I.id)):x.get(Z.hitId.toString(),"/drives/".concat(I.parentReference.driveId,"/items/").concat(I.id,"/thumbnails/0/medium")))}catch(c){R.e(c)}finally{R.f()}return z=function(e){if(e&&e.size>0){var t,r=(0,u.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=(0,i.Z)(t.value,2),s=n[0],a=n[1],o=v.value[0].hitsContainers[0].hits[s],l="#microsoft.graph.listItem"===o.resource["@odata.type"]?{url:a.content.thumbnailWebUrl}:{url:a.content.url};o.resource.thumbnail=l}}catch(c){r.e(c)}finally{r.f()}}},o.prev=34,o.t1=z,o.next=38,x.executeAll();case 38:return o.t2=o.sent,(0,o.t1)(o.t2),o.t3=z,o.next=43,b.executeAll();case 43:o.t4=o.sent,(0,o.t3)(o.t4),o.next=49;break;case 47:o.prev=47,o.t5=o.catch(34);case 49:if(!this.shouldUpdateCache()||!v){o.next=53;break}return p=T.Q.getCache(ae.O.search,ae.O.search.stores.responses),o.next=53,p.putValue(m,{response:JSON.stringify(v)});case 53:(0,C.f)(this.response,v)||(this.response=v),o.next=59;break;case 56:o.prev=56,o.t6=o.catch(5),this.error=o.t6;case 59:this.response&&(this.error=null),o.next=63;break;case 62:this.response=null;case 63:this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error});case 65:case"end":return o.stop()}}),o,this,[[5,56],[34,47]])})))}},{key:"renderLoading",value:function(){var e=this;return this.renderTemplate("loading",null)||(0,x.dy)(O||(O=(0,h.Z)(["\n        ","\n       "])),(0,d.Z)(Array(this.size)).map((function(){return(0,x.dy)(U||(U=(0,h.Z)(['\n            <div class="search-result">\n              <div class="search-result-grid">\n                <div class="search-result-icon">\n                  <fluent-skeleton class="search-result-icon__shimmer" shape="rect" shimmer></fluent-skeleton>\n                </div>\n                <div class="searc-result-content">\n                  <div class="search-result-name">\n                    <fluent-skeleton class="search-result-name__shimmer" shape="rect" shimmer></fluent-skeleton>\n                  </div>\n                  <div class="search-result-info">\n                    <div class="search-result-author">\n                      <fluent-skeleton class="search-result-author__shimmer" shape="circle" shimmer></fluent-skeleton>\n                    </div>\n                    <div class="search-result-date">\n                      <fluent-skeleton class="search-result-date__shimmer" shape="rect" shimmer></fluent-skeleton>\n                    </div>\n                  </div>\n                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>\n                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>\n                </div>\n                ',"\n              </div>\n              <fluent-divider></fluent-divider>\n            </div>\n          "])),e.fetchThumbnail&&(0,x.dy)(F||(F=(0,h.Z)(['\n                    <div class="search-result-thumbnail">\n                      <fluent-skeleton class="search-result-thumbnail__shimmer" shape="rect" shimmer></fluent-skeleton>\n                    </div>\n                  ']))))})))}},{key:"renderResult",value:function(e){var t=this.getResourceType(e.resource);if(this.hasTemplate("result-".concat(t)))return this.renderTemplate("result-".concat(t),e,e.hitId);switch(e.resource["@odata.type"]){case"#microsoft.graph.driveItem":return this.renderDriveItem(e);case"#microsoft.graph.site":return this.renderSite(e);case"#microsoft.graph.person":return this.renderPerson(e);case"#microsoft.graph.drive":case"#microsoft.graph.list":return this.renderList(e);case"#microsoft.graph.listItem":return this.renderListItem(e);case"#microsoft.graph.search.bookmark":return this.renderBookmark(e);case"#microsoft.graph.search.acronym":return this.renderAcronym(e);case"#microsoft.graph.search.qna":return this.renderQnA(e);default:return this.renderDefault(e)}}},{key:"renderFooter",value:function(e){if(this.pagingRequired(e)){var t=this.getActivePages(e.total);return(0,x.dy)(A||(A=(0,h.Z)(['\n        <div class="search-results-pages">\n          ',"\n          ","\n          ","\n          ","\n        </div>\n      "])),this.renderPreviousPage(),this.renderFirstPage(t),this.renderAllPages(t),this.renderNextPage())}}},{key:"pagingRequired",value:function(e){return(null===e||void 0===e?void 0:e.moreResultsAvailable)||this.currentPage*this.size<(null===e||void 0===e?void 0:e.total)}},{key:"getActivePages",value:function(e){var t=this,r=[],n=function(){var e=t.currentPage-Math.floor(t.pagingMax/2)-1;return e>=Math.floor(t.pagingMax/2)?e:0}();if(n+1>this.pagingMax-this.currentPage||this.pagingMax===this.currentPage)for(var s=n+1;s<Math.ceil(e/this.size)&&s<this.pagingMax+(this.currentPage-1)&&r.length<this.pagingMax-2;++s)r.push(s+1);else for(var i=n;i<this.pagingMax;++i)r.push(i+1);return r}},{key:"renderAllPages",value:function(e){var t=this;return(0,x.dy)(B||(B=(0,h.Z)(["\n      ",""])),e.map((function(e){return(0,x.dy)(E||(E=(0,h.Z)(['\n            <fluent-button\n              title="'," ",'"\n              appearance="stealth"\n              class="','"\n              @click="','">\n                ',"\n            </fluent-button>"])),oe.page,e,e===t.currentPage?"search-results-page-active":"search-results-page",(function(){return t.onPageClick(e)}),e)})))}},{key:"renderFirstPage",value:function(e){var t=this;return(0,x.dy)(W||(W=(0,h.Z)(["\n      ",""])),e.some((function(e){return 1===e}))?x.Ld:(0,x.dy)(H||(H=(0,h.Z)(['\n              <fluent-button\n                 title="',' 1"\n                 appearance="stealth"\n                 class="search-results-page"\n                 @click="','">\n                 1\n               </fluent-button>'])),oe.page,this.onFirstPageClick)?(0,x.dy)($||($=(0,h.Z)(['\n              <fluent-button\n                id="page-back-dot"\n                appearance="stealth"\n                class="search-results-page"\n                title="','"\n                @click="','"\n              >\n                ...\n              </fluent-button>'])),this.getDotButtonTitle(),(function(){return t.onPageClick(t.currentPage-Math.ceil(t.pagingMax/2))})):x.Ld)}},{key:"getDotButtonTitle",value:function(){return"".concat(oe.back," ").concat(Math.ceil(this.pagingMax/2)," ").concat(oe.pages)}},{key:"renderPreviousPage",value:function(){return this.currentPage>1?(0,x.dy)(Q||(Q=(0,h.Z)(['\n          <fluent-button\n            appearance="stealth"\n            class="search-results-page"\n            title="','"\n            @click="','">\n              ',"\n            </fluent-button>"])),oe.back,this.onPageBackClick,(0,ue.d)(ue.l.ChevronLeft)):x.Ld}},{key:"renderNextPage",value:function(){return this.isLastPage()?x.Ld:(0,x.dy)(K||(K=(0,h.Z)(['\n          <fluent-button\n            appearance="stealth"\n            class="search-results-page"\n            title="','"\n            aria-label="','"\n            @click="','">\n              ',"\n            </fluent-button>"])),oe.next,oe.next,this.onPageNextClick,(0,ue.d)(ue.l.ChevronRight))}},{key:"onPageClick",value:function(e){this.currentPage=e,this.scrollToFirstResult()}},{key:"isLastPage",value:function(){return this.currentPage===Math.ceil(this.response.value[0].hitsContainers[0].total/this.size)}},{key:"scrollToFirstResult",value:function(){this.renderRoot.querySelector(".search-results").scrollIntoView({block:"start",behavior:"smooth"})}},{key:"getResourceType",value:function(e){return e["@odata.type"].split(".").pop()}},{key:"renderDriveItem",value:function(e){var t,r,n=e.resource;return(0,_.b)(V||(V=(0,h.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          <mgt-file\n            .fileDetails="','"\n            view="image"\n            class="file-icon">\n          </mgt-file>\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">','</a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-author">\n              <mgt-person\n                person-query=','\n                view="oneLine"\n                person-card="hover"\n                show-presence="true">\n              </mgt-person>\n            </div>\n            <div class="search-result-date">\n              &nbsp; '," ",'\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n        ',"\n\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),e.resource,n.webUrl,(0,ce.ju)(n.name),n.lastModifiedBy.user.email,oe.modified,(0,ce.t9)(new Date(n.lastModifiedDateTime)),(0,ce.$8)(e.summary),(null===(t=n.thumbnail)||void 0===t?void 0:t.url)&&(0,x.dy)(G||(G=(0,h.Z)(['\n          <div class="search-result-thumbnail">\n            <a href="','" target="_blank"><img alt="','" src="','" /></a>\n          </div>'])),n.webUrl,n.name,null===(r=n.thumbnail)||void 0===r?void 0:r.url))}},{key:"renderSite",value:function(e){var t=e.resource;return(0,x.dy)(J||(J=(0,h.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="searc-result-content">\n          <div class="search-result-name">\n            <a href="','" target="_blank">','</a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-url">\n              <a href="','" target="_blank">','</a>\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),this.getResourceIcon(t),t.webUrl,t.displayName,t.webUrl,t.webUrl,(0,ce.$8)(e.summary))}},{key:"renderList",value:function(e){var t=e.resource;return(0,_.b)(Y||(Y=(0,h.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          <mgt-file\n            .fileDetails="','"\n            view="image">\n          </mgt-file>\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">\n              ','\n            </a>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),e.resource,t.webUrl,(0,ce.ju)(t.name||(0,ce.nN)(t.webUrl)),(0,ce.$8)(e.summary))}},{key:"renderListItem",value:function(e){var t,r,n=e.resource;return(0,_.b)(X||(X=(0,h.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">\n              ','\n            </a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-author">\n              <mgt-person\n                person-query=','\n                view="oneLine"\n                person-card="hover"\n                show-presence="true">\n              </mgt-person>\n            </div>\n            <div class="search-result-date">\n              &nbsp; '," ",'\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n        ',"\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),n.webUrl.endsWith(".aspx")?(0,ue.d)(ue.l.News):(0,ue.d)(ue.l.FileOuter),n.webUrl,(0,ce.ju)(n.name||(0,ce.nN)(n.webUrl)),n.lastModifiedBy.user.email,oe.modified,(0,ce.t9)(new Date(n.lastModifiedDateTime)),(0,ce.$8)(e.summary),(null===(t=n.thumbnail)||void 0===t?void 0:t.url)&&(0,x.dy)(ee||(ee=(0,h.Z)(['\n          <div class="search-result-thumbnail">\n            <a href="','" target="_blank"><img alt="','" src="','" /></a>\n          </div>'])),n.webUrl,(0,ce.ju)(n.name||(0,ce.nN)(n.webUrl)),(null===(r=n.thumbnail)||void 0===r?void 0:r.url)||x.Ld))}},{key:"renderPerson",value:function(e){var t=e.resource;return(0,_.b)(te||(te=(0,h.Z)(['\n      <div class="search-result">\n        <mgt-person\n          view="fourLines"\n          person-query=','\n          person-card="hover"\n          show-presence="true">\n        </mgt-person>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),t.userPrincipalName)}},{key:"renderBookmark",value:function(e){return this.renderAnswer(e,ue.l.DoubleBookmark)}},{key:"renderAcronym",value:function(e){return this.renderAnswer(e,ue.l.BookOpen)}},{key:"renderQnA",value:function(e){return this.renderAnswer(e,ue.l.BookQuestion)}},{key:"renderAnswer",value:function(e,t){var r=e.resource;return(0,x.dy)(re||(re=(0,h.Z)(['\n      <div class="search-result-grid search-result-answer">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">','</a>\n          </div>\n          <div class="search-result-summary">',"</div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),(0,ue.d)(t),this.getResourceUrl(r),r.displayName,r.description)}},{key:"renderDefault",value:function(e){var t=e.resource,r=this.getResourceUrl(t);return(0,x.dy)(ne||(ne=(0,h.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            ','\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),this.getResourceIcon(t),r?(0,x.dy)(se||(se=(0,h.Z)(['\n                  <a href="','?Web=1" target="_blank">',"</a>\n                "])),r,this.getResourceName(t)):(0,x.dy)(ie||(ie=(0,h.Z)(["\n                  ","\n                "])),this.getResourceName(t)),this.getResultSummary(e))}},{key:"getResourceUrl",value:function(e){return e.webUrl||e.webLink||null}},{key:"getResourceName",value:function(e){return e.displayName||e.subject||(0,ce.ju)(e.name)}},{key:"getResultSummary",value:function(e){var t;return(0,ce.$8)(e.summary||(null===(t=e.resource)||void 0===t?void 0:t.description)||null)}},{key:"getResourceIcon",value:function(e){switch(e["@odata.type"]){case"#microsoft.graph.site":return(0,ue.d)(ue.l.Globe);case"#microsoft.graph.message":return(0,ue.d)(ue.l.Email);case"#microsoft.graph.event":return(0,ue.d)(ue.l.Event);case"microsoft.graph.chatMessage":return(0,ue.d)(ue.l.SmallChat);default:return(0,ue.d)(ue.l.FileOuter)}}},{key:"shouldRetrieveCache",value:function(){return(0,ce.rK)()&&this.cacheEnabled&&!this.isRefreshing}},{key:"shouldUpdateCache",value:function(){return(0,ce.rK)()&&this.cacheEnabled}},{key:"getRequestOptions",value:function(){var e={entityTypes:this.entityTypes,query:{queryString:this.queryString},from:this.from?this.from:void 0,size:this.size?this.size:void 0,fields:this.getFields(),enableTopResults:this.enableTopResults?this.enableTopResults:void 0};return this.entityTypes.includes("externalItem")&&(e.contentSources=this.contentSources),"beta"===this.version&&(e.query.queryTemplate=this.queryTemplate?this.queryTemplate:void 0),e}},{key:"getFields",value:function(){if(this.fields)return this.defaultFields.concat(this.fields)}}],[{key:"styles",get:function(){return le}}]),r}(z);xe([(0,b.Cb)({attribute:"query-string",type:String}),be("design:type",String),be("design:paramtypes",[String])],we.prototype,"queryString",null),xe([(0,b.Cb)({attribute:"query-template",type:String}),be("design:type",String)],we.prototype,"queryTemplate",void 0),xe([(0,b.Cb)({attribute:"entity-types",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),be("design:type",Array)],we.prototype,"entityTypes",void 0),xe([(0,b.Cb)({attribute:"scopes",converter:function(e,t){return e?e.toLowerCase().split(","):null}}),be("design:type",Array)],we.prototype,"scopes",void 0),xe([(0,b.Cb)({attribute:"content-sources",converter:function(e,t){return e?e.toLowerCase().split(","):null}}),be("design:type",Array)],we.prototype,"contentSources",void 0),xe([(0,b.Cb)({attribute:"version",reflect:!0,type:String}),be("design:type",Object)],we.prototype,"version",void 0),xe([(0,b.Cb)({attribute:"size",reflect:!0,type:Number}),be("design:type",Number),be("design:paramtypes",[Object])],we.prototype,"size",null),xe([(0,b.Cb)({attribute:"paging-max",reflect:!0,type:Number}),be("design:type",Object)],we.prototype,"pagingMax",void 0),xe([(0,b.Cb)({attribute:"fetch-thumbnail",type:Boolean}),be("design:type",Boolean)],we.prototype,"fetchThumbnail",void 0),xe([(0,b.Cb)({attribute:"fields",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),be("design:type",Array)],we.prototype,"fields",void 0),xe([(0,b.Cb)({attribute:"enable-top-results",reflect:!0,type:Boolean}),be("design:type",Object)],we.prototype,"enableTopResults",void 0),xe([(0,b.Cb)({attribute:"cache-enabled",reflect:!0,type:Boolean}),be("design:type",Object)],we.prototype,"cacheEnabled",void 0),xe([(0,b.Cb)({attribute:"cache-invalidation-period",reflect:!0,type:Number}),be("design:type",Object)],we.prototype,"cacheInvalidationPeriod",void 0),xe([(0,b.SB)(),be("design:type",Object)],we.prototype,"response",void 0),xe([(0,b.SB)(),be("design:type",Number),be("design:paramtypes",[Number])],we.prototype,"currentPage",null);var Te=(0,r(7908).$)("search-results",(function(){(0,ve.J)(de.aV,he.hb,pe.x,me.ue),(0,ge.R)(),(0,ye.yQ)(),(0,fe.R)("search-results",we)})),je=r(7574),Se=function(e){return(0,je.jsx)(je.Fragment,{children:e.searchTerm&&(0,je.jsxs)(je.Fragment,{children:["*"!==e.searchTerm&&(0,je.jsx)(Te,{entityTypes:["bookmark"],queryString:e.searchTerm,version:"beta",size:1,scopes:["Bookmark.Read.All"],children:(0,je.jsx)(Ce,{template:"no-data"})}),(0,je.jsx)(Te,{entityTypes:["driveItem","listItem","site"],queryString:e.searchTerm,scopes:["Files.Read.All","Sites.Read.All"],fetchThumbnail:!0})]})})},Ce=function(e){return(0,je.jsx)(je.Fragment,{})},_e=function(e){return(0,je.jsx)(je.Fragment,{children:(0,je.jsx)(Te,{entityTypes:["people"],size:20,queryString:e.searchTerm,version:"beta"})})},Re=r(7780),Pe=r(4220),Ze=r(8013),Ie=r(9191),ze=r(2205),De=function(e){return(0,je.jsx)(je.Fragment,{children:e.searchTerm&&(0,je.jsx)(Te,{entityTypes:["externalItem"],contentSources:["/external/connections/contosoBlogPosts"],queryString:e.searchTerm,scopes:["ExternalItem.Read.All"],version:"beta"})})},Ne=r(7602),qe=r(9251),Me=r(2476),Le=r(5607),Oe=r(9591),Ue=r(1654),Fe=r(4508),Ae=r(6816),Be=r(2880),Ee=r(1901),We=r(7828),He=r(2277),$e=r(5908),Qe=r(4636),Ke=r(710),Ve=(0,Re.Z)({container:(0,a.Z)((0,a.Z)({},Pe.q5.gap("16px")),{},{display:"flex",flexDirection:"row",flexWrap:"wrap"}),card:{width:"300px",height:"fit-content",maxWidth:"100%"},caption:{color:Oe.T.colorNeutralForeground3},noDataSearchTerm:{fontWeight:Oe.T.fontWeightSemibold},emptyContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"calc(100vh - 300px)"},fileContainer:{display:"flex"},fileTitle:{paddingLeft:"10px",alignSelf:"center"},noDataMessage:{paddingLeft:"10px"},noDataIcon:{fontSize:"128px"},row:{cursor:"pointer"}}),Ge=function(e){return(0,je.jsx)(je.Fragment,{children:e.searchTerm&&(0,je.jsxs)(Te,{entityTypes:["driveItem"],queryString:e.searchTerm,fetchThumbnail:!0,queryTemplate:"({searchTerms}) ContentTypeId:0x0101*",version:"beta",fields:["createdBy","lastModifiedDateTime","Title","DefaultEncodingURL"],size:30,cacheEnabled:!0,children:[(0,je.jsx)(Ye,{template:"default"}),(0,je.jsx)(Ye,{template:"loading"}),(0,je.jsx)(Xe,{template:"no-data"})]})})},Je=function(e,t){return[(0,Ue.p)({columnId:"name",renderHeaderCell:function(){return"Name"},renderCell:function(r){return(0,je.jsx)(Fe.K,{children:e?(0,je.jsx)(Ae.j,{shape:"rectangle",style:{width:"120px"}}):(0,je.jsxs)("div",{className:t.fileContainer,children:[(0,je.jsx)(Ne.$,{fileDetails:r.resource,view:qe.b.image}),(0,je.jsx)("span",{className:t.fileTitle,children:r.resource.listItem.fields.title})]})})}}),(0,Ue.p)({columnId:"modified",renderHeaderCell:function(){return"Modified"},renderCell:function(t){return(0,je.jsx)(Fe.K,{children:e?(0,je.jsx)(Ae.j,{shape:"rectangle",style:{width:"120px"}}):et(new Date(t.resource.lastModifiedDateTime))})}}),(0,Ue.p)({columnId:"owner",renderHeaderCell:function(){return"Owner"},renderCell:function(t){return(0,je.jsx)(Fe.K,{children:e?(0,je.jsxs)("div",{style:{display:"grid",alignItems:"center",position:"relative",gridTemplateColumns:"min-content 80%",gap:"10px"},children:[(0,je.jsx)(Ae.j,{shape:"circle",size:32}),(0,je.jsx)(Ae.j,{style:{width:"120px"}})]}):(0,je.jsx)(Me.F,{personQuery:t.resource.createdBy.user.email,view:qe.b.oneline,personCardInteraction:Le.c.hover})})}})]},Ye=function(e){var t,r,n,s=Ve(),a=o.useState(null===(t=e.dataContext.value)||void 0===t||null===(r=t[0])||void 0===r||null===(n=r.hitsContainers[0])||void 0===n?void 0:n.hits),l=(0,i.Z)(a,1)[0];return(0,je.jsx)("div",{children:(0,je.jsxs)(Be._,{columns:Je("loading"===e.template,s),items:"loading"===e.template?(0,d.Z)(Array(30)):l,children:[(0,je.jsx)(Ee.S,{children:(0,je.jsx)(We.m,{children:function(e){var t=e.renderHeaderCell;return(0,je.jsx)(He.p,{children:t()})}})}),(0,je.jsx)($e.s,{children:function(e){var t=e.item,r=e.rowId;return(0,je.jsx)(We.m,{className:s.row,onClick:function(){return function(e){var t=new URL(e.resource.listItem.fields.defaultEncodingURL);t.searchParams.append("Web","1"),window.open(t.toString(),"_blank")}(t)},children:function(e){var r=e.renderCell;return(0,je.jsx)(Qe.a,{children:r(t)})}},r)}})]})})},Xe=function(e){var t,r=Ve(),n=o.useState(null===(t=e.dataContext.value[0])||void 0===t?void 0:t.searchTerms),s=(0,i.Z)(n,1)[0];return(0,je.jsxs)("div",{className:r.emptyContainer,children:[(0,je.jsx)("div",{children:(0,je.jsx)(Ke.vRj,{className:r.noDataIcon})}),(0,je.jsxs)("div",{className:r.noDataMessage,children:["We couldn't find any results for ",(0,je.jsx)("span",{className:r.noDataSearchTerm,children:s.join(" ")})]})]})},et=function(e){var t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=r)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});var n=new Date(r);if(n.setDate(t.getDate()-t.getDay()),e>=n)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});var s=new Date(n);return s.setDate(n.getDate()-7),e>=s?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},tt=(0,Re.Z)({panels:(0,a.Z)({},Pe.q5.padding("10px")),container:{maxWidth:"1028px",width:"100%"}}),rt=function(){var e=tt(),t=(0,ze.b)(),r=o.useState(new URLSearchParams(window.location.search).get("q")),n=(0,i.Z)(r,1)[0],s=o.useState("allResults"),a=(0,i.Z)(s,2),c=a[0],u=a[1];return(0,je.jsxs)(je.Fragment,{children:[(0,je.jsx)(l.m,{title:"Search",description:"Use this Search Center to test Microsot Graph Toolkit search components capabilities"}),(0,je.jsxs)("div",{className:e.container,children:[(0,je.jsxs)(Ze.t,{selectedValue:c,onTabSelect:function(e,t){u(t.value)},children:[(0,je.jsx)(Ie.O,{value:"allResults",children:"All Results"}),(0,je.jsx)(Ie.O,{value:"driveItems",children:"Files"}),(0,je.jsx)(Ie.O,{value:"externalItems",children:"External Items"}),(0,je.jsx)(Ie.O,{value:"people",children:"People"})]}),(0,je.jsxs)("div",{className:e.panels,children:["allResults"===c&&(0,je.jsx)(Se,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"driveItems"===c&&(0,je.jsx)(Ge,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"externalItems"===c&&(0,je.jsx)(De,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"people"===c&&(0,je.jsx)(_e,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm})]})]})]})}},9155:function(e,t,r){r.d(t,{g:function(){return l}});var n=r(9249),s=r(7371),i=r(5754),a=r(6906),o=r(4629),l=function(e){(0,i.Z)(r,e);var t=(0,a.Z)(r);function r(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"beta";return(0,n.Z)(this,r),t.call(this,e,s)}return(0,s.Z)(r,[{key:"forComponent",value:function(e){var t=new r(this.client);return this.setComponent(e),t}}],[{key:"fromGraph",value:function(e){var t=new r(e.client);return t.setComponent(e.componentName),t}}]),r}(o.k)},7602:function(e,t,r){r.d(t,{$:function(){return s}});var n=r(8382),s=(0,r(7908).$)("file",n.R)}}]);
//# sourceMappingURL=218.3244f5fb.chunk.js.map