"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[105],{505:function(e,t,n){n.d(t,{m:function(){return o}});n(969);var r=n(7780),i=n(3583),s=n(7574),a=(0,r.Z)({divider:{alignItems:"self-start",paddingTop:"20px",marginBottom:"20px"}}),o=function(e){var t=a();return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:e.title}),(0,s.jsx)("div",{children:e.description}),(0,s.jsx)(i.i,{className:t.divider})]})}},7724:function(e,t,n){n.d(t,{xV:function(){return N}});var r,i,s,a,o,l,c,u=n(2723),p=n(8079),h=n(1171),d=n(9249),f=n(7371),v=n(5754),g=n(6906),b=n(9242),y=n(5378),m=n(7667),x=n(2742),k=n(2292),C=n(8556),O=n(8402),P=n(6781),R=n(5854),j=n(7425),w=n(2097),T=n(8097),Z=function(e,t,n,r){var i,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(a=(s<3?i(a):s>3?i(t,n,a):i(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},S=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{l(r.next(e))}catch(t){s(t)}}function o(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))},L=function(e){return Array.isArray(null===e||void 0===e?void 0:e.value)};!function(e){e.json="json",e.image="image"}(c||(c={}));var I=function(){return m.Q.config.response.isEnabled&&m.Q.config.isEnabled},N=function(){return(0,T.R)("get",Q)},Q=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,d.Z)(this,n),(e=t.apply(this,arguments)).scopes=[],e.version="v1.0",e.type=c.json,e.maxPages=3,e.pollingRate=0,e.cacheEnabled=!1,e.cacheInvalidationPeriod=0,e.isPolling=!1,e.isRefreshing=!1,e.renderLoading=function(){var t=e.renderTemplate("loading",null);return L(e.response)?e.renderValueContentWithDefaultTemplate((0,b.dy)(r||(r=(0,h.Z)([""," "," "])),e.response.value.map((function(t){return e.renderTemplate("value",t,t.id)})),t)):t},e.renderContent=function(){if(e.hasTemplate("value")&&L(e.response)){var t=L(e.response)?(0,b.dy)(i||(i=(0,h.Z)(["\n          ","\n        "])),e.response.value.map((function(t){return e.renderTemplate("value",t,t.id)}))):e.renderTemplate("value",e.response);return e.renderValueContentWithDefaultTemplate(t)}return e.response?e.renderTemplate("default",e.response)||(0,b.dy)(s||(s=(0,h.Z)([""]))):e.hasTemplate("no-data")?e.renderTemplate("no-data",null):(0,b.dy)(a||(a=(0,h.Z)([""])))},e}return(0,f.Z)(n,[{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this._task.run()}},{key:"clearState",value:function(){this.response=null}},{key:"args",value:function(){return[this.providerState,this.resource,this.scopes,this.version,this.pollingRate,this.type,this.maxPages,this.cacheEnabled,this.cacheInvalidationPeriod]}},{key:"renderValueContentWithDefaultTemplate",value:function(e){if(this.hasTemplate("default")){var t=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?(0,b.dy)(o||(o=(0,h.Z)(["\n          ","","\n        "])),t,e):(0,b.dy)(l||(l=(0,h.Z)(["\n          ","","\n        "])),e,t)}return e}},{key:"loadState",value:function(){var e,t,n;return E(this,void 0,void 0,(0,u.Z)().mark((function r(){var i,s,a,o,l,h,d,f,v,g,b,y,P,T,Z,S,E,N=this;return(0,u.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=x.C.globalProvider,this.error=null,i&&i.state===k.Aw.SignedIn){r.next=4;break}return r.abrupt("return");case 4:if(!this.resource){r.next=75;break}if(r.prev=5,a="".concat(this.version).concat(this.resource),o=null,!this.shouldRetrieveCache()){r.next=19;break}if(s=m.Q.getCache(w.O.get,w.O.get.stores.responses),!I()){r.next=16;break}return r.next=13,s.getValue(a);case 13:r.t0=r.sent,r.next=17;break;case 16:r.t0=null;case 17:(l=r.t0)&&(this.cacheInvalidationPeriod||m.Q.config.response.invalidationPeriod||m.Q.config.defaultInvalidationPeriod)>Date.now()-l.timeCached&&(o=JSON.parse(l.response));case 19:if(o){r.next=66;break}if(h=this.resource,d=!1,(null===(e=this.response)||void 0===e?void 0:e["@odata.deltaLink"])?(h=this.response["@odata.deltaLink"],d=!0):d=new URL(h,"https://graph.microsoft.com").pathname.endsWith("delta"),f=i.graph.forComponent(this),v=f.api(h).version(this.version),(null===(t=this.scopes)||void 0===t?void 0:t.length)&&(v=v.middlewareOptions(C.z.apply(void 0,(0,p.Z)(this.scopes)))),this.type!==c.json){r.next=46;break}return r.next=29,v.get();case 29:if(o=r.sent,d&&L(this.response)&&L(o)&&(g=o.value,o.value=this.response.value.concat(g)),this.isPolling||(0,O.f)(this.response,o)||(this.response=o),!L(o)||!o["@odata.nextLink"]){r.next=44;break}b=1,y=o;case 35:if(!(b<this.maxPages||this.maxPages<=0||d&&this.pollingRate)||!(null===y||void 0===y?void 0:y["@odata.nextLink"])){r.next=44;break}return b++,P=y["@odata.nextLink"].split(this.version)[1],r.next=40,f.client.api(P).version(this.version).get();case 40:y=r.sent,(null===(n=null===y||void 0===y?void 0:y.value)||void 0===n?void 0:n.length)&&(y.value=o.value.concat(y.value),o=y,this.isPolling||(this.response=o)),r.next=35;break;case 44:r.next=62;break;case 46:if(-1!==this.resource.indexOf("/photo/$value")||-1!==this.resource.indexOf("/thumbnails/")){r.next=48;break}throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");case 48:if(!(this.resource.indexOf("/photo/$value")>-1)){r.next=56;break}return Z=this.resource.replace("/photo/$value",""),r.next=52,(0,R.E0)(f,Z,this.scopes);case 52:(S=r.sent)&&(T=S.photo),r.next=61;break;case 56:if(!(this.resource.indexOf("/thumbnails/")>-1)){r.next=61;break}return r.next=59,(0,j.mp)(f,this.resource,this.scopes);case 59:(E=r.sent)&&(T=E.thumbnail);case 61:T&&(o={image:T});case 62:if(!this.shouldUpdateCache()||!o){r.next=66;break}return s=m.Q.getCache(w.O.get,w.O.get.stores.responses),r.next=66,s.putValue(a,{response:JSON.stringify(o)});case 66:(0,O.f)(this.response,o)||(this.response=o),r.next=72;break;case 69:r.prev=69,r.t1=r.catch(5),this.error=r.t1;case 72:this.response&&(this.error=null,this.pollingRate&&setTimeout((function(){N.isPolling=!0,N.loadState().finally((function(){N.isPolling=!1}))}),this.pollingRate)),r.next=76;break;case 75:this.response=null;case 76:this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error},!0,!1,!0);case 78:case"end":return r.stop()}}),r,this,[[5,69]])})))}},{key:"shouldRetrieveCache",value:function(){return I()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}},{key:"shouldUpdateCache",value:function(){return I()&&this.cacheEnabled}}]),n}(P.F);Z([(0,y.Cb)({attribute:"resource",reflect:!0,type:String}),S("design:type",String)],Q.prototype,"resource",void 0),Z([(0,y.Cb)({attribute:"scopes",converter:function(e,t){return e?e.toLowerCase().split(","):null},reflect:!0}),S("design:type",Array)],Q.prototype,"scopes",void 0),Z([(0,y.Cb)({attribute:"version",reflect:!0,type:String}),S("design:type",Object)],Q.prototype,"version",void 0),Z([(0,y.Cb)({attribute:"type",reflect:!0,type:c}),S("design:type",String)],Q.prototype,"type",void 0),Z([(0,y.Cb)({attribute:"max-pages",reflect:!0,type:Number}),S("design:type",Object)],Q.prototype,"maxPages",void 0),Z([(0,y.Cb)({attribute:"polling-rate",reflect:!0,type:Number}),S("design:type",Object)],Q.prototype,"pollingRate",void 0),Z([(0,y.Cb)({attribute:"cache-enabled",reflect:!0,type:Boolean}),S("design:type",Object)],Q.prototype,"cacheEnabled",void 0),Z([(0,y.Cb)({attribute:"cache-invalidation-period",type:Number}),S("design:type",Object)],Q.prototype,"cacheInvalidationPeriod",void 0),Z([(0,y.Cb)({attribute:!1}),S("design:type",Object)],Q.prototype,"response",void 0),Z([(0,y.Cb)({attribute:!1}),S("design:type",Object)],Q.prototype,"error",void 0)}}]);
//# sourceMappingURL=105.2dc77d39.chunk.js.map