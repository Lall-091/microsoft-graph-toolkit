"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[823],{6823:function(e,t,i){i.d(t,{_:function(){return ve},K:function(){return ge}});var l,n,r,o,a,s,d,u,c,p,f,h=i(2723),g=i(1361),v=i(8079),m=i(1171),b=i(9249),y=i(7371),x=i(3069),k=i(5058),S=i(5754),F=i(6906),_=i(8402),w=i(2742),U=i(3022),I=i(2292),L=i(6429),z=i(8498),C=i(3836),P=i(4761),E=i(1687),Z=i(7425),T=i(4223),B=i(9251),A=[(0,C.iv)(l||(l=(0,m.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}\n'])))],R={showMoreSubtitle:"Show more items",filesSectionTitle:"Files",sharedTextSubtitle:"Shared"},q=i(8382),D=i(4622),O=i(9576),N=i(7940),M=i(768),Q=i(524),j=i(322),G=i(6552),V=i(9698),K=[(0,C.iv)(n||(n=(0,m.Z)(["\n:host .file-upload-area-button{width:auto;display:flex;align-items:end;justify-content:end;margin-inline-end:36px;margin-top:30px}:host fluent-button .upload-icon path{fill:var(--file-upload-button-text-color,var(--foreground-on-accent-rest))}:host fluent-button.file-upload-button::part(control){border:var(--file-upload-button-border,none);background:var(--file-upload-button-background-color,var(--accent-fill-rest))}:host fluent-button.file-upload-button::part(control):hover{background:var(--file-upload-button-background-color-hover,var(--accent-fill-hover))}:host fluent-button.file-upload-button .upload-text{color:var(--file-upload-button-text-color,var(--foreground-on-accent-rest));font-weight:400;line-height:20px}:host input{display:none}:host fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host fluent-dialog::part(overlay){opacity:.5}:host fluent-dialog::part(control){--dialog-width:$file-upload-dialog-width;--dialog-height:$file-upload-dialog-height;padding:var(--file-upload-dialog-padding,24px);border:var(--file-upload-dialog-border,1px solid var(--neutral-fill-rest))}:host fluent-dialog .file-upload-dialog-ok{background:var(--file-upload-dialog-keep-both-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-keep-both-button-border,none);color:var(--file-upload-dialog-keep-both-button-text-color,var(--foreground-on-accent-rest))}:host fluent-dialog .file-upload-dialog-ok:hover{background:var(--file-upload-dialog-keep-both-button-background-color-hover,var(--accent-fill-hover))}:host fluent-dialog .file-upload-dialog-cancel{background:var(--file-upload-dialog-replace-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-replace-button-border,1px solid var(--neutral-foreground-rest));color:var(--file-upload-dialog-replace-button-text-color,var(--neutral-foreground-rest))}:host fluent-dialog .file-upload-dialog-cancel:hover{background:var(--file-upload-dialog-replace-button-background-color-hover,var(--accent-fill-hover))}:host fluent-checkbox{margin-top:12px}:host fluent-checkbox .file-upload-dialog-check{color:var(--file-upload-dialog-text-color,--foreground-on-accent-rest)}:host .file-upload-table{display:flex}:host .file-upload-table.upload{display:flex}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell.percent-indicator{padding-inline-start:10px}:host .file-upload-table .file-upload-cell .description{opacity:.5;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:28px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-inline-start:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .mgt-file-item{--file-background-color:transparent;--file-padding:0 12px;--file-padding-inline-start:24px}:host .file-upload-template{clear:both}:host .file-upload-template .file-upload-folder-tab{padding-inline-start:20px}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-background-color,var(--accent-fill-rest));color:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{display:flex;align-items:end;justify-content:end;gap:5px}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));padding-right:5px}:host .file-upload-dialog.visible{display:block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{cursor:pointer;opacity:.5}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border-drag,1px dashed #0078d4);background-color:var(--file-upload-background-color-drag,rgba(0,120,212,.1));position:absolute;inset:0;z-index:1;display:inline-block}[dir=rtl] :host .file-upload-status{left:0;right:28px}\n"])))],$={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep both",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep both files?',uploadButtonLabel:"File upload button"},W=i(8097),H=function(e,t,i,l){var n,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},J=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Y=function(e,t,i,l){return new(i||(i=Promise))((function(n,r){function o(e){try{s(l.next(e))}catch(t){r(t)}}function a(e){try{s(l.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}s((l=l.apply(e,t||[])).next())}))},X=function(e){return e.isDirectory},ee=function(e){return"getAsEntry"in e&&"function"===typeof e.getAsEntry},te=function(e){(0,S.Z)(i,e);var t=(0,F.Z)(i);function i(){var e;return(0,b.Z)(this,i),(e=t.call(this))._dragCounter=0,e._maxChunkSize=4194304,e._dialogTitle="",e._dialogContent="",e._dialogPrimaryButton="",e._dialogSecondaryButton="",e._dialogCheckBox="",e._applyAll=!1,e._applyAllConflictBehavior=null,e._maximumFileSize=!1,e._excludedFileType=!1,e.onFileUploadChange=function(t){var i=t.target;!t||i.files.length<1||e.readUploadedFiles(i.files,(function(){return i.value=null}))},e.onFileUploadClick=function(){e.renderRoot.querySelector("#file-upload-input").click()},e.handleonDragOver=function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.items&&t.dataTransfer.items.length>0&&(t.dataTransfer.dropEffect=t.dataTransfer.dropEffect=e._dropEffect)},e.handleonDragEnter=function(t){(t.preventDefault(),t.stopPropagation(),e._dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0)&&(t.dataTransfer.dropEffect=e._dropEffect,e.renderRoot.querySelector("#file-upload-border").classList.add("visible"))},e.handleonDragLeave=function(t){(t.preventDefault(),t.stopPropagation(),e._dragCounter--,0===e._dragCounter)&&e.renderRoot.querySelector("#file-upload-border").classList.remove("visible")},e.handleonDrop=function(t){var i;t.preventDefault(),t.stopPropagation();e.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),(null===(i=t.dataTransfer)||void 0===i?void 0:i.items)&&e.readUploadedFiles(t.dataTransfer.items,(function(){t.dataTransfer.clearData()})),e._dragCounter=0},e.filesToUpload=[],e}return(0,y.Z)(i,[{key:"strings",get:function(){return $}},{key:"_dropEffect",get:function(){return"copy"}},{key:"render",value:function(){if(null!==this.parentElement){var e=this.parentElement;e.addEventListener("dragenter",this.handleonDragEnter),e.addEventListener("dragleave",this.handleonDragLeave),e.addEventListener("dragover",this.handleonDragOver),e.addEventListener("drop",this.handleonDrop)}return(0,C.dy)(r||(r=(0,m.Z)(['\n        <div id="file-upload-dialog" class="file-upload-dialog">\n          \x3c!-- Modal content --\x3e\n          <fluent-dialog modal="true" class="file-upload-dialog-content">\n            <span\n              class="file-upload-dialog-close"\n              id="file-upload-dialog-close">\n                ','\n            </span>\n            <div class="file-upload-dialog-content-text">\n              <h2 class="file-upload-dialog-title">',"</h2>\n              <div>",'</div>\n                <fluent-checkbox\n                  id="file-upload-dialog-check"\n                  class="file-upload-dialog-check">\n                    ','\n                </fluent-checkbox>\n            </div>\n            <div class="file-upload-dialog-editor">\n              <fluent-button\n                appearance="accent"\n                class="file-upload-dialog-ok">\n                ','\n              </fluent-button>\n              <fluent-button\n                appearance="outline"\n                class="file-upload-dialog-cancel">\n                ','\n              </fluent-button>\n            </div>\n          </fluent-dialog>\n        </div>\n        <div id="file-upload-border"></div>\n        <div class="file-upload-area-button">\n          <input\n            id="file-upload-input"\n            title="','"\n            tabindex="-1"\n            aria-label="file upload input"\n            type="file"\n            multiple\n            @change="','"\n          />\n          <fluent-button\n            appearance="accent"\n            class="file-upload-button"\n            @click=',"\n            label=",'>\n              <span slot="start">','</span>\n              <span class="upload-text">','</span>\n          </fluent-button>\n        </div>\n        <div class="file-upload-template">\n          ',"\n        </div>\n       "])),(0,T.d)(T.l.Cancel),this._dialogTitle,this._dialogContent,this._dialogCheckBox,this._dialogPrimaryButton,this._dialogSecondaryButton,this.strings.uploadButtonLabel,this.onFileUploadChange,this.onFileUploadClick,this.strings.uploadButtonLabel,(0,T.d)(T.l.Upload),this.strings.buttonUploadFile,this.renderFolderTemplate(this.filesToUpload))}},{key:"renderFolderTemplate",value:function(e){var t=this,i=[];if(e.length>0){var l=e.map((function(e){return-1===i.indexOf(e.fullPath.substring(0,e.fullPath.lastIndexOf("/")))?e.fullPath.endsWith("/")?(0,C.dy)(a||(a=(0,m.Z)(["",""])),t.renderFileTemplate(e,"")):(i.push(e.fullPath.substring(0,e.fullPath.lastIndexOf("/"))),(0,U.b)(o||(o=(0,m.Z)(["\n            <div class='file-upload-table'>\n              <div class='file-upload-cell'>\n                <mgt-file\n                  .fileDetails=","\n                  .view=",'\n                  class="mgt-file-item">\n                </mgt-file>\n              </div>\n            </div>\n            ',""])),{name:e.fullPath.substring(1,e.fullPath.lastIndexOf("/")),folder:"Folder"},B.b.oneline,t.renderFileTemplate(e,"file-upload-folder-tab"))):(0,C.dy)(s||(s=(0,m.Z)(["",""])),t.renderFileTemplate(e,"file-upload-folder-tab"))}));return(0,C.dy)(d||(d=(0,m.Z)(["",""])),l)}return(0,C.dy)(u||(u=(0,m.Z)([""])))}},{key:"renderFileTemplate",value:function(e,t){var i=(0,j.$)({"file-upload-table":!0,upload:e.completed}),l=t+("lastModifiedDateTime"===e.fieldUploadResponse?" file-upload-dialog-success":""),n=(0,j.$)({description:"description"===e.fieldUploadResponse}),r=e.completed?(0,C.dy)(c||(c=(0,m.Z)([""]))):this.renderFileUploadTemplate(e);return(0,U.b)(p||(p=(0,m.Z)(['\n        <div class="','">\n          <div class="',"\">\n            <div class='file-upload-cell'>\n              <div class=\"",'">\n                <div class="file-upload-status">\n                  ',"\n                </div>\n                <mgt-file\n                  .fileDetails=","\n                  .view=","\n                  .line2Property=",'\n                  part="upload"\n                  class="mgt-file-item">\n                </mgt-file>\n              </div>\n            </div>\n              ',"\n            </div>\n          </div>\n        </div>"])),i,l,n,e.iconStatus,e.driveItem,e.view,e.fieldUploadResponse,r)}},{key:"renderFileUploadTemplate",value:function(e){var t=this,i=(0,j.$)({"file-upload-table":!0,upload:e.completed});return(0,C.dy)(f||(f=(0,m.Z)(["\n    <div class='file-upload-cell'>\n      <div class='file-upload-table file-upload-name'>\n        <div class='file-upload-cell'>\n          <div\n            title=\"","\"\n            class='file-upload-filename'>\n            ","\n          </div>\n        </div>\n      </div>\n      <div class='file-upload-table'>\n        <div class='file-upload-cell'>\n          <div class=\"",'">\n            <fluent-progress class="file-upload-bar" value="',"\"></fluent-progress>\n            <div class='file-upload-cell percent-indicator'>\n              <span>",'%</span>\n              <span\n                class="file-upload-cancel"\n                @click=',">\n                ","\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    "])),e.file.name,e.file.name,i,e.percent,e.percent,(function(){return t.deleteFileUploadSession(e)}),(0,T.d)(T.l.Cancel))}},{key:"deleteFileUploadSession",value:function(e){return Y(this,void 0,void 0,(0,h.Z)().mark((function t(){return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,void 0===e.uploadUrl){t.next=9;break}return t.next=4,(0,Z.Ew)(this.fileUploadList.graph,e.uploadUrl);case 4:e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,$.cancelUploadFile),t.next=12;break;case 9:e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,$.cancelUploadFile);case 12:t.next=19;break;case 14:t.prev=14,t.t0=t.catch(0),e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,$.cancelUploadFile);case 19:case"end":return t.stop()}}),t,this,[[0,14]])})))}},{key:"readUploadedFiles",value:function(e,t){return Y(this,void 0,void 0,(0,h.Z)().mark((function i(){var l;return(0,h.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.getFilesFromUploadArea(e);case 2:return l=i.sent,i.next=5,this.getSelectedFiles(l);case 5:t();case 6:case"end":return i.stop()}}),i,this)})))}},{key:"getSelectedFiles",value:function(e){return Y(this,void 0,void 0,(0,h.Z)().mark((function t(){var i,l,n,r,o,a,s,d=this;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=[],n=[],this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach((function(e){e.completed?n.push(e):l.push(e)})),r=(0,g.Z)(e),t.prev=8,a=(0,h.Z)().mark((function e(){var t,i,n,r,a,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.value,i=""===t.fullPath?"/"+t.name:t.fullPath,0!==l.filter((function(e){return e.fullPath===i})).length){e.next=28;break}if(n=!0,void 0===d.fileUploadList.maxFileSize||!n){e.next=12;break}if(!(t.size>1024*d.fileUploadList.maxFileSize)){e.next=12;break}if(n=!1,!1!==d._maximumFileSize){e.next=12;break}return e.next=10,d.getFileUploadStatus(t,i,"MaxFileSize",d.fileUploadList);case 10:null!==(r=e.sent)&&1===r[0]&&(d._maximumFileSize=!0);case 12:if(void 0===d.fileUploadList.excludedFileExtensions){e.next=21;break}if(!(d.fileUploadList.excludedFileExtensions.length>0&&n)){e.next=21;break}if(!(d.fileUploadList.excludedFileExtensions.filter((function(e){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1})).length>0)){e.next=21;break}if(n=!1,!1!==d._excludedFileType){e.next=21;break}return e.next=19,d.getFileUploadStatus(t,i,"ExcludedFileType",d.fileUploadList);case 19:null!==(a=e.sent)&&1===a[0]&&(d._excludedFileType=!0);case 21:if(!n){e.next=28;break}return e.next=24,d.getFileUploadStatus(t,i,"Upload",d.fileUploadList);case 24:s=e.sent,u=!1,null!==s&&(-1===s[0]?u=!0:(d._applyAll=Boolean(s[0]),d._applyAllConflictBehavior=s[1]?1:0)),l.push({file:t,driveItem:{name:t.name},fullPath:i,conflictBehavior:null!==s?s[1]?1:0:null,iconStatus:null,percent:1,view:B.b.image,completed:u,maxSize:d._maxChunkSize,minSize:0});case 28:case"end":return e.stop()}}),e)})),r.s();case 11:if((o=r.n()).done){t.next=15;break}return t.delegateYield(a(),"t0",13);case 13:t.next=11;break;case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(8),r.e(t.t1);case 20:return t.prev=20,r.f(),t.finish(20);case 23:return(l=l.sort((function(e,t){return e.fullPath.substring(0,e.fullPath.lastIndexOf("/")).localeCompare(t.fullPath.substring(0,t.fullPath.lastIndexOf("/")))}))).forEach((function(e){if(0!==n.filter((function(t){return t.fullPath===e.fullPath})).length){var t=n.findIndex((function(t){return t.fullPath===e.fullPath}));n.splice(t,1)}})),(i=l).push.apply(i,n),this.filesToUpload=l,s=this.filesToUpload.map((function(e){return d.sendFileItemGraph(e)})),t.next=30,Promise.all(s);case 30:case"end":return t.stop()}}),t,this,[[8,17,20,23]])})))}},{key:"getFileUploadStatus",value:function(e,t,l,n){var r=this,o=Object.create(null,{requestStateUpdate:{get:function(){return(0,x.Z)((0,k.Z)(i.prototype),"requestStateUpdate",r)}}});return Y(this,void 0,void 0,(0,h.Z)().mark((function i(){var r,a=this;return(0,h.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:r=this.renderRoot.querySelector("#file-upload-dialog"),i.t0=l,i.next="Upload"===i.t0?4:"ExcludedFileType"===i.t0?23:"MaxFileSize"===i.t0?32:41;break;case 4:return i.next=6,(0,Z.iD)(this.fileUploadList.graph,"".concat(this.getGrapQuery(t),"?$select=id"));case 6:if(null===i.sent){i.next=21;break}if(!0!==this._applyAll){i.next=10;break}return i.abrupt("return",[this._applyAll,this._applyAllConflictBehavior]);case 10:return r.classList.add("visible"),this._dialogTitle=$.fileReplaceTitle,this._dialogContent=$.fileReplace.replace("{FileName}",e.name),this._dialogCheckBox=$.checkApplyAll,this._dialogPrimaryButton=$.buttonReplace,this._dialogSecondaryButton=$.buttonKeep,i.next=18,o.requestStateUpdate.call(this,!0);case 18:return i.abrupt("return",new Promise((function(e){var t=a.renderRoot.querySelector(".file-upload-dialog-close"),i=a.renderRoot.querySelector(".file-upload-dialog-ok"),l=a.renderRoot.querySelector(".file-upload-dialog-cancel"),n=a.renderRoot.querySelector("#file-upload-dialog-check");n.checked=!1,n.classList.remove("hide");var o=function(){r.classList.remove("visible"),e([n.checked?1:0,1])},s=function(){r.classList.remove("visible"),e([n.checked?1:0,0])},d=function(){r.classList.remove("visible"),e([-1])};i.removeEventListener("click",o),l.removeEventListener("click",s),t.removeEventListener("click",d),i.addEventListener("click",o),l.addEventListener("click",s),t.addEventListener("click",d)})));case 21:return i.abrupt("return",null);case 22:case 41:return i.abrupt("break",42);case 23:return r.classList.add("visible"),this._dialogTitle=$.fileTypeTitle,this._dialogContent=$.fileType.replace("{FileName}",e.name)+" ("+n.excludedFileExtensions.join(",")+")",this._dialogCheckBox=$.checkAgain,this._dialogPrimaryButton=$.buttonOk,this._dialogSecondaryButton=$.buttonCancel,i.next=31,o.requestStateUpdate.call(this,!0);case 31:return i.abrupt("return",new Promise((function(e){var t=a.renderRoot.querySelector(".file-upload-dialog-ok"),i=a.renderRoot.querySelector(".file-upload-dialog-cancel"),l=a.renderRoot.querySelector(".file-upload-dialog-close"),n=a.renderRoot.querySelector("#file-upload-dialog-check");n.checked=!1,n.classList.remove("hide");var o=function(){r.classList.remove("visible"),e([n.checked?1:0])},s=function(){r.classList.remove("visible"),e([0])};t.removeEventListener("click",o),i.removeEventListener("click",s),l.removeEventListener("click",s),t.addEventListener("click",o),i.addEventListener("click",s),l.addEventListener("click",s)})));case 32:return r.classList.add("visible"),this._dialogTitle=$.maximumFileSizeTitle,this._dialogContent=$.maximumFileSize.replace("{FileSize}",(0,V.td)(1024*n.maxFileSize)).replace("{FileName}",e.name)+(0,V.td)(e.size)+".",this._dialogCheckBox=$.checkAgain,this._dialogPrimaryButton=$.buttonOk,this._dialogSecondaryButton=$.buttonCancel,i.next=40,o.requestStateUpdate.call(this,!0);case 40:return i.abrupt("return",new Promise((function(e){var t=a.renderRoot.querySelector(".file-upload-dialog-ok"),i=a.renderRoot.querySelector(".file-upload-dialog-cancel"),l=a.renderRoot.querySelector(".file-upload-dialog-close"),n=a.renderRoot.querySelector("#file-upload-dialog-check");n.checked=!1,n.classList.remove("hide");var o=function(){r.classList.remove("visible"),e([n.checked?1:0])},s=function(){r.classList.remove("visible"),e([0])};t.removeEventListener("click",o),i.removeEventListener("click",s),l.removeEventListener("click",s),t.addEventListener("click",o),i.addEventListener("click",s),l.addEventListener("click",s)})));case 42:case"end":return i.stop()}}),i,this)})))}},{key:"getGrapQuery",value:function(e){var t="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(t=this.fileUploadList.itemPath.startsWith("/")?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?"/users/".concat(this.fileUploadList.userId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.userId&&this.fileUploadList.itemPath?"/users/".concat(this.fileUploadList.userId,"/drive/root:").concat(t).concat(e):this.fileUploadList.groupId&&this.fileUploadList.itemId?"/groups/".concat(this.fileUploadList.groupId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.groupId&&this.fileUploadList.itemPath?"/groups/".concat(this.fileUploadList.groupId,"/drive/root:").concat(t).concat(e):this.fileUploadList.driveId&&this.fileUploadList.itemId?"/drives/".concat(this.fileUploadList.driveId,"/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.driveId&&this.fileUploadList.itemPath?"/drives/".concat(this.fileUploadList.driveId,"/root:").concat(t).concat(e):this.fileUploadList.siteId&&this.fileUploadList.itemId?"/sites/".concat(this.fileUploadList.siteId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.siteId&&this.fileUploadList.itemPath?"/sites/".concat(this.fileUploadList.siteId,"/drive/root:").concat(t).concat(e):this.fileUploadList.itemId?"/me/drive/items/".concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.itemPath?"/me/drive/root:".concat(t).concat(e):"/me/drive/root:".concat(e)}},{key:"sendFileItemGraph",value:function(e){return Y(this,void 0,void 0,(0,h.Z)().mark((function t(){var i,l,n,r;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.fileUploadList.graph,l="",!(e.file.size<this._maxChunkSize)){t.next=18;break}if(t.prev=3,e.completed){t.next=11;break}return null!==e.conflictBehavior&&1!==e.conflictBehavior||(l="".concat(this.getGrapQuery(e.fullPath),":/content")),0===e.conflictBehavior&&(l="".concat(this.getGrapQuery(e.fullPath),":/content?@microsoft.graph.conflictBehavior=rename")),t.next=9,(0,Z.UD)(i,l,e.file);case 9:e.driveItem=t.sent,null!==e.driveItem?this.setUploadSuccess(e):(e.driveItem={name:e.file.name},this.setUploadFail(e,$.failUploadFile));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),this.setUploadFail(e,$.failUploadFile);case 16:t.next=37;break;case 18:if(e.completed){t.next=37;break}if(void 0!==e.uploadUrl){t.next=37;break}return t.next=22,(0,Z.Bs)(i,"".concat(this.getGrapQuery(e.fullPath),":/createUploadSession"),e.conflictBehavior);case 22:if(n=t.sent,t.prev=23,null===n){t.next=32;break}return e.uploadUrl=n.uploadUrl,t.next=28,this.sendSessionUrlGraph(i,e);case 28:null!==(r=t.sent)?(e.driveItem=r,this.setUploadSuccess(e)):this.setUploadFail(e,$.failUploadFile),t.next=33;break;case 32:this.setUploadFail(e,$.failUploadFile);case 33:t.next=37;break;case 35:t.prev=35,t.t1=t.catch(23);case 37:case"end":return t.stop()}}),t,this,[[3,13],[23,35]])})))}},{key:"sendSessionUrlGraph",value:function(e,t){var l=this,n=Object.create(null,{requestStateUpdate:{get:function(){return(0,x.Z)((0,k.Z)(i.prototype),"requestStateUpdate",l)}}});return Y(this,void 0,void 0,(0,h.Z)().mark((function i(){var l,r;return(0,h.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.file.size>t.minSize)){i.next=30;break}if(void 0!==t.mimeStreamString){i.next=5;break}return i.next=4,this.readFileContent(t.file);case 4:t.mimeStreamString=i.sent;case 5:return l=new Blob([t.mimeStreamString.slice(t.minSize,t.maxSize)]),t.percent=Math.round(t.maxSize/t.file.size*100),i.next=9,n.requestStateUpdate.call(this,!0);case 9:if(void 0===t.uploadUrl){i.next=27;break}return i.next=12,(0,Z.qU)(e,t.uploadUrl,"".concat(t.maxSize-t.minSize),"bytes ".concat(t.minSize,"-").concat(t.maxSize-1,"/").concat(t.file.size),l);case 12:if(null!==(r=i.sent)){i.next=17;break}return i.abrupt("return",null);case 17:if(!(0,Z.X5)(r)){i.next=23;break}t.minSize=parseInt(r.nextExpectedRanges[0].split("-")[0],10),t.maxSize=t.minSize+this._maxChunkSize,t.maxSize>t.file.size&&(t.maxSize=t.file.size),i.next=25;break;case 23:if(void 0===r.id){i.next=25;break}return i.abrupt("return",r);case 25:i.next=28;break;case 27:return i.abrupt("return",null);case 28:i.next=0;break;case 30:case"end":return i.stop()}}),i,this)})))}},{key:"setUploadSuccess",value:function(e){var t=this;e.percent=100,(0,x.Z)((0,k.Z)(i.prototype),"requestStateUpdate",this).call(this,!0),setTimeout((function(){e.iconStatus=(0,T.d)(T.l.Success),e.view=B.b.twolines,e.fieldUploadResponse="lastModifiedDateTime",e.completed=!0,(0,x.Z)((0,k.Z)(i.prototype),"requestStateUpdate",t).call(t,!0),(0,Z.s7)()}),500)}},{key:"setUploadFail",value:function(e,t){var l=this;setTimeout((function(){e.iconStatus=(0,T.d)(T.l.Fail),e.view=B.b.twolines,e.driveItem.description=t,e.fieldUploadResponse="description",e.completed=!0,(0,x.Z)((0,k.Z)(i.prototype),"requestStateUpdate",l).call(l,!0)}),500)}},{key:"readFileContent",value:function(e){return new Promise((function(t,i){var l=new FileReader;l.onloadend=function(){t(l.result)},l.onerror=function(e){i(e)},l.readAsArrayBuffer(e)}))}},{key:"getFilesFromUploadArea",value:function(e){return Y(this,void 0,void 0,(0,h.Z)().mark((function t(){var i,l,n,r,o,a,s,d,u,c;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=[],n=[],r=(0,g.Z)(e);try{for(r.s();!(o=r.n()).done;)a=o.value,"getAsFile"in(p=a)&&"function"===typeof p.getAsFile||"webkitGetAsEntry"in p&&"function"===typeof p.webkitGetAsEntry?ee(a)?(l=a.getAsEntry(),X(l)?i.push(l):(s=a.getAsFile())&&(this.writeFilePath(s,""),n.push(s))):a.webkitGetAsEntry?(l=a.webkitGetAsEntry(),X(l)?i.push(l):(d=a.getAsFile())&&(this.writeFilePath(d,""),n.push(d))):(u=a.getAsFile())&&(this.writeFilePath(u,""),n.push(u)):(this.writeFilePath(a,""),n.push(a))}catch(f){r.e(f)}finally{r.f()}if(!(i.length>0)){t.next=9;break}return t.next=7,this.getFolderFiles(i);case 7:c=t.sent,n.push.apply(n,(0,v.Z)(c));case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}var p}),t,this)})))}},{key:"getFolderFiles",value:function(e){var t=this;return new Promise((function(i){var l=0,n=[];e.forEach((function(e){r(e,"")}));var r=function(e,r){X(e)?o(e.createReader()):function(e){return e.isFile}(e)&&(l++,e.file((function(e){l--,t.writeFilePath(e,r),n.push(e),0===l&&i(n)})))},o=function(e){l++,e.readEntries((function(e){l--;var t,o=(0,g.Z)(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;r(a,a.fullPath)}}catch(s){o.e(s)}finally{o.f()}0===l&&i(n)}))}}))}},{key:"writeFilePath",value:function(e,t){e.fullPath=t}}],[{key:"styles",get:function(){return K}},{key:"requiredScopes",get:function(){return(0,v.Z)(new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"]))}}]),i}(Q.b);H([(0,P.Cb)({type:Object}),J("design:type",Array)],te.prototype,"filesToUpload",void 0),H([(0,P.Cb)({type:Object}),J("design:type",Object)],te.prototype,"fileUploadList",void 0);var ie,le,ne,re,oe,ae,se,de,ue,ce=i(1710),pe=function(e,t,i,l){var n,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},fe=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},he=function(e,t,i,l){return new(i||(i=Promise))((function(n,r){function o(e){try{s(l.next(e))}catch(t){r(t)}}function a(e){try{s(l.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}s((l=l.apply(e,t||[])).next())}))},ge=function(){(0,G.J)(ce.le),(0,q.R)(),(0,G.J)(D.Jh,O.hb,N.g,M.Ad),(0,q.R)(),(0,W.R)("file-upload",te),(0,W.R)("file-list",ve)},ve=function(e){(0,S.Z)(i,e);var t=(0,F.Z)(i);function i(){var e;return(0,b.Z)(this,i),(e=t.call(this))._isCompact=!1,e.disableOpenOnClick=!1,e._focusedItemIndex=-1,e.onFocusFirstItem=function(){return e._focusedItemIndex=0},e.onFileListKeyDown=function(t){var i,l=e.renderRoot.querySelector(".file-list");if(null===l||void 0===l?void 0:l.children.length){if("ArrowUp"!==t.code&&"ArrowDown"!==t.code||("ArrowUp"===t.code&&(-1===e._focusedItemIndex&&(e._focusedItemIndex=l.children.length),e._focusedItemIndex=(e._focusedItemIndex-1+l.children.length)%l.children.length),"ArrowDown"===t.code&&(e._focusedItemIndex=(e._focusedItemIndex+1)%l.children.length),i=l.children[e._focusedItemIndex],e.updateItemBackgroundColor(l,i,"focused")),"Enter"===t.code||"Space"===t.code){var n=(i=l.children[e._focusedItemIndex]).children[0];t.preventDefault(),e.fireCustomEvent("itemClick",n.fileDetails),e.handleFileClick(n.fileDetails),e.updateItemBackgroundColor(l,i,"selected")}"Tab"===t.code&&(i=l.children[e._focusedItemIndex])}},e.clearState(),e._pageSize=10,e.itemView=B.b.twolines,e._maxUploadFile=10,e.enableFileUpload=!1,e._preloadedFiles=[],e}return(0,y.Z)(i,[{key:"strings",get:function(){return R}},{key:"fileListQuery",get:function(){return this._fileListQuery},set:function(e){e!==this._fileListQuery&&(this._fileListQuery=e,this.requestStateUpdate())}},{key:"displayName",get:function(){return this.strings.filesSectionTitle}},{key:"cardTitle",get:function(){return this.strings.filesSectionTitle}},{key:"renderIcon",value:function(){return(0,T.d)(T.l.Files)}},{key:"fileQueries",get:function(){return this._fileQueries},set:function(e){(0,_.s)(this._fileQueries,e)||(this._fileQueries=e,this.requestStateUpdate())}},{key:"files",get:function(){return this._files},set:function(e){(0,_.s)(this._files,e)||(this._files=e,this.requestStateUpdate())}},{key:"siteId",get:function(){return this._siteId},set:function(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}},{key:"driveId",get:function(){return this._driveId},set:function(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}},{key:"groupId",get:function(){return this._groupId},set:function(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}},{key:"itemId",get:function(){return this._itemId},set:function(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}},{key:"itemPath",get:function(){return this._itemPath},set:function(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}},{key:"userId",get:function(){return this._userId},set:function(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}},{key:"insightType",get:function(){return this._insightType},set:function(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}},{key:"fileExtensions",get:function(){return this._fileExtensions},set:function(e){(0,_.s)(this._fileExtensions,e)||(this._fileExtensions=e,this.requestStateUpdate())}},{key:"pageSize",get:function(){return this._pageSize},set:function(e){e!==this._pageSize&&(this._pageSize=e,this.requestStateUpdate())}},{key:"maxFileSize",get:function(){return this._maxFileSize},set:function(e){e!==this._maxFileSize&&(this._maxFileSize=e,this.requestStateUpdate())}},{key:"maxUploadFile",get:function(){return this._maxUploadFile},set:function(e){e!==this._maxUploadFile&&(this._maxUploadFile=e,this.requestStateUpdate())}},{key:"excludedFileExtensions",get:function(){return this._excludedFileExtensions},set:function(e){(0,_.s)(this._excludedFileExtensions,e)||(this._excludedFileExtensions=e,this.requestStateUpdate())}},{key:"requestStateUpdate",value:function(e){return this.clearState(),(0,x.Z)((0,k.Z)(i.prototype),"requestStateUpdate",this).call(this,e)}},{key:"clearState",value:function(){(0,x.Z)((0,k.Z)(i.prototype),"clearState",this).call(this),this._files=null,this._pageSize=10,this._maxUploadFile=10}},{key:"asCompactView",value:function(){return this._isCompact=!0,this}},{key:"asFullView",value:function(){return this._isCompact=!1,this}},{key:"render",value:function(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this._isCompact?this.renderCompactView():this.renderFullView():this.renderNoData()}},{key:"renderCompactView",value:function(){var e=this.files.slice(0,3);return this.renderFiles(e)}},{key:"renderFullView",value:function(){return this.renderTemplate("default",{files:this.files})||this.renderFiles(this.files)}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||(0,C.dy)(ie||(ie=(0,m.Z)([""])))}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||(!0===this.enableFileUpload&&void 0!==w.C.globalProvider?(0,C.dy)(le||(le=(0,m.Z)(['\n            <div class="file-list-wrapper" dir=',">\n              ","\n            </div>"])),this.direction,this.renderFileUpload()):(0,C.dy)(ne||(ne=(0,m.Z)([""]))))}},{key:"renderFiles",value:function(e){var t=this;return(0,C.dy)(re||(re=(0,m.Z)(['\n      <div id="file-list-wrapper" class="file-list-wrapper" dir=',">\n        ",'\n        <ul\n          id="file-list"\n          class="file-list"\n        >\n          <li\n            tabindex="0"\n            class="file-item"\n            @keydown="','"\n            @focus="','"\n            @click=',">\n            ","\n          </li>\n          ","\n        </ul>\n        ","\n      </div>\n    "])),this.direction,this.enableFileUpload?this.renderFileUpload():null,this.onFileListKeyDown,this.onFocusFirstItem,(function(i){return t.handleItemSelect(e[0],i)}),this.renderFile(e[0]),(0,E.r)(e.slice(1),(function(e){return e.id}),(function(e){return(0,C.dy)(oe||(oe=(0,m.Z)(['\n              <li\n                class="file-item"\n                @keydown="','"\n                @click=',">\n                ","\n              </li>\n            "])),t.onFileListKeyDown,(function(i){return t.handleItemSelect(e,i)}),t.renderFile(e))})),this.hideMoreFilesButton||!this.pageIterator||!this.pageIterator.hasNext&&!this._preloadedFiles.length||this._isCompact?null:this.renderMoreFileButton())}},{key:"renderFile",value:function(e){var t=this.itemView;return this.renderTemplate("file",{file:e},e.id)||(0,U.b)(ae||(ae=(0,m.Z)(['\n        <mgt-file class="mgt-file-item" .fileDetails='," .view=","></mgt-file>\n      "])),e,t)}},{key:"renderMoreFileButton",value:function(){var e=this;return this._isLoadingMore?(0,C.dy)(se||(se=(0,m.Z)(['\n        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>\n      ']))):(0,C.dy)(de||(de=(0,m.Z)(['\n        <fluent-button\n          appearance="stealth"\n          id="show-more"\n          class="show-more"\n          @click=','\n        >\n          <span class="show-more-text">',"</span>\n        </fluent-button>"])),(function(){return e.renderNextPage()}),this.strings.showMoreSubtitle)}},{key:"renderFileUpload",value:function(){var e={graph:w.C.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return(0,U.b)(ue||(ue=(0,m.Z)(["\n        <mgt-file-upload .fileUploadList="," ></mgt-file-upload>\n      "])),e)}},{key:"loadState",value:function(){var e;return he(this,void 0,void 0,(0,h.Z)().mark((function t(){var i,l,n,r,o,a=this;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=w.C.globalProvider)&&i.state!==I.Aw.Loading){t.next=3;break}return t.abrupt("return");case 3:if(i.state!==I.Aw.SignedOut){t.next=6;break}return this._files=null,t.abrupt("return");case 6:if(this._graph=i.graph.forComponent(this),r=!this.driveId&&!this.siteId&&!this.groupId&&!this.userId,(this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this._files=null),this.files){t.next=114;break}if(!this.fileListQuery){t.next=16;break}return t.next=13,(0,Z.ht)(this._graph,this.fileListQuery,this.pageSize);case 13:n=t.sent,t.next=102;break;case 16:if(!this.fileQueries){t.next=22;break}return t.next=19,(0,Z.bf)(this._graph,this.fileQueries);case 19:l=t.sent,t.next=102;break;case 22:if(!r){t.next=46;break}if(!this.itemId){t.next=29;break}return t.next=26,(0,Z.k_)(this._graph,this.itemId,this.pageSize);case 26:n=t.sent,t.next=44;break;case 29:if(!this.itemPath){t.next=35;break}return t.next=32,(0,Z.V7)(this._graph,this.itemPath,this.pageSize);case 32:n=t.sent,t.next=44;break;case 35:if(!this.insightType){t.next=41;break}return t.next=38,(0,Z.Kv)(this._graph,this.insightType);case 38:l=t.sent,t.next=44;break;case 41:return t.next=43,(0,Z.UA)(this._graph,this.pageSize);case 43:n=t.sent;case 44:t.next=102;break;case 46:if(!this.driveId){t.next=59;break}if(!this.itemId){t.next=53;break}return t.next=50,(0,Z.th)(this._graph,this.driveId,this.itemId,this.pageSize);case 50:n=t.sent,t.next=57;break;case 53:if(!this.itemPath){t.next=57;break}return t.next=56,(0,Z.A6)(this._graph,this.driveId,this.itemPath,this.pageSize);case 56:n=t.sent;case 57:t.next=102;break;case 59:if(!this.groupId){t.next=72;break}if(!this.itemId){t.next=66;break}return t.next=63,(0,Z.Gi)(this._graph,this.groupId,this.itemId,this.pageSize);case 63:n=t.sent,t.next=70;break;case 66:if(!this.itemPath){t.next=70;break}return t.next=69,(0,Z.Lr)(this._graph,this.groupId,this.itemPath,this.pageSize);case 69:n=t.sent;case 70:t.next=102;break;case 72:if(!this.siteId){t.next=85;break}if(!this.itemId){t.next=79;break}return t.next=76,(0,Z.Vd)(this._graph,this.siteId,this.itemId,this.pageSize);case 76:n=t.sent,t.next=83;break;case 79:if(!this.itemPath){t.next=83;break}return t.next=82,(0,Z.Qk)(this._graph,this.siteId,this.itemPath,this.pageSize);case 82:n=t.sent;case 83:t.next=102;break;case 85:if(!this.userId){t.next=102;break}if(!this.itemId){t.next=92;break}return t.next=89,(0,Z.Yl)(this._graph,this.userId,this.itemId,this.pageSize);case 89:n=t.sent,t.next=102;break;case 92:if(!this.itemPath){t.next=98;break}return t.next=95,(0,Z.f8)(this._graph,this.userId,this.itemPath,this.pageSize);case 95:n=t.sent,t.next=102;break;case 98:if(!this.insightType){t.next=102;break}return t.next=101,(0,Z.LQ)(this._graph,this.userId,this.insightType);case 101:l=t.sent;case 102:if(n&&(this.pageIterator=n,this._preloadedFiles=(0,v.Z)(this.pageIterator.value),l=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),!this.fileExtensions||null===this.fileExtensions){t.next=113;break}if(!(null===(e=this.pageIterator)||void 0===e?void 0:e.value)){t.next=112;break}case 105:if(!this.pageIterator.hasNext){t.next=110;break}return t.next=108,(0,Z.xf)(this.pageIterator);case 108:t.next=105;break;case 110:l=this.pageIterator.value,this._preloadedFiles=[];case 112:o=l.filter((function(e){var t,i=(0,g.Z)(a.fileExtensions);try{for(i.s();!(t=i.n()).done;){if(t.value===a.getFileExtension(e.name))return e}}catch(l){i.e(l)}finally{i.f()}}));case 113:(null===o||void 0===o?void 0:o.length)>=0?(this._files=o,this.pageSize&&(l=this.files.splice(0,this.pageSize),this._files=l)):this._files=l;case 114:case"end":return t.stop()}}),t,this)})))}},{key:"handleItemSelect",value:function(e,t){if(this.handleFileClick(e),this.fireCustomEvent("itemClick",e),t){var i=this.renderRoot.querySelector(".file-list"),l=Array.from(i.children),n=t.target.closest("li"),r=l.indexOf(n);this._focusedItemIndex=r;var o=i.children[this._focusedItemIndex];this.updateItemBackgroundColor(i,o,"selected")}}},{key:"renderNextPage",value:function(){return he(this,void 0,void 0,(0,h.Z)().mark((function e(){var t;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._preloadedFiles.length>0)){e.next=4;break}this._files=[].concat((0,v.Z)(this.files),(0,v.Z)(this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length)))),e.next=12;break;case 4:if(!this.pageIterator.hasNext){e.next=12;break}return this._isLoadingMore=!0,(null===(t=this.renderRoot.querySelector("#file-list-wrapper"))||void 0===t?void 0:t.animate)&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),e.next=10,(0,Z.xf)(this.pageIterator);case 10:this._isLoadingMore=!1,this._files=this.pageIterator.value;case 12:case"end":return e.stop()}}),e,this)})))}},{key:"handleFileClick",value:function(e){(null===e||void 0===e?void 0:e.webUrl)&&!this.disableOpenOnClick&&window.open(e.webUrl,"_blank","noreferrer")}},{key:"getFileExtension",value:function(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}},{key:"updateItemBackgroundColor",value:function(e,t,i){var l,n=(0,g.Z)(e.children);try{for(n.s();!(l=n.n()).done;){var r=l.value;r.classList.remove(i),r.removeAttribute("tabindex")}}catch(s){n.e(s)}finally{n.f()}t&&(t.classList.add(i),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),t.setAttribute("tabindex","0"),t.focus());var o,a=(0,g.Z)(e.children);try{for(a.s();!(o=a.n()).done;){o.value.classList.remove("selected")}}catch(s){a.e(s)}finally{a.f()}}},{key:"reload",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(0,Z.s7)(),this.requestStateUpdate()}}],[{key:"styles",get:function(){return A}},{key:"requiredScopes",get:function(){return(0,v.Z)(new Set((0,v.Z)(q.P.requiredScopes)))}}]),i}(L.h);pe([(0,P.SB)(),fe("design:type",Object)],ve.prototype,"_isCompact",void 0),pe([(0,P.Cb)({attribute:"file-list-query"}),fe("design:type",String),fe("design:paramtypes",[String])],ve.prototype,"fileListQuery",null),pe([(0,P.Cb)({attribute:"file-queries",converter:function(e,t){return e?e.split(",").map((function(e){return e.trim()})):null}}),fe("design:type",Array),fe("design:paramtypes",[Array])],ve.prototype,"fileQueries",null),pe([(0,P.Cb)({type:Object}),fe("design:type",Array),fe("design:paramtypes",[Array])],ve.prototype,"files",null),pe([(0,P.Cb)({attribute:"site-id"}),fe("design:type",String),fe("design:paramtypes",[String])],ve.prototype,"siteId",null),pe([(0,P.Cb)({attribute:"drive-id"}),fe("design:type",String),fe("design:paramtypes",[String])],ve.prototype,"driveId",null),pe([(0,P.Cb)({attribute:"group-id"}),fe("design:type",String),fe("design:paramtypes",[String])],ve.prototype,"groupId",null),pe([(0,P.Cb)({attribute:"item-id"}),fe("design:type",String),fe("design:paramtypes",[String])],ve.prototype,"itemId",null),pe([(0,P.Cb)({attribute:"item-path"}),fe("design:type",String),fe("design:paramtypes",[String])],ve.prototype,"itemPath",null),pe([(0,P.Cb)({attribute:"user-id"}),fe("design:type",String),fe("design:paramtypes",[String])],ve.prototype,"userId",null),pe([(0,P.Cb)({attribute:"insight-type"}),fe("design:type",String),fe("design:paramtypes",[String])],ve.prototype,"insightType",null),pe([(0,P.Cb)({attribute:"item-view",converter:function(e){return e&&0!==e.length?(e=e.toLowerCase(),"undefined"===typeof B.b[e]?B.b.threelines:B.b[e]):B.b.threelines}}),fe("design:type",Number)],ve.prototype,"itemView",void 0),pe([(0,P.Cb)({attribute:"file-extensions",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),fe("design:type",Array),fe("design:paramtypes",[Array])],ve.prototype,"fileExtensions",null),pe([(0,P.Cb)({attribute:"page-size",type:Number}),fe("design:type",Number),fe("design:paramtypes",[Number])],ve.prototype,"pageSize",null),pe([(0,P.Cb)({attribute:"disable-open-on-click",type:Boolean}),fe("design:type",Object)],ve.prototype,"disableOpenOnClick",void 0),pe([(0,P.Cb)({attribute:"hide-more-files-button",type:Boolean}),fe("design:type",Boolean)],ve.prototype,"hideMoreFilesButton",void 0),pe([(0,P.Cb)({attribute:"max-file-size",type:Number}),fe("design:type",Number),fe("design:paramtypes",[Number])],ve.prototype,"maxFileSize",null),pe([(0,P.Cb)({attribute:"enable-file-upload",type:Boolean}),fe("design:type",Boolean)],ve.prototype,"enableFileUpload",void 0),pe([(0,P.Cb)({attribute:"max-upload-file",type:Number}),fe("design:type",Number),fe("design:paramtypes",[Number])],ve.prototype,"maxUploadFile",null),pe([(0,P.Cb)({attribute:"excluded-file-extensions",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),fe("design:type",Array),fe("design:paramtypes",[Array])],ve.prototype,"excludedFileExtensions",null),pe([(0,P.SB)(),fe("design:type",Array)],ve.prototype,"_files",void 0),pe([(0,P.SB)(),fe("design:type",Object)],ve.prototype,"_graph",void 0),pe([(0,P.SB)(),fe("design:type",String)],ve.prototype,"_fileListQuery",void 0),pe([(0,P.SB)(),fe("design:type",Array)],ve.prototype,"_fileQueries",void 0),pe([(0,P.SB)(),fe("design:type",String)],ve.prototype,"_siteId",void 0),pe([(0,P.SB)(),fe("design:type",String)],ve.prototype,"_itemId",void 0),pe([(0,P.SB)(),fe("design:type",String)],ve.prototype,"_driveId",void 0),pe([(0,P.SB)(),fe("design:type",String)],ve.prototype,"_itemPath",void 0),pe([(0,P.SB)(),fe("design:type",String)],ve.prototype,"_groupId",void 0),pe([(0,P.SB)(),fe("design:type",String)],ve.prototype,"_insightType",void 0),pe([(0,P.SB)(),fe("design:type",Array)],ve.prototype,"_fileExtensions",void 0),pe([(0,P.SB)(),fe("design:type",Number)],ve.prototype,"_pageSize",void 0),pe([(0,P.SB)(),fe("design:type",Array)],ve.prototype,"_excludedFileExtensions",void 0),pe([(0,P.SB)(),fe("design:type",Number)],ve.prototype,"_maxUploadFile",void 0),pe([(0,P.SB)(),fe("design:type",Number)],ve.prototype,"_maxFileSize",void 0),pe([(0,P.SB)(),fe("design:type",String)],ve.prototype,"_userId",void 0),pe([(0,P.SB)(),fe("design:type",Array)],ve.prototype,"_preloadedFiles",void 0),pe([(0,P.SB)(),fe("design:type",z.H)],ve.prototype,"pageIterator",void 0),pe([(0,P.SB)(),fe("design:type",Boolean)],ve.prototype,"_isLoadingMore",void 0)}}]);
//# sourceMappingURL=823.d8ad64b1.chunk.js.map