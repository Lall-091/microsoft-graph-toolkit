"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[155],{33155:function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var o=n(96234),r=n(33028),i=n(30969),a=n(90505),l=n(26823),s=n(17908),c=(0,s.$)("file-list",l.K),d=n(47780),u=n(94220),p=n(38013),h=n(9191),f=n(81581),v=(0,s.$)("teams-channel-picker",f.B),g=n(37574),y=(0,d.Z)({fileGrid:{paddingBottom:"10px"}}),m=function(){var e=i.useState(null),t=(0,o.Z)(e,2),n=t[0],r=t[1],a=y();return(0,g.jsxs)("div",{children:[(0,g.jsx)(v,{selectionChanged:function(e){return r(e.detail)},className:a.fileGrid}),n&&(0,g.jsx)(c,{groupId:n.team.id,itemPath:n.channel.displayName,pageSize:100})]})},b=n(32723),x=n(34795),k=n(72742),S=n(57151),C=(0,s.$)("picker",S.C),j=(0,d.Z)({picker:{paddingBottom:"10px",display:"block"}}),w=function(){var e=i.useState(null),t=(0,o.Z)(e,2),n=t[0],r=t[1],a=i.useState(""),l=(0,o.Z)(a,2),s=l[0],d=l[1],u=i.useState(""),p=(0,o.Z)(u,2),h=p[0],f=p[1],v=j(),y=function(){var e=(0,x.Z)((0,b.Z)().mark((function e(t){var n;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("documentLibrary"!==t.detail.list.template){e.next=9;break}return e.next=3,k.C.globalProvider.graph.client.api("/sites/root/lists/".concat(t.detail.id,"/drive")).get();case 3:n=e.sent,r(t.detail),d(n.id),f(""),e.next=12;break;case 9:r(null),d(""),f("Please select a document library");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,g.jsxs)("div",{children:[(0,g.jsx)(C,{resource:"/sites/root/lists",placeholder:"Select a list",keyName:"displayName",selectionChanged:y,className:v.picker}),n&&s&&(0,g.jsx)(c,{itemPath:"/",driveId:s,pageSize:100}),h&&(0,g.jsx)("div",{children:h})]})},Z=(0,d.Z)({panels:(0,r.Z)({},u.q5.padding("10px"))}),P=function(){var e=Z(),t=i.useState("my"),n=(0,o.Z)(t,2),r=n[0],l=n[1];return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(a.m,{title:"Files",description:"View your files from accross your OneDrive, channels you are a member of and your SharePoint sites"}),(0,g.jsxs)("div",{children:[(0,g.jsxs)(p.t,{selectedValue:r,onTabSelect:function(e,t){l(t.value)},children:[(0,g.jsx)(h.O,{value:"my",children:"My Files"}),(0,g.jsx)(h.O,{value:"recent",children:"Recent Files"}),(0,g.jsx)(h.O,{value:"site",children:"Site Files"}),(0,g.jsx)(h.O,{value:"channel",children:"Channel Files"})]}),(0,g.jsxs)("div",{className:e.panels,children:["my"===r&&(0,g.jsx)(c,{pageSize:100}),"recent"===r&&(0,g.jsx)(c,{insightType:"used",enableFileUpload:!1,pageSize:100}),"site"===r&&(0,g.jsx)(w,{}),"channel"===r&&(0,g.jsx)(m,{})]})]})]})}},57151:function(e,t,n){n.d(t,{C:function(){return I}});var o,r,i,a,l=n(32723),s=n(71171),c=n(9249),d=n(87371),u=n(45754),p=n(86906),h=n(14160),f=n(78268),v=n(43152),g=n(33022),y=n(48970),m=n(66429),b={comboboxPlaceholder:"Select an item"},x=n(91519),k=n(77788),S=n(66552),C=n(57724),j=[(0,h.iv)(o||(o=(0,s.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'])))],w=n(58097),Z=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},P=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},R=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{s(o.next(e))}catch(t){i(t)}}function l(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((o=o.apply(e,t||[])).next())}))},I=function(){(0,S.J)(x.ee,k.P),(0,C.xV)(),(0,w.R)("picker",N)},N=function(e){(0,u.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;return(0,c.Z)(this,n),(e=t.call(this)).version="v1.0",e.maxPages=3,e.scopes=[],e.cacheEnabled=!1,e.cacheInvalidationPeriod=0,e.handleComboboxKeydown=function(t){var n,o,r=t.key,i=t.target.querySelector(".selected");i&&(n=i.getAttribute("value")),"Enter"===r&&n&&(o=e.response.filter((function(e){return e.id===n})).pop(),e.fireCustomEvent("selectionChanged",o,!0,!1,!0))},e.placeholder=e.strings.comboboxPlaceholder,e.entityType=null,e.keyName=null,e.isRefreshing=!1,e}return(0,d.Z)(n,[{key:"strings",get:function(){return b}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}},{key:"clearState",value:function(){this.response=null,this.error=null}},{key:"render",value:function(){var e;if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.hasTemplate("error")){var t=this.error?this.error:null;return this.renderTemplate("error",{error:t},"error")}return this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(null===(e=this.response)||void 0===e?void 0:e.length)>0?this.renderPicker():this.renderGet()}},{key:"renderPicker",value:function(){var e=this;return(0,g.b)(r||(r=(0,s.Z)(["\n      <fluent-combobox\n        @keydown=","\n        current-value=",'\n        part="picker"\n        class="picker"\n        id="combobox"\n        autocomplete="list"\n        placeholder=',">\n        ","\n      </fluent-combobox>\n     "])),this.handleComboboxKeydown,(0,v.o)(this.selectedValue),this.placeholder,this.response.map((function(t){return(0,h.dy)(i||(i=(0,s.Z)(["\n          <fluent-option\n            value=","\n            @click=","\n          >\n            ","\n          </fluent-option>"])),t.id,(function(n){return e.handleClick(n,t)}),t[e.keyName])})))}},{key:"renderGet",value:function(){return(0,g.b)(a||(a=(0,s.Z)(['\n      <mgt-get\n        class="mgt-get"\n        resource=',"\n        version=","\n        .scopes=","\n        max-pages=","\n        ?cache-enabled=","\n        ?cache-invalidation-period=",">\n      </mgt-get>"])),this.resource,this.version,this.scopes,this.maxPages,this.cacheEnabled,this.cacheInvalidationPeriod)}},{key:"loadState",value:function(){return R(this,void 0,void 0,(0,l.Z)().mark((function e(){var t,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.response||((t=this.renderRoot.querySelector(".mgt-get"))?t.addEventListener("dataChange",(function(e){return n.handleDataChange(e)})):(0,y.vU)("mgt-picker component requires a child mgt-get component. Something has gone horribly wrong.")),this.isRefreshing=!1,e.next=4,Promise.resolve();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"handleDataChange",value:function(e){var t=e.detail.response.value,n=e.detail.error?e.detail.error:null;this.response=t,this.error=n}},{key:"handleClick",value:function(e,t){this.fireCustomEvent("selectionChanged",t,!0,!1,!0)}}],[{key:"styles",get:function(){return j}}]),n}(m.h);Z([(0,f.Cb)({attribute:"resource",type:String}),P("design:type",String)],N.prototype,"resource",void 0),Z([(0,f.Cb)({attribute:"version",type:String}),P("design:type",Object)],N.prototype,"version",void 0),Z([(0,f.Cb)({attribute:"max-pages",type:Number}),P("design:type",Object)],N.prototype,"maxPages",void 0),Z([(0,f.Cb)({attribute:"placeholder",type:String}),P("design:type",String)],N.prototype,"placeholder",void 0),Z([(0,f.Cb)({attribute:"key-name",type:String}),P("design:type",String)],N.prototype,"keyName",void 0),Z([(0,f.Cb)({attribute:"entity-type",type:String}),P("design:type",String)],N.prototype,"entityType",void 0),Z([(0,f.Cb)({attribute:"scopes",converter:function(e){return e?e.toLowerCase().split(","):null}}),P("design:type",Array)],N.prototype,"scopes",void 0),Z([(0,f.Cb)({attribute:"cache-enabled",type:Boolean}),P("design:type",Object)],N.prototype,"cacheEnabled",void 0),Z([(0,f.Cb)({attribute:"cache-invalidation-period",type:Number}),P("design:type",Object)],N.prototype,"cacheInvalidationPeriod",void 0),Z([(0,f.Cb)({attribute:"selected-value",type:String}),P("design:type",String)],N.prototype,"selectedValue",void 0),Z([(0,f.SB)(),P("design:type",Array)],N.prototype,"response",void 0)}}]);
//# sourceMappingURL=155.428901fc.chunk.js.map