"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[102],{17744:function(e,t,n){n.d(t,{g:function(){return s}});n(30969);var o=n(38667),r=n(47780),a=n(37574),i=(0,r.Z)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 300px)"},message:{paddingLeft:"10px"}}),s=function(e){var t=i();return(0,a.jsxs)("div",{className:t.root,children:[(0,a.jsx)(o.$,{}),(0,a.jsx)("div",{className:t.message,children:(0,a.jsx)("span",{children:e.message||"Loading..."})})]})}},13846:function(e,t,n){n.d(t,{K:function(){return $}});var o,r,a,i,s,l,c,d,p,u,v,h,f,g,y,m=n(68079),b=n(32723),x=n(71171),w=n(9249),k=n(87371),S=n(93069),Z=n(95058),_=n(45754),z=n(86906),C=n(14160),I=n(78268),D=n(33022),T=n(72742),j=n(42292),L=n(66429),O=[(0,C.iv)(o||(o=(0,x.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}\n'])))],N=n(98556),P=n(48498),U=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))},A=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"calendars.read";return U(void 0,void 0,void 0,(0,b.Z)().mark((function o(){var r;return(0,b.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=e.api(t).middlewareOptions((0,N.z)(n)).orderby("start/dateTime"),o.abrupt("return",P.H.create(e,r));case 2:case"end":return o.stop()}}),o)})))},R=function(e,t,n,o){return U(void 0,void 0,void 0,(0,b.Z)().mark((function r(){var a,i,s;return(0,b.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a="startdatetime=".concat(t.toISOString()),i="enddatetime=".concat(n.toISOString()),s=o?"groups/".concat(o,"/calendar"):"me",s+="/calendarview?".concat(a,"&").concat(i),r.abrupt("return",A(e,s));case 5:case"end":return r.stop()}}),r)})))},E=n(34223),M=n(64612),Q=n(66552),q=n(12572),B=n(457),H=n(58097),F=function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},K=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},W=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))},$=function(){(0,Q.J)(q.ay),(0,M.vr)(),(0,H.R)("agenda",G)},G=function(e){(0,_.Z)(n,e);var t=(0,z.Z)(n);function n(){var e;return(0,w.Z)(this,n),(e=t.apply(this,arguments))._days=3,e.onResize=function(){e._isNarrow=e.offsetWidth<600},e}return(0,k.Z)(n,[{key:"date",get:function(){return this._date},set:function(e){this._date!==e&&(this._date=e,this.reloadState())}},{key:"groupId",get:function(){return this._groupId},set:function(e){this._groupId!==e&&(this._groupId=e,this.reloadState())}},{key:"days",get:function(){return this._days},set:function(e){this._days!==e&&(this._days=e,this.reloadState())}},{key:"eventQuery",get:function(){return this._eventQuery},set:function(e){this._eventQuery!==e&&(this._eventQuery=e,this.reloadState())}},{key:"preferredTimezone",get:function(){return this._preferredTimezone},set:function(e){this._preferredTimezone!==e&&(this._preferredTimezone=e,this.reloadState())}},{key:"connectedCallback",value:function(){this._isNarrow=this.offsetWidth<600,(0,S.Z)((0,Z.Z)(n.prototype),"connectedCallback",this).call(this),window.addEventListener("resize",this.onResize)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("resize",this.onResize),(0,S.Z)((0,Z.Z)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"render",value:function(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();var e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});if(t)return t;var n={agenda:!0,grouped:this.groupByDay};return(0,C.dy)(r||(r=(0,x.Z)(["\n      <div dir=",' class="','">\n        ',"\n        ","\n      </div>\n    "])),this.direction,(0,B.$)(n),this.groupByDay?this.renderGroups(e):this.renderEvents(e),this.isLoadingState?this.renderLoading():(0,C.dy)(a||(a=(0,x.Z)([""]))))}},{key:"reload",value:function(){return W(this,void 0,void 0,(0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadEvents();case 2:this.events=e.sent;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||(0,C.dy)(i||(i=(0,x.Z)(['\n        <fluent-card class="event event-loading">\n          <div class="event-time-container">\n            <div class="event-time-loading loading-element"></div>\n          </div>\n          <div class="event-details-container">\n            <div class="event-subject-loading loading-element"></div>\n            <div class="event-location-container">\n              <div class="event-location-icon-loading loading-element"></div>\n              <div class="event-location-loading loading-element"></div>\n            </div>\n            <div class="event-location-container">\n              <div class="event-attendee-loading loading-element"></div>\n              <div class="event-attendee-loading loading-element"></div>\n              <div class="event-attendee-loading loading-element"></div>\n            </div>\n          </div>\n        </fluent-card>'])))}},{key:"clearState",value:function(){this.events=null}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||(0,C.dy)(s||(s=(0,x.Z)([""])))}},{key:"renderEvent",value:function(e){this._isNarrow=this.offsetWidth<600;var t={narrow:this._isNarrow};return(0,C.dy)(l||(l=(0,x.Z)(['\n      <fluent-card class="','">\n        <div class="','">\n          <div class="event-time" aria-label="','">','</div>\n        </div>\n        <div class="','">\n          '," "," ",'\n        </div>\n        <div class="event-other-container">',"</div>\n      </fluent-card>\n    "])),(0,B.$)(Object.assign({event:!0},t)),(0,B.$)(Object.assign({"event-time-container":!0},t)),this.getEventTimeString(e),this.getEventTimeString(e),(0,B.$)(Object.assign({"event-details-container":!0},t)),this.renderTitle(e),this.renderLocation(e),this.renderAttendees(e),this.renderOther(e))}},{key:"renderHeader",value:function(e){return this.renderTemplate("header",{header:e},"header-"+e)||(0,C.dy)(c||(c=(0,x.Z)(['\n        <div class="header" aria-label="','">',"</div>\n      "])),e,e)}},{key:"renderTitle",value:function(e){return(0,C.dy)(d||(d=(0,x.Z)(["\n      <div\n        aria-label=",'\n        class="','"\n      >\n        ',"\n      </div>"])),e.subject,(0,B.$)({"event-subject":!0,narrow:this._isNarrow}),e.subject)}},{key:"renderLocation",value:function(e){return e.location.displayName?(0,C.dy)(p||(p=(0,x.Z)(['\n      <div class="event-location-container">\n        <div class="event-location-icon">','</div>\n        <div class="event-location" aria-label="','">',"</div>\n      </div>\n    "])),(0,E.d)(E.l.OfficeLocation),e.location.displayName,e.location.displayName):null}},{key:"renderAttendees",value:function(e){return e.attendees.length?(0,D.b)(u||(u=(0,x.Z)(['\n      <mgt-people\n        show-max="5"\n        show-presence\n        class="event-attendees"\n        .peopleQueries=',"\n      ></mgt-people>\n    "])),e.attendees.map((function(e){return e.emailAddress.address}))):null}},{key:"renderOther",value:function(e){return this.hasTemplate("event-other")?(0,C.dy)(v||(v=(0,x.Z)(["\n          ","\n        "])),this.renderTemplate("event-other",{event:e},e.id+"-other")):null}},{key:"renderGroups",value:function(e){var t=this,n={};return e.forEach((function(e){var o,r=null===(o=null===e||void 0===e?void 0:e.start)||void 0===o?void 0:o.dateTime;"UTC"===e.end.timeZone&&(r+="Z");var a=t.getDateHeaderFromDateTimeString(r);n[a]=n[a]||[],n[a].push(e)})),(0,C.dy)(h||(h=(0,x.Z)(["\n      ","\n    "])),Object.keys(n).map((function(e){return(0,C.dy)(f||(f=(0,x.Z)(['\n            <div class="group">'," ","</div>\n          "])),t.renderHeader(e),t.renderEvents(n[e]))})))}},{key:"renderEvents",value:function(e){var t=this;return(0,C.dy)(g||(g=(0,x.Z)(["\n        ",""])),e.map((function(e){return(0,C.dy)(y||(y=(0,x.Z)(['\n              <div\n                class="event-container"\n                tabindex="0"\n                @focus=',">\n                ","\n              </div>"])),(function(){return t.eventClicked(e)}),t.renderTemplate("event",{event:e},e.id)||t.renderEvent(e))})))}},{key:"loadState",value:function(){return W(this,void 0,void 0,(0,b.Z)().mark((function e(){var t;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.events){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadEvents();case 4:(null===(t=e.sent)||void 0===t?void 0:t.length)>0&&(this.events=t);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"reloadState",value:function(){return W(this,void 0,void 0,(0,b.Z)().mark((function e(){return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.events=null,e.next=3,this.requestStateUpdate(!0);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"eventClicked",value:function(e){this.fireCustomEvent("eventClick",e)}},{key:"getEventTimeString",value:function(e){if(e.isAllDay)return"ALL DAY";var t=e.start.dateTime;"UTC"===e.start.timeZone&&(t+="Z");var n=e.end.dateTime;"UTC"===e.end.timeZone&&(n+="Z");var o=this.prettyPrintTimeFromDateTime(new Date(t)),r=this.prettyPrintTimeFromDateTime(new Date(n));return"".concat(o," - ").concat(r)}},{key:"loadEvents",value:function(){return W(this,void 0,void 0,(0,b.Z)().mark((function e(){var t,n,o,r,a,i,s,l,c,d;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=T.C.globalProvider,n=[],(null===t||void 0===t?void 0:t.state)!==j.Aw.SignedIn){e.next=44;break}if(o=t.graph.forComponent(this),!this.eventQuery){e.next=25;break}return e.prev=5,(r=this.eventQuery.split("|")).length>1?(i=r[0].trim(),a=r[1].trim()):i=this.eventQuery,e.next=10,A(o,i,a);case 10:if(!(null===(s=e.sent)||void 0===s?void 0:s.value)){e.next=19;break}n=s.value;case 13:if(!s.hasNext){e.next=19;break}return e.next=16,s.next();case 16:n=s.value,e.next=13;break;case 19:e.next=23;break;case 21:e.prev=21,e.t0=e.catch(5);case 23:e.next=44;break;case 25:return l=this.date?new Date(this.date):new Date,(c=new Date(l.getTime())).setDate(l.getDate()+this.days),e.prev=28,e.next=31,R(o,l,c,this.groupId);case 31:if(!(null===(d=e.sent)||void 0===d?void 0:d.value)){e.next=40;break}n=d.value;case 34:if(!d.hasNext){e.next=40;break}return e.next=37,d.next();case 37:n=d.value,e.next=34;break;case 40:e.next=44;break;case 42:e.prev=42,e.t1=e.catch(28);case 44:return e.abrupt("return",n);case 45:case"end":return e.stop()}}),e,this,[[5,21],[28,42]])})))}},{key:"prettyPrintTimeFromDateTime",value:function(e){return e.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}},{key:"getDateHeaderFromDateTimeString",value:function(e){return new Date(e).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}}],[{key:"styles",get:function(){return O}},{key:"requiredScopes",get:function(){return(0,m.Z)(new Set(["calendars.read"].concat((0,m.Z)(M.Mb.requiredScopes))))}}]),n}(L.h);F([(0,I.Cb)({attribute:"date",type:String}),K("design:type",String),K("design:paramtypes",[Object])],G.prototype,"date",null),F([(0,I.Cb)({attribute:"group-id",type:String}),K("design:type",String),K("design:paramtypes",[Object])],G.prototype,"groupId",null),F([(0,I.Cb)({attribute:"days",type:Number}),K("design:type",Number),K("design:paramtypes",[Object])],G.prototype,"days",null),F([(0,I.Cb)({attribute:"event-query",type:String}),K("design:type",String),K("design:paramtypes",[Object])],G.prototype,"eventQuery",null),F([(0,I.Cb)({attribute:"events",type:Array}),K("design:type",Array)],G.prototype,"events",void 0),F([(0,I.Cb)({attribute:"show-max",type:Number}),K("design:type",Number)],G.prototype,"showMax",void 0),F([(0,I.Cb)({attribute:"group-by-day",type:Boolean}),K("design:type",Boolean)],G.prototype,"groupByDay",void 0),F([(0,I.Cb)({attribute:"preferred-timezone",type:String}),K("design:type",String),K("design:paramtypes",[Object])],G.prototype,"preferredTimezone",null),F([(0,I.Cb)({attribute:!1}),K("design:type",Boolean)],G.prototype,"_isNarrow",void 0)},64612:function(e,t,n){n.d(t,{Mb:function(){return E},cC:function(){return j.c},vr:function(){return R}});var o,r,a,i,s,l,c,d=n(68079),p=n(32723),u=n(71171),v=n(41361),h=n(9249),f=n(87371),g=n(93069),y=n(95058),m=n(45754),b=n(86906),x=n(14160),w=n(78268),k=n(11),S=n(94545),Z=n(7244),_=n(7236),z=n(78402),C=n(33022),I=n(72742),D=n(42292),T=n(66429),j=n(25607),L=[(0,x.iv)(o||(o=(0,u.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}\n'])))],O=n(39768),N=n(58097),P=function(e,t,n,o){var r,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(i=(a<3?r(i):a>3?r(t,n,i):r(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},U=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},A=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))},R=function(){(0,O.yQ)(),(0,N.R)("people",E)},E=function(e){(0,m.Z)(n,e);var t=(0,b.Z)(n);function n(){var e;return(0,h.Z)(this,n),(e=t.call(this)).personCardInteraction=j.c.hover,e.scopes=[],e._peoplePresence={},e._version="v1.0",e._arrowKeyLocation=-1,e.handleKeyDown=function(t){var n,o,r=e.shadowRoot.querySelector(".people-list"),a=null===r||void 0===r?void 0:r.children,i=(0,v.Z)(a);try{for(i.s();!(o=i.n()).done;){var s=o.value;s.setAttribute("tabindex","-1"),s.blur()}}catch(p){i.e(p)}finally{i.f()}var l=r.childElementCount,c=t.key;if("ArrowRight"===c)e._arrowKeyLocation=(e._arrowKeyLocation+1+l)%l;else if("ArrowLeft"===c)e._arrowKeyLocation=(e._arrowKeyLocation-1+l)%l;else if("Tab"===c||"Escape"===c)e._arrowKeyLocation=-1,r.blur();else if(["Enter","space"," "].includes(c)&&e.personCardInteraction!==j.c.none){var d=a[e._arrowKeyLocation].querySelector("mgt-person");d&&d.showPersonCard()}e._arrowKeyLocation>-1&&((n=a[e._arrowKeyLocation]).setAttribute("tabindex","1"),n.focus())},e.showMax=3,e}return(0,f.Z)(n,[{key:"groupId",get:function(){return this._groupId},set:function(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}},{key:"userIds",get:function(){return this._userIds},set:function(e){(0,z.s)(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}},{key:"peopleQueries",get:function(){return this._peopleQueries},set:function(e){(0,z.s)(this._peopleQueries,e)||(this._peopleQueries=e,this.requestStateUpdate(!0))}},{key:"resource",get:function(){return this._resource},set:function(e){this._resource!==e&&(this._resource=e,this.requestStateUpdate(!0))}},{key:"version",get:function(){return this._version},set:function(e){this._version!==e&&(this._version=e,this.requestStateUpdate(!0))}},{key:"fallbackDetails",get:function(){return this._fallbackDetails},set:function(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.requestStateUpdate())}},{key:"clearState",value:function(){this.people=null}},{key:"requestStateUpdate",value:function(e){return e&&(this.people=null),(0,g.Z)((0,y.Z)(n.prototype),"requestStateUpdate",this).call(this,e)}},{key:"render",value:function(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null)||(0,x.dy)(r||(r=(0,u.Z)([""])))}},{key:"renderPeople",value:function(){var e=this,t=this.people.slice(0,this.showMax).filter((function(e){return e}));return(0,x.dy)(a||(a=(0,u.Z)(['\n      <ul\n        tabindex="0"\n        class="people-list"\n        aria-label="people"\n        @keydown=',">\n        ","\n        ","\n      </ul>\n    "])),this.handleKeyDown,(0,k.r)(t,(function(e){return e.id?e.id:e.displayName}),(function(t){return(0,x.dy)(i||(i=(0,u.Z)(['\n            <li tabindex="-1" class="people-person">\n              ',"\n            </li>\n          "])),e.renderPerson(t))})),this.people.length>this.showMax?this.renderOverflow():null)}},{key:"renderOverflow",value:function(){var e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||(0,x.dy)(s||(s=(0,u.Z)(['\n        <li tabindex="-1" aria-label="and ',' more attendees" class="overflow"><span>+',"</span></li>\n      "])),e,e)}},{key:"renderPerson",value:function(e){var t={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]);return this.renderTemplate("person",{person:e},e.id)||(0,C.b)(l||(l=(0,u.Z)(["\n        <mgt-person\n          .personDetails=","\n          .fetchImage=","\n          .avatarSize=","\n          .personCardInteraction=","\n          .showPresence=","\n          .personPresence=","\n          .usage=","\n        ></mgt-person>\n      "])),e,!0,"small",this.personCardInteraction,this.showPresence,t,"people")}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||(0,x.dy)(c||(c=(0,u.Z)([""])))}},{key:"loadState",value:function(){return A(this,void 0,void 0,(0,p.Z)().mark((function e(){var t,n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.people){e.next=39;break}if(!(t=I.C.globalProvider)||t.state!==D.Aw.SignedIn){e.next=39;break}if(n=t.graph.forComponent(this),!this.groupId){e.next=10;break}return e.next=7,(0,_.V0)(n,null,this.groupId,this.showMax,S.bz.person);case 7:this.people=e.sent,e.next=32;break;case 10:if(!this.userIds&&!this.peopleQueries){e.next=23;break}if(!this.userIds){e.next=17;break}return e.next=14,(0,_.Qi)(n,this.userIds,"","",this._fallbackDetails);case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,(0,_.BD)(n,this.peopleQueries,this._fallbackDetails);case 19:e.t0=e.sent;case 20:this.people=e.t0,e.next=32;break;case 23:if(!this.resource){e.next=29;break}return e.next=26,(0,S.s8)(n,this.version,this.resource,this.scopes);case 26:this.people=e.sent,e.next=32;break;case 29:return e.next=31,(0,S.kH)(n);case 31:this.people=e.sent;case 32:if(!this.showPresence){e.next=38;break}return e.next=35,(0,Z.G)(n,this.people);case 35:this._peoplePresence=e.sent,e.next=39;break;case 38:this._peoplePresence=null;case 39:case"end":return e.stop()}}),e,this)})))}}],[{key:"styles",get:function(){return L}},{key:"requiredScopes",get:function(){return(0,d.Z)(new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read"].concat((0,d.Z)(O.yI.requiredScopes))))}}]),n}(T.h);P([(0,w.Cb)({attribute:"group-id",type:String}),U("design:type",String),U("design:paramtypes",[Object])],E.prototype,"groupId",null),P([(0,w.Cb)({attribute:"user-ids",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),U("design:type",Array),U("design:paramtypes",[Array])],E.prototype,"userIds",null),P([(0,w.Cb)({attribute:"people",type:Object}),U("design:type",Array)],E.prototype,"people",void 0),P([(0,w.Cb)({attribute:"people-queries",converter:function(e,t){return e.split(",").map((function(e){return e.trim()}))}}),U("design:type",Array),U("design:paramtypes",[Array])],E.prototype,"peopleQueries",null),P([(0,w.Cb)({attribute:"show-max",type:Number}),U("design:type",Number)],E.prototype,"showMax",void 0),P([(0,w.Cb)({attribute:"show-presence",type:Boolean}),U("design:type",Boolean)],E.prototype,"showPresence",void 0),P([(0,w.Cb)({attribute:"person-card",converter:function(e,t){return e=e.toLowerCase(),"undefined"===typeof j.c[e]?j.c.hover:j.c[e]}}),U("design:type",Number)],E.prototype,"personCardInteraction",void 0),P([(0,w.Cb)({attribute:"resource",type:String}),U("design:type",String),U("design:paramtypes",[Object])],E.prototype,"resource",null),P([(0,w.Cb)({attribute:"version",type:String}),U("design:type",String),U("design:paramtypes",[Object])],E.prototype,"version",null),P([(0,w.Cb)({attribute:"scopes",converter:function(e){return e?e.toLowerCase().split(","):null},reflect:!0}),U("design:type",Array)],E.prototype,"scopes",void 0),P([(0,w.Cb)({attribute:"fallback-details",type:Array}),U("design:type",Array),U("design:paramtypes",[Array])],E.prototype,"fallbackDetails",null),P([(0,w.SB)(),U("design:type",Object)],E.prototype,"_arrowKeyLocation",void 0)},38667:function(e,t,n){n.d(t,{$:function(){return r}});var o=n(91734),r=(0,n(17908).$)("spinner",o.Y)}}]);
//# sourceMappingURL=102.bdb5607a.chunk.js.map