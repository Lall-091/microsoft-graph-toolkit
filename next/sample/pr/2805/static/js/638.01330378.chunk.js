"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[638],{79638:function(e,t,o){o.d(t,{U:function(){return O}});var r,n,i,a,s,l,c,d,u=o(68079),p=o(32723),h=o(71171),f=o(9249),m=o(87371),g=o(45754),y=o(86906),b=o(14160),v=o(78268),k=o(33022),x=o(66429),S={termsetIdRequired:"The termsetId property or termset-id attribute is required",noTermsFound:"No terms found",comboboxPlaceholder:"Select a term",loadingMessage:"Loading..."},I=o(91519),T=o(77788),C=o(66552),w=[(0,b.iv)(r||(r=(0,h.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--max-height:var(--taxonomy-picker-list-max-height, 380px)}:host .picker{background-color:var(--taxonomy-picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--taxonomy-picker-placeholder-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--taxonomy-picker-placeholder-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--max-height:var(--taxonomy-picker-list-max-height, 380px)}:host .picker{background-color:var(--taxonomy-picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--taxonomy-picker-placeholder-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--taxonomy-picker-placeholder-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'])))],R=o(57724),Z=o(58097),P=o(91734),j=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},L=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function s(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},O=function(){(0,C.J)(I.ee,T.P),(0,P.Y)(),(0,R.xV)(),(0,Z.R)("taxonomy-picker",U)},U=function(e){(0,g.Z)(o,e);var t=(0,y.Z)(o);function o(){var e;return(0,f.Z)(this,o),(e=t.call(this)).version="beta",e.position="below",e.cacheEnabled=!1,e.cacheInvalidationPeriod=0,e.placeholder=e.strings.comboboxPlaceholder,e.isRefreshing=!1,e.noTerms=!1,e}return(0,m.Z)(o,[{key:"strings",get:function(){return S}},{key:"defaultSelectedTermId",get:function(){return this._defaultSelectedTermId},set:function(e){e!==this._defaultSelectedTermId&&(this._defaultSelectedTermId=e,this.requestStateUpdate(!0))}},{key:"selectedTerm",get:function(){return this._selectedTerm},set:function(e){this._selectedTerm=e}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}},{key:"clearState",value:function(){this.terms=null,this.error=null,this.noTerms=!1}},{key:"render",value:function(){var e;return this.isLoadingState&&!this.terms?this.renderLoading():this.error?this.renderError():this.noTerms?this.renderNoData():(null===(e=this.terms)||void 0===e?void 0:e.length)>0?this.renderTaxonomyPicker():this.renderGet()}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null,"loading")||(0,k.b)(n||(n=(0,h.Z)(['\n        <div class="message-parent">\n          <mgt-spinner></mgt-spinner>\n          <div label="loading-text" aria-label="loading">\n            ',"\n          </div>\n        </div>\n      "])),this.strings.loadingMessage)}},{key:"renderError",value:function(){return this.renderTemplate("error",null,"error")||(0,b.dy)(i||(i=(0,h.Z)(["\n              <span>\n                ","\n            </span>\n          "])),this.error)}},{key:"renderNoData",value:function(){return this.renderTemplate("no-data",null)||(0,b.dy)(a||(a=(0,h.Z)(["\n            <span>\n              ","\n            </span>\n          "])),this.strings.noTermsFound)}},{key:"renderTaxonomyPicker",value:function(){var e=this;return(0,k.b)(s||(s=(0,h.Z)(['\n      <fluent-combobox class="taxonomy-picker" autocomplete="both" placeholder='," position="," ?disabled=",">\n        ","\n      </fluent-combobox>\n     "])),this.placeholder,this.position,this.disabled,this.terms.map((function(t){return e.renderTaxonomyPickerItem(t)})))}},{key:"renderTaxonomyPickerItem",value:function(e){var t=this,o=this.defaultSelectedTermId&&this.defaultSelectedTermId===e.id;return(0,b.dy)(l||(l=(0,h.Z)(["\n        <fluent-option value="," ?selected="," @click=","> "," </fluent-option>\n        "])),e.id,o,(function(o){return t.handleClick(o,e)}),this.renderTemplate("term",{term:e},e.id)||e.labels[0].name)}},{key:"renderGet",value:function(){if(!this.termsetId)return(0,b.dy)(c||(c=(0,h.Z)(["\n            <span>\n                ","\n            </span>\n            "])),this.strings.termsetIdRequired);var e="/termStore/sets/".concat(this.termsetId,"/children");return this.termId&&(e="/termStore/sets/".concat(this.termsetId,"/terms/").concat(this.termId,"/children")),this.siteId&&(e="/sites/".concat(this.siteId).concat(e)),e+="?$select=id,labels,descriptions,properties",(0,k.b)(d||(d=(0,h.Z)(['\n      <mgt-get\n        class="mgt-get"\n        resource=',"\n        version=","\n        scopes=","\n        ?cache-enabled=","\n        ?cache-invalidation-period=",">\n      </mgt-get>"])),e,this.version,["TermStore.Read.All"],this.cacheEnabled,this.cacheInvalidationPeriod)}},{key:"loadState",value:function(){return E(this,void 0,void 0,(0,p.Z)().mark((function e(){var t=this;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.terms||this.renderRoot.querySelector(".mgt-get").addEventListener("dataChange",(function(e){return t.handleDataChange(e)})),this.isRefreshing=!1,e.next=4,Promise.resolve();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"handleDataChange",value:function(e){var t=this,o=e.detail.error?e.detail.error:null;if(o)this.error=o;else{this.locale&&(this.locale=this.locale.toLowerCase());var r=e.detail.response.value.map((function(e){var o=e.labels;if(o&&o.length>0&&t.locale){var r=o.find((function(e){return e.languageTag.toLowerCase()===t.locale}));r&&(e.labels=[r].concat((0,u.Z)(o.filter((function(e){return e.languageTag.toLowerCase()!==t.locale})))))}return e}));this.terms=r,0===r.length&&(this.noTerms=!0)}}},{key:"handleClick",value:function(e,t){this.selectedTerm=t,this.fireCustomEvent("selectionChanged",t)}}],[{key:"styles",get:function(){return w}}]),o}(x.h);j([(0,v.Cb)({attribute:"term-set-id",type:String}),L("design:type",String)],U.prototype,"termsetId",void 0),j([(0,v.Cb)({attribute:"term-id",type:String}),L("design:type",String)],U.prototype,"termId",void 0),j([(0,v.Cb)({attribute:"site-id",type:String}),L("design:type",String)],U.prototype,"siteId",void 0),j([(0,v.Cb)({attribute:"locale",type:String}),L("design:type",String)],U.prototype,"locale",void 0),j([(0,v.Cb)({attribute:"version",type:String}),L("design:type",Object)],U.prototype,"version",void 0),j([(0,v.Cb)({attribute:"placeholder",type:String}),L("design:type",String)],U.prototype,"placeholder",void 0),j([(0,v.Cb)({attribute:"position",type:String,converter:function(e){return"above"===e?"above":"below"}}),L("design:type",String)],U.prototype,"position",void 0),j([(0,v.Cb)({attribute:"default-selected-term-id",type:String}),L("design:type",String),L("design:paramtypes",[String])],U.prototype,"defaultSelectedTermId",null),j([(0,v.Cb)({attribute:"selected-term",type:Object}),L("design:type",Object),L("design:paramtypes",[Object])],U.prototype,"selectedTerm",null),j([(0,v.Cb)({attribute:"disabled",type:Boolean}),L("design:type",Boolean)],U.prototype,"disabled",void 0),j([(0,v.Cb)({attribute:"cache-enabled",type:Boolean}),L("design:type",Object)],U.prototype,"cacheEnabled",void 0),j([(0,v.Cb)({attribute:"cache-invalidation-period",type:Number}),L("design:type",Object)],U.prototype,"cacheInvalidationPeriod",void 0),j([(0,v.SB)(),L("design:type",Array)],U.prototype,"terms",void 0),j([(0,v.SB)(),L("design:type",Boolean)],U.prototype,"noTerms",void 0)}}]);
//# sourceMappingURL=638.01330378.chunk.js.map