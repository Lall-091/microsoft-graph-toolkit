"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[26],{17744:function(e,n,t){t.d(n,{g:function(){return o}});t(30969);var a=t(38667),i=t(47780),r=t(37574),s=(0,i.Z)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 300px)"},message:{paddingLeft:"10px"}}),o=function(e){var n=s();return(0,r.jsxs)("div",{className:n.root,children:[(0,r.jsx)(a.$,{}),(0,r.jsx)("div",{className:n.message,children:(0,r.jsx)("span",{children:e.message||"Loading..."})})]})}},90505:function(e,n,t){t.d(n,{m:function(){return o}});t(30969);var a=t(47780),i=t(73583),r=t(37574),s=(0,a.Z)({divider:{alignItems:"self-start",paddingTop:"20px",marginBottom:"20px"}}),o=function(e){var n=s();return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:e.title}),(0,r.jsx)("div",{children:e.description}),(0,r.jsx)(i.i,{className:n.divider})]})}},27026:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var a=t(96234),i=t(33028),r=t(30969),s=t(90505),o=t(71166),c=t(17744),l=t(47780),d=t(94220),u=t(40016),h=t(14468),v=t(38675),x=t(84493),p=t(52895),m=t(15504),f=t(99657),g=t(102),j=t(32723),w=t(34795),y=t(57774),C=t(72742),b=t(2476),S=t(72292),k=t(95010),N=t(70390),Z=t(37574),I=(0,l.Z)({chat:{paddingLeft:"5px",paddingRight:"5px",display:"flex",alignItems:"center",height:"50px",cursor:"pointer",":hover":{backgroundColor:"var(--colorNeutralBackground1Hover)"}},active:{backgroundColor:"var(--colorNeutralBackground1Selected)"},person:{"--person-avatar-size-small":"40px","& .fui-Persona__primaryText":{fontSize:"var(--fontSizeBase300);"},"& .fui-Persona__secondaryText":(0,i.Z)({whiteSpace:"nowrap",textOverflow:"ellipsis",width:"200px",display:"inline-block"},d.q5.overflow("hidden"))},messagePreview:(0,i.Z)({whiteSpace:"nowrap",textOverflow:"ellipsis",width:"200px",display:"inline-block"},d.q5.overflow("hidden"))}),T=function(e){var n,t,a,i;return"text"===(null===e||void 0===e||null===(n=e.lastMessagePreview)||void 0===n||null===(t=n.body)||void 0===t?void 0:t.contentType)?null===e||void 0===e||null===(a=e.lastMessagePreview)||void 0===a||null===(i=a.body)||void 0===i?void 0:i.content:"..."},P=function(e){var n=I();return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)("span",{className:n.messagePreview,children:T(e.chat)})})},z=function(e){var n=e.chat,t=e.isSelected,i=e.onSelected,s=I(),o=(0,r.useState)(),c=(0,a.Z)(o,2),l=c[0],d=c[1];(0,r.useEffect)((function(){var e=function(){var e=(0,w.Z)((0,j.Z)().mark((function e(){var n;return(0,j.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.C.me();case 2:n=e.sent,d(n.id);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();l||e()}),[l]);var h=(0,r.useCallback)((function(e){var n,t,a=null===(n=e.members)||void 0===n?void 0:n.find((function(e){return e.userId!==l}));return a?(console.log("member",a),a.userId):1===(null===(t=e.members)||void 0===t?void 0:t.length)&&e.members[0].userId===l?l:void 0}),[l]),v=(0,r.useCallback)((function(e){var n,t="";e.topic?t=e.topic:t=null===(n=e.members)||void 0===n?void 0:n.map((function(e){var n;return null===(n=e.displayName)||void 0===n?void 0:n.split(" ")[0]})).join(", ");return t}),[]);return(0,Z.jsx)(Z.Fragment,{children:l&&(0,Z.jsxs)("div",{className:(0,u.z)(s.chat,"".concat(t&&s.active)),children:["oneOnOne"===n.chatType&&(0,Z.jsx)(b.F,{userId:h(n),view:S.b.twolines,avatarSize:"auto",showPresence:!0,onClick:function(){return i(n)},className:s.person,children:(0,Z.jsx)(P,{template:"line2",chat:n})}),"group"===n.chatType&&(0,Z.jsxs)("div",{onClick:function(){return i(n)},children:[(0,Z.jsx)(y.I,{textAlignment:"center",size:"extra-large",name:v(n),secondaryText:T(n),avatar:{icon:(0,Z.jsx)(k.mPx,{}),initials:null},className:s.person}),(0,Z.jsx)("span",{})]}),"meeting"===n.chatType&&(0,Z.jsx)("div",{onClick:function(){return i(n)},children:(0,Z.jsx)(y.I,{textAlignment:"center",size:"extra-large",className:s.person,avatar:{icon:(0,Z.jsx)(N.$i4,{}),initials:null},name:v(n),secondaryText:T(n)})})]})})},B=function(e){var n=e.dataContext.value,t=(0,r.useState)(e.selectedChat||n[0]),i=(0,a.Z)(t,2),s=i[0],o=i[1],c=r.useCallback((function(n){o(n),e.onSelected(s)}),[o,s,e]);r.useEffect((function(){c(s)}));return console.log("chats",n),(0,Z.jsx)("div",{children:n.map((function(e,n){return(0,Z.jsx)(z,{chat:e,isSelected:!s&&0===n||(t=e,!!s&&s&&t.id===(null===s||void 0===s?void 0:s.id)),onSelected:c},e.id);var t}))})},M=(0,l.Z)({container:{display:"flex",flexDirection:"row"},panels:(0,i.Z)({},d.q5.padding("10px")),main:(0,i.Z)((0,i.Z)({display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"300px",minWidth:"300px"},d.q5.overflow("auto")),{},{maxHeight:"80vh",borderRightColor:"var(--neutral-stroke-rest)",borderRightStyle:"solid",borderRightWidth:"1px"}),side:(0,i.Z)((0,i.Z)({display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"80%"},d.q5.overflow("auto")),{},{maxHeight:"80vh",height:"100%"}),newChat:{paddingBottom:"10px",marginRight:"0px",marginLeft:"auto"},dialog:{display:"block"}}),$=r.memo((function(e){return(0,Z.jsxs)(o.d,{resource:"me/chats?$expand=members,lastMessagePreview&$orderBy=lastMessagePreview/createdDateTime desc&$filter=viewpoint/lastMessageReadDateTime ge ".concat(function(e){var n=new Date;return n.setMonth(n.getMonth()-e),n.toISOString()}(9)),scopes:["chat.read"],cacheEnabled:!0,children:[(0,Z.jsx)(B,{template:"default",onSelected:e.onChatSelected,selectedChat:e.chatSelected}),(0,Z.jsx)(c.g,{template:"loading",message:"Loading your chats..."})]})})),D=function(){var e=M(),n=r.useState(),t=(0,a.Z)(n,2),i=t[0],o=t[1],c=r.useState(!1),l=(0,a.Z)(c,2),d=l[0],j=l[1];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(s.m,{title:"Chats",description:"Stay in touch with your teammates and navigate your chats"}),(0,Z.jsxs)("div",{className:e.container,children:[(0,Z.jsxs)("div",{className:(0,u.z)(e.panels,e.main),children:[(0,Z.jsx)("div",{className:e.newChat,children:(0,Z.jsxs)(h.V,{open:d,children:[(0,Z.jsx)(v.h,{disableButtonEnhancement:!0,children:(0,Z.jsx)(x.z,{appearance:"primary",onClick:function(){return j(!0)},children:"New Chat"})}),(0,Z.jsx)(p.c,{children:(0,Z.jsxs)(m.a,{className:e.dialog,children:[(0,Z.jsx)(f.$,{children:"New Chat"}),(0,Z.jsx)(g.Vk,{onChatCreated:function(e){e.id!==(null===i||void 0===i?void 0:i.id)&&d&&j(!1),o(e)},onCancelClicked:function(){j(!1)}})]})})]})}),(0,Z.jsx)($,{chatSelected:i,onChatSelected:o})]}),(0,Z.jsx)("div",{className:e.side,children:i&&(0,Z.jsx)(g.en,{chatId:i.id})})]})]})}},71166:function(e,n,t){t.d(n,{d:function(){return i}});var a=t(57724),i=(0,t(17908).$)("get",a.xV)}}]);
//# sourceMappingURL=26.ddf89181.chunk.js.map