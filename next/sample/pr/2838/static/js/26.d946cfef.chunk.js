"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[26],{17744:function(e,n,t){t.d(n,{g:function(){return o}});t(30969);var r=t(38667),i=t(47780),a=t(37574),s=(0,i.Z)({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 300px)"},message:{paddingLeft:"10px"}}),o=function(e){var n=s();return(0,a.jsxs)("div",{className:n.root,children:[(0,a.jsx)(r.$,{}),(0,a.jsx)("div",{className:n.message,children:(0,a.jsx)("span",{children:e.message||"Loading..."})})]})}},90505:function(e,n,t){t.d(n,{m:function(){return o}});t(30969);var r=t(47780),i=t(73583),a=t(37574),s=(0,r.Z)({divider:{alignItems:"self-start",paddingTop:"20px",marginBottom:"20px"}}),o=function(e){var n=s();return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{children:e.title}),(0,a.jsx)("div",{children:e.description}),(0,a.jsx)(i.i,{className:n.divider})]})}},27026:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var r=t(96234),i=t(33028),a=t(30969),s=t(90505),o=t(71166),l=t(17744),d=t(47780),c=t(94220),u=t(40016),v=t(14468),m=t(38675),p=t(84493),f=t(52895),h=t(15504),g=t(99657),x=t(68342),w=t(32723),j=t(34795),y=t(72742),S=t(57774),b=t(2476),C=t(72292),k=t(29267),N=t(97875),Z=t(37574),P=(0,d.Z)({chat:{paddingLeft:"5px",paddingRight:"5px",display:"flex",alignItems:"center",height:"50px",cursor:"pointer",":hover":{backgroundColor:"var(--colorNeutralBackground1Hover)"}},active:{backgroundColor:"var(--colorNeutralBackground1Selected)"},person:{userSelect:"none","--person-line1-font-weight":"var(--fontWeightRegular)","--person-avatar-size-small":"40px","--person-avatar-size":"40px","--person-line2-font-size":"var(--fontSizeBase200)","--person-line2-text-color":"var(--colorNeutralForeground4)","& .fui-Persona__primaryText":{fontSize:"var(--fontSizeBase300)",fontWeight:"var(--fontWeightRegular)"},"& .fui-Persona__secondaryText":(0,i.Z)({whiteSpace:"nowrap",textOverflow:"ellipsis",width:"200px",display:"inline-block",fontSize:"var(--fontSizeBase200);",color:"var(--colorNeutralForeground4)"},c.q5.overflow("hidden"))},group:{paddingTop:"5px"},messagePreview:(0,i.Z)({whiteSpace:"nowrap",textOverflow:"ellipsis",width:"200px",display:"inline-block"},c.q5.overflow("hidden"))}),I=a.memo((function(e){var n=e.chat,t=e.isSelected,i=e.onSelected,s=e.userId,o=P(),l=(0,a.useState)(""),d=(0,r.Z)(l,2),c=d[0],v=d[1],m=(0,a.useCallback)((function(e){var n,t,r=null===(n=e.members)||void 0===n?void 0:n.find((function(e){return e.userId!==s}));return r?r.userId:1===(null===(t=e.members)||void 0===t?void 0:t.length)&&e.members[0].userId===s?s:void 0}),[s]),p=(0,a.useCallback)((function(e){var n,t,r=new Intl.ListFormat("en"),i=[];return e.topic?e.topic:(null===(n=e.members)||void 0===n||null===(t=n.filter((function(e){return e.userId!==s})))||void 0===t||t.forEach((function(e){var n;i.push(null===(n=e.displayName)||void 0===n?void 0:n.split(" ")[0])})),r.format(i))}),[s]);return a.useEffect((function(){v(function(e,n){var t,r,i,a,s,o,l,d,c,u,v,m,p,f,h="";if(null!==e&&void 0!==e&&null!==(t=e.lastMessagePreview)&&void 0!==t&&null!==(r=t.from)&&void 0!==r&&r.user&&(null===e||void 0===e||null===(i=e.lastMessagePreview)||void 0===i||null===(a=i.from)||void 0===a?void 0:a.user.id)!==n?(h+=null===e||void 0===e||null===(u=e.lastMessagePreview)||void 0===u||null===(v=u.from)||void 0===v||null===(m=v.user.displayName)||void 0===m?void 0:m.split(" ")[0],h+=": "):h+="You: ","text"===(null===e||void 0===e||null===(s=e.lastMessagePreview)||void 0===s||null===(o=s.body)||void 0===o?void 0:o.contentType))h+=null===e||void 0===e||null===(p=e.lastMessagePreview)||void 0===p||null===(f=p.body)||void 0===f?void 0:f.content;else if("html"===(null===e||void 0===e||null===(l=e.lastMessagePreview)||void 0===l||null===(d=l.body)||void 0===d?void 0:d.contentType)){var g,x,w=null===e||void 0===e||null===(g=e.lastMessagePreview)||void 0===g||null===(x=g.body)||void 0===x?void 0:x.content,j=(new DOMParser).parseFromString(w,"text/html"),y=j.querySelectorAll("img"),S=j.querySelector("attachment"),b=j.querySelector("span[itemId]");if(j.querySelector("systemEventMessage")||b)return;h+=j.body.textContent||j.body.innerText||"",y&&(Array.from(y.values()).find((function(e){return e.src.includes(".gif")}))?h+=" \ud83d\udcf7 GIF":h+=" Sent an image"),S&&(h="Sent a card")}return null===(c=h)||void 0===c?void 0:c.trim().replace(/[\n\t\r]/g,"").replace(/\s+/g," ")}(n,s))}),[n,s]),(0,Z.jsx)(Z.Fragment,{children:s&&(0,Z.jsxs)("div",{className:(0,u.z)(o.chat,"".concat(t&&o.active)),children:["oneOnOne"===n.chatType&&(0,Z.jsx)(b.F,{userId:m(n),view:c?C.b.twolines:C.b.oneline,avatarSize:"auto",showPresence:!0,onClick:function(){return i(n)},className:o.person,children:c&&(0,Z.jsx)(M,{template:"line2",chat:n,userId:s,messagePreview:c})}),"group"===n.chatType&&(0,Z.jsxs)("div",{onClick:function(){return i(n)},children:[(0,Z.jsx)(S.I,{textAlignment:"center",size:"extra-large",name:p(n),secondaryText:c,avatar:{icon:(0,Z.jsx)(k.rqh,{}),initials:null},className:(0,u.z)(o.person,o.group)}),(0,Z.jsx)("span",{})]}),"meeting"===n.chatType&&(0,Z.jsx)("div",{onClick:function(){return i(n)},children:(0,Z.jsx)(S.I,{textAlignment:"center",size:"extra-large",className:(0,u.z)(o.person,o.group),avatar:{icon:(0,Z.jsx)(N.mLZ,{}),initials:null},name:p(n),secondaryText:c})})]})})})),M=function(e){var n=P();return(0,Z.jsx)(Z.Fragment,{children:e.messagePreview&&(0,Z.jsx)("span",{className:n.messagePreview,children:e.messagePreview})})},z=a.memo(I),T=function(e){var n=e.dataContext.value,t=(0,a.useState)(),i=(0,r.Z)(t,2),s=i[0],o=i[1],l=(0,a.useState)(n[0]),d=(0,r.Z)(l,2),c=d[0],u=d[1],v=a.useCallback((function(n){u(n),e.onSelected(c)}),[u,c,e]);a.useEffect((function(){v(c)})),a.useEffect((function(){var e=function(){var e=(0,j.Z)((0,w.Z)().mark((function e(){var n;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.C.me();case 2:n=e.sent,o(n.id);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s||e()}),[s]);return(0,Z.jsx)("div",{children:n.filter((function(e){var n;return(null===(n=e.members)||void 0===n?void 0:n.length)>1})).map((function(e,n){return(0,Z.jsx)(z,{chat:e,isSelected:!c&&0===n||(t=e,!!c&&c&&t.id===(null===c||void 0===c?void 0:c.id)),onSelected:v,userId:s},e.id);var t}))})},q=(0,d.Z)({container:{display:"flex",flexDirection:"row"},panels:(0,i.Z)({},c.q5.padding("10px")),main:(0,i.Z)((0,i.Z)({display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"300px",minWidth:"300px"},c.q5.overflow("auto")),{},{maxHeight:"80vh",borderRightColor:"var(--neutral-stroke-rest)",borderRightStyle:"solid",borderRightWidth:"1px"}),side:(0,i.Z)((0,i.Z)({display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"80%"},c.q5.overflow("auto")),{},{maxHeight:"80vh",height:"100%"}),newChat:{paddingBottom:"10px",marginRight:"0px",marginLeft:"auto"},dialog:{display:"block"},dialogSurface:{contain:"unset"}}),B=a.memo((function(e){return(0,Z.jsxs)(o.d,{resource:e.resourceUrl,scopes:["chat.read"],children:[(0,Z.jsx)(T,{template:"default",onSelected:e.onChatSelected}),(0,Z.jsx)(l.g,{template:"loading",message:"Loading your chats..."})]})})),D=function(){var e=q(),n=function(e){var n=new Date;return n.setMonth(n.getMonth()-e),n.toISOString()},t=a.useState("me/chats?$expand=members,lastMessagePreview&$orderBy=lastMessagePreview/createdDateTime desc&$filter=viewpoint/lastMessageReadDateTime ge ".concat(n(9))),i=(0,r.Z)(t,2),o=i[0],l=i[1],d=a.useState(),c=(0,r.Z)(d,2),w=c[0],j=c[1],y=a.useState(!1),S=(0,r.Z)(y,2),b=S[0],C=S[1];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(s.m,{title:"Chats",description:"Stay in touch with your teammates and navigate your chats"}),(0,Z.jsxs)("div",{className:e.container,children:[(0,Z.jsxs)("div",{className:(0,u.z)(e.panels,e.main),children:[(0,Z.jsx)("div",{className:e.newChat,children:(0,Z.jsxs)(v.V,{open:b,children:[(0,Z.jsx)(m.h,{disableButtonEnhancement:!0,children:(0,Z.jsx)(p.z,{appearance:"primary",onClick:function(){return C(!0)},children:"New Chat"})}),(0,Z.jsx)(f.c,{className:e.dialogSurface,children:(0,Z.jsxs)(h.a,{className:e.dialog,children:[(0,Z.jsx)(g.$,{children:"New Chat"}),(0,Z.jsx)(x.Vk,{onChatCreated:function(e){e.id!==(null===w||void 0===w?void 0:w.id)&&b&&(C(!1),l("me/chats?$expand=members,lastMessagePreview&$orderBy=lastMessagePreview/createdDateTime desc&$filter=viewpoint/lastMessageReadDateTime ge ".concat(n(9)))),j(e)},onCancelClicked:function(){C(!1)}})]})})]})}),(0,Z.jsx)(B,{onChatSelected:j,resourceUrl:o})]}),(0,Z.jsx)("div",{className:e.side,children:w&&(0,Z.jsx)(x.en,{chatId:w.id})})]})]})}},71166:function(e,n,t){t.d(n,{d:function(){return i}});var r=t(57724),i=(0,t(17908).$)("get",r.xV)}}]);
//# sourceMappingURL=26.d946cfef.chunk.js.map