"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[363],{505:function(e,t,n){n.d(t,{m:function(){return l}});n(969);var r=n(7780),a=n(3583),i=n(7574),s=(0,r.Z)({divider:{alignItems:"self-start",paddingTop:"20px",marginBottom:"20px"}}),l=function(e){var t=s();return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:e.title}),(0,i.jsx)("div",{children:e.description}),(0,i.jsx)(a.i,{className:t.divider})]})}},7363:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r=n(6234),a=n(3028),i=n(969),s=n(505),l=n(5750),c=n(6231),o=(0,c.$)("search-results",l.GB),d=n(7574),u=function(e){return(0,d.jsx)(d.Fragment,{children:e.searchTerm&&(0,d.jsxs)(d.Fragment,{children:["*"!==e.searchTerm&&(0,d.jsx)(o,{entityTypes:["bookmark"],queryString:e.searchTerm,version:"beta",size:1,scopes:["Bookmark.Read.All"],children:(0,d.jsx)(m,{template:"no-data"})}),(0,d.jsx)(o,{entityTypes:["driveItem","listItem","site"],queryString:e.searchTerm,scopes:["Files.Read.All","Files.ReadWrite.All","Sites.Read.All"],fetchThumbnail:!0})]})})},m=function(e){return(0,d.jsx)(d.Fragment,{})},h=function(e){return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(o,{entityTypes:["people"],size:20,queryString:e.searchTerm,version:"beta"})})},x=n(7780),p=n(4220),f=n(8013),j=n(9191),v=n(2205),g=function(e){return(0,d.jsx)(d.Fragment,{children:e.searchTerm&&(0,d.jsx)(o,{entityTypes:["externalItem"],contentSources:["/external/connections/contosoBlogPosts"],queryString:e.searchTerm,scopes:["ExternalItem.Read.All"],version:"beta"})})},T=n(8079),y=(0,c.$)("file",l.Rs),w=n(2476),S=n(9591),C=n(1654),D=n(4508),I=n(6816),b=n(2880),R=n(1901),k=n(275),F=n(2277),N=n(5908),Z=n(4636),L=n(710),q=(0,x.Z)({container:(0,a.Z)((0,a.Z)({},p.q5.gap("16px")),{},{display:"flex",flexDirection:"row",flexWrap:"wrap"}),card:{width:"300px",height:"fit-content",maxWidth:"100%"},caption:{color:S.T.colorNeutralForeground3},noDataSearchTerm:{fontWeight:S.T.fontWeightSemibold},emptyContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"calc(100vh - 300px)"},fileContainer:{display:"flex"},fileTitle:{paddingLeft:"10px",alignSelf:"center"},noDataMessage:{paddingLeft:"10px"},noDataIcon:{fontSize:"128px"},row:{cursor:"pointer"}}),W=function(e){return(0,d.jsx)(d.Fragment,{children:e.searchTerm&&(0,d.jsxs)(o,{entityTypes:["driveItem"],queryString:e.searchTerm,fetchThumbnail:!0,queryTemplate:"({searchTerms}) ContentTypeId:0x0101*",version:"beta",fields:["createdBy","lastModifiedDateTime","Title","DefaultEncodingURL"],size:30,cacheEnabled:!0,children:[(0,d.jsx)(M,{template:"default"}),(0,d.jsx)(M,{template:"loading"}),(0,d.jsx)(B,{template:"no-data"})]})})},A=function(e,t){return[(0,C.p)({columnId:"name",renderHeaderCell:function(){return"Name"},renderCell:function(n){return(0,d.jsx)(D.K,{children:e?(0,d.jsx)(I.j,{shape:"rectangle",style:{width:"120px"}}):(0,d.jsxs)("div",{className:t.fileContainer,children:[(0,d.jsx)(y,{fileDetails:n.resource,view:"image"}),(0,d.jsx)("span",{className:t.fileTitle,children:n.resource.listItem.fields.title})]})})}}),(0,C.p)({columnId:"modified",renderHeaderCell:function(){return"Modified"},renderCell:function(t){return(0,d.jsx)(D.K,{children:e?(0,d.jsx)(I.j,{shape:"rectangle",style:{width:"120px"}}):z(new Date(t.resource.lastModifiedDateTime))})}}),(0,C.p)({columnId:"owner",renderHeaderCell:function(){return"Owner"},renderCell:function(t){return(0,d.jsx)(D.K,{children:e?(0,d.jsxs)("div",{style:{display:"grid",alignItems:"center",position:"relative",gridTemplateColumns:"min-content 80%",gap:"10px"},children:[(0,d.jsx)(I.j,{shape:"circle",size:32}),(0,d.jsx)(I.j,{style:{width:"120px"}})]}):(0,d.jsx)(w.F,{personQuery:t.resource.createdBy.user.email,view:"oneline",personCardInteraction:"hover"})})}})]},M=function(e){var t,n,a,s=q(),l=i.useState(null===(t=e.dataContext.value)||void 0===t||null===(n=t[0])||void 0===n||null===(a=n.hitsContainers[0])||void 0===a?void 0:a.hits),c=(0,r.Z)(l,1)[0];return(0,d.jsx)("div",{children:(0,d.jsxs)(b._,{columns:A("loading"===e.template,s),items:"loading"===e.template?(0,T.Z)(Array(30)):c,children:[(0,d.jsx)(R.S,{children:(0,d.jsx)(k.m,{children:function(e){var t=e.renderHeaderCell;return(0,d.jsx)(F.p,{children:t()})}})}),(0,d.jsx)(N.s,{children:function(e){var t=e.item,n=e.rowId;return(0,d.jsx)(k.m,{className:s.row,onClick:function(){return function(e){var t=new URL(e.resource.listItem.fields.defaultEncodingURL);t.searchParams.append("Web","1"),window.open(t.toString(),"_blank")}(t)},children:function(e){var n=e.renderCell;return(0,d.jsx)(Z.a,{children:n(t)})}},n)}})]})})},B=function(e){var t,n=q(),a=i.useState(null===(t=e.dataContext.value[0])||void 0===t?void 0:t.searchTerms),s=(0,r.Z)(a,1)[0];return(0,d.jsxs)("div",{className:n.emptyContainer,children:[(0,d.jsx)("div",{children:(0,d.jsx)(L.vRj,{className:n.noDataIcon})}),(0,d.jsxs)("div",{className:n.noDataMessage,children:["We couldn't find any results for ",(0,d.jsx)("span",{className:n.noDataSearchTerm,children:s.join(" ")})]})]})},z=function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});var r=new Date(n);if(r.setDate(t.getDate()-t.getDay()),e>=r)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});var a=new Date(r);return a.setDate(r.getDate()-7),e>=a?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},E=(0,x.Z)({panels:(0,a.Z)({},p.q5.padding("10px")),container:{maxWidth:"1028px",width:"100%"}}),O=function(){var e=E(),t=(0,v.b)(),n=i.useState(new URLSearchParams(window.location.search).get("q")),a=(0,r.Z)(n,1)[0],l=i.useState("allResults"),c=(0,r.Z)(l,2),o=c[0],m=c[1];return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.m,{title:"Search",description:"Use this Search Center to test Microsot Graph Toolkit search components capabilities"}),(0,d.jsxs)("div",{className:e.container,children:[(0,d.jsxs)(f.t,{selectedValue:o,onTabSelect:function(e,t){m(t.value)},children:[(0,d.jsx)(j.O,{value:"allResults",children:"All Results"}),(0,d.jsx)(j.O,{value:"driveItems",children:"Files"}),(0,d.jsx)(j.O,{value:"externalItems",children:"External Items"}),(0,d.jsx)(j.O,{value:"people",children:"People"})]}),(0,d.jsxs)("div",{className:e.panels,children:["allResults"===o&&(0,d.jsx)(u,{searchTerm:null!==a&&void 0!==a?a:t.state.searchTerm}),"driveItems"===o&&(0,d.jsx)(W,{searchTerm:null!==a&&void 0!==a?a:t.state.searchTerm}),"externalItems"===o&&(0,d.jsx)(g,{searchTerm:null!==a&&void 0!==a?a:t.state.searchTerm}),"people"===o&&(0,d.jsx)(h,{searchTerm:null!==a&&void 0!==a?a:t.state.searchTerm})]})]})]})}}}]);
//# sourceMappingURL=363.bd05d635.chunk.js.map