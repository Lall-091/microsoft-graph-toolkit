import{aL as v,aM as d,cR as w}from"./App-C2ns6K9I.js";import{p as y,f as O}from"./index-CnB6Kp1M.js";var B=function(s,t,i,e){function n(o){return o instanceof i?o:new i(function(c){c(o)})}return new(i||(i=Promise))(function(o,c){function l(u){try{h(e.next(u))}catch(p){c(p)}}function a(u){try{h(e.throw(u))}catch(p){c(p)}}function h(u){u.done?o(u.value):n(u.value).then(l,a)}h((e=e.apply(s,t||[])).next())})};class I{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(t,i,e){return B(this,void 0,void 0,function*(){const n=yield i.get();if(n!=null&&n.value){const o=new I;return o._graph=t,o._value=n.value,o._nextLink=n["@odata.nextLink"],o._version=e||t.version,o}return null})}static createFromValue(t,i,e=null){const n=new I;return n._graph=t,n._value=i,n._nextLink=e,n._version=t.version,n}get nextLink(){return this._nextLink||""}next(){var t;return B(this,void 0,void 0,function*(){if(this._nextLink){const i=this._nextLink.split(this._version)[1],e=yield this._graph.api(i).version(this._version).get();if(!((t=e==null?void 0:e.value)===null||t===void 0)&&t.length)return this._value=this._value.concat(e.value),this._nextLink=e["@odata.nextLink"],e.value}return null})}}var r=function(s,t,i,e){function n(o){return o instanceof i?o:new i(function(c){c(o)})}return new(i||(i=Promise))(function(o,c){function l(u){try{h(e.next(u))}catch(p){c(p)}}function a(u){try{h(e.throw(u))}catch(p){c(p)}}function h(u){u.done?o(u.value):n(u.value).then(l,a)}h((e=e.apply(s,t||[])).next())})};const J=s=>Array.isArray(s.nextExpectedRanges),P=()=>r(void 0,void 0,void 0,function*(){yield v.getCache(d.fileLists,d.fileLists.stores.fileLists).clearStore()}),x=()=>v.config.files.invalidationPeriod||v.config.defaultInvalidationPeriod,m=()=>v.config.files.isEnabled&&v.config.isEnabled,C=()=>v.config.fileLists.invalidationPeriod||v.config.defaultInvalidationPeriod,F=()=>v.config.fileLists.isEnabled&&v.config.isEnabled,$=["Files.Read","Files.ReadWrite","Files.Read.All","Files.ReadWrite.All","Group.Read.All","Group.ReadWrite.All","Sites.Read.All","Sites.ReadWrite.All"],L=["Sites.Read.All","Sites.ReadWrite.All"],S=["Files.ReadWrite","Files.ReadWrite.All","Sites.ReadWrite.All"],f=(s,t,i=d.files.stores.fileQueries,e=$)=>r(void 0,void 0,void 0,function*(){const n=v.getCache(d.files,i),o=yield k(n,t);if(o)return o;let c;try{c=yield s.api(t).middlewareOptions(y(e)).get(),m()&&(yield n.putValue(t,{file:JSON.stringify(c)}))}catch{}return c||null}),V=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/drives/${t}/items/${i}`;return f(s,e,d.files.stores.driveFiles)}),U=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/drives/${t}/root:/${i}`;return f(s,e,d.files.stores.driveFiles)}),W=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/groups/${t}/drive/items/${i}`;return f(s,e,d.files.stores.groupFiles)}),E=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/groups/${t}/drive/root:/${i}`;return f(s,e,d.files.stores.groupFiles)}),T=(s,t)=>r(void 0,void 0,void 0,function*(){const i=`/me/drive/items/${t}`;return f(s,i,d.files.stores.userFiles)}),q=(s,t)=>r(void 0,void 0,void 0,function*(){const i=`/me/drive/root:/${t}`;return f(s,i,d.files.stores.userFiles)}),G=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/sites/${t}/drive/items/${i}`;return f(s,e,d.files.stores.siteFiles)}),M=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/sites/${t}/drive/root:/${i}`;return f(s,e,d.files.stores.siteFiles)}),j=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/sites/${t}/lists/${i}/items/${e}/driveItem`;return f(s,n,d.files.stores.siteFiles)}),z=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/users/${t}/drive/items/${i}`;return f(s,e,d.files.stores.userFiles)}),H=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/users/${t}/drive/root:/${i}`;return f(s,e,d.files.stores.userFiles)}),K=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/me/insights/${t}/${i}/resource`;return f(s,e,d.files.stores.insightFiles,L)}),Q=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/users/${t}/insights/${i}/${e}/resource`;return f(s,n,d.files.stores.insightFiles,L)}),g=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){let n;const o=v.getCache(d.fileLists,i),c=yield _(o,i,`${t}:${e}`);if(c)return n=b(s,c.files,c.nextLink),n;let l;try{if(l=s.api(t).middlewareOptions(y($)),e&&l.top(e),n=yield D(s,l),F()){const a=n.nextLink;yield o.putValue(t,{files:n.value.map(h=>JSON.stringify(h)),nextLink:a})}}catch{}return n||null}),X=(s,t)=>r(void 0,void 0,void 0,function*(){const i="/me/drive/root/children",e=d.fileLists.stores.fileLists;return g(s,i,e,t)}),Y=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/drives/${t}/items/${i}/children`,o=d.fileLists.stores.fileLists;return g(s,n,o,e)}),Z=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/drives/${t}/root:/${i}:/children`,o=d.fileLists.stores.fileLists;return g(s,n,o,e)}),ee=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/groups/${t}/drive/items/${i}/children`,o=d.fileLists.stores.fileLists;return g(s,n,o,e)}),te=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/groups/${t}/drive/root:/${i}:/children`,o=d.fileLists.stores.fileLists;return g(s,n,o,e)}),ie=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/me/drive/items/${t}/children`,n=d.fileLists.stores.fileLists;return g(s,e,n,i)}),se=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=`/me/drive/root:/${t}:/children`,n=d.fileLists.stores.fileLists;return g(s,e,n,i)}),ne=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/sites/${t}/drive/items/${i}/children`,o=d.fileLists.stores.fileLists;return g(s,n,o,e)}),oe=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/sites/${t}/drive/root:/${i}:/children`,o=d.fileLists.stores.fileLists;return g(s,n,o,e)}),re=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/users/${t}/drive/items/${i}/children`,o=d.fileLists.stores.fileLists;return g(s,n,o,e)}),ce=(s,t,i,e)=>r(void 0,void 0,void 0,function*(){const n=`/users/${t}/drive/root:/${i}:/children`,o=d.fileLists.stores.fileLists;return g(s,n,o,e)}),de=(s,t,i)=>r(void 0,void 0,void 0,function*(){const e=d.fileLists.stores.fileLists;return g(s,t,e,i)}),le=(s,t)=>r(void 0,void 0,void 0,function*(){const i=`/me/insights/${t}`,e=d.fileLists.stores.insightfileLists,n=v.getCache(d.fileLists,e),o=yield _(n,e,i);if(o)return o.files.map(a=>JSON.parse(a));let c;try{c=yield s.api(i).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(y(L)).get()}catch{}const l=yield R(s,c,L);return F()&&(yield n.putValue(i,{files:l.map(a=>JSON.stringify(a))})),l||null}),ae=(s,t,i)=>r(void 0,void 0,void 0,function*(){let e,n;i==="shared"?(e="/me/insights/shared",n=`((lastshared/sharedby/id eq '${t}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(e=`/users/${t}/insights/${i}`,n="resourceReference/type eq 'microsoft.graph.driveItem'");const o=`${e}?$filter=${n}`,c=d.fileLists.stores.insightfileLists,l=v.getCache(d.fileLists,c),a=yield _(l,c,o);if(a)return a.files.map(p=>JSON.parse(p));let h;try{h=yield s.api(e).filter(n).middlewareOptions(y(L)).get()}catch{}const u=yield R(s,h,L);return F()&&(yield l.putValue(e,{files:u.map(p=>JSON.stringify(p))})),u||null}),ue=(s,t)=>r(void 0,void 0,void 0,function*(){if(!t||t.length===0)return[];const i=s.createBatch(),e=[];let n,o;m()&&(n=v.getCache(d.files,d.files.stores.fileQueries));for(const c of t)m()&&(o=yield n.getValue(c)),m()&&o&&x()>Date.now()-o.timeCached?e.push(JSON.parse(o.file)):c!==""&&i.get(c,c,$);try{const c=yield i.executeAll();for(const l of t){const a=c.get(l);a!=null&&a.content&&(e.push(a.content),m()&&(yield n.putValue(l,{file:JSON.stringify(a.content)})))}return e}catch{try{return Promise.all(t.filter(l=>l&&l!=="").map(l=>r(void 0,void 0,void 0,function*(){const a=yield f(s,l);if(a)return m()&&(yield n.putValue(l,{file:JSON.stringify(a)})),a})))}catch{return[]}}}),R=(s,t,i)=>r(void 0,void 0,void 0,function*(){if(!t)return[];const e=t.value,n=s.createBatch(),o=[];for(const c of e){const l=c.resourceReference.id;l!==""&&n.get(l,l,i)}try{const c=yield n.executeAll();for(const l of e){const a=c.get(l.resourceReference.id);a!=null&&a.content&&o.push(a.content)}return o}catch{try{return Promise.all(e.filter(l=>!!l.resourceReference.id).map(l=>r(void 0,void 0,void 0,function*(){return yield s.api(l.resourceReference.id).middlewareOptions(y(i)).get()})))}catch{return[]}}}),D=(s,t)=>r(void 0,void 0,void 0,function*(){return I.create(s,t)}),b=(s,t,i)=>I.createFromValue(s,t.map(e=>JSON.parse(e)),i),k=(s,t)=>r(void 0,void 0,void 0,function*(){if(m()){const i=yield s.getValue(t);if(i&&x()>Date.now()-i.timeCached)return JSON.parse(i.file)}return null}),_=(s,t,i)=>r(void 0,void 0,void 0,function*(){if(s||(s=v.getCache(d.fileLists,t)),F()){const e=yield s.getValue(i);if(e&&C()>Date.now()-e.timeCached)return e}return null}),ve=s=>r(void 0,void 0,void 0,function*(){const t=s.nextLink;if(s.hasNext&&(yield s.next()),F()){const i=v.getCache(d.fileLists,d.fileLists.stores.fileLists),o=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(t)[3];yield i.putValue(o,{files:s.value.map(c=>JSON.stringify(c)),nextLink:t})}}),fe=(s,t,i)=>r(void 0,void 0,void 0,function*(){try{const e=yield s.api(t).responseType(O.RAW).middlewareOptions(y(i)).get();if(e.status===404)return{eTag:null,thumbnail:null};if(!e.ok)return null;const n=e.headers.get("eTag"),o=yield w(yield e.blob());return{eTag:n,thumbnail:o}}catch{return null}}),he=(s,t)=>r(void 0,void 0,void 0,function*(){try{return(yield s.api(t).middlewareOptions(y($)).get())||null}catch{}return null}),pe=(s,t,i)=>r(void 0,void 0,void 0,function*(){try{const e={item:{"@microsoft.graph.conflictBehavior":i||"rename"}};let n;try{n=yield s.api(t).middlewareOptions(y(S)).post(JSON.stringify(e))}catch{}return n||null}catch{return null}}),ge=(s,t,i,e,n)=>r(void 0,void 0,void 0,function*(){try{const o={"Content-Length":i,"Content-Range":e};let c;try{c=yield s.client.api(t).middlewareOptions(y(S)).headers(o).put(n)}catch{}return c||null}catch{return null}}),ye=(s,t,i)=>r(void 0,void 0,void 0,function*(){try{let e;try{e=yield s.client.api(t).middlewareOptions(y(S)).put(i)}catch{}return e||null}catch{return null}}),me=(s,t)=>r(void 0,void 0,void 0,function*(){try{yield s.client.api(t).middlewareOptions(y(S)).delete()}catch{return null}});export{T as A,q as B,z as C,H as D,Q as E,V as F,I as G,U as H,G as I,M as J,j as K,W as L,E as M,K as N,he as a,pe as b,ge as c,me as d,P as e,de as f,fe as g,ue as h,J as i,ie as j,se as k,le as l,X as m,Y as n,Z as o,ee as p,te as q,ne as r,ye as s,oe as t,re as u,L as v,ce as w,ae as x,ve as y,f as z};
