import{p as A,b as P,a as k,j as s,r as F}from"./index-hTImyq8J.js";import{P as B}from"./PageHeader-I8Yequpb.js";import{W as z,at as W,a1 as I,X as L,au as q,Y as p,a6 as N,av as Q,aw as U,ax as H,ay as K,az as G,aA as Z,a0 as c,aB as V,a8 as Y,Z as X,a4 as S,a2 as J,a3 as ee,aC as te,a9 as M,an as $,aq as w,ap as ne,ai as E,ar as oe,as as C}from"./App-BzsUK9sM.js";import{r as ie}from"./mgt-spinner-Cjrh1Vk8.js";import{G as re}from"./graph.files-DKBTnc1L.js";import{c as ae}from"./repeat-RjgbHnYE.js";import{G as _}from"./get-VGcQ1QE3.js";import"./mgt-get-asn_Xesw.js";const se=[z`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size, 24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size, 12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size, 20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size, 12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--person-avatar-size:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:rgb(255,255,255)!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:rgb(0,0,0)!important}}
`];var O=function(r,e,t,n){function a(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function l(d){try{f(n.next(d))}catch(m){i(m)}}function g(d){try{f(n.throw(d))}catch(m){i(m)}}function f(d){d.done?o(d.value):a(d.value).then(l,g)}f((n=n.apply(r,e||[])).next())})};const R=(r,e,t)=>O(void 0,void 0,void 0,function*(){const n=r.api(e).middlewareOptions(A(t)).orderby("start/dateTime");return re.create(r,n)}),le=(r,e,t,n)=>O(void 0,void 0,void 0,function*(){const a=`startdatetime=${e.toISOString()}`,o=`enddatetime=${t.toISOString()}`,i=n?`groups/${n}/calendar/calendarview?${a}&${o}`:`me/calendarview?${a}&${o}`;return R(r,i,n?["Group.Read.All","Group.ReadWrite.All"]:["Calendars.ReadBasic","Calendars.Read","Calendars.ReadWrite"])}),de=[z`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .people-list .people-person{--person-avatar-size:var(--people-person-avatar-size, 24px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size, 12px);font-weight:var(--people-overflow-font-weight,400)}
`];var u=function(r,e,t,n){var a=arguments.length,o=a<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var l=r.length-1;l>=0;l--)(i=r[l])&&(o=(a<3?i(o):a>3?i(e,t,o):i(e,t))||o);return a>3&&o&&Object.defineProperty(e,t,o),o},v=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},ce=function(r,e,t,n){function a(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function l(d){try{f(n.next(d))}catch(m){i(m)}}function g(d){try{f(n.throw(d))}catch(m){i(m)}}function f(d){d.done?o(d.value):a(d.value).then(l,g)}f((n=n.apply(r,e||[])).next())})};const pe=()=>{W(),I("people",h)};class h extends L{static get styles(){return de}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...q.requiredScopes])]}constructor(){super(),this.personCardInteraction="hover",this.version="v1.0",this.scopes=[],this._peoplePresence={},this._arrowKeyLocation=-1,this.renderContent=()=>!this.people||this.people.length===0?this.renderNoData():this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople(),this.renderLoading=()=>this.renderTemplate("loading",null)||p``,this.handleKeyDown=e=>{const t=this.shadowRoot.querySelector(".people-list");let n;const a=t==null?void 0:t.children;for(const l of a){const g=l;g.setAttribute("tabindex","-1"),g.blur()}const o=t.childElementCount,i=e.key;if(i==="ArrowRight")this._arrowKeyLocation=(this._arrowKeyLocation+1+o)%o;else if(i==="ArrowLeft")this._arrowKeyLocation=(this._arrowKeyLocation-1+o)%o;else if(i==="Tab"||i==="Escape")this._arrowKeyLocation=-1,t.blur();else if(["Enter","space"," "].includes(i)&&this.personCardInteraction!=="none"){const g=a[this._arrowKeyLocation].querySelector("mgt-person");g&&g.showPersonCard()}this._arrowKeyLocation>-1&&(n=a[this._arrowKeyLocation],n.setAttribute("tabindex","1"),n.focus())},this.showMax=3}clearState(){this.people=null}args(){return[this.providerState,this.groupId,this.userIds,this.peopleQueries,this.showMax,this.resource,this.version,this.fallbackDetails]}renderPeople(){const e=this.people.slice(0,this.showMax).filter(t=>t);return p`
      <ul
        tabindex="0"
        class="people-list"
        aria-label="people"
        @keydown=${this.handleKeyDown}>
        ${ae(e,t=>t.id?t.id:t.displayName,t=>p`
            <li tabindex="-1" class="people-person">
              ${this.renderPerson(t)}
            </li>
          `)}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){const e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||p`
        <li tabindex="-1" aria-label="and ${e} more attendees" class="overflow"><span>+${e}</span></li>
      `}renderPerson(e){let t={activity:"Offline",availability:"Offline",id:null};return this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]),this.renderTemplate("person",{person:e},e.id)||N`
        <mgt-person
          class="people-person"
          .personDetails=${e}
          .fetchImage=${!0}
          .avatarSize=${"small"}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${t}
          .usage=${"people"}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||p``}loadState(){return ce(this,void 0,void 0,function*(){if(!this.people){const e=P.globalProvider;if(e&&e.state===k.SignedIn){const t=e.graph.forComponent(this);this.groupId?this.people=yield Q(t,null,this.groupId,this.showMax,"person"):this.userIds?this.people=yield U(t,this.userIds,"","",this.fallbackDetails):this.peopleQueries?this.people=yield H(t,this.peopleQueries,this.fallbackDetails):this.resource?this.people=yield K(t,this.version,this.resource,this.scopes):this.people=yield G(t),this.showPresence?this._peoplePresence=yield Z(t,this.people):this._peoplePresence=null}}})}}u([c({attribute:"group-id",type:String}),v("design:type",String)],h.prototype,"groupId",void 0);u([c({attribute:"user-ids",converter:(r,e)=>r.split(",").map(t=>t.trim())}),v("design:type",Array)],h.prototype,"userIds",void 0);u([c({attribute:"people",type:Object}),v("design:type",Array)],h.prototype,"people",void 0);u([c({attribute:"people-queries",converter:(r,e)=>r.split(",").map(t=>t.trim())}),v("design:type",Array)],h.prototype,"peopleQueries",void 0);u([c({attribute:"show-max",type:Number}),v("design:type",Number)],h.prototype,"showMax",void 0);u([c({attribute:"show-presence",type:Boolean}),v("design:type",Boolean)],h.prototype,"showPresence",void 0);u([c({attribute:"person-card",converter:(r,e)=>V(r,"hover")}),v("design:type",String)],h.prototype,"personCardInteraction",void 0);u([c({attribute:"resource",type:String}),v("design:type",String)],h.prototype,"resource",void 0);u([c({attribute:"version",type:String}),v("design:type",Object)],h.prototype,"version",void 0);u([c({attribute:"scopes",converter:r=>r?r.toLowerCase().split(","):null,reflect:!0}),v("design:type",Array)],h.prototype,"scopes",void 0);u([c({attribute:"fallback-details",type:Array}),v("design:type",Array)],h.prototype,"fallbackDetails",void 0);u([Y(),v("design:type",Object)],h.prototype,"_arrowKeyLocation",void 0);var x=function(r,e,t,n){var a=arguments.length,o=a<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,n);else for(var l=r.length-1;l>=0;l--)(i=r[l])&&(o=(a<3?i(o):a>3?i(e,t,o):i(e,t))||o);return a>3&&o&&Object.defineProperty(e,t,o),o},b=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},j=function(r,e,t,n){function a(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function l(d){try{f(n.next(d))}catch(m){i(m)}}function g(d){try{f(n.throw(d))}catch(m){i(m)}}function f(d){d.done?o(d.value):a(d.value).then(l,g)}f((n=n.apply(r,e||[])).next())})};const he=()=>{X(te),pe(),I("agenda",y)};class y extends L{constructor(){super(...arguments),this.days=3,this.renderContent=()=>{if(!this.events||this.events.length===0)return this.renderNoData();const e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});if(t)return t;const n={agenda:!0,grouped:this.groupByDay};return p`
      <div dir=${this.direction} class="${S(n)}">
        ${this.groupByDay?this.renderGroups(e):this.renderEvents(e)}
      </div>
    `},this.renderLoading=()=>this.renderTemplate("loading",null)||p`
        <fluent-card class="event event-loading">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </fluent-card>`,this.onResize=()=>{this._isNarrow=this.offsetWidth<600}}static get styles(){return se}static get requiredScopes(){return[...new Set(["calendars.read",...h.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}reload(){return j(this,void 0,void 0,function*(){this.events=yield this.loadEvents()})}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||p``}renderEvent(e){this._isNarrow=this.offsetWidth<600;const t={narrow:this._isNarrow};return p`
      <fluent-card class="${S(Object.assign({event:!0},t))}">
        <div class="${S(Object.assign({"event-time-container":!0},t))}">
          <div class="event-time" aria-label="${this.getEventTimeString(e)}">${this.getEventTimeString(e)}</div>
        </div>
        <div class="${S(Object.assign({"event-details-container":!0},t))}">
          ${this.renderTitle(e)} ${this.renderLocation(e)} ${this.renderAttendees(e)}
        </div>
        <div class="event-other-container">${this.renderOther(e)}</div>
      </fluent-card>
    `}renderHeader(e){return this.renderTemplate("header",{header:e},"header-"+e)||p`
        <div class="header" aria-label="${e}">${e}</div>
      `}renderTitle(e){return p`
      <div
        aria-label=${e.subject}
        class="${S({"event-subject":!0,narrow:this._isNarrow})}"
      >
        ${e.subject}
      </div>`}renderLocation(e){return e.location.displayName?p`
      <div class="event-location-container">
        <div class="event-location-icon">${J(ee.OfficeLocation)}</div>
        <div class="event-location" aria-label="${e.location.displayName}">${e.location.displayName}</div>
      </div>
    `:null}renderAttendees(e){return e.attendees.length?N`
      <mgt-people
        show-max="5"
        show-presence
        class="event-attendees"
        .peopleQueries=${e.attendees.map(t=>t.emailAddress.address)}
      ></mgt-people>
    `:null}renderOther(e){return this.hasTemplate("event-other")?p`
          ${this.renderTemplate("event-other",{event:e},e.id+"-other")}
        `:null}renderGroups(e){const t={};return e.forEach(n=>{var a;let o=(a=n==null?void 0:n.start)===null||a===void 0?void 0:a.dateTime;n.end.timeZone==="UTC"&&(o+="Z");const i=this.getDateHeaderFromDateTimeString(o);t[i]=t[i]||[],t[i].push(n)}),p`
      ${Object.keys(t).map(n=>p`
            <div class="group">${this.renderHeader(n)} ${this.renderEvents(t[n])}</div>
          `)}
    `}renderEvents(e){return p`
        ${e.map(t=>p`
              <div
                class="event-container"
                tabindex="0"
                @focus=${()=>this.eventClicked(t)}>
                ${this.renderTemplate("event",{event:t},t.id)||this.renderEvent(t)}
              </div>`)}`}args(){return[this.providerState,this.preferredTimezone,this.eventQuery,this.date,this.groupId,this.days]}loadState(){return j(this,void 0,void 0,function*(){if(this.events)return;const e=yield this.loadEvents();(e==null?void 0:e.length)>0&&(this.events=e)})}eventClicked(e){this.fireCustomEvent("eventClick",e)}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";let t=e.start.dateTime;e.start.timeZone==="UTC"&&(t+="Z");let n=e.end.dateTime;e.end.timeZone==="UTC"&&(n+="Z");const a=this.prettyPrintTimeFromDateTime(new Date(t)),o=this.prettyPrintTimeFromDateTime(new Date(n));return`${a} - ${o}`}loadEvents(){return j(this,void 0,void 0,function*(){const e=P.globalProvider;let t=[];if((e==null?void 0:e.state)===k.SignedIn){const n=e.graph.forComponent(this);if(this.eventQuery)try{const a=this.eventQuery.split("|");let o,i;a.length>1?(i=a[0].trim(),o=a[1].trim()):i=this.eventQuery;const l=yield R(n,i,o?[o]:[]);if(l!=null&&l.value)for(t=l.value;l.hasNext;)yield l.next(),t=l.value}catch{}else{const a=this.date?new Date(this.date):new Date,o=new Date(a.getTime());o.setDate(a.getDate()+this.days);try{const i=yield le(n,a,o,this.groupId);if(i!=null&&i.value)for(t=i.value;i.hasNext;)yield i.next(),t=i.value}catch{}}}return t})}prettyPrintTimeFromDateTime(e){return e.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}getDateHeaderFromDateTimeString(e){return new Date(e).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}}x([c({attribute:"date",type:String}),b("design:type",String)],y.prototype,"date",void 0);x([c({attribute:"group-id",type:String}),b("design:type",String)],y.prototype,"groupId",void 0);x([c({attribute:"days",type:Number}),b("design:type",Object)],y.prototype,"days",void 0);x([c({attribute:"event-query",type:String}),b("design:type",String)],y.prototype,"eventQuery",void 0);x([c({attribute:"events",type:Array,hasChanged:(r,e)=>r!==e}),b("design:type",Array)],y.prototype,"events",void 0);x([c({attribute:"show-max",type:Number}),b("design:type",Number)],y.prototype,"showMax",void 0);x([c({attribute:"group-by-day",type:Boolean}),b("design:type",Boolean)],y.prototype,"groupByDay",void 0);x([c({attribute:"preferred-timezone",type:String}),b("design:type",String)],y.prototype,"preferredTimezone",void 0);x([c({attribute:!1}),b("design:type",Boolean)],y.prototype,"_isNarrow",void 0);const ue=M("agenda",he),ve=M("spinner",ie),ge=$({email:{boxShadow:"var(--box-shadow)",...w.padding("10px"),...w.margin("8px"),":hover":{borderLeftWidth:"4px",borderLeftColor:"var(--input-border-color--hover)",borderLeftStyle:"solid",paddingLeft:"6px"},"& mgt-person":{"--font-size":"12px","--person-avatar-size":"16px"}},link:{color:"var(--color-sub1)",textDecorationLine:"none"},header:{display:"flex",justifyContent:"space-between"},subject:{color:"var(--color-sub1)",fontSize:"14px",...w.gridArea("1 / 1 / auto / 3"),...w.margin("0")},title:{display:"flex",justifyContent:"space-between",marginBottom:"4px",color:"var(--color-sub1)"},date:{fontSize:"12px",paddingLeft:"4px",float:"right"},body:{fontSize:"13px",textOverflow:"ellipsis",wordWrap:"break-word",...w.overflow("hidden"),maxHeight:"2.8em",lineHeight:"1.4em",color:"var(--color-sub2)"},emptyBody:{fontStyle:"italic"}});function T(r){var n,a;const e=ge(),t=r.dataContext;return s.jsx("div",{className:e.email,children:s.jsxs("a",{className:e.link,href:t.webLink,target:"_blank",rel:"noreferrer",children:[s.jsx("div",{className:e.header,children:s.jsx("div",{children:s.jsx(ne,{personQuery:(a=(n=t.sender)==null?void 0:n.emailAddress)==null?void 0:a.address,personCardInteraction:"hover",view:"oneline"})})}),s.jsxs("div",{className:e.title,children:[s.jsx("h3",{className:e.subject,children:t.subject}),s.jsx("span",{className:e.date,children:new Date(t.receivedDateTime).toLocaleDateString()})]}),t!=null&&t.bodyPreview?s.jsx("div",{className:e.body,children:t.bodyPreview}):s.jsx("div",{className:E(e.body,e.emptyBody),children:"..."})]})})}const fe=$({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 300px)"},message:{paddingLeft:"10px"}}),D=r=>{const e=fe();return s.jsxs("div",{className:e.root,children:[s.jsx(ve,{}),s.jsx("div",{className:e.message,children:s.jsx("span",{children:r.message||"Loading..."})})]})},me=$({container:{display:"flex",flexDirection:"row"},panels:{...w.padding("10px")},main:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"70%"},side:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"30%"}}),_e=()=>{const r=me(),[e,t]=F.useState("focused"),n=(a,o)=>{t(o.value)};return s.jsxs(s.Fragment,{children:[s.jsx(B,{title:"Mail and Calendar",description:"Stay productive and navigate your emails and your calendar appointments"}),s.jsxs(oe,{selectedValue:e,onTabSelect:n,className:r.container,children:[s.jsx(C,{value:"focused",children:"Focused"}),s.jsx(C,{value:"others",children:"Others"})]}),s.jsxs("div",{className:r.container,children:[s.jsxs("div",{className:E(r.panels,r.main),children:[e==="focused"&&s.jsxs(_,{resource:"/me/mailFolders/Inbox/messages?$orderby=InferenceClassification, createdDateTime DESC&filter=InferenceClassification eq 'Focused'",maxPages:3,scopes:["Mail.Read"],children:[s.jsx(T,{template:"value"}),s.jsx(D,{template:"loading",message:"Loading your focused inbox..."})]}),e==="others"&&s.jsxs(_,{resource:"/me/mailFolders/Inbox/messages?$orderby=InferenceClassification, createdDateTime DESC&filter=InferenceClassification eq 'Other'",maxPages:3,scopes:["Mail.Read"],children:[s.jsx(T,{template:"value"}),s.jsx(D,{template:"loading",message:"Loading your other inbox..."})]})]}),s.jsx("div",{className:r.side,children:s.jsx(ue,{groupByDay:!0})})]})]})};export{_e as default};
