"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[997],{505:function(e,t,r){r.d(t,{m:function(){return o}});r(969);var n=r(7780),s=r(3583),i=r(7574),a=(0,n.Z)({divider:{alignItems:"self-start",paddingTop:"20px",marginBottom:"20px"}}),o=function(e){var t=a();return(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:e.title}),(0,i.jsx)("div",{children:e.description}),(0,i.jsx)(s.i,{className:t.divider})]})}},5997:function(e,t,r){r.r(t),r.d(t,{default:function(){return Je}});var n,s,i,a,o,l,c,u,d,h,p,m,v,f,g,y,x,b,k,w,T,j,S,C,R,_,P,I=r(6234),Z=r(3028),z=r(969),q=r(505),D=r(2723),N=r(1361),M=r(8079),L=r(1171),U=r(9249),F=r(7371),O=r(3069),B=r(5058),A=r(5754),W=r(6906),E=r(4160),H=r(8268),Q=r(2742),$=r(2292),K=r(7667),V=r(8556),G=r(9155),J=r(8402),Y=r(3022),X=r(6429),ee=r(2097),te={modified:"modified on",back:"Back",next:"Next",pages:"pages",page:"Page"},re=[(0,E.iv)(n||(n=(0,L.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n'])))],ne=r(9698),se=r(4223),ie=r(3408),ae=r(9576),oe=r(8388),le=r(5827),ce=r(6552),ue=r(8097),de=r(8382),he=r(9768),pe=function(e,t,r,n){var s,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,r,a):s(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},me=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ve=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function o(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}l((n=n.apply(e,t||[])).next())}))},fe=function(e){(0,A.Z)(r,e);var t=(0,W.Z)(r);function r(){var e;return(0,U.Z)(this,r),(e=t.call(this))._size=10,e.entityTypes=["driveItem","listItem","site"],e.scopes=[],e.contentSources=[],e.version="v1.0",e.pagingMax=7,e.enableTopResults=!1,e.cacheEnabled=!1,e.cacheInvalidationPeriod=3e4,e.isRefreshing=!1,e.defaultFields=["webUrl","lastModifiedBy","lastModifiedDateTime","summary","displayName","name"],e._currentPage=1,e.onFirstPageClick=function(){e.currentPage=1,e.scrollToFirstResult()},e.onPageBackClick=function(){e.currentPage--,e.scrollToFirstResult()},e.onPageNextClick=function(){e.currentPage++,e.scrollToFirstResult()},console.warn("\ud83e\udd92: <mgt-search-results> is a preview component and may change prior to becoming generally available. See more information https://aka.ms/mgt/preview-components"),e}return(0,F.Z)(r,[{key:"strings",get:function(){return te}},{key:"queryString",get:function(){return this._queryString},set:function(e){this._queryString!==e&&(this._queryString=e,this._currentPage=1,this.setLoadingState(!0),this.requestStateUpdate(!0))}},{key:"from",get:function(){return(this.currentPage-1)*this.size}},{key:"size",get:function(){return this._size},set:function(e){e>this.maxPageSize?this._size=this.maxPageSize:this._size=e}},{key:"searchEndpoint",get:function(){return"/search/query"}},{key:"maxPageSize",get:function(){return 1e3}},{key:"currentPage",get:function(){return this._currentPage},set:function(e){this._currentPage!==e&&(this._currentPage=e,this.requestStateUpdate(!0))}},{key:"attributeChangedCallback",value:function(e,t,n){(0,O.Z)((0,B.Z)(r.prototype),"attributeChangedCallback",this).call(this,e,t,n),this.requestStateUpdate()}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}},{key:"clearState",value:function(){this.response=null}},{key:"render",value:function(){var e,t,r,n,l,c,u,d,h,p=this,m=null,v=null;return this.hasTemplate("header")&&(v=this.renderTemplate("header",this.response)),h=this.renderFooter(null===(t=null===(e=this.response)||void 0===e?void 0:e.value[0])||void 0===t?void 0:t.hitsContainers[0]),m=this.isLoadingState?this.renderLoading():this.error?this.renderError():this.response&&this.hasTemplate("default")?this.renderTemplate("default",this.response)||(0,E.dy)(s||(s=(0,L.Z)([""]))):(null===(n=null===(r=this.response)||void 0===r?void 0:r.value[0])||void 0===n?void 0:n.hitsContainers[0])?(0,E.dy)(i||(i=(0,L.Z)(["",""])),null===(d=null===(u=null===(c=null===(l=this.response)||void 0===l?void 0:l.value[0])||void 0===c?void 0:c.hitsContainers[0])||void 0===u?void 0:u.hits)||void 0===d?void 0:d.map((function(e){return p.renderResult(e)}))):this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(0,E.dy)(a||(a=(0,L.Z)([""]))),(0,E.dy)(o||(o=(0,L.Z)(["\n      ",'\n      <div class="search-results">\n        ',"\n      </div>\n      ",""])),v,m,h)}},{key:"loadState",value:function(){var e,t,r,n,s,i;return ve(this,void 0,void 0,(0,D.Z)().mark((function a(){var o,l,c,u,d,h,p,m,v,f,g,y,x,b,k,w;return(0,D.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o=Q.C.globalProvider,this.error=null,o&&o.state===$.Aw.SignedIn){a.next=4;break}return a.abrupt("return");case 4:if(!this.queryString){a.next=62;break}if(a.prev=5,l=this.getRequestOptions(),u=JSON.stringify({endpoint:"".concat(this.version).concat(this.searchEndpoint),requestOptions:l}),d=null,!this.shouldRetrieveCache()){a.next=20;break}if(c=K.Q.getCache(ee.O.search,ee.O.search.stores.responses),!(0,ne.rK)()){a.next=17;break}return a.next=14,c.getValue(u);case 14:a.t0=a.sent,a.next=18;break;case 17:a.t0=null;case 18:(h=a.t0)&&(0,ne.n6)(this.cacheInvalidationPeriod)>Date.now()-h.timeCached&&(d=JSON.parse(h.response));case 20:if(d){a.next=53;break}return p=o.graph.forComponent(this),m=p.api(this.searchEndpoint).version(this.version),(null===(e=this.scopes)||void 0===e?void 0:e.length)&&(m=m.middlewareOptions(V.z.apply(void 0,(0,M.Z)(this.scopes)))),a.next=26,m.post({requests:[l]});case 26:if(d=a.sent,!this.fetchThumbnail){a.next=49;break}v=p.createBatch(),f=G.g.fromGraph(p).createBatch(),g=(null===(t=d.value)||void 0===t?void 0:t.length)&&(null===(r=d.value[0].hitsContainers)||void 0===r?void 0:r.length)&&null!==(s=null===(n=d.value[0].hitsContainers[0])||void 0===n?void 0:n.hits)&&void 0!==s?s:[],y=(0,N.Z)(g);try{for(y.s();!(x=y.n()).done;)b=x.value,!((k=b.resource).size>0||(null===(i=k.webUrl)||void 0===i?void 0:i.endsWith(".aspx")))||"#microsoft.graph.driveItem"!==k["@odata.type"]&&"#microsoft.graph.listItem"!==k["@odata.type"]||("#microsoft.graph.listItem"===k["@odata.type"]?f.get(b.hitId.toString(),"/sites/".concat(k.parentReference.siteId,"/pages/").concat(k.id)):v.get(b.hitId.toString(),"/drives/".concat(k.parentReference.driveId,"/items/").concat(k.id,"/thumbnails/0/medium")))}catch(T){y.e(T)}finally{y.f()}return w=function(e){if(e&&e.size>0){var t,r=(0,N.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=(0,I.Z)(t.value,2),s=n[0],i=n[1],a=d.value[0].hitsContainers[0].hits[s],o="#microsoft.graph.listItem"===a.resource["@odata.type"]?{url:i.content.thumbnailWebUrl}:{url:i.content.url};a.resource.thumbnail=o}}catch(T){r.e(T)}finally{r.f()}}},a.prev=34,a.t1=w,a.next=38,v.executeAll();case 38:return a.t2=a.sent,(0,a.t1)(a.t2),a.t3=w,a.next=43,f.executeAll();case 43:a.t4=a.sent,(0,a.t3)(a.t4),a.next=49;break;case 47:a.prev=47,a.t5=a.catch(34);case 49:if(!this.shouldUpdateCache()||!d){a.next=53;break}return c=K.Q.getCache(ee.O.search,ee.O.search.stores.responses),a.next=53,c.putValue(u,{response:JSON.stringify(d)});case 53:(0,J.f)(this.response,d)||(this.response=d),a.next=59;break;case 56:a.prev=56,a.t6=a.catch(5),this.error=a.t6;case 59:this.response&&(this.error=null),a.next=63;break;case 62:this.response=null;case 63:this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error});case 65:case"end":return a.stop()}}),a,this,[[5,56],[34,47]])})))}},{key:"renderLoading",value:function(){var e=this;return this.renderTemplate("loading",null)||(0,E.dy)(l||(l=(0,L.Z)(["\n        ","\n       "])),(0,M.Z)(Array(this.size)).map((function(){return(0,E.dy)(c||(c=(0,L.Z)(['\n            <div class="search-result">\n              <div class="search-result-grid">\n                <div class="search-result-icon">\n                  <fluent-skeleton class="search-result-icon__shimmer" shape="rect" shimmer></fluent-skeleton>\n                </div>\n                <div class="searc-result-content">\n                  <div class="search-result-name">\n                    <fluent-skeleton class="search-result-name__shimmer" shape="rect" shimmer></fluent-skeleton>\n                  </div>\n                  <div class="search-result-info">\n                    <div class="search-result-author">\n                      <fluent-skeleton class="search-result-author__shimmer" shape="circle" shimmer></fluent-skeleton>\n                    </div>\n                    <div class="search-result-date">\n                      <fluent-skeleton class="search-result-date__shimmer" shape="rect" shimmer></fluent-skeleton>\n                    </div>\n                  </div>\n                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>\n                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>\n                </div>\n                ',"\n              </div>\n              <fluent-divider></fluent-divider>\n            </div>\n          "])),e.fetchThumbnail&&(0,E.dy)(u||(u=(0,L.Z)(['\n                    <div class="search-result-thumbnail">\n                      <fluent-skeleton class="search-result-thumbnail__shimmer" shape="rect" shimmer></fluent-skeleton>\n                    </div>\n                  ']))))})))}},{key:"renderResult",value:function(e){var t=this.getResourceType(e.resource);if(this.hasTemplate("result-".concat(t)))return this.renderTemplate("result-".concat(t),e,e.hitId);switch(e.resource["@odata.type"]){case"#microsoft.graph.driveItem":return this.renderDriveItem(e);case"#microsoft.graph.site":return this.renderSite(e);case"#microsoft.graph.person":return this.renderPerson(e);case"#microsoft.graph.drive":case"#microsoft.graph.list":return this.renderList(e);case"#microsoft.graph.listItem":return this.renderListItem(e);case"#microsoft.graph.search.bookmark":return this.renderBookmark(e);case"#microsoft.graph.search.acronym":return this.renderAcronym(e);case"#microsoft.graph.search.qna":return this.renderQnA(e);default:return this.renderDefault(e)}}},{key:"renderFooter",value:function(e){if(this.pagingRequired(e)){var t=this.getActivePages(e.total);return(0,E.dy)(d||(d=(0,L.Z)(['\n        <div class="search-results-pages">\n          ',"\n          ","\n          ","\n          ","\n        </div>\n      "])),this.renderPreviousPage(),this.renderFirstPage(t),this.renderAllPages(t),this.renderNextPage())}}},{key:"pagingRequired",value:function(e){return(null===e||void 0===e?void 0:e.moreResultsAvailable)||this.currentPage*this.size<(null===e||void 0===e?void 0:e.total)}},{key:"getActivePages",value:function(e){var t=this,r=[],n=function(){var e=t.currentPage-Math.floor(t.pagingMax/2)-1;return e>=Math.floor(t.pagingMax/2)?e:0}();if(n+1>this.pagingMax-this.currentPage||this.pagingMax===this.currentPage)for(var s=n+1;s<Math.ceil(e/this.size)&&s<this.pagingMax+(this.currentPage-1)&&r.length<this.pagingMax-2;++s)r.push(s+1);else for(var i=n;i<this.pagingMax;++i)r.push(i+1);return r}},{key:"renderAllPages",value:function(e){var t=this;return(0,E.dy)(h||(h=(0,L.Z)(["\n      ",""])),e.map((function(e){return(0,E.dy)(p||(p=(0,L.Z)(['\n            <fluent-button\n              title="'," ",'"\n              appearance="stealth"\n              class="','"\n              @click="','">\n                ',"\n            </fluent-button>"])),te.page,e,e===t.currentPage?"search-results-page-active":"search-results-page",(function(){return t.onPageClick(e)}),e)})))}},{key:"renderFirstPage",value:function(e){var t=this;return(0,E.dy)(m||(m=(0,L.Z)(["\n      ",""])),e.some((function(e){return 1===e}))?E.Ld:(0,E.dy)(v||(v=(0,L.Z)(['\n              <fluent-button\n                 title="',' 1"\n                 appearance="stealth"\n                 class="search-results-page"\n                 @click="','">\n                 1\n               </fluent-button>'])),te.page,this.onFirstPageClick)?(0,E.dy)(f||(f=(0,L.Z)(['\n              <fluent-button\n                id="page-back-dot"\n                appearance="stealth"\n                class="search-results-page"\n                title="','"\n                @click="','"\n              >\n                ...\n              </fluent-button>'])),this.getDotButtonTitle(),(function(){return t.onPageClick(t.currentPage-Math.ceil(t.pagingMax/2))})):E.Ld)}},{key:"getDotButtonTitle",value:function(){return"".concat(te.back," ").concat(Math.ceil(this.pagingMax/2)," ").concat(te.pages)}},{key:"renderPreviousPage",value:function(){return this.currentPage>1?(0,E.dy)(g||(g=(0,L.Z)(['\n          <fluent-button\n            appearance="stealth"\n            class="search-results-page"\n            title="','"\n            @click="','">\n              ',"\n            </fluent-button>"])),te.back,this.onPageBackClick,(0,se.d)(se.l.ChevronLeft)):E.Ld}},{key:"renderNextPage",value:function(){return this.isLastPage()?E.Ld:(0,E.dy)(y||(y=(0,L.Z)(['\n          <fluent-button\n            appearance="stealth"\n            class="search-results-page"\n            title="','"\n            aria-label="','"\n            @click="','">\n              ',"\n            </fluent-button>"])),te.next,te.next,this.onPageNextClick,(0,se.d)(se.l.ChevronRight))}},{key:"onPageClick",value:function(e){this.currentPage=e,this.scrollToFirstResult()}},{key:"isLastPage",value:function(){return this.currentPage===Math.ceil(this.response.value[0].hitsContainers[0].total/this.size)}},{key:"scrollToFirstResult",value:function(){this.renderRoot.querySelector(".search-results").scrollIntoView({block:"start",behavior:"smooth"})}},{key:"getResourceType",value:function(e){return e["@odata.type"].split(".").pop()}},{key:"renderDriveItem",value:function(e){var t,r,n=e.resource;return(0,Y.b)(x||(x=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          <mgt-file\n            .fileDetails="','"\n            view="image"\n            class="file-icon">\n          </mgt-file>\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">','</a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-author">\n              <mgt-person\n                person-query=','\n                view="oneLine"\n                person-card="hover"\n                show-presence="true">\n              </mgt-person>\n            </div>\n            <div class="search-result-date">\n              &nbsp; '," ",'\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n        ',"\n\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),e.resource,n.webUrl,(0,ne.ju)(n.name),n.lastModifiedBy.user.email,te.modified,(0,ne.t9)(new Date(n.lastModifiedDateTime)),(0,ne.$8)(e.summary),(null===(t=n.thumbnail)||void 0===t?void 0:t.url)&&(0,E.dy)(b||(b=(0,L.Z)(['\n          <div class="search-result-thumbnail">\n            <a href="','" target="_blank"><img alt="','" src="','" /></a>\n          </div>'])),n.webUrl,n.name,null===(r=n.thumbnail)||void 0===r?void 0:r.url))}},{key:"renderSite",value:function(e){var t=e.resource;return(0,E.dy)(k||(k=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="searc-result-content">\n          <div class="search-result-name">\n            <a href="','" target="_blank">','</a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-url">\n              <a href="','" target="_blank">','</a>\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),this.getResourceIcon(t),t.webUrl,t.displayName,t.webUrl,t.webUrl,(0,ne.$8)(e.summary))}},{key:"renderList",value:function(e){var t=e.resource;return(0,Y.b)(w||(w=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          <mgt-file\n            .fileDetails="','"\n            view="image">\n          </mgt-file>\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">\n              ','\n            </a>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),e.resource,t.webUrl,(0,ne.ju)(t.name||(0,ne.nN)(t.webUrl)),(0,ne.$8)(e.summary))}},{key:"renderListItem",value:function(e){var t,r,n=e.resource;return(0,Y.b)(T||(T=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">\n              ','\n            </a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-author">\n              <mgt-person\n                person-query=','\n                view="oneLine"\n                person-card="hover"\n                show-presence="true">\n              </mgt-person>\n            </div>\n            <div class="search-result-date">\n              &nbsp; '," ",'\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n        ',"\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),n.webUrl.endsWith(".aspx")?(0,se.d)(se.l.News):(0,se.d)(se.l.FileOuter),n.webUrl,(0,ne.ju)(n.name||(0,ne.nN)(n.webUrl)),n.lastModifiedBy.user.email,te.modified,(0,ne.t9)(new Date(n.lastModifiedDateTime)),(0,ne.$8)(e.summary),(null===(t=n.thumbnail)||void 0===t?void 0:t.url)&&(0,E.dy)(j||(j=(0,L.Z)(['\n          <div class="search-result-thumbnail">\n            <a href="','" target="_blank"><img alt="','" src="','" /></a>\n          </div>'])),n.webUrl,(0,ne.ju)(n.name||(0,ne.nN)(n.webUrl)),(null===(r=n.thumbnail)||void 0===r?void 0:r.url)||E.Ld))}},{key:"renderPerson",value:function(e){var t=e.resource;return(0,Y.b)(S||(S=(0,L.Z)(['\n      <div class="search-result">\n        <mgt-person\n          view="fourLines"\n          person-query=','\n          person-card="hover"\n          show-presence="true">\n        </mgt-person>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),t.userPrincipalName)}},{key:"renderBookmark",value:function(e){return this.renderAnswer(e,se.l.DoubleBookmark)}},{key:"renderAcronym",value:function(e){return this.renderAnswer(e,se.l.BookOpen)}},{key:"renderQnA",value:function(e){return this.renderAnswer(e,se.l.BookQuestion)}},{key:"renderAnswer",value:function(e,t){var r=e.resource;return(0,E.dy)(C||(C=(0,L.Z)(['\n      <div class="search-result-grid search-result-answer">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">','</a>\n          </div>\n          <div class="search-result-summary">',"</div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),(0,se.d)(t),this.getResourceUrl(r),r.displayName,r.description)}},{key:"renderDefault",value:function(e){var t=e.resource,r=this.getResourceUrl(t);return(0,E.dy)(R||(R=(0,L.Z)(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            ','\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),this.getResourceIcon(t),r?(0,E.dy)(_||(_=(0,L.Z)(['\n                  <a href="','?Web=1" target="_blank">',"</a>\n                "])),r,this.getResourceName(t)):(0,E.dy)(P||(P=(0,L.Z)(["\n                  ","\n                "])),this.getResourceName(t)),this.getResultSummary(e))}},{key:"getResourceUrl",value:function(e){return e.webUrl||e.webLink||null}},{key:"getResourceName",value:function(e){return e.displayName||e.subject||(0,ne.ju)(e.name)}},{key:"getResultSummary",value:function(e){var t;return(0,ne.$8)(e.summary||(null===(t=e.resource)||void 0===t?void 0:t.description)||null)}},{key:"getResourceIcon",value:function(e){switch(e["@odata.type"]){case"#microsoft.graph.site":return(0,se.d)(se.l.Globe);case"#microsoft.graph.message":return(0,se.d)(se.l.Email);case"#microsoft.graph.event":return(0,se.d)(se.l.Event);case"microsoft.graph.chatMessage":return(0,se.d)(se.l.SmallChat);default:return(0,se.d)(se.l.FileOuter)}}},{key:"shouldRetrieveCache",value:function(){return(0,ne.rK)()&&this.cacheEnabled&&!this.isRefreshing}},{key:"shouldUpdateCache",value:function(){return(0,ne.rK)()&&this.cacheEnabled}},{key:"getRequestOptions",value:function(){var e={entityTypes:this.entityTypes,query:{queryString:this.queryString},from:this.from?this.from:void 0,size:this.size?this.size:void 0,fields:this.getFields(),enableTopResults:this.enableTopResults?this.enableTopResults:void 0};return this.entityTypes.includes("externalItem")&&(e.contentSources=this.contentSources),"beta"===this.version&&(e.query.queryTemplate=this.queryTemplate?this.queryTemplate:void 0),e}},{key:"getFields",value:function(){if(this.fields)return this.defaultFields.concat(this.fields)}}],[{key:"styles",get:function(){return re}}]),r}(X.h);pe([(0,H.Cb)({attribute:"query-string",type:String}),me("design:type",String),me("design:paramtypes",[String])],fe.prototype,"queryString",null),pe([(0,H.Cb)({attribute:"query-template",type:String}),me("design:type",String)],fe.prototype,"queryTemplate",void 0),pe([(0,H.Cb)({attribute:"entity-types",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),me("design:type",Array)],fe.prototype,"entityTypes",void 0),pe([(0,H.Cb)({attribute:"scopes",converter:function(e,t){return e?e.toLowerCase().split(","):null}}),me("design:type",Array)],fe.prototype,"scopes",void 0),pe([(0,H.Cb)({attribute:"content-sources",converter:function(e,t){return e?e.toLowerCase().split(","):null}}),me("design:type",Array)],fe.prototype,"contentSources",void 0),pe([(0,H.Cb)({attribute:"version",reflect:!0,type:String}),me("design:type",Object)],fe.prototype,"version",void 0),pe([(0,H.Cb)({attribute:"size",reflect:!0,type:Number}),me("design:type",Number),me("design:paramtypes",[Object])],fe.prototype,"size",null),pe([(0,H.Cb)({attribute:"paging-max",reflect:!0,type:Number}),me("design:type",Object)],fe.prototype,"pagingMax",void 0),pe([(0,H.Cb)({attribute:"fetch-thumbnail",type:Boolean}),me("design:type",Boolean)],fe.prototype,"fetchThumbnail",void 0),pe([(0,H.Cb)({attribute:"fields",converter:function(e){return e.split(",").map((function(e){return e.trim()}))},type:String}),me("design:type",Array)],fe.prototype,"fields",void 0),pe([(0,H.Cb)({attribute:"enable-top-results",reflect:!0,type:Boolean}),me("design:type",Object)],fe.prototype,"enableTopResults",void 0),pe([(0,H.Cb)({attribute:"cache-enabled",reflect:!0,type:Boolean}),me("design:type",Object)],fe.prototype,"cacheEnabled",void 0),pe([(0,H.Cb)({attribute:"cache-invalidation-period",reflect:!0,type:Number}),me("design:type",Object)],fe.prototype,"cacheInvalidationPeriod",void 0),pe([(0,H.SB)(),me("design:type",Object)],fe.prototype,"response",void 0),pe([(0,H.SB)(),me("design:type",Number),me("design:paramtypes",[Number])],fe.prototype,"currentPage",null);var ge=r(7908),ye=(0,ge.$)("search-results",(function(){(0,ce.J)(ie.aV,ae.hb,oe.x,le.ue),(0,de.R)(),(0,he.yQ)(),(0,ue.R)("search-results",fe)})),xe=r(7574),be=function(e){return(0,xe.jsx)(xe.Fragment,{children:e.searchTerm&&(0,xe.jsxs)(xe.Fragment,{children:["*"!==e.searchTerm&&(0,xe.jsx)(ye,{entityTypes:["bookmark"],queryString:e.searchTerm,version:"beta",size:1,scopes:["Bookmark.Read.All"],children:(0,xe.jsx)(ke,{template:"no-data"})}),(0,xe.jsx)(ye,{entityTypes:["driveItem","listItem","site"],queryString:e.searchTerm,scopes:["Files.Read.All","Sites.Read.All"],fetchThumbnail:!0})]})})},ke=function(e){return(0,xe.jsx)(xe.Fragment,{})},we=function(e){return(0,xe.jsx)(xe.Fragment,{children:(0,xe.jsx)(ye,{entityTypes:["people"],size:20,queryString:e.searchTerm,version:"beta"})})},Te=r(7780),je=r(4220),Se=r(8013),Ce=r(9191),Re=r(2205),_e=function(e){return(0,xe.jsx)(xe.Fragment,{children:e.searchTerm&&(0,xe.jsx)(ye,{entityTypes:["externalItem"],contentSources:["/external/connections/contosoBlogPosts"],queryString:e.searchTerm,scopes:["ExternalItem.Read.All"],version:"beta"})})},Pe=(0,ge.$)("file",de.R),Ie=r(9251),Ze=r(2476),ze=r(5607),qe=r(9591),De=r(1654),Ne=r(4508),Me=r(6816),Le=r(2880),Ue=r(1901),Fe=r(7828),Oe=r(2277),Be=r(5908),Ae=r(4636),We=r(710),Ee=(0,Te.Z)({container:(0,Z.Z)((0,Z.Z)({},je.q5.gap("16px")),{},{display:"flex",flexDirection:"row",flexWrap:"wrap"}),card:{width:"300px",height:"fit-content",maxWidth:"100%"},caption:{color:qe.T.colorNeutralForeground3},noDataSearchTerm:{fontWeight:qe.T.fontWeightSemibold},emptyContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"calc(100vh - 300px)"},fileContainer:{display:"flex"},fileTitle:{paddingLeft:"10px",alignSelf:"center"},noDataMessage:{paddingLeft:"10px"},noDataIcon:{fontSize:"128px"},row:{cursor:"pointer"}}),He=function(e){return(0,xe.jsx)(xe.Fragment,{children:e.searchTerm&&(0,xe.jsxs)(ye,{entityTypes:["driveItem"],queryString:e.searchTerm,fetchThumbnail:!0,queryTemplate:"({searchTerms}) ContentTypeId:0x0101*",version:"beta",fields:["createdBy","lastModifiedDateTime","Title","DefaultEncodingURL"],size:30,cacheEnabled:!0,children:[(0,xe.jsx)($e,{template:"default"}),(0,xe.jsx)($e,{template:"loading"}),(0,xe.jsx)(Ke,{template:"no-data"})]})})},Qe=function(e,t){return[(0,De.p)({columnId:"name",renderHeaderCell:function(){return"Name"},renderCell:function(r){return(0,xe.jsx)(Ne.K,{children:e?(0,xe.jsx)(Me.j,{shape:"rectangle",style:{width:"120px"}}):(0,xe.jsxs)("div",{className:t.fileContainer,children:[(0,xe.jsx)(Pe,{fileDetails:r.resource,view:Ie.b.image}),(0,xe.jsx)("span",{className:t.fileTitle,children:r.resource.listItem.fields.title})]})})}}),(0,De.p)({columnId:"modified",renderHeaderCell:function(){return"Modified"},renderCell:function(t){return(0,xe.jsx)(Ne.K,{children:e?(0,xe.jsx)(Me.j,{shape:"rectangle",style:{width:"120px"}}):Ve(new Date(t.resource.lastModifiedDateTime))})}}),(0,De.p)({columnId:"owner",renderHeaderCell:function(){return"Owner"},renderCell:function(t){return(0,xe.jsx)(Ne.K,{children:e?(0,xe.jsxs)("div",{style:{display:"grid",alignItems:"center",position:"relative",gridTemplateColumns:"min-content 80%",gap:"10px"},children:[(0,xe.jsx)(Me.j,{shape:"circle",size:32}),(0,xe.jsx)(Me.j,{style:{width:"120px"}})]}):(0,xe.jsx)(Ze.F,{personQuery:t.resource.createdBy.user.email,view:Ie.b.oneline,personCardInteraction:ze.c.hover})})}})]},$e=function(e){var t,r,n,s=Ee(),i=z.useState(null===(t=e.dataContext.value)||void 0===t||null===(r=t[0])||void 0===r||null===(n=r.hitsContainers[0])||void 0===n?void 0:n.hits),a=(0,I.Z)(i,1)[0];return(0,xe.jsx)("div",{children:(0,xe.jsxs)(Le._,{columns:Qe("loading"===e.template,s),items:"loading"===e.template?(0,M.Z)(Array(30)):a,children:[(0,xe.jsx)(Ue.S,{children:(0,xe.jsx)(Fe.m,{children:function(e){var t=e.renderHeaderCell;return(0,xe.jsx)(Oe.p,{children:t()})}})}),(0,xe.jsx)(Be.s,{children:function(e){var t=e.item,r=e.rowId;return(0,xe.jsx)(Fe.m,{className:s.row,onClick:function(){return function(e){var t=new URL(e.resource.listItem.fields.defaultEncodingURL);t.searchParams.append("Web","1"),window.open(t.toString(),"_blank")}(t)},children:function(e){var r=e.renderCell;return(0,xe.jsx)(Ae.a,{children:r(t)})}},r)}})]})})},Ke=function(e){var t,r=Ee(),n=z.useState(null===(t=e.dataContext.value[0])||void 0===t?void 0:t.searchTerms),s=(0,I.Z)(n,1)[0];return(0,xe.jsxs)("div",{className:r.emptyContainer,children:[(0,xe.jsx)("div",{children:(0,xe.jsx)(We.vRj,{className:r.noDataIcon})}),(0,xe.jsxs)("div",{className:r.noDataMessage,children:["We couldn't find any results for ",(0,xe.jsx)("span",{className:r.noDataSearchTerm,children:s.join(" ")})]})]})},Ve=function(e){var t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=r)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});var n=new Date(r);if(n.setDate(t.getDate()-t.getDay()),e>=n)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});var s=new Date(n);return s.setDate(n.getDate()-7),e>=s?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},Ge=(0,Te.Z)({panels:(0,Z.Z)({},je.q5.padding("10px")),container:{maxWidth:"1028px",width:"100%"}}),Je=function(){var e=Ge(),t=(0,Re.b)(),r=z.useState(new URLSearchParams(window.location.search).get("q")),n=(0,I.Z)(r,1)[0],s=z.useState("allResults"),i=(0,I.Z)(s,2),a=i[0],o=i[1];return(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(q.m,{title:"Search",description:"Use this Search Center to test Microsot Graph Toolkit search components capabilities"}),(0,xe.jsxs)("div",{className:e.container,children:[(0,xe.jsxs)(Se.t,{selectedValue:a,onTabSelect:function(e,t){o(t.value)},children:[(0,xe.jsx)(Ce.O,{value:"allResults",children:"All Results"}),(0,xe.jsx)(Ce.O,{value:"driveItems",children:"Files"}),(0,xe.jsx)(Ce.O,{value:"externalItems",children:"External Items"}),(0,xe.jsx)(Ce.O,{value:"people",children:"People"})]}),(0,xe.jsxs)("div",{className:e.panels,children:["allResults"===a&&(0,xe.jsx)(be,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"driveItems"===a&&(0,xe.jsx)(He,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"externalItems"===a&&(0,xe.jsx)(_e,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm}),"people"===a&&(0,xe.jsx)(we,{searchTerm:null!==n&&void 0!==n?n:t.state.searchTerm})]})]})]})}},9155:function(e,t,r){r.d(t,{g:function(){return l}});var n=r(9249),s=r(7371),i=r(5754),a=r(6906),o=r(4629),l=function(e){(0,i.Z)(r,e);var t=(0,a.Z)(r);function r(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"beta";return(0,n.Z)(this,r),t.call(this,e,s)}return(0,s.Z)(r,[{key:"forComponent",value:function(e){var t=new r(this.client);return this.setComponent(e),t}}],[{key:"fromGraph",value:function(e){var t=new r(e.client);return t.setComponent(e.componentName),t}}]),r}(o.k)}}]);
//# sourceMappingURL=997.b1741c5e.chunk.js.map