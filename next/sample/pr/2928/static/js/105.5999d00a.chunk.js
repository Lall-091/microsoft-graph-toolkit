"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[105],{505:function(e,t,n){n.d(t,{m:function(){return o}});n(969);var i=n(7780),r=n(3583),s=n(7574),a=(0,i.Z)({divider:{alignItems:"self-start",paddingTop:"20px",marginBottom:"20px"}}),o=function(e){var t=a();return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:e.title}),(0,s.jsx)("div",{children:e.description}),(0,s.jsx)(r.i,{className:t.divider})]})}},7724:function(e,t,n){n.d(t,{xV:function(){return N}});var i,r,s,a,o,l,c=n(2723),u=n(1171),h=n(9249),p=n(7371),d=n(3069),f=n(5058),v=n(5754),g=n(6906),b=n(3836),y=n(4761),m=n(7667),x=n(2742),k=n(2292),C=n(8556),O=n(8402),P=n(6429),j=n(5854),R=n(7425),w=n(2097),S=n(8097),Z=function(e,t,n,i){var r,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,n,a):r(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},T=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{l(i.next(e))}catch(t){s(t)}}function o(e){try{l(i.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))},L=function(e){return Array.isArray(null===e||void 0===e?void 0:e.value)};!function(e){e.json="json",e.image="image"}(l||(l={}));var I=function(){return m.Q.config.response.isEnabled&&m.Q.config.isEnabled},N=function(){return(0,S.R)("get",Q)},Q=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,h.Z)(this,n),(e=t.apply(this,arguments)).scopes=[],e.version="v1.0",e.type=l.json,e.maxPages=3,e.pollingRate=0,e.cacheEnabled=!1,e.cacheInvalidationPeriod=0,e.isPolling=!1,e.isRefreshing=!1,e}return(0,p.Z)(n,[{key:"attributeChangedCallback",value:function(e,t,i){(0,d.Z)((0,f.Z)(n.prototype),"attributeChangedCallback",this).call(this,e,t,i),this.requestStateUpdate()}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}},{key:"clearState",value:function(){this.response=null}},{key:"render",value:function(){var e=this;if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&L(this.response)){var t;if(L(this.response)){var n=null;this.isLoadingState&&!this.isPolling&&(n=this.renderTemplate("loading",null)),t=(0,b.dy)(i||(i=(0,u.Z)(["\n          "," ","\n        "])),this.response.value.map((function(t){return e.renderTemplate("value",t,t.id)})),n)}else t=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){var l=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?(0,b.dy)(r||(r=(0,u.Z)(["\n            ","","\n          "])),l,t):(0,b.dy)(s||(s=(0,u.Z)(["\n            ","","\n          "])),t,l)}return t}return this.response?this.renderTemplate("default",this.response)||(0,b.dy)(a||(a=(0,u.Z)([""]))):this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(0,b.dy)(o||(o=(0,u.Z)([""])))}},{key:"loadState",value:function(){var e,t,n;return E(this,void 0,void 0,(0,c.Z)().mark((function i(){var r,s,a,o,u,h,p,d,f,v,g,b,y,P,S,Z,T,E=this;return(0,c.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r=x.C.globalProvider,this.error=null,r&&r.state===k.Aw.SignedIn){i.next=4;break}return i.abrupt("return");case 4:if(!this.resource){i.next=75;break}if(i.prev=5,a="".concat(this.version).concat(this.resource),o=null,!this.shouldRetrieveCache()){i.next=19;break}if(s=m.Q.getCache(w.O.get,w.O.get.stores.responses),!I()){i.next=16;break}return i.next=13,s.getValue(a);case 13:i.t0=i.sent,i.next=17;break;case 16:i.t0=null;case 17:(u=i.t0)&&(this.cacheInvalidationPeriod||m.Q.config.response.invalidationPeriod||m.Q.config.defaultInvalidationPeriod)>Date.now()-u.timeCached&&(o=JSON.parse(u.response));case 19:if(o){i.next=66;break}if(h=this.resource,p=!1,(null===(e=this.response)||void 0===e?void 0:e["@odata.deltaLink"])?(h=this.response["@odata.deltaLink"],p=!0):p=new URL(h,"https://graph.microsoft.com").pathname.endsWith("delta"),d=r.graph.forComponent(this),f=d.api(h).version(this.version),(null===(t=this.scopes)||void 0===t?void 0:t.length)&&(f=f.middlewareOptions((0,C.z)(this.scopes))),this.type!==l.json){i.next=46;break}return i.next=29,f.get();case 29:if(o=i.sent,p&&L(this.response)&&L(o)&&(v=o.value,o.value=this.response.value.concat(v)),this.isPolling||(0,O.f)(this.response,o)||(this.response=o),!L(o)||!o["@odata.nextLink"]){i.next=44;break}g=1,b=o;case 35:if(!(g<this.maxPages||this.maxPages<=0||p&&this.pollingRate)||!(null===b||void 0===b?void 0:b["@odata.nextLink"])){i.next=44;break}return g++,y=b["@odata.nextLink"].split(this.version)[1],i.next=40,d.api(y).version(this.version).get();case 40:b=i.sent,(null===(n=null===b||void 0===b?void 0:b.value)||void 0===n?void 0:n.length)&&(b.value=o.value.concat(b.value),o=b,this.isPolling||(this.response=o)),i.next=35;break;case 44:i.next=62;break;case 46:if(-1!==this.resource.indexOf("/photo/$value")||-1!==this.resource.indexOf("/thumbnails/")){i.next=48;break}throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");case 48:if(!(this.resource.indexOf("/photo/$value")>-1)){i.next=56;break}return S=this.resource.replace("/photo/$value",""),i.next=52,(0,j.E0)(d,S,this.scopes);case 52:(Z=i.sent)&&(P=Z.photo),i.next=61;break;case 56:if(!(this.resource.indexOf("/thumbnails/")>-1)){i.next=61;break}return i.next=59,(0,R.mp)(d,this.resource,this.scopes);case 59:(T=i.sent)&&(P=T.thumbnail);case 61:P&&(o={image:P});case 62:if(!this.shouldUpdateCache()||!o){i.next=66;break}return s=m.Q.getCache(w.O.get,w.O.get.stores.responses),i.next=66,s.putValue(a,{response:JSON.stringify(o)});case 66:(0,O.f)(this.response,o)||(this.response=o),i.next=72;break;case 69:i.prev=69,i.t1=i.catch(5),this.error=i.t1;case 72:this.response&&(this.error=null,this.pollingRate&&setTimeout((function(){E.isPolling=!0,E.loadState().finally((function(){E.isPolling=!1}))}),this.pollingRate)),i.next=76;break;case 75:this.response=null;case 76:this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error});case 78:case"end":return i.stop()}}),i,this,[[5,69]])})))}},{key:"shouldRetrieveCache",value:function(){return I()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}},{key:"shouldUpdateCache",value:function(){return I()&&this.cacheEnabled}}]),n}(P.h);Z([(0,y.Cb)({attribute:"resource",reflect:!0,type:String}),T("design:type",String)],Q.prototype,"resource",void 0),Z([(0,y.Cb)({attribute:"scopes",converter:function(e,t){return e?e.toLowerCase().split(","):null},reflect:!0}),T("design:type",Array)],Q.prototype,"scopes",void 0),Z([(0,y.Cb)({attribute:"version",reflect:!0,type:String}),T("design:type",Object)],Q.prototype,"version",void 0),Z([(0,y.Cb)({attribute:"type",reflect:!0,type:l}),T("design:type",String)],Q.prototype,"type",void 0),Z([(0,y.Cb)({attribute:"max-pages",reflect:!0,type:Number}),T("design:type",Object)],Q.prototype,"maxPages",void 0),Z([(0,y.Cb)({attribute:"polling-rate",reflect:!0,type:Number}),T("design:type",Object)],Q.prototype,"pollingRate",void 0),Z([(0,y.Cb)({attribute:"cache-enabled",reflect:!0,type:Boolean}),T("design:type",Object)],Q.prototype,"cacheEnabled",void 0),Z([(0,y.Cb)({attribute:"cache-invalidation-period",type:Number}),T("design:type",Object)],Q.prototype,"cacheInvalidationPeriod",void 0),Z([(0,y.Cb)({attribute:!1}),T("design:type",Object)],Q.prototype,"response",void 0),Z([(0,y.Cb)({attribute:!1}),T("design:type",Object)],Q.prototype,"error",void 0)}}]);
//# sourceMappingURL=105.5999d00a.chunk.js.map